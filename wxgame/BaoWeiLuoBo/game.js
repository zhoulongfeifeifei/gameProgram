	define("GamePlatform.js", function(require, module, exports){ 			
(function(){"use strict";var a={None:0,WeiXin:3,WeiXinApp:1,QQ:2,FaceBook:4},b={},c=a.WeiXinApp,d={BENDI:0,NEIWANG:1,WAIWANG:2,PREPUBLISH:3,ZHENGSHI:4,IDCTEST:5}.ZHENGSHI;b.getCurrentPlatForm=function(){return c},b.needUploadScore=function(){return!0},b.getIsShowAll=function(){return!0},b.isCN=function(){return c!=a.FaceBook},b.getLanguage=function(){return b.isCN()?"_cn":"_en"},b.getPlatFormName=function(){var b=this.getCurrentPlatForm();return b===a.WeiXinApp?"WeiXinApp":b===a.FaceBook?"FaceBook":b===a.WeiXin?"WeiXin":b===a.QQ?"QQ":""},b.sdkCodeUrls=function(){var b=[],c=this.getCurrentPlatForm();return c===a.FaceBook?b.push("https://connect.facebook.com/en_US/fbinstant.latest.js"):c===a.QQ?(b.push("https://qzonestyle.gtimg.cn/qzone/hybrid/lib/qqapi.1470836255000.js?_offline=1&max_age=36000000"),b.push("https://h5sdk.qq.com/h5game/js/h5jssdk-1.1.4.min.js"),b.push("https://midas.gtimg.cn/h5pay/js/api/midas.js")):void 0,b},b.getServer=function(){return"https://wx.bwlbh5.qq.com/"},b.getCDN=function(){return"https://image.bwlbh5.qq.com/cdn/wx/"},window.PlatformType=a,window.GamePlatform=b})(); 
 			});
 		define("SDKInterface_WeiXinApp.js", function(require, module, exports){ 			
(function(){'use strict';var a={},b=!1;setTimeout(function(){wx.showShareMenu({withShareTicket:!0}),wx.onShareAppMessage(function(){b=!0;var a=parseInt(1e8*Math.random())%4+16,c=GamePlatform.getCDN()+'res/shareImg/share'+a+'.jpg';console.log(c);new Date().getTime();return{title:'\u4FDD\u536B\u841D\u535C\u8FC5\u73A9\u7248',imageUrl:c,query:'type=group',success:function(){console.log('\u8F6C\u53D1 '+this.query),b=!0},fail:function(){b=!1}}})},0),a.init=function(b){console.log('sdk init'),cc.addTimePoint('SDKInt');var c=wx.getSystemInfoSync();console.log(c);var d=c.platform;window.isOnIOS=!1,'ios'==d?window.isOnIOS=!0:'devtools'==d&&(window.isOnIOS=-1!=c.model.indexOf('iPhone')),console.log('window.isOnIOS'+window.isOnIOS),a.systemInfo=c,a.version=a.systemInfo.version,b&&b()},a.startGame=function(a){console.log('sdk start game'),a&&a()},a.setLoadProgress=function(){},a.login=function(b){console.log('call login'),cc.addTimePoint('calllogin'),wx.getSetting({success:function(c){console.log('\u8FD4\u56DE\u8BBE\u7F6E'+JSON.stringify(c)),c.authSetting['scope.userInfo']==void 0?a.beginLogin(b):(console.log('res.authSetting.scope.userInfo'+c.authSetting['scope.userInfo']),c.authSetting['scope.userInfo']?a.beginLogin(b):(console,wx.openSetting({success:function(){console.log('sGet success'),a.beginLogin(b)},fail:function(){console.log('set fail')}})))},fail:function(){console.log('wx.getSetting failed'),b&&b(null)}})},a.beginLogin=function(b){var c={name:'',photo:'',id:'0',openid:'',token:''},d=!1,e=!1;console.log('wx.login'),cc.addTimePoint('wxlogin'),wx.login({success:function(f){console.log('\u5FAE\u4FE1\u767B\u5F55\u6210\u529F:'+JSON.stringify(f)),cc.addTimePoint('wxlogin_getUserInfo'),wx.getUserInfo({success:function(e){var f=e.userInfo,g=f.nickName,h=f.avatarUrl,i=f.gender,j=f.province,k=f.city,l=f.country;console.log('\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u6210\u529F'+JSON.stringify(e)),a.getFriendList(),c.name=g,c.photo=h,cc.addTimePoint('wxlogin_getUserInfoSucess'),wx.postMessage({type:'hide'}),d&&(b&&b(c),console.log('\u767B\u5F55\u56DE\u8C03'+JSON.stringify(c)),a.reportLogin(c.name,c.openid),cc.addTimePoint('wxloginsucess')),d=!0},fail:function(a){console.log('\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u5931\u8D25'+JSON.stringify(a));e||(e=!0,b&&b(null,-1))}}),cc.addTimePoint('GetfSOpenid');var g=GamePlatform.getServer();console.log(g);var h=window.isOnIOS?0:1,i={wxcode:f.code,platid:h};console.log('\u53D1\u9001\uFF1A'+JSON.stringify(i)),wx.request({url:g+'wx',method:'POST',data:'data='+encodeURIComponent(JSON.stringify(i)),header:{"content-type":'application/x-www-form-urlencoded'},success:function(f){if(console.log('\u83B7\u53D6openID\u6210\u529F'+JSON.stringify(f)),cc.addTimePoint('GetfSOpenidsucess'),!f.data.code)c.openid=f.data.openid,window.openid=c.openid,c.token=f.data.token,d&&(wx.postMessage({type:'update_openid',data:c.openid}),b&&b(c),console.log('\u767B\u5F55\u56DE\u8C03'+JSON.stringify(c)),a.reportLogin(c.name,c.openid),cc.addTimePoint('wxloginsucess')),d=!0;else{if(e)return;e=!0,b&&b(null)}},fail:function(a){console.log('\u83B7\u53D6openID\u5931\u8D25'+JSON.stringify(a));e||(e=!0,b&&b(null))}})},fail:function(a){console.log(JSON.stringify(a));e||(e=!0,b&&b(null))},complete:function(){console.log('sdk login complete')}})},a.shareMessage=function(a,c,d,e,f,g){b=!0;var h='';for(var i in'function'==typeof f&&(g=f),e||(e={}),(void 0===e.time&&(e.time=new Date().getTime()),e))h.length&&(h+='&'),h+=i+'='+e[i];wx.shareAppMessage({title:a,imageUrl:d,query:h,success:function(a){console.log('\u5206\u4EAB\u6210\u529F'+JSON.stringify(a)),g&&g(!0)},fail:function(a){console.log('\u5206\u4EAB\u5931\u8D25'+JSON.stringify(a)),g&&g(!1)}})},a.invite=function(){},a.getEntryData=function(){var a=wx.getLaunchOptionsSync();return console.log('\u5165\u53E3\u53C2\u6570:'+JSON.stringify(a)),this._entryDataForOptions(a)},a.share=function(a,b,c,d){d&&d()},a.getFriendList=function(a,b){return void(b&&b([]))},a.setTopBarText=function(a,b){wx.setTopBarText({text:a,success:function(a){console.log('\u52A8\u6001\u66F4\u65B0\u6587\u672C\u6210\u529F:'+JSON.stringify(a)),b&&b()},fail:function(a){console.log('\u52A8\u6001\u66F4\u65B0\u6587\u672C\u5931\u8D25:'+JSON.stringify(a)),b&&b()}})},a.pay=function(b,c){var d=a.systemInfo.platform,e=!1;'ios'==d?e=!0:'devtools'==d&&(e=-1!=a.systemInfo.model.indexOf('iPhone'));var f=e?'iap':'android',g=e?'1450013234':'1450013233',h={mode:'game',env:0,offerId:g,buyQuantity:parseFloat(b.num),zoneId:'4',currencyType:'CNY',platform:f,success:function(a){console.log('\u652F\u4ED8\u6210\u529F\uFF1A'+a.errMsg+'/'+a.errCode),c&&c(0,a.errMsg)},fail:function(a){console.log('\u652F\u4ED8\u5931\u8D25\uFF1A'+a.errMsg+'/'+a.errCode),c&&c(a.errCode,a.errMsg)},complete:function(){}};console.log(JSON.stringify(h)),wx.requestMidasPayment(h)},a._lastEntryData='',a._entryDataForOptions=function(a){var b=a.query,c=a.scene,d=JSON.stringify(b);this._lastEntryData=d;var e=!1;for(var f in b)if('time'!=f){e=!0;break}return e||1044!==c||void 0===b.time?b:{type:'group'}},a.reportUserData=function(){},a.setOnShowCallback=function(b){a.onShowCallback=b},a.setOnHideCallback=function(b){a.onHideCallback=b},a.reportLogin=function(c,d){console.log('openID:'+d),wx.postMessage({type:'openid',data:d}),wx.gameLoginReport({data:{gameVersion:3,roleName:c,roleId:d+''},success:function(a){console.log('\u767B\u5165\u4E0A\u62A5\u6210\u529F'+JSON.stringify(a))},fail:function(a){console.log('\u767B\u5165\u4E0A\u62A5\u5931\u8D25'+JSON.stringify(a))}});var e=this;wx.onShow&&wx.onShow(function(f){console.log('onShow \u5165\u53E3\u53C2\u6570:'+JSON.stringify(f));var g=e._entryDataForOptions(f);b=!1,console.log('-- wx.onShow--entryData:'+g),a.onShowCallback&&a.onShowCallback.apply(a,[g]),wx.gameLoginReport({data:{gameVersion:3,roleName:c,roleId:d},success:function(a){console.log('\u767B\u5165\u4E0A\u62A5\u6210\u529F'+JSON.stringify(a))},fail:function(a){console.log('\u767B\u5165\u4E0A\u62A5\u5931\u8D25'+JSON.stringify(a))}})}),wx.onHide&&wx.onHide(function(){console.log('--wx.onHide'),a.onHideCallback&&a.onHideCallback(),wx.gameLogoutReport({data:{gameVersion:3,roleName:c,roleId:d},success:function(a){console.log('\u767B\u51FA\u4E0A\u62A5\u6210\u529F'+JSON.stringify(a))},fail:function(a){console.log('\u767B\u51FA\u4E0A\u62A5\u5931\u8D25'+JSON.stringify(a))}})})},a.setZiyuVisibility=function(a){a?wx.postMessage({type:'show'}):wx.postMessage({type:'hide'})},a.possMessage=function(a){wx.postMessage(a)},a.getLocalStorage=function(a){var b;try{b=wx.getStorageSync(a)}catch(a){return''}return b},a.setLocalStorage=function(a,b){try{wx.setStorageSync(a,b)}catch(a){}},a.wxtriggerGC=function(){console.log('\u5F00\u59CB \u8C03\u7528\u817E\u8BAF\u7684GC\u56DE\u6536');try{wx.triggerGC()}catch(a){console.log('\u8C03\u7528\u817E\u8BAF\u7684GC\u56DE\u6536 \u5931\u8D25:'+a)}},a.setTopBarText('\u5FEB\u6765\uFF0C\u9694\u58C1\u8001\u6BCD\u732A\u6B63\u5728\u5077\u5403\u4F60\u7684\u841D\u535C\uFF01'),window.SDKInterface=a})(); 
 			});
 		define("main.js", function(require, module, exports){ 			
!function(e){function t(){var e=w.pop();return e||(e=new f),e}function n(e){w.push(e)}function s(e,t){var i=e._minX<t._minX?e._minX:t._minX,n=e._minY<t._minY?e._minY:t._minY;return((e._maxX>t._maxX?e._maxX:t._maxX)-i)*((e._maxY>t._maxY?e._maxY:t._maxY)-n)}function r(e){var t,i,n,s,r,a,o=1,h=l.Node._performStacks[l.Node._performing];for(h||(h=[],l.Node._performStacks.push(h)),h.length=0,l.Node._performing++,h[0]=e;o;)if(o--,n=h[o],h[o]=null,n){if((t=n._children)&&t.length>0)for(s=n._renderCmd,r=0,a=t.length;r<a;++r)i=t[r],h[o]=i,o++,i._renderCmd.transform(s);var d=n._protectedChildren;if(d&&d.length>0)for(s=n._renderCmd,r=0,a=d.length;r<a;++r)i=d[r],h[o]=i,o++,i._renderCmd.transform(s)}l.Node._performing--}function a(e,t){e.shaderProgram=t;var i=e.children;if(i)for(var n=0;n<i.length;n++)a(i[n],t)}function o(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(i){var n,s,r,a,o,h,l,d="",c=0;for(i=t(i);c<i.length;)a=(n=i.charCodeAt(c++))>>2,o=(3&n)<<4|(s=i.charCodeAt(c++))>>4,h=(15&s)<<2|(r=i.charCodeAt(c++))>>6,l=63&r,isNaN(s)?h=l=64:isNaN(r)&&(l=64),d=d+e.charAt(a)+e.charAt(o)+e.charAt(h)+e.charAt(l);return d},this.decode=function(t){var n,s,r,a,o,h,l="",d=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<t.length;)n=e.indexOf(t.charAt(d++))<<2|(a=e.indexOf(t.charAt(d++)))>>4,s=(15&a)<<4|(o=e.indexOf(t.charAt(d++)))>>2,r=(3&o)<<6|(h=e.indexOf(t.charAt(d++))),l+=String.fromCharCode(n),64!=o&&(l+=String.fromCharCode(s)),64!=h&&(l+=String.fromCharCode(r));return l=i(l)};var t=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},i=function(e){var t,i,n,s="",r=0;for(t=i=0;r<e.length;)(t=e.charCodeAt(r))<128?(s+=String.fromCharCode(t),r++):t>191&&t<224?(i=e.charCodeAt(r+1),s+=String.fromCharCode((31&t)<<6|63&i),r+=2):(i=e.charCodeAt(r+1),n=e.charCodeAt(r+2),s+=String.fromCharCode((15&t)<<12|(63&i)<<6|63&n),r+=3);return s}}function h(e){l.view.adjustViewPort(!0),l.view.setOrientation(l.ORIENTATION_LANDSCAPE),l.view.setDesignResolutionSize(1136,640,l.ResolutionPolicy.EXACT_FIT),l.director.getRunningScene()||qi.sceneWithLoadingLogo([],we.INVALIDE);var t=0,i=function(){Ql.loadFromServer(function(n){if(n){var s=++t>3?6:0;ju.Retry(n,i,s)}else{Ql.sendFriendsToServer(),l.log("login ok"),l.director.getScheduler().schedule(Ql.update,Ql,1,l.REPEAT_FOREVER,0,!1,"heartbeat update");var r=wr.getModel();e&&e.diamond&&(r.rewardDim=e.diamond);var a=function(){l.addTimePoint("GO_MAIN_S");var e=Ht,t=we.MAIN,i=l.game.entryData;if(i){t=we.WAIT,e=[];var n=setInterval(function(){l.spriteFrameCache.getSpriteFrame("btn_blue_s.png")&&(clearInterval(n),i.mess?qi.preloadWithMessData(i.mess):qi.sceneWithLoadingLogo(Ht,we.MAIN))},50)}qi.sceneWithLoadingLogo(e,t)};lp&&"function"==typeof SDKInterface.startGame?SDKInterface.startGame(function(){a()}):a()}})};i(),l.addTimePoint("clearAll"),lp&&(SDKInterface.setOnShowCallback&&SDKInterface.setOnShowCallback(l.game.onShow.bind(l.game)),SDKInterface.setOnHideCallback&&SDKInterface.setOnHideCallback(l.game.onHide.bind(l.game)))}var l=window.cc||{};window.cc=l,l._tmp=l._tmp||{},l._LogInfos={},l.timePoints=[],l.addTimePoint=function(e){var t=(new Date).getTime();l.timePoints.push(e),l.timePoints[e]=t},l.printTimePoint=function(e,t){if(e&&t)console.log(e,"-----",t,l.timePoints[t]-l.timePoints[e]);else if(e)console.log(e,l.timePoints[e]-l.timePoints[0]);else{e=l.timePoints[0];for(var i=0;i<l.timePoints.length;++i)t=l.timePoints[i],console.log("------",t,l.timePoints[t]-l.timePoints[e])}},l.addTimePoint("start");var d=window;d.gl,d.WebGLRenderingContext,d.DeviceOrientationEvent,d.DeviceMotionEvent,d.AudioContext,d.AudioContext||d.webkitAudioContext,d.mozAudioContext,(d=Object.prototype)._super,d.ctor,d=null,l._drawingUtil=null,l._renderContext=null,l._supportRender=!1,l._canvas=null,l.container=null,l._gameDiv=null,window.ENABLE_IMAEG_POOL=!0,l.each=function(e,t,i){if(e)if(e instanceof Array){for(var n=0,s=e.length;n<s;n++)if(!1===t.call(i,e[n],n))return}else for(var r in e)if(!1===t.call(i,e[r],r))return},l.extend=function(e){var t=arguments.length>=2?Array.prototype.slice.call(arguments,1):[];return l.each(t,function(t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}),e},l.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new i,e.prototype.constructor=e},l.isFunction=function(e){return"function"==typeof e},l.isNumber=function(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)},l.isString=function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},l.isArray=function(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===Object.prototype.toString.call(e)},l.isUndefined=function(e){return void 0===e},l.isObject=function(e){return"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)},l.isCrossOrigin=function(e){if(!e)return l.log("invalid URL"),!1;var t=e.indexOf("://");if(-1===t)return!1;var i=e.indexOf("/",t+3);return(-1===i?e:e.substring(0,i))!==location.origin},l.AsyncPool=function(e,t,i,n,s){var r=this;r._finished=!1,r._srcObj=e,r._limit=t,r._pool=[],r._iterator=i,r._iteratorTarget=s,r._onEnd=n,r._onEndTarget=s,r._results=e instanceof Array?[]:{},r._errors=e instanceof Array?[]:{},l.each(e,function(e,t){r._pool.push({index:t,value:e})}),r.size=r._pool.length,r.finishedSize=0,r._workingSize=0,r._limit=r._limit||r.size,r.onIterator=function(e,t){r._iterator=e,r._iteratorTarget=t},r.onEnd=function(e,t){r._onEnd=e,r._onEndTarget=t},r._handleItem=function(){var e=this;if(!(0===e._pool.length||e._workingSize>=e._limit)){var t=e._pool.shift(),i=t.value,n=t.index;e._workingSize++,e._iterator.call(e._iteratorTarget,i,n,function(t,i){if(!e._finished)if(t?e._errors[this.index]=t:e._results[this.index]=i,e.finishedSize++,e._workingSize--,e.finishedSize===e.size||e._errors.length>0){var n=0===e._errors.length?null:e._errors;e.onEnd(n,e._results)}else e._handleItem()}.bind(t),e)}},r.flow=function(){var e=this;if(0!==e._pool.length)for(var t=0;t<e._limit;t++)e._handleItem();else e._onEnd&&e._onEnd.call(e._onEndTarget,null,[])},r.onEnd=function(e,t){if(r._finished=!0,r._onEnd){var i=r._onEnd,n=r._onEndTarget;r._onEnd=null,r._onEndTarget=null,i.call(n,e,t)}}},l.async={series:function(e,t,i){var n=new l.AsyncPool(e,1,function(e,t,n){e.call(i,n)},t,i);return n.flow(),n},parallel:function(e,t,i){var n=new l.AsyncPool(e,0,function(e,t,n){e.call(i,n)},t,i);return n.flow(),n},waterfall:function(e,t,i){var n=[],s=[null],r=new l.AsyncPool(e,1,function(t,r,a){n.push(function(t){n=Array.prototype.slice.call(arguments,1),e.length-1===r&&(s=s.concat(n)),a.apply(null,arguments)}),t.apply(i,n)},function(e){if(t)return e?t.call(i,e):void t.apply(i,s)});return r.flow(),r},map:function(e,t,i,n){var s=t;"object"==typeof t&&(i=t.cb,n=t.iteratorTarget,s=t.iterator);var r=new l.AsyncPool(e,0,s,i,n);return r.flow(),r},mapLimit:function(e,t,i,n,s){var r=new l.AsyncPool(e,t,i,n,s);return r.flow(),r}},l.path={normalizeRE:/[^\.\/]+\/\.\.\//,join:function(){for(var e=arguments.length,t="",i=0;i<e;i++)t=(t+(""===t?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return t},extname:function(e){var t=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(e);return t?t[1]:null},mainFileName:function(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(0,t)}return e},basename:function(e,t){var i=e.indexOf("?");i>0&&(e=e.substring(0,i));var n=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(e.replace(/(\/|\\\\)$/,""));if(!n)return null;var s=n[2];return t&&e.substring(e.length-t.length).toLowerCase()===t.toLowerCase()?s.substring(0,s.length-t.length):s},dirname:function(e){return e.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(e,t){t=t||"";var i=e.indexOf("?"),n="";return i>0&&(n=e.substring(i),e=e.substring(0,i)),(i=e.lastIndexOf("."))<0?e+t+n:e.substring(0,i)+t+n},changeBasename:function(e,t,i){if(0===t.indexOf("."))return this.changeExtname(e,t);var n=e.indexOf("?"),s="",r=i?this.extname(e):"";return n>0&&(s=e.substring(n),e=e.substring(0,n)),n=e.lastIndexOf("/"),n=n<=0?0:n+1,e.substring(0,n)+t+r+s},_normalize:function(e){var t=e=String(e);do{t=e,e=e.replace(this.normalizeRE,"")}while(t.length!==e.length);return e}};var c={_pool:new Array(10),_MAX:10,_smallImg:"data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=",count:0,get:function(){if(this.count>0){this.count--;var e=this._pool[this.count];return this._pool[this.count]=null,e}return new Image},put:function(e){var t=this._pool;e instanceof HTMLImageElement&&this.count<this._MAX&&(e.src=this._smallImg,t[this.count]=e,this.count++)}};if(l.loader=function(){var e={},t={},i={},n={},s={},r=new RegExp("^(?:https?|ftp)://\\S*$","i");return{resPath:"https://h5-game.feiyuapi.com/qq/",audioPath:"",cache:{},getXMLHttpRequest:function(){var e=new window.XMLHttpRequest;return e.timeout=1e4,void 0===e.ontimeout&&(e._timeoutId=-1),e},_getArgs4Js:function(e){var t=e[0],i=e[1],n=e[2],s=["",null,null];if(1===e.length)s[1]=t instanceof Array?t:[t];else if(2===e.length)"function"==typeof i?(s[1]=t instanceof Array?t:[t],s[2]=i):(s[0]=t||"",s[1]=i instanceof Array?i:[i]);else{if(3!==e.length)throw new Error("arguments error to load js!");s[0]=t||"",s[1]=i instanceof Array?i:[i],s[2]=n}return s},isLoading:function(e){return void 0!==s[e]},loadJs:function(t,i,n){var s=this,r=s._getArgs4Js(arguments),a=r[0],o=r[1],h=r[2];navigator.userAgent.indexOf("Trident/5")>-1?s._loadJs4Dependency(a,o,0,h):l.async.map(o,function(t,i,n){var r=l.path.join(a,t);if(e[r])return n(null);s._createScript(r,!1,n)},h)},loadJsWithImg:function(e,t,i){var n=this,s=(n._loadJsImg(),n._getArgs4Js(arguments));this.loadJs(s[0],s[1],function(e){if(e)throw new Error(e);s[2]&&s[2]()})},_createScript:function(t,i,n){return e[t]=!0,window.createJs(t),void(n&&n())},_loadJs4Dependency:function(e,t,i,n){if(i>=t.length)n&&n();else{var s=this;s._createScript(l.path.join(e,t[i]),!1,function(r){if(r)return n(r);s._loadJs4Dependency(e,t,i+1,n)})}},_loadJsImg:function(){var e=document.getElementById("cocos2d_loadJsImg");return e||(e=document.createElement("img"),l._loadingImage&&(e.src=l._loadingImage),window.canvas.style.backgroundColor="transparent"),null},loadTxt:function(e,t){if(l._isNodeJs)require("fs").readFile(e,function(e,i){e?t(e):t(null,i.toString())});else{var i=this.getXMLHttpRequest(),n="load "+e+" failed!";i.open("GET",e,!0),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(i.setRequestHeader("Accept-Charset","utf-8"),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?t(null,i.responseText):t({status:i.status,errorMessage:n},null))}):(i.overrideMimeType&&i.overrideMimeType("text/plain; charset=utf-8"),i.onload=function(){i._timeoutId>=0&&clearTimeout(i._timeoutId),4===i.readyState&&(200===i.status?t(null,i.responseText):t({status:i.status,errorMessage:n},null))},i.onerror=function(){t({status:i.status,errorMessage:n},null)},void 0===i.ontimeout&&(i._timeoutId=setTimeout(function(){i.ontimeout()},i.timeout)),i.ontimeout=function(){t({status:i.status,errorMessage:"Request timeout: "+n},null)}),i.send(null)}},loadCsb:function(e,t){var i=l.loader.getXMLHttpRequest(),n="load "+e+" failed!";i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){i._timeoutId>=0&&clearTimeout(i._timeoutId);var e=i.response;e&&(window.msg=e),4===i.readyState&&(200===i.status?t(null,i.response):t({status:i.status,errorMessage:n},null))},i.onerror=function(){t({status:i.status,errorMessage:n},null)},void 0===i.ontimeout&&(i._timeoutId=setTimeout(function(){i.ontimeout()},i.timeout)),i.ontimeout=function(){t({status:i.status,errorMessage:"Request timeout: "+n},null)},i.send(null)},loadJson:function(e,t){this.loadTxt(e,function(i,n){if(i)t(i);else{try{var s=JSON.parse(n)}catch(t){throw new Error("parse json ["+e+"] failed : "+t)}t(null,s)}})},_checkIsImageURL:function(e){return null!=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(e)},loadImg:function(e,t,i,n){var r={isCrossOrigin:!0};void 0!==i?r.isCrossOrigin=void 0===t.isCrossOrigin?r.isCrossOrigin:t.isCrossOrigin:void 0!==t&&(i=t);var a=this.getRes(e);if(a)return i&&i(null,a),null;var o=s[e];if(o)return o.callbacks.push(i),o.img;n=n||c.get(),r.isCrossOrigin&&"file://"!==location.origin?n.crossOrigin="Anonymous":n.crossOrigin=null;var h=function(){this.removeEventListener("load",h,!1),this.removeEventListener("error",u,!1);var t=s[e];if(t){for(var i=t.callbacks,r=0;r<i.length;++r){var a=i[r];a&&a(null,n)}t.img=null,delete s[e]}ENABLE_IMAEG_POOL&&l._renderType===l.game.RENDER_TYPE_WEBGL&&c.put(n)},d=this,u=function(){if(this.removeEventListener("load",h,!1),this.removeEventListener("error",u,!1),"https:"!==window.location.protocol&&n.crossOrigin&&"anonymous"===n.crossOrigin.toLowerCase())r.isCrossOrigin=!1,d.release(e),l.loader.loadImg(e,r,i,n);else{var t=s[e];if(t){for(var a=t.callbacks,o=0;o<a.length;++o){var p=a[o];p&&p("load image failed")}t.img=null,delete s[e]}l._renderType===l.game.RENDER_TYPE_WEBGL&&c.put(n)}};return s[e]={img:n,callbacks:i?[i]:[]},n.addEventListener("load",h),n.addEventListener("error",u),n.src=e,n},_loadResIterator:function(e,i,n){var s=this,a=null,o=e.type;o?(o="."+o.toLowerCase(),a=e.src?e.src:e.name+o):(a=e,o=l.path.extname(a));var h=a;a=a.replace(s._hasVerReg,"");var d=s.getRes(a);if(d)return n(null,d);var c=null;if(o&&(c=t[o.toLowerCase()]),!c)return l.error("loader for ["+o+"] not exists!"),n();if(!r.test(h)){var u=c.getBasePath?c.getBasePath():s.resPath;h=s.getUrl(u,h)}l.game.config.noCache&&"string"==typeof h&&(s._noCacheRex.test(h)?h+="&_t="+(new Date-0):h+="?_t="+(new Date-0)),c.load(h,a,e,function(e,t){e?(l.log(e),s.cache[a]=null,delete s.cache[a],n({status:520,errorMessage:e},null)):(s.cache[a]=t,n(null,t))})},_hasVerReg:/\?v=\d+$/,_noCacheRex:/\?/,getUrl:function(e,n){var s=this,r=l.path;if(void 0!==e&&void 0===n){n=e;var a=r.extname(n);a=a?a.toLowerCase():"";var o=t[a];e=o&&o.getBasePath?o.getBasePath():s.resPath}if((n=l.path.join(e||"",n)).match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(i[n])return i[n];var h=r.extname(n)||"";n=i[n]=n.substring(0,n.length-h.length)+"_"+l.sys.language+h}return n},load:function(e,t,i){var n=this,s=arguments.length;if(0===s)throw new Error("arguments error!");3===s?"function"==typeof t&&(t="function"==typeof i?{trigger:t,cb:i}:{cb:t,cbTarget:i}):2===s?"function"==typeof t&&(t={cb:t}):1===s&&(t={}),e instanceof Array||(e=[e]);var r=new l.AsyncPool(e,l.CONCURRENCY_HTTP_REQUEST_COUNT,function(e,i,s,r){n._loadResIterator(e,i,function(e){var i=Array.prototype.slice.call(arguments,1);t.trigger&&t.trigger.call(t.triggerTarget,i[0],r.size,r.finishedSize),s(e,i[0])})},t.cb,t.cbTarget);return r.flow(),r},_handleAliases:function(e,t){var i=[];for(var s in e){var r=e[s];n[s]=r,i.push(r)}this.load(i,t)},loadAliases:function(e,t){var i=this,n=i.getRes(e);n?i._handleAliases(n.filenames,t):i.load(e,function(e,n){i._handleAliases(n[0].filenames,t)})},register:function(e,i){if(e&&i){if("string"==typeof e)return t[e.trim().toLowerCase()]=i;for(var n=0,s=e.length;n<s;n++)t["."+e[n].trim().toLowerCase()]=i}},getRes:function(e){return this.cache[e]||this.cache[n[e]]},_getAliase:function(e){return n[e]},releaseAllAudio:function(){var e,t=this.cache,i=[];for(var n in t)".mp3"!==(e=l.path.extname(n))&&".wav"!==e&&".ogg"!==e||i.push(n);for(var s in i)this.release(i[s])},release:function(e){var t=this.cache,i=s[e];i&&(i.img=null,delete s[e]),delete t[e],delete t[n[e]],delete n[e]},releaseAll:function(){var e=this.cache;for(var t in e)delete e[t];for(var t in n)delete n[t]}}}(),l.formatStr=function(){var e=arguments,t=e.length;if(t<1)return"";var i=e[0],n=!0;"object"==typeof i&&(n=!1);for(var s=1;s<t;++s){var r=e[s];if(n)for(;;){if("number"==typeof r&&i.match(/(%d)|(%s)/)){i=i.replace(/(%d)|(%s)/,r);break}i.match(/%s/)?i=i.replace(/%s/,r):i+="    "+r;break}else i+="    "+r}return i},function(){function e(e){var t=l.game.CONFIG_KEY,i=parseInt(e[t.renderMode])||0;(isNaN(i)||i>2||i<0)&&(e[t.renderMode]=0),l._renderType=l.game.RENDER_TYPE_CANVAS,l._supportRender=!1,0===i?l.sys.capabilities.opengl?(l._renderType=l.game.RENDER_TYPE_WEBGL,l._supportRender=!0):l.sys.capabilities.canvas&&(l._renderType=l.game.RENDER_TYPE_CANVAS,l._supportRender=!0):1===i&&l.sys.capabilities.canvas?(l._renderType=l.game.RENDER_TYPE_CANVAS,l._supportRender=!0):2===i&&l.sys.capabilities.opengl&&(l._renderType=l.game.RENDER_TYPE_WEBGL,l._supportRender=!0)}function t(e,i,n){if(o[i])return null;n=n||"";var s=[],r=e[i];if(!r)throw new Error("can not find module ["+i+"]");for(var a=l.path,h=0,d=r.length;h<d;h++){var c=r[h];if(!o[c]){var u=a.extname(c);if(u)".js"===u.toLowerCase()&&s.push(a.join(n,c));else{var p=t(e,c,n);p&&(s=s.concat(p))}o[c]=1}}return s}function i(e){l._initDebugSetting&&l._initDebugSetting(e[l.game.CONFIG_KEY.debugMode]),l._engineLoaded=!0,console.log(l.ENGINE_VERSION),d&&d()}function n(e){var n=l.game.CONFIG_KEY,s=e[n.engineDir],r=l.loader;if(l.Class)i(e);else{var a=l.path.join(s,"moduleConfig.json");r.loadJson(a,function(n,r){if(n)throw new Error(n);var a=e.modules||[],o=r.module,h=[];l.sys.capabilities.opengl&&a.indexOf("base4webgl")<0?a.splice(0,0,"base4webgl"):a.indexOf("core")<0&&a.splice(0,0,"core");for(var d=0,c=a.length;d<c;d++){var u=t(o,a[d],s);u&&(h=h.concat(u))}l.loader.loadJsWithImg(h,function(t){if(t)throw t;i(e)})})}}function s(){this.removeEventListener("load",s,!1),n(l.game.config)}var r=document.createElement("canvas"),a=document.createElement("canvas");l.create3DContext=function(e,t){for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,s=0;s<i.length;++s){try{n=e.getContext(i[s],t)}catch(e){}if(n)break}return n};!function(){l.sys={};var e=l.sys;e.LANGUAGE_ENGLISH="en",e.LANGUAGE_CHINESE="zh",e.LANGUAGE_FRENCH="fr",e.LANGUAGE_ITALIAN="it",e.LANGUAGE_GERMAN="de",e.LANGUAGE_SPANISH="es",e.LANGUAGE_DUTCH="du",e.LANGUAGE_RUSSIAN="ru",e.LANGUAGE_KOREAN="ko",e.LANGUAGE_JAPANESE="ja",e.LANGUAGE_HUNGARIAN="hu",e.LANGUAGE_PORTUGUESE="pt",e.LANGUAGE_ARABIC="ar",e.LANGUAGE_NORWEGIAN="no",e.LANGUAGE_POLISH="pl",e.LANGUAGE_UNKNOWN="unkonwn",e.OS_IOS="iOS",e.OS_ANDROID="Android",e.OS_WINDOWS="Windows",e.OS_MARMALADE="Marmalade",e.OS_LINUX="Linux",e.OS_BADA="Bada",e.OS_BLACKBERRY="Blackberry",e.OS_OSX="OS X",e.OS_WP8="WP8",e.OS_WINRT="WINRT",e.OS_UNKNOWN="Unknown",e.UNKNOWN=-1,e.WIN32=0,e.LINUX=1,e.MACOS=2,e.ANDROID=3,e.IPHONE=4,e.IPAD=5,e.BLACKBERRY=6,e.NACL=7,e.EMSCRIPTEN=8,e.TIZEN=9,e.WINRT=10,e.WP8=11,e.MOBILE_BROWSER=100,e.DESKTOP_BROWSER=101,e.BROWSER_TYPE_WECHAT="wechat",e.BROWSER_TYPE_ANDROID="androidbrowser",e.BROWSER_TYPE_IE="ie",e.BROWSER_TYPE_QQ_APP="qq",e.BROWSER_TYPE_QQ="qqbrowser",e.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",e.BROWSER_TYPE_UC="ucbrowser",e.BROWSER_TYPE_360="360browser",e.BROWSER_TYPE_BAIDU_APP="baiduboxapp",e.BROWSER_TYPE_BAIDU="baidubrowser",e.BROWSER_TYPE_MAXTHON="maxthon",e.BROWSER_TYPE_OPERA="opera",e.BROWSER_TYPE_OUPENG="oupeng",e.BROWSER_TYPE_MIUI="miuibrowser",e.BROWSER_TYPE_FIREFOX="firefox",e.BROWSER_TYPE_SAFARI="safari",e.BROWSER_TYPE_CHROME="chrome",e.BROWSER_TYPE_LIEBAO="liebao",e.BROWSER_TYPE_QZONE="qzone",e.BROWSER_TYPE_SOUGOU="sogou",e.BROWSER_TYPE_UNKNOWN="unknown",e.isNative=!1;var t=window,i=t.navigator,n=document,s=n.documentElement,o=i.userAgent.toLowerCase();e.isMobile=/mobile|android|iphone|ipad/.test(o),e.platform=e.isMobile?e.MOBILE_BROWSER:e.DESKTOP_BROWSER;var h=i.language;h=(h=h||i.browserLanguage)?h.split("-")[0]:e.LANGUAGE_ENGLISH,e.language=h;var d=!1,c=!1,u="",p=0,m=/android (\d+(?:\.\d+)+)/i.exec(o)||/android (\d+(?:\.\d+)+)/i.exec(i.platform);m&&(d=!0,u=m[1]||"",p=parseInt(u)||0),(m=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(o))?(c=!0,u=m[2]||"",p=parseInt(u)||0):/(iPhone|iPad|iPod)/.exec(i.platform)&&(c=!0,u="",p=0);var _=e.OS_UNKNOWN;-1!==i.appVersion.indexOf("Win")?_=e.OS_WINDOWS:c?_=e.OS_IOS:-1!==i.appVersion.indexOf("Mac")?_=e.OS_OSX:-1!==i.appVersion.indexOf("X11")&&-1===i.appVersion.indexOf("Linux")?_=e.OS_UNIX:d?_=e.OS_ANDROID:-1!==i.appVersion.indexOf("Linux")&&(_=e.OS_LINUX),e.os=_,e.osVersion=u,e.osMainVersion=p,e.browserType=e.BROWSER_TYPE_UNKNOWN,function(){var t=/qqbrowser|qq|chrome|safari|firefox|opr|oupeng|opera/i,i=/micromessenger|mqqbrowser|sogou|qzone|liebao|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|trident|miuibrowser/i.exec(o);i||(i=t.exec(o));var n=i?i[0]:e.BROWSER_TYPE_UNKNOWN;"micromessenger"===n?n=e.BROWSER_TYPE_WECHAT:"safari"===n&&d?n=e.BROWSER_TYPE_ANDROID:"trident"===n?n=e.BROWSER_TYPE_IE:"360 aphone"===n?n=e.BROWSER_TYPE_360:"mxbrowser"===n?n=e.BROWSER_TYPE_MAXTHON:"opr"===n&&(n=e.BROWSER_TYPE_OPERA),e.browserType=n}(),e.browserVersion="",function(){var t=/(mqqbrowser|micromessenger|sogou|qzone|liebao|maxthon|mxbrowser|baidu)(mobile)?(browser)?\/?([\d.]+)/i,i=/(msie |rv:|firefox|chrome|ucbrowser|qq|oupeng|opera|opr|safari|miui)(mobile)?(browser)?\/?([\d.]+)/i,n=o.match(t);n||(n=o.match(i)),e.browserVersion=n?n[4]:""}();var g=window.innerWidth||document.documentElement.clientWidth,T=window.innerHeight||document.documentElement.clientHeight,f=window.devicePixelRatio||1;if(e.windowPixelResolution={width:f*g,height:f*T},e._checkWebGLRenderMode=function(){if(l._renderType!==l.game.RENDER_TYPE_WEBGL)throw new Error("This feature supports WebGL render mode only.")},e._supportCanvasNewBlendModes=function(){var e=r;e.width=1,e.height=1;var t=e.getContext("2d");t.fillStyle="#000",t.fillRect(0,0,1,1),t.globalCompositeOperation="multiply";var i=a;i.width=1,i.height=1;var n=i.getContext("2d");return n.fillStyle="#fff",n.fillRect(0,0,1,1),t.drawImage(i,0,0,1,1),0===t.getImageData(0,0,1,1).data[0]}(),l.sys.isMobile){var S=document.createElement("style");S.type="text/css",document.body.appendChild(S),S.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}try{var w=e.localStorage=t.localStorage;w.setItem("storage",""),w.removeItem("storage"),w=null}catch(t){var v=function(){l.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option")};e.localStorage={getItem:v,setItem:v,removeItem:v,clear:v}}var L=!!r.getContext("2d"),M=!1;if(t.WebGLRenderingContext){var C=document.createElement("CANVAS");try{if(l.create3DContext(C)&&(M=!0),M&&e.os===e.OS_IOS&&9===e.osMainVersion&&(window.indexedDB||(M=!1)),M&&e.os===e.OS_ANDROID){var y=parseFloat(e.browserVersion);switch(e.browserType){case e.BROWSER_TYPE_MOBILE_QQ:case e.BROWSER_TYPE_BAIDU:case e.BROWSER_TYPE_BAIDU_APP:M=y>=6.2;break;case e.BROWSER_TYPE_CHROME:M=y>=30;break;case e.BROWSER_TYPE_ANDROID:e.osMainVersion&&e.osMainVersion>=5&&(M=!0);break;case e.BROWSER_TYPE_UNKNOWN:case e.BROWSER_TYPE_360:case e.BROWSER_TYPE_MIUI:case e.BROWSER_TYPE_UC:M=!1}}}catch(e){}C=null}var B=e.capabilities={canvas:L,opengl:M};(void 0!==s.ontouchstart||void 0!==n.ontouchstart||i.msPointerEnabled)&&(B.touches=!0),void 0!==s.onmouseup&&(B.mouse=!0),void 0!==s.onkeyup&&(B.keyboard=!0),(t.DeviceMotionEvent||t.DeviceOrientationEvent)&&(B.accelerometer=!0),e.garbageCollect=function(){},e.dumpRoot=function(){},e.restartVM=function(){},e.cleanScript=function(e){},e.isObjectValid=function(e){return!!e},e.dump=function(){var e=this,t="";t+="isMobile : "+e.isMobile+"\r\n",t+="language : "+e.language+"\r\n",t+="browserType : "+e.browserType+"\r\n",t+="browserVersion : "+e.browserVersion+"\r\n",t+="capabilities : "+JSON.stringify(e.capabilities)+"\r\n",t+="os : "+e.os+"\r\n",t+="osVersion : "+e.osVersion+"\r\n",t+="platform : "+e.platform+"\r\n",t+="Using "+(l._renderType===l.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",l.log(t)},e.openURL=function(e){window.open(e)},e.now=function(){return Date.now?Date.now():+new Date}}(),r=null,a=null,l.log=l.warn=l.error=l.assert=function(){};var o={},h=!1,d=null;l._engineLoaded=!1,l.initEngine=function(t,i){if(h){var r=d;d=function(){r&&r(),i&&i()}}else d=i,!l.game.config&&t?l.game.config=t:l.game.config||l.game._loadConfig(),e(t=l.game.config),document.body?n(t):l._addEventListener(window,"load",s,!1),h=!0}}(),l.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",EVENT_RESIZE:"game_on_resize",EVENT_RENDERER_INITED:"renderer_inited",RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,_eventHide:null,_eventShow:null,CONFIG_KEY:{width:"width",height:"height",engineDir:"engineDir",modules:"modules",debugMode:"debugMode",exposeClassName:"exposeClassName",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList"},_paused:!0,_configLoaded:!1,_prepareCalled:!1,_prepared:!1,_rendererInitialized:!1,_renderContext:null,_intervalId:null,_lastTime:null,_frameTime:null,frame:null,container:null,canvas:null,config:null,onStart:null,onStop:null,setFrameRate:function(e){var t=this;t.config[t.CONFIG_KEY.frameRate]=e,t._intervalId&&window.cancelAnimationFrame(t._intervalId),t._intervalId=0,t._paused=!0,t._setAnimFrame(),t._runMainLoop()},step:function(){l.director.mainLoop()},pause:function(){this._paused||(this._paused=!0,l.audioEngine&&l.audioEngine._pausePlaying(),this._intervalId&&window.cancelAnimationFrame(this._intervalId),this._intervalId=0)},resume:function(){this._paused&&(this._paused=!1,l.audioEngine&&l.audioEngine._resumePlaying(),this._runMainLoop())},isPaused:function(){return this._paused},restart:function(){l.director.popToSceneStackLevel(0),l.audioEngine&&l.audioEngine.end(),l.eventManager.setEnabled(!1),setTimeout(function(){l.game.onStart()},150)},end:function(){close()},prepare:function(e){var t=this,i=t.config,n=t.CONFIG_KEY;if(this._configLoaded){if(this._prepared)e&&e();else if(!this._prepareCalled)if(l._engineLoaded){this._prepareCalled=!0,this._initRenderer(i[n.width],i[n.height]),l.view=l.EGLView._getInstance(),l.director=l.Director._getInstance(),l.director.setOpenGLView&&l.director.setOpenGLView(l.view),l.winSize=l.director.getWinSize(),this._initEvents(),this._setAnimFrame(),this._runMainLoop();var s=i[n.jsList];s?l.loader.loadJsWithImg(s,function(i){if(i)throw new Error(i);t._prepared=!0,e&&e()}):e&&e()}else l.initEngine(this.config,function(){t.prepare(e)})}else this._loadConfig(function(){t.prepare(e)})},run:function(e,t){"function"==typeof e?l.game.onStart=e:(e&&("string"==typeof e?(l.game.config||this._loadConfig(),l.game.config[l.game.CONFIG_KEY.id]=e):l.game.config=e),"function"==typeof t&&(l.game.onStart=t)),this.prepare(l.game.onStart&&l.game.onStart.bind(l.game))},_setAnimFrame:function(){this._lastTime=new Date;var e=l.game.config[l.game.CONFIG_KEY.frameRate];this._frameTime=1e3/e,60!==e&&30!==e?(window.requestAnimFrame=this._stTime,window.cancelAnimationFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(e){var t=(new Date).getTime(),i=Math.max(0,l.game._frameTime-(t-l.game._lastTime)),n=window.setTimeout(function(){e()},i);return l.game._lastTime=t+i,n},_ctTime:function(e){window.clearTimeout(e)},_runMainLoop:function(){var e,t=this,i=t.config,n=t.CONFIG_KEY,s=l.director,r=!0,a=i[n.frameRate];s.setDisplayStats(i[n.showFPS]),e=function(){if(!t._paused){if(30===a&&(r=!r))return void(t._intervalId=window.requestAnimFrame(e));s.mainLoop(),t._intervalId=window.requestAnimFrame(e)}},t._intervalId=window.requestAnimFrame(e),t._paused=!1},_loadConfig:function(e){var t=this.config||document.ccConfig;if(t)this._initConfig(t),e&&e();else{for(var i=[],n=0;n<i.length;n++){var s=i[n].getAttribute("cocos");if(""===s||s)break}var r,a,o=this,h=function(t,i){var n=JSON.parse(i);o._initConfig(n),e&&e()};n<i.length&&((r=i[n].src)&&(a=/(.*)\//.exec(r)[0],l.loader.resPath=a,r=l.path.join(a,"project.json")),l.loader.loadTxt(r,h)),l.loader.loadTxt(l.path.join(l.loader.resPath,"project.json"),h)}},_initConfig:function(e){var t=this.CONFIG_KEY,i=e[t.modules];e[t.showFPS]=void 0===e[t.showFPS]||e[t.showFPS],e[t.engineDir]=e[t.engineDir]||"frameworks/cocos2d-html5",null==e[t.debugMode]&&(e[t.debugMode]=0),e[t.exposeClassName]=!!e[t.exposeClassName],e[t.frameRate]=e[t.frameRate]||60,null==e[t.renderMode]&&(e[t.renderMode]=0),null==e[t.registerSystemEvent]&&(e[t.registerSystemEvent]=!0),i&&i.indexOf("core")<0&&i.splice(0,0,"core"),i&&(e[t.modules]=i),this.config=e,this._configLoaded=!0},_initRenderer:function(e,t){if(!this._rendererInitialized){if(!l._supportRender)throw new Error("The renderer doesn't support the renderMode "+this.config[this.CONFIG_KEY.renderMode]);this.config[l.game.CONFIG_KEY.id];var i,n,s=window,r=s.canvas;"CANVAS"===r.tagName?(e=e||r.width,t=t||r.height,this.canvas=l._canvas=i=r,this.container=l.container=n=document.createElement("DIV"),i.parentNode&&i.parentNode.insertBefore(n,i)):("DIV"!==r.tagName&&l.log("Warning: target element is not a DIV or CANVAS"),e=e||r.clientWidth,t=t||r.clientHeight,this.canvas=l._canvas=i=l.$(document.createElement("CANVAS")),this.container=l.container=n=document.createElement("DIV"),r.appendChild(n)),n.setAttribute("id","Cocos2dGameContainer"),n.appendChild(i),this.frame=n.parentNode===document.body?document.documentElement:n.parentNode,i.setAttribute("width",e||480),i.setAttribute("height",t||320),i.setAttribute("tabindex",99),l._renderType===l.game.RENDER_TYPE_WEBGL&&(this._renderContext=l._renderContext=l.webglContext=l.create3DContext(i,{stencil:!0,alpha:!1,preserveDrawingBuffer:!0})),this._renderContext?(l.renderer=l.rendererWebGL,s.gl=this._renderContext,l.renderer.init(),l._drawingUtil=new l.DrawingPrimitiveWebGL(this._renderContext),l.textureCache._initializingRenderer(),l.glExt={},l.glExt.instanced_arrays=s.gl.getExtension("ANGLE_instanced_arrays"),l.glExt.element_uint=s.gl.getExtension("OES_element_index_uint")):(l._renderType=l.game.RENDER_TYPE_CANVAS,l.renderer=l.rendererCanvas,this._renderContext=l._renderContext=new l.CanvasContextWrapper(i.getContext("2d")),l._drawingUtil=l.DrawingPrimitiveCanvas?new l.DrawingPrimitiveCanvas(this._renderContext):null),l._gameDiv=n,l.game.canvas.oncontextmenu=function(){if(!l._isContextMenuEnable)return!1},this.dispatchEvent(this.EVENT_RENDERER_INITED,!0),this._rendererInitialized=!0}},_initEvents:function(){var e,t=window;this._eventHide=this._eventHide||new l.EventCustom(this.EVENT_HIDE),this._eventHide.setUserData(this),this._eventShow=this._eventShow||new l.EventCustom(this.EVENT_SHOW),this._eventShow.setUserData(this),this.config[this.CONFIG_KEY.registerSystemEvent]&&l.inputManager.registerSystemEvent(this.canvas),l.isUndefined(document.hidden)?l.isUndefined(document.mozHidden)?l.isUndefined(document.msHidden)?l.isUndefined(document.webkitHidden)||(e="webkitHidden"):e="msHidden":e="mozHidden":e="hidden";var i=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"],n=function(){l.eventManager&&l.game._eventHide&&l.eventManager.dispatchEvent(l.game._eventHide)},s=function(){l.eventManager&&l.game._eventShow&&l.eventManager.dispatchEvent(l.game._eventShow)};if(e)for(var r=0;r<i.length;r++)document.addEventListener(i[r],function(t){var i=document[e];(i=i||t.hidden)?n():s()},!1);else t.addEventListener("blur",n,!1),t.addEventListener("focus",s,!1);navigator.userAgent.indexOf("MicroMessenger")>-1&&(t.onfocus=function(){s()}),"onpageshow"in window&&"onpagehide"in window&&(t.addEventListener("pagehide",n,!1),t.addEventListener("pageshow",s,!1)),l.eventManager.addCustomListener(l.game.EVENT_HIDE,function(){l.game.pause()}),l.eventManager.addCustomListener(l.game.EVENT_SHOW,function(){l.game.resume()})}},Function.prototype.bind=Function.prototype.bind||function(e){if(!l.isFunction(this))throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),i=this,n=function(){},s=function(){return i.apply(this instanceof n&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,s.prototype=new n,s},l.EventHelper=function(){},l.EventHelper.prototype={constructor:l.EventHelper,apply:function(e){e.addEventListener=l.EventHelper.prototype.addEventListener,e.hasEventListener=l.EventHelper.prototype.hasEventListener,e.removeEventListener=l.EventHelper.prototype.removeEventListener,e.dispatchEvent=l.EventHelper.prototype.dispatchEvent},addEventListener:function(e,t,i){if("load"===e&&this._textureLoaded)setTimeout(function(){t.call(i)},0);else{void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),this.hasEventListener(e,t,i)||n[e].push({callback:t,eventTarget:i})}},hasEventListener:function(e,t,i){if(void 0===this._listeners)return!1;var n=this._listeners;if(void 0!==n[e])for(var s=0,r=n.length;s<r;s++){var a=n[s];if(a.callback===t&&a.eventTarget===i)return!0}return!1},removeEventListener:function(e,t,i){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n)for(var s=0;s<n.length;){var r=n[s];r.eventTarget===i&&r.callback===t?n.splice(s,1):s++}}},removeEventTarget:function(e,t,i){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n)for(var s=0;s<n.length;)n[s].eventTarget===i?n.splice(s,1):s++}},dispatchEvent:function(e,t){if(void 0!==this._listeners){null==t&&(t=!0);var i=this._listeners[e];if(void 0!==i){for(var n=[],s=i.length,r=0;r<s;r++)n[r]=i[r];for(r=0;r<s;r++)n[r].callback.call(n[r].eventTarget,this);t&&(i.length=0)}}}},l.EventHelper.prototype.apply(l.game),l._LogInfos={ActionManager_addAction:"cc.ActionManager.addAction(): action must be non-null",ActionManager_removeAction:"cocos2d: removeAction: Target not found",ActionManager_removeActionByTag:"cc.ActionManager.removeActionByTag(): an invalid tag",ActionManager_removeActionByTag_2:"cc.ActionManager.removeActionByTag(): target must be non-null",ActionManager_getActionByTag:"cc.ActionManager.getActionByTag(): an invalid tag",ActionManager_getActionByTag_2:"cocos2d : getActionByTag(tag = %s): Action not found",configuration_dumpInfo:"cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from ccConfig.js)",configuration_loadConfigFile:"Expected 'data' dict, but not found. Config file: %s",configuration_loadConfigFile_2:"Please load the resource first : %s",Director_resume:"cocos2d: Director: Error in gettimeofday",Director_setProjection:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel_2:"cocos2d: Director: Error in gettimeofday",Director_popScene:"running scene should not null",Director_pushScene:"the scene should not null",arrayVerifyType:"element type is wrong!",Scheduler_scheduleCallbackForTarget:"CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",Scheduler_scheduleCallbackForTarget_2:"cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",Scheduler_scheduleCallbackForTarget_3:"cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",Scheduler_pauseTarget:"cc.Scheduler.pauseTarget():target should be non-null",Scheduler_resumeTarget:"cc.Scheduler.resumeTarget():target should be non-null",Scheduler_isTargetPaused:"cc.Scheduler.isTargetPaused():target should be non-null",Node_getZOrder:"getZOrder is deprecated. Please use getLocalZOrder instead.",Node_setZOrder:"setZOrder is deprecated. Please use setLocalZOrder instead.",Node_getRotation:"RotationX != RotationY. Don't know which one to return",Node_getScale:"ScaleX != ScaleY. Don't know which one to return",Node_addChild:"An Node can't be added as a child of itself.",Node_addChild_2:"child already added. It can't be added again",Node_addChild_3:"child must be non-null",Node_removeFromParentAndCleanup:"removeFromParentAndCleanup is deprecated. Use removeFromParent instead",Node_boundingBox:"boundingBox is deprecated. Use getBoundingBox instead",Node_removeChildByTag:"argument tag is an invalid tag",Node_removeChildByTag_2:"cocos2d: removeChildByTag(tag = %s): child not found!",Node_removeAllChildrenWithCleanup:"removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",Node_stopActionByTag:"cc.Node.stopActionBy(): argument tag an invalid tag",Node_getActionByTag:"cc.Node.getActionByTag(): argument tag is an invalid tag",Node_resumeSchedulerAndActions:"resumeSchedulerAndActions is deprecated, please use resume instead.",Node_pauseSchedulerAndActions:"pauseSchedulerAndActions is deprecated, please use pause instead.",Node__arrayMakeObjectsPerformSelector:"Unknown callback function",Node_reorderChild:"cc.Node.reorderChild(): child must be non-null",Node_reorderChild_2:"cc.Node.reorderChild(): this child is not in children list",Node_runAction:"cc.Node.runAction(): action must be non-null",Node_schedule:"callback function must be non-null",Node_schedule_2:"interval must be positive",Node_initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",AtlasNode_updateAtlasValues:"cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",AtlasNode_initWithTileFile:"",AtlasNode__initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",_EventListenerKeyboard_checkAvailable:"cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",_EventListenerTouchOneByOne_checkAvailable:"cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",_EventListenerTouchAllAtOnce_checkAvailable:"cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",_EventListenerAcceleration_checkAvailable:"cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil",EventListener_create:"Invalid parameter.",__getListenerID:"Don't call this method if the event is for touch.",eventManager__forceAddEventListener:"Invalid scene graph priority!",eventManager_addListener:"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",eventManager_removeListeners:"Invalid listener type!",eventManager_setPriority:"Can't set fixed priority with scene graph based listener.",eventManager_addListener_2:"Invalid parameters.",eventManager_addListener_3:"listener must be a cc.EventListener object when adding a fixed priority listener",eventManager_addListener_4:"The listener has been registered, please don't register it again.",LayerMultiplex_initWithLayers:"parameters should not be ending with null in Javascript",LayerMultiplex_switchTo:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_switchToAndReleaseMe:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_addLayer:"cc.Layer.addLayer(): layer should be non-null",EGLView_setDesignResolutionSize:"Resolution not valid",EGLView_setDesignResolutionSize_2:"should set resolutionPolicy",inputManager_handleTouchesBegin:"The touches is more than MAX_TOUCHES, nUnusedIndex = %s",swap:"cc.swap is being modified from original macro, please check usage",checkGLErrorDebug:"WebGL error %s",animationCache__addAnimationsWithDictionary:"cocos2d: cc.AnimationCache: No animations were found in provided dictionary.",animationCache__addAnimationsWithDictionary_2:"cc.AnimationCache. Invalid animation format",animationCache_addAnimations:"cc.AnimationCache.addAnimations(): File could not be found",animationCache__parseVersion1:"cocos2d: cc.AnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion1_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache__parseVersion1_3:"cocos2d: cc.AnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",animationCache__parseVersion1_4:"cocos2d: cc.AnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",animationCache__parseVersion2:"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion2_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache_addAnimations_2:"cc.AnimationCache.addAnimations(): Invalid texture file name",Sprite_ignoreAnchorPointForPosition:"cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",Sprite_setDisplayFrameWithAnimationName:"cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",Sprite_setDisplayFrameWithAnimationName_2:"cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",Sprite_setDisplayFrame:"setDisplayFrame is deprecated, please use setSpriteFrame instead.",Sprite__updateBlendFunc:"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",Sprite_initWithSpriteFrame:"cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",Sprite_initWithSpriteFrameName:"cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",Sprite_initWithSpriteFrameName1:" is null, please check.",Sprite_initWithFile:"cc.Sprite.initWithFile(): filename should be non-null",Sprite_setDisplayFrameWithAnimationName_3:"cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",Sprite_addChild:"cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",Sprite_addChild_2:"cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",Sprite_addChild_3:"cc.Sprite.addChild(): child should be non-null",Sprite_setTexture:"cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",Sprite_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_4:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_5:"cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",Sprite_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",Sprite_setSpriteFrame:"Invalid spriteFrameName",Sprite_setTexture_2:"Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",Sprite_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",Sprite_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",SpriteBatchNode_addSpriteWithoutQuad:"cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",SpriteBatchNode_increaseAtlasCapacity:"cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",SpriteBatchNode_increaseAtlasCapacity_2:"cocos2d: WARNING: Not enough memory to resize the atlas",SpriteBatchNode_reorderChild:"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",SpriteBatchNode_removeChild:"cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",SpriteBatchNode_addSpriteWithoutQuad_2:"cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",SpriteBatchNode_reorderChild_2:"cc.SpriteBatchNode.addChild(): child should be non-null",spriteFrameCache__getFrameConfig:"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",spriteFrameCache_addSpriteFrames:"cocos2d: WARNING: an alias with name %s already exists",spriteFrameCache__checkConflict:"cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",spriteFrameCache_getSpriteFrame:"cocos2d: cc.SpriteFrameCahce: Frame %s not found",spriteFrameCache__getFrameConfig_2:"Please load the resource first : %s",spriteFrameCache_addSpriteFrames_2:"cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",spriteFrameCache_addSpriteFrames_3:"Argument must be non-nil",CCSpriteBatchNode_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_addChild:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",CCSpriteBatchNode_addChild_2:"cc.Sprite.addChild(): child should be non-null",CCSpriteBatchNode_setSpriteFrame:"Invalid spriteFrameName",CCSpriteBatchNode_setTexture:"Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",CCSpriteBatchNode_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_addChild_3:"cc.SpriteBatchNode.addChild(): child should be non-null",TextureAtlas_initWithFile:"cocos2d: Could not open file: %s",TextureAtlas_insertQuad:"cc.TextureAtlas.insertQuad(): invalid totalQuads",TextureAtlas_initWithTexture:"cc.TextureAtlas.initWithTexture():texture should be non-null",TextureAtlas_updateQuad:"cc.TextureAtlas.updateQuad(): quad should be non-null",TextureAtlas_updateQuad_2:"cc.TextureAtlas.updateQuad(): Invalid index",TextureAtlas_insertQuad_2:"cc.TextureAtlas.insertQuad(): Invalid index",TextureAtlas_insertQuads:"cc.TextureAtlas.insertQuad(): Invalid index + amount",TextureAtlas_insertQuadFromIndex:"cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",TextureAtlas_insertQuadFromIndex_2:"cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",TextureAtlas_removeQuadAtIndex:"cc.TextureAtlas.removeQuadAtIndex(): Invalid index",TextureAtlas_removeQuadsAtIndex:"cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",TextureAtlas_moveQuadsFromIndex:"cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",TextureAtlas_moveQuadsFromIndex_2:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",TextureAtlas_moveQuadsFromIndex_3:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex",textureCache_addPVRTCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_addETCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_textureForKey:"textureForKey is deprecated. Please use getTextureForKey instead.",textureCache_addPVRImage:"addPVRImage does not support on HTML5",textureCache_addUIImage:"cocos2d: Couldn't add UIImage in TextureCache",textureCache_dumpCachedTextureInfo:"cocos2d: '%s' id=%s %s x %s",textureCache_dumpCachedTextureInfo_2:"cocos2d: '%s' id= HTMLCanvasElement %s x %s",textureCache_dumpCachedTextureInfo_3:"cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",textureCache_addUIImage_2:"cc.Texture.addUIImage(): image should be non-null",Texture2D_initWithETCFile:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData:"initWithPVRTCData does not support on HTML5",Texture2D_addImage:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithImage:"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",Texture2D_initWithImage_2:"cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",Texture2D_initWithString:"initWithString isn't supported on cocos2d-html5",Texture2D_initWithETCFile_2:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile_2:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData_2:"initWithPVRTCData does not support on HTML5",Texture2D_bitsPerPixelForFormat:"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",Texture2D__initPremultipliedATextureWithImage:"cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",Texture2D_addImage_2:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithData:"NSInternalInconsistencyException",MissingFile:"Missing file: %s",radiansToDegress:"cc.radiansToDegress() should be called cc.radiansToDegrees()",RectWidth:"Rect width exceeds maximum margin: %s",RectHeight:"Rect height exceeds maximum margin: %s",EventManager__updateListeners:"If program goes here, there should be event in dispatch.",EventManager__updateListeners_2:"_inDispatch should be 1 here."},l._logToWebPage=function(e){if(l._canvas){var t=l._logList,i=document;if(!t){var n=i.createElement("Div"),s=n.style;n.setAttribute("id","logInfoDiv"),l._canvas.parentNode.appendChild(n),n.setAttribute("width","200"),n.setAttribute("height",l._canvas.height),s.zIndex="99999",s.position="absolute",s.top="0",s.left="0";var r=(t=l._logList=i.createElement("textarea")).style;t.setAttribute("rows","20"),t.setAttribute("cols","30"),t.setAttribute("disabled",!0),n.appendChild(t),r.backgroundColor="transparent",r.borderBottom="1px solid #cccccc",r.borderRightWidth="0px",r.borderLeftWidth="0px",r.borderTopWidth="0px",r.borderTopStyle="none",r.borderRightStyle="none",r.borderLeftStyle="none",r.padding="0px",r.margin=0}t.value=t.value+e+"\r\n",t.scrollTop=t.scrollHeight}},l._formatString=function(e){if(!l.isObject(e))return e;try{return JSON.stringify(e)}catch(e){return""}},l._initDebugSetting=function(e){var t=l.game;if(e!==t.DEBUG_MODE_NONE){var i;e>t.DEBUG_MODE_ERROR?(i=l._logToWebPage.bind(l),l.error=function(){i("ERROR :  "+l.formatStr.apply(l,arguments))},l.assert=function(e,t){if(!e&&t){for(var n=2;n<arguments.length;n++)t=t.replace(/(%s)|(%d)/,l._formatString(arguments[n]));i("Assert: "+t)}},e!==t.DEBUG_MODE_ERROR_FOR_WEB_PAGE&&(l.warn=function(){i("WARN :  "+l.formatStr.apply(l,arguments))}),e===t.DEBUG_MODE_INFO_FOR_WEB_PAGE&&(l.log=function(){i(l.formatStr.apply(l,arguments))})):console&&console.log.apply&&(l.error=Function.prototype.bind.call(console.error,console),console.assert?l.assert=Function.prototype.bind.call(console.assert,console):l.assert=function(e,t){if(!e&&t){for(var i=2;i<arguments.length;i++)t=t.replace(/(%s)|(%d)/,l._formatString(arguments[i]));throw new Error(t)}},e!==t.DEBUG_MODE_ERROR&&(l.warn=Function.prototype.bind.call(console.warn,console)),e===t.DEBUG_MODE_INFO&&(l.log=Function.prototype.bind.call(console.log,console)))}},l.loader.loadBinary=function(e,t){var i=this,n=this.getXMLHttpRequest(),s="load "+e+" failed!";n.open("GET",e,!0),l.loader.loadBinary._IEFilter?(n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var e=l._convertResponseBodyToText(n.responseBody);t(null,i._str2Uint8Array(e))}else t(s)}):(n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.onload=function(){4===n.readyState&&200===n.status?t(null,i._str2Uint8Array(n.responseText)):t(s)}),n.send(null)},l.loader.loadBinary._IEFilter=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&window.IEBinaryToArray_ByteStr&&window.IEBinaryToArray_ByteStr_Last,l.loader._str2Uint8Array=function(e){if(!e)return null;for(var t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=255&e.charCodeAt(i);return t},l.loader.loadBinarySync=function(e){var t=this,i=this.getXMLHttpRequest();i.timeout=0;var n="load "+e+" failed!";i.open("GET",e,!1);var s=null;if(l.loader.loadBinary._IEFilter){if(i.setRequestHeader("Accept-Charset","x-user-defined"),i.send(null),200!==i.status)return l.log(n),null;var r=l._convertResponseBodyToText(i.responseBody);r&&(s=t._str2Uint8Array(r))}else{if(i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.send(null),200!==i.status)return l.log(n),null;s=this._str2Uint8Array(i.responseText)}return s},window.Uint8Array=window.Uint8Array||window.Array,l.loader.loadBinary._IEFilter){var u='\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = ""\r\n   End If\r\nEnd Function\r\n',p=document.createElement("script");p.type="text/vbscript",p.textContent=u,document.body.appendChild(p),l._convertResponseBodyToText=function(e){for(var t={},i=0;i<256;i++)for(var n=0;n<256;n++)t[String.fromCharCode(i+256*n)]=String.fromCharCode(i)+String.fromCharCode(n);var s=IEBinaryToArray_ByteStr(e),r=IEBinaryToArray_ByteStr_Last(e);return s.replace(/[\s\S]/g,function(e){return t[e]})+r}}var l=l||{};l._loadingImage="data:image/gif;base64,R0lGODlhEAAQALMNAD8/P7+/vyoqKlVVVX9/fxUVFUBAQGBgYMDAwC8vL5CQkP///wAAAP///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAANACwAAAAAEAAQAAAEO5DJSau9OOvNex0IMnDIsiCkiW6g6BmKYlBFkhSUEgQKlQCARG6nEBwOgl+QApMdCIRD7YZ5RjlGpCUCACH5BAUAAA0ALAAAAgAOAA4AAAQ6kLGB0JA4M7QW0hrngRllkYyhKAYqKUGguAws0ypLS8JxCLQDgXAIDg+FRKIA6v0SAECCBpXSkstMBAAh+QQFAAANACwAAAAACgAQAAAEOJDJORAac6K1kDSKYmydpASBUl0mqmRfaGTCcQgwcxDEke+9XO2WkxQSiUIuAQAkls0n7JgsWq8RACH5BAUAAA0ALAAAAAAOAA4AAAQ6kMlplDIzTxWC0oxwHALnDQgySAdBHNWFLAvCukc215JIZihVIZEogDIJACBxnCSXTcmwGK1ar1hrBAAh+QQFAAANACwAAAAAEAAKAAAEN5DJKc4RM+tDyNFTkSQF5xmKYmQJACTVpQSBwrpJNteZSGYoFWjIGCAQA2IGsVgglBOmEyoxIiMAIfkEBQAADQAsAgAAAA4ADgAABDmQSVZSKjPPBEDSGucJxyGA1XUQxAFma/tOpDlnhqIYN6MEAUXvF+zldrMBAjHoIRYLhBMqvSmZkggAIfkEBQAADQAsBgAAAAoAEAAABDeQyUmrnSWlYhMASfeFVbZdjHAcgnUQxOHCcqWylKEohqUEAYVkgEAMfkEJYrFA6HhKJsJCNFoiACH5BAUAAA0ALAIAAgAOAA4AAAQ3kMlJq704611SKloCAEk4lln3DQgyUMJxCBKyLAh1EMRR3wiDQmHY9SQslyIQUMRmlmVTIyRaIgA7",l._fpsImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD9qabkAAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfcAgcQLxxUBNp/AAAQZ0lEQVR42u2be3QVVZbGv1N17829eRLyIKAEOiISEtPhJTJAYuyBDmhWjAEx4iAGBhxA4wABbVAMWUAeykMCM+HRTcBRWkNH2l5moS0LCCrQTkYeQWBQSCAIgYRXEpKbW/XNH5zS4noR7faPEeu31l0h4dSpvc+t/Z199jkFWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhY/H9D/MR9qfKnLj/00U71aqfJn9+HCkCR/Wk36ddsgyJ/1wF4fkDfqqm9/gPsUeTnVr6a2xlQfnxdI7zs0W7irzD17Ytb2WT7EeNv/r4ox1O3Quf2QP2pgt9utwfout4FQE8AVBSlnaRmfvAURQkg2RlAbwB9AThlW5L0GaiKojhJhgOIBqDa7XaPrusdPtr5kQwF0BVAAoBIABRCKDd5aFUhRDAAw57eAOwAhKIoupft3zoqhB1AqLwuHIBut9uFt02qqvqRDJR2dAEQJj/BAOjn56dqmma+xiaECAEQAWAggLsB6A6HQ2iaZggBhBAqgEAAnQB0kzaEmT4hAITT6VQ8Ho/HJAKKECJQtr8LwD1y/A1/vcdfEUIEyfZ9AcQbYvZ942Px88L2UwlJR0dH0EMPPbRj5syZPUeNGrXR7Xb/641xIwJ1XY9NSUlZm52dfW+XLl1w8uRJzJ8//+OGhoYJqqqe1TSt1Wsm9NN1PSIqKmr12rVrR5WUlHy1bdu2AQCumWc3IYRD1/UwVVXnFRQUTIuNjUVzczN2797dWFJSkq8oymZd15sAGAEnFEUJ1nX9nzIzM1dnZmZGh4SE4OTJk5g5c+Zf29vbp9pstrMej6fVOyhIhgAYU1hY+B+hoaGoqKg4XVlZea+XTULTNFdCQsLGiRMnPuR2u3UhBOV9eeDAAWXTpk095DUe6WsoyRE5OTlr0tLSAux2O/bs2cO5c+e+pijKUpIXSHaQVAGkvPLKK++6XK4OksJLCFlXV2cvKSlJBFAjhU+x2WwhHo9nUHp6+urMzMy7wsLCUF9fjxdffPHjxsbGiTab7WuPx9NiEutOuq4PyMjI+M+srKyYqKgoHD58GDNmzNjq8XhyVFU9b/q+LH7hBAEYu3PnTlZVVRFAGgCX6f/tAHoOHDjwa0p27txp/JO9e/f+QM7cipw9nfL3kQBKt2zZQpJ87rnn6mQmoHilw2EACs+cOUOSrK+vZ1NTE0nyo48+IoBpxswoBcMJ4Ndjx471kOTFixe5d+9ekqTH42H//v13A4jyzpAURfEH0H/OnDnthu1z5sw558MmFUCPWbNmnaMP3nrrLZoyDmP8Hl68eDFJ8siRI9/Yc+zYMQKYKdtAztrTrl27xptRXV1NAKMAOAyBBBA/Y8aMdpLs6Ojgxx9//E37+++//29yvFXppwvAwMcee8xjtDHsuXLlCqOjo//ia3wsfpkoALqFhoZuIckJEyackimm3dQmEMDUmpoakmRISMhhAHOHDx/eQJIbN24kgKEyMAHAFRMTs2XXrl1saWkhSZ0kp0+ffhrAr3wEW/S8efOukORLL72kA1gKYMPWrVtJkk899dRJAHeYrgsEsIQkjx8/TgDvAPjd448/3kaSb7zxBmUa7vC6z53BwcFbSHL9+vU6Sc6aNes8gF5ewWAH0PfVV18lSQL4DMBGIcQ6AKtcLleBFC2jXtFt8ODBe0iyoqKCAJYByC8qKmJDQwOzsrK+MAmqo1OnTveHhoa+GRkZ+XZkZOSWiIiIvzgcjk9mzpypkWRmZuZpmbYbGV4AgPnNzc1sa2sjgN0A5iQmJtaSZHl5OQHcb/K3s81mW0uSTU1NBFAFYFbfvn1Pk+Tbb79NAA8IIVzW42/hByA+Pz/fLR/2ZXIda05NI/z9/TeR5J49ewhgqlxTrtI0jY2NjQQw3zTLuWJiYjaUlJToS5Ys6fjkk080kwDEeAmADcA9GzZsIElGRUW9CyAWwLApU6Y0kOSKFSsog9QICGdERMTGsrIyZmVlEcC9AB4IDw/fTpLbtm0jgN94CUAnAJmVlZVcs2aNZ/LkyRdJcvbs2b4EwAkgZfPmzTxw4AABFAN4BkC6vFeUSewcAO5duXIlSTIhIaEawGMAxgKYAmAGgCS73e5vrKVk/yGythANYEhCQsIhkly+fDkBpKqqGmL6DgIALDKN/3yZpVWQZGVlJQE8aPI3KiMjo5okV61aRQAjAPQBMPfIkSN0u90EUCBtsPiFEwpgbn19PdetW2fM5N4zQ9ekpKQqkty0aRMBpMjiWM6JEydIkoqirJUFJ6iq6pAPVy8A6cZMehMBUACEuVyuFwG8HBwcPEIWx367ZMkSjSQXLVrUJouTRorrkAHdA8BdQogsAOsKCwtJkmPGjDkvMw2bDDo/ADEjRoz4XylyFbm5uY0mAbjLyyZ/AOOrq6tZVlbWsWDBgo69e/eyoqKCgwcPPg4gSQaoIRbp27dvN7KF+tLSUr28vJwFBQXtMpvpYRIM7+wrAkDeqVOnePbsWQIoNKfzpiXPg8uXLydJJicnNwF4f+nSpW6STEtLq5fjYwhk1wkTJtSQ5Ouvv04AqTKj+N2xY8dIkgEBAW/Ie1v8wncRegwZMmQvSfbr12+3Ua33WqPfOWbMmP0kWVpaSgCDZAqcfejQIWNZsEGKgvnh9gfQb9myZd8nAEJVVZtMkUNk8CcNHTq0liR1XWdYWNhmH1mJIme80OnTp18x1rp5eXkEsNJms92Fb7e/IgEsvHz5Mp999tkmAI/l5uZeMC0B7vEqqAYAyL106RJJsra2lpWVld+sucePH38ZQG+5NncBeOrgwYMkqbe3t/Po0aOsra011wAWyl0H7x0JJ4DE+fPnu0kyPT29DsDdUrBuyNKEEAkAdpw/f/6GeoEM8GUmfwEgPCIiopwkGxsbabPZPgOw6L777vvm4p49e26VGYjFLxUhhD+ApLKyMp44ccIoVnXybgbgzkcfffRzklyzZg0BDJYCMMmoCwQFBXkLgLGWvvcWAgBToSsKwNPTp09vMR7UuLi4rwH0lgU8c/Db5ezbeeTIkRWzZ8++aMxu+fn5BPCADBwHgP4LFy701NXVEUAJgAnPP/98kyxMNgHo53A4zH77BQQETMvPz7+Um5vbBuAlAFMSExPPmdbVL0qh8Acw8fDhw5SCchVAEYAVb775JknyhRdeaJYztHfxMwLAaqNwCGC2FArv8x0hAHKNLGPKlCme5OTk/Zs3bzb7O0wKiiG8KXl5ed8IxenTp0mSR48e1UmyW7duWywBuD2xyQcgFECgoih+8H1gyJgZV5Lkyy+/3CbTRIePtl2HDBmyw1QBHyGDdXZdXR1JUghRKkXBjOMHCoBdpr0L3nvvPZLkF198wejo6O0A4lVVDTb74HQ6AwD8Wq7Jh8rgGgDgQ13XjVR8qaxJuADMbmlpYXl5uV5UVNRWUFDgfv/993Vj/ZydnU1c37eHXML4S3viAcQqitJD2l104cIFY8lTKsXSBWBMVVWVcd9yed2A1NTUQ6Zl00CvLMMOoHdubm6zFIlWOf5+PsY/Kj09vdrU11QAwwGsv3jxIk21m2DZr10I0RXAuAcffPBgaWkpV69eTYfDcdiwUxY0w6xw+flX8L1xApjevXv3lREREaW6rofB93aPDUDQpEmTMgHgtddeqwBwEd/utZvpqK6uPgEAcXFxkA94NwB9unfvjrNnz4LklwDcf08iIqv66Zs2bXrl4YcfxooVKxAbG7uqrq5uAYA2TdOEqqpGYIi2tjbl6aeffu/YsWPv5uTk7JaC1wHg4Pnz542MwoVvTx+21dbWYvjw4WLixIl+2dnZ9lGjRgmSTE1NRUpKCkwFTGiaxtTU1OXTpk3707Bhw/6g67pDipnT4biuj7qut+Lbk3Vf1tTUXI9qu91Pjq1QFEUBgJaWFgBo8yGOQ8eNGxcAAOvXr/8QwBUfYygAKL169eoCABcuXACAWtn2hOGv0+kMNO1KiPDw8F4A4rZv3/7R1KlTR0+bNu1ht9u9r1+/fqitrQXJgwDarRC6/QjPzs4+QJIffPCB9/aQmSAA43ft2mW0e1QGoi8CAPyLsZccExNTC2BlRkbGRdOyYJCP2csBIN6UAZzCd7cBbQCijYp/dXU1ExMTz6SmptaMHj36f9LS0vYlJCRsl6mxIWSdu3fv/g5J7t+/nwC2AShMTk6+SJKff/45AWRLYbD7+fndAeDf5BJnLoCCyZMnt5JkdnZ2C4B/F0KEm1Pu+Pj4rST55ZdfEsBWAK+mpaVdMo3raDn7KwDuSEpK+m+S3LBhAwG8DuCtHTt2UBbpjgC408vvcFVV15HkuXPnjMp+p5uMf0RcXNyHJNnQ0EBVVfcCWBQXF3fG+Jv0yxABPwB5LS0tRmFxN4BlTzzxxGWSXLx4sS5F3GGFy+1Hp5SUlJq6ujoWFxdTpsZ2H+0iIyMj/0iSWVlZX5mr5jfJFroPGzasxlhTnjp1iiTZ3NxMl8tlrCd9pfa9SkpKSJI5OTmnZOageLUZZqxvfVFWVkZcPwdgNwnSCKPqb17jkmR8fPzfZMDZ5CRsFBmNI7h95s2b1yhT7/MAYmStwCx4vy0uLqa3v5qmEcCfvSr1QQAeXb16NY3Cm3HQ55133iGAp+SxZTNhKSkpfzUddkrFjYevzAQCeGjp0qXfsYckY2NjTwD4leGDLCL2HTdunNtoY+zWSHFcIHdsFCtcfuZ1vO9Eqs3m7/F47sb1k2qX/f3997W2tl7BjWfpBYDOzzzzzIVJkyZh0KBBCwEsB3AJvl9AETabLcDj8dwRFRW1ctasWb8JCgpSzp07d62wsPC/Wltb8xRFadR1/ZqPXYbgAQMGbI2Pjw/+6quv9ldVVT0r01ezuPRJSUn5Y9euXXVd11WzDaqq6kePHm3+7LPPRgO4KlNuxWazhXo8nuTk5OSXMjIyEl0uFxoaGtqKior+dPXq1VdUVT0jj7r68ieoT58+vx8yZMjdx48fP1JVVTVF9m20VW02WyfZf97YsWPjXS4X6urqWvPy8jYCWCyEuEDS8FdVFKWzruv//OSTTy5OTk7uqWkaPv3007qysrJ8RVH+LI8ym8/rB3Tu3HnRI488knLo0KG2ffv2ZQI4C98vP6mqqoZqmpaclpa2cOTIkX39/f3R0NDQUVxc/G5TU9PLqqrWa5rWLH1QVFUN0TStX1JSUvH48eP7BwYG4uDBg1cKCgpeBbBe2u+2Qug2EwD5N5sMPuNtMe8XP4TT6Qxoa2sbIGeXvUKIK7d4IISiKC5d1wPljOfA9bPwzYqiXNV13dd6Uqiq6qdpml2mpe02m63d4/G4vcTF5fF47LJf71nJA6BZVVW3pmntuPHlmAD5wk6Q9NnbHp9vHaqq6tA0zU/64PZhk1FfCZB9G/23ALiqKEqzD39tpvbGUqoFwFUhRLP3yzpCCDtJpxyXDulfG27+pqRR3DXsUWVd4Yq0x/taVQjhIhksC8L+ABpM9ljBf5sKwI8pIBr75L5E4vvu+UNeG/a+hv+AL7yFH8qPtOfHjtOP6V/Bja8D6z/B2Nys/1u9Xv33tLf4GfF/LC4GCJwByWIAAAAASUVORK5CYII=",l._loaderImage="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAlAAD/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM4MDBEMDY2QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM4MDBEMDY1QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU2RTk0OEM4OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU2RTk0OEM5OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQADQkJCQoJDQoKDRMMCwwTFhENDREWGhUVFhUVGhkUFhUVFhQZGR0fIB8dGScnKionJzk4ODg5QEBAQEBAQEBAQAEODAwOEA4RDw8RFA4RDhQVERISERUfFRUXFRUfKB0ZGRkZHSgjJiAgICYjLCwoKCwsNzc1NzdAQEBAQEBAQEBA/8AAEQgAyACgAwEiAAIRAQMRAf/EALAAAAEFAQEAAAAAAAAAAAAAAAQAAgMFBgcBAQEAAwEBAAAAAAAAAAAAAAAAAQMEAgUQAAIBAgIEBwoLBgQGAwAAAAECAwAEEQUhMRIGQVFxsTITFGGBwdEiQlKSMzWRoeFicqKyI1NzFYJjJDQWB9KjVCbxwkNkJWXik3QRAAIBAgMFBQcDBQEAAAAAAAABAhEDIRIEMUFRcTJhwVIUBZGhsSJyEzOB0ULhYpIjUxX/2gAMAwEAAhEDEQA/AMJSpUqAVKlXuFAeUq9wpUB5XuFe4V6ooDzZHDox0CnGMinzwl7Z8NajaHeoO3vmTBZBtp9YUIqTEV5ROxHKnWRnaU8VRMhFBUjpV7hSoSeUq9pUB5Sr2lhQHlKvcK8oBV7hSFSRrtaKAZs07YNPM1pG2xJIAw1jSeandry/8X4m8VCKkWwaWwam7Xl/4v1W8VLtmX/i/VbxUoKkWwakSM407tmX/i/VbxUmzGwjQsjdY41IARie/U0IbZO0kNtCXnOCkEBeFu4KI3Bs7DNb27ya+jDx3kJeEnpJJEcQVbWDsk17u5urd591ucZkWhym2Vnd9RkCDEpFxDRpbw0bunu5mlp2De2FMLYXOD2wB2xbOeraUcYGJ72mlSUiqzzdzMd3Z3mixltA2yzcK/NlHM1DQyRXce1HocdNOEfJXZ88y9ZojOqhiBszIRiHQ8Y4cK5TvHuzLljHNMqxNoDjLFraHHnjPxcNCGVbxEUzYNTx5jZSxhpW6qTzlwJ+DCvO2Zf+L9VvFSgqyHYNLYNTdssPxfibxUu15f8Ai/VPiqCakOwa82DU/a8v/F+JvFTDdWPBL8R8VKCvYRYV5UzoMAy6QdIIqI0B4KJtxiRQwou16QoGUkntH5Tz0RbZbmF2hktraSVBo2lUkY8tDye0flPPXTslVUyiyVRsjqUOA4yMT8dW2ram2m6UVTNq9S7EIyUVJydMTn/6DnP+im9Wl+g5z/opvVrpteEhQWY4AaSTwAVf5WPiZh/9S5/zj7zltzlmYWkfWXNvJDGTgGcYDHirR7i7mSbwXParsFMrgb7w6jKw/wCmnc9I14kF3vpvCljbMyWMOJL4aEiB8qU/ObUK7HYWVrl1pFZWiCOCBQqKOLjPGTrNZZqKbUXVHq2nNwTuJRk1VpbgXN8s7Rk5ym0UQQzhIG2NAjhxHWbI+gCBVjBBFbwxwQqEiiUJGg1BVGAFe7dV28WYLYZFmF2Th1UD7JGjymGyn1iK5OyzIBGB1HgrLZhamzumQAGJwSqnSCh1q3GOCodxt4cxurdcpzuN4cyhiWaF5Bg09udUmnWw1H/jV9nFuJ7Quo+8h8peThFA+047vduyMtk7fYqTl07YFdfUufMPzT5p71UdtlmYXaGS2t3mQHAsgxANdadYJopLe4QS2867EsZ4QfCNYrCFbjdDPmgkYyWFxgVf04ifJf6ScNdRUW1XBb6FU5TjF5EpSSrGu/s5lN+g5z/opvVpfoOc/wCim9WtdHnatvObJXDW7xLGhB8nrPaY9/HCr+tEdPCVaSeDoYLnqF63lzW4/PFSW3ecxbI84VSzWUwUaSdg0DXXK5nvAipnd6qgKvWnQO7pri9ZUEmm3Vl2j1kr8pRlFRyquBNZjGxQ/S56Y1S2fu9OVueon11Szahoou06QoQUXadIVCD2FJJ7R+U89dMydv8Axdn+TH9muZye0flPPXQstlK5Tbka1gUjlC1q0vVLkeb6r+O3Tx9xcY1nt8c0NrZCyiOE1108NYjGv1joo7Js1jzKyScYLIvkzL6LDwHXVJksH9Sb49dKNq0tj1jA6uriOCL+02FWX7iVtZX1/AzaHTyeoauKn2MX9W79zebiZCuR5MjSrhfXuEtwTrUeZH+yNfdrRNcxI6IzhXlJEak6WIGJ2Rw4ChWnChndtlVBLMdQA0k1gbXNMzzDfDLs6mjaPKppJbWwJ1bOwwxw43OnHh71YT3DpfWUJmFlb5jHHDdeXBHIsrRea5TSqvxqG04cNN62vetoCS4tre5mgnkGE9q+3DKOkuI2WX6LDQRRHWDh1UCtwj7QRg2wdl8Djgw1qe7XvW0BQ3kfZ7mSLgU+T9E6RVbnuVrnWVSWqj+Lt8ZbRuHEdKPkYVcZ2MJY5fSGyeVar45+rkWQHAqccalPE5km1htWK5nK4Wnt5FuUBUwOMG4nGkA/BXUrW4S6torlOjMgcd/xVn7rLo7zKs0uEjCNeSvdwoBhgsZxX1l2j36k3Lu+uyprdj5Vs5A+i/lD48a0aaVJOPi7jB6lbzWozpjB48pf1NDXNN4vfl7+Z4BXS65pvF78vfzPAK71XTHmZ/S/yT+jvJ7L3fHytz1E+upbL+Qj5W56jfXWRnsIYKLtekKEFGWvSFQgyjk9o/Keet3YthlMP/5x9msJJ7R+U89biyb/AMXEv7gD6tadL1T+kwepRrC39ZkLDMbiwMvUHRPG0bjlGg8ore/23sxBldxfMPLupNhT8yL/AORNZbdzJ484scytxgLqJY5LZj6Q2sV5G1Vud1mjjyG0ij0NEGSZToKyhjtqw4waztuiXA3qKTbSxltfGhbZlE95ZtZqxVbgiOZhrER9ph3Svk9+pJILZ4Y4DGBFCUMKjRsGPobPFhUfW0NJmljE2xJcIrcI2vFUEln1lRXd6lrazXT9GCNpD+yNqoI7mOVduNw6nzlOIoPOUa6yye1XXcbMR5GdQ3xY0BSbj31/FcTQZirJ+q431q7anbHCTZ72Bw7lbPrKBMcBWNNgbMBBh+bsjBdni0VJ1lARZs6yWiupxCuMDy6KpS2IwOo6DTr3Mre3e5tZZVUM4ZBjqOOJoWO4jkXajcOOMHGgDISvWIrdAkKR80+TzVl908bPPL3LzxOuHdifxVfiTAg92qI/w+/8gGgSyN/mR7XPVlp0lF/3L3mbVKtu5Hjbk/8AHE2Fc03i9+Xv5ngFdKNc13i9+Xv5ngFaNV0x5nn+l/kn9HeEWXu+PlbnqJ9dS2Xu9OVueon11kZ7CGCjLXpCgxRlr0hUIPYUcntH5Tz1s8vb+Bt1/dqPirGSe0flPPWusG/g4Py15q06XqlyMWvVYQ+ruI9xJOqzO9hOto/sP8tbGOFIrmWeM7IuMDMnAXXQJOUjQeOsJk0nY96ip0CYunrjaHx1t+srPJUbXBm2LrFPikwTOb+T+VhbZxGMrDXp83x1QSy2tucJpUjPETp+Cn5/ftaRvKvtp3Kx48HG3erHMzOxZiWZtLMdJNQSbbL71Vk6yynViOkqnEEfOWtPbXi3EQkGg6mXiNckjeSJxJGxR10qw0GtxuxmvbImD4CZMFlA4fRfv0BqesqqzTMZNMEDbIHtHH2QeCiZJSqMQdOGiue53mz3czQwsRbIcNHnkec3c4qAMuriz68gTIToxwOOnlp0MjxMJYW741Gs3RVldtbygE/dMcHX/moDaxTiWNZB53B3arb8/wC+4SOF4sf/AKxU9kcBsfOGHfoUHtG/RbzY5Die5HHhXdvavqiZ9Q8Jdlq4/gbKua7xe/L38zwCuhpf2Uk/Zo50kmwJKIdogDjw1VzzeL35e/meAVp1LTgqY4nn+mRauzqmqwrjzCLL3fHytz1E+upLL+Qj5W56jfXWRnroYKLtekKEFF2vSFQg9hSSe0flPPWosm/hIfoLzVl5PaPynnrRWb/w0X0F5q06XqlyM2sVYx5gmbFre/t71NY2T+0h8VbSO5SWNJUOKSAMp7jDGspmMPaLRlXS6eWve1/FRO7WYdbZm1Y/eW/R7qHxHRXGojlm3ulid6aVbaW+OALvgCLq2Hm9WxHKWqjhj6xsK1e8dm15l4niG1LZkswGsxtrPeOmsvayBJA1VItlWjptLuTdPMo7LtjRDq9naK4+WF9IrUW7BaHOljGqVHB7w2hzVoZt87d8vaNYSLl02CcRsDEbJbj71Uu7UBkvJ7/D7q2QoDxySaAO8MTXdxRVMpRp5XZOWdF/ms7R5XdyKfKWJsO/5PhrG5XlNxmEywW6bTnTxAAcJNbGSMXkM1pjgbiNo1PziPJ+Os7u7m/6ReM00ZOgxSpqYYHT3wRXMKN4ll9zUG4bQfNshu8sZVuEA2hirA4qe/VOwwrVbzbww5mI44UKRRYkbWG0S3JWctbd7u5WFfOOLHiUdJqmaipfLsIsObhWe001lMkMVvJNjhghIALMcBxCs7fxXQmkupx1bXDswGPlaTidVaEyKNXkoo4eBV+Sq7L7Vs9zcBgeyQ4GQ/MB1crmoim2orezqcowTuSeEY48jQ7oZX2PLzdyLhNd6RjrEY6I7+uspvH78vfzPAK6UAAAFGAGgAcArmu8Xvy9/M8ArTfio24RW5nnaG67uou3H/KPuqT2X8hHytz1G+upLL3enK3PUb66ys9RDBRdr0hQgou06QqEGUkntH5Tz1e238vF9BeaqKT2j8p56vbb+Xi+gvNWjTdUuRn1XTHmTh8KrJTJlt8t1CPIY44cGnpJVjTJYkmjaN9Ib4u7V923njTethRauZJV3PaW1rfLIiXEDYg6R4VYc9CXW7thfOZbKdbGZtLW8uPVY/u3GrkNUkM9zlcxUjbhfWOA90cRq4gv4LhdqN+VToNYWmnRm9NNVWNTyHc6VWBv8wt4YeHqm6xyPmroq1Z7WGFLSxTq7WLSuPSdjrkfumq5yHXDUeA92oO2SKpVumNAaoJLMXH3myp0rpJ4uKhc3tbDM5BMri1zAj79j7KTiY8TcdBpcsith0286o+sPCagEX9Pzg4zXUCp6QYse8oouCG3tk6m1BYv05W6T+IdyolxbHDAAa2OgDlNCz3ryN2WxBd5PJMg1t81eId2ukqnLlTBbfcuY+9uJLiRcvtPvHdsHK+cfRHcHDWsyawjyy0WBcDI3lTP6TeIcFV+S5OmXx9bJg1048o8Cj0V8Jq2DVu09nL80up7OxHi+oal3P8AXB/IsZS8T/YOV65zvCcc7vfzPAK3ivWCz445zeH954BXOr6I8yfSfyz+jvCLP3fHytz1G+upLP3fHytz1E+usbPaQ0UXadIUIKLtekKhB7Ckk9o/Keer22/l4/oLzVRSe0flPPV7b/y8X0F5q0abqlyM+q6Y8yQsBTDMor1o8aiaE1pbluMqS3sbLLHIhSRQyngqukhaJ9uBjo+H5aOa3ao2t34qouRlLajTalGP8v0IY8ylXQ+PKPFU/bYXOLPge6CKia0LaxTOxHu1Q7cuBd9yPEJ7TbjXKO8CajbMIF6CNIeNvJHjqIWJ7tSpYkalqVblwIdyG+RGXur0hXYJFxal+Dhq5y3slkv3Y2pD0pTr+QUClpJRUdo9XW4OLrTHtM16cZLLWkeC7y4jvlNEpcRtw1Ux27Ci448NZrTFy3nn3IQWxlgGrDZ3pza7/M8ArZo+ArF5171uvp+CqdV0R5l/psUrs2vB3hdl7vTlbnqJ9dS2Xu+PlbnqJ9dY2eshooq16QoQUXa9IVCD2FLJ7RuU89WNtmUSQqkgYMgw0accKrpPaPynnrZWG4Vi+VWmY5tnMWXG+XrIYnA0rhj0mdcTgdNdwnKDqjmduM1SRR/qlr8/4KX6pa8T/BVzDuLZXudRZblmbxXcPUNPc3KqCIwrbOzgrHEnHjoyD+3eSXkht7DeKG4umDGOJVUklfouThXfmbnZ7Cvy1vt9pmv1W1+d8FL9VteJvgq5yrcOGfLmzHN80iyyETPbptAEFo2ZG8pmUa1OFNn3Ky6W/sbDKM5hv5bx2WTZA+7RF2y52WOPJTzE+z2Dy1vt9pT/AKpacTerS/U7Tib1a04/t7kDXPY03jhN0W6sQ7K7W3q2dnrMccaDy/8At80kuZfqWYxWNtlcvUPPhiGYhWDeUy7IwYU8xPs9g8tb7faUn6pacTerTxm9oOBvVq3v9z927aynuId44LiWKNnjhAXF2UYhRg516qpsryjLr21665zFLSTaK9U2GOA87SwqY37knRU+BzOzags0s1Oyr+BKM6sxwP6tSDPLMen6vy0rvdm3Sxlu7K/S7WDDrFUDUTxgnTU826eXW7KlxmqQuwDBXUKcD+1Xee/wXuKX5XDGWLapSVcOyhEM/seJ/V+WnjeGx4pPV+Wkm6kKZlFay3Jlt7iFpYZY8ASVK6DjtDDA0f8A0Tl340/1f8Ndx8xJVWXB0KbktFFpNzdVXAC/qOwA0CQni2flrO3Vwbm5lnI2TKxbDirX/wBE5d+NcfV/wVR7xZPa5U9utvI8nWhmbbw0YEAYYAVxfhfy5rlKR4Fulu6X7mW1mzT8S4Yis/5CPlbnqJ9dSWfu9OVueon11mZvQ2i7XpChKKtekKhBlNJ7R+U89bDfGTb3a3ZX0Lcj6kdY+T2j8p560288m1kWQr6MJ+ylSAr+2cnV5renjs3H1loX+3j9XvbbtxLN9lqW4UnV5jdnjtXHxihtyZNjeSBu5J9k1BJe7xy7W5CJ/wCzuD/mTVTf2+fq97LJuLrPsNRueS7W6aJ/38x+vLVXuY+xvHaNxbf2GoCezf8A36j/APsSf8w1sLnqczTefJluYoLm5uo5F61sBshItP1cNFYe1f8A3ir/APfE/wCZUe9bB94r5jwuPsrQFhmG4l/Z2M17HdW90tuu3IkTHaCjWdIw0VVZdks9/C06yJFEp2dp+E1bbqybGTZ8vpQD7L1XRv8A7blT96Oda7tpNuuNE37Cq9KSisjyuUoxrStKllHbLlWTXsMs8chuSuwEPDqwoLe5y+YRE/gLzmqRekvKKtd4327yM/ulHxmrHJStySWVRyrjxKI2XC/CTlnlPPKTpTdFbP0L1bgrf5Lp0G3dPhQHwV0S1lzBsns3sESR8Crh9WAJGjSOKuU3E+zdZQ3oJh8IArdZXFDmOTpHa3i2+YrI2KtKy4ricBsBuHHgFXSo440+Wa2qqxjvM9uMoy+WvzWpLCWWWE28HxL6e43ojgkeSCBY1Ri5BGIUDT51cl3vm276BBqSEH4WbxV0tlkyXJcxTMb+OW6uY9mGHrCzDQwwAbTp2uKuTZ9N1uYsfRRR8WPhrm419mSSjRyiqxVK7y23B/ftuTm2oSdJyzNVw3BFn7vTlbnqF9dS2fu9OVueon11lZuQ2iLdsGFD05H2dNQGV0ntG5Tz1dWm9N1b2kVq8EVwsI2UaQaQOKhmitZGLOmk68DhSFvY+gfWNSAg7z3Qvo7yKCKIohiaNR5LKxx8qpxvjcqS0VpbxvwOAcRQPZ7D0G9Y0uz2HoH1jUCpLY7zXlpbm3eKO5QuzjrBqZji3x17PvNcyT288VvDBJbMWUovS2hslW7mFQ9nsPQPrGl2ew9A+saCod/WNxtbYsrfb17WBxx5ddD2281xC88klvDcSXEnWuzrqOGGC9zRUPZ7D0G9Y0uzWHoH1jQVCLreq6ntZbaO3it1mGy7RjTs1X2mYy20ZiCq8ZOODcdEdmsPQb1jS7PYegfWNdJuLqnQiSUlRqpFLmryxtH1Ma7Qw2gNNPOdSt0oI27p007s9h6B9Y0uz2HoH1jXX3Z+I4+1b8IJdX89xLHKQFMXQUahpxoiPN5P+onfU+A0/s9h6DesaXZ7D0D6xpG7OLbUtu0StW5JJx2bBsmbtiSiEk+cxoCWWSaVpZOk2vDVo0VYdnsPQb1jSNvZcCH1jSd2c+p1XAmFqEOmOPEfaH+BQd1ueo211IzrgFUYKNAAqI1WztCpUqVCRUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoD/9k=";var l=window.cc||{};window.cc=l,l.defineGetterSetter=function(e,t,i,n,s,r){if(e.__defineGetter__)i&&e.__defineGetter__(t,i),n&&e.__defineSetter__(t,n);else{if(!Object.defineProperty)throw new Error("browser does not support getters");var a={enumerable:!1,configurable:!0};i&&(a.get=i),n&&(a.set=n),Object.defineProperty(e,t,a)}if(!s&&!r)for(var o=null!=i,h=void 0!=n,l=Object.getOwnPropertyNames(e),d=0;d<l.length;d++){var c=l[d];if((e.__lookupGetter__?!e.__lookupGetter__(c):!Object.getOwnPropertyDescriptor(e,c))&&"function"==typeof e[c]){var u=e[c];if(o&&u===i&&(s=c,!h||r))break;if(h&&u===n&&(r=c,!o||s))break}}var p=e.constructor;s&&(p.__getters__||(p.__getters__={}),p.__getters__[s]=t),r&&(p.__setters__||(p.__setters__={}),p.__setters__[r]=t)},l.clone=function(e){var t=e.constructor?new e.constructor:{};for(var i in e){var n=e[i];"object"!=typeof n||!n||n instanceof l.Node||n instanceof HTMLElement?t[i]=n:t[i]=l.clone(n)}return t},l.inject=function(e,t){for(var i in e)t[i]=e[i]};var m={id:0|998*Math.random(),instanceId:0|998*Math.random(),getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}};!function(){var e=/\b_super\b/;l.Class=function(){},l.Class.extend=function(t){var i=this.prototype,n=Object.create(i),s={writable:!0,enumerable:!1,configurable:!0},r,a;r=function(e,t,i,n,s){if(this.__instanceId=m.getNewInstanceId(),this.ctor)switch(arguments.length){case 0:this.ctor();break;case 1:this.ctor(e);break;case 2:this.ctor(e,t);break;case 3:this.ctor(e,t,i);break;case 4:this.ctor(e,t,i,n);break;case 5:this.ctor(e,t,i,n,s);break;default:this.ctor.apply(this,arguments)}},s.value=m.getNewID(),Object.defineProperty(n,"__pid",s),r.prototype=n,s.value=r,Object.defineProperty(n,"constructor",s),this.__getters__&&(r.__getters__=l.clone(this.__getters__)),this.__setters__&&(r.__setters__=l.clone(this.__setters__));for(var o=0,h=arguments.length;o<h;++o){var d=arguments[o];for(var c in d){var u="function"==typeof d[c],p="function"==typeof i[c],_=e.test(d[c]);if(u&&p&&_?(s.value=function(e,t){return function(){var n=this._super;this._super=i[e];var s=t.apply(this,arguments);return this._super=n,s}}(c,d[c]),Object.defineProperty(n,c,s)):u?(s.value=d[c],Object.defineProperty(n,c,s)):n[c]=d[c],u){var g,T,f;if(this.__getters__&&this.__getters__[c]){f=this.__getters__[c];for(var S in this.__setters__)if(this.__setters__[S]===f){T=S;break}l.defineGetterSetter(n,f,d[c],d[T]?d[T]:n[T],c,T)}if(this.__setters__&&this.__setters__[c]){f=this.__setters__[c];for(var S in this.__getters__)if(this.__getters__[S]===f){g=S;break}l.defineGetterSetter(n,f,d[g]?d[g]:n[g],d[c],g,c)}}}}return r.extend=l.Class.extend,r.implement=function(e){for(var t in e)n[t]=e[t]},r}}();var l=l||{};switch(l._tmp=l._tmp||{},l.associateWithNative=function(e,t){},l.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},l.FMT_JPG=0,l.FMT_PNG=1,l.FMT_TIFF=2,l.FMT_RAWDATA=3,l.FMT_WEBP=4,l.FMT_UNKNOWN=5,l.getImageFormatByData=function(e){return e.length>8&&137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]&&13===e[4]&&10===e[5]&&26===e[6]&&10===e[7]?l.FMT_PNG:e.length>2&&(73===e[0]&&73===e[1]||77===e[0]&&77===e[1]||255===e[0]&&216===e[1])?l.FMT_TIFF:l.FMT_UNKNOWN},l.Point=function(e,t){this.x=e||0,this.y=t||0},l.p=function(e,t){return void 0===e?{x:0,y:0}:void 0===t?{x:e.x,y:e.y}:{x:e,y:t}},l.pointEqualToPoint=function(e,t){return e&&t&&e.x===t.x&&e.y===t.y},l.Size=function(e,t){this.width=e||0,this.height=t||0},l.size=function(e,t){return void 0===e?{width:0,height:0}:void 0===t?{width:e.width,height:e.height}:{width:e,height:t}},l.sizeEqualToSize=function(e,t){return e&&t&&e.width===t.width&&e.height===t.height},l.Rect=function(e,t,i,n){this.x=e||0,this.y=t||0,this.width=i||0,this.height=n||0},l.rect=function(e,t,i,n){return void 0===e?{x:0,y:0,width:0,height:0}:void 0===t?{x:e.x,y:e.y,width:e.width,height:e.height}:{x:e,y:t,width:i,height:n}},l.rectEqualToRect=function(e,t){return e&&t&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},l._rectEqualToZero=function(e){return e&&0===e.x&&0===e.y&&0===e.width&&0===e.height},l.rectContainsRect=function(e,t){return!(!e||!t)&&!(e.x>=t.x||e.y>=t.y||e.x+e.width<=t.x+t.width||e.y+e.height<=t.y+t.height)},l.rectGetMaxX=function(e){return e.x+e.width},l.rectGetMidX=function(e){return e.x+e.width/2},l.rectGetMinX=function(e){return e.x},l.rectGetMaxY=function(e){return e.y+e.height},l.rectGetMidY=function(e){return e.y+e.height/2},l.rectGetMinY=function(e){return e.y},l.rectContainsPoint=function(e,t){return t.x>=l.rectGetMinX(e)&&t.x<=l.rectGetMaxX(e)&&t.y>=l.rectGetMinY(e)&&t.y<=l.rectGetMaxY(e)},l.rectIntersectsRect=function(e,t){var i=e.x+e.width,n=e.y+e.height,s=t.x+t.width,r=t.y+t.height;return!(i<t.x||s<e.x||n<t.y||r<e.y)},l.rectOverlapsRect=function(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)},l.rectUnion=function(e,t){var i=l.rect(0,0,0,0);return i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i.width=Math.max(e.x+e.width,t.x+t.width)-i.x,i.height=Math.max(e.y+e.height,t.y+t.height)-i.y,i},l.rectIntersection=function(e,t){var i=l.rect(Math.max(l.rectGetMinX(e),l.rectGetMinX(t)),Math.max(l.rectGetMinY(e),l.rectGetMinY(t)),0,0);return i.width=Math.min(l.rectGetMaxX(e),l.rectGetMaxX(t))-l.rectGetMinX(i),i.height=Math.min(l.rectGetMaxY(e),l.rectGetMaxY(t))-l.rectGetMinY(i),i},l.SAXParser=l.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1},parse:function(e){return this._parseXML(e)},_parseXML:function(e){return this._parser.parseFromString(e,"text/xml")}}),l.PlistParser=l.SAXParser.extend({parse:function(e){var t=this._parseXML(e),i=t.documentElement;if("plist"!==i.tagName)return l.warn("Not a plist file!"),{};for(var n=null,s=0,r=i.childNodes.length;s<r&&1!==(n=i.childNodes[s]).nodeType;s++);return t=null,this._parseNode(n)},_parseNode:function(e){var t=null,i=e.tagName;if("dict"===i)t=this._parseDict(e);else if("array"===i)t=this._parseArray(e);else if("string"===i)if(1===e.childNodes.length)t=e.firstChild.nodeValue;else{t="";for(var n=0;n<e.childNodes.length;n++)t+=e.childNodes[n].nodeValue}else"false"===i?t=!1:"true"===i?t=!0:"real"===i?t=parseFloat(e.firstChild.nodeValue):"integer"===i&&(t=parseInt(e.firstChild.nodeValue,10));return t},_parseArray:function(e){for(var t=[],i=0,n=e.childNodes.length;i<n;i++){var s=e.childNodes[i];1===s.nodeType&&t.push(this._parseNode(s))}return t},_parseDict:function(e){for(var t={},i=null,n=0,s=e.childNodes.length;n<s;n++){var r=e.childNodes[n];1===r.nodeType&&("key"===r.tagName?i=r.firstChild.nodeValue:t[i]=this._parseNode(r))}return t}}),l.saxParser=new l.SAXParser,l.plistParser=new l.PlistParser,l._txtLoader={load:function(e,t,i,n){l.loader.loadTxt(e,n)}},l.loader.register(["txt","xml","vsh","fsh","atlas"],l._txtLoader),l._jsonLoader={load:function(e,t,i,n){l.loader.loadJson(e,n)}},l.loader.register(["json","ExportJson"],l._jsonLoader),l._jsLoader={load:function(e,t,i,n){l.loader.loadJs(e,n)}},l.loader.register(["js"],l._jsLoader),l._imgLoader={load:function(e,t,i,n){var s;s=l.loader.isLoading(e)?function(e,i){if(e)return n(e);var s=l.textureCache.getTextureForKey(t)||l.textureCache.handleLoadedTexture(t,i);n(null,s)}:function(e,i){if(e)return n(e);var s=l.textureCache.handleLoadedTexture(t,i);n(null,s)},l.loader.loadImg(e,s)}},l.loader.register(["png","jpg","bmp","jpeg","gif","ico","tiff","webp"],l._imgLoader),l._serverImgLoader={load:function(e,t,i,n){l._imgLoader.load(i.src,t,i,n)}},l.loader.register(["serverImg"],l._serverImgLoader),l._plistLoader={load:function(e,t,i,n){l.loader.loadTxt(e,function(e,t){if(e)return n(e);n(null,l.plistParser.parse(t))})}},l.loader.register(["plist"],l._plistLoader),l._fontLoader={TYPE:{".eot":"embedded-opentype",".ttf":"truetype",".ttc":"truetype",".woff":"woff",".svg":"svg"},_loadFont:function(e,t,i){var n=document,s=l.path,r=this.TYPE,a=document.createElement("style");a.type="text/css",n.body.appendChild(a);var o="";if(isNaN(e-0)?o+="@font-face { font-family:"+e+"; src:":o+="@font-face { font-family:'"+e+"'; src:",t instanceof Array)for(var h=0,d=t.length;h<d;h++){var c=t[h];i=s.extname(c).toLowerCase(),o+="url('"+t[h]+"') format('"+r[i]+"')",o+=h===d-1?";":","}else o+="url('"+t+"') format('"+r[i=i.toLowerCase()]+"');";a.textContent+=o+"}";var u=document.createElement("div"),p=u.style;p.fontFamily=e,u.innerHTML=".",p.position="absolute",p.left="-100px",p.top="-100px",n.body.appendChild(u)},load:function(e,t,i,n){var s=this,r=i.type,a=i.name,o=i.srcs;l.isString(i)?(r=l.path.extname(i),a=l.path.basename(i,r),s._loadFont(a,i,r)):s._loadFont(a,o),document.fonts?document.fonts.load("1em "+a).then(function(){n(null,!0)},function(e){n(e)}):n(null,!0)}},l.loader.register(["font","eot","ttf","woff","svg","ttc"],l._fontLoader),l._binaryLoader={load:function(e,t,i,n){l.loader.loadBinary(e,n)}},l._csbLoader={load:function(e,t,i,n){l.loader.loadCsb(e,n)}},l.loader.register(["csb"],l._csbLoader),window.CocosEngine=l.ENGINE_VERSION="Cocos2d-JS v3.15",l.FIX_ARTIFACTS_BY_STRECHING_TEXEL=0,l.DIRECTOR_STATS_POSITION=l.p(0,0),l.DIRECTOR_FPS_INTERVAL=.5,l.COCOSNODE_RENDER_SUBPIXEL=1,l.SPRITEBATCHNODE_RENDER_SUBPIXEL=1,l.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA=1,l.TEXTURE_ATLAS_USE_TRIANGLE_STRIP=0,l.TEXTURE_ATLAS_USE_VAO=0,l.TEXTURE_NPOT_SUPPORT=0,l.RETINA_DISPLAY_FILENAME_SUFFIX="-hd",l.USE_LA88_LABELS=1,l.SPRITE_DEBUG_DRAW=0,l.SPRITEBATCHNODE_DEBUG_DRAW=0,l.LABELBMFONT_DEBUG_DRAW=0,l.LABELATLAS_DEBUG_DRAW=0,l.DRAWNODE_TOTAL_VERTICES=2e4,l.DEFAULT_ENGINE=l.ENGINE_VERSION+"-canvas",l.ENABLE_STACKABLE_ACTIONS=1,l.ENABLE_GL_STATE_CACHE=1,l.$=function(e){var t=this===l?document:this,i=e instanceof HTMLElement?e:t.querySelector(e);return i&&(i.find=i.find||l.$,i.hasClass=i.hasClass||function(e){return this.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},i.addClass=i.addClass||function(e){return this.hasClass(e)||(this.className&&(this.className+=" "),this.className+=e),this},i.removeClass=i.removeClass||function(e){return this.hasClass(e)&&(this.className=this.className.replace(e,"")),this},i.remove=i.remove||function(){return this.parentNode&&this.parentNode.removeChild(this),this},i.appendTo=i.appendTo||function(e){return e.appendChild(this),this},i.prependTo=i.prependTo||function(e){return e.childNodes[0]?e.insertBefore(this,e.childNodes[0]):e.appendChild(this),this},i.transforms=i.transforms||function(){return this.style[l.$.trans]=l.$.translate(this.position)+l.$.rotate(this.rotation)+l.$.scale(this.scale)+l.$.skew(this.skew),this},i.position=i.position||{x:0,y:0},i.rotation=i.rotation||0,i.scale=i.scale||{x:1,y:1},i.skew=i.skew||{x:0,y:0},i.translates=function(e,t){return this.position.x=e,this.position.y=t,this.transforms(),this},i.rotate=function(e){return this.rotation=e,this.transforms(),this},i.resize=function(e,t){return this.scale.x=e,this.scale.y=t,this.transforms(),this},i.setSkew=function(e,t){return this.skew.x=e,this.skew.y=t,this.transforms(),this}),i},l.sys.browserType){case l.sys.BROWSER_TYPE_FIREFOX:l.$.pfx="Moz",l.$.hd=!0;break;case l.sys.BROWSER_TYPE_CHROME:case l.sys.BROWSER_TYPE_SAFARI:l.$.pfx="webkit",l.$.hd=!0;break;case l.sys.BROWSER_TYPE_OPERA:l.$.pfx="O",l.$.hd=!1;break;case l.sys.BROWSER_TYPE_IE:l.$.pfx="ms",l.$.hd=!1;break;default:l.$.pfx="webkit",l.$.hd=!0}l.$.trans=l.$.pfx+"Transform",l.$.translate=l.$.hd?function(e){return"translate3d("+e.x+"px, "+e.y+"px, 0) "}:function(e){return"translate("+e.x+"px, "+e.y+"px) "},l.$.rotate=l.$.hd?function(e){return"rotateZ("+e+"deg) "}:function(e){return"rotate("+e+"deg) "},l.$.scale=function(e){return"scale("+e.x+", "+e.y+") "},l.$.skew=function(e){return"skewX("+-e.x+"deg) skewY("+e.y+"deg)"},l.$new=function(e){return l.$(document.createElement(e))},l.$.findpos=function(e){var t=0,i=0;do{t+=e.offsetLeft,i+=e.offsetTop}while(e=e.offsetParent);return{x:t,y:i}},l.INVALID_INDEX=-1,l.PI=Math.PI,l.FLT_MAX=parseFloat("3.402823466e+38F"),l.FLT_MIN=parseFloat("1.175494351e-38F"),l.RAD=l.PI/180,l.DEG=180/l.PI,l.UINT_MAX=4294967295,l.swap=function(e,t,i){if(!l.isObject(i)||l.isUndefined(i.x)||l.isUndefined(i.y))l.log(l._LogInfos.swap);else{var n=i[e];i[e]=i[t],i[t]=n}},l.lerp=function(e,t,i){return e+(t-e)*i},l.rand=function(){return 16777215*Math.random()},l.randomMinus1To1=function(){return 2*(Math.random()-.5)},l.random0To1=Math.random,l.degreesToRadians=function(e){return e*l.RAD},l.radiansToDegrees=function(e){return e*l.DEG},l.radiansToDegress=function(e){return l.log(l._LogInfos.radiansToDegress),e*l.DEG},l.REPEAT_FOREVER=Number.MAX_VALUE-1,l.nodeDrawSetup=function(e){e._shaderProgram&&(e._glProgramState.apply(),e._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},l.enableDefaultGLStates=function(){},l.disableDefaultGLStates=function(){},l.incrementGLDraws=function(e){l.g_NumberOfDraws+=e},l.FLT_EPSILON=1.192092896e-7,l.contentScaleFactor=function(){return l.director._contentScaleFactor},l.pointPointsToPixels=function(e){var t=l.contentScaleFactor();return l.p(e.x*t,e.y*t)},l.pointPixelsToPoints=function(e){var t=l.contentScaleFactor();return l.p(e.x/t,e.y/t)},l._pointPixelsToPointsOut=function(e,t){var i=l.contentScaleFactor();t.x=e.x/i,t.y=e.y/i},l.sizePointsToPixels=function(e){var t=l.contentScaleFactor();return l.size(e.width*t,e.height*t)},l.sizePixelsToPoints=function(e){var t=l.contentScaleFactor();return l.size(e.width/t,e.height/t)},l._sizePixelsToPointsOut=function(e,t){var i=l.contentScaleFactor();t.width=e.width/i,t.height=e.height/i},l.rectPixelsToPoints=function(e){var t=l.contentScaleFactor();return l.rect(e.x/t,e.y/t,e.width/t,e.height/t)},l.rectPointsToPixels=function(e){var t=l.contentScaleFactor();return l.rect(e.x*t,e.y*t,e.width*t,e.height*t)},l.ONE=1,l.ZERO=0,l.SRC_ALPHA=770,l.SRC_ALPHA_SATURATE=776,l.SRC_COLOR=768,l.DST_ALPHA=772,l.DST_COLOR=774,l.ONE_MINUS_SRC_ALPHA=771,l.ONE_MINUS_SRC_COLOR=769,l.ONE_MINUS_DST_ALPHA=773,l.ONE_MINUS_DST_COLOR=775,l.ONE_MINUS_CONSTANT_ALPHA=32772,l.ONE_MINUS_CONSTANT_COLOR=32770,l.LINEAR=9729,l.REPEAT=10497,l.CLAMP_TO_EDGE=33071,l.MIRRORED_REPEAT=33648,l.BLEND_SRC=l.SRC_ALPHA,l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){l._renderType===l.game.RENDER_TYPE_WEBGL&&l.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA&&(l.BLEND_SRC=l.ONE)}),l.BLEND_DST=l.ONE_MINUS_SRC_ALPHA,l.checkGLErrorDebug=function(){if(l.renderMode===l.game.RENDER_TYPE_WEBGL){var e=l._renderContext.getError();e&&l.log(l._LogInfos.checkGLErrorDebug,e)}},l.ORIENTATION_PORTRAIT=1,l.ORIENTATION_LANDSCAPE=2,l.ORIENTATION_AUTO=3,l.CONCURRENCY_HTTP_REQUEST_COUNT=l.sys.isMobile?20:0,l.BATCH_VERTEX_COUNT=2e3,l.VERTEX_ATTRIB_FLAG_NONE=0,l.VERTEX_ATTRIB_FLAG_POSITION=1,l.VERTEX_ATTRIB_FLAG_COLOR=2,l.VERTEX_ATTRIB_FLAG_TEX_COORDS=4,l.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX=l.VERTEX_ATTRIB_FLAG_POSITION|l.VERTEX_ATTRIB_FLAG_COLOR|l.VERTEX_ATTRIB_FLAG_TEX_COORDS,l.GL_ALL=0,l.VERTEX_ATTRIB_POSITION=0,l.VERTEX_ATTRIB_COLOR=1,l.VERTEX_ATTRIB_TEX_COORDS=2,l.VERTEX_ATTRIB_MAX=7,l.UNIFORM_PMATRIX=0,l.UNIFORM_MVMATRIX=1,l.UNIFORM_MVPMATRIX=2,l.UNIFORM_TIME=3,l.UNIFORM_SINTIME=4,l.UNIFORM_COSTIME=5,l.UNIFORM_RANDOM01=6,l.UNIFORM_SAMPLER=7,l.UNIFORM_MAX=8,l.SHADER_POSITION_TEXTURECOLOR="ShaderPositionTextureColor",l.SHADER_SPRITE_POSITION_TEXTURECOLOR="ShaderSpritePositionTextureColor",l.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY="ShaderSpritePositionTextureColorGray",l.SHADER_POSITION_TEXTURECOLORALPHATEST="ShaderPositionTextureColorAlphaTest",l.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST="ShaderSpritePositionTextureColorAlphaTest",l.SHADER_POSITION_COLOR="ShaderPositionColor",l.SHADER_SPRITE_POSITION_COLOR="ShaderSpritePositionColor",l.SHADER_POSITION_TEXTURE="ShaderPositionTexture",l.SHADER_POSITION_TEXTURE_UCOLOR="ShaderPositionTextureUColor",l.SHADER_POSITION_TEXTUREA8COLOR="ShaderPositionTextureA8Color",l.SHADER_POSITION_UCOLOR="ShaderPositionUColor",l.SHADER_POSITION_LENGTHTEXTURECOLOR="ShaderPositionLengthTextureColor",l.UNIFORM_PMATRIX_S="CC_PMatrix",l.UNIFORM_MVMATRIX_S="CC_MVMatrix",l.UNIFORM_MVPMATRIX_S="CC_MVPMatrix",l.UNIFORM_TIME_S="CC_Time",l.UNIFORM_SINTIME_S="CC_SinTime",l.UNIFORM_COSTIME_S="CC_CosTime",l.UNIFORM_RANDOM01_S="CC_Random01",l.UNIFORM_SAMPLER_S="CC_Texture0",l.UNIFORM_ALPHA_TEST_VALUE_S="CC_alpha_value",l.ATTRIBUTE_NAME_COLOR="a_color",l.ATTRIBUTE_NAME_POSITION="a_position",l.ATTRIBUTE_NAME_TEX_COORD="a_texCoord",l.ATTRIBUTE_NAME_MVMAT="a_mvMatrix",l.ITEM_SIZE=32,l.CURRENT_ITEM=3233828865,l.ZOOM_ACTION_TAG=3233828866,l.NORMAL_TAG=8801,l.SELECTED_TAG=8802,l.DISABLE_TAG=8803,l.arrayVerifyType=function(e,t){if(e&&e.length>0)for(var i=0;i<e.length;i++)if(!(e[i]instanceof t))return l.log("element type is wrong!"),!1;return!0},l.arrayRemoveObject=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t){e.splice(i,1);break}},l.arrayRemoveArray=function(e,t){for(var i=0,n=t.length;i<n;i++)l.arrayRemoveObject(e,t[i])},l.arrayAppendObjectsToIndex=function(e,t,i){return e.splice.apply(e,[i,0].concat(t)),e},l.copyArray=function(e){var t,i=e.length,n=new Array(i);for(t=0;t<i;t+=1)n[t]=e[t];return n},l.Color=function(e,t,i,n){e=e||0,t=t||0,i=i||0,n="number"==typeof n?n:255,this._val=(e<<24>>>0)+(t<<16)+(i<<8)+n};var d=l.Color.prototype;d._getR=function(){return(4278190080&this._val)>>>24},d._setR=function(e){this._val=16777215&this._val|e<<24>>>0},d._getG=function(){return(16711680&this._val)>>16},d._setG=function(e){this._val=4278255615&this._val|e<<16},d._getB=function(){return(65280&this._val)>>8},d._setB=function(e){this._val=4294902015&this._val|e<<8},d._getA=function(){return 255&this._val},d._setA=function(e){this._val=4294967040&this._val|e},d.r,l.defineGetterSetter(d,"r",d._getR,d._setR),d.g,l.defineGetterSetter(d,"g",d._getG,d._setG),d.b,l.defineGetterSetter(d,"b",d._getB,d._setB),d.a,l.defineGetterSetter(d,"a",d._getA,d._setA),l.color=function(e,t,i,n){return void 0===e?new l.Color(0,0,0,255):"object"==typeof e?new l.Color(e.r,e.g,e.b,null==e.a?255:e.a):"string"==typeof e?l.hexToColor(e):new l.Color(e,t,i,null==n?255:n)},l.colorEqual=function(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b},l.Acceleration=function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.timestamp=n||0},l.Vertex2F=function(e,t,i,n){this._arrayBuffer=i||new ArrayBuffer(l.Vertex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=e||0,this._view[1]=t||0},l.Vertex2F.BYTES_PER_ELEMENT=8,d=l.Vertex2F.prototype,d._getX=function(){return this._view[0]},d._setX=function(e){this._view[0]=e},d._getY=function(){return this._view[1]},d._setY=function(e){this._view[1]=e},d.x,l.defineGetterSetter(d,"x",d._getX,d._setX),d.y,l.defineGetterSetter(d,"y",d._getY,d._setY),l.Vertex3F=function(e,t,i,n,s){this._arrayBuffer=n||new ArrayBuffer(l.Vertex3F.BYTES_PER_ELEMENT),this._offset=s||0;var r=this._arrayBuffer,a=this._offset;this._view=new Float32Array(r,a,3),this._view[0]=e||0,this._view[1]=t||0,this._view[2]=i||0},l.Vertex3F.BYTES_PER_ELEMENT=12,d=l.Vertex3F.prototype,d._getX=function(){return this._view[0]},d._setX=function(e){this._view[0]=e},d._getY=function(){return this._view[1]},d._setY=function(e){this._view[1]=e},d._getZ=function(){return this._view[2]},d._setZ=function(e){this._view[2]=e},d.x,l.defineGetterSetter(d,"x",d._getX,d._setX),d.y,l.defineGetterSetter(d,"y",d._getY,d._setY),d.z,l.defineGetterSetter(d,"z",d._getZ,d._setZ),l.Tex2F=function(e,t,i,n){this._arrayBuffer=i||new ArrayBuffer(l.Tex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=e||0,this._view[1]=t||0},l.Tex2F.BYTES_PER_ELEMENT=8,d=l.Tex2F.prototype,d._getU=function(){return this._view[0]},d._setU=function(e){this._view[0]=e},d._getV=function(){return this._view[1]},d._setV=function(e){this._view[1]=e},d.u,l.defineGetterSetter(d,"u",d._getU,d._setU),d.v,l.defineGetterSetter(d,"v",d._getV,d._setV),l.Quad2=function(e,t,i,n,s,r){this._arrayBuffer=s||new ArrayBuffer(l.Quad2.BYTES_PER_ELEMENT),this._offset=r||0;var a=this._arrayBuffer,o=this._offset,h=l.Vertex2F.BYTES_PER_ELEMENT;this._tl=e?new l.Vertex2F(e.x,e.y,a,o):new l.Vertex2F(0,0,a,o),o+=h,this._tr=t?new l.Vertex2F(t.x,t.y,a,o):new l.Vertex2F(0,0,a,o),o+=h,this._bl=i?new l.Vertex2F(i.x,i.y,a,o):new l.Vertex2F(0,0,a,o),o+=h,this._br=n?new l.Vertex2F(n.x,n.y,a,o):new l.Vertex2F(0,0,a,o)},l.Quad2.BYTES_PER_ELEMENT=32,d=l.Quad2.prototype,d._getTL=function(){return this._tl},d._setTL=function(e){this._tl._view[0]=e.x,this._tl._view[1]=e.y},d._getTR=function(){return this._tr},d._setTR=function(e){this._tr._view[0]=e.x,this._tr._view[1]=e.y},d._getBL=function(){return this._bl},d._setBL=function(e){this._bl._view[0]=e.x,this._bl._view[1]=e.y},d._getBR=function(){return this._br},d._setBR=function(e){this._br._view[0]=e.x,this._br._view[1]=e.y},d.tl,l.defineGetterSetter(d,"tl",d._getTL,d._setTL),d.tr,l.defineGetterSetter(d,"tr",d._getTR,d._setTR),d.bl,l.defineGetterSetter(d,"bl",d._getBL,d._setBL),d.br,l.defineGetterSetter(d,"br",d._getBR,d._setBR),l.Quad3=function(e,t,i,n,s,r){this._arrayBuffer=s||new ArrayBuffer(l.Quad3.BYTES_PER_ELEMENT),this._offset=r||0;var a=this._arrayBuffer,o=this._offset,h=l.Vertex3F.BYTES_PER_ELEMENT;this.bl=e?new l.Vertex3F(e.x,e.y,e.z,a,o):new l.Vertex3F(0,0,0,a,o),o+=h,this.br=t?new l.Vertex3F(t.x,t.y,t.z,a,o):new l.Vertex3F(0,0,0,a,o),o+=h,this.tl=i?new l.Vertex3F(i.x,i.y,i.z,a,o):new l.Vertex3F(0,0,0,a,o),o+=h,this.tr=n?new l.Vertex3F(n.x,n.y,n.z,a,o):new l.Vertex3F(0,0,0,a,o)},l.Quad3.BYTES_PER_ELEMENT=48,l.V3F_C4B_T2F=function(e,t,i,n,s){this._arrayBuffer=n||new ArrayBuffer(l.V3F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=s||0;var r=this._arrayBuffer,a=this._offset;this._vertices=e?new l.Vertex3F(e.x,e.y,e.z,r,a):new l.Vertex3F(0,0,0,r,a),a+=l.Vertex3F.BYTES_PER_ELEMENT,this._colors=t?new l._WebGLColor(t.r,t.g,t.b,t.a,r,a):new l._WebGLColor(0,0,0,0,r,a),a+=l._WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new l.Tex2F(i.u,i.v,r,a):new l.Tex2F(0,0,r,a)},l.V3F_C4B_T2F.BYTES_PER_ELEMENT=24,d=l.V3F_C4B_T2F.prototype,d._getVertices=function(){return this._vertices},d._setVertices=function(e){var t=this._vertices;t._view[0]=e.x,t._view[1]=e.y,t._view[2]=e.z},d._getColor=function(){return this._colors},d._setColor=function(e){var t=this._colors;t._view[0]=e.r,t._view[1]=e.g,t._view[2]=e.b,t._view[3]=e.a},d._getTexCoords=function(){return this._texCoords},d._setTexCoords=function(e){this._texCoords._view[0]=e.u,this._texCoords._view[1]=e.v},d.vertices,l.defineGetterSetter(d,"vertices",d._getVertices,d._setVertices),d.colors,l.defineGetterSetter(d,"colors",d._getColor,d._setColor),d.texCoords,l.defineGetterSetter(d,"texCoords",d._getTexCoords,d._setTexCoords),l.V3F_C4B_T2F_Quad=function(e,t,i,n,s,r){this._arrayBuffer=s||new ArrayBuffer(l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._offset=r||0;var a=this._arrayBuffer,o=this._offset,h=l.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=e?new l.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,a,o):new l.V3F_C4B_T2F(null,null,null,a,o),o+=h,this._bl=t?new l.V3F_C4B_T2F(t.vertices,t.colors,t.texCoords,a,o):new l.V3F_C4B_T2F(null,null,null,a,o),o+=h,this._tr=i?new l.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,a,o):new l.V3F_C4B_T2F(null,null,null,a,o),o+=h,this._br=n?new l.V3F_C4B_T2F(n.vertices,n.colors,n.texCoords,a,o):new l.V3F_C4B_T2F(null,null,null,a,o)},l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96,d=l.V3F_C4B_T2F_Quad.prototype,d._getTL=function(){return this._tl},d._setTL=function(e){var t=this._tl;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},d._getBL=function(){return this._bl},d._setBL=function(e){var t=this._bl;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},d._getTR=function(){return this._tr},d._setTR=function(e){var t=this._tr;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},d._getBR=function(){return this._br},d._setBR=function(e){var t=this._br;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},d._getArrayBuffer=function(){return this._arrayBuffer},d.tl,l.defineGetterSetter(d,"tl",d._getTL,d._setTL),d.tr,l.defineGetterSetter(d,"tr",d._getTR,d._setTR),d.bl,l.defineGetterSetter(d,"bl",d._getBL,d._setBL),d.br,l.defineGetterSetter(d,"br",d._getBR,d._setBR),d.arrayBuffer,l.defineGetterSetter(d,"arrayBuffer",d._getArrayBuffer,null),l.V3F_C4B_T2F_QuadZero=function(){return new l.V3F_C4B_T2F_Quad},l.V3F_C4B_T2F_QuadCopy=function(e){if(!e)return l.V3F_C4B_T2F_QuadZero();var t=e.tl,i=e.bl,n=e.tr,s=e.br;return{tl:{vertices:{x:t.vertices.x,y:t.vertices.y,z:t.vertices.z},colors:{r:t.colors.r,g:t.colors.g,b:t.colors.b,a:t.colors.a},texCoords:{u:t.texCoords.u,v:t.texCoords.v}},bl:{vertices:{x:i.vertices.x,y:i.vertices.y,z:i.vertices.z},colors:{r:i.colors.r,g:i.colors.g,b:i.colors.b,a:i.colors.a},texCoords:{u:i.texCoords.u,v:i.texCoords.v}},tr:{vertices:{x:n.vertices.x,y:n.vertices.y,z:n.vertices.z},colors:{r:n.colors.r,g:n.colors.g,b:n.colors.b,a:n.colors.a},texCoords:{u:n.texCoords.u,v:n.texCoords.v}},br:{vertices:{x:s.vertices.x,y:s.vertices.y,z:s.vertices.z},colors:{r:s.colors.r,g:s.colors.g,b:s.colors.b,a:s.colors.a},texCoords:{u:s.texCoords.u,v:s.texCoords.v}}}},l.V3F_C4B_T2F_QuadsCopy=function(e){if(!e)return[];for(var t=[],i=0;i<e.length;i++)t.push(l.V3F_C4B_T2F_QuadCopy(e[i]));return t},l.V2F_C4B_T2F=function(e,t,i,n,s){this._arrayBuffer=n||new ArrayBuffer(l.V2F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=s||0;var r=this._arrayBuffer,a=this._offset;this._vertices=e?new l.Vertex2F(e.x,e.y,r,a):new l.Vertex2F(0,0,r,a),a+=l.Vertex2F.BYTES_PER_ELEMENT,this._colors=t?new l._WebGLColor(t.r,t.g,t.b,t.a,r,a):new l._WebGLColor(0,0,0,0,r,a),a+=l._WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new l.Tex2F(i.u,i.v,r,a):new l.Tex2F(0,0,r,a)},l.V2F_C4B_T2F.BYTES_PER_ELEMENT=20,d=l.V2F_C4B_T2F.prototype,d._getVertices=function(){return this._vertices},d._setVertices=function(e){this._vertices._view[0]=e.x,this._vertices._view[1]=e.y},d._getColor=function(){return this._colors},d._setColor=function(e){var t=this._colors;t._view[0]=e.r,t._view[1]=e.g,t._view[2]=e.b,t._view[3]=e.a},d._getTexCoords=function(){return this._texCoords},d._setTexCoords=function(e){this._texCoords._view[0]=e.u,this._texCoords._view[1]=e.v},d.vertices,l.defineGetterSetter(d,"vertices",d._getVertices,d._setVertices),d.colors,l.defineGetterSetter(d,"colors",d._getColor,d._setColor),d.texCoords,l.defineGetterSetter(d,"texCoords",d._getTexCoords,d._setTexCoords),l.V2F_C4B_T2F_Triangle=function(e,t,i,n,s){this._arrayBuffer=n||new ArrayBuffer(l.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT),this._offset=s||0;var r=this._arrayBuffer,a=this._offset,o=l.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=e?new l.V2F_C4B_T2F(e.vertices,e.colors,e.texCoords,r,a):new l.V2F_C4B_T2F(null,null,null,r,a),a+=o,this._b=t?new l.V2F_C4B_T2F(t.vertices,t.colors,t.texCoords,r,a):new l.V2F_C4B_T2F(null,null,null,r,a),a+=o,this._c=i?new l.V2F_C4B_T2F(i.vertices,i.colors,i.texCoords,r,a):new l.V2F_C4B_T2F(null,null,null,r,a)},l.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60,d=l.V2F_C4B_T2F_Triangle.prototype,d._getA=function(){return this._a},d._setA=function(e){var t=this._a;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},d._getB=function(){return this._b},d._setB=function(e){var t=this._b;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},d._getC=function(){return this._c},d._setC=function(e){var t=this._c;t.vertices=e.vertices,t.colors=e.colors,t.texCoords=e.texCoords},d.a,l.defineGetterSetter(d,"a",d._getA,d._setA),d.b,l.defineGetterSetter(d,"b",d._getB,d._setB),d.c,l.defineGetterSetter(d,"c",d._getC,d._setC),l.vertex2=function(e,t){return new l.Vertex2F(e,t)},l.vertex3=function(e,t,i){return new l.Vertex3F(e,t,i)},l.tex2=function(e,t){return new l.Tex2F(e,t)},l.BlendFunc=function(e,t){this.src=e,this.dst=t},l.blendFuncDisable=function(){return new l.BlendFunc(l.ONE,l.ZERO)},l.hexToColor=function(e){e=e.replace(/^#?/,"0x");var t=parseInt(e),i=t>>16,n=(t>>8)%256,s=t%256;return new l.Color(i,n,s)},l.colorToHex=function(e){var t=e.r.toString(16),i=e.g.toString(16),n=e.b.toString(16);return"#"+(e.r<16?"0"+t:t)+(e.g<16?"0"+i:i)+(e.b<16?"0"+n:n)},l.TEXT_ALIGNMENT_LEFT=0,l.TEXT_ALIGNMENT_CENTER=1,l.TEXT_ALIGNMENT_RIGHT=2,l.VERTICAL_TEXT_ALIGNMENT_TOP=0,l.VERTICAL_TEXT_ALIGNMENT_CENTER=1,l.VERTICAL_TEXT_ALIGNMENT_BOTTOM=2,l._Dictionary=l.Class.extend({_keyMapTb:null,_valueMapTb:null,__currId:0,ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return"key_"+ ++this.__currId},setObject:function(e,t){if(null!=t){var i=this.__getKey();this._keyMapTb[i]=t,this._valueMapTb[i]=e}},objectForKey:function(e){if(null==e)return null;var t=this._keyMapTb;for(var i in t)if(t[i]===e)return this._valueMapTb[i];return null},valueForKey:function(e){return this.objectForKey(e)},removeObjectForKey:function(e){if(null!=e){var t=this._keyMapTb;for(var i in t)if(t[i]===e)return delete this._valueMapTb[i],void delete t[i]}},removeObjectsForKeys:function(e){if(null!=e)for(var t=0;t<e.length;t++)this.removeObjectForKey(e[t])},allKeys:function(){var e=[],t=this._keyMapTb;for(var i in t)e.push(t[i]);return e},removeAllObjects:function(){this._keyMapTb={},this._valueMapTb={}},count:function(){return this.allKeys().length}}),l.FontDefinition=function(e){var t=this;if(t.fontName="Arial",t.fontSize=12,t.textAlign=l.TEXT_ALIGNMENT_CENTER,t.verticalAlign=l.VERTICAL_TEXT_ALIGNMENT_TOP,t.fillStyle=l.color(255,255,255,255),t.boundingWidth=0,t.boundingHeight=0,t.strokeEnabled=!1,t.strokeStyle=l.color(255,255,255,255),t.lineWidth=1,t.lineHeight="normal",t.fontStyle="normal",t.fontWeight="normal",t.shadowEnabled=!1,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowOpacity=1,e&&e instanceof Object)for(var i in e)t[i]=e[i]},l.FontDefinition.prototype._getCanvasFontStr=function(){var e=this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px";return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+e+" '"+this.fontName+"'"},l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){l._renderType===l.game.RENDER_TYPE_WEBGL&&(l._WebGLColor=function(e,t,i,n,s,r){this._arrayBuffer=s||new ArrayBuffer(l._WebGLColor.BYTES_PER_ELEMENT),this._offset=r||0;var a=this._arrayBuffer,o=this._offset;this._view=new Uint8Array(a,o,4),this._view[0]=e||0,this._view[1]=t||0,this._view[2]=i||0,this._view[3]=null==n?255:n,void 0===n&&(this.a_undefined=!0)},l._WebGLColor.BYTES_PER_ELEMENT=4,(d=l._WebGLColor.prototype)._getR=function(){return this._view[0]},d._setR=function(e){this._view[0]=e<0?0:e},d._getG=function(){return this._view[1]},d._setG=function(e){this._view[1]=e<0?0:e},d._getB=function(){return this._view[2]},d._setB=function(e){this._view[2]=e<0?0:e},d._getA=function(){return this._view[3]},d._setA=function(e){this._view[3]=e<0?0:e},l.defineGetterSetter(d,"r",d._getR,d._setR),l.defineGetterSetter(d,"g",d._getG,d._setG),l.defineGetterSetter(d,"b",d._getB,d._setB),l.defineGetterSetter(d,"a",d._getA,d._setA))}),d=l.color,d._getWhite=function(){return l.color(255,255,255)},d._getYellow=function(){return l.color(255,255,0)},d._getBlue=function(){return l.color(0,0,255)},d._getGreen=function(){return l.color(0,255,0)},d._getRed=function(){return l.color(255,0,0)},d._getMagenta=function(){return l.color(255,0,255)},d._getBlack=function(){return l.color(0,0,0)},d._getOrange=function(){return l.color(255,127,0)},d._getGray=function(){return l.color(166,166,166)},d.WHITE,l.defineGetterSetter(d,"WHITE",d._getWhite),d.YELLOW,l.defineGetterSetter(d,"YELLOW",d._getYellow),d.BLUE,l.defineGetterSetter(d,"BLUE",d._getBlue),d.GREEN,l.defineGetterSetter(d,"GREEN",d._getGreen),d.RED,l.defineGetterSetter(d,"RED",d._getRed),d.MAGENTA,l.defineGetterSetter(d,"MAGENTA",d._getMagenta),d.BLACK,l.defineGetterSetter(d,"BLACK",d._getBlack),d.ORANGE,l.defineGetterSetter(d,"ORANGE",d._getOrange),d.GRAY,l.defineGetterSetter(d,"GRAY",d._getGray),l.BlendFunc._disable=function(){return new l.BlendFunc(l.ONE,l.ZERO)},l.BlendFunc._alphaPremultiplied=function(){return new l.BlendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA)},l.BlendFunc._alphaNonPremultiplied=function(){return new l.BlendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA)},l.BlendFunc._additive=function(){return new l.BlendFunc(l.SRC_ALPHA,l.ONE)},l.BlendFunc.DISABLE,l.defineGetterSetter(l.BlendFunc,"DISABLE",l.BlendFunc._disable),l.BlendFunc.ALPHA_PREMULTIPLIED,l.defineGetterSetter(l.BlendFunc,"ALPHA_PREMULTIPLIED",l.BlendFunc._alphaPremultiplied),l.BlendFunc.ALPHA_NON_PREMULTIPLIED,l.defineGetterSetter(l.BlendFunc,"ALPHA_NON_PREMULTIPLIED",l.BlendFunc._alphaNonPremultiplied),l.BlendFunc.ADDITIVE,l.defineGetterSetter(l.BlendFunc,"ADDITIVE",l.BlendFunc._additive),l.Touches=[],l.TouchesIntergerDict={},l.DENSITYDPI_DEVICE="device-dpi",l.DENSITYDPI_HIGH="high-dpi",l.DENSITYDPI_MEDIUM="medium-dpi",l.DENSITYDPI_LOW="low-dpi";var _={init:function(){this.html=document.documentElement},availWidth:function(e){return e&&e!==this.html?e.clientWidth:window.innerWidth},availHeight:function(e){return e&&e!==this.html?e.clientHeight:window.innerHeight},meta:{width:"device-width"},adaptationType:l.sys.browserType};switch(window.navigator.userAgent.indexOf("OS 8_1_")>-1&&(_.adaptationType=l.sys.BROWSER_TYPE_MIUI),l.sys.os===l.sys.OS_IOS&&(_.adaptationType=l.sys.BROWSER_TYPE_SAFARI),_.adaptationType){case l.sys.BROWSER_TYPE_SAFARI:_.meta["minimal-ui"]="true";break;case l.sys.BROWSER_TYPE_CHROME:_.__defineGetter__("target-densitydpi",function(){return l.view._targetDensityDPI});break;case l.sys.BROWSER_TYPE_MIUI:_.init=function(e){if(!e.__resizeWithBrowserSize){var t=function(){e.setDesignResolutionSize(e._designResolutionSize.width,e._designResolutionSize.height,e._resolutionPolicy),window.removeEventListener("resize",t,!1)};window.addEventListener("resize",t,!1)}}}var g=null;l.EGLView=l.Class.extend({_delegate:null,_frameSize:null,_designResolutionSize:null,_originalDesignResolutionSize:null,_viewPortRect:null,_visibleRect:null,_retinaEnabled:!1,_autoFullScreen:!1,_devicePixelRatio:1,_viewName:"",_resizeCallback:null,_orientationChanging:!0,_resizing:!1,_scaleX:1,_originalScaleX:1,_scaleY:1,_originalScaleY:1,_isRotated:!1,_orientation:3,_resolutionPolicy:null,_rpExactFit:null,_rpShowAll:null,_rpNoBorder:null,_rpFixedHeight:null,_rpFixedWidth:null,_initialized:!1,_contentTranslateLeftTop:null,_frame:null,_frameZoomFactor:1,__resizeWithBrowserSize:!1,_isAdjustViewPort:!0,_targetDensityDPI:null,ctor:function(){var e=this,t=document,i=l.ContainerStrategy,n=l.ContentStrategy;_.init(this),e._frame=l.container.parentNode===t.body?t.documentElement:l.container.parentNode,e._frameSize=l.size(0,0),e._initFrameSize();var s=l._canvas.width,r=l._canvas.height;e._designResolutionSize=l.size(s,r),e._originalDesignResolutionSize=l.size(s,r),e._viewPortRect=l.rect(0,0,s,r),e._visibleRect=l.rect(0,0,s,r),e._contentTranslateLeftTop={left:0,top:0},e._viewName="Cocos2dHTML5";var a=l.sys;l.visibleRect&&l.visibleRect.init(e._visibleRect),e._rpExactFit=new l.ResolutionPolicy(i.EQUAL_TO_FRAME,n.EXACT_FIT),e._rpShowAll=new l.ResolutionPolicy(i.PROPORTION_TO_FRAME,n.SHOW_ALL),e._rpNoBorder=new l.ResolutionPolicy(i.EQUAL_TO_FRAME,n.NO_BORDER),e._rpFixedHeight=new l.ResolutionPolicy(i.EQUAL_TO_FRAME,n.FIXED_HEIGHT),e._rpFixedWidth=new l.ResolutionPolicy(i.EQUAL_TO_FRAME,n.FIXED_WIDTH),e._targetDensityDPI=l.DENSITYDPI_HIGH,a.isMobile&&window.addEventListener("orientationchange",this._orientationChange)},_resizeEvent:function(){var e;if(!(e=this.setDesignResolutionSize?this:l.view)._orientationChanging){var t=e._frameSize.width,i=e._frameSize.height,n=e._isRotated;if(l.sys.isMobile){var s=l.game.container.style,r=s.margin;s.margin="0",s.display="none",e._initFrameSize(),s.margin=r,s.display="block"}else e._initFrameSize();if(e._isRotated!==n||e._frameSize.width!==t||e._frameSize.height!==i){var a=e._originalDesignResolutionSize.width,o=e._originalDesignResolutionSize.height;e._resizing=!0,a>0&&e.setDesignResolutionSize(a,o,e._resolutionPolicy),e._resizing=!1,l.eventManager.dispatchCustomEvent("canvas-resize"),e._resizeCallback&&e._resizeCallback.call()}}},_orientationChange:function(){l.view._orientationChanging=!0,l.sys.isMobile&&(l.game.container.style.display="none"),setTimeout(function(){l.view._orientationChanging=!1,l.view._resizeEvent()},300)},setTargetDensityDPI:function(e){this._targetDensityDPI=e,this._adjustViewportMeta()},getTargetDensityDPI:function(){return this._targetDensityDPI},resizeWithBrowserSize:function(e){e?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,window.addEventListener("resize",this._resizeEvent)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resizeEvent))},setResizeCallback:function(e){"function"!=typeof e&&null!=e||(this._resizeCallback=e)},setOrientation:function(e){if((e&=l.ORIENTATION_AUTO)&&this._orientation!==e&&(this._orientation=e,this._resolutionPolicy)){var t=this._originalDesignResolutionSize.width,i=this._originalDesignResolutionSize.height;this.setDesignResolutionSize(t,i,this._resolutionPolicy)}},setDocumentPixelWidth:function(e){this._setViewportMeta({width:e},!0),document.documentElement.style.width=e+"px",document.body.style.width="100%",this.setDesignResolutionSize(this._designResolutionSize.width,this._designResolutionSize.height,this._resolutionPolicy)},_initFrameSize:function(){var e=this._frameSize,t=_.availWidth(this._frame),i=_.availHeight(this._frame),n=t>=i;!l.sys.isMobile||n&&this._orientation&l.ORIENTATION_LANDSCAPE||!n&&this._orientation&l.ORIENTATION_PORTRAIT?(e.width=t,e.height=i,l.container.style["-webkit-transform"]="rotate(0deg)",l.container.style.transform="rotate(0deg)",this._isRotated=!1):(e.width=i,e.height=t,l.container.style["-webkit-transform"]="rotate(90deg)",l.container.style.transform="rotate(90deg)",l.container.style["-webkit-transform-origin"]="0px 0px 0px",l.container.style.transformOrigin="0px 0px 0px",this._isRotated=!0)},_adjustSizeKeepCanvasSize:function(){var e=this._originalDesignResolutionSize.width,t=this._originalDesignResolutionSize.height;e>0&&this.setDesignResolutionSize(e,t,this._resolutionPolicy)},_setViewportMeta:function(e,t){},_adjustViewportMeta:function(){this._isAdjustViewPort&&(this._setViewportMeta(_.meta,!1),this._isAdjustViewPort=!1)},_setScaleXYForRenderTexture:function(){var e=l.contentScaleFactor();this._scaleX=e,this._scaleY=e},_resetScale:function(){this._scaleX=this._originalScaleX,this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(e){this._isAdjustViewPort=e},enableRetina:function(e){this._retinaEnabled=!!e},isRetinaEnabled:function(){return this._retinaEnabled},enableAutoFullScreen:function(e){e&&e!==this._autoFullScreen&&l.sys.isMobile&&this._frame===document.documentElement?(this._autoFullScreen=!0,l.screen.autoFullScreen(this._frame)):this._autoFullScreen=!1},isAutoFullScreenEnabled:function(){return this._autoFullScreen},isOpenGLReady:function(){return l.game.canvas&&l._renderContext},setFrameZoomFactor:function(e){this._frameZoomFactor=e,this.centerWindow(),l.director.setProjection(l.director.getProjection())},swapBuffers:function(){},setIMEKeyboardState:function(e){},setContentTranslateLeftTop:function(e,t){this._contentTranslateLeftTop={left:e,top:t}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},getCanvasSize:function(){return l.size(l._canvas.width,l._canvas.height)},getFrameSize:function(){return l.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(e,t){this._frameSize.width=e,this._frameSize.height=t,this._frame.style.width=e+"px",this._frame.style.height=t+"px",this._resizeEvent(),l.director.setProjection(l.director.getProjection())},getVisibleSize:function(){return l.size(this._visibleRect.width,this._visibleRect.height)},getVisibleSizeInPixel:function(){return l.size(this._visibleRect.width*this._scaleX,this._visibleRect.height*this._scaleY)},getVisibleOrigin:function(){return l.p(this._visibleRect.x,this._visibleRect.y)},getVisibleOriginInPixel:function(){return l.p(this._visibleRect.x*this._scaleX,this._visibleRect.y*this._scaleY)},canSetContentScaleFactor:function(){return!0},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(e){var t=this;if(e instanceof l.ResolutionPolicy)t._resolutionPolicy=e;else{var i=l.ResolutionPolicy;e===i.EXACT_FIT&&(t._resolutionPolicy=t._rpExactFit),e===i.SHOW_ALL&&(t._resolutionPolicy=t._rpShowAll),e===i.NO_BORDER&&(t._resolutionPolicy=t._rpNoBorder),e===i.FIXED_HEIGHT&&(t._resolutionPolicy=t._rpFixedHeight),e===i.FIXED_WIDTH&&(t._resolutionPolicy=t._rpFixedWidth)}},setDesignResolutionSize:function(e,t,i){if(e>0||t>0){this.setResolutionPolicy(i);var n=this._resolutionPolicy;if(n&&n.preApply(this),l.sys.isMobile&&this._adjustViewportMeta(),this._resizing||this._initFrameSize(),n){this._originalDesignResolutionSize.width=this._designResolutionSize.width=e,this._originalDesignResolutionSize.height=this._designResolutionSize.height=t;var s=n.apply(this,this._designResolutionSize);if(s.scale&&2===s.scale.length&&(this._scaleX=s.scale[0],this._scaleY=s.scale[1]),s.viewport){var r=this._viewPortRect,a=this._visibleRect,o=s.viewport;r.x=o.x,r.y=o.y,r.width=o.width,r.height=o.height,a.x=-r.x/this._scaleX,a.y=-r.y/this._scaleY,a.width=l._canvas.width/this._scaleX,a.height=l._canvas.height/this._scaleY,l._renderContext.setOffset&&l._renderContext.setOffset(r.x,-r.y)}var h=l.director;h._winSizeInPoints.width=this._designResolutionSize.width,h._winSizeInPoints.height=this._designResolutionSize.height,n.postApply(this),l.winSize.width=h._winSizeInPoints.width,l.winSize.height=h._winSizeInPoints.height,l._renderType===l.game.RENDER_TYPE_WEBGL?h.setGLDefaultValues():l._renderType===l.game.RENDER_TYPE_CANVAS&&(l.renderer._allNeedDraw=!0),this._originalScaleX=this._scaleX,this._originalScaleY=this._scaleY,l.visibleRect&&l.visibleRect.init(this._visibleRect)}else l.log(l._LogInfos.EGLView_setDesignResolutionSize_2)}else l.log(l._LogInfos.EGLView_setDesignResolutionSize)},getDesignResolutionSize:function(){return l.size(this._designResolutionSize.width,this._designResolutionSize.height)},setRealPixelResolution:function(e,t,i){},setViewPortInPoints:function(e,t,i,n){var s=this._frameZoomFactor,r=this._scaleX,a=this._scaleY;l._renderContext.viewport(e*r*s+this._viewPortRect.x*s,t*a*s+this._viewPortRect.y*s,i*r*s,n*a*s)},setScissorInPoints:function(e,t,i,n){var s=this._frameZoomFactor,r=this._scaleX,a=this._scaleY,o=Math.ceil(e*r*s+this._viewPortRect.x*s),h=Math.ceil(t*a*s+this._viewPortRect.y*s),d=Math.ceil(i*r*s),c=Math.ceil(n*a*s);if(!g){var u=gl.getParameter(gl.SCISSOR_BOX);g=l.rect(u[0],u[1],u[2],u[3])}g.x==o&&g.y==h&&g.width==d&&g.height==c||(g.x=o,g.y=h,g.width=d,g.height=c,l._renderContext.scissor(o,h,d,c))},isScissorEnabled:function(){return l._renderContext.isEnabled(gl.SCISSOR_TEST)},getScissorRect:function(){if(!g){var e=gl.getParameter(gl.SCISSOR_BOX);g=l.rect(e[0],e[1],e[2],e[3])}var t=1/this._scaleX,i=1/this._scaleY;return l.rect((g.x-this._viewPortRect.x)*t,(g.y-this._viewPortRect.y)*i,g.width*t,g.height*i)},setViewName:function(e){null!=e&&e.length>0&&(this._viewName=e)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(e,t,i){var n=this._devicePixelRatio*(e-i.left),s=this._devicePixelRatio*(i.top+i.height-t);return this._isRotated?{x:this._viewPortRect.width-s,y:n}:{x:n,y:s}},_convertMouseToLocationInView:function(e,t){var i=this._viewPortRect,n=this;e.x=(n._devicePixelRatio*(e.x-t.left)-i.x)/n._scaleX,e.y=(n._devicePixelRatio*(t.top+t.height-e.y)-i.y)/n._scaleY},_convertPointWithScale:function(e){var t=this._viewPortRect;e.x=(e.x-t.x)/this._scaleX,e.y=(e.y-t.y)/this._scaleY},_convertTouchesWithScale:function(e){for(var t,i,n,s=this._viewPortRect,r=this._scaleX,a=this._scaleY,o=0;o<e.length;o++)i=(t=e[o])._point,n=t._prevPoint,i.x=(i.x-s.x)/r,i.y=(i.y-s.y)/a,n.x=(n.x-s.x)/r,n.y=(n.y-s.y)/a}}),l.EGLView._getInstance=function(){return this._instance||(this._instance=this._instance||new l.EGLView,this._instance.initialize()),this._instance},l.ContainerStrategy=l.Class.extend({preApply:function(e){},apply:function(e,t){},postApply:function(e){},_setupContainer:function(e,t,i){var n=l.game.canvas,s=l.game.container;l.sys.os===l.sys.OS_ANDROID&&(document.body.style.width=(e._isRotated?i:t)+"px",document.body.style.height=(e._isRotated?t:i)+"px"),s.style.width=n.style.width=t+"px",s.style.height=n.style.height=i+"px";var r=e._devicePixelRatio=1;e.isRetinaEnabled()&&(r=e._devicePixelRatio=Math.min(2,window.devicePixelRatio||1)),n.width=t*r,n.height=i*r,l._renderContext.resetCache&&l._renderContext.resetCache()},_fixContainer:function(){document.body.insertBefore(l.container,document.body.firstChild);var e=document.body.style;e.width=window.innerWidth+"px",e.height=window.innerHeight+"px",e.overflow="hidden";var t=l.container.style;t.position="fixed",t.left=t.top="0px",document.body.scrollTop=0}}),l.ContentStrategy=l.Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(e,t,i,n,s,r){Math.abs(e-i)<2&&(i=e),Math.abs(t-n)<2&&(n=t);var a=l.rect(Math.round((e-i)/2),Math.round((t-n)/2),i,n);return l._renderType,l.game.RENDER_TYPE_CANVAS,this._result.scale=[s,r],this._result.viewport=a,this._result},preApply:function(e){},apply:function(e,t){return{scale:[1,1]}},postApply:function(e){}}),function(){var e=l.ContainerStrategy.extend({apply:function(e){var t=e._frameSize.height,i=l.container.style;this._setupContainer(e,e._frameSize.width,e._frameSize.height),e._isRotated?i.margin="0 0 0 "+t+"px":i.margin="0px"}}),t=l.ContainerStrategy.extend({apply:function(e,t){var i,n,s=e._frameSize.width,r=e._frameSize.height,a=l.container.style,o=t.width,h=t.height,d=s/o,c=r/h;d<c?(i=s,n=h*d):(i=o*c,n=r);var u=Math.round((s-i)/2),p=Math.round((r-n)/2);i=s-2*u,n=r-2*p,this._setupContainer(e,i,n),e._isRotated?a.margin="0 0 0 "+r+"px":a.margin="0px",a.paddingLeft=u+"px",a.paddingRight=u+"px",a.paddingTop=p+"px",a.paddingBottom=p+"px"}}),i=(e.extend({preApply:function(e){this._super(e),e._frame=document.documentElement},apply:function(e){this._super(e),this._fixContainer()}}),t.extend({preApply:function(e){this._super(e),e._frame=document.documentElement},apply:function(e,t){this._super(e,t),this._fixContainer()}}),l.ContainerStrategy.extend({apply:function(e){this._setupContainer(e,l._canvas.width,l._canvas.height)}}));l.ContainerStrategy.EQUAL_TO_FRAME=new e,l.ContainerStrategy.PROPORTION_TO_FRAME=new t,l.ContainerStrategy.ORIGINAL_CONTAINER=new i;var n=l.ContentStrategy.extend({apply:function(e,t){var i=l._canvas.width,n=l._canvas.height,s=i/t.width,r=n/t.height;return this._buildResult(i,n,i,n,s,r)}}),s=l.ContentStrategy.extend({apply:function(e,t){var i,n,s=l._canvas.width,r=l._canvas.height,a=t.width,o=t.height,h=s/a,d=r/o,c=0;return h<d?(c=h,i=s,n=o*c):(c=d,i=a*c,n=r),this._buildResult(s,r,i,n,c,c)}}),r=l.ContentStrategy.extend({apply:function(e,t){var i,n,s,r=l._canvas.width,a=l._canvas.height,o=t.width,h=t.height,d=r/o,c=a/h;return d<c?(i=c,n=o*i,s=a):(i=d,n=r,s=h*i),this._buildResult(r,a,n,s,i,i)}}),a=l.ContentStrategy.extend({apply:function(e,t){var i=l._canvas.width,n=l._canvas.height,s=n/t.height,r=i,a=n;return this._buildResult(i,n,r,a,s,s)},postApply:function(e){l.director._winSizeInPoints=e.getVisibleSize()}}),o=l.ContentStrategy.extend({apply:function(e,t){var i=l._canvas.width,n=l._canvas.height,s=i/t.width,r=i,a=n;return this._buildResult(i,n,r,a,s,s)},postApply:function(e){l.director._winSizeInPoints=e.getVisibleSize()}});l.ContentStrategy.EXACT_FIT=new n,l.ContentStrategy.SHOW_ALL=new s,l.ContentStrategy.NO_BORDER=new r,l.ContentStrategy.FIXED_HEIGHT=new a,l.ContentStrategy.FIXED_WIDTH=new o}(),l.ResolutionPolicy=l.Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(e,t){this.setContainerStrategy(e),this.setContentStrategy(t)},preApply:function(e){this._containerStrategy.preApply(e),this._contentStrategy.preApply(e)},apply:function(e,t){return this._containerStrategy.apply(e,t),this._contentStrategy.apply(e,t)},postApply:function(e){this._containerStrategy.postApply(e),this._contentStrategy.postApply(e)},setContainerStrategy:function(e){e instanceof l.ContainerStrategy&&(this._containerStrategy=e)},setContentStrategy:function(e){e instanceof l.ContentStrategy&&(this._contentStrategy=e)}}),l.ResolutionPolicy.EXACT_FIT=0,l.ResolutionPolicy.NO_BORDER=1,l.ResolutionPolicy.SHOW_ALL=2,l.ResolutionPolicy.FIXED_HEIGHT=3,l.ResolutionPolicy.FIXED_WIDTH=4,l.ResolutionPolicy.UNKNOWN=5,l.screen={_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var e,t,i,n,s=this._fnMap;for(e=0,i=s.length;e<i;e++)if((t=s[e])&&t[1]in document){for(e=0,n=t.length;e<n;e++)this._fn[s[0][e]]=t[e];break}this._supportsFullScreen=void 0!==this._fn.requestFullscreen,this._touchEvent="ontouchstart"in window?"touchstart":"mousedown"},fullScreen:function(){return!!this._supportsFullScreen&&(void 0!==document[this._fn.fullscreenElement]&&null!==document[this._fn.fullscreenElement])},requestFullScreen:function(e,t){if(this._supportsFullScreen){if(e=e||document.documentElement,t){var i=this._fn.fullscreenchange;this._preOnFullScreenChange&&document.removeEventListener(i,this._preOnFullScreenChange),this._preOnFullScreenChange=t,document.addEventListener(i,t,!1)}return e[this._fn.requestFullscreen]()}},exitFullScreen:function(){return!this._supportsFullScreen||document[this._fn.exitFullscreen]()},autoFullScreen:function(e,t){function i(){n.removeEventListener(s._touchEvent,i),s.requestFullScreen(e,t)}e=e||document.body;var n=l.game.canvas||e,s=this;this.requestFullScreen(e,t),n.addEventListener(this._touchEvent,i)}},l.screen.init(),l.visibleRect={topLeft:l.p(0,0),topRight:l.p(0,0),top:l.p(0,0),bottomLeft:l.p(0,0),bottomRight:l.p(0,0),bottom:l.p(0,0),center:l.p(0,0),left:l.p(0,0),right:l.p(0,0),width:0,height:0,init:function(e){var t=this.width=e.width,i=this.height=e.height,n=e.x,s=e.y,r=s+i,a=n+t;this.topLeft.x=n,this.topLeft.y=r,this.topRight.x=a,this.topRight.y=r,this.top.x=n+t/2,this.top.y=r,this.bottomLeft.x=n,this.bottomLeft.y=s,this.bottomRight.x=a,this.bottomRight.y=s,this.bottom.x=n+t/2,this.bottom.y=s,this.center.x=n+t/2,this.center.y=s+i/2,this.left.x=n,this.left.y=s+i/2,this.right.x=a,this.right.y=s+i/2}},l.UIInterfaceOrientationLandscapeLeft=-90,l.UIInterfaceOrientationLandscapeRight=90,l.UIInterfaceOrientationPortraitUpsideDown=180,l.UIInterfaceOrientationPortrait=0,l.inputManager={TOUCH_TIMEOUT:5e3,_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:l.p(0,0),_prevMousePoint:l.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:!1,_accelInterval:1/30,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){for(var e=this._indexBitsUsed,t=l.sys.now(),i=0;i<this._maxTouches;i++){if(!(1&e))return this._indexBitsUsed|=1<<i,i;var n=this._touches[i];if(t-n._lastModified>this.TOUCH_TIMEOUT)return this._removeUsedIndexBit(i),delete this._touchesIntegerDict[n.getID()],i;e>>=1}return-1},_removeUsedIndexBit:function(e){if(!(e<0||e>=this._maxTouches)){var t=1<<e;t=~t,this._indexBitsUsed&=t}},_glView:null,handleTouchesBegin:function(e){for(var t,i,n,s=[],r=this._touchesIntegerDict,a=l.sys.now(),o=0,h=e.length;o<h;o++)if(t=e[o],n=t.getID(),null==r[n]){var d=this._getUnUsedIndex();if(-1===d){l.log(l._LogInfos.inputManager_handleTouchesBegin,d);continue}(i=this._touches[d]=new l.Touch(t._point.x,t._point.y,t.getID()))._lastModified=a,i._setPrevPoint(t._prevPoint),r[n]=d,s.push(i)}if(s.length>0){this._glView._convertTouchesWithScale(s);var c=new l.EventTouch(s);c._eventCode=l.EventTouch.EventCode.BEGAN,l.eventManager.dispatchEvent(c)}},handleTouchesMove:function(e){for(var t,i,n,s=[],r=this._touches,a=l.sys.now(),o=0,h=e.length;o<h;o++)n=(t=e[o]).getID(),null!=(i=this._touchesIntegerDict[n])&&r[i]&&(r[i]._setPoint(t._point),r[i]._setPrevPoint(t._prevPoint),r[i]._lastModified=a,s.push(r[i]));if(s.length>0){this._glView._convertTouchesWithScale(s);var d=new l.EventTouch(s);d._eventCode=l.EventTouch.EventCode.MOVED,l.eventManager.dispatchEvent(d)}},handleTouchesEnd:function(e){var t=this.getSetOfTouchesEndOrCancel(e);if(t.length>0){this._glView._convertTouchesWithScale(t);var i=new l.EventTouch(t);i._eventCode=l.EventTouch.EventCode.ENDED,l.eventManager.dispatchEvent(i)}},handleTouchesCancel:function(e){var t=this.getSetOfTouchesEndOrCancel(e);if(t.length>0){this._glView._convertTouchesWithScale(t);var i=new l.EventTouch(t);i._eventCode=l.EventTouch.EventCode.CANCELLED,l.eventManager.dispatchEvent(i)}},getSetOfTouchesEndOrCancel:function(e){for(var t,i,n,s=[],r=this._touches,a=this._touchesIntegerDict,o=0,h=e.length;o<h;o++)null!=(i=a[n=(t=e[o]).getID()])&&r[i]&&(r[i]._setPoint(t._point),r[i]._setPrevPoint(t._prevPoint),s.push(r[i]),this._removeUsedIndexBit(i),delete a[n]);return s},getHTMLElementPosition:function(e){document.documentElement,window;var t=null;return t=l.isFunction(e.getBoundingClientRect)?e.getBoundingClientRect():{left:0,top:0,width:parseInt(e.style.width),height:parseInt(e.style.height)},{left:0,top:0,width:t.width,height:t.height}},getPreTouch:function(e){for(var t=null,i=this._preTouchPool,n=e.getID(),s=i.length-1;s>=0;s--)if(i[s].getID()===n){t=i[s];break}return t||(t=e),t},setPreTouch:function(e){for(var t=!1,i=this._preTouchPool,n=e.getID(),s=i.length-1;s>=0;s--)if(i[s].getID()===n){i[s]=e,t=!0;break}t||(i.length<=50?i.push(e):(i[this._preTouchPoolPointer]=e,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(e,t,i){var n=this._preTouchPoint,s=this._glView.convertToLocationInView(e,t,i),r=new l.Touch(s.x,s.y);return r._setPrevPoint(n.x,n.y),n.x=s.x,n.y=s.y,r},getMouseEvent:function(e,t,i){var n=this._prevMousePoint;this._glView._convertMouseToLocationInView(e,t);var s=new l.EventMouse(i);return s.setLocation(e.x,e.y),s._setPrevCursor(n.x,n.y),n.x=e.x,n.y=e.y,s},getPointByEvent:function(e,t){return null!=e.pageX?{x:e.pageX,y:e.pageY}:(t.left-=document.body.scrollLeft,t.top-=document.body.scrollTop,{x:e.clientX,y:e.clientY})},getTouchesByEvent:function(e,t){for(var i,n,s,r=[],a=this._glView,o=this._preTouchPoint,h=e.changedTouches.length,d=0;d<h;d++)if(i=e.changedTouches[d]){var c;c=l.sys.BROWSER_TYPE_FIREFOX===l.sys.browserType?a.convertToLocationInView(i.pageX,i.pageY,t):a.convertToLocationInView(i.clientX,i.clientY,t),null!=i.identifier?(n=new l.Touch(c.x,c.y,i.identifier),s=this.getPreTouch(n).getLocation(),n._setPrevPoint(s.x,s.y),this.setPreTouch(n)):(n=new l.Touch(c.x,c.y))._setPrevPoint(o.x,o.y),o.x=c.x,o.y=c.y,r.push(n)}return r},registerSystemEvent:function(e){if(!this._isRegisterEvent){this._glView=l.view;var t=this,i="mouse"in l.sys.capabilities,n="touches"in l.sys.capabilities,s=!1;if(l.sys.isMobile&&(s=!0),i&&(window.addEventListener("mousedown",function(){t._mousePressed=!0},!1),window.addEventListener("mouseup",function(i){if(!s){var n=t._mousePressed;if(t._mousePressed=!1,n){var r=t.getHTMLElementPosition(e),a=t.getPointByEvent(i,r);if(!l.rectContainsPoint(new l.Rect(r.left,r.top,r.width,r.height),a)){t.handleTouchesEnd([t.getTouchByXY(a.x,a.y,r)]);var o=t.getMouseEvent(a,r,l.EventMouse.UP);o.setButton(i.button),l.eventManager.dispatchEvent(o)}}}},!1),e.addEventListener("mousedown",function(i){if(!s){t._mousePressed=!0;var n=t.getHTMLElementPosition(e),r=t.getPointByEvent(i,n);t.handleTouchesBegin([t.getTouchByXY(r.x,r.y,n)]);var a=t.getMouseEvent(r,n,l.EventMouse.DOWN);a.setButton(i.button),l.eventManager.dispatchEvent(a),i.stopPropagation(),i.preventDefault(),e.focus()}},!1),e.addEventListener("mouseup",function(i){if(!s){t._mousePressed=!1;var n=t.getHTMLElementPosition(e),r=t.getPointByEvent(i,n);t.handleTouchesEnd([t.getTouchByXY(r.x,r.y,n)]);var a=t.getMouseEvent(r,n,l.EventMouse.UP);a.setButton(i.button),l.eventManager.dispatchEvent(a),i.stopPropagation(),i.preventDefault()}},!1),e.addEventListener("mousemove",function(i){if(!s){var n=t.getHTMLElementPosition(e),r=t.getPointByEvent(i,n);t.handleTouchesMove([t.getTouchByXY(r.x,r.y,n)]);var a=t.getMouseEvent(r,n,l.EventMouse.MOVE);t._mousePressed?a.setButton(i.button):a.setButton(null),l.eventManager.dispatchEvent(a),i.stopPropagation(),i.preventDefault()}},!1),e.addEventListener("mousewheel",function(i){var n=t.getHTMLElementPosition(e),s=t.getPointByEvent(i,n),r=t.getMouseEvent(s,n,l.EventMouse.SCROLL);r.setButton(i.button),r.setScrollData(0,i.wheelDelta),l.eventManager.dispatchEvent(r),i.stopPropagation(),i.preventDefault()},!1),e.addEventListener("DOMMouseScroll",function(i){var n=t.getHTMLElementPosition(e),s=t.getPointByEvent(i,n),r=t.getMouseEvent(s,n,l.EventMouse.SCROLL);r.setButton(i.button),r.setScrollData(0,-120*i.detail),l.eventManager.dispatchEvent(r),i.stopPropagation(),i.preventDefault()},!1)),window.navigator.msPointerEnabled){var r={MSPointerDown:t.handleTouchesBegin,MSPointerMove:t.handleTouchesMove,MSPointerUp:t.handleTouchesEnd,MSPointerCancel:t.handleTouchesCancel};for(var a in r)!function(i,n){e.addEventListener(i,function(i){var s=t.getHTMLElementPosition(e);s.left-=document.documentElement.scrollLeft,s.top-=document.documentElement.scrollTop,n.call(t,[t.getTouchByXY(i.clientX,i.clientY,s)]),i.stopPropagation()},!1)}(a,r[a])}n&&(e.addEventListener("touchstart",function(i){if(i.changedTouches){var n=t.getHTMLElementPosition(e);t.handleTouchesBegin(t.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1),e.addEventListener("touchmove",function(i){if(i.changedTouches){var n=t.getHTMLElementPosition(e);t.handleTouchesMove(t.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1),e.addEventListener("touchend",function(i){if(i.changedTouches){var n=t.getHTMLElementPosition(e);t.handleTouchesEnd(t.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1),e.addEventListener("touchcancel",function(i){if(i.changedTouches){var n=t.getHTMLElementPosition(e);t.handleTouchesCancel(t.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1)),this._registerKeyboardEvent(),this._registerAccelerometerEvent(),this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(e){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,l.eventManager.dispatchEvent(new l.EventAcceleration(this._acceleration))),this._accelCurTime+=e}};var d=l.inputManager;d.setAccelerometerEnabled=function(e){var t=this;if(t._accelEnabled!==e){t._accelEnabled=e;var i=l.director.getScheduler();t._accelEnabled,t._accelCurTime=0,i.scheduleUpdate(t)}},d.setAccelerometerInterval=function(e){this._accelInterval!==e&&(this._accelInterval=e)},d._registerKeyboardEvent=function(){l._canvas.addEventListener("keydown",function(e){l.eventManager.dispatchEvent(new l.EventKeyboard(e.keyCode,!0)),e.stopPropagation(),e.preventDefault()},!1),l._canvas.addEventListener("keyup",function(e){l.eventManager.dispatchEvent(new l.EventKeyboard(e.keyCode,!1)),e.stopPropagation(),e.preventDefault()},!1)},d._registerAccelerometerEvent=function(){var e=window,t=this;t._acceleration=new l.Acceleration,t._accelDeviceEvent=e.DeviceMotionEvent||e.DeviceOrientationEvent,l.sys.browserType===l.sys.BROWSER_TYPE_MOBILE_QQ&&(t._accelDeviceEvent=window.DeviceOrientationEvent);var i=t._accelDeviceEvent===e.DeviceMotionEvent?"devicemotion":"deviceorientation",n=navigator.userAgent;(/Android/.test(n)||/Adr/.test(n)&&l.sys.browserType===l.BROWSER_TYPE_UC)&&(t._minus=-1),e.addEventListener(i,t.didAccelerate.bind(t),!1)},d.didAccelerate=function(e){var t=this,i=window;if(t._accelEnabled){var n,s,r,a=t._acceleration;if(t._accelDeviceEvent===window.DeviceMotionEvent){var o=e.accelerationIncludingGravity;n=t._accelMinus*o.x*.1,s=t._accelMinus*o.y*.1,r=.1*o.z}else n=e.gamma/90*.981,s=-e.beta/90*.981,r=e.alpha/90*.981;a.x=n,a.y=s,a.z=r,a.timestamp=e.timeStamp||Date.now();var h=a.x;i.orientation===l.UIInterfaceOrientationLandscapeRight?(a.x=-a.y,a.y=h):i.orientation===l.UIInterfaceOrientationLandscapeLeft?(a.x=a.y,a.y=-h):i.orientation===l.UIInterfaceOrientationPortraitUpsideDown&&(a.x=-a.x,a.y=-a.y)}},l.AffineTransform=function(e,t,i,n,s,r){this.a=e,this.b=t,this.c=i,this.d=n,this.tx=s,this.ty=r},l.affineTransformMake=function(e,t,i,n,s,r){return{a:e,b:t,c:i,d:n,tx:s,ty:r}},l.pointApplyAffineTransform=function(e,t,i){var n,s;return void 0===i?(i=t,n=e.x,s=e.y):(n=e,s=t),{x:i.a*n+i.c*s+i.tx,y:i.b*n+i.d*s+i.ty}},l._pointApplyAffineTransform=function(e,t,i){return l.pointApplyAffineTransform(e,t,i)},l.sizeApplyAffineTransform=function(e,t){return{width:t.a*e.width+t.c*e.height,height:t.b*e.width+t.d*e.height}},l.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},l.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},l.rectApplyAffineTransform=function(e,t){var i=l.rectGetMinY(e),n=l.rectGetMinX(e),s=l.rectGetMaxX(e),r=l.rectGetMaxY(e),a=l.pointApplyAffineTransform(n,i,t),o=l.pointApplyAffineTransform(s,i,t),h=l.pointApplyAffineTransform(n,r,t),d=l.pointApplyAffineTransform(s,r,t),c=Math.min(a.x,o.x,h.x,d.x),u=Math.max(a.x,o.x,h.x,d.x),p=Math.min(a.y,o.y,h.y,d.y),m=Math.max(a.y,o.y,h.y,d.y);return l.rect(c,p,u-c,m-p)},l._rectApplyAffineTransformIn=function(e,t){var i=l.rectGetMinY(e),n=l.rectGetMinX(e),s=l.rectGetMaxX(e),r=l.rectGetMaxY(e),a=l.pointApplyAffineTransform(n,i,t),o=l.pointApplyAffineTransform(s,i,t),h=l.pointApplyAffineTransform(n,r,t),d=l.pointApplyAffineTransform(s,r,t),c=Math.min(a.x,o.x,h.x,d.x),u=Math.max(a.x,o.x,h.x,d.x),p=Math.min(a.y,o.y,h.y,d.y),m=Math.max(a.y,o.y,h.y,d.y);return e.x=c,e.y=p,e.width=u-c,e.height=m-p,e},l.affineTransformTranslate=function(e,t,i){return{a:e.a,b:e.b,c:e.c,d:e.d,tx:e.tx+e.a*t+e.c*i,ty:e.ty+e.b*t+e.d*i}},l.affineTransformScale=function(e,t,i){return{a:e.a*t,b:e.b*t,c:e.c*i,d:e.d*i,tx:e.tx,ty:e.ty}},l.affineTransformRotate=function(e,t){var i=Math.sin(t),n=Math.cos(t);return{a:e.a*n+e.c*i,b:e.b*n+e.d*i,c:e.c*n-e.a*i,d:e.d*n-e.b*i,tx:e.tx,ty:e.ty}},l.affineTransformConcat=function(e,t){return{a:e.a*t.a+e.b*t.c,b:e.a*t.b+e.b*t.d,c:e.c*t.a+e.d*t.c,d:e.c*t.b+e.d*t.d,tx:e.tx*t.a+e.ty*t.c+t.tx,ty:e.tx*t.b+e.ty*t.d+t.ty}},l.affineTransformConcatIn=function(e,t){var i=e.a,n=e.b,s=e.c,r=e.d,a=e.tx,o=e.ty;return e.a=i*t.a+n*t.c,e.b=i*t.b+n*t.d,e.c=s*t.a+r*t.c,e.d=s*t.b+r*t.d,e.tx=a*t.a+o*t.c+t.tx,e.ty=a*t.b+o*t.d+t.ty,e},l.affineTransformEqualToTransform=function(e,t){return e.a===t.a&&e.b===t.b&&e.c===t.c&&e.d===t.d&&e.tx===t.tx&&e.ty===t.ty},l.affineTransformInvert=function(e){var t=1/(e.a*e.d-e.b*e.c);return{a:t*e.d,b:-t*e.b,c:-t*e.c,d:t*e.a,tx:t*(e.c*e.ty-e.d*e.tx),ty:t*(e.b*e.tx-e.a*e.ty)}},l.affineTransformInvertOut=function(e,t){var i=e.a,n=e.b,s=e.c,r=e.d,a=1/(i*r-n*s);t.a=a*r,t.b=-a*n,t.c=-a*s,t.d=a*i,t.tx=a*(s*e.ty-r*e.tx),t.ty=a*(n*e.tx-i*e.ty)},l.POINT_EPSILON=parseFloat("1.192092896e-07F"),l.pNeg=function(e){return l.p(-e.x,-e.y)},l.pAdd=function(e,t){return l.p(e.x+t.x,e.y+t.y)},l.pSub=function(e,t){return l.p(e.x-t.x,e.y-t.y)},l.pMult=function(e,t){return l.p(e.x*t,e.y*t)},l.pMidpoint=function(e,t){return l.pMult(l.pAdd(e,t),.5)},l.pDot=function(e,t){return e.x*t.x+e.y*t.y},l.pCross=function(e,t){return e.x*t.y-e.y*t.x},l.pPerp=function(e){return l.p(-e.y,e.x)},l.pRPerp=function(e){return l.p(e.y,-e.x)},l.pProject=function(e,t){return l.pMult(t,l.pDot(e,t)/l.pDot(t,t))},l.pRotate=function(e,t){return l.p(e.x*t.x-e.y*t.y,e.x*t.y+e.y*t.x)},l.pUnrotate=function(e,t){return l.p(e.x*t.x+e.y*t.y,e.y*t.x-e.x*t.y)},l.pLengthSQ=function(e){return l.pDot(e,e)},l.pDistanceSQ=function(e,t){return l.pLengthSQ(l.pSub(e,t))},l.pLength=function(e){return Math.sqrt(l.pLengthSQ(e))},l.pDistance=function(e,t){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},l.pNormalize=function(e){var t=l.pLength(e);return 0===t?l.p(e):l.pMult(e,1/t)},l.pForAngle=function(e){return l.p(Math.cos(e),Math.sin(e))},l.pToAngle=function(e){return Math.atan2(e.y,e.x)},l.clampf=function(e,t,i){if(t>i){var n=t;t=i,i=n}return e<t?t:e<i?e:i},l.pClamp=function(e,t,i){return l.p(l.clampf(e.x,t.x,i.x),l.clampf(e.y,t.y,i.y))},l.pFromSize=function(e){return l.p(e.width,e.height)},l.pCompOp=function(e,t){return l.p(t(e.x),t(e.y))},l.pLerp=function(e,t,i){var n={x:e.x,y:e.y};return n.x+=i*(t.x-e.x),n.y+=i*(t.y-e.y),n},l.pFuzzyEqual=function(e,t,i){return e.x-i<=t.x&&t.x<=e.x+i&&e.y-i<=t.y&&t.y<=e.y+i},l.pCompMult=function(e,t){return l.p(e.x*t.x,e.y*t.y)},l.pAngleSigned=function(e,t){var i=l.pNormalize(e),n=l.pNormalize(t),s=Math.atan2(i.x*n.y-i.y*n.x,l.pDot(i,n));return Math.abs(s)<l.POINT_EPSILON?0:s},l.pAngle=function(e,t){var i=Math.acos(l.pDot(l.pNormalize(e),l.pNormalize(t)));return Math.abs(i)<l.POINT_EPSILON?0:i},l.pRotateByAngle=function(e,t,i){var n=l.pSub(e,t),s=Math.cos(i),r=Math.sin(i),a=n.x;return n.x=a*s-n.y*r+t.x,n.y=a*r+n.y*s+t.y,n},l.pLineIntersect=function(e,t,i,n,s){if(e.x===t.x&&e.y===t.y||i.x===n.x&&i.y===n.y)return!1;var r=t.x-e.x,a=t.y-e.y,o=n.x-i.x,h=n.y-i.y,l=e.x-i.x,d=e.y-i.y,c=h*r-o*a;return s.x=o*d-h*l,s.y=r*d-a*l,0===c?0===s.x||0===s.y:(s.x=s.x/c,s.y=s.y/c,!0)},l.pSegmentIntersect=function(e,t,i,n){var s=l.p(0,0);return!!(l.pLineIntersect(e,t,i,n,s)&&s.x>=0&&s.x<=1&&s.y>=0&&s.y<=1)},l.pIntersectPoint=function(e,t,i,n){var s=l.p(0,0);if(l.pLineIntersect(e,t,i,n,s)){var r=l.p(0,0);return r.x=e.x+s.x*(t.x-e.x),r.y=e.y+s.x*(t.y-e.y),r}return l.p(0,0)},l.pSameAs=function(e,t){return null!=e&&null!=t&&(e.x===t.x&&e.y===t.y)},l.pZeroIn=function(e){e.x=0,e.y=0},l.pIn=function(e,t){e.x=t.x,e.y=t.y},l.pMultIn=function(e,t){e.x*=t,e.y*=t},l.pSubIn=function(e,t){e.x-=t.x,e.y-=t.y},l.pAddIn=function(e,t){e.x+=t.x,e.y+=t.y},l.pNormalizeIn=function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);0!==t&&l.pMultIn(e,1/t)},l.vertexLineToPolygon=function(e,t,i,n,s){if(!((s+=n)<=1)){t*=.5;for(var r,a=s-1,o=n;o<s;o++){r=2*o;var h,d=l.p(e[2*o],e[2*o+1]);if(0===o)h=l.pPerp(l.pNormalize(l.pSub(d,l.p(e[2*(o+1)],e[2*(o+1)+1]))));else if(o===a)h=l.pPerp(l.pNormalize(l.pSub(l.p(e[2*(o-1)],e[2*(o-1)+1]),d)));else{var c=l.p(e[2*(o-1)],e[2*(o-1)+1]),u=l.p(e[2*(o+1)],e[2*(o+1)+1]),p=l.pNormalize(l.pSub(u,d)),m=l.pNormalize(l.pSub(c,d)),_=Math.acos(l.pDot(p,m));h=_<l.degreesToRadians(70)?l.pPerp(l.pNormalize(l.pMidpoint(p,m))):_<l.degreesToRadians(170)?l.pNormalize(l.pMidpoint(p,m)):l.pPerp(l.pNormalize(l.pSub(u,c)))}h=l.pMult(h,t),i[2*r]=d.x+h.x,i[2*r+1]=d.y+h.y,i[2*(r+1)]=d.x-h.x,i[2*(r+1)+1]=d.y-h.y}for(o=n=0===n?0:n-1;o<a;o++){var g=(r=2*o)+2,T=l.vertex2(i[2*r],i[2*r+1]),f=l.vertex2(i[2*(r+1)],i[2*(r+1)+1]),S=l.vertex2(i[2*g],i[2*g]),w=l.vertex2(i[2*(g+1)],i[2*(g+1)+1]),v=!l.vertexLineIntersect(T.x,T.y,w.x,w.y,f.x,f.y,S.x,S.y);v.isSuccess||(v.value<0||v.value>1)&&(v.isSuccess=!0),v.isSuccess&&(i[2*g]=w.x,i[2*g+1]=w.y,i[2*(g+1)]=S.x,i[2*(g+1)+1]=S.y)}}},l.vertexLineIntersect=function(e,t,i,n,s,r,a,o){var h,l,d,c;return e===i&&t===n||s===a&&r===o?{isSuccess:!1,value:0}:(i-=e,n-=t,s-=e,r-=t,a-=e,o-=t,h=Math.sqrt(i*i+n*n),l=i/h,d=n/h,c=s*l+r*d,r=r*l-s*d,s=c,c=a*l+o*d,o=o*l-a*d,a=c,r===o?{isSuccess:!1,value:0}:{isSuccess:!0,value:(a+(s-a)*o/(o-r))/h})},l.vertexListIsClockwise=function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t],s=e[(t+1)%i],r=e[(t+2)%i];if(l.pCross(l.pSub(s,n),l.pSub(r,s))>0)return!1}return!0},l.CGAffineToGL=function(e,t){t[2]=t[3]=t[6]=t[7]=t[8]=t[9]=t[11]=t[14]=0,t[10]=t[15]=1,t[0]=e.a,t[4]=e.c,t[12]=e.tx,t[1]=e.b,t[5]=e.d,t[13]=e.ty},l.GLToCGAffine=function(e,t){t.a=e[0],t.c=e[4],t.tx=e[12],t.b=e[1],t.d=e[5],t.ty=e[13]},l.Touch=l.Class.extend({_lastModified:0,_point:null,_prevPoint:null,_id:0,_startPointCaptured:!1,_startPoint:null,ctor:function(e,t,i){this.setTouchInfo(i,e,t)},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getDelta:function(){return l.pSub(this._point,this._prevPoint)},getLocationInView:function(){return{x:this._point.x,y:this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getID:function(){return this._id},getId:function(){return l.log("getId is deprecated. Please use getID instead."),this._id},setTouchInfo:function(e,t,i){this._prevPoint=this._point,this._point=l.p(t||0,i||0),this._id=e,this._startPointCaptured||(this._startPoint=l.p(this._point),l.view._convertPointWithScale(this._startPoint),this._startPointCaptured=!0)},_setPoint:function(e,t){void 0===t?(this._point.x=e.x,this._point.y=e.y):(this._point.x=e,this._point.y=t)},_setPrevPoint:function(e,t){this._prevPoint=void 0===t?l.p(e.x,e.y):l.p(e||0,t||0)}}),l.Event=l.Class.extend({_type:0,_isStopped:!1,_currentTarget:null,_setCurrentTarget:function(e){this._currentTarget=e},ctor:function(e){this._type=e},getType:function(){return this._type},stopPropagation:function(){this._isStopped=!0},isStopped:function(){return this._isStopped},getCurrentTarget:function(){return this._currentTarget}}),l.Event.TOUCH=0,l.Event.KEYBOARD=1,l.Event.ACCELERATION=2,l.Event.MOUSE=3,l.Event.FOCUS=4,l.Event.CUSTOM=6,l.EventCustom=l.Event.extend({_eventName:null,_userData:null,ctor:function(e){l.Event.prototype.ctor.call(this,l.Event.CUSTOM),this._eventName=e},setUserData:function(e){this._userData=e},getUserData:function(){return this._userData},getEventName:function(){return this._eventName}}),l.EventMouse=l.Event.extend({_eventType:0,_button:0,_x:0,_y:0,_prevX:0,_prevY:0,_scrollX:0,_scrollY:0,ctor:function(e){l.Event.prototype.ctor.call(this,l.Event.MOUSE),this._eventType=e},setScrollData:function(e,t){this._scrollX=e,this._scrollY=t},getScrollX:function(){return this._scrollX},getScrollY:function(){return this._scrollY},setLocation:function(e,t){this._x=e,this._y=t},getLocation:function(){return{x:this._x,y:this._y}},getLocationInView:function(){return{x:this._x,y:l.view._designResolutionSize.height-this._y}},_setPrevCursor:function(e,t){this._prevX=e,this._prevY=t},getDelta:function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},getDeltaX:function(){return this._x-this._prevX},getDeltaY:function(){return this._y-this._prevY},setButton:function(e){this._button=e},getButton:function(){return this._button},getLocationX:function(){return this._x},getLocationY:function(){return this._y}}),l.EventMouse.NONE=0,l.EventMouse.DOWN=1,l.EventMouse.UP=2,l.EventMouse.MOVE=3,l.EventMouse.SCROLL=4,l.EventMouse.BUTTON_LEFT=0,l.EventMouse.BUTTON_RIGHT=2,l.EventMouse.BUTTON_MIDDLE=1,l.EventMouse.BUTTON_4=3,l.EventMouse.BUTTON_5=4,l.EventMouse.BUTTON_6=5,l.EventMouse.BUTTON_7=6,l.EventMouse.BUTTON_8=7,l.EventTouch=l.Event.extend({_eventCode:0,_touches:null,ctor:function(e){l.Event.prototype.ctor.call(this,l.Event.TOUCH),this._touches=e||[]},getEventCode:function(){return this._eventCode},getTouches:function(){return this._touches},_setEventCode:function(e){this._eventCode=e},_setTouches:function(e){this._touches=e}}),l.EventTouch.MAX_TOUCHES=5,l.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3},l.EventFocus=l.Event.extend({_widgetGetFocus:null,_widgetLoseFocus:null,ctor:function(e,t){l.Event.prototype.ctor.call(this,l.Event.FOCUS),this._widgetGetFocus=t,this._widgetLoseFocus=e}}),l.EventListener=l.Class.extend({_onEvent:null,_type:0,_listenerID:null,_registered:!1,_fixedPriority:0,_node:null,_paused:!0,_isEnabled:!0,ctor:function(e,t,i){this._onEvent=i,this._type=e||0,this._listenerID=t||""},_setPaused:function(e){this._paused=e},_isPaused:function(){return this._paused},_setRegistered:function(e){this._registered=e},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(e){this._fixedPriority=e},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(e){this._node=e},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!==this._onEvent},clone:function(){return null},setEnabled:function(e){this._isEnabled=e},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}}),l.EventListener.UNKNOWN=0,l.EventListener.TOUCH_ONE_BY_ONE=1,l.EventListener.TOUCH_ALL_AT_ONCE=2,l.EventListener.KEYBOARD=3,l.EventListener.MOUSE=4,l.EventListener.ACCELERATION=6,l.EventListener.FOCUS=7,l.EventListener.CUSTOM=8,l._EventListenerCustom=l.EventListener.extend({_onCustomEvent:null,ctor:function(e,t,i){this._onCustomEvent=t,this._target=i,l.EventListener.prototype.ctor.call(this,l.EventListener.CUSTOM,e,this._callback)},_callback:function(e){null!==this._onCustomEvent&&this._onCustomEvent.call(this._target,e)},checkAvailable:function(){return l.EventListener.prototype.checkAvailable.call(this)&&null!==this._onCustomEvent},clone:function(){return new l._EventListenerCustom(this._listenerID,this._onCustomEvent)}}),l._EventListenerCustom.create=function(e,t){return new l._EventListenerCustom(e,t)},l._EventListenerMouse=l.EventListener.extend({onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){l.EventListener.prototype.ctor.call(this,l.EventListener.MOUSE,l._EventListenerMouse.LISTENER_ID,this._callback)},_callback:function(e){var t=l.EventMouse;switch(e._eventType){case t.DOWN:this.onMouseDown&&this.onMouseDown(e);break;case t.UP:this.onMouseUp&&this.onMouseUp(e);break;case t.MOVE:this.onMouseMove&&this.onMouseMove(e);break;case t.SCROLL:this.onMouseScroll&&this.onMouseScroll(e)}},clone:function(){var e=new l._EventListenerMouse;return e.onMouseDown=this.onMouseDown,e.onMouseUp=this.onMouseUp,e.onMouseMove=this.onMouseMove,e.onMouseScroll=this.onMouseScroll,e},checkAvailable:function(){return!0}}),l._EventListenerMouse.LISTENER_ID="__cc_mouse",l._EventListenerMouse.create=function(){return new l._EventListenerMouse},l._EventListenerTouchOneByOne=l.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){l.EventListener.prototype.ctor.call(this,l.EventListener.TOUCH_ONE_BY_ONE,l._EventListenerTouchOneByOne.LISTENER_ID,null),this._claimedTouches=[]},setSwallowTouches:function(e){this.swallowTouches=e},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var e=new l._EventListenerTouchOneByOne;return e.onTouchBegan=this.onTouchBegan,e.onTouchMoved=this.onTouchMoved,e.onTouchEnded=this.onTouchEnded,e.onTouchCancelled=this.onTouchCancelled,e.swallowTouches=this.swallowTouches,e},checkAvailable:function(){return!!this.onTouchBegan||(l.log(l._LogInfos._EventListenerTouchOneByOne_checkAvailable),!1)}}),l._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one",l._EventListenerTouchOneByOne.create=function(){return new l._EventListenerTouchOneByOne},l._EventListenerTouchAllAtOnce=l.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){l.EventListener.prototype.ctor.call(this,l.EventListener.TOUCH_ALL_AT_ONCE,l._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var e=new l._EventListenerTouchAllAtOnce;return e.onTouchesBegan=this.onTouchesBegan,e.onTouchesMoved=this.onTouchesMoved,e.onTouchesEnded=this.onTouchesEnded,e.onTouchesCancelled=this.onTouchesCancelled,e},checkAvailable:function(){return null!==this.onTouchesBegan||null!==this.onTouchesMoved||null!==this.onTouchesEnded||null!==this.onTouchesCancelled||(l.log(l._LogInfos._EventListenerTouchAllAtOnce_checkAvailable),!1)}}),l._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once",l._EventListenerTouchAllAtOnce.create=function(){return new l._EventListenerTouchAllAtOnce},l.EventListener.create=function(e){l.assert(e&&e.event,l._LogInfos.EventListener_create);var t=e.event;delete e.event;var i=null;t===l.EventListener.TOUCH_ONE_BY_ONE?i=new l._EventListenerTouchOneByOne:t===l.EventListener.TOUCH_ALL_AT_ONCE?i=new l._EventListenerTouchAllAtOnce:t===l.EventListener.MOUSE?i=new l._EventListenerMouse:t===l.EventListener.CUSTOM?(i=new l._EventListenerCustom(e.eventName,e.callback),delete e.eventName,delete e.callback):t===l.EventListener.KEYBOARD?i=new l._EventListenerKeyboard:t===l.EventListener.ACCELERATION?(i=new l._EventListenerAcceleration(e.callback),delete e.callback):t===l.EventListener.FOCUS&&(i=new l._EventListenerFocus);for(var n in e)i[n]=e[n];return i},l._EventListenerFocus=l.EventListener.extend({clone:function(){var e=new l._EventListenerFocus;return e.onFocusChanged=this.onFocusChanged,e},checkAvailable:function(){return!!this.onFocusChanged||(l.log("Invalid EventListenerFocus!"),!1)},onFocusChanged:null,ctor:function(){l.EventListener.prototype.ctor.call(this,l.EventListener.FOCUS,l._EventListenerFocus.LISTENER_ID,this._callback)},_callback:function(e){this.onFocusChanged&&this.onFocusChanged(e._widgetLoseFocus,e._widgetGetFocus)}}),l._EventListenerFocus.LISTENER_ID="__cc_focus_event",function(){function e(e){var t=l.Event,i=e._type;return i===t.ACCELERATION?l._EventListenerAcceleration.LISTENER_ID:i===t.CUSTOM?e._eventName:i===t.KEYBOARD?l._EventListenerKeyboard.LISTENER_ID:i===t.MOUSE?l._EventListenerMouse.LISTENER_ID:i===t.FOCUS?l._EventListenerFocus.LISTENER_ID:(i===t.TOUCH&&l.log(l._LogInfos.__getListenerID),"")}l._EventListenerVector=l.Class.extend({_fixedListeners:null,_sceneGraphListeners:null,gt0Index:0,ctor:function(){this._fixedListeners=[],this._sceneGraphListeners=[]},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(e){0===e._getFixedPriority()?this._sceneGraphListeners.push(e):this._fixedListeners.push(e)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0,this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}}),l.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_toRemovedListeners:[],_dirtyNodes:[],_inDispatch:0,_isEnabled:!1,_nodePriorityIndex:0,_internalCustomListenerIDs:[l.game.EVENT_HIDE,l.game.EVENT_SHOW],_setDirtyForNode:function(e){null!=this._nodeListenersMap[e.__instanceId]&&this._dirtyNodes.push(e);for(var t=e.getChildren(),i=0,n=t.length;i<n;i++)this._setDirtyForNode(t[i])},pauseTarget:function(e,t){var i,n,s=this._nodeListenersMap[e.__instanceId];if(s)for(i=0,n=s.length;i<n;i++)s[i]._setPaused(!0);if(!0===t){var r=e.getChildren();for(i=0,n=r.length;i<n;i++)this.pauseTarget(r[i],!0)}},resumeTarget:function(e,t){var i,n,s=this._nodeListenersMap[e.__instanceId];if(s)for(i=0,n=s.length;i<n;i++)s[i]._setPaused(!1);if(this._setDirtyForNode(e),!0===t){var r=e.getChildren();for(i=0,n=r.length;i<n;i++)this.resumeTarget(r[i],!0)}},_addListener:function(e){0===this._inDispatch?this._forceAddEventListener(e):this._toAddedListeners.push(e)},_forceAddEventListener:function(e){var t=e._getListenerID(),i=this._listenersMap[t];if(i||(i=new l._EventListenerVector,this._listenersMap[t]=i),i.push(e),0===e._getFixedPriority()){this._setDirty(t,this.DIRTY_SCENE_GRAPH_PRIORITY);var n=e._getSceneGraphPriority();null===n&&l.log(l._LogInfos.eventManager__forceAddEventListener),this._associateNodeAndEventListener(n,e),n.isRunning()&&this.resumeTarget(n)}else this._setDirty(t,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(e){return this._listenersMap[e]},_updateDirtyFlagForSceneGraph:function(){if(0!==this._dirtyNodes.length){for(var e,t,i=this._dirtyNodes,n=this._nodeListenersMap,s=0,r=i.length;s<r;s++)if(e=n[i[s].__instanceId])for(var a=0,o=e.length;a<o;a++)(t=e[a])&&this._setDirty(t._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyNodes.length=0}},_removeAllListenersInVector:function(e){if(e)for(var t,i=0;i<e.length;)(t=e[i])._setRegistered(!1),null!=t._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(t._getSceneGraphPriority(),t),t._setSceneGraphPriority(null)),0===this._inDispatch?l.arrayRemoveObject(e,t):++i},_removeListenersForListenerID:function(e){var t,i=this._listenersMap[e];if(i){var n=i.getFixedPriorityListeners(),s=i.getSceneGraphPriorityListeners();this._removeAllListenersInVector(s),this._removeAllListenersInVector(n),delete this._priorityDirtyFlagMap[e],this._inDispatch||i.clear(),delete this._listenersMap[e]}var r,a=this._toAddedListeners;for(t=0;t<a.length;)(r=a[t])&&r._getListenerID()===e?l.arrayRemoveObject(a,r):++t},_sortEventListeners:function(e){var t=this.DIRTY_NONE,i=this._priorityDirtyFlagMap;if(i[e]&&(t=i[e]),t!==this.DIRTY_NONE&&(i[e]=this.DIRTY_NONE,t&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(e),t&this.DIRTY_SCENE_GRAPH_PRIORITY)){var n=l.director.getRunningScene();n?this._sortListenersOfSceneGraphPriority(e,n):i[e]=this.DIRTY_SCENE_GRAPH_PRIORITY}},_sortListenersOfSceneGraphPriority:function(e,t){var i=this._getListeners(e);if(i){var n=i.getSceneGraphPriorityListeners();n&&0!==n.length&&(this._nodePriorityIndex=0,this._nodePriorityMap={},this._visitTarget(t,!0),i.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))}},_sortEventListenersOfSceneGraphPriorityDes:function(e,t){var i=l.eventManager._nodePriorityMap,n=e._getSceneGraphPriority(),s=t._getSceneGraphPriority();return t&&s&&i[s.__instanceId]?e&&n&&i[n.__instanceId]?i[t._getSceneGraphPriority().__instanceId]-i[e._getSceneGraphPriority().__instanceId]:1:-1},_sortListenersOfFixedPriority:function(e){var t=this._listenersMap[e];if(t){var i=t.getFixedPriorityListeners();if(i&&0!==i.length){i.sort(this._sortListenersOfFixedPriorityAsc);for(var n=0,s=i.length;n<s&&!(i[n]._getFixedPriority()>=0);)++n;t.gt0Index=n}}},_sortListenersOfFixedPriorityAsc:function(e,t){return e._getFixedPriority()-t._getFixedPriority()},_onUpdateListeners:function(e){var t,i,n,s=e.getFixedPriorityListeners(),r=e.getSceneGraphPriorityListeners(),a=this._toRemovedListeners;if(r)for(t=0;t<r.length;)(i=r[t])._isRegistered()?++t:(l.arrayRemoveObject(r,i),-1!==(n=a.indexOf(i))&&a.splice(n,1));if(s)for(t=0;t<s.length;)(i=s[t])._isRegistered()?++t:(l.arrayRemoveObject(s,i),-1!==(n=a.indexOf(i))&&a.splice(n,1));r&&0===r.length&&e.clearSceneGraphListeners(),s&&0===s.length&&e.clearFixedListeners()},frameUpdateListeners:function(){var e=this._listenersMap,t=this._priorityDirtyFlagMap;for(var i in e)e[i].empty()&&(delete t[i],delete e[i]);var n=this._toAddedListeners;if(0!==n.length){for(var s=0,r=n.length;s<r;s++)this._forceAddEventListener(n[s]);n.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()},_updateTouchListeners:function(e){var t=this._inDispatch;if(l.assert(t>0,l._LogInfos.EventManager__updateListeners),!(t>1)){var i;(i=this._listenersMap[l._EventListenerTouchOneByOne.LISTENER_ID])&&this._onUpdateListeners(i),(i=this._listenersMap[l._EventListenerTouchAllAtOnce.LISTENER_ID])&&this._onUpdateListeners(i),l.assert(1===t,l._LogInfos.EventManager__updateListeners_2);var n=this._toAddedListeners;if(0!==n.length){for(var s=0,r=n.length;s<r;s++)this._forceAddEventListener(n[s]);n.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()}},_cleanToRemovedListeners:function(){for(var e=this._toRemovedListeners,t=0;t<e.length;t++){var i=e[t],n=this._listenersMap[i._getListenerID()];if(n){var s,r=n.getFixedPriorityListeners(),a=n.getSceneGraphPriorityListeners();a&&-1!==(s=a.indexOf(i))&&a.splice(s,1),r&&-1!==(s=r.indexOf(i))&&r.splice(s,1)}}e.length=0},_onTouchEventCallback:function(e,t){if(!e._isRegistered)return!1;var i=t.event,n=t.selTouch;i._setCurrentTarget(e._node);var s,r=!1,a=i.getEventCode(),o=l.EventTouch.EventCode;return a===o.BEGAN?e.onTouchBegan&&(r=e.onTouchBegan(n,i))&&e._registered&&e._claimedTouches.push(n):e._claimedTouches.length>0&&-1!==(s=e._claimedTouches.indexOf(n))&&(r=!0,a===o.MOVED&&e.onTouchMoved?e.onTouchMoved(n,i):a===o.ENDED?(e.onTouchEnded&&e.onTouchEnded(n,i),e._registered&&e._claimedTouches.splice(s,1)):a===o.CANCELLED&&(e.onTouchCancelled&&e.onTouchCancelled(n,i),e._registered&&e._claimedTouches.splice(s,1))),i.isStopped()?(l.eventManager._updateTouchListeners(i),!0):!!(r&&e._registered&&e.swallowTouches)&&(t.needsMutableSet&&t.touches.splice(n,1),!0)},_dispatchTouchEvent:function(e){this._sortEventListeners(l._EventListenerTouchOneByOne.LISTENER_ID),this._sortEventListeners(l._EventListenerTouchAllAtOnce.LISTENER_ID);var t=this._getListeners(l._EventListenerTouchOneByOne.LISTENER_ID),i=this._getListeners(l._EventListenerTouchAllAtOnce.LISTENER_ID);if(null!==t||null!==i){var n=e.getTouches(),s=l.copyArray(n),r={event:e,needsMutableSet:t&&i,touches:s,selTouch:null};if(t)for(var a=0;a<n.length;a++)if(r.selTouch=n[a],this._dispatchEventToListeners(t,this._onTouchEventCallback,r),e.isStopped())return;i&&s.length>0&&(this._dispatchEventToListeners(i,this._onTouchesEventCallback,{event:e,touches:s}),e.isStopped())||this._updateTouchListeners(e)}},_onTouchesEventCallback:function(e,t){if(!e._registered)return!1;var i=l.EventTouch.EventCode,n=t.event,s=t.touches,r=n.getEventCode();return n._setCurrentTarget(e._node),r===i.BEGAN&&e.onTouchesBegan?e.onTouchesBegan(s,n):r===i.MOVED&&e.onTouchesMoved?e.onTouchesMoved(s,n):r===i.ENDED&&e.onTouchesEnded?e.onTouchesEnded(s,n):r===i.CANCELLED&&e.onTouchesCancelled&&e.onTouchesCancelled(s,n),!!n.isStopped()&&(l.eventManager._updateTouchListeners(n),!0)},_associateNodeAndEventListener:function(e,t){var i=this._nodeListenersMap[e.__instanceId];i||(i=[],this._nodeListenersMap[e.__instanceId]=i),i.push(t)},_dissociateNodeAndEventListener:function(e,t){var i=this._nodeListenersMap[e.__instanceId];i&&(l.arrayRemoveObject(i,t),0===i.length&&delete this._nodeListenersMap[e.__instanceId])},_dispatchEventToListeners:function(e,t,i){var n,s,r=!1,a=e.getFixedPriorityListeners(),o=e.getSceneGraphPriorityListeners(),h=0;if(a&&0!==a.length)for(;h<e.gt0Index;++h)if((s=a[h]).isEnabled()&&!s._isPaused()&&s._isRegistered()&&t(s,i)){r=!0;break}if(o&&!r)for(n=0;n<o.length;n++)if((s=o[n]).isEnabled()&&!s._isPaused()&&s._isRegistered()&&t(s,i)){r=!0;break}if(a&&!r)for(;h<a.length;++h)if((s=a[h]).isEnabled()&&!s._isPaused()&&s._isRegistered()&&t(s,i)){r=!0;break}},_setDirty:function(e,t){var i=this._priorityDirtyFlagMap;null==i[e]?i[e]=t:i[e]=t|i[e]},_visitTarget:function(e,t){var i=e.getChildren(),n=0,s=i.length,r=this._globalZOrderNodeMap,a=this._nodeListenersMap;if(s>0){for(var o;n<s&&((o=i[n])&&o.getLocalZOrder()<0);n++)this._visitTarget(o,!1);for(null!=a[e.__instanceId]&&(r[e.getGlobalZOrder()]||(r[e.getGlobalZOrder()]=[]),r[e.getGlobalZOrder()].push(e.__instanceId));n<s;n++)(o=i[n])&&this._visitTarget(o,!1)}else null!=a[e.__instanceId]&&(r[e.getGlobalZOrder()]||(r[e.getGlobalZOrder()]=[]),r[e.getGlobalZOrder()].push(e.__instanceId));if(t){var h=[];for(var l in r)h.push(l);h.sort(this._sortNumberAsc);var d,c,u=h.length,p=this._nodePriorityMap;for(n=0;n<u;n++)for(d=r[h[n]],c=0;c<d.length;c++)p[d[c]]=++this._nodePriorityIndex;this._globalZOrderNodeMap={}}},_sortNumberAsc:function(e,t){return e-t},addListener:function(e,t){if(l.assert(e&&t,l._LogInfos.eventManager_addListener_2),e instanceof l.EventListener){if(e._isRegistered())return void l.log(l._LogInfos.eventManager_addListener_4)}else l.assert(!l.isNumber(t),l._LogInfos.eventManager_addListener_3),e=l.EventListener.create(e);if(e.checkAvailable()){if(l.isNumber(t)){if(0===t)return void l.log(l._LogInfos.eventManager_addListener);e._setSceneGraphPriority(null),e._setFixedPriority(t),e._setRegistered(!0),e._setPaused(!1),this._addListener(e)}else e._setSceneGraphPriority(t),e._setFixedPriority(0),e._setRegistered(!0),this._addListener(e);return e}},addCustomListener:function(e,t,i){var n=new l._EventListenerCustom(e,t,i);return this.addListener(n,1),n},removeListener:function(e){if(null!=e){var t,i=this._listenersMap;for(var n in i){var s=i[n],r=s.getFixedPriorityListeners(),a=s.getSceneGraphPriorityListeners();if((t=this._removeListenerInVector(a,e))?this._setDirty(e._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(t=this._removeListenerInVector(r,e))&&this._setDirty(e._getListenerID(),this.DIRTY_FIXED_PRIORITY),s.empty()&&(delete this._priorityDirtyFlagMap[e._getListenerID()],delete i[n]),t)break}if(!t)for(var o=this._toAddedListeners,h=0,d=o.length;h<d;h++){var c=o[h];if(c===e){l.arrayRemoveObject(o,c),c._setRegistered(!1);break}}}},_removeListenerInCallback:function(e,t){if(null==e)return!1;for(var i=0,n=e.length;i<n;i++){var s=e[i];if(s._onCustomEvent===t||s._onEvent===t)return s._setRegistered(!1),null!=s._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(s._getSceneGraphPriority(),s),s._setSceneGraphPriority(null)),0===this._inDispatch&&l.arrayRemoveObject(e,s),!0}return!1},_removeListenerInVector:function(e,t){if(null==e)return!1;for(var i=0,n=e.length;i<n;i++){var s=e[i];if(s===t)return s._setRegistered(!1),null!=s._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(s._getSceneGraphPriority(),s),s._setSceneGraphPriority(null)),0===this._inDispatch?l.arrayRemoveObject(e,s):this._toRemovedListeners.push(s),!0}return!1},removeListeners:function(e,t){var i=this;if(e instanceof l.Node){delete i._nodePriorityMap[e.__instanceId],l.arrayRemoveObject(i._dirtyNodes,e);var n,s=i._nodeListenersMap[e.__instanceId];if(s){var r=l.copyArray(s);for(n=0;n<r.length;n++)i.removeListener(r[n]);r.length=0}var a=i._toAddedListeners;for(n=0;n<a.length;){var o=a[n];o._getSceneGraphPriority()===e?(o._setSceneGraphPriority(null),o._setRegistered(!1),a.splice(n,1)):++n}if(!0===t){var h,d=e.getChildren();for(n=0,h=d.length;n<h;n++)i.removeListeners(d[n],!0)}}else e===l.EventListener.TOUCH_ONE_BY_ONE?i._removeListenersForListenerID(l._EventListenerTouchOneByOne.LISTENER_ID):e===l.EventListener.TOUCH_ALL_AT_ONCE?i._removeListenersForListenerID(l._EventListenerTouchAllAtOnce.LISTENER_ID):e===l.EventListener.MOUSE?i._removeListenersForListenerID(l._EventListenerMouse.LISTENER_ID):e===l.EventListener.ACCELERATION?i._removeListenersForListenerID(l._EventListenerAcceleration.LISTENER_ID):e===l.EventListener.KEYBOARD?i._removeListenersForListenerID(l._EventListenerKeyboard.LISTENER_ID):l.log(l._LogInfos.eventManager_removeListeners)},removeCustomListeners:function(e){this._removeListenersForListenerID(e)},removeAllListeners:function(){var e=this._listenersMap,t=this._internalCustomListenerIDs;for(var i in e)-1===t.indexOf(i)&&this._removeListenersForListenerID(i)},setPriority:function(e,t){if(null!=e){var i=this._listenersMap;for(var n in i){var s=i[n].getFixedPriorityListeners();if(s&&-1!==s.indexOf(e))return null!=e._getSceneGraphPriority()&&l.log(l._LogInfos.eventManager_setPriority),void(e._getFixedPriority()!==t&&(e._setFixedPriority(t),this._setDirty(e._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}},setEnabled:function(e){this._isEnabled=e},isEnabled:function(){return this._isEnabled},dispatchEvent:function(t){if(this._isEnabled){if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,!t||!t.getType)throw new Error("event is undefined");if(t._type===l.Event.TOUCH)return this._dispatchTouchEvent(t),void this._inDispatch--;var i=e(t);this._sortEventListeners(i);var n=this._listenersMap[i];n&&(this._dispatchEventToListeners(n,this._onListenerCallback,t),this._onUpdateListeners(n)),this._inDispatch--}},_onListenerCallback:function(e,t){return t._setCurrentTarget(e._getSceneGraphPriority()),e._onEvent(t),t.isStopped()},dispatchCustomEvent:function(e,t){var i=new l.EventCustom(e);i.setUserData(t),this.dispatchEvent(i)}}}(),l.EventAcceleration=l.Event.extend({_acc:null,ctor:function(e){l.Event.prototype.ctor.call(this,l.Event.ACCELERATION),this._acc=e}}),l.EventKeyboard=l.Event.extend({_keyCode:0,_isPressed:!1,ctor:function(e,t){l.Event.prototype.ctor.call(this,l.Event.KEYBOARD),this._keyCode=e,this._isPressed=t}}),l._EventListenerAcceleration=l.EventListener.extend({_onAccelerationEvent:null,ctor:function(e){this._onAccelerationEvent=e;var t=this;l.EventListener.prototype.ctor.call(this,l.EventListener.ACCELERATION,l._EventListenerAcceleration.LISTENER_ID,function(e){t._onAccelerationEvent(e._acc,e)})},checkAvailable:function(){return l.assert(this._onAccelerationEvent,l._LogInfos._EventListenerAcceleration_checkAvailable),!0},clone:function(){return new l._EventListenerAcceleration(this._onAccelerationEvent)}}),l._EventListenerAcceleration.LISTENER_ID="__cc_acceleration",l._EventListenerAcceleration.create=function(e){return new l._EventListenerAcceleration(e)},l._EventListenerKeyboard=l.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){var e=this;l.EventListener.prototype.ctor.call(this,l.EventListener.KEYBOARD,l._EventListenerKeyboard.LISTENER_ID,function(t){t._isPressed?e.onKeyPressed&&e.onKeyPressed(t._keyCode,t):e.onKeyReleased&&e.onKeyReleased(t._keyCode,t)})},clone:function(){var e=new l._EventListenerKeyboard;return e.onKeyPressed=this.onKeyPressed,e.onKeyReleased=this.onKeyReleased,e},checkAvailable:function(){return null!==this.onKeyPressed||null!==this.onKeyReleased||(l.log(l._LogInfos._EventListenerKeyboard_checkAvailable),!1)}}),l._EventListenerKeyboard.LISTENER_ID="__cc_keyboard",l._EventListenerKeyboard.create=function(){return new l._EventListenerKeyboard};var T=function(){var e=function(e,t){this.gl=e,this.vertexBuffer=e.createBuffer(),this.size=888,this.byteLength=t||3552*l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,this.data=new ArrayBuffer(this.byteLength),this.dataArray=new Float32Array(this.data),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.dataArray,e.DYNAMIC_DRAW),this._dirty=!1,this._spaces={0:this.byteLength}};return e.prototype={constructor:e,allocBuffer:function(e,t){var i=this._spaces[e];if(i&&i>=t){if(delete this._spaces[e],i>t){var n=e+t;this._spaces[n]=i-t}return!0}return!1},requestBuffer:function(e){var t,i;for(t in this._spaces)if(i=parseInt(t),this._spaces[t]>=e&&this.allocBuffer(i,e))return i;return-1},freeBuffer:function(e,t){var i,n,s,r=this._spaces;for(n in r){if((i=parseInt(n))>e)break;if(i+r[n]>=e){t=t+e-i,e=i;break}}s=e+t,this._spaces[s]&&(t+=this._spaces[s],delete this._spaces[s]),this._spaces[e]=t},setDirty:function(){this._dirty=!0},update:function(){this._dirty&&(this.gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferSubData(gl.ARRAY_BUFFER,0,this.dataArray),this._dirty=!1)},updateSubData:function(e,t){this.gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferSubData(gl.ARRAY_BUFFER,e,t)},destroy:function(){this.gl.deleteBuffer(this.vertexBuffer),this.data=null,this.positions=null,this.colors=null,this.texCoords=null,this.vertexBuffer=null}},e}();l.rendererCanvas={childrenOrderDirty:!0,assignedZ:0,assignedZStep:1e-4,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:l.color(),_clearFillStyle:"rgb(0, 0, 0)",_dirtyRegion:null,_allNeedDraw:!0,_enableDirtyRegion:!1,_debugDirtyRegion:!1,_canUseDirtyRegion:!1,_dirtyRegionCountThreshold:10,getRenderCmd:function(e){return e._createRenderCmd()},enableDirtyRegion:function(e){this._enableDirtyRegion=e},isDirtyRegionEnabled:function(){return this._enableDirtyRegion},setDirtyRegionCountThreshold:function(e){this._dirtyRegionCountThreshold=e},_collectDirtyRegion:function(){var e,t,i=this._renderCmds,n=this._dirtyRegion,s=0,r=!0,a=l.Node.CanvasRenderCmd.RegionStatus;for(e=0,t=i.length;e<t;e++){var o=i[e],h=o._regionFlag,d=o._oldRegion,c=o._currentRegion;h>a.NotDirty&&(++s>this._dirtyRegionCountThreshold&&(r=!1),r&&(!c.isEmpty()&&n.addRegion(c),o._regionFlag>a.Dirty&&!d.isEmpty()&&n.addRegion(d)),o._regionFlag=a.NotDirty)}return r},_beginDrawDirtyRegion:function(e){var t=e.getContext(),i=this._dirtyRegion.getDirtyRegions();t.save();var n=e._scaleX,s=e._scaleY;e.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},n,s),t.beginPath();for(var r=0,a=i.length;r<a;++r){var o=i[r];t.rect(o._minX,-o._maxY,o._width,o._height)}t.clip()},_endDrawDirtyRegion:function(e){e.restore()},_debugDrawDirtyRegion:function(e){if(this._debugDirtyRegion){var t=e.getContext(),i=this._dirtyRegion.getDirtyRegions(),n=e._scaleX,s=e._scaleY;e.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},n,s),t.beginPath();for(var r=0,a=i.length;r<a;++r){var o=i[r];t.rect(o._minX,-o._maxY,o._width,o._height)}var h=t.fillStyle;t.fillStyle="green",t.fill(),t.fillStyle=h}},rendering:function(e){var t=this._dirtyRegion=this._dirtyRegion||new l.DirtyRegion,i=l._canvas,n=e||l._renderContext,s=n.getContext(),r=l.view.getScaleX(),a=l.view.getScaleY();n.setViewScale(r,a),n.computeRealOffsetY();var o,h,d=this._dirtyRegion.getDirtyRegions(),c=this._renderCmds,u=this._allNeedDraw||!this._enableDirtyRegion||!this._canUseDirtyRegion,p=!0;for(u||(p=this._collectDirtyRegion()),(u=u||!p)||this._beginDrawDirtyRegion(n),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,i.width,i.height),255===this._clearColor.r&&255===this._clearColor.g&&255===this._clearColor.b||(n.setFillStyle(this._clearFillStyle),n.setGlobalAlpha(this._clearColor.a),s.fillRect(0,0,i.width,i.height)),o=0,h=c.length;o<h;o++){var m=c[o],_=!1,g=m._currentRegion;if(!g||u)_=!0;else for(var T=0,f=d.length;T<f;++T)if(d[T].intersects(g)){_=!0;break}_&&m.rendering(n,r,a)}u||(this._debugDrawDirtyRegion(n),this._endDrawDirtyRegion(s)),t.clear(),this._allNeedDraw=!1},_renderingToCacheCanvas:function(e,t,i,n){e||l.log("The context of RenderTexture is invalid."),i=l.isUndefined(i)?1:i,n=l.isUndefined(n)?1:n,t=t||this._currentID;var s,r,a=this._cacheToCanvasCmds[t];for(e.computeRealOffsetY(),s=0,r=a.length;s<r;s++)a[s].rendering(e,i,n);this._removeCache(t);var o=this._cacheInstanceIds;0===o.length?this._isCacheToCanvasOn=!1:this._currentID=o[o.length-1]},_turnToCacheMode:function(e){this._isCacheToCanvasOn=!0,e=e||0,this._cacheToCanvasCmds[e]=[],-1===this._cacheInstanceIds.indexOf(e)&&this._cacheInstanceIds.push(e),this._currentID=e},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},_removeCache:function(e){e=e||this._currentID;var t=this._cacheToCanvasCmds[e];t&&(t.length=0,delete this._cacheToCanvasCmds[e]);var i=this._cacheInstanceIds;l.arrayRemoveObject(i,e)},resetFlag:function(){this.childrenOrderDirty=!1,this._transformNodePool.length=0},transform:function(){var e=this._transformNodePool;e.sort(this._sortNodeByLevelAsc);for(var t=0,i=e.length;t<i;t++)0!==e[t]._dirtyFlag&&e[t].updateStatus();e.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(e,t){return e._curLevel-t._curLevel},pushDirtyNode:function(e){this._transformNodePool.push(e)},clear:function(){},clearRenderCommands:function(){this._renderCmds.length=0,this._cacheInstanceIds.length=0,this._isCacheToCanvasOn=!1,this._allNeedDraw=!0,this._canUseDirtyRegion=!0},pushRenderCommand:function(e){if(e.needDraw())if(e._canUseDirtyRegion||(this._canUseDirtyRegion=!1),this._isCacheToCanvasOn){var t=this._currentID,i=this._cacheToCanvasCmds[t];-1===i.indexOf(e)&&i.push(e)}else-1===this._renderCmds.indexOf(e)&&this._renderCmds.push(e)}},function(){l.CanvasContextWrapper=function(e){this._context=e,this._saveCount=0,this._currentAlpha=e.globalAlpha,this._currentCompositeOperation=e.globalCompositeOperation,this._currentFillStyle=e.fillStyle,this._currentStrokeStyle=e.strokeStyle,this._offsetX=0,this._offsetY=0,this._realOffsetY=this.height,this._armatureMode=0};var e=l.CanvasContextWrapper.prototype;e.resetCache=function(){var e=this._context;this._currentAlpha=e.globalAlpha,this._currentCompositeOperation=e.globalCompositeOperation,this._currentFillStyle=e.fillStyle,this._currentStrokeStyle=e.strokeStyle,this._realOffsetY=this._context.canvas.height+this._offsetY},e.setOffset=function(e,t){this._offsetX=e,this._offsetY=t,this._realOffsetY=this._context.canvas.height+this._offsetY},e.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY},e.setViewScale=function(e,t){this._scaleX=e,this._scaleY=t},e.getContext=function(){return this._context},e.save=function(){this._context.save(),this._saveCount++},e.restore=function(){this._context.restore(),this._saveCount--},e.setGlobalAlpha=function(e){this._saveCount>0?this._context.globalAlpha=e:this._currentAlpha!==e&&(this._currentAlpha=e,this._context.globalAlpha=e)},e.setCompositeOperation=function(e){this._saveCount>0?this._context.globalCompositeOperation=e:this._currentCompositeOperation!==e&&(this._currentCompositeOperation=e,this._context.globalCompositeOperation=e)},e.setFillStyle=function(e){this._saveCount>0?this._context.fillStyle=e:this._currentFillStyle!==e&&(this._currentFillStyle=e,this._context.fillStyle=e)},e.setStrokeStyle=function(e){this._saveCount>0?this._context.strokeStyle=e:this._currentStrokeStyle!==e&&(this._currentStrokeStyle=e,this._context.strokeStyle=e)},e.setTransform=function(e,t,i){this._armatureMode>0?(this.restore(),this.save(),this._context.transform(e.a*t,-e.b*i,-e.c*t,e.d*i,e.tx*t,-e.ty*i)):this._context.setTransform(e.a*t,-e.b*i,-e.c*t,e.d*i,this._offsetX+e.tx*t,this._realOffsetY-e.ty*i)},e._switchToArmatureMode=function(e,t,i,n){e?(this._armatureMode++,this._context.setTransform(t.a,t.c,t.b,t.d,this._offsetX+t.tx*i,this._realOffsetY-t.ty*n),this.save()):(this._armatureMode--,this.restore())}}(),l.rendererWebGL=function(){function e(e){var t=l._renderContext;if(s){var i=6*Math.ceil(e/4);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s),_=new Uint16Array(i);for(var n=0,o=0,h=i;o<h;o+=6)_[o]=n+0,_[o+1]=n+1,_[o+2]=n+2,_[o+3]=n+1,_[o+4]=n+2,_[o+5]=n+3,n+=4;t.bufferData(t.ELEMENT_ARRAY_BUFFER,_,t.DYNAMIC_DRAW)}if(r){var g=4*(u=e*d);c=new ArrayBuffer(g),p=new Float32Array(c),m=new Uint32Array(c),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,p,t.DYNAMIC_DRAW)}a=e-200}function t(t){var i=l._renderContext;null===s&&(r=i.createBuffer(),s=i.createBuffer()),e(t)}var i={texture:null,blendSrc:null,blendDst:null,glProgramState:null},n=!1,s=null,r=null,a=0,o=0,h=0,d=6,c=null,u=0,p=null,m=null,_=null,g=0,T=!0,f=!1,S={QUAD:0,TRIANGLE:1,CUSTOM:2};return{mat4Identity:null,childrenOrderDirty:!0,assignedZ:0,assignedZStep:.01,VertexType:S,_transformNodePool:[],_renderCmds:[],_isCacheToBufferOn:!1,_cacheToBufferCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:l.color(0,0,0,255),init:function(){var e=l._renderContext;e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),this.mat4Identity=new l.math.Matrix4,this.mat4Identity.identity(),t(l.BATCH_VERTEX_COUNT),l.sys.os===l.sys.OS_IOS&&(f=!0)},getVertexSize:function(){return a},getRenderCmd:function(e){return e._createRenderCmd()},_turnToCacheMode:function(e){this._isCacheToBufferOn=!0,e=e||0,this._cacheToBufferCmds[e]?this._cacheToBufferCmds[e].length=0:this._cacheToBufferCmds[e]=[],-1===this._cacheInstanceIds.indexOf(e)&&this._cacheInstanceIds.push(e),this._currentID=e},_turnToNormalMode:function(){this._isCacheToBufferOn=!1},_removeCache:function(e){e=e||this._currentID;var t=this._cacheToBufferCmds[e];t&&(t.length=0,delete this._cacheToBufferCmds[e]);var i=this._cacheInstanceIds;l.arrayRemoveObject(i,e)},_renderingToBuffer:function(e){e=e||this._currentID;var t=this._cacheToBufferCmds[e],i=l._renderContext;this.rendering(i,t),this._removeCache(e);var n=this._cacheInstanceIds;0===n.length?this._isCacheToBufferOn=!1:this._currentID=n[n.length-1]},resetFlag:function(){this.childrenOrderDirty&&(this.childrenOrderDirty=!1),this._transformNodePool.length=0},transform:function(){var e=this._transformNodePool;e.sort(this._sortNodeByLevelAsc);var t,i;for(t=0,i=e.length;t<i;t++)e[t].updateStatus();e.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(e,t){return e._curLevel-t._curLevel},pushDirtyNode:function(e){this._transformNodePool.push(e)},clearRenderCommands:function(){this._renderCmds.length=0},clear:function(){var e=l._renderContext;e.clearColor(this._clearColor.r/255,this._clearColor.g/255,this._clearColor.b/255,this._clearColor.a/255),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)},setDepthTest:function(e){var t=l._renderContext;e?(t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL)):t.disable(t.DEPTH_TEST)},pushRenderCommand:function(e){if(e.rendering||e.uploadData)if(this._isCacheToBufferOn){var t=this._currentID,i=this._cacheToBufferCmds[t];-1===i.indexOf(e)&&i.push(e)}else-1===this._renderCmds.indexOf(e)&&this._renderCmds.push(e)},_increaseBatchingSize:function(e,t,i){var n,s;switch(t=t||S.QUAD){case S.QUAD:for(n=0;n<e;n+=4)s=o+n,_[h++]=s+0,_[h++]=s+1,_[h++]=s+2,_[h++]=s+1,_[h++]=s+2,_[h++]=s+3;break;case S.TRIANGLE:for(T=!1,n=0;n<e;n+=3)s=o+n,_[h++]=s+0,_[h++]=s+1,_[h++]=s+2;break;case S.CUSTOM:T=!1;var r=i.length;for(n=0;n<r;n++)_[h++]=o+i[n];break;default:return}o+=e},_updateBatchedInfo:function(e,t,n){return(e!==i.texture||t.src!==i.blendSrc||t.dst!==i.blendDst||n!==i.glProgramState)&&(this._batchRendering(),i.texture=e,i.blendSrc=t.src,i.blendDst=t.dst,i.glProgramState=n,!0)},_breakBatch:function(){n=!0},_uploadBufferData:function(e){o>=a&&this._batchRendering();var t=e._node,s=t._texture||t._spriteFrame&&t._spriteFrame._texture,r=t._blendFunc.src,h=t._blendFunc.dst,l=e._glProgramState;(n||i.texture!==s||i.blendSrc!==r||i.blendDst!==h||i.glProgramState!==l)&&(this._batchRendering(),i.texture=s,i.blendSrc=r,i.blendDst=h,i.glProgramState=l,n=!1);var c=e.uploadData(p,m,o*d);c>0&&this._increaseBatchingSize(c,e.vertexType)},_batchRendering:function(){if(0!==o&&i.texture){var e=l._renderContext,t=i.texture,n=i.glProgramState,c=o>.5*a;if(n&&(n.apply(),n.getGLProgram()._updateProjectionUniform()),l.glBlendFunc(i.blendSrc,i.blendDst),l.glBindTexture2DN(0,t),e.bindBuffer(e.ARRAY_BUFFER,r),c)e.bufferData(e.ARRAY_BUFFER,p,e.DYNAMIC_DRAW);else{var u=p.subarray(0,o*d);e.bufferData(e.ARRAY_BUFFER,u,e.DYNAMIC_DRAW)}e.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),e.enableVertexAttribArray(l.VERTEX_ATTRIB_COLOR),e.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),e.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,3,e.FLOAT,!1,24,0),e.vertexAttribPointer(l.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,24,12),e.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,e.FLOAT,!1,24,16),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),(!g||!T||h>g)&&(c?e.bufferData(e.ELEMENT_ARRAY_BUFFER,_,e.DYNAMIC_DRAW):e.bufferData(e.ELEMENT_ARRAY_BUFFER,_.subarray(0,h),e.DYNAMIC_DRAW)),e.drawElements(e.TRIANGLES,h,e.UNSIGNED_SHORT,0),l.g_NumberOfDraws++,T?g=h:(g=0,T=!0),o=0,h=0}},rendering:function(e,t){var n,s,r,a=t||this._renderCmds,h=e||l._renderContext;for(h.bindBuffer(gl.ARRAY_BUFFER,null),n=0,s=a.length;n<s;++n)(r=a[n]).needDraw()&&(r.uploadData?this._uploadBufferData(r):(o>0&&this._batchRendering(),r.rendering(h)));this._batchRendering(),i.texture=null}}}();var f=function(){this._minX=0,this._minY=0,this._maxX=0,this._maxY=0,this._width=0,this._height=0,this._area=0},S=f.prototype,w=[];S.setTo=function(e,t,i,n){return this._minX=e,this._minY=t,this._maxX=i,this._maxY=n,this.updateArea(),this},S.intValues=function(){this._minX=Math.floor(this._minX),this._minY=Math.floor(this._minY),this._maxX=Math.ceil(this._maxX),this._maxY=Math.ceil(this._maxY),this.updateArea()},S.updateArea=function(){this._width=this._maxX-this._minX,this._height=this._maxY-this._minY,this._area=this._width*this._height},S.union=function(e){this._width<=0||this._height<=0?this.setTo(e._minX,e._minY,e._maxX,e._maxY):(this._minX>e._minX&&(this._minX=e._minX),this._minY>e._minY&&(this._minY=e._minY),this._maxX<e._maxX&&(this._maxX=e._maxX),this._maxY<e._maxY&&(this._maxY=e._maxY),this.updateArea())},S.setEmpty=function(){this._minX=0,this._minY=0,this._maxX=0,this._maxY=0,this._width=0,this._height=0,this._area=0},S.isEmpty=function(){return this._width<=0||this._height<=0},S.intersects=function(e){if(this._width<=0||this._height<=0||e._width<=0||e._height<=0)return!1;var t=this._minX>e._minX?this._minX:e._minX,i=this._maxX<e._maxX?this._maxX:e._maxX;return!(t>i)&&(t=this._minY>e._minY?this._minY:e._minY,i=this._maxY<e._maxY?this._maxY:e._maxY,t<=i)},S.updateRegion=function(e,t){if(0!=e.width&&0!=e.height){var i,n,s,r,a=t,o=a.a,h=a.b,l=a.c,d=a.d,c=a.tx,u=a.ty,p=e.x,m=e.y,_=p+e.width,g=m+e.height;if(1==o&&0==h&&0==l&&1==d)i=p+c-1,n=m+u-1,s=_+c+1,r=g+u+1;else{var T=o*p+l*m+c,f=h*p+d*m+u,S=o*_+l*m+c,w=h*_+d*m+u,v=o*_+l*g+c,L=h*_+d*g+u,M=o*p+l*g+c,C=h*p+d*g+u,y=0;T>S&&(y=T,T=S,S=y),v>M&&(y=v,v=M,M=y),i=(T<v?T:v)-1,s=(S>M?S:M)+1,f>w&&(y=f,f=w,w=y),L>C&&(y=L,L=C,C=y),n=(f<L?f:L)-1,r=(w>C?w:C)+1}this._minX=i,this._minY=n,this._maxX=s,this._maxY=r,this._width=s-i,this._height=r-n,this._area=this._width*this._height}else this.setEmpty()};var v=function(){this.dirtyList=[],this.hasClipRect=!1,this.clipWidth=0,this.clipHeight=0,this.clipArea=0,this.clipRectChanged=!1},L=v.prototype;L.setClipRect=function(e,t){this.hasClipRect=!0,this.clipRectChanged=!0,this.clipWidth=Math.ceil(e),this.clipHeight=Math.ceil(t),this.clipArea=this.clipWidth*this.clipHeight},L.addRegion=function(e){var i=e._minX,n=e._minY,s=e._maxX,r=e._maxY;if(this.hasClipRect&&(i<0&&(i=0),n<0&&(n=0),s>this.clipWidth&&(s=this.clipWidth),r>this.clipHeight&&(r=this.clipHeight)),i>=s||n>=r)return!1;if(this.clipRectChanged)return!0;var a=this.dirtyList,o=t();return a.push(o.setTo(i,n,s,r)),this.mergeDirtyList(a),!0},L.clear=function(){for(var e=this.dirtyList,t=e.length,i=0;i<t;i++)n(e[i]);e.length=0},L.getDirtyRegions=function(){var e=this.dirtyList;if(this.clipRectChanged){this.clipRectChanged=!1,this.clear();var i=t();e.push(i.setTo(0,0,this.clipWidth,this.clipHeight))}else for(;this.mergeDirtyList(e););var n=this.dirtyList.length;if(n>0)for(var s=0;s<n;s++)this.dirtyList[s].intValues();return this.dirtyList},L.mergeDirtyList=function(e){var t=e.length;if(t<2)return!1;for(var i=this.hasClipRect,r=t>3?Number.POSITIVE_INFINITY:0,a=0,o=0,h=0,l=0;l<t-1;l++){var d=e[l];i&&(h+=d.area);for(var c=l+1;c<t;c++){var u=e[c],p=s(d,u)-d.area-u.area;r>p&&(a=l,o=c,r=p)}}if(i&&h/this.clipArea>.95&&(this.clipRectChanged=!0),a!=o){var m=e[o];return e[a].union(m),n(m),e.splice(o,1),!0}return!1},l.Region=f,l.DirtyRegion=v,l._tmp.PrototypeCCNode=function(){var e=l.Node.prototype;l.defineGetterSetter(e,"x",e.getPositionX,e.setPositionX),l.defineGetterSetter(e,"y",e.getPositionY,e.setPositionY),e.width,l.defineGetterSetter(e,"width",e._getWidth,e._setWidth),e.height,l.defineGetterSetter(e,"height",e._getHeight,e._setHeight),e.anchorX,l.defineGetterSetter(e,"anchorX",e._getAnchorX,e._setAnchorX),e.anchorY,l.defineGetterSetter(e,"anchorY",e._getAnchorY,e._setAnchorY),e.skewX,l.defineGetterSetter(e,"skewX",e.getSkewX,e.setSkewX),e.skewY,l.defineGetterSetter(e,"skewY",e.getSkewY,e.setSkewY),e.zIndex,l.defineGetterSetter(e,"zIndex",e.getLocalZOrder,e.setLocalZOrder),e.vertexZ,l.defineGetterSetter(e,"vertexZ",e.getVertexZ,e.setVertexZ),e.rotation,l.defineGetterSetter(e,"rotation",e.getRotation,e.setRotation),e.rotationX,l.defineGetterSetter(e,"rotationX",e.getRotationX,e.setRotationX),e.rotationY,l.defineGetterSetter(e,"rotationY",e.getRotationY,e.setRotationY),e.scale,l.defineGetterSetter(e,"scale",e.getScale,e.setScale),e.scaleX,l.defineGetterSetter(e,"scaleX",e.getScaleX,e.setScaleX),e.scaleY,l.defineGetterSetter(e,"scaleY",e.getScaleY,e.setScaleY),e.children,l.defineGetterSetter(e,"children",e.getChildren),e.childrenCount,l.defineGetterSetter(e,"childrenCount",e.getChildrenCount),e.parent,l.defineGetterSetter(e,"parent",e.getParent,e.setParent),e.visible,l.defineGetterSetter(e,"visible",e.isVisible,e.setVisible),e.running,l.defineGetterSetter(e,"running",e.isRunning),e.ignoreAnchor,l.defineGetterSetter(e,"ignoreAnchor",e.isIgnoreAnchorPointForPosition,e.ignoreAnchorPointForPosition),e.tag,e.userData,e.userObject,e.arrivalOrder,e.actionManager,l.defineGetterSetter(e,"actionManager",e.getActionManager,e.setActionManager),e.scheduler,l.defineGetterSetter(e,"scheduler",e.getScheduler,e.setScheduler),e.shaderProgram,l.defineGetterSetter(e,"shaderProgram",e.getShaderProgram,e.setShaderProgram),e.opacity,l.defineGetterSetter(e,"opacity",e.getOpacity,e.setOpacity),e.opacityModifyRGB,l.defineGetterSetter(e,"opacityModifyRGB",e.isOpacityModifyRGB),e.cascadeOpacity,l.defineGetterSetter(e,"cascadeOpacity",e.isCascadeOpacityEnabled,e.setCascadeOpacityEnabled),e.color,l.defineGetterSetter(e,"color",e.getColor,e.setColor),e.cascadeColor,l.defineGetterSetter(e,"cascadeColor",e.isCascadeColorEnabled,e.setCascadeColorEnabled)},l.NODE_TAG_INVALID=-1,l.s_globalOrderOfArrival=1,l.Node=l.Class.extend({_localZOrder:0,_globalZOrder:0,_vertexZ:0,_customZ:NaN,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:null,_normalizedPosition:null,_usingNormalizedPosition:!1,_normalizedPositionDirty:!1,_skewX:0,_skewY:0,_children:null,_visible:!0,_anchorPoint:null,_contentSize:null,_running:!1,_parent:null,_ignoreAnchorPointForPosition:!1,tag:l.NODE_TAG_INVALID,userData:null,userObject:null,_reorderChildDirty:!1,arrivalOrder:0,_actionManager:null,_scheduler:null,_additionalTransformDirty:!1,_additionalTransform:null,_componentContainer:null,_isTransitionFinished:!1,_className:"Node",_showNode:!1,_name:"",_realOpacity:255,_realColor:null,_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_renderCmd:null,ctor:function(){var e=this;e._anchorPoint=l.p(0,0),e._contentSize=l.size(0,0),e._position=l.p(0,0),e._normalizedPosition=l.p(0,0),e._children=[];l.director;e._additionalTransform=l.affineTransformMakeIdentity(),l.ComponentContainer&&(e._componentContainer=new l.ComponentContainer(e)),this._realColor=l.color(255,255,255,255),this._renderCmd=this._createRenderCmd()},init:function(){return!0},attr:function(e){for(var t in e)this[t]=e[t]},getSkewX:function(){return this._skewX},setSkewX:function(e){this._skewX=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getSkewY:function(){return this._skewY},setSkewY:function(e){this._skewY=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},setLocalZOrder:function(e){this._parent?this._parent.reorderChild(this,e):this._localZOrder=e,l.eventManager._setDirtyForNode(this)},_setLocalZOrder:function(e){this._localZOrder=e},getLocalZOrder:function(){return this._localZOrder},getZOrder:function(){return l.log(l._LogInfos.Node_getZOrder),this.getLocalZOrder()},setZOrder:function(e){l.log(l._LogInfos.Node_setZOrder),this.setLocalZOrder(e)},setGlobalZOrder:function(e){this._globalZOrder!==e&&(this._globalZOrder=e,l.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(e){this._customZ=this._vertexZ=e},getRotation:function(){return this._rotationX!==this._rotationY&&l.log(l._LogInfos.Node_getRotation),this._rotationX},setRotation:function(e){this._rotationX=this._rotationY=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getRotationX:function(){return this._rotationX},setRotationX:function(e){this._rotationX=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getRotationY:function(){return this._rotationY},setRotationY:function(e){this._rotationY=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getScale:function(){return this._scaleX!==this._scaleY&&l.log(l._LogInfos.Node_getScale),this._scaleX},setScale:function(e,t){this._scaleX=e,this._scaleY=t||0===t?t:e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX},setScaleX:function(e){this._scaleX=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY},setScaleY:function(e){this._scaleY=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},setPosition:function(e,t){var i=this._position;if(void 0===t){if(i.x===e.x&&i.y===e.y)return;i.x=e.x,i.y=e.y}else{if(i.x===e&&i.y===t)return;i.x=e,i.y=t}this._usingNormalizedPosition=!1,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},setNormalizedPosition:function(e,t){var i=this._normalizedPosition;void 0===t?(i.x=e.x,i.y=e.y):(i.x=e,i.y=t),this._normalizedPositionDirty=this._usingNormalizedPosition=!0,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getPosition:function(){return l.p(this._position)},getNormalizedPosition:function(){return l.p(this._normalizedPosition)},getPositionX:function(){return this._position.x},setPositionX:function(e){this._position.x=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getPositionY:function(){return this._position.y},setPositionY:function(e){this._position.y=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(e){this._visible!==e&&(this._visible=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty),l.renderer.childrenOrderDirty=!0)},getAnchorPoint:function(){return l.p(this._anchorPoint)},setAnchorPoint:function(e,t){var i=this._anchorPoint;if(void 0===t){if(e.x===i.x&&e.y===i.y)return;i.x=e.x,i.y=e.y}else{if(e===i.x&&t===i.y)return;i.x=e,i.y=t}this._renderCmd._updateAnchorPointInPoint()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(e){this._anchorPoint.x!==e&&(this._anchorPoint.x=e,this._renderCmd._updateAnchorPointInPoint())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(e){this._anchorPoint.y!==e&&(this._anchorPoint.y=e,this._renderCmd._updateAnchorPointInPoint())},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints()},_getWidth:function(){return this._contentSize.width},_setWidth:function(e){this._contentSize.width=e,this._renderCmd._updateAnchorPointInPoint()},_getHeight:function(){return this._contentSize.height},_setHeight:function(e){this._contentSize.height=e,this._renderCmd._updateAnchorPointInPoint()},getContentSize:function(){return l.size(this._contentSize)},setContentSize:function(e,t){var i=this._contentSize;if(void 0===t){if(e.width===i.width&&e.height===i.height)return;i.width=e.width,i.height=e.height}else{if(e===i.width&&t===i.height)return;i.width=e,i.height=t}this._renderCmd._updateAnchorPointInPoint()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(e){this._parent=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},ignoreAnchorPointForPosition:function(e){e!==this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty))},getTag:function(){return this.tag},setTag:function(e){this.tag=e},setName:function(e){this._name=e},getName:function(){return this._name},getUserData:function(){return this.userData},setUserData:function(e){this.userData=e},getUserObject:function(){return this.userObject},setUserObject:function(e){this.userObject!==e&&(this.userObject=e)},getOrderOfArrival:function(){return this.arrivalOrder},setOrderOfArrival:function(e){this.arrivalOrder=e},getActionManager:function(){return this._actionManager||l.director.getActionManager()},setActionManager:function(e){this._actionManager!==e&&(this.stopAllActions(),this._actionManager=e)},getScheduler:function(){return this._scheduler||l.director.getScheduler()},setScheduler:function(e){this._scheduler!==e&&(this.unscheduleAllCallbacks(),this._scheduler=e)},boundingBox:function(){return l.log(l._LogInfos.Node_boundingBox),this.getBoundingBox()},getBoundingBox:function(){var e=l.rect(0,0,this._contentSize.width,this._contentSize.height);return l._rectApplyAffineTransformIn(e,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),l.eventManager.removeListeners(this)},getChildByTag:function(e){var t=this._children;if(null!==t)for(var i=0;i<t.length;i++){var n=t[i];if(n&&n.tag===e)return n}return null},getChildByName:function(e){if(!e)return l.log("Invalid name"),null;for(var t=this._children,i=0,n=t.length;i<n;i++)if(t[i]._name===e)return t[i];return null},addChild:function(e,t,i){t=void 0===t?e._localZOrder:t;var n,s=!1;void 0===i?n=e._name:"string"==typeof i?(n=i,i=void 0):"number"==typeof i&&(s=!0,n=""),l.assert(e,l._LogInfos.Node_addChild_3),l.assert(null===e._parent,"child already added. It can't be added again"),this._addChildHelper(e,t,i,n,s)},_addChildHelper:function(e,t,i,n,s){this._children||(this._children=[]),this._insertChild(e,t),s?e.setTag(i):e.setName(n),e.setParent(this),e.setOrderOfArrival(l.s_globalOrderOfArrival++),this._running&&(e._performRecursive(l.Node._stateCallbackType.onEnter),this._isTransitionFinished&&e._performRecursive(l.Node._stateCallbackType.onEnterTransitionDidFinish)),e._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty),this._cascadeColorEnabled&&e._renderCmd.setDirtyFlag(l.Node._dirtyFlags.colorDirty),this._cascadeOpacityEnabled&&e._renderCmd.setDirtyFlag(l.Node._dirtyFlags.opacityDirty)},removeFromParent:function(e){this._parent&&(void 0===e&&(e=!0),this._parent.removeChild(this,e))},removeFromParentAndCleanup:function(e){l.log(l._LogInfos.Node_removeFromParentAndCleanup),this.removeFromParent(e)},removeChild:function(e,t){0!==this._children.length&&(void 0===t&&(t=!0),this._children.indexOf(e)>-1&&this._detachChild(e,t),l.renderer.childrenOrderDirty=!0)},removeChildByTag:function(e,t){e===l.NODE_TAG_INVALID&&l.log(l._LogInfos.Node_removeChildByTag);var i=this.getChildByTag(e);i?this.removeChild(i,t):l.log(l._LogInfos.Node_removeChildByTag_2,e)},removeAllChildrenWithCleanup:function(e){this.removeAllChildren(e)},removeAllChildren:function(e){var t=this._children;if(null!==t){void 0===e&&(e=!0);for(var i=0;i<t.length;i++){var n=t[i];n&&(this._running&&(n._performRecursive(l.Node._stateCallbackType.onExitTransitionDidStart),n._performRecursive(l.Node._stateCallbackType.onExit)),e&&n._performRecursive(l.Node._stateCallbackType.cleanup),n.parent=null,n._renderCmd.detachFromParent())}this._children.length=0,l.renderer.childrenOrderDirty=!0}},_detachChild:function(e,t){this._running&&(e._performRecursive(l.Node._stateCallbackType.onExitTransitionDidStart),e._performRecursive(l.Node._stateCallbackType.onExit)),t&&e._performRecursive(l.Node._stateCallbackType.cleanup),e.parent=null,e._renderCmd.detachFromParent(),l.arrayRemoveObject(this._children,e)},_insertChild:function(e,t){l.renderer.childrenOrderDirty=this._reorderChildDirty=!0,this._children.push(e),e._setLocalZOrder(t)},setNodeDirty:function(){this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},reorderChild:function(e,t){l.assert(e,l._LogInfos.Node_reorderChild),-1!==this._children.indexOf(e)?t!==e.zIndex&&(l.renderer.childrenOrderDirty=this._reorderChildDirty=!0,e.arrivalOrder=l.s_globalOrderOfArrival,l.s_globalOrderOfArrival++,e._setLocalZOrder(t),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.orderDirty)):l.log(l._LogInfos.Node_reorderChild_2)},sortAllChildren:function(){if(this._reorderChildDirty){var e,t,i,n=this._children,s=n.length;for(e=1;e<s;e++){for(i=n[e],t=e-1;t>=0;){if(i._localZOrder<n[t]._localZOrder)n[t+1]=n[t];else{if(!(i._localZOrder===n[t]._localZOrder&&i.arrivalOrder<n[t].arrivalOrder))break;n[t+1]=n[t]}t--}n[t+1]=i}this._reorderChildDirty=!1}},draw:function(e){},transformAncestors:function(){null!==this._parent&&(this._parent.transformAncestors(),this._parent.transform())},onEnter:function(){this._isTransitionFinished=!1,this._running=!0,this.resume()},_performRecursive:function(e){var t=l.Node._stateCallbackType;if(!(e>=t.max)){var i,n,s,r,a,o=0,h=l.Node._performStacks[l.Node._performing];for(h||(h=[],l.Node._performStacks.push(h)),h.length=0,l.Node._performing++,s=h[0]=this;s;){if((i=s._children)&&i.length>0)for(r=0,a=i.length;r<a;++r)n=i[r],h.push(n);if((i=s._protectedChildren)&&i.length>0)for(r=0,a=i.length;r<a;++r)n=i[r],h.push(n);s=h[++o]}for(r=h.length-1;r>=0;--r)if(s=h[r],h[r]=null,s)switch(e){case t.onEnter:s.onEnter();break;case t.onExit:s.onExit();break;case t.onEnterTransitionDidFinish:s.onEnterTransitionDidFinish();break;case t.cleanup:s.cleanup();break;case t.onExitTransitionDidStart:s.onExitTransitionDidStart()}l.Node._performing--}},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0},onExitTransitionDidStart:function(){},onExit:function(){this._running=!1,this.pause(),this.removeAllComponents()},runAction:function(e){return l.assert(e,l._LogInfos.Node_runAction),this.actionManager.addAction(e,this,!this._running),e},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this)},stopAction:function(e){this.actionManager.removeAction(e)},stopActionByTag:function(e){e!==l.ACTION_TAG_INVALID?this.actionManager.removeActionByTag(e,this):l.log(l._LogInfos.Node_stopActionByTag)},getActionByTag:function(e){return e===l.ACTION_TAG_INVALID?(l.log(l._LogInfos.Node_getActionByTag),null):this.actionManager.getActionByTag(e,this)},getNumberOfRunningActions:function(){return this.actionManager.numberOfRunningActionsInTarget(this)},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(e){this.scheduler.scheduleUpdate(this,e,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdate(this)},schedule:function(e,t,i,n,s){var r=arguments.length;"function"==typeof e?1===r?(t=0,i=l.REPEAT_FOREVER,n=0,s=this.__instanceId):2===r?"number"==typeof t?(i=l.REPEAT_FOREVER,n=0,s=this.__instanceId):(s=t,t=0,i=l.REPEAT_FOREVER,n=0):3===r?("string"==typeof i?(s=i,i=l.REPEAT_FOREVER):s=this.__instanceId,n=0):4===r&&(s=this.__instanceId):1===r?(t=0,i=l.REPEAT_FOREVER,n=0):2===r&&(i=l.REPEAT_FOREVER,n=0),l.assert(e,l._LogInfos.Node_schedule),l.assert(t>=0,l._LogInfos.Node_schedule_2),t=t||0,i=isNaN(i)?l.REPEAT_FOREVER:i,n=n||0,this.scheduler.schedule(e,this,t,i,n,!this._running,s)},scheduleOnce:function(e,t,i){void 0===i&&(i=this.__instanceId),this.schedule(e,0,0,t,i)},unschedule:function(e){e&&this.scheduler.unschedule(e,this)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllForTarget(this)},resumeSchedulerAndActions:function(){l.log(l._LogInfos.Node_resumeSchedulerAndActions),this.resume()},resume:function(){this.scheduler.resumeTarget(this),this.actionManager&&this.actionManager.resumeTarget(this),l.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){l.log(l._LogInfos.Node_pauseSchedulerAndActions),this.pause()},pause:function(){this.scheduler.pauseTarget(this),this.actionManager&&this.actionManager.pauseTarget(this),l.eventManager.pauseTarget(this)},setAdditionalTransform:function(e){if(void 0===e)return this._additionalTransformDirty=!1;this._additionalTransform=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty),this._additionalTransformDirty=!0},getParentToNodeTransform:function(){return this._renderCmd.getParentToNodeTransform()},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var e=this.getNodeToParentTransform(),t=this._parent;null!==t;t=t.parent)e=l.affineTransformConcat(e,t.getNodeToParentTransform());return e},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getWorldToNodeTransform:function(){return l.affineTransformInvert(this.getNodeToWorldTransform())},worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(e){return l.pointApplyAffineTransform(e,this.getWorldToNodeTransform())},convertToWorldSpace:function(e){return e=e||l.p(0,0),l.pointApplyAffineTransform(e,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(e){return l.pSub(this.convertToNodeSpace(e),this._renderCmd.getAnchorPointInPoints())},convertToWorldSpaceAR:function(e){e=e||l.p(0,0);var t=l.pAdd(e,this._renderCmd.getAnchorPointInPoints());return this.convertToWorldSpace(t)},_convertToWindowSpace:function(e){var t=this.convertToWorldSpace(e);return l.director.convertToUI(t)},convertTouchToNodeSpace:function(e){var t=e.getLocation();return this.convertToNodeSpace(t)},convertTouchToNodeSpaceAR:function(e){var t=l.director.convertToGL(e.getLocation());return this.convertToNodeSpaceAR(t)},update:function(e){this._componentContainer&&!this._componentContainer.isEmpty()&&this._componentContainer.visit(e)},updateTransform:function(){for(var e,t=this._children,i=0;i<t.length;i++)(e=t[i])&&e.updateTransform()},retain:function(){},release:function(){},getComponent:function(e){return this._componentContainer?this._componentContainer.getComponent(e):null},addComponent:function(e){this._componentContainer&&this._componentContainer.add(e)},removeComponent:function(e){return!!this._componentContainer&&this._componentContainer.remove(e)},removeAllComponents:function(){this._componentContainer&&this._componentContainer.removeAll()},grid:null,visit:function(e){var t=this._renderCmd,i=e?e._renderCmd:null;if(this._visible){var n=l.renderer;t.visit(i);var s,r,a=this._children,o=a.length;if(o>0){for(this._reorderChildDirty&&this.sortAllChildren(),s=0;s<o&&(r=a[s])._localZOrder<0;s++)r.visit(this);for(n.pushRenderCommand(t);s<o;s++)a[s].visit(this)}else n.pushRenderCommand(t);t._dirtyFlag=0}else t._propagateFlagsDown(i)},transform:function(e,t){this._renderCmd.transform(e,t)},nodeToParentTransform:function(){return this.getNodeToParentTransform()},getNodeToParentTransform:function(e){var t=this._renderCmd.getNodeToParentTransform();if(e){for(var i={a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx,ty:t.ty},n=this._parent;null!=n&&n!=e;n=n.getParent())l.affineTransformConcatIn(i,n.getNodeToParentTransform());return i}return t},getNodeToParentAffineTransform:function(e){return this.getNodeToParentTransform(e)},getCamera:function(){return null},getGrid:function(){return this.grid},setGrid:function(e){this.grid=e},getShaderProgram:function(){return this._renderCmd.getShaderProgram()},setShaderProgram:function(e){this._renderCmd.setShaderProgram(e)},setGLProgramState:function(e){this._renderCmd.setGLProgramState(e)},getGLProgramState:function(){return this._renderCmd.getGLProgramState()},getGLServerState:function(){return 0},setGLServerState:function(e){},getBoundingBoxToWorld:function(){var e=l.rect(0,0,this._contentSize.width,this._contentSize.height),t=this.getNodeToWorldTransform();if(e=l.rectApplyAffineTransform(e,t),!this._children)return e;for(var i=this._children,n=0;n<i.length;n++){var s=i[n];if(s&&s._visible){var r=s._getBoundingBoxToCurrentNode(t);r&&(e=l.rectUnion(e,r))}}return e},_getBoundingBoxToCurrentNode:function(e){var t=l.rect(0,0,this._contentSize.width,this._contentSize.height),i=void 0===e?this.getNodeToParentTransform():l.affineTransformConcat(this.getNodeToParentTransform(),e);if(t=l.rectApplyAffineTransform(t,i),!this._children)return t;for(var n=this._children,s=0;s<n.length;s++){var r=n[s];if(r&&r._visible){var a=r._getBoundingBoxToCurrentNode(i);a&&(t=l.rectUnion(t,a))}}return t},getOpacity:function(){return this._realOpacity},getDisplayedOpacity:function(){return this._renderCmd.getDisplayedOpacity()},setOpacity:function(e){this._realOpacity=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.opacityDirty)},updateDisplayedOpacity:function(e){this._renderCmd._updateDisplayOpacity(e)},isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled},setCascadeOpacityEnabled:function(e){this._cascadeOpacityEnabled!==e&&(this._cascadeOpacityEnabled=e,this._renderCmd.setCascadeOpacityEnabledDirty())},getColor:function(){var e=this._realColor;return l.color(e.r,e.g,e.b,e.a)},getDisplayedColor:function(){return this._renderCmd.getDisplayedColor()},setColor:function(e){var t=this._realColor;t.r=e.r,t.g=e.g,t.b=e.b,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.colorDirty)},updateDisplayedColor:function(e){this._renderCmd._updateDisplayColor(e)},isCascadeColorEnabled:function(){return this._cascadeColorEnabled},setCascadeColorEnabled:function(e){this._cascadeColorEnabled!==e&&(this._cascadeColorEnabled=e,this._renderCmd.setCascadeColorEnabledDirty())},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.Node.CanvasRenderCmd(this):new l.Node.WebGLRenderCmd(this)},enumerateChildren:function(e,t){l.assert(e&&0!=e.length,"Invalid name"),l.assert(null!=t,"Invalid callback function");var i=e.length,n=0,s=i,r=!1;i>2&&"/"===e[0]&&"/"===e[1]&&(r=!0,n=2,s-=2);var a=!1;i>3&&"/"===e[i-3]&&"."===e[i-2]&&"."===e[i-1]&&(a=!0,s-=3);var o=e.substr(n,s);a&&(o="[[:alnum:]]+/"+o),r?this.doEnumerateRecursive(this,o,t):this.doEnumerate(o,t)},doEnumerateRecursive:function(e,t,i){var n=!1;if(e.doEnumerate(t,i))n=!0;else for(var s,r=e.getChildren(),a=r.length,o=0;o<a;o++)if(s=r[o],this.doEnumerateRecursive(s,t,i)){n=!0;break}return n},doEnumerate:function(e,t){var i=e.indexOf("/"),n=e,s=!1;-1!==i&&(n=e.substr(0,i),s=!0);for(var r,a=!1,o=this._children,h=o.length,l=0;l<h;l++)if(-1!==(r=o[l])._name.indexOf(n))if(s){if(a=r.doEnumerate(e,t))break}else if(t(r)){a=!0;break}return a}}),l.Node.create=function(){return new l.Node},l.Node._stateCallbackType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,onExitTransitionDidStart:5,max:6},l.Node._performStacks=[[]],l.Node._performing=0,l.assert(l.isFunction(l._tmp.PrototypeCCNode),l._LogInfos.MissingFile,"BaseNodesPropertyDefine.js"),l._tmp.PrototypeCCNode(),delete l._tmp.PrototypeCCNode,l.CustomRenderCmd=function(e,t){this._needDraw=!0,this._target=e,this._callback=t},l.CustomRenderCmd.prototype.rendering=function(e,t,i){this._callback&&this._callback.call(this._target,e,t,i)},l.CustomRenderCmd.prototype.needDraw=function(){return this._needDraw};var M=l.Node._dirtyFlags={transformDirty:1,visibleDirty:2,colorDirty:4,opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,textureDirty:256,contentDirty:512,COUNT:10,all:1023},C=Math.PI/180;l.Node.RenderCmd=function(e){this._node=e,this._anchorPointInPoints={x:0,y:0},this._displayedColor=l.color(255,255,255,255)},l.Node.RenderCmd.prototype={constructor:l.Node.RenderCmd,_needDraw:!1,_dirtyFlag:1,_curLevel:-1,_displayedOpacity:255,_cascadeColorEnabledDirty:!1,_cascadeOpacityEnabledDirty:!1,_transform:null,_worldTransform:null,_inverse:null,needDraw:function(){return this._needDraw},getAnchorPointInPoints:function(){return l.p(this._anchorPointInPoints)},getDisplayedColor:function(){var e=this._displayedColor;return l.color(e.r,e.g,e.b,e.a)},getDisplayedOpacity:function(){return this._displayedOpacity},setCascadeColorEnabledDirty:function(){this._cascadeColorEnabledDirty=!0,this.setDirtyFlag(l.Node._dirtyFlags.colorDirty)},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=!0,this.setDirtyFlag(l.Node._dirtyFlags.opacityDirty)},getParentToNodeTransform:function(){return this._inverse||(this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0}),this._dirtyFlag&l.Node._dirtyFlags.transformDirty&&l.affineTransformInvertOut(this.getNodeToParentTransform(),this._inverse),this._inverse},detachFromParent:function(){},_updateAnchorPointInPoint:function(){var e=this._anchorPointInPoints,t=this._node._contentSize,i=this._node._anchorPoint;e.x=t.width*i.x,e.y=t.height*i.y,this.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},setDirtyFlag:function(e){0===this._dirtyFlag&&0!==e&&l.renderer.pushDirtyNode(this),this._dirtyFlag|=e},getParentRenderCmd:function(){return this._node&&this._node._parent&&this._node._parent._renderCmd?this._node._parent._renderCmd:null},transform:function(e,t){this._transform||(this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0});var i=this._node,n=e?e._worldTransform:null,s=this._transform,a=this._worldTransform;if(i._usingNormalizedPosition&&i._parent){var o=i._parent._contentSize;i._position.x=i._normalizedPosition.x*o.width,i._position.y=i._normalizedPosition.y*o.height,i._normalizedPositionDirty=!1}var h=i._rotationX||i._rotationY,d=i._skewX||i._skewY,c=i._scaleX,u=i._scaleY,p=this._anchorPointInPoints.x,m=this._anchorPointInPoints.y,_=1,g=0,T=0,f=1;if(h||d){if(s.tx=i._position.x,s.ty=i._position.y,h){var S=i._rotationX*C;if(T=Math.sin(S),f=Math.cos(S),i._rotationY===i._rotationX)_=f,g=-T;else{var w=i._rotationY*C;_=Math.cos(w),g=-Math.sin(w)}}if(s.a=_*=c,s.b=g*=c,s.c=T*=u,s.d=f*=u,d){var v=Math.tan(i._skewX*C),L=Math.tan(i._skewY*C);v===1/0&&(v=99999999),L===1/0&&(L=99999999),s.a=_+T*L,s.b=g+f*L,s.c=T+_*v,s.d=f+g*v}(p||m)&&(s.tx-=s.a*p+s.c*m,s.ty-=s.b*p+s.d*m,i._ignoreAnchorPointForPosition&&(s.tx+=p,s.ty+=m)),i._additionalTransformDirty&&l.affineTransformConcatIn(s,i._additionalTransform),n?(a.a=s.a*n.a+s.b*n.c,a.b=s.a*n.b+s.b*n.d,a.c=s.c*n.a+s.d*n.c,a.d=s.c*n.b+s.d*n.d,a.tx=n.a*s.tx+n.c*s.ty+n.tx,a.ty=n.d*s.ty+n.ty+n.b*s.tx):(a.a=s.a,a.b=s.b,a.c=s.c,a.d=s.d,a.tx=s.tx,a.ty=s.ty)}else s.a=c,s.b=0,s.c=0,s.d=u,s.tx=i._position.x,s.ty=i._position.y,(p||m)&&(s.tx-=s.a*p,s.ty-=s.d*m,i._ignoreAnchorPointForPosition&&(s.tx+=p,s.ty+=m)),i._additionalTransformDirty&&l.affineTransformConcatIn(s,i._additionalTransform),n?(a.a=s.a*n.a+s.b*n.c,a.b=s.a*n.b+s.b*n.d,a.c=s.c*n.a+s.d*n.c,a.d=s.c*n.b+s.d*n.d,a.tx=s.tx*n.a+s.ty*n.c+n.tx,a.ty=s.tx*n.b+s.ty*n.d+n.ty):(a.a=s.a,a.b=s.b,a.c=s.c,a.d=s.d,a.tx=s.tx,a.ty=s.ty);this._updateCurrentRegions&&(this._updateCurrentRegions(),this._notifyRegionStatus&&this._notifyRegionStatus(l.Node.CanvasRenderCmd.RegionStatus.DirtyDouble)),t&&r(i),this._cacheDirty=!0},getNodeToParentTransform:function(){return(!this._transform||this._dirtyFlag&l.Node._dirtyFlags.transformDirty)&&this.transform(),this._transform},visit:function(e){var t=this._node,i=l.renderer;(e=e||this.getParentRenderCmd())&&(this._curLevel=e._curLevel+1),isNaN(t._customZ)&&(t._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),this._syncStatus(e)},_updateDisplayColor:function(e){var t,i,n,s,r=this._node,a=this._displayedColor,o=r._realColor;if(this._notifyRegionStatus&&this._notifyRegionStatus(l.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeColorEnabledDirty&&!r._cascadeColorEnabled){a.r=o.r,a.g=o.g,a.b=o.b;var h=new l.Color(255,255,255,255);for(t=0,i=(n=r._children).length;t<i;t++)(s=n[t])&&s._renderCmd&&s._renderCmd._updateDisplayColor(h);this._cascadeColorEnabledDirty=!1}else{if(void 0===e){var d=r._parent;e=d&&d._cascadeColorEnabled?d.getDisplayedColor():l.color.WHITE}if(a.r=0|o.r*e.r/255,a.g=0|o.g*e.g/255,a.b=0|o.b*e.b/255,r._cascadeColorEnabled)for(t=0,i=(n=r._children).length;t<i;t++)(s=n[t])&&s._renderCmd&&(s._renderCmd._updateDisplayColor(a),s._renderCmd._updateColor())}this._dirtyFlag&=~M.colorDirty},_updateDisplayOpacity:function(e){var t,i,n,s,r=this._node;if(this._notifyRegionStatus&&this._notifyRegionStatus(l.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeOpacityEnabledDirty&&!r._cascadeOpacityEnabled){for(this._displayedOpacity=r._realOpacity,t=0,i=(n=r._children).length;t<i;t++)(s=n[t])&&s._renderCmd&&s._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else{if(void 0===e){var a=r._parent;e=255,a&&a._cascadeOpacityEnabled&&(e=a.getDisplayedOpacity())}if(this._displayedOpacity=r._realOpacity*e/255,r._cascadeOpacityEnabled)for(t=0,i=(n=r._children).length;t<i;t++)(s=n[t])&&s._renderCmd&&(s._renderCmd._updateDisplayOpacity(this._displayedOpacity),s._renderCmd._updateColor())}this._dirtyFlag&=~M.opacityDirty},_syncDisplayColor:function(e){var t=this._node,i=this._displayedColor,n=t._realColor;if(void 0===e){var s=t._parent;e=s&&s._cascadeColorEnabled?s.getDisplayedColor():l.color.WHITE}i.r=0|n.r*e.r/255,i.g=0|n.g*e.g/255,i.b=0|n.b*e.b/255},_syncDisplayOpacity:function(e){var t=this._node;if(void 0===e){var i=t._parent;e=255,i&&i._cascadeOpacityEnabled&&(e=i.getDisplayedOpacity())}this._displayedOpacity=t._realOpacity*e/255},_updateColor:function(){},_propagateFlagsDown:function(e){var t=this._dirtyFlag,i=e?e._node:null;i&&i._cascadeColorEnabled&&e._dirtyFlag&M.colorDirty&&(t|=M.colorDirty),i&&i._cascadeOpacityEnabled&&e._dirtyFlag&M.opacityDirty&&(t|=M.opacityDirty),e&&e._dirtyFlag&M.transformDirty&&(t|=M.transformDirty),this._dirtyFlag=t},updateStatus:function(){var e=this._dirtyFlag,t=e&M.colorDirty,i=e&M.opacityDirty;e&M.contentDirty&&(this._notifyRegionStatus&&this._notifyRegionStatus(l.Node.CanvasRenderCmd.RegionStatus.Dirty),this._dirtyFlag&=~M.contentDirty),t&&this._updateDisplayColor(),i&&this._updateDisplayOpacity(),(t||i)&&this._updateColor(),e&M.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag&=~M.transformDirty),e&M.orderDirty&&(this._dirtyFlag&=~M.orderDirty)},_syncStatus:function(e){var t=this._dirtyFlag,i=e?e._node:null;i&&i._cascadeColorEnabled&&e._dirtyFlag&M.colorDirty&&(t|=M.colorDirty),i&&i._cascadeOpacityEnabled&&e._dirtyFlag&M.opacityDirty&&(t|=M.opacityDirty),e&&e._dirtyFlag&M.transformDirty&&(t|=M.transformDirty),this._dirtyFlag=t;var n=t&M.colorDirty,s=t&M.opacityDirty;n&&this._syncDisplayColor(),s&&this._syncDisplayOpacity(),(n||s)&&this._updateColor(),t&M.transformDirty&&this.transform(e),t&M.orderDirty&&(this._dirtyFlag&=~M.orderDirty)},setShaderProgram:function(e){},getShaderProgram:function(){return null},getGLProgramState:function(){return null},setGLProgramState:function(e){}},l.Node.RenderCmd.prototype.originTransform=l.Node.RenderCmd.prototype.transform,l.Node.RenderCmd.prototype.originUpdateStatus=l.Node.RenderCmd.prototype.updateStatus,l.Node.RenderCmd.prototype._originSyncStatus=l.Node.RenderCmd.prototype._syncStatus,function(){l.Node.CanvasRenderCmd=function(e){this._node=e,this._anchorPointInPoints={x:0,y:0},this._displayedColor=l.color(255,255,255,255),this._cachedParent=null,this._cacheDirty=!1,this._currentRegion=new l.Region,this._oldRegion=new l.Region,this._regionFlag=0,this._canUseDirtyRegion=!1},l.Node.CanvasRenderCmd.RegionStatus={NotDirty:0,Dirty:1,DirtyDouble:2};var e=l.Node.CanvasRenderCmd.prototype=Object.create(l.Node.RenderCmd.prototype);e.constructor=l.Node.CanvasRenderCmd,e._rootCtor=l.Node.CanvasRenderCmd,e._notifyRegionStatus=function(e){this._needDraw&&this._regionFlag<e&&(this._regionFlag=e)};var t=new l.Rect;e.getLocalBB=function(){var e=this._node;return t.x=t.y=0,t.width=e._contentSize.width,t.height=e._contentSize.height,t},e._updateCurrentRegions=function(){var e=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=e,l.Node.CanvasRenderCmd.RegionStatus.DirtyDouble!==this._regionFlag||this._currentRegion.isEmpty()||this._oldRegion.union(this._currentRegion),this._currentRegion.updateRegion(this.getLocalBB(),this._worldTransform)},e.setDirtyFlag=function(e,t){l.Node.RenderCmd.prototype.setDirtyFlag.call(this,e,t),this._setCacheDirty(t),this._cachedParent&&this._cachedParent.setDirtyFlag(e,!0)},e._setCacheDirty=function(){if(!1===this._cacheDirty){this._cacheDirty=!0;var e=this._cachedParent;e&&e!==this&&e._setNodeDirtyForCache&&e._setNodeDirtyForCache()}},e._setCachedParent=function(e){if(this._cachedParent!==e){this._cachedParent=e;for(var t=this._node._children,i=0,n=t.length;i<n;i++)t[i]._renderCmd._setCachedParent(e)}},e.detachFromParent=function(){this._cachedParent=null;for(var e,t=this._node._children,i=0,n=t.length;i<n;i++)(e=t[i])&&e._renderCmd&&e._renderCmd.detachFromParent()},l.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc=function(e){return e?e.src===l.SRC_ALPHA&&e.dst===l.ONE||e.src===l.ONE&&e.dst===l.ONE?"lighter":e.src===l.ZERO&&e.dst===l.SRC_ALPHA?"destination-in":e.src===l.ZERO&&e.dst===l.ONE_MINUS_SRC_ALPHA?"destination-out":"source-over":"source-over"}}(),function(){l.Node.WebGLRenderCmd=function(e){this._node=e,this._anchorPointInPoints={x:0,y:0},this._displayedColor=l.color(255,255,255,255),this._glProgramState=null};var e=l.Node.WebGLRenderCmd.prototype=Object.create(l.Node.RenderCmd.prototype);e.constructor=l.Node.WebGLRenderCmd,e._rootCtor=l.Node.WebGLRenderCmd,e._updateColor=function(){},e.setShaderProgram=function(e){this._glProgramState=l.GLProgramState.getOrCreateWithGLProgram(e)},e.getShaderProgram=function(){return this._glProgramState?this._glProgramState.getGLProgram():null},e.getGLProgramState=function(){return this._glProgramState},e.setGLProgramState=function(e){this._glProgramState=e},Object.defineProperty(e,"_shaderProgram",{set:function(e){this.setShaderProgram(e)},get:function(){return this.getShaderProgram()}})}(),l.AtlasNode=l.Node.extend({textureAtlas:null,quadsToDraw:0,_itemsPerRow:0,_itemsPerColumn:0,_itemWidth:0,_itemHeight:0,_opacityModifyRGB:!1,_blendFunc:null,_ignoreContentScaleFactor:!1,_className:"AtlasNode",_texture:null,_textureForCanvas:null,ctor:function(e,t,i,n){l.Node.prototype.ctor.call(this),this._blendFunc={src:l.BLEND_SRC,dst:l.BLEND_DST},this._ignoreContentScaleFactor=!1,void 0!==n&&this.initWithTileFile(e,t,i,n)},_createRenderCmd:function(){l._renderType===l.game.RENDER_TYPE_CANVAS?this._renderCmd=new l.AtlasNode.CanvasRenderCmd(this):this._renderCmd=new l.AtlasNode.WebGLRenderCmd(this)},updateAtlasValues:function(){l.log(l._LogInfos.AtlasNode_updateAtlasValues)},getColor:function(){return this._opacityModifyRGB?this._renderCmd._colorUnmodified:l.Node.prototype.getColor.call(this)},setOpacityModifyRGB:function(e){var t=this.color;this._opacityModifyRGB=e,this.setColor(t)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){this._blendFunc=void 0===t?e:{src:e,dst:t}},setTextureAtlas:function(e){this.textureAtlas=e},getTextureAtlas:function(){return this.textureAtlas},getQuadsToDraw:function(){return this.quadsToDraw},setQuadsToDraw:function(e){this.quadsToDraw=e},initWithTileFile:function(e,t,i,n){if(!e)throw new Error("cc.AtlasNode.initWithTileFile(): title should not be null");var s=l.textureCache.addImage(e);return this.initWithTexture(s,t,i,n)},initWithTexture:function(e,t,i,n){return this._renderCmd.initWithTexture(e,t,i,n)},setColor:function(e){this._renderCmd.setColor(e)},setOpacity:function(e){this._renderCmd.setOpacity(e)},getTexture:function(){return this._texture},setTexture:function(e){this._texture=e},_setIgnoreContentScaleFactor:function(e){this._ignoreContentScaleFactor=e}});var d=l.AtlasNode.prototype;l.defineGetterSetter(d,"opacity",d.getOpacity,d.setOpacity),l.defineGetterSetter(d,"color",d.getColor,d.setColor),d.texture,l.defineGetterSetter(d,"texture",d.getTexture,d.setTexture),d.textureAtlas,d.quadsToDraw,l.EventHelper.prototype.apply(d),l.AtlasNode.create=function(e,t,i,n){return new l.AtlasNode(e,t,i,n)},function(){l.AtlasNode.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!1,this._colorUnmodified=l.color.WHITE,this._textureToRender=null};var e=l.AtlasNode.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.AtlasNode.CanvasRenderCmd,e.initWithTexture=function(e,t,i,n){var s=this._node;return s._itemWidth=t,s._itemHeight=i,s._opacityModifyRGB=!0,s._texture=e,s._texture?(this._textureToRender=e,this._calculateMaxItems(),s.quadsToDraw=n,!0):(l.log(l._LogInfos.AtlasNode__initWithTexture),!1)},e.setColor=function(e){var t=this._node._realColor;t.r===e.r&&t.g===e.g&&t.b===e.b||(this._colorUnmodified=e,this._changeTextureColor())},e._changeTextureColor=function(){var e=this._node._texture,t=this._colorUnmodified,i=e.getHtmlElementObj(),n=l.rect(0,0,i.width,i.height);e===this._textureToRender?this._textureToRender=e._generateColorTexture(t.r,t.g,t.b,n):e._generateColorTexture(t.r,t.g,t.b,n,this._textureToRender.getHtmlElementObj())},e.setOpacity=function(e){var t=this._node;l.Node.prototype.setOpacity.call(t,e)},e._calculateMaxItems=function(){var e=this._node,t=e._texture.getContentSize();e._itemsPerColumn=0|t.height/e._itemHeight,e._itemsPerRow=0|t.width/e._itemWidth}}(),function(){l.AtlasNode.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._textureAtlas=null,this._colorUnmodified=l.color.WHITE,this._colorF32Array=null,this._uniformColor=null,this._matrix=new l.math.Matrix4,this._matrix.identity(),this._shaderProgram=l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURE_UCOLOR),this._uniformColor=l._renderContext.getUniformLocation(this._shaderProgram.getProgram(),"u_color")};var e=l.AtlasNode.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.AtlasNode.WebGLRenderCmd,e._updateBlendFunc=function(){var e=this._node;this._textureAtlas.texture.hasPremultipliedAlpha()||(e._blendFunc.src=l.SRC_ALPHA,e._blendFunc.dst=l.ONE_MINUS_SRC_ALPHA)},e._updateOpacityModifyRGB=function(){this._node._opacityModifyRGB=this._textureAtlas.texture.hasPremultipliedAlpha()},e.rendering=function(e){var t=e||l._renderContext,i=this._node,n=this._worldTransform;this._matrix.mat[0]=n.a,this._matrix.mat[4]=n.c,this._matrix.mat[12]=n.tx,this._matrix.mat[1]=n.b,this._matrix.mat[5]=n.d,this._matrix.mat[13]=n.ty,this._glProgramState.apply(this._matrix),l.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),this._uniformColor&&this._colorF32Array&&(t.uniform4fv(this._uniformColor,this._colorF32Array),this._textureAtlas.drawNumberOfQuads(i.quadsToDraw,0))},e.initWithTexture=function(e,t,i,n){var s=this._node;s._itemWidth=t,s._itemHeight=i,this._colorUnmodified=l.color.WHITE,s._opacityModifyRGB=!0,s._blendFunc.src=l.BLEND_SRC,s._blendFunc.dst=l.BLEND_DST;var r=s._realColor;return this._colorF32Array=new Float32Array([r.r/255,r.g/255,r.b/255,s._realOpacity/255]),this._textureAtlas=new l.TextureAtlas,this._textureAtlas.initWithTexture(e,n),this._textureAtlas?(this._updateBlendFunc(),this._updateOpacityModifyRGB(),this._calculateMaxItems(),s.quadsToDraw=n,!0):(l.log(l._LogInfos.AtlasNode__initWithTexture),!1)},e.setColor=function(e){var t=l.color(e.r,e.g,e.b),i=this._node;this._colorUnmodified=e;var n=this._displayedOpacity;i._opacityModifyRGB&&(t.r=t.r*n/255,t.g=t.g*n/255,t.b=t.b*n/255),l.Node.prototype.setColor.call(i,t)},e.setOpacity=function(e){var t=this._node;l.Node.prototype.setOpacity.call(t,e),t._opacityModifyRGB&&(t.color=this._colorUnmodified)},e._updateColor=function(){if(this._colorF32Array){var e=this._displayedColor;this._colorF32Array[0]=e.r/255,this._colorF32Array[1]=e.g/255,this._colorF32Array[2]=e.b/255,this._colorF32Array[3]=this._displayedOpacity/255}},e.getTexture=function(){return this._textureAtlas.texture},e.setTexture=function(e){this._textureAtlas.texture=e,this._updateBlendFunc(),this._updateOpacityModifyRGB()},e._calculateMaxItems=function(){var e=this._node,t=this._textureAtlas.texture,i=t.getContentSize();e._ignoreContentScaleFactor&&(i=t.getContentSizeInPixels()),e._itemsPerColumn=0|i.height/e._itemHeight,e._itemsPerRow=0|i.width/e._itemWidth}}(),l._tmp.WebGLTexture2D=function(){l.Texture2D=l.Class.extend({_pVRHaveAlphaPremultiplied:!0,_pixelFormat:null,_pixelsWide:0,_pixelsHigh:0,_name:"",_contentSize:null,maxS:0,maxT:0,_hasPremultipliedAlpha:!1,_hasMipmaps:!1,shaderProgram:null,_textureLoaded:!1,_htmlElementObj:null,_webTextureObj:null,url:null,ctor:function(){this._contentSize=l.size(0,0),this._pixelFormat=l.Texture2D.defaultPixelFormat},releaseTexture:function(){this._webTextureObj&&l._renderContext.deleteTexture(this._webTextureObj),this._htmlElementObj=null,l.loader.release(this.url)},getPixelFormat:function(){return this._pixelFormat},getPixelsWide:function(){return this._pixelsWide},getPixelsHigh:function(){return this._pixelsHigh},getName:function(){return this._webTextureObj},getContentSize:function(){return l.size(this._contentSize.width/l.contentScaleFactor(),this._contentSize.height/l.contentScaleFactor())},_getWidth:function(){return this._contentSize.width/l.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/l.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},getMaxS:function(){return this.maxS},setMaxS:function(e){this.maxS=e},getMaxT:function(){return this.maxT},setMaxT:function(e){this.maxT=e},getShaderProgram:function(){return this.shaderProgram},setShaderProgram:function(e){this.shaderProgram=e},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha},hasMipmaps:function(){return this._hasMipmaps},description:function(){var e=this;return"<cc.Texture2D | Name = "+e._name+" | Dimensions = "+e._pixelsWide+" x "+e._pixelsHigh+" | Coordinates = ("+e.maxS+", "+e.maxT+")>"},releaseData:function(e){null},keepData:function(e,t){return e},initWithData:function(e,t,i,n,s){var r=this,a=l.Texture2D,o=l._renderContext,h=o.RGBA,d=o.UNSIGNED_BYTE,c=i*l.Texture2D._B[t]/8;switch(c%8==0?o.pixelStorei(o.UNPACK_ALIGNMENT,8):c%4==0?o.pixelStorei(o.UNPACK_ALIGNMENT,4):c%2==0?o.pixelStorei(o.UNPACK_ALIGNMENT,2):o.pixelStorei(o.UNPACK_ALIGNMENT,1),r._webTextureObj=o.createTexture(),l.glBindTexture2D(r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),t){case a.PIXEL_FORMAT_RGBA8888:h=o.RGBA;break;case a.PIXEL_FORMAT_RGB888:h=o.RGB;break;case a.PIXEL_FORMAT_RGBA4444:d=o.UNSIGNED_SHORT_4_4_4_4;break;case a.PIXEL_FORMAT_RGB5A1:d=o.UNSIGNED_SHORT_5_5_5_1;break;case a.PIXEL_FORMAT_RGB565:d=o.UNSIGNED_SHORT_5_6_5;break;case a.PIXEL_FORMAT_AI88:h=o.LUMINANCE_ALPHA;break;case a.PIXEL_FORMAT_A8:h=o.ALPHA;break;case a.PIXEL_FORMAT_I8:h=o.LUMINANCE;break;default:l.assert(0,l._LogInfos.Texture2D_initWithData)}return o.texImage2D(o.TEXTURE_2D,0,h,i,n,0,h,d,e),r._contentSize.width=s.width,r._contentSize.height=s.height,r._pixelsWide=i,r._pixelsHigh=n,r._pixelFormat=t,r.maxS=s.width/i,r.maxT=s.height/n,r._hasPremultipliedAlpha=!1,r._hasMipmaps=!1,r.shaderProgram=l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURE),r._textureLoaded=!0,!0},drawAtPoint:function(e){var t=this,i=[0,t.maxT,t.maxS,t.maxT,0,0,t.maxS,0],n=l._renderContext,s=t._pixelsWide*t.maxS,r=t._pixelsHigh*t.maxT,a=[e.x,e.y,0,s+e.x,e.y,0,e.x,r+e.y,0,s+e.x,r+e.y,0];t._glProgramState.apply(),t._glProgramState._glprogram.setUniformsForBuiltins(),l.glBindTexture2D(t),n.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),n.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,n.FLOAT,!1,0,a),n.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,0,i),n.drawArrays(n.TRIANGLE_STRIP,0,4)},drawInRect:function(e){var t=this,i=[0,t.maxT,t.maxS,t.maxT,0,0,t.maxS,0],n=[e.x,e.y,e.x+e.width,e.y,e.x,e.y+e.height,e.x+e.width,e.y+e.height];t._glProgramState.apply(),t._glProgramState._glprogram.setUniformsForBuiltins(),l.glBindTexture2D(t);var s=l._renderContext;s.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),s.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),s.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,s.FLOAT,!1,0,n),s.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,s.FLOAT,!1,0,i),s.drawArrays(s.TRIANGLE_STRIP,0,4)},initWithImage:function(e){if(null==e)return l.log(l._LogInfos.Texture2D_initWithImage),!1;var t=e.getWidth(),i=e.getHeight(),n=l.configuration.getMaxTextureSize();return t>n||i>n?(l.log(l._LogInfos.Texture2D_initWithImage_2,t,i,n,n),!1):(this._textureLoaded=!0,this._initPremultipliedATextureWithImage(e,t,i))},initWithElement:function(e){e&&(this._webTextureObj=l._renderContext.createTexture(),this._htmlElementObj=e,this._textureLoaded=!0,this._hasPremultipliedAlpha=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(e){var t=this;if(e=void 0!==e?e:t._hasPremultipliedAlpha,l.game._rendererInitialized&&t._htmlElementObj&&t._htmlElementObj.width&&t._htmlElementObj.height){var i=l._renderContext;l.glBindTexture2D(t),i.pixelStorei(i.UNPACK_ALIGNMENT,4),e&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t._htmlElementObj),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),t.shaderProgram=l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURE),l.glBindTexture2D(null),e&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0);var n=t._htmlElementObj.width,s=t._htmlElementObj.height;t._pixelsWide=t._contentSize.width=n,t._pixelsHigh=t._contentSize.height=s,t._pixelFormat=l.Texture2D.PIXEL_FORMAT_RGBA8888,t.maxS=1,t.maxT=1,t._hasPremultipliedAlpha=e,t._hasMipmaps=!1,ENABLE_IMAEG_POOL&&(t._htmlElementObj=null),t.dispatchEvent("load")}},initWithString:function(e,t,i,n,s,r){return l.log(l._LogInfos.Texture2D_initWithString),null},initWithETCFile:function(e){return l.log(l._LogInfos.Texture2D_initWithETCFile_2),!1},initWithPVRFile:function(e){return l.log(l._LogInfos.Texture2D_initWithPVRFile_2),!1},initWithPVRTCData:function(e,t,i,n,s,r){return l.log(l._LogInfos.Texture2D_initWithPVRTCData_2),!1},setTexParameters:function(e,t,i,n){var s=this,r=l._renderContext;void 0!==t&&(e={minFilter:e,magFilter:t,wrapS:i,wrapT:n}),l.assert(s._pixelsWide===l.NextPOT(s._pixelsWide)&&s._pixelsHigh===l.NextPOT(s._pixelsHigh)||e.wrapS===r.CLAMP_TO_EDGE&&e.wrapT===r.CLAMP_TO_EDGE,"WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures"),l.glBindTexture2D(s),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e.minFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e.magFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e.wrapS),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e.wrapT)},setAntiAliasTexParameters:function(){var e=l._renderContext;l.glBindTexture2D(this),this._hasMipmaps?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)},setAliasTexParameters:function(){var e=l._renderContext;l.glBindTexture2D(this),this._hasMipmaps?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)},generateMipmap:function(){var e=this;l.assert(e._pixelsWide===l.NextPOT(e._pixelsWide)&&e._pixelsHigh===l.NextPOT(e._pixelsHigh),"Mimpap texture only works in POT textures"),l.glBindTexture2D(e),l._renderContext.generateMipmap(l._renderContext.TEXTURE_2D),e._hasMipmaps=!0},stringForFormat:function(){return l.Texture2D._M[this._pixelFormat]},bitsPerPixelForFormat:function(e){e=e||this._pixelFormat;var t=l.Texture2D._B[e];return null!=t?t:(l.log(l._LogInfos.Texture2D_bitsPerPixelForFormat,e),-1)},_initPremultipliedATextureWithImage:function(e,t,i){var n=l.Texture2D,s=e.getData(),r=null,a=null,o=e.hasAlpha(),h=l.size(e.getWidth(),e.getHeight()),d=n.defaultPixelFormat,c=e.getBitsPerComponent();o||(c>=8?d=n.PIXEL_FORMAT_RGB888:(l.log(l._LogInfos.Texture2D__initPremultipliedATextureWithImage),d=n.PIXEL_FORMAT_RGB565));var u,p=t*i;if(d===n.PIXEL_FORMAT_RGB565)if(o)for(s=new Uint16Array(t*i),r=e.getData(),u=0;u<p;++u)s[u]=(r[u]>>0&255)>>3<<11|(r[u]>>8&255)>>2<<5|(r[u]>>16&255)>>3<<0;else for(s=new Uint16Array(t*i),a=e.getData(),u=0;u<p;++u)s[u]=(255&a[u])>>3<<11|(255&a[u])>>2<<5|(255&a[u])>>3<<0;else if(d===n.PIXEL_FORMAT_RGBA4444)for(s=new Uint16Array(t*i),r=e.getData(),u=0;u<p;++u)s[u]=(r[u]>>0&255)>>4<<12|(r[u]>>8&255)>>4<<8|(r[u]>>16&255)>>4<<4|(r[u]>>24&255)>>4<<0;else if(d===n.PIXEL_FORMAT_RGB5A1)for(s=new Uint16Array(t*i),r=e.getData(),u=0;u<p;++u)s[u]=(r[u]>>0&255)>>3<<11|(r[u]>>8&255)>>3<<6|(r[u]>>16&255)>>3<<1|(r[u]>>24&255)>>7<<0;else if(d===n.PIXEL_FORMAT_A8)for(s=new Uint8Array(t*i),r=e.getData(),u=0;u<p;++u)s[u]=r>>24&255;if(o&&d===n.PIXEL_FORMAT_RGB888)for(r=e.getData(),s=new Uint8Array(t*i*3),u=0;u<p;++u)s[3*u]=r>>0&255,s[3*u+1]=r>>8&255,s[3*u+2]=r>>16&255;return this.initWithData(s,d,t,i,h),s!=e.getData()&&(s=null),this._hasPremultipliedAlpha=e.isPremultipliedAlpha(),!0},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},removeLoadedEventListener:function(e){this.removeEventTarget("load",e)}})},l._tmp.WebGLTextureAtlas=function(){var e=l.TextureAtlas.prototype;e._setupVBO=function(){var e=this,t=l._renderContext;e._buffersVBO[0]=t.createBuffer(),e._buffersVBO[1]=t.createBuffer(),e._quadsWebBuffer=t.createBuffer(),e._mapBuffers()},e._mapBuffers=function(){var e=this,t=l._renderContext;t.bindBuffer(t.ARRAY_BUFFER,e._quadsWebBuffer),t.bufferData(t.ARRAY_BUFFER,e._quadsArrayBuffer,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._buffersVBO[1]),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e._indices,t.STATIC_DRAW)},e.drawNumberOfQuads=function(e,t){var i=this;if(t=t||0,0!==e&&i.texture&&i.texture.isLoaded()){var n=l._renderContext;l.glBindTexture2D(i.texture),n.bindBuffer(n.ARRAY_BUFFER,i._quadsWebBuffer),i.dirty&&(n.bufferData(n.ARRAY_BUFFER,i._quadsArrayBuffer,n.DYNAMIC_DRAW),i.dirty=!1),n.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(l.VERTEX_ATTRIB_COLOR),n.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),n.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,24,0),n.vertexAttribPointer(l.VERTEX_ATTRIB_COLOR,4,n.UNSIGNED_BYTE,!0,24,12),n.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,24,16),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i._buffersVBO[1]),l.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?n.drawElements(n.TRIANGLE_STRIP,6*e,n.UNSIGNED_SHORT,6*t*i._indices.BYTES_PER_ELEMENT):n.drawElements(n.TRIANGLES,6*e,n.UNSIGNED_SHORT,6*t*i._indices.BYTES_PER_ELEMENT),l.g_NumberOfDraws++}}},l._tmp.WebGLTextureCache=function(){var e=l.textureCache;e.handleLoadedTexture=function(e,t){var i,n=this._textures;return l.game._rendererInitialized||(n=this._loadedTexturesBefore),(i=n[e])||((i=n[e]=new l.Texture2D).url=e),i.initWithElement(t),".png"===l.path.extname(e)?i.handleLoadedTexture(!0):i.handleLoadedTexture(),i},e.addImage=function(e,t,i){l.assert(e,l._LogInfos.Texture2D_addImage_2);var n=this._textures;l.game._rendererInitialized||(n=this._loadedTexturesBefore);var s=n[e]||n[l.loader._getAliase(e)];if(s)return s.isLoaded()?(t&&t.call(i,s),s):(s.addEventListener("load",function(){t&&t.call(i,s)},i),s);(s=n[e]=new l.Texture2D).url=e;var r=l.loader.getBasePath?l.loader.getBasePath():l.loader.resPath,a=0===e.indexOf("http")?e:l.path.join(r||"",e);return l.loader.loadImg(a,function(n,s){if(n)return t&&t.call(i,n);var r=l.textureCache.handleLoadedTexture(e,s);t&&t.call(i,r)}),s},e.addImageAsync=e.addImage,e=null},l._tmp.PrototypeTexture2D=function(){var e=l.Texture2D;e.PVRImagesHavePremultipliedAlpha=function(e){l.PVRHaveAlphaPremultiplied_=e},e.PIXEL_FORMAT_RGBA8888=2,e.PIXEL_FORMAT_RGB888=3,e.PIXEL_FORMAT_RGB565=4,e.PIXEL_FORMAT_A8=5,e.PIXEL_FORMAT_I8=6,e.PIXEL_FORMAT_AI88=7,e.PIXEL_FORMAT_RGBA4444=8,e.PIXEL_FORMAT_RGB5A1=7,e.PIXEL_FORMAT_PVRTC4=9,e.PIXEL_FORMAT_PVRTC2=10,e.PIXEL_FORMAT_DEFAULT=e.PIXEL_FORMAT_RGBA8888,e.defaultPixelFormat=e.PIXEL_FORMAT_DEFAULT;var t=l.Texture2D._M={};t[e.PIXEL_FORMAT_RGBA8888]="RGBA8888",t[e.PIXEL_FORMAT_RGB888]="RGB888",t[e.PIXEL_FORMAT_RGB565]="RGB565",t[e.PIXEL_FORMAT_A8]="A8",t[e.PIXEL_FORMAT_I8]="I8",t[e.PIXEL_FORMAT_AI88]="AI88",t[e.PIXEL_FORMAT_RGBA4444]="RGBA4444",t[e.PIXEL_FORMAT_RGB5A1]="RGB5A1",t[e.PIXEL_FORMAT_PVRTC4]="PVRTC4",t[e.PIXEL_FORMAT_PVRTC2]="PVRTC2";var i=l.Texture2D._B={};i[e.PIXEL_FORMAT_RGBA8888]=32,i[e.PIXEL_FORMAT_RGB888]=24,i[e.PIXEL_FORMAT_RGB565]=16,i[e.PIXEL_FORMAT_A8]=8,i[e.PIXEL_FORMAT_I8]=8,i[e.PIXEL_FORMAT_AI88]=16,i[e.PIXEL_FORMAT_RGBA4444]=16,i[e.PIXEL_FORMAT_RGB5A1]=16,i[e.PIXEL_FORMAT_PVRTC4]=4,i[e.PIXEL_FORMAT_PVRTC2]=3;var n=l.Texture2D.prototype;n.name,l.defineGetterSetter(n,"name",n.getName),n.pixelFormat,l.defineGetterSetter(n,"pixelFormat",n.getPixelFormat),n.pixelsWidth,l.defineGetterSetter(n,"pixelsWidth",n.getPixelsWide),n.pixelsHeight,l.defineGetterSetter(n,"pixelsHeight",n.getPixelsHigh),n.width,l.defineGetterSetter(n,"width",n._getWidth),n.height,l.defineGetterSetter(n,"height",n._getHeight)},l._tmp.PrototypeTextureAtlas=function(){var e=l.TextureAtlas.prototype;e.totalQuads,l.defineGetterSetter(e,"totalQuads",e.getTotalQuads),e.capacity,l.defineGetterSetter(e,"capacity",e.getCapacity),e.quads,l.defineGetterSetter(e,"quads",e.getQuads,e.setQuads)},l.ALIGN_CENTER=51,l.ALIGN_TOP=19,l.ALIGN_TOP_RIGHT=18,l.ALIGN_RIGHT=50,l.ALIGN_BOTTOM_RIGHT=34,l.ALIGN_BOTTOM=35,l.ALIGN_BOTTOM_LEFT=33,l.ALIGN_LEFT=49,l.ALIGN_TOP_LEFT=17,l.PVRHaveAlphaPremultiplied_=!1,l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){if(l._renderType===l.game.RENDER_TYPE_CANVAS){var e={_contentSize:null,_textureLoaded:!1,_htmlElementObj:null,url:null,_pattern:null,ctor:function(){this._contentSize=l.size(0,0),this._textureLoaded=!1,this._htmlElementObj=null,this._pattern="",this._pixelsWide=0,this._pixelsHigh=0},getPixelsWide:function(){return this._pixelsWide},getPixelsHigh:function(){return this._pixelsHigh},getContentSize:function(){var e=l.contentScaleFactor();return l.size(this._contentSize.width/e,this._contentSize.height/e)},_getWidth:function(){return this._contentSize.width/l.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/l.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(e){e&&(this._htmlElementObj=e,this._pixelsWide=this._contentSize.width=e.width,this._pixelsHigh=this._contentSize.height=e.height,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){var e=this;if(e._htmlElementObj){var t=e._htmlElementObj;e._pixelsWide=e._contentSize.width=t.width,e._pixelsHigh=e._contentSize.height=t.height,e.dispatchEvent("load")}},description:function(){return"<cc.Texture2D | width = "+this._contentSize.width+" height "+this._contentSize.height+">"},initWithData:function(e,t,i,n,s){return!1},initWithImage:function(e){return!1},initWithString:function(e,t,i,n,s,r){return!1},releaseTexture:function(){this._htmlElementObj=null,l.loader.release(this.url)},getName:function(){return null},getMaxS:function(){return 1},setMaxS:function(e){},getMaxT:function(){return 1},setMaxT:function(e){},getPixelFormat:function(){return null},getShaderProgram:function(){return null},setShaderProgram:function(e){},hasPremultipliedAlpha:function(){return!1},hasMipmaps:function(){return!1},releaseData:function(e){null},keepData:function(e,t){return e},drawAtPoint:function(e){},drawInRect:function(e){},initWithETCFile:function(e){return l.log(l._LogInfos.Texture2D_initWithETCFile),!1},initWithPVRFile:function(e){return l.log(l._LogInfos.Texture2D_initWithPVRFile),!1},initWithPVRTCData:function(e,t,i,n,s,r){return l.log(l._LogInfos.Texture2D_initWithPVRTCData),!1},setTexParameters:function(e,t,i,n){void 0!==t&&(e={minFilter:e,magFilter:t,wrapS:i,wrapT:n}),e.wrapS!==l.REPEAT||e.wrapT!==l.REPEAT?e.wrapS!==l.REPEAT?e.wrapT!==l.REPEAT?this._pattern="":this._pattern="repeat-y":this._pattern="repeat-x":this._pattern="repeat"},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(e){return-1},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},removeLoadedEventListener:function(e){this.removeEventTarget("load",e)},_generateColorTexture:function(){},_generateTextureCacheForColor:function(){if(this.channelCache)return this.channelCache;var e=[document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas")];return t(this._htmlElementObj,e),this.channelCache=e},_grayElementObj:null,_backupElement:null,_isGray:!1,_switchToGray:function(e){this._textureLoaded&&this._isGray!==e&&(this._isGray=e,this._isGray?(this._backupElement=this._htmlElementObj,this._grayElementObj||(this._grayElementObj=l.Texture2D._generateGrayTexture(this._htmlElementObj)),this._htmlElementObj=this._grayElementObj):null!==this._backupElement&&(this._htmlElementObj=this._backupElement))},_generateGrayTexture:function(){if(!this._textureLoaded)return null;var e=l.Texture2D._generateGrayTexture(this._htmlElementObj),t=new l.Texture2D;return t.initWithElement(e),t.handleLoadedTexture(),t}},t=function(e,t){var i=e.width,n=e.height;t[0].width=i,t[0].height=n,t[1].width=i,t[1].height=n,t[2].width=i,t[2].height=n,t[3].width=i,t[3].height=n;var s=t[3].getContext("2d");s.drawImage(e,0,0);for(var r,a=s.getImageData(0,0,i,n).data,o=0;o<4;o++){for(var h=(r=t[o].getContext("2d")).getImageData(0,0,i,n),l=h.data,d=0;d<a.length;d+=4)l[d]=0===o?a[d]:0,l[d+1]=1===o?a[d+1]:0,l[d+2]=2===o?a[d+2]:0,l[d+3]=a[d+3];r.putImageData(h,0,0)}e.onload=null};l.sys._supportCanvasNewBlendModes?e._generateColorTexture=function(e,t,i,n,s){var r=!1;s?r=!0:s=document.createElement("canvas");var a=this._htmlElementObj;n||(n=l.rect(0,0,a.width,a.height)),s.width=n.width,s.height=n.height;var o=s.getContext("2d");if(o.globalCompositeOperation="source-over",o.fillStyle="rgb("+(0|e)+","+(0|t)+","+(0|i)+")",o.fillRect(0,0,n.width,n.height),o.globalCompositeOperation="multiply",o.drawImage(a,n.x,n.y,n.width,n.height,0,0,n.width,n.height),o.globalCompositeOperation="destination-atop",o.drawImage(a,n.x,n.y,n.width,n.height,0,0,n.width,n.height),r)return s;var h=new l.Texture2D;return h.initWithElement(s),h.handleLoadedTexture(),h}:e._generateColorTexture=function(e,t,i,n,s){var r=!1;s?r=!0:s=document.createElement("canvas");var a=this._htmlElementObj;n||(n=l.rect(0,0,a.width,a.height));var o,h,d,c;if(o=n.x,h=n.y,d=n.width,c=n.height,d&&c){s.width=d,s.height=c;var u=s.getContext("2d"),p=l.textureCache.getTextureColors(this);if(u.globalCompositeOperation="lighter",u.drawImage(p[3],o,h,d,c,0,0,d,c),e>0&&(u.globalAlpha=e/255,u.drawImage(p[0],o,h,d,c,0,0,d,c)),t>0&&(u.globalAlpha=t/255,u.drawImage(p[1],o,h,d,c,0,0,d,c)),i>0&&(u.globalAlpha=i/255,u.drawImage(p[2],o,h,d,c,0,0,d,c)),r)return s;var m=new l.Texture2D;return m.initWithElement(s),m.handleLoadedTexture(),m}},l.Texture2D=l.Class.extend(e),l.Texture2D._generateGrayTexture=function(e,t,i){if(null===e)return null;i=i||document.createElement("canvas"),t=t||l.rect(0,0,e.width,e.height),i.width=t.width,i.height=t.height;var n=i.getContext("2d");n.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);for(var s=n.getImageData(0,0,t.width,t.height),r=s.data,a=0,o=r.length;a<o;a+=4)r[a]=r[a+1]=r[a+2]=.34*r[a]+.5*r[a+1]+.16*r[a+2];return n.putImageData(s,0,0),i}}else l._renderType===l.game.RENDER_TYPE_WEBGL&&(l.assert(l.isFunction(l._tmp.WebGLTexture2D),l._LogInfos.MissingFile,"TexturesWebGL.js"),l._tmp.WebGLTexture2D(),delete l._tmp.WebGLTexture2D);l.EventHelper.prototype.apply(l.Texture2D.prototype),l.assert(l.isFunction(l._tmp.PrototypeTexture2D),l._LogInfos.MissingFile,"TexturesPropertyDefine.js"),l._tmp.PrototypeTexture2D(),delete l._tmp.PrototypeTexture2D}),l.textureCache={_textures:{},_textureColorsCache:{},_textureKeySeq:0|1e3*Math.random(),_loadedTexturesBefore:{},_initializingRenderer:function(){var e,t=this._loadedTexturesBefore,i=this._textures;for(e in t){var n=t[e];n.handleLoadedTexture(),i[e]=n}this._loadedTexturesBefore={}},addPVRTCImage:function(e){l.log(l._LogInfos.textureCache_addPVRTCImage)},addETCImage:function(e){l.log(l._LogInfos.textureCache_addETCImage)},description:function(){return"<TextureCache | Number of textures = "+this._textures.length+">"},textureForKey:function(e){return l.log(l._LogInfos.textureCache_textureForKey),this.getTextureForKey(e)},getTextureForKey:function(e){return this._textures[e]||this._textures[l.loader._getAliase(e)]},getKeyByTexture:function(e){for(var t in this._textures)if(this._textures[t]===e)return t;return null},_generalTextureKey:function(e){return"_textureKey_"+e},getTextureColors:function(e){var t=e._htmlElementObj,i=this.getKeyByTexture(t);return i||(i=t instanceof HTMLImageElement?t.src:this._generalTextureKey(e.__instanceId)),this._textureColorsCache[i]||(this._textureColorsCache[i]=e._generateTextureCacheForColor()),this._textureColorsCache[i]},addPVRImage:function(e){l.log(l._LogInfos.textureCache_addPVRImage)},removeAllTextures:function(){var e=this._textures;for(var t in e)e[t]&&e[t].releaseTexture();this._textures={}},removeTexture:function(e){if(e){var t=this._textures;for(var i in t)t[i]===e&&(t[i].releaseTexture(),delete t[i])}},removeTextureForKey:function(e){if(null!=e){var t=this._textures[e];t&&(t.releaseTexture(),delete this._textures[e])}},cacheImage:function(e,t){if(t instanceof l.Texture2D)this._textures[e]=t;else{var i=new l.Texture2D;i.initWithElement(t),i.handleLoadedTexture(),this._textures[e]=i}},addUIImage:function(e,t){if(l.assert(e,l._LogInfos.textureCache_addUIImage_2),t&&this._textures[t])return this._textures[t];var i=new l.Texture2D;return i.initWithImage(e),null!=t?this._textures[t]=i:l.log(l._LogInfos.textureCache_addUIImage),i},dumpCachedTextureInfo:function(){var e=0,t=0,i=this._textures;for(var n in i){var s=i[n];e++,s.getHtmlElementObj()instanceof HTMLImageElement?l.log(l._LogInfos.textureCache_dumpCachedTextureInfo,n,s.getHtmlElementObj().src,s.getPixelsWide(),s.getPixelsHigh()):l.log(l._LogInfos.textureCache_dumpCachedTextureInfo_2,n,s.getPixelsWide(),s.getPixelsHigh()),t+=s.getPixelsWide()*s.getPixelsHigh()*4}var r=this._textureColorsCache;for(n in r){var a=r[n];for(var o in a){var h=a[o];e++,l.log(l._LogInfos.textureCache_dumpCachedTextureInfo_2,n,h.width,h.height),t+=h.width*h.height*4}}l.log(l._LogInfos.textureCache_dumpCachedTextureInfo_3,e+"",t/1024+"",(t/1048576).toFixed(2)+"")},_clear:function(){this._textures={},this._textureColorsCache={},this._textureKeySeq=0|1e3*Math.random(),this._loadedTexturesBefore={}}},l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){if(l._renderType===l.game.RENDER_TYPE_CANVAS){var e=l.textureCache;e.handleLoadedTexture=function(e,t){var i=this._textures,n=i[e];return n||((n=i[e]=new l.Texture2D).url=e),n.initWithElement(t),n.handleLoadedTexture(),n},e.addImage=function(e,t,i){l.assert(e,l._LogInfos.Texture2D_addImage);var n=this._textures,s=n[e]||n[l.loader._getAliase(e)];if(s)return s.isLoaded()?(t&&t.call(i,s),s):(s.addEventListener("load",function(){t&&t.call(i,s)},i),s);(s=n[e]=new l.Texture2D).url=e;var r=l.loader.getBasePath?l.loader.getBasePath():l.loader.resPath,a=0===e.indexOf("http")?e:l.path.join(r||"",e);return l.loader.loadImg(a,function(n,s){if(n)return t&&t.call(i,n);var r=l.textureCache.handleLoadedTexture(e,s);t&&t.call(i,r)}),s},e.addImageAsync=e.addImage,e=null}else l._renderType===l.game.RENDER_TYPE_WEBGL&&(l.assert(l.isFunction(l._tmp.WebGLTextureCache),l._LogInfos.MissingFile,"TexturesWebGL.js"),l._tmp.WebGLTextureCache(),delete l._tmp.WebGLTextureCache)}),l.TextureAtlas=l.Class.extend({dirty:!1,texture:null,_indices:null,_buffersVBO:null,_capacity:0,_quads:null,_quadsArrayBuffer:null,_quadsWebBuffer:null,_quadsReader:null,ctor:function(e,t){this._buffersVBO=[],l.isString(e)?this.initWithFile(e,t):e instanceof l.Texture2D&&this.initWithTexture(e,t)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(e){this.texture=e},setDirty:function(e){this.dirty=e},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(e){this._quads=e},_copyQuadsToTextureAtlas:function(e,t){if(e)for(var i=0;i<e.length;i++)this._setQuadToArray(e[i],t+i)},_setQuadToArray:function(e,t){var i=this._quads;i[t]?(i[t].bl=e.bl,i[t].br=e.br,i[t].tl=e.tl,i[t].tr=e.tr):i[t]=new l.V3F_C4B_T2F_Quad(e.tl,e.bl,e.tr,e.br,this._quadsArrayBuffer,t*l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)},description:function(){return"<cc.TextureAtlas | totalQuads ="+this._totalQuads+">"},_setupIndices:function(){if(0!==this._capacity)for(var e=this._indices,t=this._capacity,i=0;i<t;i++)l.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?(e[6*i+0]=4*i+0,e[6*i+1]=4*i+0,e[6*i+2]=4*i+2,e[6*i+3]=4*i+1,e[6*i+4]=4*i+3,e[6*i+5]=4*i+3):(e[6*i+0]=4*i+0,e[6*i+1]=4*i+1,e[6*i+2]=4*i+2,e[6*i+3]=4*i+3,e[6*i+4]=4*i+2,e[6*i+5]=4*i+1)},_setupVBO:function(){var e=l._renderContext;this._buffersVBO[0]=e.createBuffer(),this._buffersVBO[1]=e.createBuffer(),this._quadsWebBuffer=e.createBuffer(),this._mapBuffers()},_mapBuffers:function(){var e=l._renderContext;e.bindBuffer(e.ARRAY_BUFFER,this._quadsWebBuffer),e.bufferData(e.ARRAY_BUFFER,this._quadsArrayBuffer,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW)},initWithFile:function(e,t){var i=l.textureCache.addImage(e);return i?this.initWithTexture(i,t):(l.log(l._LogInfos.TextureAtlas_initWithFile,e),!1)},initWithTexture:function(e,t){l.assert(e,l._LogInfos.TextureAtlas_initWithTexture),t|=0,this._capacity=t,this._totalQuads=0,this.texture=e,this._quads=[],this._indices=new Uint16Array(6*t);var i=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._quadsArrayBuffer=new ArrayBuffer(i*t),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),(!this._quads||!this._indices)&&t>0)return!1;for(var n=this._quads,s=0;s<t;s++)n[s]=new l.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,s*i);return this._setupIndices(),this._setupVBO(),this.dirty=!0,!0},updateQuad:function(e,t){l.assert(e,l._LogInfos.TextureAtlas_updateQuad),l.assert(t>=0&&t<this._capacity,l._LogInfos.TextureAtlas_updateQuad_2),this._totalQuads=Math.max(t+1,this._totalQuads),this._setQuadToArray(e,t),this.dirty=!0},insertQuad:function(e,t){if(l.assert(t<this._capacity,l._LogInfos.TextureAtlas_insertQuad_2),++this._totalQuads>this._capacity)l.log(l._LogInfos.TextureAtlas_insertQuad);else{var i=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=t*i,s=(this._totalQuads-1-t)*i;this._quads[this._totalQuads-1]=new l.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*i),this._quadsReader.set(this._quadsReader.subarray(n,n+s),n+i),this._setQuadToArray(e,t),this.dirty=!0}},insertQuads:function(e,t,i){i=i||e.length,l.assert(t+i<=this._capacity,l._LogInfos.TextureAtlas_insertQuads);var n=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads+=i,this._totalQuads>this._capacity)l.log(l._LogInfos.TextureAtlas_insertQuad);else{var s,r=t*n,a=(this._totalQuads-1-t-i)*n,o=this._totalQuads-1-i;for(s=0;s<i;s++)this._quads[o+s]=new l.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*n);for(this._quadsReader.set(this._quadsReader.subarray(r,r+a),r+n*i),s=0;s<i;s++)this._setQuadToArray(e[s],t+s);this.dirty=!0}},insertQuadFromIndex:function(e,t){if(e!==t){l.assert(t>=0||t<this._totalQuads,l._LogInfos.TextureAtlas_insertQuadFromIndex),l.assert(e>=0||e<this._totalQuads,l._LogInfos.TextureAtlas_insertQuadFromIndex_2);var i,n,s=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,r=this._quadsReader,a=r.subarray(e*s,s);e>t?(i=t*s,n=(e-t)*s,r.set(r.subarray(i,i+n),i+s),r.set(a,i)):(i=(e+1)*s,n=(t-e)*s,r.set(r.subarray(i,i+n),i-s),r.set(a,t*s)),this.dirty=!0}},removeQuadAtIndex:function(e){l.assert(e<this._totalQuads,l._LogInfos.TextureAtlas_removeQuadAtIndex);var t=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads--,this._quads.length=this._totalQuads,e!==this._totalQuads){var i=(e+1)*t,n=(this._totalQuads-e)*t;this._quadsReader.set(this._quadsReader.subarray(i,i+n),i-t)}this.dirty=!0},removeQuadsAtIndex:function(e,t){if(l.assert(e+t<=this._totalQuads,l._LogInfos.TextureAtlas_removeQuadsAtIndex),this._totalQuads-=t,e!==this._totalQuads){var i=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=(e+t)*i,s=(this._totalQuads-e)*i,r=e*i;this._quadsReader.set(this._quadsReader.subarray(n,n+s),r)}this.dirty=!0},removeAllQuads:function(){this._quads.length=0,this._totalQuads=0},_setDirty:function(e){this.dirty=e},resizeCapacity:function(e){if(e===this._capacity)return!0;var t=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=this._capacity;this._totalQuads=Math.min(this._totalQuads,e),this._capacity=0|e;var n,s=this._capacity,r=this._totalQuads;if(null===this._quads)for(this._quads=[],this._quadsArrayBuffer=new ArrayBuffer(t*s),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),n=0;n<s;n++)this._quads=new l.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,n*t);else{var a,o,h=this._quads;if(s>i){for(a=[],o=new ArrayBuffer(t*s),n=0;n<r;n++)a[n]=new l.V3F_C4B_T2F_Quad(h[n].tl,h[n].bl,h[n].tr,h[n].br,o,n*t);for(;n<s;n++)a[n]=new l.V3F_C4B_T2F_Quad(null,null,null,null,o,n*t);this._quadsReader=new Uint8Array(o),this._quads=a,this._quadsArrayBuffer=o}else{var d=Math.max(r,s);for(a=[],o=new ArrayBuffer(t*s),n=0;n<d;n++)a[n]=new l.V3F_C4B_T2F_Quad(h[n].tl,h[n].bl,h[n].tr,h[n].br,o,n*t);this._quadsReader=new Uint8Array(o),this._quads=a,this._quadsArrayBuffer=o}}if(null===this._indices)this._indices=new Uint16Array(6*s);else if(s>i){var c=new Uint16Array(6*s);c.set(this._indices,0),this._indices=c}else this._indices=this._indices.subarray(0,6*s);return this._setupIndices(),this._mapBuffers(),this.dirty=!0,!0},increaseTotalQuadsWith:function(e){this._totalQuads+=e},moveQuadsFromIndex:function(e,t,i){if(void 0===i){if(i=t,t=this._totalQuads-e,l.assert(i+(this._totalQuads-e)<=this._capacity,l._LogInfos.TextureAtlas_moveQuadsFromIndex),0===t)return}else if(l.assert(i+t<=this._totalQuads,l._LogInfos.TextureAtlas_moveQuadsFromIndex_2),l.assert(e<this._totalQuads,l._LogInfos.TextureAtlas_moveQuadsFromIndex_3),e===i)return;var n,s,r=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,a=e*r,o=t*r,h=this._quadsReader,d=h.subarray(a,a+o),c=i*r;i<e?(n=(e-i)*r,s=i*r,h.set(h.subarray(s,s+n),s+o)):(n=(i-e)*r,s=(e+t)*r,h.set(h.subarray(s,s+n),a)),h.set(d,c),this.dirty=!0},fillWithEmptyQuadsFromIndex:function(e,t){for(var i=t*l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=new Uint8Array(this._quadsArrayBuffer,e*l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i),s=0;s<i;s++)n[s]=0},drawQuads:function(){this.drawNumberOfQuads(this._totalQuads,0)},_releaseBuffer:function(){var e=l._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&e.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1]&&e.deleteBuffer(this._buffersVBO[1])),this._quadsWebBuffer&&e.deleteBuffer(this._quadsWebBuffer)}});var d=l.TextureAtlas.prototype;d.totalQuads,l.defineGetterSetter(d,"totalQuads",d.getTotalQuads),d.capacity,l.defineGetterSetter(d,"capacity",d.getCapacity),d.quads,l.defineGetterSetter(d,"quads",d.getQuads,d.setQuads),l.TextureAtlas.create=function(e,t){return new l.TextureAtlas(e,t)},l.TextureAtlas.createWithTexture=l.TextureAtlas.create,l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){l._renderType===l.game.RENDER_TYPE_WEBGL&&(l.assert(l.isFunction(l._tmp.WebGLTextureAtlas),l._LogInfos.MissingFile,"TexturesWebGL.js"),l._tmp.WebGLTextureAtlas(),delete l._tmp.WebGLTextureAtlas)}),l.assert(l.isFunction(l._tmp.PrototypeTextureAtlas),l._LogInfos.MissingFile,"TexturesPropertyDefine.js"),l._tmp.PrototypeTextureAtlas(),delete l._tmp.PrototypeTextureAtlas,l.Scene=l.Node.extend({_className:"Scene",ctor:function(){l.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(l.director.getWinSize())}}),l.Scene.create=function(){return new l.Scene},l.LoaderScene=l.Scene.extend({_interval:null,_label:null,_logo:null,_className:"LoaderScene",cb:null,target:null,init:function(){var e=this,t=160,i=200,n=e._bgLayer=new l.LayerColor(l.color(32,32,32,255));e.addChild(n,0);var s=24,r=-i/2+100;l._loaderImage&&(l.loader.loadImg(l._loaderImage,{isCrossOrigin:!1},function(n,s){t=s.width,i=s.height,e._initStage(s,l.visibleRect.center)}),s=14,r=-i/2-10);var a=e._label=new l.LabelTTF("Loading... 0%","Arial",s);return a.setPosition(l.pAdd(l.visibleRect.center,l.p(0,r))),a.setColor(l.color(180,180,180)),n.addChild(this._label,10),!0},_initStage:function(e,t){var i=this,n=i._texture2d=new l.Texture2D;n.initWithElement(e),n.handleLoadedTexture();var s=i._logo=new l.Sprite(n);s.setScale(l.contentScaleFactor()),s.x=t.x,s.y=t.y,i._bgLayer.addChild(s,10)},onEnter:function(){var e=this;l.Node.prototype.onEnter.call(e),e.schedule(e._startLoading,.3)},onExit:function(){l.Node.prototype.onExit.call(this);this._label.setString("Loading... 0%")},initWithResources:function(e,t,i){l.isString(e)&&(e=[e]),this.resources=e||[],this.cb=t,this.target=i},_startLoading:function(){var e=this;e.unschedule(e._startLoading);var t=e.resources;l.loader.load(t,function(t,i,n){var s=n/i*100|0;s=Math.min(s,100),e._label.setString("Loading... "+s+"%")},function(){e.cb&&e.cb.call(e.target)})},_updateTransform:function(){this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty),this._bgLayer._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty),this._label._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty),this._logo&&this._logo._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)}}),l.LoaderScene.preload=function(e,t,i){var n=l;return n.loaderScene||(n.loaderScene=new l.LoaderScene,n.loaderScene.init(),l.eventManager.addCustomListener(l.Director.EVENT_PROJECTION_CHANGED,function(){n.loaderScene._updateTransform()})),n.loaderScene.initWithResources(e,t,i),l.director.runScene(n.loaderScene),n.loaderScene},l.Layer=l.Node.extend({_className:"Layer",ctor:function(){l.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(l.winSize),this._cascadeColorEnabled=!1,this._cascadeOpacityEnabled=!1},bake:function(){this._renderCmd.bake()},unbake:function(){this._renderCmd.unbake()},isBaked:function(){return this._renderCmd._isBaked},visit:function(e){var t=this._renderCmd,i=e?e._renderCmd:null;if(this._visible){var n=l.renderer;if(t.visit(i),t._isBaked)n.pushRenderCommand(t),t._bakeSprite.visit(this);else{var s,r,a=this._children,o=a.length;if(o>0){for(this._reorderChildDirty&&this.sortAllChildren(),s=0;s<o&&(r=a[s])._localZOrder<0;s++)r.visit(this);for(n.pushRenderCommand(t);s<o;s++)a[s].visit(this)}else n.pushRenderCommand(t)}t._dirtyFlag=0}else t._propagateFlagsDown(i)},addChild:function(e,t,i){l.Node.prototype.addChild.call(this,e,t,i),this._renderCmd._bakeForAddChild(e)},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.Layer.CanvasRenderCmd(this):new l.Layer.WebGLRenderCmd(this)}}),l.Layer.create=function(){return new l.Layer},l.LayerColor=l.Layer.extend({_blendFunc:null,_className:"LayerColor",getBlendFunc:function(){return this._blendFunc},changeWidthAndHeight:function(e,t){this.width=e,this.height=t},changeWidth:function(e){this.width=e},changeHeight:function(e){this.height=e},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},ctor:function(e,t,i){l.Layer.prototype.ctor.call(this),this._blendFunc=l.BlendFunc._alphaNonPremultiplied(),l.LayerColor.prototype.init.call(this,e,t,i)},init:function(e,t,i){var n=l.director.getWinSize();e=e||l.color(0,0,0,255),t=void 0===t?n.width:t,i=void 0===i?n.height:i;var s=this._realColor;return s.r=e.r,s.g=e.g,s.b=e.b,this._realOpacity=e.a,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.colorDirty|l.Node._dirtyFlags.opacityDirty),l.LayerColor.prototype.setContentSize.call(this,t,i),!0},visit:function(e){var t=this._renderCmd,i=e?e._renderCmd:null;if(this._visible){var n=l.renderer;if(t.visit(i),t._isBaked)n.pushRenderCommand(t._bakeRenderCmd),t._bakeSprite._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty),t._bakeSprite.visit(this);else{var s,r=this._children,a=r.length;if(a>0){for(this._reorderChildDirty&&this.sortAllChildren(),s=0;s<a;s++){var o=r[s];if(!(o._localZOrder<0))break;o.visit(this)}for(n.pushRenderCommand(t);s<a;s++)r[s].visit(this)}else n.pushRenderCommand(t)}t._dirtyFlag=0}else t._propagateFlagsDown(i)},setBlendFunc:function(e,t){var i=this._blendFunc;void 0===t?(i.src=e.src,i.dst=e.dst):(i.src=e,i.dst=t),this._renderCmd.updateBlendFunc(i)},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.LayerColor.CanvasRenderCmd(this):new l.LayerColor.WebGLRenderCmd(this)}}),l.LayerColor.create=function(e,t,i){return new l.LayerColor(e,t,i)},function(){var e=l.LayerColor.prototype;l.defineGetterSetter(e,"width",e._getWidth,e._setWidth),l.defineGetterSetter(e,"height",e._getHeight,e._setHeight)}(),l.LayerGradient=l.LayerColor.extend({_endColor:null,_startOpacity:255,_endOpacity:255,_alongVector:null,_compressedInterpolation:!1,_className:"LayerGradient",_colorStops:[],ctor:function(e,t,i,n){l.LayerColor.prototype.ctor.call(this),this._endColor=l.color(0,0,0,255),this._alongVector=l.p(0,-1),this._startOpacity=255,this._endOpacity=255,n&&n instanceof Array?(this._colorStops=n,n.splice(0,0,{p:0,color:e||l.color.BLACK}),n.push({p:1,color:t||l.color.BLACK})):this._colorStops=[{p:0,color:e||l.color.BLACK},{p:1,color:t||l.color.BLACK}],l.LayerGradient.prototype.init.call(this,e,t,i,n)},init:function(e,t,i,n){e=e||l.color(0,0,0,255),t=t||l.color(0,0,0,255),i=i||l.p(0,-1);var s=this,r=s._endColor;return s._startOpacity=e.a,r.r=t.r,r.g=t.g,r.b=t.b,s._endOpacity=t.a,s._alongVector=i,s._compressedInterpolation=!0,l.LayerColor.prototype.init.call(s,l.color(e.r,e.g,e.b,255)),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.colorDirty|l.Node._dirtyFlags.opacityDirty|l.Node._dirtyFlags.gradientDirty),!0},setContentSize:function(e,t){l.LayerColor.prototype.setContentSize.call(this,e,t),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.gradientDirty)},_setWidth:function(e){l.LayerColor.prototype._setWidth.call(this,e),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.gradientDirty)},_setHeight:function(e){l.LayerColor.prototype._setHeight.call(this,e),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.gradientDirty)},getStartColor:function(){return l.color(this._realColor)},setStartColor:function(e){this.color=e;var t=this._colorStops;if(t&&t.length>0){var i=t[0].color;i.r=e.r,i.g=e.g,i.b=e.b}},setEndColor:function(e){var t=this._endColor;t.r=e.r,t.g=e.g,t.b=e.b;var i=this._colorStops;if(i&&i.length>0){var n=i[i.length-1].color;n.r=e.r,n.g=e.g,n.b=e.b}this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.colorDirty)},getEndColor:function(){return l.color(this._endColor)},setStartOpacity:function(e){this._startOpacity=e;var t=this._colorStops;t&&t.length>0&&(t[0].color.a=e),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.opacityDirty)},getStartOpacity:function(){return this._startOpacity},setEndOpacity:function(e){this._endOpacity=e;var t=this._colorStops;t&&t.length>0&&(t[t.length-1].color.a=e),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.opacityDirty)},getEndOpacity:function(){return this._endOpacity},setVector:function(e){this._alongVector.x=e.x,this._alongVector.y=e.y,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.gradientDirty)},getVector:function(){return l.p(this._alongVector.x,this._alongVector.y)},isCompressedInterpolation:function(){return this._compressedInterpolation},setCompressedInterpolation:function(e){this._compressedInterpolation=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.gradientDirty)},getColorStops:function(){return this._colorStops},setColorStops:function(e){this._colorStops=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.colorDirty|l.Node._dirtyFlags.opacityDirty|l.Node._dirtyFlags.gradientDirty)},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.LayerGradient.CanvasRenderCmd(this):new l.LayerGradient.WebGLRenderCmd(this)}}),l.LayerGradient.create=function(e,t,i,n){return new l.LayerGradient(e,t,i,n)},function(){var e=l.LayerGradient.prototype;e.startColor,l.defineGetterSetter(e,"startColor",e.getStartColor,e.setStartColor),e.endColor,l.defineGetterSetter(e,"endColor",e.getEndColor,e.setEndColor),e.startOpacity,l.defineGetterSetter(e,"startOpacity",e.getStartOpacity,e.setStartOpacity),e.endOpacity,l.defineGetterSetter(e,"endOpacity",e.getEndOpacity,e.setEndOpacity),e.vector,l.defineGetterSetter(e,"vector",e.getVector,e.setVector),e.colorStops,l.defineGetterSetter(e,"colorStops",e.getColorStops,e.setColorStops)}(),l.LayerMultiplex=l.Layer.extend({_enabledLayer:0,_layers:null,_className:"LayerMultiplex",ctor:function(e){l.Layer.prototype.ctor.call(this),e instanceof Array?l.LayerMultiplex.prototype.initWithLayers.call(this,e):l.LayerMultiplex.prototype.initWithLayers.call(this,Array.prototype.slice.call(arguments))},initWithLayers:function(e){return e.length>0&&null==e[e.length-1]&&l.log(l._LogInfos.LayerMultiplex_initWithLayers),this._layers=e,this._enabledLayer=0,this.addChild(this._layers[this._enabledLayer]),!0},switchTo:function(e){e>=this._layers.length?l.log(l._LogInfos.LayerMultiplex_switchTo):(this.removeChild(this._layers[this._enabledLayer],!0),this._enabledLayer=e,this.addChild(this._layers[e]))},switchToAndReleaseMe:function(e){e>=this._layers.length?l.log(l._LogInfos.LayerMultiplex_switchToAndReleaseMe):(this.removeChild(this._layers[this._enabledLayer],!0),this._layers[this._enabledLayer]=null,this._enabledLayer=e,this.addChild(this._layers[e]))},addLayer:function(e){e?this._layers.push(e):l.log(l._LogInfos.LayerMultiplex_addLayer)}}),l.LayerMultiplex.create=function(){return new l.LayerMultiplex(Array.prototype.slice.call(arguments))},function(){l.Layer.CanvasRenderCmd=function(e){this._rootCtor(e),this._isBaked=!1,this._bakeSprite=null,this._canUseDirtyRegion=!0,this._updateCache=2};var e=l.Layer.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.Layer.CanvasRenderCmd,e._layerCmdCtor=l.Layer.CanvasRenderCmd,e._setCacheDirty=function(e){if(e&&0===this._updateCache&&(this._updateCache=2),!1===this._cacheDirty){this._cacheDirty=!0;var t=this._cachedParent;t&&t!==this&&t._setNodeDirtyForCache&&t._setNodeDirtyForCache()}},e.updateStatus=function(){var e=l.Node._dirtyFlags;this._dirtyFlag&e.orderDirty&&(this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2),this._dirtyFlag&=~e.orderDirty),this.originUpdateStatus()},e._syncStatus=function(e){var t=l.Node._dirtyFlags,i=this._dirtyFlag;(this._isBaked||i&t.orderDirty)&&(this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2),this._dirtyFlag&=~t.orderDirty),this._originSyncStatus(e)},e.transform=function(e,t){this._worldTransform||(this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0});var i=this._worldTransform,n=i.a,s=i.b,r=i.c,a=i.d;i.tx,i.ty;this.originTransform(e,t),i.a===n&&i.b===s&&i.c===r&&i.d===a||0!==this._updateCache||(this._updateCache=2)},e.bake=function(){if(!this._isBaked){this._needDraw=!0,l.renderer.childrenOrderDirty=!0,this._isBaked=this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2);for(var e=this._node._children,t=0,i=e.length;t<i;t++)e[t]._renderCmd._setCachedParent(this);this._bakeSprite||(this._bakeSprite=new l.BakeSprite,this._bakeSprite.setAnchorPoint(0,0))}},e.unbake=function(){if(this._isBaked){l.renderer.childrenOrderDirty=!0,this._needDraw=!1,this._isBaked=!1,this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2);for(var e=this._node._children,t=0,i=e.length;t<i;t++)e[t]._renderCmd._setCachedParent(null)}},e.isBaked=function(){return this._isBaked},e.rendering=function(){if(this._cacheDirty){var e=this._node,t=e._children,i=this._bakeSprite;this.transform(this.getParentRenderCmd(),!0);var n=this._getBoundingBoxForBake();n.width=0|n.width+.5,n.height=0|n.height+.5;var s=i.getCacheContext(),r=s.getContext();if(i.setPosition(n.x,n.y),this._updateCache>0){i.resetCanvasSize(n.width,n.height),s.setOffset(0-n.x,r.canvas.height-n.height+n.y),e.sortAllChildren(),l.renderer._turnToCacheMode(this.__instanceId);for(var a=0,o=t.length;a<o;a++)t[a].visit(this);l.renderer._renderingToCacheCanvas(s,this.__instanceId),i.transform(),this._updateCache--}this._cacheDirty=!1}},e._bakeForAddChild=function(e){e._parent===this._node&&this._isBaked&&e._renderCmd._setCachedParent(this)},e._getBoundingBoxForBake=function(){var e=null,t=this._node;if(!t._children||0===t._children.length)return l.rect(0,0,10,10);for(var i=t.getNodeToWorldTransform(),n=t._children,s=0,r=n.length;s<r;s++){var a=n[s];if(a&&a._visible)if(e){var o=a._getBoundingBoxToCurrentNode(i);o&&(e=l.rectUnion(e,o))}else e=a._getBoundingBoxToCurrentNode(i)}return e}}(),function(){l.LayerColor.CanvasRenderCmd=function(e){this._layerCmdCtor(e),this._needDraw=!0,this._blendFuncStr="source-over",this._bakeRenderCmd=new l.CustomRenderCmd(this,this._bakeRendering)};var e=l.LayerColor.CanvasRenderCmd.prototype=Object.create(l.Layer.CanvasRenderCmd.prototype);e.constructor=l.LayerColor.CanvasRenderCmd,e.unbake=function(){l.Layer.CanvasRenderCmd.prototype.unbake.call(this),this._needDraw=!0},e.rendering=function(e,t,i){var n=e||l._renderContext,s=n.getContext(),r=this._node,a=this._displayedColor,o=this._displayedOpacity/255,h=r._contentSize.width,d=r._contentSize.height;0!==o&&(n.setCompositeOperation(this._blendFuncStr),n.setGlobalAlpha(o),n.setFillStyle("rgba("+(0|a.r)+","+(0|a.g)+","+(0|a.b)+", 1)"),n.setTransform(this._worldTransform,t,i),s.fillRect(0,0,h,-d),l.g_NumberOfDraws++)},e.updateBlendFunc=function(e){this._blendFuncStr=l.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(e)},e._updateSquareVertices=e._updateSquareVerticesWidth=e._updateSquareVerticesHeight=function(){},e._bakeRendering=function(){if(this._cacheDirty){var e,t=this._node,i=this._bakeSprite,n=t._children,s=n.length;this.transform(this.getParentRenderCmd(),!0);var r=this._getBoundingBoxForBake();r.width=0|r.width+.5,r.height=0|r.height+.5;var a=i.getCacheContext(),o=a.getContext();if(i.setPosition(r.x,r.y),this._updateCache>0){o.fillStyle=a._currentFillStyle,i.resetCanvasSize(r.width,r.height),a.setOffset(0-r.x,o.canvas.height-r.height+r.y);var h;if(l.renderer._turnToCacheMode(this.__instanceId),s>0){for(t.sortAllChildren(),e=0;e<s&&(h=n[e])._localZOrder<0;e++)h.visit(t);for(l.renderer.pushRenderCommand(this);e<s;e++)n[e].visit(t)}else l.renderer.pushRenderCommand(this);l.renderer._renderingToCacheCanvas(a,this.__instanceId),i.transform(),this._updateCache--}this._cacheDirty=!1}},e._getBoundingBoxForBake=function(){var e=this._node,t=l.rect(0,0,e._contentSize.width,e._contentSize.height),i=e.getNodeToWorldTransform();if(t=l.rectApplyAffineTransform(t,e.getNodeToWorldTransform()),!e._children||0===e._children.length)return t;for(var n=e._children,s=0;s<n.length;s++){var r=n[s];if(r&&r._visible){var a=r._getBoundingBoxToCurrentNode(i);t=l.rectUnion(t,a)}}return t}}(),function(){l.LayerGradient.CanvasRenderCmd=function(e){l.LayerColor.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._startPoint=l.p(0,0),this._endPoint=l.p(0,0),this._startStopStr=null,this._endStopStr=null};var e=l.LayerGradient.CanvasRenderCmd.prototype=Object.create(l.LayerColor.CanvasRenderCmd.prototype);e.constructor=l.LayerGradient.CanvasRenderCmd,e.rendering=function(e,t,i){var n=e||l._renderContext,s=n.getContext(),r=this._node,a=this._displayedOpacity/255;if(0!==a){var o=r._contentSize.width,h=r._contentSize.height;n.setCompositeOperation(this._blendFuncStr),n.setGlobalAlpha(a);var d=s.createLinearGradient(this._startPoint.x,this._startPoint.y,this._endPoint.x,this._endPoint.y);if(r._colorStops)for(var c=0;c<r._colorStops.length;c++){var u=r._colorStops[c];d.addColorStop(u.p,this._colorStopsStr[c])}else d.addColorStop(0,this._startStopStr),d.addColorStop(1,this._endStopStr);n.setFillStyle(d),n.setTransform(this._worldTransform,t,i),s.fillRect(0,0,o,-h),l.g_NumberOfDraws++}},e.updateStatus=function(){var e=l.Node._dirtyFlags;this._dirtyFlag&e.gradientDirty&&(this._dirtyFlag|=e.colorDirty,this._dirtyFlag&=~e.gradientDirty),this.originUpdateStatus()},e._syncStatus=function(e){var t=l.Node._dirtyFlags;this._dirtyFlag&t.gradientDirty&&(this._dirtyFlag|=t.colorDirty,this._dirtyFlag&=~t.gradientDirty),this._originSyncStatus(e)},e._updateColor=function(){var e=this._node,t=e._contentSize,i=.5*t.width,n=.5*t.height,s=l.pAngleSigned(l.p(0,-1),e._alongVector),r=l.pRotateByAngle(l.p(0,-1),l.p(0,0),s),a=Math.min(Math.abs(1/r.x),Math.abs(1/r.y));this._startPoint.x=i*(-r.x*a)+i,this._startPoint.y=n*(r.y*a)-n,this._endPoint.x=i*(r.x*a)+i,this._endPoint.y=n*(-r.y*a)-n;var o=this._displayedColor,h=e._endColor,d=e._startOpacity/255,c=e._endOpacity/255;if(this._startStopStr="rgba("+Math.round(o.r)+","+Math.round(o.g)+","+Math.round(o.b)+","+d.toFixed(4)+")",this._endStopStr="rgba("+Math.round(h.r)+","+Math.round(h.g)+","+Math.round(h.b)+","+c.toFixed(4)+")",e._colorStops){this._startOpacity=0,this._endOpacity=0,this._colorStopsStr=[];for(var u=0;u<e._colorStops.length;u++){var p=e._colorStops[u].color,m=null==p.a?1:p.a/255;this._colorStopsStr.push("rgba("+Math.round(p.r)+","+Math.round(p.g)+","+Math.round(p.b)+","+m.toFixed(4)+")")}}}}(),function(){l.Layer.WebGLRenderCmd=function(e){this._rootCtor(e),this._isBaked=!1};var e=l.Layer.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.Layer.WebGLRenderCmd,e._layerCmdCtor=l.Layer.WebGLRenderCmd,e.bake=function(){},e.unbake=function(){},e._bakeForAddChild=function(){}}(),function(){l.LayerColor.WebGLRenderCmd=function(e){this._layerCmdCtor(e),this._needDraw=!0,this._matrix=null,this.initData(4),this._color=new Uint32Array(1),this._vertexBuffer=null,this._shaderProgram=l.shaderCache.programForKey(l.SHADER_POSITION_COLOR)};var e=l.LayerColor.WebGLRenderCmd.prototype=Object.create(l.Layer.WebGLRenderCmd.prototype);e.constructor=l.LayerColor.WebGLRenderCmd,e.initData=function(e){this._data=new ArrayBuffer(16*e),this._positionView=new Float32Array(this._data),this._colorView=new Uint32Array(this._data),this._dataDirty=!0},e.transform=function(e,t){this.originTransform(e,t);var i=this._node,n=i._contentSize.width,s=i._contentSize.height,r=this._positionView;r[4]=n,r[9]=s,r[12]=n,r[13]=s,r[2].z=r[6]=r[10]=r[14]=i._vertexZ,this._dataDirty=!0},e._updateColor=function(){var e=this._displayedColor;this._color[0]=this._displayedOpacity<<24|e.b<<16|e.g<<8|e.r;for(var t=this._colorView,i=0;i<4;i++)t[4*i+3]=this._color[0];this._dataDirty=!0},e.rendering=function(e){var t=e||l._renderContext,i=this._node;this._matrix||(this._matrix=new l.math.Matrix4,this._matrix.identity());var n=this._worldTransform;this._matrix.mat[0]=n.a,this._matrix.mat[4]=n.c,this._matrix.mat[12]=n.tx,this._matrix.mat[1]=n.b,this._matrix.mat[5]=n.d,this._matrix.mat[13]=n.ty,this._dataDirty&&(this._vertexBuffer||(this._vertexBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this._data,t.DYNAMIC_DRAW),this._dataDirty=!1),this._glProgramState.apply(this._matrix),l.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(l.VERTEX_ATTRIB_COLOR),t.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,16,0),t.vertexAttribPointer(l.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,16,12),t.drawArrays(t.TRIANGLE_STRIP,0,4)},e.updateBlendFunc=function(e){}}(),function(){l.LayerGradient.WebGLRenderCmd=function(e){l.LayerColor.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._clipRect=new l.Rect,this._clippingRectDirty=!1};var e=l.LayerGradient.WebGLRenderCmd.prototype=Object.create(l.LayerColor.WebGLRenderCmd.prototype);e.constructor=l.LayerGradient.WebGLRenderCmd,e.updateStatus=function(){var e=l.Node._dirtyFlags;this._dirtyFlag&e.gradientDirty&&(this._dirtyFlag|=e.colorDirty,this._updateVertex(),this._dirtyFlag&=~e.gradientDirty),this.originUpdateStatus()},e._syncStatus=function(e){var t=l.Node._dirtyFlags;this._dirtyFlag&t.gradientDirty&&(this._dirtyFlag|=t.colorDirty,this._updateVertex(),this._dirtyFlag&=~t.gradientDirty),this._originSyncStatus(e)},e.transform=function(e,t){this.originTransform(e,t),this._updateVertex()},e._updateVertex=function(){var e=this._node,t=e._colorStops;if(t&&!(t.length<2)){this._clippingRectDirty=!0;var i,n=t.length,s=2*n,r=e._contentSize;this._positionView.length/4<s&&this.initData(s);var a=Math.PI+l.pAngleSigned(l.p(0,-1),e._alongVector),o=l.p(r.width/2,r.height/2),h=Math.round(l.radiansToDegrees(a)),d=l.affineTransformMake(1,0,0,1,o.x,o.y);d=l.affineTransformRotate(d,a);var c,u;h<90?(c=l.p(-o.x,o.y),u=l.p(o.x,o.y)):h<180?(c=l.p(o.x,o.y),u=l.p(o.x,-o.y)):h<270?(c=l.p(o.x,-o.y),u=l.p(-o.x,-o.y)):(c=l.p(-o.x,-o.y),u=l.p(-o.x,o.y));var p=Math.sin(a),m=Math.cos(a),_=Math.abs((c.x*m-c.y*p)/o.x),g=Math.abs((u.x*p+u.y*m)/o.y);d=l.affineTransformScale(d,_,g);var T=this._positionView;for(i=0;i<n;i++){var f=t[i].p*r.height,S=l.pointApplyAffineTransform(-o.x,f-o.y,d),w=2*i*4;T[w]=S.x,T[w+1]=S.y,T[w+2]=e._vertexZ;var v=l.pointApplyAffineTransform(r.width-o.x,f-o.y,d);T[w+=4]=v.x,T[w+1]=v.y,T[w+2]=e._vertexZ}this._dataDirty=!0}},e._updateColor=function(){var e=this._node._colorStops;if(e&&!(e.length<2)){var t,n,s=e.length,r=this._colorView,a=this._displayedOpacity/255;for(i=0;i<s;i++)t=e[i].color,this._color[0]=t.a*a<<24|t.b<<16|t.g<<8|t.r,r[(n=2*i*4)+3]=this._color[0],r[(n+=4)+3]=this._color[0];this._dataDirty=!0}},e.rendering=function(e){var t=e||l._renderContext,i=this._node;this._matrix||(this._matrix=new l.math.Matrix4,this._matrix.identity());var n=this._getClippingRect();t.enable(t.SCISSOR_TEST),l.view.setScissorInPoints(n.x,n.y,n.width,n.height);var s=this._worldTransform;this._matrix.mat[0]=s.a,this._matrix.mat[4]=s.c,this._matrix.mat[12]=s.tx,this._matrix.mat[1]=s.b,this._matrix.mat[5]=s.d,this._matrix.mat[13]=s.ty,this._dataDirty&&(this._vertexBuffer||(this._vertexBuffer=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,this._vertexBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._data,gl.DYNAMIC_DRAW),this._dataDirty=!1),this._glProgramState.apply(this._matrix),l.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),gl.bindBuffer(gl.ARRAY_BUFFER,this._vertexBuffer),gl.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),gl.enableVertexAttribArray(l.VERTEX_ATTRIB_COLOR),gl.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,3,gl.FLOAT,!1,16,0),gl.vertexAttribPointer(l.VERTEX_ATTRIB_COLOR,4,gl.UNSIGNED_BYTE,!0,16,12),gl.drawArrays(gl.TRIANGLE_STRIP,0,4),t.disable(t.SCISSOR_TEST)},e._getClippingRect=function(){if(this._clippingRectDirty){var e=this._node,t=l.rect(0,0,e._contentSize.width,e._contentSize.height),i=e.getNodeToWorldTransform();this._clipRect=l._rectApplyAffineTransformIn(t,i)}return this._clipRect}}(),l._tmp.PrototypeSprite=function(){var e=l.Sprite.prototype;l.defineGetterSetter(e,"opacityModifyRGB",e.isOpacityModifyRGB,e.setOpacityModifyRGB),l.defineGetterSetter(e,"opacity",e.getOpacity,e.setOpacity),l.defineGetterSetter(e,"color",e.getColor,e.setColor),e.dirty,e.flippedX,l.defineGetterSetter(e,"flippedX",e.isFlippedX,e.setFlippedX),e.flippedY,l.defineGetterSetter(e,"flippedY",e.isFlippedY,e.setFlippedY),e.offsetX,l.defineGetterSetter(e,"offsetX",e._getOffsetX),e.offsetY,l.defineGetterSetter(e,"offsetY",e._getOffsetY),e.atlasIndex,e.texture,l.defineGetterSetter(e,"texture",e.getTexture,e.setTexture),e.textureRectRotated,l.defineGetterSetter(e,"textureRectRotated",e.isTextureRectRotated),e.textureAtlas,e.batchNode,l.defineGetterSetter(e,"batchNode",e.getBatchNode,e.setBatchNode),e.quad,l.defineGetterSetter(e,"quad",e.getQuad)},l.Sprite=l.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_batchNode:null,_recursiveDirty:null,_hasChildren:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_className:"Sprite",ctor:function(e,t,i){var n=this;l.Node.prototype.ctor.call(n),this.setAnchorPoint(.5,.5),n._loader=new l.Sprite.LoadManager,n._shouldBeHidden=!1,n._offsetPosition=l.p(0,0),n._unflippedOffsetPositionFromCenter=l.p(0,0),n._blendFunc={src:l.BLEND_SRC,dst:l.BLEND_DST},n._rect=l.rect(0,0,0,0),n._softInit(e,t,i)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},isDirty:function(){return this.dirty},setDirty:function(e){this.dirty=e},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(e){this.atlasIndex=e},getTextureRect:function(){return l.rect(this._rect)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(e){this.textureAtlas=e},getOffsetPosition:function(){return l.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(e){return l.assert(e,l._LogInfos.Sprite_initWithSpriteFrame),this.setSpriteFrame(e)},initWithSpriteFrameName:function(e){l.assert(e,l._LogInfos.Sprite_initWithSpriteFrameName);var t=l.spriteFrameCache.getSpriteFrame(e);return l.assert(t,e+l._LogInfos.Sprite_initWithSpriteFrameName1),this.initWithSpriteFrame(t)},useBatchNode:function(e){},setVertexRect:function(e){var t=this._rect;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},setFlippedX:function(e){this._flippedX!==e&&(this._flippedX=e,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(e){this._flippedY!==e&&(this._flippedY=e,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:function(e){this._opacityModifyRGB!==e&&(this._opacityModifyRGB=e,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setDisplayFrameWithAnimationName:function(e,t){l.assert(e,l._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);var i=l.animationCache.getAnimation(e);if(i){var n=i.getFrames()[t];n?this.setSpriteFrame(n.getSpriteFrame()):l.log(l._LogInfos.Sprite_setDisplayFrameWithAnimationName_2)}else l.log(l._LogInfos.Sprite_setDisplayFrameWithAnimationName)},getBatchNode:function(){return this._batchNode},getTexture:function(){return this._texture},_softInit:function(e,t,i){if(void 0===e)l.Sprite.prototype.init.call(this);else if("string"==typeof e){var n=-1!==e.indexOf("/"),s="#"===e[0];if(!n||s){var r=s?e.substr(1,e.length-1):e,a=l.spriteFrameCache.getSpriteFrame(r);a?this.initWithSpriteFrame(a):l.log("%s does not exist",e)}else l.Sprite.prototype.init.call(this,e,t)}else if("object"==typeof e)if(e instanceof l.Texture2D)this.initWithTexture(e,t,i);else if(e instanceof l.SpriteFrame)this.initWithSpriteFrame(e);else if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof(new Image).constructor||e instanceof document.createElement("canvas").constructor){var o=new l.Texture2D;o.initWithElement(e),o.handleLoadedTexture(),this.initWithTexture(o)}},getQuad:function(){return null},setBlendFunc:function(e,t){var i=this._blendFunc;void 0===t?(i.src=e.src,i.dst=e.dst):(i.src=e,i.dst=t),this._renderCmd.updateBlendFunc(i)},init:function(){var e=this;return arguments.length>0?e.initWithFile(arguments[0],arguments[1]):(l.Node.prototype.init.call(e),e.dirty=e._recursiveDirty=!1,e._blendFunc.src=l.BLEND_SRC,e._blendFunc.dst=l.BLEND_DST,e.texture=null,e._flippedX=e._flippedY=!1,e.anchorX=.5,e.anchorY=.5,e._offsetPosition.x=0,e._offsetPosition.y=0,e._hasChildren=!1,e.setTextureRect(l.rect(0,0,0,0),!1,l.size(0,0)),!0)},initWithFile:function(e,t){l.assert(e,l._LogInfos.Sprite_initWithFile);var i=l.textureCache.getTextureForKey(e);if(i||(i=l.textureCache.addImage(e)),!i.isLoaded())return this._loader.clear(),this._loader.once(i,function(){this.initWithFile(e,t),this.dispatchEvent("load")},this),!1;if(!t){var n=i.getContentSize();t=l.rect(0,0,n.width,n.height)}return this.initWithTexture(i,t)},initWithTexture:function(e,t,i,n){var s=this;return l.assert(0!==arguments.length,l._LogInfos.CCSpriteBatchNode_initWithTexture),this._loader.clear(),s._textureLoaded=e.isLoaded(),s._textureLoaded?(i=i||!1,e=this._renderCmd._handleTextureForRotatedTexture(e,t,i,n),!!l.Node.prototype.init.call(s)&&(s._batchNode=null,s._recursiveDirty=!1,s.dirty=!1,s._opacityModifyRGB=!0,s._blendFunc.src=l.BLEND_SRC,s._blendFunc.dst=l.BLEND_DST,s._flippedX=s._flippedY=!1,s._offsetPosition.x=0,s._offsetPosition.y=0,s._hasChildren=!1,s._rectRotated=i,t&&(s._rect.x=t.x,s._rect.y=t.y,s._rect.width=t.width,s._rect.height=t.height),t||(t=l.rect(0,0,e.width,e.height)),this._renderCmd._checkTextureBoundary(e,t,i),s.setTexture(e),s.setTextureRect(t,i),s.setBatchNode(null),!0)):(this._loader.once(e,function(){this.initWithTexture(e,t,i,n),this.dispatchEvent("load")},this),!1)},setTextureRect:function(e,t,i,n){var s=this;s._rectRotated=t||!1,s.setContentSize(i||e),s.setVertexRect(e),s._renderCmd._setTextureCoords(e,n);var r=s._unflippedOffsetPositionFromCenter.x,a=s._unflippedOffsetPositionFromCenter.y;s._flippedX&&(r=-r),s._flippedY&&(a=-a);var o=s._rect;s._offsetPosition.x=r+(s._contentSize.width-o.width)/2,s._offsetPosition.y=a+(s._contentSize.height-o.height)/2},addChild:function(e,t,i){l.assert(e,l._LogInfos.CCSpriteBatchNode_addChild_2),null==t&&(t=e._localZOrder),null==i&&(i=e.tag),this._renderCmd._setBatchNodeForAddChild(e)&&(l.Node.prototype.addChild.call(this,e,t,i),this._hasChildren=!0)},setSpriteFrame:function(e){var t=this;"string"==typeof e&&(e=l.spriteFrameCache.getSpriteFrame(e),l.assert(e,l._LogInfos.Sprite_setSpriteFrame)),this._loader.clear(),this.setNodeDirty(!0);var i=e.getTexture();if(t._textureLoaded=e.textureLoaded(),this._loader.clear(),!t._textureLoaded)return this._loader.once(i,function(){this.setSpriteFrame(e),this.dispatchEvent("load")},this),!1;var n=e.getOffset();t._unflippedOffsetPositionFromCenter.x=n.x,t._unflippedOffsetPositionFromCenter.y=n.y,i!==t._texture&&(this._renderCmd._setTexture(i),t.setColor(t._realColor)),t.setTextureRect(e.getRect(),e.isRotated(),e.getOriginalSize())},setDisplayFrame:function(e){l.log(l._LogInfos.Sprite_setDisplayFrame),this.setSpriteFrame(e)},isFrameDisplayed:function(e){return this._renderCmd.isFrameDisplayed(e)},displayFrame:function(){return this.getSpriteFrame()},getSpriteFrame:function(){return new l.SpriteFrame(this._texture,l.rectPointsToPixels(this._rect),this._rectRotated,l.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),l.sizePointsToPixels(this._contentSize))},setBatchNode:function(e){},setTexture:function(e){if(!e)return this._renderCmd._setTexture(null);var t="string"==typeof e;if(t&&(e=l.textureCache.addImage(e)),this._loader.clear(),!e._textureLoaded)return this._loader.once(e,function(){this.setTexture(e),this.dispatchEvent("load")},this),!1;this._renderCmd._setTexture(e),t&&this._changeRectWithTexture(e),this.setColor(this._realColor),this._textureLoaded=!0},_changeRectWithTexture:function(e){var t=e._contentSize,i=l.rect(0,0,t.width,t.height);this.setTextureRect(i)},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.Sprite.CanvasRenderCmd(this):new l.Sprite.WebGLRenderCmd(this)}}),l.Sprite.create=function(e,t,i){return new l.Sprite(e,t,i)},l.Sprite.createWithTexture=l.Sprite.create,l.Sprite.createWithSpriteFrameName=l.Sprite.create,l.Sprite.createWithSpriteFrame=l.Sprite.create,l.Sprite.INDEX_NOT_INITIALIZED=-1,l.EventHelper.prototype.apply(l.Sprite.prototype),l.assert(l.isFunction(l._tmp.PrototypeSprite),l._LogInfos.MissingFile,"SpritesPropertyDefine.js"),l._tmp.PrototypeSprite(),delete l._tmp.PrototypeSprite,function(){var e=l.Sprite.LoadManager=function(){this.list=[]};e.prototype.add=function(e,t,i){e&&e.addEventListener&&(e.addEventListener("load",t,i),this.list.push({source:e,listener:t,target:i}))},e.prototype.once=function(e,t,i){if(e&&e.addEventListener){var n=function(s){e.removeEventListener("load",n,i),t.call(i,s)};e.addEventListener("load",n,i),this.list.push({source:e,listener:n,target:i})}},e.prototype.clear=function(){for(;this.list.length>0;){var e=this.list.pop();e.source.removeEventListener("load",e.listener,e.target)}}}(),function(){l.Sprite.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:!1},this._blendFuncStr="source-over",this._colorized=!1,this._canUseDirtyRegion=!0,this._textureToRender=null};var e=l.Sprite.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.Sprite.CanvasRenderCmd,e._spriteCmdCtor=l.Sprite.CanvasRenderCmd,e.setDirtyRecursively=function(e){},e._setTexture=function(e){var t=this._node;if(t._texture!==e){t._textureLoaded=!!e&&e._textureLoaded,t._texture=e;var i=e._contentSize,n=l.rect(0,0,i.width,i.height);t.setTextureRect(n),this._updateColor()}},e._setColorDirty=function(){this.setDirtyFlag(l.Node._dirtyFlags.colorDirty|l.Node._dirtyFlags.opacityDirty)},e.isFrameDisplayed=function(e){var t=this._node;return e.getTexture()===t._texture&&l.rectEqualToRect(e.getRect(),t._rect)},e.updateBlendFunc=function(e){this._blendFuncStr=l.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(e)},e._setBatchNodeForAddChild=function(e){return!0},e._handleTextureForRotatedTexture=function(e,t,i,n){if(i&&e.isLoaded()){var s=e.getHtmlElementObj();s=l.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(s,t,n);var r=new l.Texture2D;r.initWithElement(s),r.handleLoadedTexture(),e=r,t.x=t.y=0,this._node._rect=l.rect(0,0,t.width,t.height)}return e},e._checkTextureBoundary=function(e,t,i){if(e&&e.url){var n=t.x+t.width,s=t.y+t.height;n>e.width&&l.error(l._LogInfos.RectWidth,e.url),s>e.height&&l.error(l._LogInfos.RectHeight,e.url)}},e.rendering=function(e,t,i){var n=this._node,s=this._textureCoord,r=this._displayedOpacity/255,a=this._textureToRender||n._texture;if((!a||0!==s.width&&0!==s.height&&a._textureLoaded)&&0!==r){var o,h=e||l._renderContext,d=h.getContext(),c=n._offsetPosition.x,u=n._rect.height,p=n._rect.width,m=-n._offsetPosition.y-u;h.setTransform(this._worldTransform,t,i),h.setCompositeOperation(this._blendFuncStr),h.setGlobalAlpha(r),(n._flippedX||n._flippedY)&&h.save(),n._flippedX&&(c=-c-p,d.scale(-1,1)),n._flippedY&&(m=n._offsetPosition.y,d.scale(1,-1));var _,g,T,f,S,w,v,L;if(this._colorized?(_=0,g=0):(_=s.renderX,g=s.renderY),T=s.width,f=s.height,S=c,w=m,v=p,L=u,a&&a._htmlElementObj)o=a._htmlElementObj,""!==a._pattern?(h.setFillStyle(d.createPattern(o,a._pattern)),d.fillRect(S,w,v,L)):d.drawImage(o,_,g,T,f,S,w,v,L);else{var M=n._contentSize;if(s.validRect){var C=this._displayedColor;h.setFillStyle("rgba("+C.r+","+C.g+","+C.b+",1)"),d.fillRect(S,w,M.width*t,M.height*i)}}(n._flippedX||n._flippedY)&&h.restore(),l.g_NumberOfDraws++}},e._updateColor=function(){var e=this._node._texture,t=this._textureCoord,i=this._displayedColor;e&&(255!==i.r||255!==i.g||255!==i.b?(this._textureToRender=e._generateColorTexture(i.r,i.g,i.b,t),this._colorized=!0):e&&(this._textureToRender=e,this._colorized=!1))},e._textureLoadedCallback=function(e){var t=this;if(!t._textureLoaded){t._textureLoaded=!0;var i=t._rect,n=this._renderCmd;i?l._rectEqualToZero(i)&&(i.width=e.width,i.height=e.height):i=l.rect(0,0,e.width,e.height),t.texture=e,t.setTextureRect(i,t._rectRotated);var s=n._displayedColor;255===s.r&&255===s.g&&255===s.b||n._updateColor(),t.setBatchNode(t._batchNode),t.dispatchEvent("load")}},e._setTextureCoords=function(e,t){void 0===t&&(t=!0);var i=this._textureCoord,n=t?l.contentScaleFactor():1;i.renderX=i.x=0|e.x*n,i.renderY=i.y=0|e.y*n,i.width=0|e.width*n,i.height=0|e.height*n,i.validRect=!(0===i.width||0===i.height||i.x<0||i.y<0)},l.Sprite.CanvasRenderCmd._cutRotateImageToCanvas=function(e,t,i){if(!e)return null;if(!t)return e;i=null==i||i;var n=document.createElement("canvas");n.width=t.width,n.height=t.height;var s=n.getContext("2d");return s.translate(n.width/2,n.height/2),i?s.rotate(-1.5707963267948966):s.rotate(1.5707963267948966),s.drawImage(e,t.x,t.y,t.height,t.width,-t.height/2,-t.width/2,t.height,t.width),n}}(),function(){l.Sprite.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._vertices=[{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0}],this._color=new Uint32Array(1),this._dirty=!1,this._recursiveDirty=!1,this._shaderProgram=l.shaderCache.programForKey(l.SHADER_SPRITE_POSITION_TEXTURECOLOR)};var e=l.Sprite.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.Sprite.WebGLRenderCmd,e._spriteCmdCtor=l.Sprite.WebGLRenderCmd,e.updateBlendFunc=function(e){},e.setDirtyFlag=function(e){l.Node.WebGLRenderCmd.prototype.setDirtyFlag.call(this,e),this._dirty=!0},e.setDirtyRecursively=function(e){this._recursiveDirty=e,this._dirty=e;for(var t,i=this._node._children,n=i?i.length:0,s=0;s<n;s++)(t=i[s])instanceof l.Sprite&&t._renderCmd.setDirtyRecursively(e)},e._setBatchNodeForAddChild=function(e){var t=this._node;if(t._batchNode){if(!(e instanceof l.Sprite))return l.log(l._LogInfos.Sprite_addChild),!1;e.texture._webTextureObj!==t.textureAtlas.texture._webTextureObj&&l.log(l._LogInfos.Sprite_addChild_2),t._batchNode.appendChild(e),t._reorderChildDirty||t._setReorderChildDirtyRecursively()}return!0},e._handleTextureForRotatedTexture=function(e){return e},e.isFrameDisplayed=function(e){var t=this._node;return l.rectEqualToRect(e.getRect(),t._rect)&&e.getTexture().getName()===t._texture.getName()&&l.pointEqualToPoint(e.getOffset(),t._unflippedOffsetPositionFromCenter)},e._textureLoadedCallback=function(e){if(!this._textureLoaded){this._textureLoaded=!0;var t=this._rect;t?l._rectEqualToZero(t)&&(t.width=e.width,t.height=e.height):t=l.rect(0,0,e.width,e.height),this.texture=e,this.setTextureRect(t,this._rectRotated),this.setBatchNode(this._batchNode),this.dispatchEvent("load"),l.renderer.childrenOrderDirty=!0}},e._setTextureCoords=function(e,t){void 0===t&&(t=!0),t&&(e=l.rectPointsToPixels(e));var i=this._node,n=i._batchNode?i.textureAtlas.texture:i._texture,s=this._vertices;if(n){var r,a,o,h,d,c=n.pixelsWidth,u=n.pixelsHeight;i._rectRotated?(l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(a=(r=(2*e.x+1)/(2*c))+(2*e.height-2)/(2*c),h=(o=(2*e.y+1)/(2*u))+(2*e.width-2)/(2*u)):(r=e.x/c,a=(e.x+e.height)/c,o=e.y/u,h=(e.y+e.width)/u),i._flippedX&&(d=o,o=h,h=d),i._flippedY&&(d=r,r=a,a=d),s[0].u=a,s[0].v=o,s[1].u=r,s[1].v=o,s[2].u=a,s[2].v=h,s[3].u=r,s[3].v=h):(l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(a=(r=(2*e.x+1)/(2*c))+(2*e.width-2)/(2*c),h=(o=(2*e.y+1)/(2*u))+(2*e.height-2)/(2*u)):(r=e.x/c,a=(e.x+e.width)/c,o=e.y/u,h=(e.y+e.height)/u),i._flippedX&&(d=r,r=a,a=d),i._flippedY&&(d=o,o=h,h=d),s[0].u=r,s[0].v=o,s[1].u=r,s[1].v=h,s[2].u=a,s[2].v=o,s[3].u=a,s[3].v=h)}},e._setColorDirty=function(){},e._updateBlendFunc=function(){if(this._batchNode)l.log(l._LogInfos.Sprite__updateBlendFunc);else{var e=this._node,t=e._blendFunc;e._texture&&e._texture.hasPremultipliedAlpha()?(t.src===l.SRC_ALPHA&&t.dst===l.BLEND_DST&&(t.src=l.ONE),e.opacityModifyRGB=!0):(t.src===l.ONE&&t.dst===l.BLEND_DST&&(t.src=l.SRC_ALPHA),e.opacityModifyRGB=!1)}},e._setTexture=function(e){var t=this._node;if(t._texture!==e){if(t._textureLoaded=!!e&&e._textureLoaded,t._texture=e,e){var i=e._contentSize,n=l.rect(0,0,i.width,i.height);t.setTextureRect(n),this._updateBlendFunc()}t._textureLoaded&&(l.renderer.childrenOrderDirty=!0)}},e._checkTextureBoundary=function(e,t,i){if(e&&e.url){var n,s;i?(n=t.x+t.height,s=t.y+t.width):(n=t.x+t.width,s=t.y+t.height),n>e.width&&l.error(l._LogInfos.RectWidth,e.url),s>e.height&&l.error(l._LogInfos.RectHeight,e.url)}},e.transform=function(e,t){this.originTransform(e,t);var i=this._node,n=i._offsetPosition.x,s=n+i._rect.width,r=i._offsetPosition.y,a=r+i._rect.height,o=this._worldTransform,h=o.tx,l=o.ty,d=n*o.a,c=n*o.b,u=s*o.a,p=s*o.b,m=a*o.c,_=a*o.d,g=r*o.c,T=r*o.d,f=this._vertices;f[0].x=d+m+h,f[0].y=c+_+l,f[1].x=d+g+h,f[1].y=c+T+l,f[2].x=u+m+h,f[2].y=p+_+l,f[3].x=u+g+h,f[3].y=p+T+l},e.needDraw=function(){var e=this._node._texture;return this._needDraw&&e},e.uploadData=function(e,t,i){var n=this._node,s=n._texture;if(!(s&&s._textureLoaded&&n._rect.width&&n._rect.height&&this._displayedOpacity))return!1;var r=this._displayedOpacity,a=this._displayedColor.r,o=this._displayedColor.g,h=this._displayedColor.b;if(n._opacityModifyRGB){var l=r/255;a*=l,o*=l,h*=l}this._color[0]=r<<24|h<<16|o<<8|a;var d,c,u=n._vertexZ,p=this._vertices,m=p.length,_=i;for(d=0;d<m;++d)c=p[d],e[_]=c.x,e[_+1]=c.y,e[_+2]=u,t[_+3]=this._color[0],e[_+4]=c.u,e[_+5]=c.v,_+=6;return m}}(),l.SpriteBatchNode=l.Node.extend({_blendFunc:null,_texture:null,_className:"SpriteBatchNode",ctor:function(e){l.Node.prototype.ctor.call(this),this._blendFunc=new l.BlendFunc(l.BLEND_SRC,l.BLEND_DST);var t;l.isString(e)?(t=l.textureCache.getTextureForKey(e))||(t=l.textureCache.addImage(e)):e instanceof l.Texture2D&&(t=e),t&&this.initWithTexture(t)},addSpriteWithoutQuad:function(e,t,i){return this.addChild(e,t,i),this},getTextureAtlas:function(){return null},setTextureAtlas:function(e){},getDescendants:function(){return this._children},initWithFile:function(e,t){var i=l.textureCache.getTextureForKey(e);return i||(i=l.textureCache.addImage(e)),this.initWithTexture(i,t)},init:function(e,t){var i=l.textureCache.getTextureForKey(e);return i||(i=l.textureCache.addImage(e)),this.initWithTexture(i,t)},increaseAtlasCapacity:function(){},removeChildAtIndex:function(e,t){this.removeChild(this._children[e],t)},rebuildIndexInOrder:function(e,t){return t},highestAtlasIndexInChild:function(e){var t=e.children;return t&&0!==t.length?this.highestAtlasIndexInChild(t[t.length-1]):e.zIndex},lowestAtlasIndexInChild:function(e){var t=e.children;return t&&0!==t.length?this.lowestAtlasIndexInChild(t[t.length-1]):e.zIndex},atlasIndexForChild:function(e){return e.zIndex},reorderBatch:function(e){this._reorderChildDirty=e},setBlendFunc:function(e,t){this._blendFunc=void 0===t?e:{src:e,dst:t}},getBlendFunc:function(){return new l.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},updateQuadFromSprite:function(e,t){l.assert(e,l._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2),e instanceof l.Sprite?(e.dirty=!0,e._renderCmd.transform(this._renderCmd,!0)):l.log(l._LogInfos.CCSpriteBatchNode_updateQuadFromSprite)},insertQuadFromSprite:function(e,t){this.addChild(e,t)},insertChild:function(e,t){this.addChild(e,t)},appendChild:function(e){this.sortAllChildren();this._children[this._children.length-1]._localZOrder;this.addChild(e.lastLocalZOrder+1)},removeSpriteFromAtlas:function(e,t){this.removeChild(e,t)},initWithTexture:function(e){return this.setTexture(e),!0},getTexture:function(){return this._texture},setTexture:function(e){if(this._texture=e,e._textureLoaded){var t,i=this._children,n=i.length;for(t=0;t<n;++t)i[t].setTexture(e)}else e.addEventListener("load",function(){var t,i=this._children,n=i.length;for(t=0;t<n;++t)i[t].setTexture(e)},this)},setShaderProgram:function(e){this._renderCmd.setShaderProgram(e);var t,i=this._children,n=i.length;for(t=0;t<n;++t)i[t].setShaderProgram(e)},addChild:function(e,t,i){l.assert(void 0!==e,l._LogInfos.CCSpriteBatchNode_addChild_3),this._isValidChild(e)&&(t=void 0===t?e.zIndex:t,i=void 0===i?e.tag:i,l.Node.prototype.addChild.call(this,e,t,i),this._renderCmd._shaderProgram&&(e.shaderProgram=this._renderCmd._shaderProgram))},_isValidChild:function(e){return e instanceof l.Sprite?e.texture===this._texture||(l.log(l._LogInfos.Sprite_addChild_5),!1):(l.log(l._LogInfos.Sprite_addChild_4),!1)}});var d=l.SpriteBatchNode.prototype;l.defineGetterSetter(d,"texture",d.getTexture,d.setTexture),l.defineGetterSetter(d,"shaderProgram",d.getShaderProgram,d.setShaderProgram),l.SpriteBatchNode.create=function(e){return new l.SpriteBatchNode(e)},l.SpriteBatchNode.createWithTexture=l.SpriteBatchNode.create,l.BakeSprite=l.Sprite.extend({_cacheCanvas:null,_cacheContext:null,ctor:function(){l.Sprite.prototype.ctor.call(this);var e=document.createElement("canvas");e.width=e.height=10,this._cacheCanvas=e,this._cacheContext=new l.CanvasContextWrapper(e.getContext("2d"));var t=new l.Texture2D;t.initWithElement(e),t.handleLoadedTexture(),this.setTexture(t)},getCacheContext:function(){return this._cacheContext},getCacheCanvas:function(){return this._cacheCanvas},resetCanvasSize:function(e,t){var i=this._cacheCanvas,n=this._cacheContext,s=n._context.strokeStyle,r=n._context.fillStyle;void 0===t&&(t=e.height,e=e.width),i.width=e,i.height=t,s!==n._context.strokeStyle&&(n._context.strokeStyle=s),r!==n._context.fillStyle&&(n._context.fillStyle=r),this.getTexture().handleLoadedTexture(),this.setTextureRect(l.rect(0,0,e,t),!1,null,!1)}}),l.AnimationFrame=l.Class.extend({_spriteFrame:null,_delayPerUnit:0,_userInfo:null,ctor:function(e,t,i){this._spriteFrame=e||null,this._delayPerUnit=t||0,this._userInfo=i||null},clone:function(){var e=new l.AnimationFrame;return e.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),e},copyWithZone:function(e){return l.clone(this)},copy:function(e){var t=new l.AnimationFrame;return t.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),t},initWithSpriteFrame:function(e,t,i){return this._spriteFrame=e,this._delayPerUnit=t,this._userInfo=i,!0},getSpriteFrame:function(){return this._spriteFrame},setSpriteFrame:function(e){this._spriteFrame=e},getDelayUnits:function(){return this._delayPerUnit},setDelayUnits:function(e){this._delayPerUnit=e},getUserInfo:function(){return this._userInfo},setUserInfo:function(e){this._userInfo=e}}),l.AnimationFrame.create=function(e,t,i){return new l.AnimationFrame(e,t,i)},l.Animation=l.Class.extend({_frames:null,_loops:0,_restoreOriginalFrame:!1,_duration:0,_delayPerUnit:0,_totalDelayUnits:0,ctor:function(e,t,i){if(this._frames=[],void 0===e)this.initWithSpriteFrames(null,0);else{var n=e[0];n&&(n instanceof l.SpriteFrame?this.initWithSpriteFrames(e,t,i):n instanceof l.AnimationFrame&&this.initWithAnimationFrames(e,t,i))}},getFrames:function(){return this._frames},setFrames:function(e){this._frames=e},addSpriteFrame:function(e){var t=new l.AnimationFrame;t.initWithSpriteFrame(e,1,null),this._frames.push(t),this._totalDelayUnits++},addSpriteFrameWithFile:function(e){var t=l.textureCache.addImage(e),i=l.rect(0,0,0,0);i.width=t.width,i.height=t.height;var n=new l.SpriteFrame(t,i);this.addSpriteFrame(n)},addSpriteFrameWithTexture:function(e,t){var i=new l.SpriteFrame(e,t);this.addSpriteFrame(i)},initWithAnimationFrames:function(e,t,i){l.arrayVerifyType(e,l.AnimationFrame),this._delayPerUnit=t,this._loops=void 0===i?1:i,this._totalDelayUnits=0;var n=this._frames;n.length=0;for(var s=0;s<e.length;s++){var r=e[s];n.push(r),this._totalDelayUnits+=r.getDelayUnits()}return!0},clone:function(){var e=new l.Animation;return e.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),e.setRestoreOriginalFrame(this._restoreOriginalFrame),e},copyWithZone:function(e){var t=new l.Animation;return t.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),t.setRestoreOriginalFrame(this._restoreOriginalFrame),t},_copyFrames:function(){for(var e=[],t=0;t<this._frames.length;t++)e.push(this._frames[t].clone());return e},copy:function(e){return this.copyWithZone(null)},getLoops:function(){return this._loops},setLoops:function(e){this._loops=e},setRestoreOriginalFrame:function(e){this._restoreOriginalFrame=e},getRestoreOriginalFrame:function(){return this._restoreOriginalFrame},getDuration:function(){return this._totalDelayUnits*this._delayPerUnit},getDelayPerUnit:function(){return this._delayPerUnit},setDelayPerUnit:function(e){this._delayPerUnit=e},getTotalDelayUnits:function(){return this._totalDelayUnits},initWithSpriteFrames:function(e,t,i){l.arrayVerifyType(e,l.SpriteFrame),this._loops=void 0===i?1:i,this._delayPerUnit=t||0,this._totalDelayUnits=0;var n=this._frames;if(n.length=0,e){for(var s=0;s<e.length;s++){var r=e[s],a=new l.AnimationFrame;a.initWithSpriteFrame(r,1,null),n.push(a)}this._totalDelayUnits+=e.length}return!0},retain:function(){},release:function(){}}),l.Animation.create=function(e,t,i){return new l.Animation(e,t,i)},l.Animation.createWithAnimationFrames=l.Animation.create,l.animationCache={_animations:{},addAnimation:function(e,t){this._animations[t]=e},removeAnimation:function(e){e&&this._animations[e]&&delete this._animations[e]},getAnimation:function(e){return this._animations[e]?this._animations[e]:null},_addAnimationsWithDictionary:function(e,t){var i=e.animations;if(i){var n=1,s=e.properties;if(s){n=null!=s.format?parseInt(s.format):n;for(var r=s.spritesheets,a=l.spriteFrameCache,o=l.path,h=0;h<r.length;h++)a.addSpriteFrames(o.changeBasename(t,r[h]))}switch(n){case 1:this._parseVersion1(i);break;case 2:this._parseVersion2(i);break;default:l.log(l._LogInfos.animationCache__addAnimationsWithDictionary_2)}}else l.log(l._LogInfos.animationCache__addAnimationsWithDictionary)},addAnimations:function(e){l.assert(e,l._LogInfos.animationCache_addAnimations_2);var t=l.loader.getRes(e);t?this._addAnimationsWithDictionary(t,e):l.log(l._LogInfos.animationCache_addAnimations)},_parseVersion1:function(e){var t=l.spriteFrameCache;for(var i in e){var n=e[i],s=n.frames,r=parseFloat(n.delay)||0,a=null;if(s){for(var o=[],h=0;h<s.length;h++){var d=t.getSpriteFrame(s[h]);if(d){var c=new l.AnimationFrame;c.initWithSpriteFrame(d,1,null),o.push(c)}else l.log(l._LogInfos.animationCache__parseVersion1_2,i,s[h])}0!==o.length?(o.length!==s.length&&l.log(l._LogInfos.animationCache__parseVersion1_4,i),a=new l.Animation(o,r,1),l.animationCache.addAnimation(a,i)):l.log(l._LogInfos.animationCache__parseVersion1_3,i)}else l.log(l._LogInfos.animationCache__parseVersion1,i)}},_parseVersion2:function(e){var t=l.spriteFrameCache;for(var i in e){var n=e[i],s=n.loop,r=parseInt(n.loops),a=s?l.REPEAT_FOREVER:isNaN(r)?1:r,o=!(!n.restoreOriginalFrame||1!=n.restoreOriginalFrame),h=n.frames;if(h){for(var d=[],c=0;c<h.length;c++){var u=h[c],p=u.spriteframe,m=t.getSpriteFrame(p);if(m){var _=parseFloat(u.delayUnits)||0,g=u.notification,T=new l.AnimationFrame;T.initWithSpriteFrame(m,_,g),d.push(T)}else l.log(l._LogInfos.animationCache__parseVersion2_2,i,p)}var f=parseFloat(n.delayPerUnit)||0,S=new l.Animation;S.initWithAnimationFrames(d,f,a),S.setRestoreOriginalFrame(o),l.animationCache.addAnimation(S,i)}else l.log(l._LogInfos.animationCache__parseVersion2,i)}},_clear:function(){this._animations={}}},l.SpriteFrame=l.Class.extend({_offset:null,_originalSize:null,_rectInPixels:null,_rotated:!1,_rect:null,_offsetInPixels:null,_originalSizeInPixels:null,_texture:null,_textureFilename:"",_textureLoaded:!1,ctor:function(e,t,i,n,s){this._offset=l.p(0,0),this._offsetInPixels=l.p(0,0),this._originalSize=l.size(0,0),this._rotated=!1,this._originalSizeInPixels=l.size(0,0),this._textureFilename="",this._texture=null,this._textureLoaded=!1,void 0!==e&&void 0!==t&&(void 0===i||void 0===n||void 0===s?this.initWithTexture(e,t):this.initWithTexture(e,t,i,n,s))},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},getRectInPixels:function(){var e=this._rectInPixels;return l.rect(e.x,e.y,e.width,e.height)},setRectInPixels:function(e){this._rectInPixels||(this._rectInPixels=l.rect(0,0,0,0)),this._rectInPixels.x=e.x,this._rectInPixels.y=e.y,this._rectInPixels.width=e.width,this._rectInPixels.height=e.height,this._rect=l.rectPixelsToPoints(e)},isRotated:function(){return this._rotated},setRotated:function(e){this._rotated=e},getRect:function(){var e=this._rect;return l.rect(e.x,e.y,e.width,e.height)},setRect:function(e){this._rect||(this._rect=l.rect(0,0,0,0)),this._rect.x=e.x,this._rect.y=e.y,this._rect.width=e.width,this._rect.height=e.height,this._rectInPixels=l.rectPointsToPixels(this._rect)},getOffsetInPixels:function(){return l.p(this._offsetInPixels)},setOffsetInPixels:function(e){this._offsetInPixels.x=e.x,this._offsetInPixels.y=e.y,l._pointPixelsToPointsOut(this._offsetInPixels,this._offset)},getOriginalSizeInPixels:function(){return l.size(this._originalSizeInPixels)},setOriginalSizeInPixels:function(e){this._originalSizeInPixels.width=e.width,this._originalSizeInPixels.height=e.height},getOriginalSize:function(){return l.size(this._originalSize)},setOriginalSize:function(e){this._originalSize.width=e.width,this._originalSize.height=e.height},getTexture:function(){if(this._texture)return this._texture;if(""!==this._textureFilename){var e=l.textureCache.addImage(this._textureFilename);return e&&(this._textureLoaded=e.isLoaded()),e}return null},setTexture:function(e){if(this._texture!==e){var t=e.isLoaded();this._textureLoaded=t,this._texture=e,t||e.addEventListener("load",function(e){if(this._textureLoaded=!0,this._rotated&&l._renderType===l.game.RENDER_TYPE_CANVAS){var t=e.getHtmlElementObj();t=l.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(t,this.getRect());var i=new l.Texture2D;i.initWithElement(t),i.handleLoadedTexture(),this.setTexture(i);var n=this.getRect();this.setRect(l.rect(0,0,n.width,n.height))}var s=this._rect;if(0===s.width&&0===s.height){var r=e.width,a=e.height;this._rect.width=r,this._rect.height=a,this._rectInPixels=l.rectPointsToPixels(this._rect),this._originalSizeInPixels.width=this._rectInPixels.width,this._originalSizeInPixels.height=this._rectInPixels.height,this._originalSize.width=r,this._originalSize.height=a}this.dispatchEvent("load")},this)}},getOffset:function(){return l.p(this._offset)},setOffset:function(e){this._offset.x=e.x,this._offset.y=e.y},clone:function(){var e=new l.SpriteFrame;return e.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),e.setTexture(this._texture),e},copyWithZone:function(){var e=new l.SpriteFrame;return e.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),e.setTexture(this._texture),e},copy:function(){return this.copyWithZone()},initWithTexture:function(e,t,i,n,s){if(2===arguments.length&&(t=l.rectPointsToPixels(t)),n=n||l.p(0,0),s=s||t,i=i||!1,"string"==typeof e?(this._texture=null,this._textureFilename=e):e instanceof l.Texture2D&&this.setTexture(e),e=this.getTexture(),this._rectInPixels=t,this._rect=l.rectPixelsToPoints(t),e&&e.url&&e.isLoaded()){var r,a;i?(r=t.x+t.height,a=t.y+t.width):(r=t.x+t.width,a=t.y+t.height),r>e.getPixelsWide()&&l.error(l._LogInfos.RectWidth,e.url),a>e.getPixelsHigh()&&l.error(l._LogInfos.RectHeight,e.url)}return this._offsetInPixels.x=n.x,this._offsetInPixels.y=n.y,l._pointPixelsToPointsOut(n,this._offset),this._originalSizeInPixels.width=s.width,this._originalSizeInPixels.height=s.height,l._sizePixelsToPointsOut(s,this._originalSize),this._rotated=i,!0}}),l.EventHelper.prototype.apply(l.SpriteFrame.prototype),l.SpriteFrame.create=function(e,t,i,n,s){return new l.SpriteFrame(e,t,i,n,s)},l.SpriteFrame.createWithTexture=l.SpriteFrame.create,l.SpriteFrame._frameWithTextureForCanvas=function(e,t,i,n,s){var r=new l.SpriteFrame;return r._texture=e,r._rectInPixels=t,r._rect=l.rectPixelsToPoints(t),r._offsetInPixels.x=n.x,r._offsetInPixels.y=n.y,l._pointPixelsToPointsOut(r._offsetInPixels,r._offset),r._originalSizeInPixels.width=s.width,r._originalSizeInPixels.height=s.height,l._sizePixelsToPointsOut(r._originalSizeInPixels,r._originalSize),r._rotated=i,r},l.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(e){var t=this._CCNS_REG2.exec(e);return t?l.rect(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])):l.rect(0,0,0,0)},_pointFromString:function(e){var t=this._CCNS_REG1.exec(e);return t?l.p(parseFloat(t[1]),parseFloat(t[2])):l.p(0,0)},_sizeFromString:function(e){var t=this._CCNS_REG1.exec(e);return t?l.size(parseFloat(t[1]),parseFloat(t[2])):l.size(0,0)},_getFrameConfig:function(e){var t=l.loader.getRes(e);return l.assert(t,l._LogInfos.spriteFrameCache__getFrameConfig_2,e),l.loader.release(e),t._inited?(this._frameConfigCache[e]=t,t):(this._frameConfigCache[e]=this._parseFrameConfig(t),this._frameConfigCache[e])},_getFrameConfigByJsonObject:function(e,t){return l.assert(t,l._LogInfos.spriteFrameCache__getFrameConfig_2,e),this._frameConfigCache[e]=this._parseFrameConfig(t),this._frameConfigCache[e]},_parseFrameConfig:function(e){var t=e.frames,i=e.metadata||e.meta,n={},s={},r=0;if(i){var a=i.format;r=a.length<=1?parseInt(a):a,s.image=i.textureFileName||i.textureFileName||i.image}for(var o in t){var h=t[o];if(h){var d={};if(0==r){d.rect=l.rect(h.x,h.y,h.width,h.height),d.rotated=!1,d.offset=l.p(h.offsetX,h.offsetY);var c=h.originalWidth,u=h.originalHeight;c&&u||l.log(l._LogInfos.spriteFrameCache__getFrameConfig),c=Math.abs(c),u=Math.abs(u),d.size=l.size(c,u)}else if(1==r||2==r)d.rect=this._rectFromString(h.frame),d.rotated=h.rotated||!1,d.offset=this._pointFromString(h.offset),d.size=this._sizeFromString(h.sourceSize);else if(3==r){var p=this._sizeFromString(h.spriteSize),m=this._rectFromString(h.textureRect);p&&(m=l.rect(m.x,m.y,p.width,p.height)),d.rect=m,d.rotated=h.textureRotated||!1,d.offset=this._pointFromString(h.spriteOffset),d.size=this._sizeFromString(h.spriteSourceSize),d.aliases=h.aliases}else{var _=h.frame,g=h.sourceSize;o=h.filename||o,d.rect=l.rect(_.x,_.y,_.w,_.h),d.rotated=h.rotated||!1,d.offset=l.p(0,0),d.size=l.size(g.w,g.h)}n[o]=d}}return{_inited:!0,frames:n,meta:s}},_addSpriteFramesByObject:function(e,t,i){if(l.assert(e,l._LogInfos.spriteFrameCache_addSpriteFrames_2),t&&t.frames){var n=this._frameConfigCache[e]||this._getFrameConfigByJsonObject(e,t);this._createSpriteFrames(e,n,i)}},_createSpriteFrames:function(e,t,i){var n=t.frames,s=t.meta;if(i)i instanceof l.Texture2D||(l.isString(i)?i=l.textureCache.addImage(i):l.assert(0,l._LogInfos.spriteFrameCache_addSpriteFrames_3));else{var r=l.path.changeBasename(e,s.image||".png");i=l.textureCache.addImage(r)}var a=this._spriteFramesAliases,o=this._spriteFrames;for(var h in n){var d=n[h],c=o[h];if(!c){c=new l.SpriteFrame(i,l.rect(d.rect),d.rotated,d.offset,d.size);var u=d.aliases;if(u)for(var p=0,m=u.length;p<m;p++){var _=u[p];a[_]&&l.log(l._LogInfos.spriteFrameCache_addSpriteFrames,_),a[_]=h}if(l._renderType===l.game.RENDER_TYPE_CANVAS&&c.isRotated()&&c.getTexture().isLoaded()){var g=c.getTexture().getHtmlElementObj();g=l.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(g,c.getRectInPixels());var T=new l.Texture2D;T.initWithElement(g),T.handleLoadedTexture(),c.setTexture(T),c.setRotated(!1);var f=c._rect;c.setRect(l.rect(0,0,f.width,f.height))}o[h]=c}}},addSpriteFrames:function(e,t){l.assert(e,l._LogInfos.spriteFrameCache_addSpriteFrames_2);var i=this._frameConfigCache[e]||l.loader.getRes(e);if(i&&i.frames){var n=this._frameConfigCache[e]||this._getFrameConfig(e);this._createSpriteFrames(e,n,t)}},_checkConflict:function(e){var t=e.frames;for(var i in t)this._spriteFrames[i]&&l.log(l._LogInfos.spriteFrameCache__checkConflict,i)},addSpriteFrame:function(e,t){this._spriteFrames[t]=e},removeSpriteFrames:function(){this._spriteFrames={},this._spriteFramesAliases={}},removeSpriteFrameByName:function(e){e&&(this._spriteFramesAliases[e]&&delete this._spriteFramesAliases[e],this._spriteFrames[e]&&delete this._spriteFrames[e])},removeSpriteFramesFromFile:function(e){var t=this,i=t._spriteFrames,n=t._spriteFramesAliases,s=t._frameConfigCache[e];if(s){var r=s.frames;for(var a in r)if(i[a]){delete i[a];for(var o in n)n[o]===a&&delete n[o]}delete t._frameConfigCache[e]}},removeSpriteFramesFromTexture:function(e){var t=this,i=t._spriteFrames,n=t._spriteFramesAliases;for(var s in i){var r=i[s];if(r&&r.getTexture()===e){delete i[s];for(var a in n)n[a]===s&&delete n[a]}}},getSpriteFrame:function(e){var t=this,i=t._spriteFrames[e];if(!i){var n=t._spriteFramesAliases[e];n&&((i=t._spriteFrames[n.toString()])||delete t._spriteFramesAliases[e])}return i},_clear:function(){this._spriteFrames={},this._spriteFramesAliases={},this._frameConfigCache={}}},l.configuration={ERROR:0,STRING:1,INT:2,DOUBLE:3,BOOLEAN:4,_maxTextureSize:0,_maxModelviewStackDepth:0,_supportsPVRTC:!1,_supportsNPOT:!1,_supportsBGRA8888:!1,_supportsDiscardFramebuffer:!1,_supportsShareableVAO:!1,_maxSamplesAllowed:0,_maxTextureUnits:0,_GlExtensions:"",_valueDict:{},_inited:!1,_init:function(){var e=this._valueDict;e["cocos2d.x.version"]=l.ENGINE_VERSION,e["cocos2d.x.compiled_with_profiler"]=!1,e["cocos2d.x.compiled_with_gl_state_cache"]=l.ENABLE_GL_STATE_CACHE,this._inited=!0},getMaxTextureSize:function(){return this._maxTextureSize},getMaxModelviewStackDepth:function(){return this._maxModelviewStackDepth},getMaxTextureUnits:function(){return this._maxTextureUnits},supportsNPOT:function(){return this._supportsNPOT},supportsPVRTC:function(){return this._supportsPVRTC},supportsETC:function(){return!1},supportsS3TC:function(){return!1},supportsATITC:function(){return!1},supportsBGRA8888:function(){return this._supportsBGRA8888},supportsDiscardFramebuffer:function(){return this._supportsDiscardFramebuffer},supportsShareableVAO:function(){return this._supportsShareableVAO},checkForGLExtension:function(e){return this._GlExtensions.indexOf(e)>-1},getValue:function(e,t){this._inited||this._init();var i=this._valueDict;return i[e]?i[e]:t},setValue:function(e,t){this._valueDict[e]=t},dumpInfo:function(){0===l.ENABLE_GL_STATE_CACHE&&(l.log(""),l.log(l._LogInfos.configuration_dumpInfo),l.log(""))},gatherGPUInfo:function(){if(l._renderType!==l.game.RENDER_TYPE_CANVAS){this._inited||this._init();var e=l._renderContext,t=this._valueDict;t["gl.vendor"]=e.getParameter(e.VENDOR),t["gl.renderer"]=e.getParameter(e.RENDERER),t["gl.version"]=e.getParameter(e.VERSION),this._GlExtensions="";for(var i=e.getSupportedExtensions(),n=0;n<i.length;n++)this._GlExtensions+=i[n]+" ";this._maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),t["gl.max_texture_size"]=this._maxTextureSize,this._maxTextureUnits=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),t["gl.max_texture_units"]=this._maxTextureUnits,this._supportsPVRTC=this.checkForGLExtension("GL_IMG_texture_compression_pvrtc"),t["gl.supports_PVRTC"]=this._supportsPVRTC,this._supportsNPOT=!1,t["gl.supports_NPOT"]=this._supportsNPOT,this._supportsBGRA8888=this.checkForGLExtension("GL_IMG_texture_format_BGRA888"),t["gl.supports_BGRA8888"]=this._supportsBGRA8888,this._supportsDiscardFramebuffer=this.checkForGLExtension("GL_EXT_discard_framebuffer"),t["gl.supports_discard_framebuffer"]=this._supportsDiscardFramebuffer,this._supportsShareableVAO=this.checkForGLExtension("vertex_array_object"),t["gl.supports_vertex_array_object"]=this._supportsShareableVAO,l.checkGLErrorDebug()}},loadConfigFile:function(e){this._inited||this._init();var t=l.loader.getRes(e);if(!t)throw new Error("Please load the resource first : "+e);l.assert(t,l._LogInfos.configuration_loadConfigFile_2,e);var i=t.data;if(i)for(var n in i)this._valueDict[n]=i[n];else l.log(l._LogInfos.configuration_loadConfigFile,e)}},l.g_NumberOfDraws=0,l.Director=l.Class.extend({_landscape:!1,_nextDeltaTimeZero:!1,_paused:!1,_purgeDirectorInNextLoop:!1,_sendCleanupToScene:!1,_animationInterval:0,_oldAnimationInterval:0,_projection:0,_contentScaleFactor:1,_deltaTime:0,_winSizeInPoints:null,_lastUpdate:null,_nextScene:null,_notificationNode:null,_openGLView:null,_scenesStack:null,_projectionDelegate:null,_runningScene:null,_totalFrames:0,_secondsPerFrame:0,_dirtyRegion:null,_scheduler:null,_actionManager:null,_eventProjectionChanged:null,_eventAfterUpdate:null,_eventAfterVisit:null,_eventAfterDraw:null,ctor:function(){var e=this;e._lastUpdate=Date.now(),l.eventManager.addCustomListener(l.game.EVENT_SHOW,function(){e._lastUpdate=Date.now()})},init:function(){return this._oldAnimationInterval=this._animationInterval=1/l.defaultFPS,this._scenesStack=[],this._projection=l.Director.PROJECTION_DEFAULT,this._projectionDelegate=null,this._totalFrames=0,this._lastUpdate=Date.now(),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=l.size(0,0),this._openGLView=null,this._contentScaleFactor=1,this._scheduler=new l.Scheduler,l.ActionManager?this._actionManager=new l.ActionManager:this._actionManager=null,this._eventAfterUpdate=new l.EventCustom(l.Director.EVENT_AFTER_UPDATE),this._eventAfterUpdate.setUserData(this),this._eventAfterVisit=new l.EventCustom(l.Director.EVENT_AFTER_VISIT),this._eventAfterVisit.setUserData(this),this._eventAfterDraw=new l.EventCustom(l.Director.EVENT_AFTER_DRAW),this._eventAfterDraw.setUserData(this),this._eventProjectionChanged=new l.EventCustom(l.Director.EVENT_PROJECTION_CHANGED),this._eventProjectionChanged.setUserData(this),!0},calculateDeltaTime:function(){var e=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):this._deltaTime=(e-this._lastUpdate)/1e3,l.game.config[l.game.CONFIG_KEY.debugMode]>0&&this._deltaTime>.2&&(this._deltaTime=1/60),this._lastUpdate=e},convertToGL:function(e){var t=document.body,i=l.view,n=t.getBoundingClientRect(),s=i._devicePixelRatio*(e.x-n.left),r=i._devicePixelRatio*(n.top+n.height-e.y);return i._isRotated?{x:i._viewPortRect.width-r,y:s}:{x:s,y:r}},convertToUI:function(e){var t=document.documentElement,i=l.view,n=t.getBoundingClientRect();n.left+=window.pageXOffset-t.clientLeft,n.top+=window.pageYOffset-t.clientTop;var s={x:0,y:0};return i._isRotated?(s.x=n.left+e.y/i._devicePixelRatio,s.y=n.top+n.height-(i._viewPortRect.width-e.x)/i._devicePixelRatio):(s.x=n.left+e.x/i._devicePixelRatio,s.y=n.top+n.height-e.y/i._devicePixelRatio),s},drawScene:function(){var e=l.renderer;this.calculateDeltaTime();this._scheduler.isWaite;this._paused||(this._actionManager.update(this._deltaTime*this._scheduler.getTimeScale()),this._scheduler.update(this._deltaTime),l.eventManager.dispatchEvent(this._eventAfterUpdate)),this._nextScene&&this.setNextScene(),this._runningScene&&(e.childrenOrderDirty?(l.renderer.clearRenderCommands(),l.renderer.assignedZ=0,this._runningScene._renderCmd._curLevel=0,this._runningScene.visit(),e.resetFlag()):e.transformDirty()&&e.transform()),e.clear(),this._notificationNode&&this._notificationNode.visit(),l.eventManager.dispatchEvent(this._eventAfterVisit),l.g_NumberOfDraws=0,e.rendering(l._renderContext),this._totalFrames++,l.eventManager.dispatchEvent(this._eventAfterDraw),l.eventManager.frameUpdateListeners(),this._calculateMPF()},end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getNotificationNode:function(){return this._notificationNode},getWinSize:function(){return l.size(this._winSizeInPoints)},getWinSizeInPixels:function(){return l.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(.25),this._paused=!0)},popScene:function(){l.assert(this._runningScene,l._LogInfos.Director_popScene),this._scenesStack.pop();var e=this._scenesStack.length;0===e?this.end():(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[e-1])},purgeCachedData:function(){l.animationCache._clear(),l.spriteFrameCache._clear(),l.textureCache._clear()},purgeDirector:function(){this.getScheduler().unscheduleAll(),l.eventManager&&l.eventManager.setEnabled(!1),this._runningScene&&(this._runningScene._performRecursive(l.Node._stateCallbackType.onExitTransitionDidStart),this._runningScene._performRecursive(l.Node._stateCallbackType.onExit),this._runningScene._performRecursive(l.Node._stateCallbackType.cleanup)),this._runningScene=null,this._nextScene=null,this._scenesStack.length=0,this.stopAnimation(),this.purgeCachedData(),l.checkGLErrorDebug()},pushScene:function(e){l.assert(e,l._LogInfos.Director_pushScene),this._sendCleanupToScene=!1,this._scenesStack.push(e),this._nextScene=e},runScene:function(e){if(l.assert(e,l._LogInfos.Director_pushScene),this._runningScene){var t=this._scenesStack.length;0===t?(this._sendCleanupToScene=!0,this._scenesStack[t]=e,this._nextScene=e):(this._sendCleanupToScene=!0,this._scenesStack[t-1]=e,this._nextScene=e)}else this.pushScene(e),this.startAnimation()},resume:function(){this._paused&&(this.setAnimationInterval(this._oldAnimationInterval),this._lastUpdate=Date.now(),this._lastUpdate||l.log(l._LogInfos.Director_resume),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(e){e!==this._contentScaleFactor&&(this._contentScaleFactor=e)},setDepthTest:null,setClearColor:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(e){this._nextDeltaTimeZero=e},setNextScene:function(){var e=!1,t=!1;if(l.TransitionScene&&(e=!!this._runningScene&&this._runningScene instanceof l.TransitionScene,t=!!this._nextScene&&this._nextScene instanceof l.TransitionScene),!t){var i=this._runningScene;i&&(i._performRecursive(l.Node._stateCallbackType.onExitTransitionDidStart),i._performRecursive(l.Node._stateCallbackType.onExit)),this._sendCleanupToScene&&i&&i._performRecursive(l.Node._stateCallbackType.cleanup)}this._runningScene=this._nextScene,l.renderer.childrenOrderDirty=!0,this._nextScene=null,e||null===this._runningScene||(this._runningScene._performRecursive(l.Node._stateCallbackType.onEnter),this._runningScene._performRecursive(l.Node._stateCallbackType.onEnterTransitionDidFinish))},setNotificationNode:function(e){l.renderer.childrenOrderDirty=!0,this._notificationNode&&(this._notificationNode._performRecursive(l.Node._stateCallbackType.onExitTransitionDidStart),this._notificationNode._performRecursive(l.Node._stateCallbackType.onExit),this._notificationNode._performRecursive(l.Node._stateCallbackType.cleanup)),this._notificationNode=e,e&&(this._notificationNode._performRecursive(l.Node._stateCallbackType.onEnter),this._notificationNode._performRecursive(l.Node._stateCallbackType.onEnterTransitionDidFinish))},getDelegate:function(){return this._projectionDelegate},setDelegate:function(e){this._projectionDelegate=e},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,isSendCleanupToScene:function(){return this._sendCleanupToScene},getRunningScene:function(){return this._runningScene},getAnimationInterval:function(){return this._animationInterval},isDisplayStats:function(){return!!l.profiler&&l.profiler.isShowingStats()},setDisplayStats:function(e){l.profiler&&(e?l.profiler.showStats():l.profiler.hideStats())},getSecondsPerFrame:function(){return this._secondsPerFrame},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero},isPaused:function(){return this._paused},getTotalFrames:function(){return this._totalFrames},popToRootScene:function(){this.popToSceneStackLevel(1)},popToSceneStackLevel:function(e){l.assert(this._runningScene,l._LogInfos.Director_popToSceneStackLevel_2);var t=this._scenesStack,i=t.length;if(0!==e){if(!(e>=i)){for(;i>e;){var n=t.pop();n.running&&(n._performRecursive(l.Node._stateCallbackType.onExitTransitionDidStart),n._performRecursive(l.Node._stateCallbackType.onExit)),n._performRecursive(l.Node._stateCallbackType.cleanup),i--}this._nextScene=t[t.length-1],this._sendCleanupToScene=!0}}else this.end()},getScheduler:function(){return this._scheduler},setScheduler:function(e){this._scheduler!==e&&(this._scheduler=e)},getActionManager:function(){return this._actionManager},setActionManager:function(e){this._actionManager!==e&&(this._actionManager=e)},getDeltaTime:function(){return this._deltaTime},_calculateMPF:function(){var e=Date.now();this._secondsPerFrame=(e-this._lastUpdate)/1e3}}),l.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",l.Director.EVENT_AFTER_UPDATE="director_after_update",l.Director.EVENT_AFTER_VISIT="director_after_visit",l.Director.EVENT_AFTER_DRAW="director_after_draw",l.DisplayLinkDirector=l.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=!0,this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||this.drawScene()},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(e){this._animationInterval=e,this.invalid||(this.stopAnimation(),this.startAnimation())}}),l.Director.sharedDirector=null,l.Director.firstUseDirector=!0,l.Director._getInstance=function(){return l.Director.firstUseDirector&&(l.Director.firstUseDirector=!1,l.Director.sharedDirector=new l.DisplayLinkDirector,l.Director.sharedDirector.init()),l.Director.sharedDirector},l.defaultFPS=60,l.Director.PROJECTION_2D=0,l.Director.PROJECTION_3D=1,l.Director.PROJECTION_CUSTOM=3,l.Director.PROJECTION_DEFAULT=l.Director.PROJECTION_2D,l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){if(l._renderType===l.game.RENDER_TYPE_CANVAS){var e=l.Director.prototype;e.getProjection=function(e){return this._projection},e.setProjection=function(e){this._projection=e,l.eventManager.dispatchEvent(this._eventProjectionChanged)},e.setDepthTest=function(){},e.setClearColor=function(e){l.renderer._clearColor=e,l.renderer._clearFillStyle="rgb("+e.r+","+e.g+","+e.b+")"},e.setOpenGLView=function(e){this._winSizeInPoints.width=l._canvas.width,this._winSizeInPoints.height=l._canvas.height,this._openGLView=e||l.view,l.eventManager&&l.eventManager.setEnabled(!0)},e.getVisibleSize=function(){return this.getWinSize()},e.getVisibleOrigin=function(){return l.p(0,0)}}else l.Director._fpsImage=new Image,l.Director._fpsImage.addEventListener("load",function(){l.Director._fpsImageLoaded=!0}),l._fpsImage&&(l.Director._fpsImage.src=l._fpsImage)}),l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){if(l._renderType===l.game.RENDER_TYPE_WEBGL){l.DirectorDelegate=l.Class.extend({updateProjection:function(){}});var e=l.Director.prototype,t=function(e){if(e&&e._renderCmd){e._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty);var i,n=e._children;for(i=0;i<n.length;i++)t(n[i])}};l.eventManager.addCustomListener(l.Director.EVENT_PROJECTION_CHANGED,function(){l.director;for(var e=l.director._scenesStack,i=0;i<e.length;i++)t(e[i])}),e.setProjection=function(e){var t=this,i=t._winSizeInPoints;t.setViewport();var n=t._openGLView,s=n._viewPortRect.x/n._scaleX,r=n._viewPortRect.y/n._scaleY;switch(e){case l.Director.PROJECTION_2D:l.kmGLMatrixMode(l.KM_GL_PROJECTION),l.kmGLLoadIdentity();var a=l.math.Matrix4.createOrthographicProjection(0,i.width,0,i.height,-1024,1024);l.kmGLMultMatrix(a),l.kmGLMatrixMode(l.KM_GL_MODELVIEW),l.kmGLLoadIdentity();break;case l.Director.PROJECTION_3D:var o=t.getZEye(),h=new l.math.Matrix4,d=new l.math.Matrix4;l.kmGLMatrixMode(l.KM_GL_PROJECTION),l.kmGLLoadIdentity(),h=l.math.Matrix4.createPerspectiveProjection(60,i.width/i.height,.1,2*o),l.kmGLMultMatrix(h);var c=new l.math.Vec3(-s+i.width/2,-r+i.height/2,o),u=new l.math.Vec3(-s+i.width/2,-r+i.height/2,0),p=new l.math.Vec3(0,1,0);d.lookAt(c,u,p),l.kmGLMultMatrix(d),l.kmGLMatrixMode(l.KM_GL_MODELVIEW),l.kmGLLoadIdentity();break;case l.Director.PROJECTION_CUSTOM:t._projectionDelegate&&t._projectionDelegate.updateProjection();break;default:l.log(l._LogInfos.Director_setProjection)}t._projection=e,l.eventManager.dispatchEvent(t._eventProjectionChanged),l.setProjectionMatrixDirty(),l.renderer.childrenOrderDirty=!0},e.setDepthTest=function(e){l.renderer.setDepthTest(e)},e.setClearColor=function(e){l.renderer._clearColor=e},e.setOpenGLView=function(e){var t=this;t._winSizeInPoints.width=l._canvas.width,t._winSizeInPoints.height=l._canvas.height,t._openGLView=e||l.view;var i=l.configuration;i.gatherGPUInfo(),i.dumpInfo(),t.setGLDefaultValues(),l.eventManager&&l.eventManager.setEnabled(!0)},e.getVisibleSize=function(){return this._openGLView.getVisibleSize()},e.getVisibleOrigin=function(){return this._openGLView.getVisibleOrigin()},e.getZEye=function(){return this._winSizeInPoints.height/1.1546999375},e.setViewport=function(){var e=this._openGLView;if(e){var t=this._winSizeInPoints;e.setViewPortInPoints(-e._viewPortRect.x/e._scaleX,-e._viewPortRect.y/e._scaleY,t.width,t.height)}},e.getOpenGLView=function(){return this._openGLView},e.getProjection=function(){return this._projection},e.setAlphaBlending=function(e){e?l.glBlendFunc(l.BLEND_SRC,l.BLEND_DST):l.glBlendFunc(l._renderContext.ONE,l._renderContext.ZERO)},e.setGLDefaultValues=function(){var e=this;e.setAlphaBlending(!0),e.setProjection(e._projection),l._renderContext.clearColor(0,0,0,0)}}}),function(){var e=function(e,t,i,n,s,r,a){this.prev=e,this.next=t,this.callback=i,this.target=n,this.priority=s,this.paused=r,this.markedForDeletion=a},t=[];e.get=function(i,n,s,r,a,o,h){var l=t.pop();return l?(l.prev=i,l.next=n,l.callback=s,l.target=r,l.priority=a,l.paused=o,l.markedForDeletion=h):l=new e(i,n,s,r,a,o,h),l},e.put=function(e){e.prev=null,e.next=null,e.callback=null,e.target=null,e.priority=0,e.paused=!1,e.markedForDeletion=!1,t.length<20&&t.push(e)};var i=function(e,t,i,n){this.list=e,this.entry=t,this.target=i,this.callback=n},n=[];i.get=function(e,t,s,r){var a=n.pop();return a?(a.list=e,a.entry=t,a.target=s,a.callback=r):a=new i(e,t,s,r),a},i.put=function(e){e.list=null,e.entry=null,e.target=null,e.callback=null,n.length<20&&n.push(e)};var s=function(e,t,i,n,s,r){var a=this;a.timers=e,a.target=t,a.timerIndex=i,a.currentTimer=n,a.currentTimerSalvaged=s,a.paused=r},r=[];s.get=function(e,t,i,n,a,o){var h=r.pop();return h?(h.timers=e,h.target=t,h.timerIndex=i,h.currentTimer=n,h.currentTimerSalvaged=a,h.paused=o):h=new s(e,t,i,n,a,o),h},s.put=function(e){e.timers=null,e.target=null,e.timerIndex=0,e.currentTimer=null,e.currentTimerSalvaged=!1,e.paused=!1,r.length<20&&r.push(e)};var a=function(){this._scheduler=null,this._elapsed=-1,this._runForever=!1,this._useDelay=!1,this._timesExecuted=0,this._repeat=0,this._delay=0,this._interval=0,this._target=null,this._callback=null,this._key=null};l.inject({initWithCallback:function(e,t,i,n,s,r,a){return this._scheduler=e,this._target=i,this._callback=t,a&&(this._key=a),this._elapsed=-1,this._interval=n,this._delay=r,this._useDelay=this._delay>0,this._repeat=s,this._runForever=this._repeat===l.REPEAT_FOREVER,!0},getInterval:function(){return this._interval},setInterval:function(e){this._interval=e},update:function(e){-1===this._elapsed?(this._elapsed=0,this._timesExecuted=0):(this._elapsed+=e,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),this._callback&&!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))},getCallback:function(){return this._callback},getKey:function(){return this._key},trigger:function(){this._target&&this._callback&&this._callback.call(this._target,this._elapsed)},cancel:function(){this._scheduler.unschedule(this._callback,this._target)}},a.prototype);var o=[];a.get=function(){return o.pop()||new a},a.put=function(e){e._scheduler=null,e._elapsed=-1,e._runForever=!1,e._useDelay=!1,e._timesExecuted=0,e._repeat=0,e._delay=0,e._interval=0,e._target=null,e._callback=null,e._key=null,o.length<20&&o.push(e)},l.Scheduler=l.Class.extend({_timeScale:1,_updatesNegList:null,_updates0List:null,_updatesPosList:null,_hashForTimers:null,_arrayForTimers:null,_hashForUpdates:null,_currentTarget:null,_currentTargetSalvaged:!1,_updateHashLocked:!1,isWaite:!1,ctor:function(){this._timeScale=1,this._updatesNegList=[],this._updates0List=[],this._updatesPosList=[],this._hashForUpdates={},this._hashForTimers={},this._currentTarget=null,this._currentTargetSalvaged=!1,this._updateHashLocked=!1,this._arrayForTimers=[]},_schedulePerFrame:function(e,t,i,n){var s=this._hashForUpdates[t.__instanceId];if(s&&s.entry){if(s.entry.priority===i)return s.entry.markedForDeletion=!1,void(s.entry.paused=n);if(this._updateHashLocked)return l.log("warning: you CANNOT change update priority in scheduled function"),s.entry.markedForDeletion=!1,void(s.entry.paused=n);this.unscheduleUpdate(t)}0===i?this._appendIn(this._updates0List,e,t,n):i<0?this._priorityIn(this._updatesNegList,e,t,i,n):this._priorityIn(this._updatesPosList,e,t,i,n)},_removeHashElement:function(e){delete this._hashForTimers[e.target.__instanceId];for(var t=this._arrayForTimers,i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);break}s.put(e)},_removeUpdateFromHash:function(t){var n=this,s=n._hashForUpdates[t.target.__instanceId];if(s){for(var r=s.list,a=s.entry,o=0,h=r.length;o<h;o++)if(r[o]===a){r.splice(o,1);break}delete n._hashForUpdates[s.target.__instanceId],e.put(a),i.put(s)}},_priorityIn:function(t,n,s,r,a){var o=this,h=e.get(null,null,n,s,r,a,!1);if(t){for(var l=t.length-1,d=0;d<=l;d++)if(r<t[d].priority){l=d;break}t.splice(d,0,h)}else(t=[]).push(h);return o._hashForUpdates[s.__instanceId]=i.get(t,h,s,null),t},_appendIn:function(t,n,s,r){var a=this,o=e.get(null,null,n,s,0,r,!1);t.push(o),a._hashForUpdates[s.__instanceId]=i.get(t,o,s,null,null)},setTimeScale:function(e){this._timeScale=e},getTimeScale:function(){return this._timeScale},update:function(e){this._updateHashLocked=!0,1!==this._timeScale&&(e*=this._timeScale);var t,i,n,s;for(t=0,n=(i=this._updatesNegList).length;t<n;t++)(s=i[t]).paused||s.markedForDeletion||s.callback(e);for(t=0,n=(i=this._updates0List).length;t<n;t++)(s=i[t]).paused||s.markedForDeletion||s.callback(e);for(t=0,n=(i=this._updatesPosList).length;t<n;t++)(s=i[t]).paused||s.markedForDeletion||s.callback(e);var r,a=this._arrayForTimers;for(t=0;t<a.length;t++){if(r=a[t],this._currentTarget=r,this._currentTargetSalvaged=!1,!r.paused&&!this.isWaite)for(r.timerIndex=0;r.timerIndex<r.timers.length;++r.timerIndex)r.currentTimer=r.timers[r.timerIndex],r.currentTimerSalvaged=!1,r.currentTimer.update(e),r.currentTimer=null;this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&this._removeHashElement(this._currentTarget)}for(t=0,i=this._updatesNegList;t<i.length;)(s=i[t]).markedForDeletion?this._removeUpdateFromHash(s):t++;for(t=0,i=this._updates0List;t<i.length;)(s=i[t]).markedForDeletion?this._removeUpdateFromHash(s):t++;for(t=0,i=this._updatesPosList;t<i.length;)(s=i[t]).markedForDeletion?this._removeUpdateFromHash(s):t++;this._updateHashLocked=!1,this._currentTarget=null},scheduleCallbackForTarget:function(e,t,i,n,s,r){this.schedule(t,e,i,n,s,r,e.__instanceId+"")},schedule:function(e,t,i,n,r,o,h){if("function"!=typeof e){var d=e;e=t,t=d,!0}4!==arguments.length&&5!==arguments.length||(h=r,o=n,n=l.REPEAT_FOREVER,r=0),void 0===h&&(h=t.__instanceId+""),l.assert(t,l._LogInfos.Scheduler_scheduleCallbackForTarget_3);var c=this._hashForTimers[t.__instanceId];c?l.assert(c.paused===o,""):(c=s.get(null,t,0,null,null,o),this._arrayForTimers.push(c),this._hashForTimers[t.__instanceId]=c);var u,p;if(null==c.timers)c.timers=[];else for(p=0;p<c.timers.length;p++)if(u=c.timers[p],e===u._callback)return l.log(l._LogInfos.Scheduler_scheduleCallbackForTarget,u.getInterval().toFixed(4),i.toFixed(4)),void(u._interval=i);(u=a.get()).initWithCallback(this,e,t,i,n,r,h),c.timers.push(u)},scheduleUpdate:function(e,t,i){this._schedulePerFrame(function(t){e.update(t)},e,t,i)},_getUnscheduleMark:function(e,t){switch(typeof e){case"number":case"string":return e===t._key;case"function":return e===t._callback}},unschedule:function(e,t){if(t&&e){var i=this,n=i._hashForTimers[t.__instanceId];if(n)for(var s=n.timers,r=0,o=s.length;r<o;r++){var h=s[r];if(this._getUnscheduleMark(e,h))return h!==n.currentTimer||n.currentTimerSalvaged||(n.currentTimerSalvaged=!0),s.splice(r,1),a.put(h),n.timerIndex>=r&&n.timerIndex--,void(0===s.length&&(i._currentTarget===n?i._currentTargetSalvaged=!0:i._removeHashElement(n)))}}},unscheduleUpdate:function(e){if(e){var t=this._hashForUpdates[e.__instanceId];t&&(this._updateHashLocked?t.entry.markedForDeletion=!0:this._removeUpdateFromHash(t.entry))}},unscheduleAllForTarget:function(e){if(e){var t=this._hashForTimers[e.__instanceId];if(t){var i=t.timers;i.indexOf(t.currentTimer)>-1&&!t.currentTimerSalvaged&&(t.currentTimerSalvaged=!0);for(var n=0,s=i.length;n<s;n++)a.put(i[n]);i.length=0,this._currentTarget===t?this._currentTargetSalvaged=!0:this._removeHashElement(t)}this.unscheduleUpdate(e)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(l.Scheduler.PRIORITY_SYSTEM)},unscheduleAllWithMinPriority:function(e){var t,i,n=this._arrayForTimers;for(t=n.length-1;t>=0;t--)i=n[t],this.unscheduleAllForTarget(i.target);var s,r=0;if(e<0)for(t=0;t<this._updatesNegList.length;)r=this._updatesNegList.length,(s=this._updatesNegList[t])&&s.priority>=e&&this.unscheduleUpdate(s.target),r==this._updatesNegList.length&&t++;if(e<=0)for(t=0;t<this._updates0List.length;)r=this._updates0List.length,(s=this._updates0List[t])&&this.unscheduleUpdate(s.target),r==this._updates0List.length&&t++;for(t=0;t<this._updatesPosList.length;)r=this._updatesPosList.length,(s=this._updatesPosList[t])&&s.priority>=e&&this.unscheduleUpdate(s.target),r==this._updatesPosList.length&&t++},isScheduled:function(e,t){l.assert(e,"Argument callback must not be empty"),l.assert(t,"Argument target must be non-nullptr");var i=this._hashForTimers[t.__instanceId];if(!i)return!1;if(null==i.timers)return!1;for(var n=i.timers,s=0;s<n.length;++s)if(e===n[s]._callback)return!0;return!1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(l.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(e){var t,i,n,s=[],r=this._arrayForTimers;for(i=0,n=r.length;i<n;i++)(t=r[i])&&(t.paused=!0,s.push(t.target));var a;if(e<0)for(i=0;i<this._updatesNegList.length;i++)(a=this._updatesNegList[i])&&a.priority>=e&&(a.paused=!0,s.push(a.target));if(e<=0)for(i=0;i<this._updates0List.length;i++)(a=this._updates0List[i])&&(a.paused=!0,s.push(a.target));for(i=0;i<this._updatesPosList.length;i++)(a=this._updatesPosList[i])&&a.priority>=e&&(a.paused=!0,s.push(a.target));return s},resumeTargets:function(e){if(e)for(var t=0;t<e.length;t++)this.resumeTarget(e[t])},pauseTarget:function(e){l.assert(e,l._LogInfos.Scheduler_pauseTarget);var t=this,i=t._hashForTimers[e.__instanceId];i&&(i.paused=!0);var n=t._hashForUpdates[e.__instanceId];n&&(n.entry.paused=!0)},resumeTarget:function(e){l.assert(e,l._LogInfos.Scheduler_resumeTarget);var t=this,i=t._hashForTimers[e.__instanceId];i&&(i.paused=!1);var n=t._hashForUpdates[e.__instanceId];n&&(n.entry.paused=!1)},isTargetPaused:function(e){l.assert(e,l._LogInfos.Scheduler_isTargetPaused);var t=this._hashForTimers[e.__instanceId];if(t)return t.paused;var i=this._hashForUpdates[e.__instanceId];return!!i&&i.entry.paused},scheduleUpdateForTarget:function(e,t,i){this.scheduleUpdate(e,t,i)},unscheduleCallbackForTarget:function(e,t){this.unschedule(t,e)},unscheduleUpdateForTarget:function(e){this.unscheduleUpdate(e)},unscheduleAllCallbacksForTarget:function(e){this.unschedule(e.__instanceId+"",e)},unscheduleAllCallbacks:function(){this.unscheduleAllWithMinPriority(l.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(e){this.unscheduleAllWithMinPriority(e)}}),l.Scheduler.PRIORITY_SYSTEM=-2147483648,l.Scheduler.PRIORITY_NON_SYSTEM=l.Scheduler.PRIORITY_SYSTEM+1}(),l.PI2=2*Math.PI,l.DrawingPrimitiveCanvas=l.Class.extend({_cacheArray:[],_renderContext:null,ctor:function(e){this._renderContext=e},drawPoint:function(e,t){t||(t=1);var i=l.view.getScaleX(),n=l.view.getScaleY(),s=l.p(e.x*i,e.y*n),r=this._renderContext.getContext();r.beginPath(),r.arc(s.x,-s.y,t*i,0,2*Math.PI,!1),r.closePath(),r.fill()},drawPoints:function(e,t,i){if(null!=e){i||(i=1);var n=this._renderContext.getContext(),s=l.view.getScaleX(),r=l.view.getScaleY();n.beginPath();for(var a=0,o=e.length;a<o;a++)n.arc(e[a].x*s,-e[a].y*r,i*s,0,2*Math.PI,!1);n.closePath(),n.fill()}},drawLine:function(e,t){var i=this._renderContext.getContext();l.view.getScaleX(),l.view.getScaleY();i.beginPath(),i.moveTo(e.x,-e.y),i.lineTo(t.x,-t.y),i.closePath(),i.stroke()},drawRect:function(e,t){this.drawLine(l.p(e.x,e.y),l.p(t.x,e.y)),this.drawLine(l.p(t.x,e.y),l.p(t.x,t.y)),this.drawLine(l.p(t.x,t.y),l.p(e.x,t.y)),this.drawLine(l.p(e.x,t.y),l.p(e.x,e.y))},drawSolidRect:function(e,t,i){var n=[e,l.p(t.x,e.y),t,l.p(e.x,t.y)];this.drawSolidPoly(n,4,i)},drawPoly:function(e,t,i,n){if(n=n||!1,null!=e){if(e.length<3)throw new Error("Polygon's point must greater than 2");var s=e[0],r=this._renderContext.getContext();l.view.getScaleX(),l.view.getScaleY();r.beginPath(),r.moveTo(s.x,-s.y);for(var a=1,o=e.length;a<o;a++)r.lineTo(e[a].x,-e[a].y);i&&r.closePath(),n?r.fill():r.stroke()}},drawSolidPoly:function(e,t,i){this.setDrawColor(i.r,i.g,i.b,i.a),this.drawPoly(e,t,!0,!0)},drawCircle:function(e,t,i,n,s){s=s||!1;var r=this._renderContext.getContext();l.view.getScaleX(),l.view.getScaleY();r.beginPath();var a=i-2*Math.PI;r.arc(0|e.x,0|-e.y,t,-i,-a,!1),s&&r.lineTo(0|e.x,0|-e.y),r.stroke()},drawQuadBezier:function(e,t,i,n){var s=this._cacheArray;s.length=0;for(var r=0,a=0;a<n;a++){var o=Math.pow(1-r,2)*e.x+2*(1-r)*r*t.x+r*r*i.x,h=Math.pow(1-r,2)*e.y+2*(1-r)*r*t.y+r*r*i.y;s.push(l.p(o,h)),r+=1/n}s.push(l.p(i.x,i.y)),this.drawPoly(s,n+1,!1,!1)},drawCubicBezier:function(e,t,i,n,s){var r=this._cacheArray;r.length=0;for(var a=0,o=0;o<s;o++){var h=Math.pow(1-a,3)*e.x+3*Math.pow(1-a,2)*a*t.x+3*(1-a)*a*a*i.x+a*a*a*n.x,d=Math.pow(1-a,3)*e.y+3*Math.pow(1-a,2)*a*t.y+3*(1-a)*a*a*i.y+a*a*a*n.y;r.push(l.p(h,d)),a+=1/s}r.push(l.p(n.x,n.y)),this.drawPoly(r,s+1,!1,!1)},drawCatmullRom:function(e,t){this.drawCardinalSpline(e,.5,t)},drawCardinalSpline:function(e,t,i){l._renderContext.setStrokeStyle("rgba(255,255,255,1)");var n=this._cacheArray;n.length=0;for(var s,r,a=1/e.length,o=0;o<i+1;o++){var h=o/i;1===h?(s=e.length-1,r=1):r=(h-a*(s=0|h/a))/a;var d=l.CardinalSplineAt(l.getControlPointAt(e,s-1),l.getControlPointAt(e,s-0),l.getControlPointAt(e,s+1),l.getControlPointAt(e,s+2),t,r);n.push(d)}this.drawPoly(n,i+1,!1,!1)},drawImage:function(e,t,i,n,s){var r=arguments.length,a=this._renderContext.getContext();switch(r){case 2:var o=e.height;a.drawImage(e,t.x,-(t.y+o));break;case 3:a.drawImage(e,t.x,-(t.y+i.height),i.width,i.height);break;case 5:a.drawImage(e,t.x,t.y,i.width,i.height,n.x,-(n.y+s.height),s.width,s.height);break;default:throw new Error("Argument must be non-nil")}},drawStar:function(e,t,i){var n=e||this._renderContext,s=n.getContext(),r="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b);n.setFillStyle(r+",1)");var a=t/10;s.beginPath(),s.moveTo(-t,t),s.lineTo(0,a),s.lineTo(t,t),s.lineTo(a,0),s.lineTo(t,-t),s.lineTo(0,-a),s.lineTo(-t,-t),s.lineTo(-a,0),s.lineTo(-t,t),s.closePath(),s.fill();var o=s.createRadialGradient(0,0,a,0,0,t);o.addColorStop(0,r+", 1)"),o.addColorStop(.3,r+", 0.8)"),o.addColorStop(1,r+", 0.0)"),n.setFillStyle(o),s.beginPath();var h=l.PI2;s.arc(0,0,t-a,0,h,!1),s.closePath(),s.fill()},drawColorBall:function(e,t,i){var n=e||this._renderContext,s=n.getContext();t*=l.view.getScaleX();var r="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b),a=t/10,o=s.createRadialGradient(0,0,a,0,0,t);o.addColorStop(0,r+", 1)"),o.addColorStop(.3,r+", 0.8)"),o.addColorStop(.6,r+", 0.4)"),o.addColorStop(1,r+", 0.0)"),n.setFillStyle(o),s.beginPath();var h=l.PI2;s.arc(0,0,t,0,h,!1),s.closePath(),s.fill()},fillText:function(e,t,i){this._renderContext.getContext().fillText(e,t,-i)},setDrawColor:function(e,t,i,n){this._renderContext.setFillStyle("rgba("+e+","+t+","+i+","+n/255+")"),this._renderContext.setStrokeStyle("rgba("+e+","+t+","+i+","+n/255+")")},setPointSize:function(e){},setLineWidth:function(e){this._renderContext.getContext().lineWidth=e*l.view.getScaleX()}}),l.DrawingPrimitiveWebGL=l.Class.extend({_renderContext:null,_initialized:!1,_shader:null,_colorLocation:"u_color",_colorArray:null,_pointSizeLocation:"u_pointSize",_pointSize:-1,ctor:function(e){if(null==e&&(e=l._renderContext),!e instanceof WebGLRenderingContext)throw new Error("Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext");this._renderContext=e,this._colorArray=new Float32Array([1,1,1,1])},lazy_init:function(){var e=this;e._initialized||(e._shader=l.shaderCache.programForKey(l.SHADER_POSITION_UCOLOR),e._shader._addUniformLocation(this._colorLocation),e._shader._addUniformLocation(this._pointSizeLocation),e._initialized=!0)},drawInit:function(){this._initialized=!1},drawPoint:function(e){this.lazy_init();var t=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),t.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array([e.x,e.y]),t.STATIC_DRAW),t.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.drawArrays(t.POINTS,0,1),t.deleteBuffer(i),l.incrementGLDraws(1)},drawPoints:function(e,t){if(e&&0!==e.length){this.lazy_init();var i=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),i.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var n=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray(e),i.STATIC_DRAW),i.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.POINTS,0,e.length),i.deleteBuffer(n),l.incrementGLDraws(1)}},_pointsToTypeArray:function(e){for(var t=new Float32Array(2*e.length),i=0;i<e.length;i++)t[2*i]=e[i].x,t[2*i+1]=e[i].y;return t},drawLine:function(e,t){this.lazy_init();var i=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),i.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var n=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray([e,t]),i.STATIC_DRAW),i.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.LINES,0,2),i.deleteBuffer(n),l.incrementGLDraws(1)},drawRect:function(e,t){this.drawLine(l.p(e.x,e.y),l.p(t.x,e.y)),this.drawLine(l.p(t.x,e.y),l.p(t.x,t.y)),this.drawLine(l.p(t.x,t.y),l.p(e.x,t.y)),this.drawLine(l.p(e.x,t.y),l.p(e.x,e.y))},drawSolidRect:function(e,t,i){var n=[e,l.p(t.x,e.y),t,l.p(e.x,t.y)];this.drawSolidPoly(n,4,i)},drawPoly:function(e,t,i){this.lazy_init();var n=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),n.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var s=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,s),n.bufferData(n.ARRAY_BUFFER,this._pointsToTypeArray(e),n.STATIC_DRAW),n.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,n.FLOAT,!1,0,0),i?n.drawArrays(n.LINE_LOOP,0,e.length):n.drawArrays(n.LINE_STRIP,0,e.length),n.deleteBuffer(s),l.incrementGLDraws(1)},drawSolidPoly:function(e,t,i){this.lazy_init(),i&&this.setDrawColor(i.r,i.g,i.b,i.a);var n=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),n.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var s=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,s),n.bufferData(n.ARRAY_BUFFER,this._pointsToTypeArray(e),n.STATIC_DRAW),n.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,n.FLOAT,!1,0,0),n.drawArrays(n.TRIANGLE_FAN,0,e.length),n.deleteBuffer(s),l.incrementGLDraws(1)},drawCircle:function(e,t,i,n,s){this.lazy_init();var r=1;s&&r++;var a=2*Math.PI/n,o=new Float32Array(2*(n+2));if(o){for(var h=0;h<=n;h++){var d=h*a,c=t*Math.cos(d+i)+e.x,u=t*Math.sin(d+i)+e.y;o[2*h]=c,o[2*h+1]=u}o[2*(n+1)]=e.x,o[2*(n+1)+1]=e.y;var p=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),p.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var m=p.createBuffer();p.bindBuffer(p.ARRAY_BUFFER,m),p.bufferData(p.ARRAY_BUFFER,o,p.STATIC_DRAW),p.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,p.FLOAT,!1,0,0),p.drawArrays(p.LINE_STRIP,0,n+r),p.deleteBuffer(m),l.incrementGLDraws(1)}},drawQuadBezier:function(e,t,i,n){this.lazy_init();for(var s=new Float32Array(2*(n+1)),r=0,a=0;a<n;a++)s[2*a]=Math.pow(1-r,2)*e.x+2*(1-r)*r*t.x+r*r*i.x,s[2*a+1]=Math.pow(1-r,2)*e.y+2*(1-r)*r*t.y+r*r*i.y,r+=1/n;s[2*n]=i.x,s[2*n+1]=i.y;var o=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),o.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var h=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,h),o.bufferData(o.ARRAY_BUFFER,s,o.STATIC_DRAW),o.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,o.FLOAT,!1,0,0),o.drawArrays(o.LINE_STRIP,0,n+1),o.deleteBuffer(h),l.incrementGLDraws(1)},drawCubicBezier:function(e,t,i,n,s){this.lazy_init();for(var r=new Float32Array(2*(s+1)),a=0,o=0;o<s;o++)r[2*o]=Math.pow(1-a,3)*e.x+3*Math.pow(1-a,2)*a*t.x+3*(1-a)*a*a*i.x+a*a*a*n.x,r[2*o+1]=Math.pow(1-a,3)*e.y+3*Math.pow(1-a,2)*a*t.y+3*(1-a)*a*a*i.y+a*a*a*n.y,a+=1/s;r[2*s]=n.x,r[2*s+1]=n.y;var h=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),h.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var d=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,d),h.bufferData(h.ARRAY_BUFFER,r,h.STATIC_DRAW),h.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,h.FLOAT,!1,0,0),h.drawArrays(h.LINE_STRIP,0,s+1),h.deleteBuffer(d),l.incrementGLDraws(1)},drawCatmullRom:function(e,t){this.drawCardinalSpline(e,.5,t)},drawCardinalSpline:function(e,t,i){this.lazy_init();for(var n,s,r=new Float32Array(2*(i+1)),a=1/e.length,o=0;o<i+1;o++){var h=o/i;1===h?(n=e.length-1,s=1):s=(h-a*(n=0|h/a))/a;var d=l.cardinalSplineAt(l.getControlPointAt(e,n-1),l.getControlPointAt(e,n),l.getControlPointAt(e,n+1),l.getControlPointAt(e,n+2),t,s);r[2*o]=d.x,r[2*o+1]=d.y}var c=this._renderContext;this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),c.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var u=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,u),c.bufferData(c.ARRAY_BUFFER,r,c.STATIC_DRAW),c.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,c.FLOAT,!1,0,0),c.drawArrays(c.LINE_STRIP,0,i+1),c.deleteBuffer(u),l.incrementGLDraws(1)},setDrawColor:function(e,t,i,n){this._colorArray[0]=e/255,this._colorArray[1]=t/255,this._colorArray[2]=i/255,this._colorArray[3]=n/255},setPointSize:function(e){this._pointSize=e*l.contentScaleFactor()},setLineWidth:function(e){this._renderContext.lineWidth&&this._renderContext.lineWidth(e)}}),l._tmp.PrototypeLabelTTF=function(){var e=l.LabelTTF.prototype;l.defineGetterSetter(e,"color",e.getColor,e.setColor),l.defineGetterSetter(e,"opacity",e.getOpacity,e.setOpacity),e.string,l.defineGetterSetter(e,"string",e.getString,e.setString),e.textAlign,l.defineGetterSetter(e,"textAlign",e.getHorizontalAlignment,e.setHorizontalAlignment),e.verticalAlign,l.defineGetterSetter(e,"verticalAlign",e.getVerticalAlignment,e.setVerticalAlignment),e.fontSize,l.defineGetterSetter(e,"fontSize",e.getFontSize,e.setFontSize),e.fontName,l.defineGetterSetter(e,"fontName",e.getFontName,e.setFontName),e.font,l.defineGetterSetter(e,"font",e._getFont,e._setFont),e.boundingSize,e.boundingWidth,l.defineGetterSetter(e,"boundingWidth",e._getBoundingWidth,e._setBoundingWidth),e.boundingHeight,l.defineGetterSetter(e,"boundingHeight",e._getBoundingHeight,e._setBoundingHeight),e.fillStyle,l.defineGetterSetter(e,"fillStyle",e._getFillStyle,e.setFontFillColor),e.strokeStyle,l.defineGetterSetter(e,"strokeStyle",e._getStrokeStyle,e._setStrokeStyle),e.lineWidth,l.defineGetterSetter(e,"lineWidth",e._getLineWidth,e._setLineWidth),e.shadowOffset,e.shadowOffsetX,l.defineGetterSetter(e,"shadowOffsetX",e._getShadowOffsetX,e._setShadowOffsetX),e.shadowOffsetY,l.defineGetterSetter(e,"shadowOffsetY",e._getShadowOffsetY,e._setShadowOffsetY),e.shadowOpacity,l.defineGetterSetter(e,"shadowOpacity",e._getShadowOpacity,e._setShadowOpacity),e.shadowBlur,l.defineGetterSetter(e,"shadowBlur",e._getShadowBlur,e._setShadowBlur)},l.LabelTTF=l.Sprite.extend({_dimensions:null,_hAlignment:l.TEXT_ALIGNMENT_CENTER,_vAlignment:l.VERTICAL_TEXT_ALIGNMENT_TOP,_fontName:null,_fontSize:0,_string:"",_originalText:null,_onCacheCanvasMode:!0,_shadowEnabled:!1,_shadowOffset:null,_shadowOpacity:0,_shadowBlur:0,_shadowColor:null,_strokeEnabled:!1,_strokeColor:null,_strokeSize:0,_textFillColor:null,_strokeShadowOffsetX:0,_strokeShadowOffsetY:0,_needUpdateTexture:!1,_lineWidths:null,_className:"LabelTTF",_fontStyle:"normal",_fontWeight:"normal",_lineHeight:"normal",initWithString:function(e,t,i,n,s,r){var a;return a=e?e+"":"",i=i||16,n=n||l.size(0,0),s=s||l.TEXT_ALIGNMENT_LEFT,r=r||l.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._dimensions=l.size(n.width,n.height),this._fontName=t||"Arial",this._hAlignment=s,this._vAlignment=r,this._fontSize=i,this._renderCmd._setFontStyle(this._fontName,i,this._fontStyle,this._fontWeight),this.string=a,this._renderCmd._setColorsString(),this._renderCmd._updateTexture(),this._setUpdateTextureDirty(),this._scaleX=this._scaleY=1/l.view.getDevicePixelRatio(),!0},_setUpdateTextureDirty:function(){this._needUpdateTexture=!0,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.textDirty)},ctor:function(e,t,i,n,s,r){l.Sprite.prototype.ctor.call(this),this._dimensions=l.size(0,0),this._hAlignment=l.TEXT_ALIGNMENT_LEFT,this._vAlignment=l.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._fontName="Arial",this._shadowEnabled=!1,this._shadowOffset=l.p(0,0),this._shadowOpacity=0,this._shadowBlur=0,this._strokeEnabled=!1,this._strokeColor=l.color(255,255,255,255),this._strokeSize=0,this._textFillColor=l.color(255,255,255,255),this._strokeShadowOffsetX=0,this._strokeShadowOffsetY=0,this._needUpdateTexture=!1,this._lineWidths=[],this._renderCmd._setColorsString(),this._textureLoaded=!0,t&&t instanceof l.FontDefinition?this.initWithStringAndTextDefinition(e,t):l.LabelTTF.prototype.initWithString.call(this,e,t,i,n,s,r)},init:function(){return this.initWithString(" ",this._fontName,this._fontSize)},description:function(){return"<cc.LabelTTF | FontName ="+this._fontName+" FontSize = "+this._fontSize.toFixed(1)+">"},getLineHeight:function(){return!this._lineHeight||this._lineHeight.charAt?this._renderCmd._getFontClientHeight():this._lineHeight||this._renderCmd._getFontClientHeight()},setLineHeight:function(e){this._lineHeight=e},getString:function(){return this._string},getHorizontalAlignment:function(){return this._hAlignment},getVerticalAlignment:function(){return this._vAlignment},getDimensions:function(){return l.size(this._dimensions)},getFontSize:function(){return this._fontSize},getFontName:function(){return this._fontName},initWithStringAndTextDefinition:function(e,t){return this._updateWithTextDefinition(t,!1),this.string=e,!0},setTextDefinition:function(e){e&&this._updateWithTextDefinition(e,!0)},getTextDefinition:function(){return this._prepareTextDefinition(!1)},enableShadow:function(e,t,i,n){null!=e.r&&null!=e.g&&null!=e.b&&null!=e.a?this._enableShadow(e,t,i):this._enableShadowNoneColor(e,t,i,n)},_enableShadowNoneColor:function(e,t,i,n){i=i||.5,!1===this._shadowEnabled&&(this._shadowEnabled=!0);var s=this._shadowOffset;(s&&s.x!==e||s._y!==t)&&(s.x=e,s.y=t),this._shadowOpacity!==i&&(this._shadowOpacity=i),this._renderCmd._setColorsString(),this._shadowBlur!==n&&(this._shadowBlur=n),this._setUpdateTextureDirty()},_enableShadow:function(e,t,i){this._shadowColor||(this._shadowColor=l.color(255,255,255,128)),this._shadowColor.r=e.r,this._shadowColor.g=e.g,this._shadowColor.b=e.b;var n,s,r,a;n=t.width||t.x||0,s=t.height||t.y||0,r=null!=e.a?e.a/255:.5,a=i,this._enableShadowNoneColor(n,s,r,a)},_getShadowOffsetX:function(){return this._shadowOffset.x},_setShadowOffsetX:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset.x!==e&&(this._shadowOffset.x=e,this._setUpdateTextureDirty())},_getShadowOffsetY:function(){return this._shadowOffset._y},_setShadowOffsetY:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset._y!==e&&(this._shadowOffset._y=e,this._setUpdateTextureDirty())},_getShadowOffset:function(){return l.p(this._shadowOffset.x,this._shadowOffset.y)},_setShadowOffset:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset.x===e.x&&this._shadowOffset.y===e.y||(this._shadowOffset.x=e.x,this._shadowOffset.y=e.y,this._setUpdateTextureDirty())},_getShadowOpacity:function(){return this._shadowOpacity},_setShadowOpacity:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOpacity!==e&&(this._shadowOpacity=e,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getShadowBlur:function(){return this._shadowBlur},_setShadowBlur:function(e){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowBlur!==e&&(this._shadowBlur=e,this._setUpdateTextureDirty())},disableShadow:function(){this._shadowEnabled&&(this._shadowEnabled=!1,this._setUpdateTextureDirty())},enableStroke:function(e,t){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var i=this._strokeColor;i.r===e.r&&i.g===e.g&&i.b===e.b||(i.r=e.r,i.g=e.g,i.b=e.b,this._renderCmd._setColorsString()),this._strokeSize!==t&&(this._strokeSize=t||0),this._setUpdateTextureDirty()},_getStrokeStyle:function(){return this._strokeColor},_setStrokeStyle:function(e){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var t=this._strokeColor;t.r===e.r&&t.g===e.g&&t.b===e.b||(t.r=e.r,t.g=e.g,t.b=e.b,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getLineWidth:function(){return this._strokeSize},_setLineWidth:function(e){!1===this._strokeEnabled&&(this._strokeEnabled=!0),this._strokeSize!==e&&(this._strokeSize=e||0,this._setUpdateTextureDirty())},disableStroke:function(){this._strokeEnabled&&(this._strokeEnabled=!1,this._setUpdateTextureDirty())},setFontFillColor:function(e){var t=this._textFillColor;t.r===e.r&&t.g===e.g&&t.b===e.b||(t.r=e.r,t.g=e.g,t.b=e.b,this._renderCmd._setColorsString(),this._needUpdateTexture=!0)},_getFillStyle:function(){return this._textFillColor},_updateWithTextDefinition:function(e,t){e.fontDimensions?(this._dimensions.width=e.boundingWidth,this._dimensions.height=e.boundingHeight):(this._dimensions.width=0,this._dimensions.height=0),this._hAlignment=e.textAlign,this._vAlignment=e.verticalAlign,this._fontName=e.fontName,this._fontSize=e.fontSize||12,e.lineHeight?this._lineHeight=e.lineHeight:this._lineHeight=this._fontSize,this._renderCmd._setFontStyle(e),e.shadowEnabled&&this.enableShadow(e.shadowOffsetX,e.shadowOffsetY,e.shadowOpacity,e.shadowBlur),e.strokeEnabled&&this.enableStroke(e.strokeStyle,e.lineWidth),this.setFontFillColor(e.fillStyle),t&&this._renderCmd._updateTexture();var i=l.Node._dirtyFlags;this._renderCmd.setDirtyFlag(i.colorDirty|i.opacityDirty|i.textDirty)},_prepareTextDefinition:function(e){var t=new l.FontDefinition;if(e?(t.fontSize=this._fontSize,t.boundingWidth=l.contentScaleFactor()*this._dimensions.width,t.boundingHeight=l.contentScaleFactor()*this._dimensions.height):(t.fontSize=this._fontSize,t.boundingWidth=this._dimensions.width,t.boundingHeight=this._dimensions.height),t.fontName=this._fontName,t.textAlign=this._hAlignment,t.verticalAlign=this._vAlignment,this._strokeEnabled){t.strokeEnabled=!0;var i=this._strokeColor;t.strokeStyle=l.color(i.r,i.g,i.b),t.lineWidth=this._strokeSize}else t.strokeEnabled=!1;this._shadowEnabled?(t.shadowEnabled=!0,t.shadowBlur=this._shadowBlur,t.shadowOpacity=this._shadowOpacity,t.shadowOffsetX=(e?l.contentScaleFactor():1)*this._shadowOffset.x,t.shadowOffsetY=(e?l.contentScaleFactor():1)*this._shadowOffset.y):t._shadowEnabled=!1;var n=this._textFillColor;return t.fillStyle=l.color(n.r,n.g,n.b),t},getScale:function(){return this._scaleX!==this._scaleY&&l.log(l._LogInfos.Node_getScale),this._scaleX*l.view.getDevicePixelRatio()},setScale:function(e,t){var i=l.view.getDevicePixelRatio();this._scaleX=e/i,this._scaleY=(t||0===t?t:e)/i,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX*l.view.getDevicePixelRatio()},setScaleX:function(e){this._scaleX=e/l.view.getDevicePixelRatio(),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY*l.view.getDevicePixelRatio()},setScaleY:function(e){this._scaleY=e/l.view.getDevicePixelRatio(),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty)},setString:function(e){e=String(e),this._originalText!==e&&(this._originalText=e+"",this._updateString(),this._setUpdateTextureDirty(),this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.transformDirty))},_updateString:function(){this._string&&""!==this._string||this._string===this._originalText||(l.renderer.childrenOrderDirty=!0),this._string=this._originalText},setHorizontalAlignment:function(e){e!==this._hAlignment&&(this._hAlignment=e,this._setUpdateTextureDirty())},setVerticalAlignment:function(e){e!==this._vAlignment&&(this._vAlignment=e,this._setUpdateTextureDirty())},setDimensions:function(e,t){var i;void 0===t?(i=e.width,t=e.height):i=e,i===this._dimensions.width&&t===this._dimensions.height||(this._dimensions.width=i,this._dimensions.height=t,this._updateString(),this._setUpdateTextureDirty())},_getBoundingWidth:function(){return this._dimensions.width},_setBoundingWidth:function(e){e!==this._dimensions.width&&(this._dimensions.width=e,this._updateString(),this._setUpdateTextureDirty())},_getBoundingHeight:function(){return this._dimensions.height},_setBoundingHeight:function(e){e!==this._dimensions.height&&(this._dimensions.height=e,this._updateString(),this._setUpdateTextureDirty())},setFontSize:function(e){this._fontSize!==e&&(this._fontSize=e,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},setFontName:function(e){this._fontName&&this._fontName!==e&&(this._fontName=e,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFont:function(){return this._renderCmd._getFontStyle()},_setFont:function(e){var t=l.LabelTTF._fontStyleRE.exec(e);t&&(this._fontSize=parseInt(t[1]),this._fontName=t[2],this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},getContentSize:function(){this._needUpdateTexture&&this._renderCmd._updateTTF();var e=l.view.getDevicePixelRatio();return l.size(this._contentSize.width/e,this._contentSize.height/e)},_getWidth:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),this._contentSize.width/l.view.getDevicePixelRatio()},_getHeight:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),this._contentSize.height/l.view.getDevicePixelRatio()},setTextureRect:function(e,t,i){var n=this;n._rectRotated=t||!1,n.setContentSize(i||e);var s=n._rect;s.x=e.x,s.y=e.y,s.width=e.width,s.height=e.height,n._renderCmd._setTextureCoords(e,!1);var r=n._unflippedOffsetPositionFromCenter.x,a=n._unflippedOffsetPositionFromCenter.y;n._flippedX&&(r=-r),n._flippedY&&(a=-a),n._offsetPosition.x=r+(e.width-s.width)/2,n._offsetPosition.y=a+(e.height-s.height)/2},setDrawMode:function(e){this._onCacheCanvasMode=e},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_WEBGL?new l.LabelTTF.WebGLRenderCmd(this):this._onCacheCanvasMode?new l.LabelTTF.CacheCanvasRenderCmd(this):new l.LabelTTF.CanvasRenderCmd(this)},_setFontStyle:function(e){this._fontStyle!==e&&(this._fontStyle=e,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontStyle:function(){return this._fontStyle},_setFontWeight:function(e){this._fontWeight!==e&&(this._fontWeight=e,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontWeight:function(){return this._fontWeight}}),l.assert(l.isFunction(l._tmp.PrototypeLabelTTF),l._LogInfos.MissingFile,"LabelTTFPropertyDefine.js"),l._tmp.PrototypeLabelTTF(),delete l._tmp.PrototypeLabelTTF,l.LabelTTF._fontStyleRE=/^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/,l.LabelTTF.create=function(e,t,i,n,s,r){return new l.LabelTTF(e,t,i,n,s,r)},l.LabelTTF.createWithFontDefinition=l.LabelTTF.create,l.LabelTTF.__labelHeightDiv=document.createElement("div"),l.LabelTTF.__labelHeightDiv.style.fontFamily="Arial",l.LabelTTF.__labelHeightDiv.style.position="absolute",l.LabelTTF.__labelHeightDiv.style.left="-100px",l.LabelTTF.__labelHeightDiv.style.top="-100px",l.LabelTTF.__labelHeightDiv.style.lineHeight="normal",document.body?document.body.appendChild(l.LabelTTF.__labelHeightDiv):window.addEventListener("load",function(){this.removeEventListener("load",arguments.callee,!1),document.body.appendChild(l.LabelTTF.__labelHeightDiv)},!1),l.LabelTTF.__getFontHeightByDiv=function(e,t){var i,n=l.LabelTTF.__labelHeightDiv;if(e instanceof l.FontDefinition){var s=e;if((i=l.LabelTTF.__fontHeightCache[s._getCanvasFontStr()])>0)return i;n.innerHTML="ajghl~!",n.style.fontFamily=s.fontName,n.style.fontSize=s.fontSize+"px",n.style.fontStyle=s.fontStyle,n.style.fontWeight=s.fontWeight,i=n.clientHeight,l.LabelTTF.__fontHeightCache[s._getCanvasFontStr()]=i,n.innerHTML=""}else{if((i=l.LabelTTF.__fontHeightCache[e+"."+t])>0)return i;n.innerHTML="ajghl~!",n.style.fontFamily=e,n.style.fontSize=t+"px",i=n.clientHeight,l.LabelTTF.__fontHeightCache[e+"."+t]=i,n.innerHTML=""}return i},l.LabelTTF.__fontHeightCache={},l.LabelTTF._textAlign=["left","center","right"],l.LabelTTF._textBaseline=["top","middle","bottom"],l.LabelTTF.wrapInspection=!0,l.LabelTTF._wordRex=/([a-zA-Z0-9\-¿¡«À-ÖØ-öø-ʯ\u0300-\u034e\u0350-\u036FͰ-ԯ\u2011‵-‷‹⁅]+|\S)/,l.LabelTTF._symbolRex=/^[!,.:;}\]%\?>、‘“》»？。，！\u2010′-‴›‼⁆⁇-⁉]/,l.LabelTTF._lastWordRex=/([a-zA-Z0-9\-¿¡«À-ÖØ-öø-ʯ\u0300-\u034e\u0350-\u036FͰ-ԯ\u2011‵-‷‹⁅]+|\S)$/,l.LabelTTF._lastEnglish=/[a-zA-Z0-9\-¿¡«À-ÖØ-öø-ʯ\u0300-\u034e\u0350-\u036FͰ-ԯ\u2011‵-‷‹⁅]+$/,l.LabelTTF._firsrEnglish=/^[a-zA-Z0-9\-¿¡«À-ÖØ-öø-ʯ\u0300-\u034e\u0350-\u036FͰ-ԯ\u2011‵-‷‹⁅]/,function(){l.LabelTTF.RenderCmd=function(){this._fontClientHeight=18,this._fontStyleStr="",this._shadowColorStr="rgba(128, 128, 128, 0.5)",this._strokeColorStr="",this._fillColorStr="rgba(255,255,255,1)",this._labelCanvas=null,this._labelContext=null,this._lineWidths=[],this._strings=[],this._isMultiLine=!1,this._status=[],this._renderingIndex=0,this._canUseDirtyRegion=!0};var e=l.LabelTTF.RenderCmd.prototype;e.constructor=l.LabelTTF.RenderCmd,e._labelCmdCtor=l.LabelTTF.RenderCmd,e._setFontStyle=function(e,t,i,n){if(e instanceof l.FontDefinition)this._fontStyleStr=e._getCanvasFontStr(),this._fontClientHeight=l.LabelTTF.__getFontHeightByDiv(e);else{var s=t*l.view.getDevicePixelRatio();this._fontStyleStr=i+" "+n+" "+s+"px '"+e+"'",this._fontClientHeight=l.LabelTTF.__getFontHeightByDiv(e,t)}},e._getFontStyle=function(){return this._fontStyleStr},e._getFontClientHeight=function(){return this._fontClientHeight},e._updateColor=function(){this._setColorsString(),this._updateTexture()},e._setColorsString=function(){var e=this._displayedColor,t=this._node,i=t._shadowColor||this._displayedColor,n=t._strokeColor,s=t._textFillColor,r=e.r/255,a=e.g/255,o=e.b/255;this._shadowColorStr="rgba("+(0|r*i.r)+","+(0|a*i.g)+","+(0|o*i.b)+","+t._shadowOpacity+")",this._fillColorStr="rgba("+(0|r*s.r)+","+(0|a*s.g)+","+(0|o*s.b)+", 1)",this._strokeColorStr="rgba("+(0|r*n.r)+","+(0|a*n.g)+","+(0|o*n.b)+", 1)"};var t=new l.Rect;e.getLocalBB=function(){var e=this._node;t.x=t.y=0;var i=l.view.getDevicePixelRatio();return t.width=e._getWidth()*i,t.height=e._getHeight()*i,t},e._updateTTF=function(){var e,t,i=this._node,n=l.view.getDevicePixelRatio(),s=i._dimensions.width*n,r=this._lineWidths;r.length=0,this._isMultiLine=!1,this._measureConfig();var a={};if(0!==s)for(this._strings=i._string.split("\n"),e=0;e<this._strings.length;e++)this._checkWarp(this._strings,e,s);else for(this._strings=i._string.split("\n"),e=0,t=this._strings.length;e<t;e++)if(this._strings[e]){var o=this._measure(this._strings[e]);r.push(o),a[this._strings[e]]=o}else r.push(0);this._strings.length>1&&(this._isMultiLine=!0);var h,d=0,c=0;if(i._strokeEnabled&&(d=c=2*i._strokeSize),i._shadowEnabled){var u=i._shadowOffset;d+=2*Math.abs(u.x),c+=2*Math.abs(u.y)}0===s?this._isMultiLine?h=l.size(Math.ceil(Math.max.apply(Math,r)+d),Math.ceil(this._fontClientHeight*n*this._strings.length+c)):(!(o=a[i._string])&&i._string&&(o=this._measure(i._string)),h=l.size(Math.ceil((o||0)+d),Math.ceil(this._fontClientHeight*n+c))):h=0===i._dimensions.height?this._isMultiLine?l.size(Math.ceil(s+d),Math.ceil(i.getLineHeight()*n*this._strings.length+c)):l.size(Math.ceil(s+d),Math.ceil(i.getLineHeight()*n+c)):l.size(Math.ceil(s+d),Math.ceil(i._dimensions.height*n+c)),"normal"!==i._getFontStyle()&&(h.width=Math.ceil(h.width+.3*i._fontSize)),i.setContentSize(h),i._strokeShadowOffsetX=d,i._strokeShadowOffsetY=c;var p=i._anchorPoint;this._anchorPointInPoints.x=.5*d+(h.width-d)*p.x,this._anchorPointInPoints.y=.5*c+(h.height-c)*p.y},e._saveStatus=function(){var e=this._node,t=l.view.getDevicePixelRatio(),i=e._strokeShadowOffsetX,n=e._strokeShadowOffsetY,s=e._contentSize.height-n,r=e._vAlignment,a=e._hAlignment,o=.5*i,h=s+.5*n,d=0,c=0,u=[],p=e._contentSize.width-i,m=e.getLineHeight()*t,_=(m-this._fontClientHeight*t)/2;if(a===l.TEXT_ALIGNMENT_RIGHT?d+=p:a===l.TEXT_ALIGNMENT_CENTER?d+=p/2:d+=0,this._isMultiLine){var g=this._strings.length;r===l.VERTICAL_TEXT_ALIGNMENT_BOTTOM?c=m-2*_+s-m*g:r===l.VERTICAL_TEXT_ALIGNMENT_CENTER&&(c=(m-2*_)/2+(s-m*g)/2);for(var T=0;T<g;T++){var f=-s+(m*T+_)+c;u.push(f)}}else r===l.VERTICAL_TEXT_ALIGNMENT_BOTTOM||(r===l.VERTICAL_TEXT_ALIGNMENT_TOP?c-=s:c-=.5*s),u.push(c);var S={contextTransform:l.p(o,h),xOffset:d,OffsetYArray:u};this._status.push(S)},e._drawTTFInCanvas=function(e){if(e){var t=this._status.pop();e.setTransform(1,0,0,1,t.contextTransform.x,t.contextTransform.y);var i=t.xOffset,n=t.OffsetYArray;this.drawLabels(e,i,n)}},e._checkWarp=function(e,t,i){var n=e[t],s=this._measure(n);if(s>i&&n.length>1){for(var r,a=n.length*(i/s)|0,o=n.substr(a),h=s-this._measure(o),d=0,c=0;h>i&&c++<100;)a*=i/h,a|=0,o=n.substr(a),h=s-this._measure(o);for(c=0;h<i&&c++<100;){if(o){var u=l.LabelTTF._wordRex.exec(o);d=u?u[0].length:1,r=o}a+=d,o=n.substr(a),h=s-this._measure(o)}0===(a-=d)&&(a=1,r=r.substr(1));var p,m=n.substr(0,a);l.LabelTTF.wrapInspection&&l.LabelTTF._symbolRex.test(r||o)&&(0===(a-=(p=l.LabelTTF._lastWordRex.exec(m))?p[0].length:0)&&(a=1),r=n.substr(a),m=n.substr(0,a)),l.LabelTTF._firsrEnglish.test(r)&&(p=l.LabelTTF._lastEnglish.exec(m))&&m!==p[0]&&(a-=p[0].length,r=n.substr(a),m=n.substr(0,a)),e[t]=r||o,e.splice(t,0,m)}},e.updateStatus=function(){var e=l.Node._dirtyFlags;this._dirtyFlag&e.textDirty&&this._updateTexture(),this.originUpdateStatus()},e._syncStatus=function(e){var t=l.Node._dirtyFlags,i=this._dirtyFlag;i&t.textDirty&&this._updateTexture(),this._originSyncStatus(e),(l._renderType===l.game.RENDER_TYPE_WEBGL||i&t.transformDirty)&&this.transform(e)},e.drawLabels=function(e,t,i){var n=this._node;if(n._shadowEnabled){var s=n._shadowOffset;e.shadowColor=this._shadowColorStr,e.shadowOffsetX=s.x,e.shadowOffsetY=-s.y,e.shadowBlur=n._shadowBlur}var r=n._hAlignment,a=n._vAlignment,o=n._strokeSize;e.font!==this._fontStyleStr&&(e.font=this._fontStyleStr),e.fillStyle=this._fillColorStr;var h=n._strokeEnabled;h&&(e.lineWidth=2*o,e.strokeStyle=this._strokeColorStr),e.textBaseline=l.LabelTTF._textBaseline[a],e.textAlign=l.LabelTTF._textAlign[r];for(var d=this._strings.length,c=0;c<d;c++){var u=this._strings[c];h&&e.strokeText(u,t,i[c]),e.fillText(u,t,i[c])}l.g_NumberOfDraws++}}(),function(){l.LabelTTF.CacheRenderCmd=function(){this._labelCmdCtor();var e=this._labelCanvas=document.createElement("canvas");e.width=1,e.height=1,this._labelContext=e.getContext("2d")},l.LabelTTF.CacheRenderCmd.prototype=Object.create(l.LabelTTF.RenderCmd.prototype),l.inject(l.LabelTTF.RenderCmd.prototype,l.LabelTTF.CacheRenderCmd.prototype);var e=l.LabelTTF.CacheRenderCmd.prototype;e.constructor=l.LabelTTF.CacheRenderCmd,e._cacheCmdCtor=l.LabelTTF.CacheRenderCmd,e._updateTexture=function(){this._dirtyFlag=this._dirtyFlag&l.Node._dirtyFlags.textDirty^this._dirtyFlag;var e=this._node;e._needUpdateTexture=!1;var t=e._contentSize;this._updateTTF();var i=t.width,n=t.height,s=this._labelContext,r=this._labelCanvas;if(!e._texture){var a=new l.Texture2D;a.initWithElement(this._labelCanvas),e.setTexture(a)}if(0===e._string.length)return r.width=1,r.height=t.height||1,e._texture&&(e._texture._htmlElementObj=this._labelCanvas,e._texture.handleLoadedTexture()),e.setTextureRect(l.rect(0,0,1,t.height)),!0;s.font=this._fontStyleStr;var o=r.width===i&&r.height===n;return r.width=i,r.height=n,o&&s.clearRect(0,0,i,n),this._saveStatus(),this._drawTTFInCanvas(s),e._texture&&(e._texture._htmlElementObj=this._labelCanvas,e._texture.handleLoadedTexture()),e.setTextureRect(l.rect(0,0,i,n)),!0},e._measureConfig=function(){this._labelContext.font=this._fontStyleStr},e._measure=function(e){return e?this._labelContext.measureText(e).width:0}}(),function(){l.LabelTTF.CacheCanvasRenderCmd=function(e){this._spriteCmdCtor(e),this._cacheCmdCtor()};var e=l.LabelTTF.CacheCanvasRenderCmd.prototype=Object.create(l.Sprite.CanvasRenderCmd.prototype);l.inject(l.LabelTTF.CacheRenderCmd.prototype,e),e.constructor=l.LabelTTF.CacheCanvasRenderCmd}(),function(){l.LabelTTF.CanvasRenderCmd=function(e){this._spriteCmdCtor(e),this._labelCmdCtor()},l.LabelTTF.CanvasRenderCmd.prototype=Object.create(l.Sprite.CanvasRenderCmd.prototype),l.inject(l.LabelTTF.RenderCmd.prototype,l.LabelTTF.CanvasRenderCmd.prototype);var e=l.LabelTTF.CanvasRenderCmd.prototype;e.constructor=l.LabelTTF.CanvasRenderCmd,e._measureConfig=function(){},e._measure=function(e){if(e){var t=l._renderContext.getContext();return t.font=this._fontStyleStr,t.measureText(e).width}return 0},e._updateTexture=function(){this._dirtyFlag=this._dirtyFlag&l.Node._dirtyFlags.textDirty^this._dirtyFlag;var e=this._node,t=e._contentSize;this._updateTTF();var i=t.width,n=t.height;return 0===e._string.length?(e.setTextureRect(l.rect(0,0,1,t.height)),!0):(this._saveStatus(),e.setTextureRect(l.rect(0,0,i,n)),!0)},e.rendering=function(e){var t=l.view.getScaleX(),i=l.view.getScaleY(),n=e||l._renderContext,s=n.getContext();if(s){var r=this._node;if(n.computeRealOffsetY(),!(this._status.length<=0)){var a=this._renderingIndex>=this._status.length?this._renderingIndex-this._status.length:this._renderingIndex,o=this._status[a];this._renderingIndex=a+1;var h=r._rect.height,d=r._offsetPosition.x,c=-r._offsetPosition.y-h,u=this._displayedOpacity/255;n.setTransform(this._worldTransform,t,i),n.setCompositeOperation(this._blendFuncStr),n.setGlobalAlpha(u),n.save(),r._flippedX&&(d=-d-r._rect.width,s.scale(-1,1)),r._flippedY&&(c=r._offsetPosition.y,s.scale(1,-1));for(var p=o.xOffset+o.contextTransform.x+d*t,m=[],_=this._strings.length,g=0;g<_;g++)m.push(o.OffsetYArray[g]+o.contextTransform.y+c*i);this.drawLabels(s,p,m),n.restore()}}}}(),function(){l.LabelTTF.WebGLRenderCmd=function(e){this._spriteCmdCtor(e),this._cacheCmdCtor()};var e=l.LabelTTF.WebGLRenderCmd.prototype=Object.create(l.Sprite.WebGLRenderCmd.prototype);l.inject(l.LabelTTF.CacheRenderCmd.prototype,e),e.constructor=l.LabelTTF.WebGLRenderCmd,e._updateColor=function(){}}(),l.HashElement=function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.paused=!1,this.lock=!1},l.ActionManager=l.Class.extend({_elementPool:[],_searchElementByTarget:function(e,t){for(var i=0;i<e.length;i++)if(t===e[i].target)return e[i];return null},ctor:function(){this._hashTargets={},this._arrayTargets=[],this._currentTarget=null},_getElement:function(e,t){var i=this._elementPool.pop();return i||(i=new l.HashElement),i.target=e,i.paused=!!t,i},_putElement:function(e){e.actions.length=0,e.actionIndex=0,e.currentAction=null,e.paused=!1,e.target=null,e.lock=!1,this._elementPool.push(e)},addAction:function(e,t,i){if(!e)throw new Error("cc.ActionManager.addAction(): action must be non-null");if(!t)throw new Error("cc.ActionManager.addAction(): action must be non-null");var n=this._hashTargets[t.__instanceId];n?n.actions||(n.actions=[]):(n=this._getElement(t,i),this._hashTargets[t.__instanceId]=n,this._arrayTargets.push(n)),n.actions.push(e),e.startWithTarget(t)},removeAllActions:function(){for(var e=this._arrayTargets,t=0;t<e.length;t++){var i=e[t];i&&this.removeAllActionsFromTarget(i.target,!0)}},removeAllActionsFromTarget:function(e,t){if(null!=e){var i=this._hashTargets[e.__instanceId];i&&(i.actions.length=0,this._deleteHashElement(i))}},removeAction:function(e){if(null!=e){var t=e.getOriginalTarget(),i=this._hashTargets[t.__instanceId];if(i){for(var n=0;n<i.actions.length;n++)if(i.actions[n]===e){i.actions.splice(n,1),i.actionIndex>=n&&i.actionIndex--;break}}else l.log(l._LogInfos.ActionManager_removeAction)}},removeActionByTag:function(e,t){e===l.ACTION_TAG_INVALID&&l.log(l._LogInfos.ActionManager_addAction),l.assert(t,l._LogInfos.ActionManager_addAction);var i=this._hashTargets[t.__instanceId];if(i)for(var n=i.actions.length,s=0;s<n;++s){var r=i.actions[s];if(r&&r.getTag()===e&&r.getOriginalTarget()===t){this._removeActionAtIndex(s,i);break}}},getActionByTag:function(e,t){e===l.ACTION_TAG_INVALID&&l.log(l._LogInfos.ActionManager_getActionByTag);var i=this._hashTargets[t.__instanceId];if(i){if(null!=i.actions)for(var n=0;n<i.actions.length;++n){var s=i.actions[n];if(s&&s.getTag()===e)return s}l.log(l._LogInfos.ActionManager_getActionByTag_2,e)}return null},numberOfRunningActionsInTarget:function(e){var t=this._hashTargets[e.__instanceId];return t&&t.actions?t.actions.length:0},pauseTarget:function(e){var t=this._hashTargets[e.__instanceId];t&&(t.paused=!0)},resumeTarget:function(e){var t=this._hashTargets[e.__instanceId];t&&(t.paused=!1)},pauseAllRunningActions:function(){for(var e=[],t=this._arrayTargets,i=0;i<t.length;i++){var n=t[i];n&&!n.paused&&(n.paused=!0,e.push(n.target))}return e},resumeTargets:function(e){if(e)for(var t=0;t<e.length;t++)e[t]&&this.resumeTarget(e[t])},purgeSharedManager:function(){l.director.getScheduler().unscheduleUpdate(this)},_removeActionAtIndex:function(e,t){t.actions[e];t.actions.splice(e,1),t.actionIndex>=e&&t.actionIndex--,0===t.actions.length&&this._deleteHashElement(t)},_deleteHashElement:function(e){var t=!1;if(e&&!e.lock&&this._hashTargets[e.target.__instanceId]){delete this._hashTargets[e.target.__instanceId];for(var i=this._arrayTargets,n=0,s=i.length;n<s;n++)if(i[n]===e){i.splice(n,1);break}this._putElement(e),t=!0}return t},update:function(e){for(var t,i=l.director.getScheduler().isWaite,n=this._arrayTargets,s=0;s<n.length;s++){if(this._currentTarget=n[s],!(t=this._currentTarget).paused&&t.actions){for(t.lock=!0,t.actionIndex=0;t.actionIndex<t.actions.length;t.actionIndex++)if(t.currentAction=t.actions[t.actionIndex],t.currentAction){if((!i||t.currentAction.getTag()<2)&&t.currentAction.step(e*(t.currentAction._speedMethod?t.currentAction._speed:1)),t.currentAction&&t.currentAction.isDone()){t.currentAction.stop();var r=t.currentAction;t.currentAction=null,this.removeAction(r)}t.currentAction=null}t.lock=!1}0===t.actions.length&&this._deleteHashElement(t)&&s--}}}),l.profiler=function(){var e=!1,t=!1,i=0,n=0,s=0,r=0,a=null,o=document.createElement("div"),h=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),u=10,p=[0,10,20,30],m=[0,0,0,0],_=3,g=0,T=0;c.id="fps",c.style.position="absolute",c.style.padding="3px",c.style.textAlign="left",c.style.backgroundColor="rgb(0, 0, 34)",c.style.bottom=l.DIRECTOR_STATS_POSITION.y+"0px",c.style.left=l.DIRECTOR_STATS_POSITION.x+"px",c.style.width="45px",c.style.height="80px";for(var f=[d,h,o],S=0;S<3;++S){var w=f[S].style;w.color="rgb(0, 255, 255)",w.font="bold 12px Helvetica, Arial",w.lineHeight="20px",w.width="100%",c.appendChild(f[S])}var v=function(e){var t=p.length-1,i=t,n=0;for(g++,T+=e;i>=0;i--)if(e>=p[i]){m[i]++;break}if(g>=u){for(n=T/u,i=t;i>0;i--)if(m[i]/u>=.6&&n>=p[i]){i!=_&&(_=i,M.onFrameRateChange&&M.onFrameRateChange(n.toFixed(2)));break}for(_changeCount=0,g=0,T=0,i=t;i>0;i--)m[i]=0}},L=function(){if(s=l.director.getSecondsPerFrame(),i++,(r+=l.director.getDeltaTime())>l.DIRECTOR_FPS_INTERVAL&&(n=i/r,i=0,r=0,M.onFrameRateChange&&v(n),e)){var t=l._renderType===l.game.RENDER_TYPE_CANVAS?"\n canvas":"\n webgl";h.innerHTML=s.toFixed(3),o.innerHTML=n.toFixed(1).toString()+t,d.innerHTML=(0|l.g_NumberOfDraws).toString()}},M={onFrameRateChange:null,getSecondsPerFrame:function(){return s},getFrameRate:function(){return n},setProfileDuration:function(e){!isNaN(e)&&e>0&&(u=e/l.DIRECTOR_FPS_INTERVAL)},resumeProfiling:function(){l.eventManager.addListener(a,1)},stopProfiling:function(){l.eventManager.removeListener(a)},isShowingStats:function(){return e},showStats:function(){t||this.init(),null===c.parentElement&&l.container.appendChild(c),e=!0},hideStats:function(){e=!1,c.parentElement===l.container&&l.container.removeChild(c)},init:function(){t||(a=l.eventManager.addCustomListener(l.Director.EVENT_AFTER_VISIT,L),t=!0)}};return M}(),l.ACTION_TAG_INVALID=-1,l.Action=l.Class.extend({originalTarget:null,target:null,tag:l.ACTION_TAG_INVALID,ctor:function(){this.originalTarget=null,this.target=null,this.tag=l.ACTION_TAG_INVALID},copy:function(){return l.log("copy is deprecated. Please use clone instead."),this.clone()},clone:function(){var e=new l.Action;return e.originalTarget=null,e.target=null,e.tag=this.tag,e},isDone:function(){return!0},startWithTarget:function(e){this.originalTarget=e,this.target=e},stop:function(){this.target=null},step:function(e){l.log("[Action step]. override me")},update:function(e){l.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(e){this.target=e},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(e){this.originalTarget=e},getTag:function(){return this.tag},setTag:function(e){this.tag=e},retain:function(){},release:function(){}}),l.action=function(){return new l.Action},l.Action.create=l.action,l.FiniteTimeAction=l.Action.extend({_duration:0,ctor:function(){l.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(e){this._duration=e},reverse:function(){return l.log("cocos2d: FiniteTimeAction#reverse: Implement me"),null},clone:function(){return new l.FiniteTimeAction}}),l.Speed=l.Action.extend({_speed:0,_innerAction:null,ctor:function(e,t){l.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,e&&this.initWithAction(e,t)},getSpeed:function(){return this._speed},setSpeed:function(e){this._speed=e},initWithAction:function(e,t){if(!e)throw new Error("cc.Speed.initWithAction(): action must be non nil");return this._innerAction=e,this._speed=t,!0},clone:function(){var e=new l.Speed;return e.initWithAction(this._innerAction.clone(),this._speed),e},startWithTarget:function(e){l.Action.prototype.startWithTarget.call(this,e),this._innerAction.startWithTarget(e)},stop:function(){this._innerAction.stop(),l.Action.prototype.stop.call(this)},step:function(e){this._innerAction.step(e*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new l.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(e){this._innerAction!==e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}}),l.speed=function(e,t){return new l.Speed(e,t)},l.Speed.create=l.speed,l.Follow=l.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(e,t){l.Action.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=l.rect(0,0,0,0),e&&(t?this.initWithTarget(e,t):this.initWithTarget(e))},clone:function(){var e=new l.Follow,t=this._worldRect,i=new l.Rect(t.x,t.y,t.width,t.height);return e.initWithTarget(this._followedNode,i),e},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(e){this._boundarySet=e},initWithTarget:function(e,t){if(!e)throw new Error("cc.Follow.initWithAction(): followedNode must be non nil");var i=this;t=t||l.rect(0,0,0,0),i._followedNode=e,i._worldRect=t,i._boundarySet=!l._rectEqualToZero(t),i._boundaryFullyCovered=!1;var n=l.director.getWinSize();return i._fullScreenSize=l.p(n.width,n.height),i._halfScreenSize=l.pMult(i._fullScreenSize,.5),i._boundarySet&&(i.leftBoundary=-(t.x+t.width-i._fullScreenSize.x),i.rightBoundary=-t.x,i.topBoundary=-t.y,i.bottomBoundary=-(t.y+t.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary&&(i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2),i.topBoundary<i.bottomBoundary&&(i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2),i.topBoundary===i.bottomBoundary&&i.leftBoundary===i.rightBoundary&&(i._boundaryFullyCovered=!0)),!0},step:function(e){var t=this._followedNode.x,i=this._followedNode.y;if(t=this._halfScreenSize.x-t,i=this._halfScreenSize.y-i,this.target._renderCmd._dirtyFlag=0,this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(l.clampf(t,this.leftBoundary,this.rightBoundary),l.clampf(i,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(t,i)},isDone:function(){return!this._followedNode.running},stop:function(){this.target=null,l.Action.prototype.stop.call(this)}}),l.follow=function(e,t){return new l.Follow(e,t)},l.Follow.create=l.follow,l.ActionInterval=l.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(e){this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this.MAX_VALUE=2,this._repeatMethod=!1,this._speedMethod=!1,l.FiniteTimeAction.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(e)},getElapsed:function(){return this._elapsed},initWithDuration:function(e){return this._duration=0===e?l.FLT_EPSILON:e,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(e){e._repeatForever=this._repeatForever,e._speed=this._speed,e._timesForRepeat=this._timesForRepeat,e._easeList=this._easeList,e._speedMethod=this._speedMethod,e._repeatMethod=this._repeatMethod},_reverseEaseList:function(e){if(this._easeList){e._easeList=[];for(var t=0;t<this._easeList.length;t++)e._easeList.push(this._easeList[t].reverse())}},clone:function(){var e=new l.ActionInterval(this._duration);return this._cloneDecoration(e),e},easing:function(e){this._easeList?this._easeList.length=0:this._easeList=[];for(var t=0;t<arguments.length;t++)this._easeList.push(arguments[t]);return this},_computeEaseTime:function(e){var t=this._easeList;if(!t||0===t.length)return e;for(var i=0,n=t.length;i<n;i++)e=t[i].easing(e);return e},step:function(e){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=e;var t=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);t=1>t?t:1,this.update(t>0?t:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(e){l.Action.prototype.startWithTarget.call(this,e),this._elapsed=0,this._firstTick=!0},reverse:function(){return l.log("cc.IntervalAction: reverse not implemented."),null},setAmplitudeRate:function(e){l.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")},getAmplitudeRate:function(){return l.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass."),0},speed:function(e){return e<=0?(l.log("The speed parameter error"),this):(this._speedMethod=!0,this._speed*=e,this)},getSpeed:function(){return this._speed},setSpeed:function(e){return this._speed=e,this},repeat:function(e){return e=Math.round(e),isNaN(e)||e<1?(l.log("The repeat parameter error"),this):(this._repeatMethod=!0,this._timesForRepeat*=e,this)},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),l.actionInterval=function(e){return new l.ActionInterval(e)},l.ActionInterval.create=l.actionInterval,l.Sequence=l.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(e){l.ActionInterval.prototype.ctor.call(this),this._actions=[];var t=e instanceof Array?e:arguments,i=t.length-1;if(i>=0&&null==t[i]&&l.log("parameters should not be ending with null in Javascript"),i>=0){for(var n,s=t[0],r=1;r<i;r++)t[r]&&(n=s,s=l.Sequence._actionOneTwo(n,t[r]));this.initWithTwoActions(s,t[i])}},initWithTwoActions:function(e,t){if(!e||!t)throw new Error("cc.Sequence.initWithTwoActions(): arguments must all be non nil");var i=e._duration+t._duration;return this.initWithDuration(i),this._actions[0]=e,this._actions[1]=t,!0},clone:function(){var e=new l.Sequence;return this._cloneDecoration(e),e.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._split=this._actions[0]._duration/this._duration,this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop(),l.Action.prototype.stop.call(this)},update:function(e){var t,i,n=0,s=this._split,r=this._actions,a=this._last;(e=this._computeEaseTime(e))<s?(t=0!==s?e/s:1,0===n&&1===a&&(r[1].update(0),r[1].stop())):(n=1,t=1===s?1:(e-s)/(1-s),-1===a&&(r[0].startWithTarget(this.target),r[0].update(1),r[0].stop()),a||(r[0].update(1),r[0].stop())),i=r[n],a===n&&i.isDone()||(a!==n&&i.startWithTarget(this.target),t*=i._timesForRepeat,i.update(t>1?t%1:t),this._last=n)},reverse:function(){var e=l.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e}}),l.sequence=function(e){var t=e instanceof Array?e:arguments;t.length>0&&null==t[t.length-1]&&l.log("parameters should not be ending with null in Javascript");for(var i,n,s,r;t&&t.length>0;)for(r=(n=Array.prototype.shift.call(t))._timesForRepeat||1,n._repeatMethod=!1,n._timesForRepeat=1,s=0,i||(i=n,s=1),s;s<r;s++)i=l.Sequence._actionOneTwo(i,n);return i},l.Sequence.create=l.sequence,l.Sequence._actionOneTwo=function(e,t){var i=new l.Sequence;return i.initWithTwoActions(e,t),i},l.Repeat=l.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(e,t){l.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithAction(e,t)},initWithAction:function(e,t){var i=e._duration*t;return!!this.initWithDuration(i)&&(this._times=t,this._innerAction=e,e instanceof l.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0)},clone:function(){var e=new l.Repeat;return this._cloneDecoration(e),e.initWithAction(this._innerAction.clone(),this._times),e},startWithTarget:function(e){this._total=0,this._nextDt=this._innerAction._duration/this._duration,l.ActionInterval.prototype.startWithTarget.call(this,e),this._innerAction.startWithTarget(e)},stop:function(){this._innerAction.stop(),l.Action.prototype.stop.call(this)},update:function(e){e=this._computeEaseTime(e);var t=this._innerAction,i=this._duration,n=this._times,s=this._nextDt;if(e>=s){for(;e>s&&this._total<n;)t.update(1),this._total++,t.stop(),t.startWithTarget(this.target),s+=t._duration/i,this._nextDt=s;e>=1&&this._total<n&&this._total++,this._actionInstant||(this._total===n?(t.update(1),t.stop()):t.update(e-(s-t._duration/i)))}else t.update(e*n%1)},isDone:function(){return this._total===this._times},reverse:function(){var e=new l.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(e),this._reverseEaseList(e),e},setInnerAction:function(e){this._innerAction!==e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}}),l.repeat=function(e,t){return new l.Repeat(e,t)},l.Repeat.create=l.repeat,l.RepeatForever=l.ActionInterval.extend({_innerAction:null,ctor:function(e){l.ActionInterval.prototype.ctor.call(this),this._innerAction=null,e&&this.initWithAction(e)},initWithAction:function(e){if(!e)throw new Error("cc.RepeatForever.initWithAction(): action must be non null");return this._innerAction=e,!0},clone:function(){var e=new l.RepeatForever;return this._cloneDecoration(e),e.initWithAction(this._innerAction.clone()),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._innerAction.startWithTarget(e)},step:function(e){var t=this._innerAction;t.step(e),t.isDone()&&(t.startWithTarget(this.target),t.step(t.getElapsed()-t._duration))},isDone:function(){return!1},reverse:function(){var e=new l.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e},setInnerAction:function(e){this._innerAction!==e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}}),l.repeatForever=function(e){return new l.RepeatForever(e)},l.RepeatForever.create=l.repeatForever,l.Spawn=l.ActionInterval.extend({_one:null,_two:null,ctor:function(e){l.ActionInterval.prototype.ctor.call(this),this._one=null,this._two=null;var t,i,n;if(e instanceof Array)i=e;else for(i=new Array(arguments.length),t=0;t<arguments.length;++t)i[t]=arguments[t];if((n=i.length-1)>=0&&null==i[n]&&l.log("parameters should not be ending with null in Javascript"),n>=0){var s,r=i[0];for(t=1;t<n;t++)i[t]&&(s=r,r=l.Spawn._actionOneTwo(s,i[t]));this.initWithTwoActions(r,i[n])}},initWithTwoActions:function(e,t){if(!e||!t)throw new Error("cc.Spawn.initWithTwoActions(): arguments must all be non null");var i=!1,n=e._duration,s=t._duration;return this.initWithDuration(Math.max(n,s))&&(this._one=e,this._two=t,n>s?this._two=l.Sequence._actionOneTwo(t,l.delayTime(n-s)):n<s&&(this._one=l.Sequence._actionOneTwo(e,l.delayTime(s-n))),i=!0),i},clone:function(){var e=new l.Spawn;return this._cloneDecoration(e),e.initWithTwoActions(this._one.clone(),this._two.clone()),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._one.startWithTarget(e),this._two.startWithTarget(e)},stop:function(){this._one.stop(),this._two.stop(),l.Action.prototype.stop.call(this)},update:function(e){e=this._computeEaseTime(e),this._one&&this._one.update(e),this._two&&this._two.update(e)},reverse:function(){var e=l.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e}}),l.spawn=function(e){var t=e instanceof Array?e:arguments;t.length>0&&null==t[t.length-1]&&l.log("parameters should not be ending with null in Javascript");for(var i=t[0],n=1;n<t.length;n++)null!=t[n]&&(i=l.Spawn._actionOneTwo(i,t[n]));return i},l.Spawn.create=l.spawn,l.Spawn._actionOneTwo=function(e,t){var i=new l.Spawn;return i.initWithTwoActions(e,t),i},l.RotateTo=l.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(e,t,i){l.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._dstAngleX=t||0,this._dstAngleY=void 0!==i?i:this._dstAngleX,!0)},clone:function(){var e=new l.RotateTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.rotationX%360,i=this._dstAngleX-t;i>180&&(i-=360),i<-180&&(i+=360),this._startAngleX=t,this._diffAngleX=i,this._startAngleY=e.rotationY%360;var n=this._dstAngleY-this._startAngleY;n>180&&(n-=360),n<-180&&(n+=360),this._diffAngleY=n},reverse:function(){l.log("cc.RotateTo.reverse(): it should be overridden in subclass.")},update:function(e){e=this._computeEaseTime(e),this.target&&(this.target.rotationX=this._startAngleX+this._diffAngleX*e,this.target.rotationY=this._startAngleY+this._diffAngleY*e)}}),l.rotateTo=function(e,t,i){return new l.RotateTo(e,t,i)},l.RotateTo.create=l.rotateTo,l.RotateBy=l.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(e,t,i){l.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._angleX=t||0,this._angleY=i||this._angleX,!0)},clone:function(){var e=new l.RotateBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._angleX,this._angleY),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._startAngleX=e.rotationX,this._startAngleY=e.rotationY},update:function(e){e=this._computeEaseTime(e),this.target&&(this.target.rotationX=this._startAngleX+this._angleX*e,this.target.rotationY=this._startAngleY+this._angleY*e)},reverse:function(){var e=new l.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),l.rotateBy=function(e,t,i){return new l.RotateBy(e,t,i)},l.RotateBy.create=l.rotateBy,l.MoveBy=l.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(e,t,i){l.ActionInterval.prototype.ctor.call(this),this._positionDelta=l.p(0,0),this._startPosition=l.p(0,0),this._previousPosition=l.p(0,0),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(void 0!==t.x&&(i=t.y,t=t.x),this._positionDelta.x=t,this._positionDelta.y=i,!0)},clone:function(){var e=new l.MoveBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._positionDelta),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.getPositionX(),i=e.getPositionY();this._previousPosition.x=t,this._previousPosition.y=i,this._startPosition.x=t,this._startPosition.y=i},update:function(e){if(e=this._computeEaseTime(e),this.target){var t=this._positionDelta.x*e,i=this._positionDelta.y*e,n=this._startPosition;if(l.ENABLE_STACKABLE_ACTIONS){var s=this.target.getPositionX(),r=this.target.getPositionY(),a=this._previousPosition;n.x=n.x+s-a.x,n.y=n.y+r-a.y,t+=n.x,i+=n.y,a.x=t,a.y=i,this.target.setPosition(t,i)}else this.target.setPosition(n.x+t,n.y+i)}},reverse:function(){var e=new l.MoveBy(this._duration,l.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(e),this._reverseEaseList(e),e}}),l.moveBy=function(e,t,i){return new l.MoveBy(e,t,i)},l.MoveBy.create=l.moveBy,l.MoveTo=l.MoveBy.extend({_endPosition:null,ctor:function(e,t,i){l.MoveBy.prototype.ctor.call(this),this._endPosition=l.p(0,0),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!l.MoveBy.prototype.initWithDuration.call(this,e,t,i)&&(void 0!==t.x&&(i=t.y,t=t.x),this._endPosition.x=t,this._endPosition.y=i,!0)},clone:function(){var e=new l.MoveTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endPosition),e},startWithTarget:function(e){l.MoveBy.prototype.startWithTarget.call(this,e),this._positionDelta.x=this._endPosition.x-e.getPositionX(),this._positionDelta.y=this._endPosition.y-e.getPositionY()}}),l.moveTo=function(e,t,i){return new l.MoveTo(e,t,i)},l.MoveTo.create=l.moveTo,l.SkewTo=l.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(e,t,i){l.ActionInterval.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){var n=!1;return l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._endSkewX=t,this._endSkewY=i,n=!0),n},clone:function(){var e=new l.SkewTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endSkewX,this._endSkewY),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._startSkewX=e.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=e.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(e){e=this._computeEaseTime(e),this.target.skewX=this._startSkewX+this._deltaX*e,this.target.skewY=this._startSkewY+this._deltaY*e}}),l.skewTo=function(e,t,i){return new l.SkewTo(e,t,i)},l.SkewTo.create=l.skewTo,l.SkewBy=l.SkewTo.extend({ctor:function(e,t,i){l.SkewTo.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){var n=!1;return l.SkewTo.prototype.initWithDuration.call(this,e,t,i)&&(this._skewX=t,this._skewY=i,n=!0),n},clone:function(){var e=new l.SkewBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._skewX,this._skewY),e},startWithTarget:function(e){l.SkewTo.prototype.startWithTarget.call(this,e),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var e=new l.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),l.skewBy=function(e,t,i){return new l.SkewBy(e,t,i)},l.SkewBy.create=l.skewBy,l.JumpBy=l.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(e,t,i,n,s){l.ActionInterval.prototype.ctor.call(this),this._startPosition=l.p(0,0),this._previousPosition=l.p(0,0),this._delta=l.p(0,0),void 0!==n&&this.initWithDuration(e,t,i,n,s)},initWithDuration:function(e,t,i,n,s){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(void 0===s&&(s=n,n=i,i=t.y,t=t.x),this._delta.x=t,this._delta.y=i,this._height=n,this._jumps=s,!0)},clone:function(){var e=new l.JumpBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._delta,this._height,this._jumps),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.getPositionX(),i=e.getPositionY();this._previousPosition.x=t,this._previousPosition.y=i,this._startPosition.x=t,this._startPosition.y=i},update:function(e){if(e=this._computeEaseTime(e),this.target){var t=e*this._jumps%1,i=4*this._height*t*(1-t);i+=this._delta.y*e;var n=this._delta.x*e,s=this._startPosition;if(l.ENABLE_STACKABLE_ACTIONS){var r=this.target.getPositionX(),a=this.target.getPositionY(),o=this._previousPosition;s.x=s.x+r-o.x,s.y=s.y+a-o.y,n+=s.x,i+=s.y,o.x=n,o.y=i,this.target.setPosition(n,i)}else this.target.setPosition(s.x+n,s.y+i)}},reverse:function(){var e=new l.JumpBy(this._duration,l.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),l.jumpBy=function(e,t,i,n,s){return new l.JumpBy(e,t,i,n,s)},l.JumpBy.create=l.jumpBy,l.JumpTo=l.JumpBy.extend({_endPosition:null,ctor:function(e,t,i,n,s){l.JumpBy.prototype.ctor.call(this),this._endPosition=l.p(0,0),void 0!==n&&this.initWithDuration(e,t,i,n,s)},initWithDuration:function(e,t,i,n,s){return!!l.JumpBy.prototype.initWithDuration.call(this,e,t,i,n,s)&&(void 0===s&&(i=t.y,t=t.x),this._endPosition.x=t,this._endPosition.y=i,!0)},startWithTarget:function(e){l.JumpBy.prototype.startWithTarget.call(this,e),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var e=new l.JumpTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),e}}),l.jumpTo=function(e,t,i,n,s){return new l.JumpTo(e,t,i,n,s)},l.JumpTo.create=l.jumpTo,l.bezierAt=function(e,t,i,n,s){return Math.pow(1-s,3)*e+3*s*Math.pow(1-s,2)*t+3*Math.pow(s,2)*(1-s)*i+Math.pow(s,3)*n},l.BezierBy=l.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(e,t){l.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=l.p(0,0),this._previousPosition=l.p(0,0),t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._config=t,!0)},clone:function(){var e=new l.BezierBy;this._cloneDecoration(e);for(var t=[],i=0;i<this._config.length;i++){var n=this._config[i];t.push(l.p(n.x,n.y))}return e.initWithDuration(this._duration,t),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.getPositionX(),i=e.getPositionY();this._previousPosition.x=t,this._previousPosition.y=i,this._startPosition.x=t,this._startPosition.y=i},update:function(e){if(e=this._computeEaseTime(e),this.target){var t=this._config,i=t[0].x,n=t[1].x,s=t[2].x,r=t[0].y,a=t[1].y,o=t[2].y,h=l.bezierAt(0,i,n,s,e),d=l.bezierAt(0,r,a,o,e),c=this._startPosition;if(l.ENABLE_STACKABLE_ACTIONS){var u=this.target.getPositionX(),p=this.target.getPositionY(),m=this._previousPosition;c.x=c.x+u-m.x,c.y=c.y+p-m.y,h+=c.x,d+=c.y,m.x=h,m.y=d,this.target.setPosition(h,d)}else this.target.setPosition(c.x+h,c.y+d)}},reverse:function(){var e=this._config,t=[l.pAdd(e[1],l.pNeg(e[2])),l.pAdd(e[0],l.pNeg(e[2])),l.pNeg(e[2])],i=new l.BezierBy(this._duration,t);return this._cloneDecoration(i),this._reverseEaseList(i),i}}),l.bezierBy=function(e,t){return new l.BezierBy(e,t)},l.BezierBy.create=l.bezierBy,l.BezierTo=l.BezierBy.extend({_toConfig:null,ctor:function(e,t){l.BezierBy.prototype.ctor.call(this),this._toConfig=[],t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._toConfig=t,!0)},clone:function(){var e=new l.BezierTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toConfig),e},startWithTarget:function(e){l.BezierBy.prototype.startWithTarget.call(this,e);var t=this._startPosition,i=this._toConfig,n=this._config;n[0]=l.pSub(i[0],t),n[1]=l.pSub(i[1],t),n[2]=l.pSub(i[2],t)}}),l.bezierTo=function(e,t){return new l.BezierTo(e,t)},l.BezierTo.create=l.bezierTo,l.ScaleTo=l.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(e,t,i){l.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._endScaleX=t,this._endScaleY=null!=i?i:t,!0)},clone:function(){var e=new l.ScaleTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endScaleX,this._endScaleY),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._startScaleX=e.scaleX,this._startScaleY=e.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(e){e=this._computeEaseTime(e),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*e,this.target.scaleY=this._startScaleY+this._deltaY*e)}}),l.scaleTo=function(e,t,i){return new l.ScaleTo(e,t,i)},l.ScaleTo.create=l.scaleTo,l.ScaleBy=l.ScaleTo.extend({startWithTarget:function(e){l.ScaleTo.prototype.startWithTarget.call(this,e),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var e=new l.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new l.ScaleBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endScaleX,this._endScaleY),e}}),l.scaleBy=function(e,t,i){return new l.ScaleBy(e,t,i)},l.ScaleBy.create=l.scaleBy,l.Blink=l.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(e,t){l.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._times=t,!0)},clone:function(){var e=new l.Blink;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._times),e},update:function(e){if(e=this._computeEaseTime(e),this.target&&!this.isDone()){var t=1/this._times,i=e%t;this.target.visible=i>t/2}},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._originalState=e.visible},stop:function(){this.target.visible=this._originalState,l.ActionInterval.prototype.stop.call(this)},reverse:function(){var e=new l.Blink(this._duration,this._times);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),l.blink=function(e,t){return new l.Blink(e,t)},l.Blink.create=l.blink,l.FadeTo=l.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(e,t){l.ActionInterval.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._toOpacity=t,!0)},clone:function(){var e=new l.FadeTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toOpacity),e},update:function(e){e=this._computeEaseTime(e);var t=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=t+(this._toOpacity-t)*e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._fromOpacity=e.opacity}}),l.fadeTo=function(e,t){return new l.FadeTo(e,t)},l.FadeTo.create=l.fadeTo,l.FadeIn=l.FadeTo.extend({_reverseAction:null,ctor:function(e){l.FadeTo.prototype.ctor.call(this),null==e&&(e=0),this.initWithDuration(e,255)},reverse:function(){var e=new l.FadeOut;return e.initWithDuration(this._duration,0),this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new l.FadeIn;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toOpacity),e},startWithTarget:function(e){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),l.FadeTo.prototype.startWithTarget.call(this,e)}}),l.fadeIn=function(e){return new l.FadeIn(e)},l.FadeIn.create=l.fadeIn,l.FadeOut=l.FadeTo.extend({ctor:function(e){l.FadeTo.prototype.ctor.call(this),null==e&&(e=0),this.initWithDuration(e,0)},reverse:function(){var e=new l.FadeIn;return e._reverseAction=this,e.initWithDuration(this._duration,255),this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new l.FadeOut;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toOpacity),e}}),l.fadeOut=function(e){return new l.FadeOut(e)},l.FadeOut.create=l.fadeOut,l.TintTo=l.ActionInterval.extend({_to:null,_from:null,ctor:function(e,t,i,n){l.ActionInterval.prototype.ctor.call(this),this._to=l.color(0,0,0),this._from=l.color(0,0,0),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=l.color(t,i,n),!0)},clone:function(){var e=new l.TintTo;this._cloneDecoration(e);var t=this._to;return e.initWithDuration(this._duration,t.r,t.g,t.b),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._from=this.target.color},update:function(e){e=this._computeEaseTime(e);var t=this._from,i=this._to;t&&this.target.setColor(l.color(t.r+(i.r-t.r)*e,t.g+(i.g-t.g)*e,t.b+(i.b-t.b)*e))}}),l.tintTo=function(e,t,i,n){return new l.TintTo(e,t,i,n)},l.TintTo.create=l.tintTo,l.TintBy=l.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(e,t,i,n){l.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._deltaR=t,this._deltaG=i,this._deltaB=n,!0)},clone:function(){var e=new l.TintBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.color;this._fromR=t.r,this._fromG=t.g,this._fromB=t.b},update:function(e){e=this._computeEaseTime(e),this.target.color=l.color(this._fromR+this._deltaR*e,this._fromG+this._deltaG*e,this._fromB+this._deltaB*e)},reverse:function(){var e=new l.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),l.tintBy=function(e,t,i,n){return new l.TintBy(e,t,i,n)},l.TintBy.create=l.tintBy,l.DelayTime=l.ActionInterval.extend({update:function(e){},reverse:function(){var e=new l.DelayTime(this._duration);return this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new l.DelayTime;return this._cloneDecoration(e),e.initWithDuration(this._duration),e}}),l.delayTime=function(e){return new l.DelayTime(e)},l.DelayTime.create=l.delayTime,l.ReverseTime=l.ActionInterval.extend({_other:null,ctor:function(e){l.ActionInterval.prototype.ctor.call(this),this._other=null,e&&this.initWithAction(e)},initWithAction:function(e){if(!e)throw new Error("cc.ReverseTime.initWithAction(): action must be non null");if(e===this._other)throw new Error("cc.ReverseTime.initWithAction(): the action was already passed in.");return!!l.ActionInterval.prototype.initWithDuration.call(this,e._duration)&&(this._other=e,!0)},clone:function(){var e=new l.ReverseTime;return this._cloneDecoration(e),e.initWithAction(this._other.clone()),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._other.startWithTarget(e)},update:function(e){e=this._computeEaseTime(e),this._other&&this._other.update(1-e)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),l.Action.prototype.stop.call(this)}}),l.reverseTime=function(e){return new l.ReverseTime(e)},l.ReverseTime.create=l.reverseTime,l.Animate=l.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,_currFrameIndex:0,ctor:function(e){l.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],e&&this.initWithAnimation(e)},getAnimation:function(){return this._animation},setAnimation:function(e){this._animation=e},getCurrentFrameIndex:function(){return this._currFrameIndex},initWithAnimation:function(e){if(!e)throw new Error("cc.Animate.initWithAnimation(): animation must be non-NULL");var t=e.getDuration();if(this.initWithDuration(t*e.getLoops())){this._nextFrame=0,this.setAnimation(e),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes;i.length=0;var n=0,s=t/e.getTotalDelayUnits(),r=e.getFrames();l.arrayVerifyType(r,l.AnimationFrame);for(var a=0;a<r.length;a++){var o=n*s/t;n+=r[a].getDelayUnits(),i.push(o)}return!0}return!1},clone:function(){var e=new l.Animate;return this._cloneDecoration(e),e.initWithAnimation(this._animation.clone()),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._animation.getRestoreOriginalFrame()&&(this._origFrame=e.getSpriteFrame()),this._nextFrame=0,this._executedLoops=0},update:function(e){(e=this._computeEaseTime(e))<1&&((0|(e*=this._animation.getLoops()))>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),e%=1);for(var t=this._animation.getFrames(),i=t.length,n=this._splitTimes,s=this._nextFrame;s<i&&n[s]<=e;s++)this._currFrameIndex=s,this.target.setSpriteFrame(t[this._currFrameIndex].getSpriteFrame()),this._nextFrame=s+1},reverse:function(){var e=this._animation,t=e.getFrames(),i=[];if(l.arrayVerifyType(t,l.AnimationFrame),t.length>0)for(var n=t.length-1;n>=0;n--){var s=t[n];if(!s)break;i.push(s.clone())}var r=new l.Animation(i,e.getDelayPerUnit(),e.getLoops());r.setRestoreOriginalFrame(e.getRestoreOriginalFrame());var a=new l.Animate(r);return this._cloneDecoration(a),this._reverseEaseList(a),a},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame),l.Action.prototype.stop.call(this)}}),l.animate=function(e){return new l.Animate(e)},l.Animate.create=l.animate,l.TargetedAction=l.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(e,t){l.ActionInterval.prototype.ctor.call(this),t&&this.initWithTarget(e,t)},initWithTarget:function(e,t){return!!this.initWithDuration(t._duration)&&(this._forcedTarget=e,this._action=t,!0)},clone:function(){var e=new l.TargetedAction;return this._cloneDecoration(e),e.initWithTarget(this._forcedTarget,this._action.clone()),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(e){e=this._computeEaseTime(e),this._action.update(e)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(e){this._forcedTarget!==e&&(this._forcedTarget=e)}}),l.targetedAction=function(e,t){return new l.TargetedAction(e,t)},l.TargetedAction.create=l.targetedAction,l.ActionInstant=l.FiniteTimeAction.extend({isDone:function(){return!0},step:function(e){this.update(1)},update:function(e){},reverse:function(){return this.clone()},clone:function(){return new l.ActionInstant}}),l.Show=l.ActionInstant.extend({update:function(e){this.target.visible=!0},reverse:function(){return new l.Hide},clone:function(){return new l.Show}}),l.show=function(){return new l.Show},l.Show.create=l.show,l.Hide=l.ActionInstant.extend({update:function(e){this.target.visible=!1},reverse:function(){return new l.Show},clone:function(){return new l.Hide}}),l.hide=function(){return new l.Hide},l.Hide.create=l.hide,l.ToggleVisibility=l.ActionInstant.extend({update:function(e){this.target.visible=!this.target.visible},reverse:function(){return new l.ToggleVisibility},clone:function(){return new l.ToggleVisibility}}),l.toggleVisibility=function(){return new l.ToggleVisibility},l.ToggleVisibility.create=l.toggleVisibility,l.RemoveSelf=l.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(e){l.FiniteTimeAction.prototype.ctor.call(this),void 0!==e&&this.init(e)},update:function(e){this.target.removeFromParent(this._isNeedCleanUp)},init:function(e){return this._isNeedCleanUp=e,!0},reverse:function(){return new l.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new l.RemoveSelf(this._isNeedCleanUp)}}),l.removeSelf=function(e){return new l.RemoveSelf(e)},l.RemoveSelf.create=l.removeSelf,l.FlipX=l.ActionInstant.extend({_flippedX:!1,ctor:function(e){l.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void 0!==e&&this.initWithFlipX(e)},initWithFlipX:function(e){return this._flippedX=e,!0},update:function(e){this.target.flippedX=this._flippedX},reverse:function(){return new l.FlipX(!this._flippedX)},clone:function(){var e=new l.FlipX;return e.initWithFlipX(this._flippedX),e}}),l.flipX=function(e){return new l.FlipX(e)},l.FlipX.create=l.flipX,l.FlipY=l.ActionInstant.extend({_flippedY:!1,ctor:function(e){l.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void 0!==e&&this.initWithFlipY(e)},initWithFlipY:function(e){return this._flippedY=e,!0},update:function(e){this.target.flippedY=this._flippedY},reverse:function(){return new l.FlipY(!this._flippedY)},clone:function(){var e=new l.FlipY;return e.initWithFlipY(this._flippedY),e}}),l.flipY=function(e){return new l.FlipY(e)},l.FlipY.create=l.flipY,l.Place=l.ActionInstant.extend({_x:0,_y:0,ctor:function(e,t){l.FiniteTimeAction.prototype.ctor.call(this),this._x=0,this._y=0,void 0!==e&&(void 0!==e.x&&(t=e.y,e=e.x),this.initWithPosition(e,t))},initWithPosition:function(e,t){return this._x=e,this._y=t,!0},update:function(e){this.target.setPosition(this._x,this._y)},clone:function(){var e=new l.Place;return e.initWithPosition(this._x,this._y),e}}),l.place=function(e,t){return new l.Place(e,t)},l.Place.create=l.place,l.CallFunc=l.ActionInstant.extend({_selectorTarget:null,_function:null,_data:null,ctor:function(e,t,i){l.FiniteTimeAction.prototype.ctor.call(this),this.initWithFunction(e,t,i)},initWithFunction:function(e,t,i){return e&&(this._function=e),t&&(this._selectorTarget=t),void 0!==i&&(this._data=i),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(e){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(e){e!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=e)},clone:function(){var e=new l.CallFunc;return e.initWithFunction(this._function,this._selectorTarget,this._data),e}}),l.callFunc=function(e,t,i){return new l.CallFunc(e,t,i)},l.CallFunc.create=l.callFunc,l.ActionEase=l.ActionInterval.extend({_inner:null,ctor:function(e){l.ActionInterval.prototype.ctor.call(this),e&&this.initWithAction(e)},initWithAction:function(e){if(!e)throw new Error("cc.ActionEase.initWithAction(): action must be non nil");return!!this.initWithDuration(e.getDuration())&&(this._inner=e,!0)},clone:function(){var e=new l.ActionEase;return e.initWithAction(this._inner.clone()),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop(),l.ActionInterval.prototype.stop.call(this)},update:function(e){this._inner.update(e)},reverse:function(){return new l.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}}),l.actionEase=function(e){return new l.ActionEase(e)},l.ActionEase.create=l.actionEase,l.EaseRateAction=l.ActionEase.extend({_rate:0,ctor:function(e,t){l.ActionEase.prototype.ctor.call(this),void 0!==t&&this.initWithAction(e,t)},setRate:function(e){this._rate=e},getRate:function(){return this._rate},initWithAction:function(e,t){return!!l.ActionEase.prototype.initWithAction.call(this,e)&&(this._rate=t,!0)},clone:function(){var e=new l.EaseRateAction;return e.initWithAction(this._inner.clone(),this._rate),e},reverse:function(){return new l.EaseRateAction(this._inner.reverse(),1/this._rate)}}),l.easeRateAction=function(e,t){return new l.EaseRateAction(e,t)},l.EaseRateAction.create=l.easeRateAction,l.EaseIn=l.EaseRateAction.extend({update:function(e){this._inner.update(Math.pow(e,this._rate))},reverse:function(){return new l.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var e=new l.EaseIn;return e.initWithAction(this._inner.clone(),this._rate),e}}),l.EaseIn.create=function(e,t){return new l.EaseIn(e,t)},l.easeIn=function(e){return{_rate:e,easing:function(e){return Math.pow(e,this._rate)},reverse:function(){return l.easeIn(1/this._rate)}}},l.EaseOut=l.EaseRateAction.extend({update:function(e){this._inner.update(Math.pow(e,1/this._rate))},reverse:function(){return new l.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var e=new l.EaseOut;return e.initWithAction(this._inner.clone(),this._rate),e}}),l.EaseOut.create=function(e,t){return new l.EaseOut(e,t)},l.easeOut=function(e){return{_rate:e,easing:function(e){return Math.pow(e,1/this._rate)},reverse:function(){return l.easeOut(1/this._rate)}}},l.EaseInOut=l.EaseRateAction.extend({update:function(e){(e*=2)<1?this._inner.update(.5*Math.pow(e,this._rate)):this._inner.update(1-.5*Math.pow(2-e,this._rate))},clone:function(){var e=new l.EaseInOut;return e.initWithAction(this._inner.clone(),this._rate),e},reverse:function(){return new l.EaseInOut(this._inner.reverse(),this._rate)}}),l.EaseInOut.create=function(e,t){return new l.EaseInOut(e,t)},l.easeInOut=function(e){return{_rate:e,easing:function(e){return(e*=2)<1?.5*Math.pow(e,this._rate):1-.5*Math.pow(2-e,this._rate)},reverse:function(){return l.easeInOut(this._rate)}}},l.EaseExponentialIn=l.ActionEase.extend({update:function(e){this._inner.update(0===e?0:Math.pow(2,10*(e-1)))},reverse:function(){return new l.EaseExponentialOut(this._inner.reverse())},clone:function(){var e=new l.EaseExponentialIn;return e.initWithAction(this._inner.clone()),e}}),l.EaseExponentialIn.create=function(e){return new l.EaseExponentialIn(e)},l._easeExponentialInObj={easing:function(e){return 0===e?0:Math.pow(2,10*(e-1))},reverse:function(){return l._easeExponentialOutObj}},l.easeExponentialIn=function(){return l._easeExponentialInObj},l.EaseExponentialOut=l.ActionEase.extend({update:function(e){this._inner.update(1===e?1:1-Math.pow(2,-10*e))},reverse:function(){return new l.EaseExponentialIn(this._inner.reverse())},clone:function(){var e=new l.EaseExponentialOut;return e.initWithAction(this._inner.clone()),e}}),l.EaseExponentialOut.create=function(e){return new l.EaseExponentialOut(e)},l._easeExponentialOutObj={easing:function(e){return 1===e?1:1-Math.pow(2,-10*e)},reverse:function(){return l._easeExponentialInObj}},l.easeExponentialOut=function(){return l._easeExponentialOutObj},l.EaseExponentialInOut=l.ActionEase.extend({update:function(e){1!==e&&0!==e&&(e=(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))),this._inner.update(e)},reverse:function(){return new l.EaseExponentialInOut(this._inner.reverse())},clone:function(){var e=new l.EaseExponentialInOut;return e.initWithAction(this._inner.clone()),e}}),l.EaseExponentialInOut.create=function(e){return new l.EaseExponentialInOut(e)},l._easeExponentialInOutObj={easing:function(e){return 1!==e&&0!==e?(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1))):e},reverse:function(){return l._easeExponentialInOutObj}},l.easeExponentialInOut=function(){return l._easeExponentialInOutObj},l.EaseSineIn=l.ActionEase.extend({update:function(e){e=0===e||1===e?e:-1*Math.cos(e*Math.PI/2)+1,this._inner.update(e)},reverse:function(){return new l.EaseSineOut(this._inner.reverse())},clone:function(){var e=new l.EaseSineIn;return e.initWithAction(this._inner.clone()),e}}),l.EaseSineIn.create=function(e){return new l.EaseSineIn(e)},l._easeSineInObj={easing:function(e){return 0===e||1===e?e:-1*Math.cos(e*Math.PI/2)+1},reverse:function(){return l._easeSineOutObj}},l.easeSineIn=function(){return l._easeSineInObj},l.EaseSineOut=l.ActionEase.extend({update:function(e){e=0===e||1===e?e:Math.sin(e*Math.PI/2),this._inner.update(e)},reverse:function(){return new l.EaseSineIn(this._inner.reverse())},clone:function(){var e=new l.EaseSineOut;return e.initWithAction(this._inner.clone()),e}}),l.EaseSineOut.create=function(e){return new l.EaseSineOut(e)},l._easeSineOutObj={easing:function(e){return 0===e||1===e?e:Math.sin(e*Math.PI/2)},reverse:function(){return l._easeSineInObj}},l.easeSineOut=function(){return l._easeSineOutObj},l.EaseSineInOut=l.ActionEase.extend({update:function(e){e=0===e||1===e?e:-.5*(Math.cos(Math.PI*e)-1),this._inner.update(e)},clone:function(){var e=new l.EaseSineInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseSineInOut(this._inner.reverse())}}),l.EaseSineInOut.create=function(e){return new l.EaseSineInOut(e)},l._easeSineInOutObj={easing:function(e){return 0===e||1===e?e:-.5*(Math.cos(Math.PI*e)-1)},reverse:function(){return l._easeSineInOutObj}},l.easeSineInOut=function(){return l._easeSineInOutObj},l.EaseElastic=l.ActionEase.extend({_period:.3,ctor:function(e,t){l.ActionEase.prototype.ctor.call(this),e&&this.initWithAction(e,t)},getPeriod:function(){return this._period},setPeriod:function(e){this._period=e},initWithAction:function(e,t){return l.ActionEase.prototype.initWithAction.call(this,e),this._period=null==t?.3:t,!0},reverse:function(){return l.log("cc.EaseElastic.reverse(): it should be overridden in subclass."),null},clone:function(){var e=new l.EaseElastic;return e.initWithAction(this._inner.clone(),this._period),e}}),l.EaseElastic.create=function(e,t){return new l.EaseElastic(e,t)},l.EaseElasticIn=l.EaseElastic.extend({update:function(e){var t=0;if(0===e||1===e)t=e;else{var i=this._period/4;e-=1,t=-Math.pow(2,10*e)*Math.sin((e-i)*Math.PI*2/this._period)}this._inner.update(t)},reverse:function(){return new l.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var e=new l.EaseElasticIn;return e.initWithAction(this._inner.clone(),this._period),e}}),l.EaseElasticIn.create=function(e,t){return new l.EaseElasticIn(e,t)},l._easeElasticInObj={easing:function(e){return 0===e||1===e?e:(e-=1,-Math.pow(2,10*e)*Math.sin((e-.075)*Math.PI*2/.3))},reverse:function(){return l._easeElasticOutObj}},l.easeElasticIn=function(e){return e&&.3!==e?{_period:e,easing:function(e){return 0===e||1===e?e:(e-=1,-Math.pow(2,10*e)*Math.sin((e-this._period/4)*Math.PI*2/this._period))},reverse:function(){return l.easeElasticOut(this._period)}}:l._easeElasticInObj},l.EaseElasticOut=l.EaseElastic.extend({update:function(e){var t=0;if(0===e||1===e)t=e;else{var i=this._period/4;t=Math.pow(2,-10*e)*Math.sin((e-i)*Math.PI*2/this._period)+1}this._inner.update(t)},reverse:function(){return new l.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var e=new l.EaseElasticOut;return e.initWithAction(this._inner.clone(),this._period),e}}),l.EaseElasticOut.create=function(e,t){return new l.EaseElasticOut(e,t)},l._easeElasticOutObj={easing:function(e){return 0===e||1===e?e:Math.pow(2,-10*e)*Math.sin((e-.075)*Math.PI*2/.3)+1},reverse:function(){return l._easeElasticInObj}},l.easeElasticOut=function(e){return e&&.3!==e?{_period:e,easing:function(e){return 0===e||1===e?e:Math.pow(2,-10*e)*Math.sin((e-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return l.easeElasticIn(this._period)}}:l._easeElasticOutObj},l.EaseElasticInOut=l.EaseElastic.extend({update:function(e){var t=0,i=this._period;if(0===e||1===e)t=e;else{e*=2,i||(i=this._period=.3*1.5);var n=i/4;t=(e-=1)<0?-.5*Math.pow(2,10*e)*Math.sin((e-n)*Math.PI*2/i):Math.pow(2,-10*e)*Math.sin((e-n)*Math.PI*2/i)*.5+1}this._inner.update(t)},reverse:function(){return new l.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var e=new l.EaseElasticInOut;return e.initWithAction(this._inner.clone(),this._period),e}}),l.EaseElasticInOut.create=function(e,t){return new l.EaseElasticInOut(e,t)},l.easeElasticInOut=function(e){return e=e||.3,{_period:e,easing:function(e){var t=0,i=this._period;if(0===e||1===e)t=e;else{e*=2,i||(i=this._period=.3*1.5);var n=i/4;t=(e-=1)<0?-.5*Math.pow(2,10*e)*Math.sin((e-n)*Math.PI*2/i):Math.pow(2,-10*e)*Math.sin((e-n)*Math.PI*2/i)*.5+1}return t},reverse:function(){return l.easeElasticInOut(this._period)}}},l.EaseBounce=l.ActionEase.extend({bounceTime:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},clone:function(){var e=new l.EaseBounce;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseBounce(this._inner.reverse())}}),l.EaseBounce.create=function(e){return new l.EaseBounce(e)},l.EaseBounceIn=l.EaseBounce.extend({update:function(e){var t=1-this.bounceTime(1-e);this._inner.update(t)},reverse:function(){return new l.EaseBounceOut(this._inner.reverse())},clone:function(){var e=new l.EaseBounceIn;return e.initWithAction(this._inner.clone()),e}}),l.EaseBounceIn.create=function(e){return new l.EaseBounceIn(e)},l._bounceTime=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},l._easeBounceInObj={easing:function(e){return 1-l._bounceTime(1-e)},reverse:function(){return l._easeBounceOutObj}},l.easeBounceIn=function(){return l._easeBounceInObj},l.EaseBounceOut=l.EaseBounce.extend({update:function(e){var t=this.bounceTime(e);this._inner.update(t)},reverse:function(){return new l.EaseBounceIn(this._inner.reverse())},clone:function(){var e=new l.EaseBounceOut;return e.initWithAction(this._inner.clone()),e}}),l.EaseBounceOut.create=function(e){return new l.EaseBounceOut(e)},l._easeBounceOutObj={easing:function(e){return l._bounceTime(e)},reverse:function(){return l._easeBounceInObj}},l.easeBounceOut=function(){return l._easeBounceOutObj},l.EaseBounceInOut=l.EaseBounce.extend({update:function(e){var t=0;e<.5?(e*=2,t=.5*(1-this.bounceTime(1-e))):t=.5*this.bounceTime(2*e-1)+.5,this._inner.update(t)},clone:function(){var e=new l.EaseBounceInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseBounceInOut(this._inner.reverse())}}),l.EaseBounceInOut.create=function(e){return new l.EaseBounceInOut(e)},l._easeBounceInOutObj={easing:function(e){var t;return e<.5?(e*=2,t=.5*(1-l._bounceTime(1-e))):t=.5*l._bounceTime(2*e-1)+.5,t},reverse:function(){return l._easeBounceInOutObj}},l.easeBounceInOut=function(){return l._easeBounceInOutObj},l.EaseBackIn=l.ActionEase.extend({update:function(e){e=0===e||1===e?e:e*e*(2.70158*e-1.70158),this._inner.update(e)},reverse:function(){return new l.EaseBackOut(this._inner.reverse())},clone:function(){var e=new l.EaseBackIn;return e.initWithAction(this._inner.clone()),e}}),l.EaseBackIn.create=function(e){return new l.EaseBackIn(e)},l._easeBackInObj={easing:function(e){return 0===e||1===e?e:e*e*(2.70158*e-1.70158)},reverse:function(){return l._easeBackOutObj}},l.easeBackIn=function(){return l._easeBackInObj},l.EaseBackOut=l.ActionEase.extend({update:function(e){e-=1,this._inner.update(e*e*(2.70158*e+1.70158)+1)},reverse:function(){return new l.EaseBackIn(this._inner.reverse())},clone:function(){var e=new l.EaseBackOut;return e.initWithAction(this._inner.clone()),e}}),l.EaseBackOut.create=function(e){return new l.EaseBackOut(e)},l._easeBackOutObj={easing:function(e){return(e-=1)*e*(2.70158*e+1.70158)+1},reverse:function(){return l._easeBackInObj}},l.easeBackOut=function(){return l._easeBackOutObj},l.EaseBackInOut=l.ActionEase.extend({update:function(e){(e*=2)<1?this._inner.update(e*e*(3.5949095*e-2.5949095)/2):(e-=2,this._inner.update(e*e*(3.5949095*e+2.5949095)/2+1))},clone:function(){var e=new l.EaseBackInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseBackInOut(this._inner.reverse())}}),l.EaseBackInOut.create=function(e){return new l.EaseBackInOut(e)},l._easeBackInOutObj={easing:function(e){return(e*=2)<1?e*e*(3.5949095*e-2.5949095)/2:(e-=2)*e*(3.5949095*e+2.5949095)/2+1},reverse:function(){return l._easeBackInOutObj}},l.easeBackInOut=function(){return l._easeBackInOutObj},l.EaseBezierAction=l.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(e){l.ActionEase.prototype.ctor.call(this,e)},_updateTime:function(e,t,i,n,s){return Math.pow(1-s,3)*e+3*s*Math.pow(1-s,2)*t+3*Math.pow(s,2)*(1-s)*i+Math.pow(s,3)*n},update:function(e){var t=this._updateTime(this._p0,this._p1,this._p2,this._p3,e);this._inner.update(t)},clone:function(){var e=new l.EaseBezierAction;return e.initWithAction(this._inner.clone()),e.setBezierParamer(this._p0,this._p1,this._p2,this._p3),e},reverse:function(){var e=new l.EaseBezierAction(this._inner.reverse());return e.setBezierParamer(this._p3,this._p2,this._p1,this._p0),e},setBezierParamer:function(e,t,i,n){this._p0=e||0,this._p1=t||0,this._p2=i||0,this._p3=n||0}}),l.EaseBezierAction.create=function(e){return new l.EaseBezierAction(e)},l.easeBezierAction=function(e,t,i,n){return{easing:function(s){return l.EaseBezierAction.prototype._updateTime(e,t,i,n,s)},reverse:function(){return l.easeBezierAction(n,i,t,e)}}},l.EaseQuadraticActionIn=l.ActionEase.extend({_updateTime:function(e){return Math.pow(e,2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuadraticActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseQuadraticActionIn(this._inner.reverse())}}),l.EaseQuadraticActionIn.create=function(e){return new l.EaseQuadraticActionIn(e)},l._easeQuadraticActionIn={easing:l.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return l._easeQuadraticActionIn}},l.easeQuadraticActionIn=function(){return l._easeQuadraticActionIn},l.EaseQuadraticActionOut=l.ActionEase.extend({_updateTime:function(e){return-e*(e-2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuadraticActionOut;return e.initWithAction(),e},reverse:function(){return new l.EaseQuadraticActionOut(this._inner.reverse())}}),l.EaseQuadraticActionOut.create=function(e){return new l.EaseQuadraticActionOut(e)},l._easeQuadraticActionOut={easing:l.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return l._easeQuadraticActionOut}},l.easeQuadraticActionOut=function(){return l._easeQuadraticActionOut},l.EaseQuadraticActionInOut=l.ActionEase.extend({_updateTime:function(e){return e*=2,e<1?e*e*.5:-.5*(--e*(e-2)-1)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuadraticActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseQuadraticActionInOut(this._inner.reverse())}}),l.EaseQuadraticActionInOut.create=function(e){return new l.EaseQuadraticActionInOut(e)},l._easeQuadraticActionInOut={easing:l.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return l._easeQuadraticActionInOut}},l.easeQuadraticActionInOut=function(){return l._easeQuadraticActionInOut},l.EaseQuarticActionIn=l.ActionEase.extend({_updateTime:function(e){return e*e*e*e},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuarticActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseQuarticActionIn(this._inner.reverse())}}),l.EaseQuarticActionIn.create=function(e){return new l.EaseQuarticActionIn(e)},l._easeQuarticActionIn={easing:l.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return l._easeQuarticActionIn}},l.easeQuarticActionIn=function(){return l._easeQuarticActionIn},l.EaseQuarticActionOut=l.ActionEase.extend({_updateTime:function(e){return-((e-=1)*e*e*e-1)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuarticActionOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseQuarticActionOut(this._inner.reverse())}}),l.EaseQuarticActionOut.create=function(e){return new l.EaseQuarticActionOut(e)},l._easeQuarticActionOut={easing:l.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return l._easeQuarticActionOut}},l.easeQuarticActionOut=function(){return l._easeQuarticActionOut},l.EaseQuarticActionInOut=l.ActionEase.extend({_updateTime:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuarticActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseQuarticActionInOut(this._inner.reverse())}}),l.EaseQuarticActionInOut.create=function(e){return new l.EaseQuarticActionInOut(e)},l._easeQuarticActionInOut={easing:l.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return l._easeQuarticActionInOut}},l.easeQuarticActionInOut=function(){return l._easeQuarticActionInOut},l.EaseQuinticActionIn=l.ActionEase.extend({_updateTime:function(e){return e*e*e*e*e},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuinticActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseQuinticActionIn(this._inner.reverse())}}),l.EaseQuinticActionIn.create=function(e){return new l.EaseQuinticActionIn(e)},l._easeQuinticActionIn={easing:l.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return l._easeQuinticActionIn}},l.easeQuinticActionIn=function(){return l._easeQuinticActionIn},l.EaseQuinticActionOut=l.ActionEase.extend({_updateTime:function(e){return(e-=1)*e*e*e*e+1},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuinticActionOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseQuinticActionOut(this._inner.reverse())}}),l.EaseQuinticActionOut.create=function(e){return new l.EaseQuinticActionOut(e)},l._easeQuinticActionOut={easing:l.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return l._easeQuinticActionOut}},l.easeQuinticActionOut=function(){return l._easeQuinticActionOut},l.EaseQuinticActionInOut=l.ActionEase.extend({_updateTime:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseQuinticActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseQuinticActionInOut(this._inner.reverse())}}),l.EaseQuinticActionInOut.create=function(e){return new l.EaseQuinticActionInOut(e)},l._easeQuinticActionInOut={easing:l.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return l._easeQuinticActionInOut}},l.easeQuinticActionInOut=function(){return l._easeQuinticActionInOut},l.EaseCircleActionIn=l.ActionEase.extend({_updateTime:function(e){return-1*(Math.sqrt(1-e*e)-1)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseCircleActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseCircleActionIn(this._inner.reverse())}}),l.EaseCircleActionIn.create=function(e){return new l.EaseCircleActionIn(e)},l._easeCircleActionIn={easing:l.EaseCircleActionIn.prototype._updateTime,reverse:function(){return l._easeCircleActionIn}},l.easeCircleActionIn=function(){return l._easeCircleActionIn},l.EaseCircleActionOut=l.ActionEase.extend({_updateTime:function(e){return e-=1,Math.sqrt(1-e*e)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseCircleActionOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseCircleActionOut(this._inner.reverse())}}),l.EaseCircleActionOut.create=function(e){return new l.EaseCircleActionOut(e)},l._easeCircleActionOut={easing:l.EaseCircleActionOut.prototype._updateTime,reverse:function(){return l._easeCircleActionOut}},l.easeCircleActionOut=function(){return l._easeCircleActionOut},l.EaseCircleActionInOut=l.ActionEase.extend({_updateTime:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):(e-=2,.5*(Math.sqrt(1-e*e)+1))},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseCircleActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseCircleActionInOut(this._inner.reverse())}}),l.EaseCircleActionInOut.create=function(e){return new l.EaseCircleActionInOut(e)},l._easeCircleActionInOut={easing:l.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return l._easeCircleActionInOut}},l.easeCircleActionInOut=function(){return l._easeCircleActionInOut},l.EaseCubicActionIn=l.ActionEase.extend({_updateTime:function(e){return e*e*e},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseCubicActionIn;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseCubicActionIn(this._inner.reverse())}}),l.EaseCubicActionIn.create=function(e){return new l.EaseCubicActionIn(e)},l._easeCubicActionIn={easing:l.EaseCubicActionIn.prototype._updateTime,reverse:function(){return l._easeCubicActionIn}},l.easeCubicActionIn=function(){return l._easeCubicActionIn},l.EaseCubicActionOut=l.ActionEase.extend({_updateTime:function(e){return(e-=1)*e*e+1},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseCubicActionOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseCubicActionOut(this._inner.reverse())}}),l.EaseCubicActionOut.create=function(e){return new l.EaseCubicActionOut(e)},l._easeCubicActionOut={easing:l.EaseCubicActionOut.prototype._updateTime,reverse:function(){return l._easeCubicActionOut}},l.easeCubicActionOut=function(){return l._easeCubicActionOut},l.EaseCubicActionInOut=l.ActionEase.extend({_updateTime:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},update:function(e){this._inner.update(this._updateTime(e))},clone:function(){var e=new l.EaseCubicActionInOut;return e.initWithAction(this._inner.clone()),e},reverse:function(){return new l.EaseCubicActionInOut(this._inner.reverse())}}),l.EaseCubicActionInOut.create=function(e){return new l.EaseCubicActionInOut(e)},l._easeCubicActionInOut={easing:l.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return l._easeCubicActionInOut}},l.easeCubicActionInOut=function(){return l._easeCubicActionInOut},l.cardinalSplineAt=function(e,t,i,n,s,r,a){var o=r*r,h=o*r,d=(1-s)/2,c=d*(2*o-h-r),u=d*(-h+o)+(2*h-3*o+1),p=d*(h-2*o+r)+(-2*h+3*o),m=d*(h-o),_=e.x*c+t.x*u+i.x*p+n.x*m,g=e.y*c+t.y*u+i.y*p+n.y*m;if(void 0===a)return l.p(_,g);a.x=_,a.y=g},l.reverseControlPoints=function(e){for(var t=[],i=e.length-1;i>=0;i--)t.push(l.p(e[i].x,e[i].y));return t},l.cloneControlPoints=function(e){for(var t=[],i=0;i<e.length;i++)t.push(l.p(e[i].x,e[i].y));return t},l.copyControlPoints=l.cloneControlPoints,l.getControlPointAt=function(e,t){return e[Math.min(e.length-1,Math.max(t,0))]},l.reverseControlPointsInline=function(e){for(var t=e.length,i=0|t/2,n=0;n<i;++n){var s=e[n];e[n]=e[t-n-1],e[t-n-1]=s}},l.CardinalSplineTo=l.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(e,t,i){l.ActionInterval.prototype.ctor.call(this),this._points=[],void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){if(!t||0===t.length)throw new Error("Invalid configuration. It must at least have one control point");return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this.setPoints(t),this._tension=i,!0)},clone:function(){var e=new l.CardinalSplineTo;return e.initWithDuration(this._duration,l.copyControlPoints(this._points),this._tension),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._deltaT=1/(this._points.length-1),this._previousPosition=l.p(this.target.getPositionX(),this.target.getPositionY()),this._accumulatedDiff=l.p(0,0)},update:function(e){e=this._computeEaseTime(e);var t,i,n=this._points;if(1===e)t=n.length-1,i=1;else{var s=this._deltaT;i=(e-s*(t=0|e/s))/s}var r=l.cardinalSplineAt(l.getControlPointAt(n,t-1),l.getControlPointAt(n,t-0),l.getControlPointAt(n,t+1),l.getControlPointAt(n,t+2),this._tension,i);if(l.ENABLE_STACKABLE_ACTIONS){var a,o;if(a=this.target.getPositionX()-this._previousPosition.x,o=this.target.getPositionY()-this._previousPosition.y,0!==a||0!==o){var h=this._accumulatedDiff;a=h.x+a,o=h.y+o,h.x=a,h.y=o,r.x+=a,r.y+=o}}this.updatePosition(r)},reverse:function(){var e=l.reverseControlPoints(this._points);return l.cardinalSplineTo(this._duration,e,this._tension)},updatePosition:function(e){this.target.setPosition(e),this._previousPosition=e},getPoints:function(){return this._points},setPoints:function(e){this._points=e}}),l.cardinalSplineTo=function(e,t,i){return new l.CardinalSplineTo(e,t,i)},l.CardinalSplineTo.create=l.cardinalSplineTo,l.CardinalSplineBy=l.CardinalSplineTo.extend({_startPosition:null,ctor:function(e,t,i){l.CardinalSplineTo.prototype.ctor.call(this),this._startPosition=l.p(0,0),void 0!==i&&this.initWithDuration(e,t,i)},startWithTarget:function(e){l.CardinalSplineTo.prototype.startWithTarget.call(this,e),this._startPosition.x=e.getPositionX(),this._startPosition.y=e.getPositionY()},reverse:function(){for(var e,t=this._points.slice(),i=t[0],n=1;n<t.length;++n)e=t[n],t[n]=l.pSub(e,i),i=e;var s=l.reverseControlPoints(t);i=s[s.length-1],s.pop(),i.x=-i.x,i.y=-i.y,s.unshift(i);for(n=1;n<s.length;++n)(e=s[n]).x=-e.x,e.y=-e.y,e.x+=i.x,e.y+=i.y,s[n]=e,i=e;return l.cardinalSplineBy(this._duration,s,this._tension)},updatePosition:function(e){var t=this._startPosition,i=e.x+t.x,n=e.y+t.y;this._previousPosition.x=i,this._previousPosition.y=n,this.target.setPosition(i,n)},clone:function(){var e=new l.CardinalSplineBy;return e.initWithDuration(this._duration,l.copyControlPoints(this._points),this._tension),e}}),l.cardinalSplineBy=function(e,t,i){return new l.CardinalSplineBy(e,t,i)},l.CardinalSplineBy.create=l.cardinalSplineBy,l.CatmullRomTo=l.CardinalSplineTo.extend({ctor:function(e,t){t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return l.CardinalSplineTo.prototype.initWithDuration.call(this,e,t,.5)},clone:function(){var e=new l.CatmullRomTo;return e.initWithDuration(this._duration,l.copyControlPoints(this._points)),e}}),l.catmullRomTo=function(e,t){return new l.CatmullRomTo(e,t)},l.CatmullRomTo.create=l.catmullRomTo,l.CatmullRomBy=l.CardinalSplineBy.extend({ctor:function(e,t){l.CardinalSplineBy.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return l.CardinalSplineTo.prototype.initWithDuration.call(this,e,t,.5)},clone:function(){var e=new l.CatmullRomBy;return e.initWithDuration(this._duration,l.copyControlPoints(this._points)),e}}),l.catmullRomBy=function(e,t){return new l.CatmullRomBy(e,t)},l.CatmullRomBy.create=l.catmullRomBy,l.ActionTweenDelegate=l.Class.extend({updateTweenAction:function(e,t){}}),l.ActionTween=l.ActionInterval.extend({key:"",from:0,to:0,delta:0,ctor:function(e,t,i,n){l.ActionInterval.prototype.ctor.call(this),this.key="",void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this.key=t,this.to=n,this.from=i,!0)},startWithTarget:function(e){if(!e||!e.updateTweenAction)throw new Error("cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function");l.ActionInterval.prototype.startWithTarget.call(this,e),this.delta=this.to-this.from},update:function(e){this.target.updateTweenAction(this.to-this.delta*(1-e),this.key)},reverse:function(){return new l.ActionTween(this.duration,this.key,this.to,this.from)},clone:function(){var e=new l.ActionTween;return e.initWithDuration(this._duration,this.key,this.from,this.to),e}}),l.actionTween=function(e,t,i,n){return new l.ActionTween(e,t,i,n)},l.ActionTween.create=l.actionTween,function(){var e=l.sys,t=(e.browserVersion,{ONLY_ONE:!1,WEB_AUDIO:!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),DELAY_CREATE_CTX:!1,ONE_SOURCE:!1});e.browserType===e.BROWSER_TYPE_FIREFOX&&(t.DELAY_CREATE_CTX=!0,t.USE_LOADER_EVENT="canplay"),e.os===e.OS_IOS&&(t.USE_LOADER_EVENT="loadedmetadata"),e.os===e.OS_ANDROID&&e.browserType===e.BROWSER_TYPE_UC&&(t.ONE_SOURCE=!0),window.__audioSupport=t}(),l.Audio=l.Class.extend({interruptPlay:!1,src:null,_element:null,_AUDIO_TYPE:"AUDIO",paused:!0,loop:!1,ctor:function(e){this.src=e},setBuffer:function(e){this._AUDIO_TYPE="WEBAUDIO",this._element=new l.Audio.WebAudio(e)},setElement:function(e){this._AUDIO_TYPE="AUDIO",this._element=e},play:function(e,t){if(this._element){if(this._element.autoplay=!0,this._element.loop=t,this.loop=t,this._element.play(),this._element.paused=!1,this.paused=!1,!t){var i=this,n=this._element;n.addEventListener("ended",function(){n.paused=!0,i.paused=!0})}"AUDIO"===this._AUDIO_TYPE&&this._element.paused,!1===l.Audio.bindTouch&&(l.Audio.bindTouch=!0)}else this.interruptPlay=!1},getPlaying:function(){return!this._element||!this.paused},stop:function(){if(this._element){this._element.pause(),this.paused=!0;try{this._element.currentTime=0}catch(e){}}else this.interruptPlay=!0},pause:function(){this._element?(this._element.pause(),this.paused=!0):this.interruptPlay=!0},resume:function(){this._element?(this._element.play(),this.paused=!1):this.interruptPlay=!1},setVolume:function(e){this._element&&(this._element.volume=e)},getVolume:function(){if(this._element)return this._element.volume},cloneNode:function(){var e=new l.Audio(this.src);if("AUDIO"===this._AUDIO_TYPE){var t=new Audio;t.src=this.src,t.preload="auto",e.setElement(t)}else e.setBuffer(this._element.buffer);return e}}),l.Audio.touchPlayList=[],l.Audio.bindTouch=!1,l.Audio.touchStart=function(){for(var e=l.Audio.touchPlayList,t=null;t=e.pop();)t.audio.loop=!!t.loop,t.audio.play(t.offset)},l.Audio.WebAudio=function(e){this.buffer=e,this.context=l.Audio._context;var t=this.context.createGain();t.gain.value=1,t.connect(this.context.destination),this._volume=t,this._loop=!1,this._startTime=-1,this._currentSource=null,this.playedLength=0,this._currextTimer=null},l.Audio.WebAudio.prototype={constructor:l.Audio.WebAudio,get paused(){return(!this._currentSource||!this._currentSource.loop)&&(-1===this._startTime||this.context.currentTime-this._startTime>this.buffer.duration)},set paused(e){},get loop(){return this._loop},set loop(e){return this._loop=e},get volume(){return this._volume.gain.value},set volume(e){return this._volume.gain.value=e},get currentTime(){return this.playedLength},set currentTime(e){return this.playedLength=e},play:function(e){this._currentSource&&!this.paused&&(this._currentSource.stop(0),this.playedLength=0);var t=this.context.createBufferSource();t.buffer=this.buffer,t.connect(this._volume),t.loop=this._loop,this._startTime=this.context.currentTime,e=e||this.playedLength;var i=this.buffer.duration;if(this._loop?t.start?t.start(0):t.notoGrainOn?t.noteGrainOn(0):t.noteOn(0):t.start?t.start(0,e,i-e):t.notoGrainOn?t.noteGrainOn(0,e,i-e):t.noteOn(0,e,i-e),this._currentSource=t,0===this.context.currentTime){var n=this;clearTimeout(this._currextTimer),this._currextTimer=setTimeout(function(){0===n.context.currentTime&&l.Audio.touchPlayList.push({offset:e,audio:n})},10)}},pause:function(){this.playedLength=this.context.currentTime-this._startTime,this.playedLength%=this.buffer.duration;var e=this._currentSource;this._currentSource=null,this._startTime=-1,e&&e.stop(0)}},function(e){var t=e.WEB_AUDIO,i=e.ONLY_ONE,n=[];!function(){var e=document.createElement("audio");if(e.canPlayType){var t=e.canPlayType('audio/ogg; codecs="vorbis"');t&&""!==t&&n.push(".ogg");var i=e.canPlayType("audio/mpeg");i&&""!==i&&n.push(".mp3");var s=e.canPlayType('audio/wav; codecs="1"');s&&""!==s&&n.push(".wav");var r=e.canPlayType("audio/mp4");r&&""!==r&&n.push(".mp4");var a=e.canPlayType("audio/x-m4a");a&&""!==a&&n.push(".m4a")}}();try{if(t){var s=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);if(l.Audio._context=s,!(s.createBufferSource&&s.createGain&&s.destination&&s.decodeAudioData))throw"context is incomplete";e.DELAY_CREATE_CTX&&setTimeout(function(){s=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),l.Audio._context=s},0)}}catch(e){t=!1,l.log("browser don't support web audio")}var r={cache:{},useWebAudio:!0,loadBuffer:function(e,i){if(t){var n=l.loader.getXMLHttpRequest();n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){n._timeoutId>=0&&clearTimeout(n._timeoutId),s.decodeAudioData(n.response,function(e){i(null,e)},function(){i("decode error - "+e)})},n.onerror=function(){i("request error - "+e)},void 0===n.ontimeout&&(n._timeoutId=setTimeout(function(){n.ontimeout()},n.timeout)),n.ontimeout=function(){i("request timeout - "+e)},n.send()}},load:function(e,t,i,s){if(0===n.length)return s("can not support audio!");var r=l.loader.getRes(t);if(r)return s(null,r);l.loader.audioPath&&(e=l.path.join(l.loader.audioPath,e));for(var a=l.path.extname(e),o=[a],h=0;h<n.length;h++)a!==n[h]&&o.push(n[h]);return r=new l.Audio(e),l.loader.cache[t]=r,this.loadAudioFromExtList(e,o,r,s),r},loadAudioFromExtList:function(i,s,r,a){if(0===s.length){var o="can not found the resource of audio! Last match url is : ";return o+=i.replace(/\.(.*)?$/,"("),n.forEach(function(e){o+=e+"|"}),o=o.replace(/\|$/,")"),a({status:520,errorMessage:o},null)}if(t&&this.useWebAudio)this.loadBuffer(i,function(e,t){e&&l.log(e),t&&r.setBuffer(t),a(null,r)});else{e.ONE_SOURCE||s.length;var h=document.createElement("audio");(h=new Audio).src=l.path.changeExtname(i,s[0]),h.preload="auto",r.setElement(h);var d=setTimeout(function(){0===h.readyState?u():c()},8e3),c=function(){h.removeEventListener("canplaythrough",c,!1),h.removeEventListener("error",u,!1),h.removeEventListener("emptied",c,!1),e.USE_LOADER_EVENT&&h.removeEventListener(e.USE_LOADER_EVENT,c,!1),clearTimeout(d),a(null,r)},u=function(){l.log("load audio failure - "+i),c()};h.addEventListener("canplaythrough",c,!1),h.addEventListener("error",u,!1),e.USE_LOADER_EVENT&&h.addEventListener(e.USE_LOADER_EVENT,c,!1)}}};l.loader.register(["mp3","ogg","wav","mp4","m4a"],r),l.audioEngine={_currMusic:null,_musicVolume:1,features:e,willPlayMusic:function(){return!1},playMusic:function(e,t){var i=this._currMusic;i&&i.stop();var n=this._musicVolume,s=l.loader.getRes(e);s||(l.loader.load(e,function(){s.getPlaying()||s.interruptPlay||(s.setVolume(n),s.play(0,t||!1))}),s=l.loader.getRes(e)),s.setVolume(n),s.play(0,t||!1),this._currMusic=s},stopMusic:function(e){var t=this._currMusic;if(t){for(var i=l.Audio.touchPlayList,n=i.length-1;n>=0;--n)i[n]&&i[n].audio===t._element&&i.splice(n,1);t.stop(),this._currMusic=null,e&&l.loader.release(t.src)}},pauseMusic:function(){var e=this._currMusic;e&&e.pause()},resumeMusic:function(){var e=this._currMusic;e&&e.resume()},rewindMusic:function(){var e=this._currMusic;e&&(e.stop(),e.play())},getMusicVolume:function(){return this._musicVolume},setMusicVolume:function(e){e-=0,isNaN(e)&&(e=1),e>1&&(e=1),e<0&&(e=0),this._musicVolume=e;var t=this._currMusic;t&&t.setVolume(e)},isMusicPlaying:function(){var e=this._currMusic;return!!e&&e.getPlaying()},_audioPool:{},_maxAudioInstance:10,_effectVolume:1,playEffect:function(e,n){if(i&&this._currMusic&&this._currMusic.getPlaying())return l.log("Browser is only allowed to play one audio"),null;var s=this._audioPool[e];s||(s=this._audioPool[e]=[]);for(var a=0;a<s.length&&s[a].getPlaying();a++);if(!t&&a>this._maxAudioInstance){var o=s.shift();o.stop(),s.push(o),a=s.length-1}var h;if(s[a])return(h=s[a]).setVolume(this._effectVolume),h.play(0,n||!1),h;if((h=l.loader.getRes(e))&&t&&"AUDIO"===h._AUDIO_TYPE&&(l.loader.release(e),h=null),h){if(!t||"AUDIO"!==h._AUDIO_TYPE)return(h=h.cloneNode()).setVolume(this._effectVolume),h.play(0,n||!1),s.push(h),h;r.loadBuffer(e,function(e,t){h.setBuffer(t),h.setVolume(l.audioEngine._effectVolume),h.getPlaying()||h.play(0,n||!1)})}var d=r.useWebAudio;return r.useWebAudio=!0,l.loader.load(e,function(t){(t=(t=l.loader.getRes(e)).cloneNode()).setVolume(l.audioEngine._effectVolume),t.play(0,n||!1),s.push(t)}),r.useWebAudio=d,h},setEffectsVolume:function(e){e-=0,isNaN(e)&&(e=1),e>1&&(e=1),e<0&&(e=0),this._effectVolume=e;var t=this._audioPool;for(var i in t){var n=t[i];if(Array.isArray(n))for(var s=0;s<n.length;s++)n[s].setVolume(e)}},getEffectsVolume:function(){return this._effectVolume},pauseEffect:function(e){e&&e.pause()},pauseAllEffects:function(){var e=this._audioPool;for(var t in e)for(var i=e[t],n=0;n<e[t].length;n++)i[n].getPlaying()&&i[n].pause()},resumeEffect:function(e){e&&e.resume()},resumeAllEffects:function(){var e=this._audioPool;for(var t in e)for(var i=e[t],n=0;n<e[t].length;n++)i[n].resume()},stopEffect:function(e){e&&e.stop()},stopAllEffects:function(){var e=this._audioPool;for(var t in e){for(var i=e[t],n=0;n<i.length;n++)i[n].stop();i.length=0}e.length=0},unloadEffect:function(e){if(e){l.loader.release(e);var t=this._audioPool[e];if(t){for(var i=0;i<t.length;i++)t[i].stop();t.length=0}delete this._audioPool[e]}},end:function(){this.stopMusic(),this.stopAllEffects()},_pauseCache:[],_pausePlaying:function(){var e=this._currMusic;e&&e.getPlaying()&&(e.pause(),this._pauseCache.push(e));var t=this._audioPool;for(var i in t)for(var n=t[i],s=0;s<t[i].length;s++)n[s].getPlaying()&&(n[s].pause(),this._pauseCache.push(n[s]))},_resumePlaying:function(){for(var e=this._pauseCache,t=0;t<e.length;t++)e[t].resume();e.length=0}}}(window.__audioSupport),l.Codec={name:"Jacob__Codec"},l.unzip=function(){return l.Codec.GZip.gunzip.apply(l.Codec.GZip,arguments)},l.unzipBase64=function(){var e=l.Codec.Base64.decode.apply(l.Codec.Base64,arguments);return l.Codec.GZip.gunzip.apply(l.Codec.GZip,[e])},l.unzipBase64AsArray=function(e,t){t=t||1;var i,n,s,r=this.unzipBase64(e),a=[];for(i=0,s=r.length/t;i<s;i++)for(a[i]=0,n=t-1;n>=0;--n)a[i]+=r.charCodeAt(i*t+n)<<8*n;return a},l.unzipAsArray=function(e,t){t=t||1;var i,n,s,r=this.unzip(e),a=[];for(i=0,s=r.length/t;i<s;i++)for(a[i]=0,n=t-1;n>=0;--n)a[i]+=r.charCodeAt(i*t+n)<<8*n;return a},l.StringToArray=function(e){var t,i=e.split(","),n=[];for(t=0;t<i.length;t++)n.push(parseInt(i[t]));return n},l.Codec.Base64={name:"Jacob__Codec__Base64"},l.Codec.Base64._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l.Codec.Base64.decode=function(e){var t,i,n,s,r,a,o=[],h=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<e.length;)t=this._keyStr.indexOf(e.charAt(h++))<<2|(s=this._keyStr.indexOf(e.charAt(h++)))>>4,i=(15&s)<<4|(r=this._keyStr.indexOf(e.charAt(h++)))>>2,n=(3&r)<<6|(a=this._keyStr.indexOf(e.charAt(h++))),o.push(String.fromCharCode(t)),64!==r&&o.push(String.fromCharCode(i)),64!==a&&o.push(String.fromCharCode(n));return o=o.join("")},l.Codec.Base64.decodeAsArray=function(e,t){var i,n,s,r=this.decode(e),a=[];for(i=0,s=r.length/t;i<s;i++)for(a[i]=0,n=t-1;n>=0;--n)a[i]+=r.charCodeAt(i*t+n)<<8*n;return a},l.uint8ArrayToUint32Array=function(e){if(e.length%4!=0)return null;for(var t=e.length/4,i=window.Uint32Array?new Uint32Array(t):[],n=0;n<t;n++){var s=4*n;i[n]=e[s]+256*e[s+1]+65536*e[s+2]+e[s+3]*(1<<24)}return i},l.GridBase=l.Class.extend({_active:!1,_reuseGrid:0,_gridSize:null,_gridRect:null,_texture:null,_step:null,_grabber:null,_isTextureFlipped:!1,_glProgramState:null,_directorProjection:0,_dirty:!1,ctor:function(e,t,i,n){l.sys._checkWebGLRenderMode(),this._active=!1,this._reuseGrid=0,this._gridSize=null,this._gridRect=new l.rect,this._texture=null,this._step=l.p(0,0),this._grabber=null,this._isTextureFlipped=!1,this._glProgramState=null,this._directorProjection=0,this._dirty=!1,void 0!==e&&this.initWithSize(e,t,i,n)},isActive:function(){return this._active},setActive:function(e){if(this._active=e,!e){var t=l.director,i=t.getProjection();t.setProjection(i)}},getReuseGrid:function(){return this._reuseGrid},setReuseGrid:function(e){this._reuseGrid=e},getGridSize:function(){return l.size(this._gridSize.width,this._gridSize.height)},setGridSize:function(e){this._gridSize.width=parseInt(e.width),this._gridSize.height=parseInt(e.height)},setGridRect:function(e){this._gridRect=e},getGridRect:function(){return this._gridRect},getStep:function(){return l.p(this._step.x,this._step.y)},setStep:function(e){this._step.x=e.x,this._step.y=e.y},isTextureFlipped:function(){return this._isTextureFlipped},setTextureFlipped:function(e){this._isTextureFlipped!==e&&(this._isTextureFlipped=e,this.calculateVertexPoints())},initWithSize:function(e,t,i,n){if(!t){var s=l.director.getWinSizeInPixels(),r=l.NextPOT(s.width),a=l.NextPOT(s.height),o=new Uint8Array(r*a*4);if(!o)return l.log("cocos2d: CCGrid: not enough memory."),!1;if((t=new l.Texture2D).initWithData(o,l.Texture2D.PIXEL_FORMAT_RGBA8888,r,a,s),!t)return l.log("cocos2d: CCGrid: error creating texture"),!1}if(i=i||!1,this._active=!1,this._reuseGrid=0,this._gridSize=e,this._texture=t,this._isTextureFlipped=i,void 0===n||l._rectEqualToZero(n)){var h=this._texture.getContentSize();n=new l.rect(0,0,h.width,h.height)}return this._gridRect=n,this._step.x=this._gridRect.width/e.width,this._step.y=this._gridRect.height/e.height,this._grabber=new l.Grabber,!!this._grabber&&(this._grabber.grab(this._texture),this._glProgramState=l.GLProgramState.getOrCreateWithGLProgram(l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURE)),this.calculateVertexPoints(),!0)},beforeDraw:function(){this._directorProjection=l.director.getProjection();var e=l.director.getWinSizeInPixels();gl.viewport(0,0,e.width,e.height),this._grabber.beforeRender(this._texture)},afterDraw:function(e){this._grabber.afterRender(this._texture),l.director.setViewport(),l.glBindTexture2D(this._texture),this.beforeBlit(),this.blit(e),this.afterBlit()},beforeBlit:function(){},afterBlit:function(){},blit:function(){l.log("cc.GridBase.blit(): Shall be overridden in subclass.")},reuse:function(){l.log("cc.GridBase.reuse(): Shall be overridden in subclass.")},calculateVertexPoints:function(){l.log("cc.GridBase.calculateVertexPoints(): Shall be overridden in subclass.")},set2DProjection:function(){var e=l.director.getWinSizeInPixels();l._renderContext.viewport(0,0,e.width,e.height),l.kmGLMatrixMode(l.KM_GL_PROJECTION),l.kmGLLoadIdentity();var t=l.math.Matrix4.createOrthographicProjection(0,e.width,0,e.height,-1,1);l.kmGLMultMatrix(t),l.kmGLMatrixMode(l.KM_GL_MODELVIEW),l.kmGLLoadIdentity(),l.setProjectionMatrixDirty()}}),l.GridBase.create=function(e,t,i,n){return new l.GridBase(e,t,i,n)},l.Grid3D=l.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,_needDepthTestForBlit:!1,_oldDepthTestValue:!1,_oldDepthWriteValue:!1,ctor:function(e,t,i,n){l.GridBase.prototype.ctor.call(this),this._texCoordinates=null,this._vertices=null,this._originalVertices=null,this._indices=null,this._texCoordinateBuffer=null,this._verticesBuffer=null,this._indicesBuffer=null,this._matrix=new l.math.Matrix4,this._matrix.identity(),void 0!==e&&this.initWithSize(e,t,i,n)},vertex:function(e){return this.getVertex(e)},getVertex:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||l.log("cc.Grid3D.vertex() : Numbers must be integers");var t=0|3*(e.x*(this._gridSize.height+1)+e.y),i=this._vertices;return new l.Vertex3F(i[t],i[t+1],i[t+2])},originalVertex:function(e){return this.getOriginalVertex(e)},getOriginalVertex:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||l.log("cc.Grid3D.originalVertex() : Numbers must be integers");var t=0|3*(e.x*(this._gridSize.height+1)+e.y),i=this._originalVertices;return new l.Vertex3F(i[t],i[t+1],i[t+2])},setVertex:function(e,t){e.x===(0|e.x)&&e.y===(0|e.y)||l.log("cc.Grid3D.setVertex() : Numbers must be integers");var i=0|3*(e.x*(this._gridSize.height+1)+e.y),n=this._vertices;n[i]=t.x,n[i+1]=t.y,n[i+2]=t.z,this._dirty=!0},beforeBlit:function(){if(this._needDepthTestForBlit){var e=l._renderContext;this._oldDepthTestValue=e.isEnabled(e.DEPTH_TEST),this._oldDepthWriteValue=e.getParameter(e.DEPTH_WRITEMASK),e.enable(e.DEPTH_TEST),e.depthMask(!0)}},afterBlit:function(){if(this._needDepthTestForBlit){var e=l._renderContext;this._oldDepthTestValue?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(this._oldDepthWriteValue)}},blit:function(e){var t=this._gridSize.width*this._gridSize.height,i=e._renderCmd._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._glProgramState.apply(this._matrix);var n=l._renderContext,s=this._dirty;n.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),n.bindBuffer(n.ARRAY_BUFFER,this._verticesBuffer),s&&n.bufferData(n.ARRAY_BUFFER,this._vertices,n.DYNAMIC_DRAW),n.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this._texCoordinateBuffer),s&&n.bufferData(n.ARRAY_BUFFER,this._texCoordinates,n.DYNAMIC_DRAW),n.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),s&&n.bufferData(n.ELEMENT_ARRAY_BUFFER,this._indices,n.STATIC_DRAW),n.drawElements(n.TRIANGLES,6*t,n.UNSIGNED_SHORT,0),s&&(this._dirty=!1),l.incrementGLDraws(1)},reuse:function(){if(this._reuseGrid>0){for(var e=this._originalVertices,t=this._vertices,i=0,n=this._vertices.length;i<n;i++)e[i]=t[i];--this._reuseGrid}},calculateVertexPoints:function(){var e=l._renderContext,t=this._texture.pixelsWidth,i=this._texture.pixelsHeight,n=this._texture.getContentSizeInPixels().height,s=this._gridSize,r=(s.width+1)*(s.height+1);this._vertices=new Float32Array(3*r),this._texCoordinates=new Float32Array(2*r),this._indices=new Uint16Array(s.width*s.height*6),this._verticesBuffer&&e.deleteBuffer(this._verticesBuffer),this._verticesBuffer=e.createBuffer(),this._texCoordinateBuffer&&e.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=e.createBuffer(),this._indicesBuffer&&e.deleteBuffer(this._indicesBuffer),this._indicesBuffer=e.createBuffer();var a,o,h,d=this._indices,c=this._texCoordinates,u=this._isTextureFlipped,p=this._vertices;for(a=0;a<s.width;++a)for(o=0;o<s.height;++o){var m=o*s.width+a,_=a*this._step.x+this._gridRect.x,g=_+this._step.x,T=o*this._step.y+this._gridRect.y,f=T+this._step.y,S=a*(s.height+1)+o,w=(a+1)*(s.height+1)+o,v=(a+1)*(s.height+1)+(o+1),L=a*(s.height+1)+(o+1);d[6*m]=S,d[6*m+1]=w,d[6*m+2]=L,d[6*m+3]=w,d[6*m+4]=v,d[6*m+5]=L;var M=[3*S,3*w,3*v,3*L],C=[{x:_,y:T,z:0},{x:g,y:T,z:0},{x:g,y:f,z:0},{x:_,y:f,z:0}],y=[2*S,2*w,2*v,2*L],B=[l.p(_,T),l.p(g,T),l.p(g,f),l.p(_,f)];for(h=0;h<4;++h)p[M[h]]=C[h].x,p[M[h]+1]=C[h].y,p[M[h]+2]=C[h].z,c[y[h]]=B[h].x/t,c[y[h]+1]=u?(n-B[h].y)/i:B[h].y/i}this._originalVertices=new Float32Array(this._vertices),e.bindBuffer(e.ARRAY_BUFFER,this._verticesBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._texCoordinateBuffer),e.bufferData(e.ARRAY_BUFFER,this._texCoordinates,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW),this._dirty=!0},setNeedDepthTestForBlit:function(e){this._needDepthTestForBlit=e},getNeedDepthTestForBlit:function(){return this._needDepthTestForBlit}}),l.Grid3D.create=function(e,t,i){return new l.Grid3D(e,t,i)},l.TiledGrid3D=l.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,ctor:function(e,t,i,n){l.GridBase.prototype.ctor.call(this),this._texCoordinates=null,this._vertices=null,this._originalVertices=null,this._indices=null,this._texCoordinateBuffer=null,this._verticesBuffer=null,this._indicesBuffer=null,this._matrix=new l.math.Matrix4,this._matrix.identity(),void 0!==e&&this.initWithSize(e,t,i,n)},tile:function(e){return this.getTile(e)},getTile:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||l.log("cc.TiledGrid3D.tile() : Numbers must be integers");var t=4*(this._gridSize.height*e.x+e.y)*3,i=this._vertices;return new l.Quad3(new l.Vertex3F(i[t],i[t+1],i[t+2]),new l.Vertex3F(i[t+3],i[t+4],i[t+5]),new l.Vertex3F(i[t+6],i[t+7],i[t+8]),new l.Vertex3F(i[t+9],i[t+10],i[t+11]))},getOriginalTile:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||l.log("cc.TiledGrid3D.originalTile() : Numbers must be integers");var t=4*(this._gridSize.height*e.x+e.y)*3,i=this._originalVertices;return new l.Quad3(new l.Vertex3F(i[t],i[t+1],i[t+2]),new l.Vertex3F(i[t+3],i[t+4],i[t+5]),new l.Vertex3F(i[t+6],i[t+7],i[t+8]),new l.Vertex3F(i[t+9],i[t+10],i[t+11]))},originalTile:function(e){return this.getOriginalTile(e)},setTile:function(e,t){e.x===(0|e.x)&&e.y===(0|e.y)||l.log("cc.TiledGrid3D.setTile() : Numbers must be integers");var i=12*(this._gridSize.height*e.x+e.y),n=this._vertices;n[i]=t.bl.x,n[i+1]=t.bl.y,n[i+2]=t.bl.z,n[i+3]=t.br.x,n[i+4]=t.br.y,n[i+5]=t.br.z,n[i+6]=t.tl.x,n[i+7]=t.tl.y,n[i+8]=t.tl.z,n[i+9]=t.tr.x,n[i+10]=t.tr.y,n[i+11]=t.tr.z,this._dirty=!0},blit:function(e){var t=this._gridSize.width*this._gridSize.height,i=e._renderCmd._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._glProgramState.apply(this._matrix);var n=l._renderContext,s=this._dirty;n.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),n.bindBuffer(n.ARRAY_BUFFER,this._verticesBuffer),s&&n.bufferData(n.ARRAY_BUFFER,this._vertices,n.DYNAMIC_DRAW),n.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,0,this._vertices),n.bindBuffer(n.ARRAY_BUFFER,this._texCoordinateBuffer),s&&n.bufferData(n.ARRAY_BUFFER,this._texCoordinates,n.DYNAMIC_DRAW),n.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,0,this._texCoordinates),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),s&&n.bufferData(n.ELEMENT_ARRAY_BUFFER,this._indices,n.STATIC_DRAW),n.drawElements(n.TRIANGLES,6*t,n.UNSIGNED_SHORT,0),s&&(this._dirty=!1),l.incrementGLDraws(1)},reuse:function(){if(this._reuseGrid>0){for(var e=this._vertices,t=this._originalVertices,i=0;i<e.length;i++)t[i]=e[i];--this._reuseGrid}},calculateVertexPoints:function(){var e=this._texture.pixelsWidth,t=this._texture.pixelsHeight,i=this._texture.getContentSizeInPixels().height,n=this._gridSize,s=n.width*n.height;this._vertices=new Float32Array(12*s),this._texCoordinates=new Float32Array(8*s),this._indices=new Uint16Array(6*s);var r=l._renderContext;this._verticesBuffer&&r.deleteBuffer(this._verticesBuffer),this._verticesBuffer=r.createBuffer(),this._texCoordinateBuffer&&r.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=r.createBuffer(),this._indicesBuffer&&r.deleteBuffer(this._indicesBuffer),this._indicesBuffer=r.createBuffer();var a,o,h=0,d=this._step,c=this._vertices,u=this._texCoordinates,p=this._isTextureFlipped;for(a=0;a<n.width;a++)for(o=0;o<n.height;o++){var m=a*d.x,_=m+d.x,g=o*d.y,T=g+d.y;c[12*h]=m,c[12*h+1]=g,c[12*h+2]=0,c[12*h+3]=_,c[12*h+4]=g,c[12*h+5]=0,c[12*h+6]=m,c[12*h+7]=T,c[12*h+8]=0,c[12*h+9]=_,c[12*h+10]=T,c[12*h+11]=0;var f=g,S=T;p&&(f=i-g,S=i-T),u[8*h]=m/e,u[8*h+1]=f/t,u[8*h+2]=_/e,u[8*h+3]=f/t,u[8*h+4]=m/e,u[8*h+5]=S/t,u[8*h+6]=_/e,u[8*h+7]=S/t,h++}var w=this._indices;for(a=0;a<s;a++)w[6*a+0]=4*a+0,w[6*a+1]=4*a+1,w[6*a+2]=4*a+2,w[6*a+3]=4*a+1,w[6*a+4]=4*a+2,w[6*a+5]=4*a+3;this._originalVertices=new Float32Array(this._vertices),r.bindBuffer(r.ARRAY_BUFFER,this._verticesBuffer),r.bufferData(r.ARRAY_BUFFER,this._vertices,r.DYNAMIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,this._texCoordinateBuffer),r.bufferData(r.ARRAY_BUFFER,this._texCoordinates,r.DYNAMIC_DRAW),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,this._indices,r.DYNAMIC_DRAW),this._dirty=!0}}),l.TiledGrid3D.create=function(e,t,i){return new l.TiledGrid3D(e,t,i)},l.Grabber=l.Class.extend({_FBO:null,_oldFBO:null,_oldClearColor:null,_gl:null,ctor:function(){l.sys._checkWebGLRenderMode(),this._gl=l._renderContext,this._oldClearColor=[0,0,0,0],this._oldFBO=null,this._FBO=this._gl.createFramebuffer()},grab:function(e){var t=this._gl;this._oldFBO=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this._FBO),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e._webTextureObj,0),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&l.log("Frame Grabber: could not attach texture to frmaebuffer"),t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO)},beforeRender:function(e){var t=this._gl;this._oldFBO=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this._FBO),this._oldClearColor=t.getParameter(t.COLOR_CLEAR_VALUE),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},afterRender:function(e){var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO),t.colorMask(!0,!0,!0,!0)},destroy:function(){this._gl.deleteFramebuffer(this._FBO)}}),l.math=l.math||{},l.math.EPSILON=1/64,l.math.square=function(e){return e*e},l.math.almostEqual=function(e,t){return e+l.math.EPSILON>t&&e-l.math.EPSILON<t},function(e){e.math.Vec2=function(e,t){void 0===t?(this.x=e.x,this.y=e.y):(this.x=e||0,this.y=t||0)};var t=e.math.Vec2.prototype;t.fill=function(e,t){this.x=e,this.y=t},t.length=function(){return Math.sqrt(e.math.square(this.x)+e.math.square(this.y))},t.lengthSq=function(){return e.math.square(this.x)+e.math.square(this.y)},t.normalize=function(){var e=1/this.length();return this.x*=e,this.y*=e,this},e.math.Vec2.add=function(e,t,i){return e.x=t.x+i.x,e.y=t.y+i.y,e},t.add=function(e){return this.x+=e.x,this.y+=e.y,this},t.dot=function(e){return this.x*e.x+this.y*e.y},e.math.Vec2.subtract=function(e,t,i){return e.x=t.x-i.x,e.y=t.y-i.y,e},t.subtract=function(e){return this.x-=e.x,this.y-=e.y,this},t.transform=function(e){var t=this.x,i=this.y;return this.x=t*e.mat[0]+i*e.mat[3]+e.mat[6],this.y=t*e.mat[1]+i*e.mat[4]+e.mat[7],this},e.math.Vec2.scale=function(e,t,i){return e.x=t.x*i,e.y=t.y*i,e},t.scale=function(e){return this.x*=e,this.y*=e,this},t.equals=function(t){return this.x<t.x+e.math.EPSILON&&this.x>t.x-e.math.EPSILON&&this.y<t.y+e.math.EPSILON&&this.y>t.y-e.math.EPSILON}}(l),function(e){e.math.Vec3=e.kmVec3=function(e,t,i){e&&void 0===t?(this.x=e.x,this.y=e.y,this.z=e.z):(this.x=e||0,this.y=t||0,this.z=i||0)},e.math.vec3=function(t,i,n){return new e.math.Vec3(t,i,n)};var t=e.math.Vec3.prototype;t.fill=function(e,t,i){return e&&void 0===t?(this.x=e.x,this.y=e.y,this.z=e.z):(this.x=e,this.y=t,this.z=i),this},t.length=function(){return Math.sqrt(e.math.square(this.x)+e.math.square(this.y)+e.math.square(this.z))},t.lengthSq=function(){return e.math.square(this.x)+e.math.square(this.y)+e.math.square(this.z)},t.normalize=function(){var e=1/this.length();return this.x*=e,this.y*=e,this.z*=e,this},t.cross=function(e){var t=this.x,i=this.y,n=this.z;return this.x=i*e.z-n*e.y,this.y=n*e.x-t*e.z,this.z=t*e.y-i*e.x,this},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},t.add=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},t.subtract=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},t.transform=function(e){var t=this.x,i=this.y,n=this.z,s=e.mat;return this.x=t*s[0]+i*s[4]+n*s[8]+s[12],this.y=t*s[1]+i*s[5]+n*s[9]+s[13],this.z=t*s[2]+i*s[6]+n*s[10]+s[14],this},t.transformNormal=function(e){var t=this.x,i=this.y,n=this.z,s=e.mat;return this.x=t*s[0]+i*s[4]+n*s[8],this.y=t*s[1]+i*s[5]+n*s[9],this.z=t*s[2]+i*s[6]+n*s[10],this},t.transformCoord=function(t){var i=new e.math.Vec4(this.x,this.y,this.z,1);return i.transform(t),this.x=i.x/i.w,this.y=i.y/i.w,this.z=i.z/i.w,this},t.scale=function(e){return this.x*=e,this.y*=e,this.z*=e,this},t.equals=function(t){var i=e.math.EPSILON;return this.x<t.x+i&&this.x>t.x-i&&this.y<t.y+i&&this.y>t.y-i&&this.z<t.z+i&&this.z>t.z-i},t.inverseTransform=function(t){var i=t.mat,n=new e.math.Vec3(this.x-i[12],this.y-i[13],this.z-i[14]);return this.x=n.x*i[0]+n.y*i[1]+n.z*i[2],this.y=n.x*i[4]+n.y*i[5]+n.z*i[6],this.z=n.x*i[8]+n.y*i[9]+n.z*i[10],this},t.inverseTransformNormal=function(e){var t=this.x,i=this.y,n=this.z,s=e.mat;return this.x=t*s[0]+i*s[1]+n*s[2],this.y=t*s[4]+i*s[5]+n*s[6],this.z=t*s[8]+i*s[9]+n*s[10],this},t.assignFrom=function(e){return e?(this.x=e.x,this.y=e.y,this.z=e.z,this):this},e.math.Vec3.zero=function(e){return e.x=e.y=e.z=0,e},t.toTypeArray=function(){var e=new Float32Array(3);return e[0]=this.x,e[1]=this.y,e[2]=this.z,e}}(l),function(e){e.math.Vec4=function(e,t,i,n){e&&void 0===t?(this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w):(this.x=e||0,this.y=t||0,this.z=i||0,this.w=n||0)},e.kmVec4=e.math.Vec4;var t=e.math.Vec4.prototype;t.fill=function(e,t,i,n){e&&void 0===t?(this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w):(this.x=e,this.y=t,this.z=i,this.w=n)},t.add=function(e){return e?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this):this},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},t.length=function(){return Math.sqrt(e.math.square(this.x)+e.math.square(this.y)+e.math.square(this.z)+e.math.square(this.w))},t.lengthSq=function(){return e.math.square(this.x)+e.math.square(this.y)+e.math.square(this.z)+e.math.square(this.w)},t.lerp=function(e,t){return this},t.normalize=function(){var e=1/this.length();return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},t.scale=function(e){return this.normalize(),this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},t.subtract=function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w},t.transform=function(e){var t=this.x,i=this.y,n=this.z,s=this.w,r=e.mat;return this.x=t*r[0]+i*r[4]+n*r[8]+s*r[12],this.y=t*r[1]+i*r[5]+n*r[9]+s*r[13],this.z=t*r[2]+i*r[6]+n*r[10]+s*r[14],this.w=t*r[3]+i*r[7]+n*r[11]+s*r[15],this},e.math.Vec4.transformArray=function(t,i){for(var n=[],s=0;s<t.length;s++){var r=new e.math.Vec4(t[s]);r.transform(i),n.push(r)}return n},t.equals=function(t){var i=e.math.EPSILON;return this.x<t.x+i&&this.x>t.x-i&&this.y<t.y+i&&this.y>t.y-i&&this.z<t.z+i&&this.z>t.z-i&&this.w<t.w+i&&this.w>t.w-i},t.assignFrom=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},t.toTypeArray=function(){var e=new Float32Array(4);return e[0]=this.x,e[1]=this.y,e[2]=this.z,e[3]=this.w,e}}(l),function(e){function t(t,i,n){var s=new e.math.Vec2(i);s.subtract(t),n.x=-s.y,n.y=s.x,n.normalize()}e.math.Ray2=function(t,i){this.start=t||new e.math.Vec2,this.dir=i||new e.math.Vec2},e.math.Ray2.prototype.fill=function(e,t,i,n){this.start.x=e,this.start.y=t,this.dir.x=i,this.dir.y=n},e.math.Ray2.prototype.intersectLineSegment=function(t,i,n){var s,r,a,o=this.start.x,h=this.start.y,l=this.start.x+this.dir.x,d=this.start.y+this.dir.y,c=t.x,u=t.y,p=i.x,m=i.y,_=(m-u)*(l-o)-(p-c)*(d-h);return!(_>-e.math.EPSILON&&_<e.math.EPSILON)&&(s=((p-c)*(h-u)-(m-u)*(o-c))/_,r=o+s*(l-o),a=h+s*(d-h),!(r<Math.min(t.x,i.x)-e.math.EPSILON||r>Math.max(t.x,i.x)+e.math.EPSILON||a<Math.min(t.y,i.y)-e.math.EPSILON||a>Math.max(t.y,i.y)+e.math.EPSILON)&&(!(r<Math.min(o,l)-e.math.EPSILON||r>Math.max(o,l)+e.math.EPSILON||a<Math.min(h,d)-e.math.EPSILON||a>Math.max(h,d)+e.math.EPSILON)&&(n.x=r,n.y=a,!0)))},e.math.Ray2.prototype.intersectTriangle=function(i,n,s,r,a){var o,h=new e.math.Vec2,l=new e.math.Vec2,d=new e.math.Vec2,c=1e4,u=!1;return this.intersectLineSegment(i,n,h)&&(u=!0,(o=h.subtract(this.start).length())<c&&(l.x=h.x,l.y=h.y,c=o,t(i,n,d))),this.intersectLineSegment(n,s,h)&&(u=!0,(o=h.subtract(this.start).length())<c&&(l.x=h.x,l.y=h.y,c=o,t(n,s,d))),this.intersectLineSegment(s,i,h)&&(u=!0,(o=h.subtract(this.start).length())<c&&(l.x=h.x,l.y=h.y,c=o,t(s,i,d))),u&&(r.x=l.x,r.y=l.y,a&&(a.x=d.x,a.y=d.y)),u}}(l),window.Uint16Array=window.Uint16Array||window.Array,window.Float32Array=window.Float32Array||window.Array,function(e){e.math.Matrix3=function(e){e&&e.mat?this.mat=new Float32Array(e.mat):this.mat=new Float32Array(9)},e.kmMat3=e.math.Matrix3;var t=e.math.Matrix3.prototype;t.fill=function(e){var t=this.mat,i=e.mat;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this},t.adjugate=function(){var e=this.mat,t=e[0],i=e[1],n=e[2],s=e[3],r=e[4],a=e[5],o=e[6],h=e[7],l=e[8];return e[0]=r*l-a*h,e[1]=n*h-i*l,e[2]=i*a-n*r,e[3]=a*o-s*l,e[4]=t*l-n*o,e[5]=n*s-t*a,e[6]=s*h-r*o,e[8]=t*r-i*s,this},t.identity=function(){var e=this.mat;return e[1]=e[2]=e[3]=e[5]=e[6]=e[7]=0,e[0]=e[4]=e[8]=1,this};var i=new e.math.Matrix3;t.inverse=function(e){if(0===e)return this;i.assignFrom(this);var t=1/e;return this.adjugate(),this.multiplyScalar(t),this},t.isIdentity=function(){var e=this.mat;return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&1===e[4]&&0===e[5]&&0===e[6]&&0===e[7]&&1===e[8]},t.transpose=function(){var e=this.mat,t=e[1],i=e[2],n=e[3],s=e[5],r=e[6],a=e[7];return e[1]=n,e[2]=r,e[3]=t,e[5]=a,e[6]=i,e[7]=s,this},t.determinant=function(){var e=this.mat,t=e[0]*e[4]*e[8]+e[1]*e[5]*e[6]+e[2]*e[3]*e[7];return t-=e[2]*e[4]*e[6]+e[0]*e[5]*e[7]+e[1]*e[3]*e[8]},t.multiply=function(e){var t=this.mat,i=e.mat,n=t[0],s=t[1],r=t[2],a=t[3],o=t[4],h=t[5],l=t[6],d=t[7],c=t[8],u=i[0],p=i[1],m=i[2],_=i[3],g=i[4],T=i[5],f=i[6],S=i[7],w=i[8];return t[0]=n*u+a*p+l*m,t[1]=s*u+o*p+d*m,t[2]=r*u+h*p+c*m,t[3]=r*u+h*p+c*m,t[4]=s*_+o*g+d*T,t[5]=r*_+h*g+c*T,t[6]=n*f+a*S+l*w,t[7]=s*f+o*S+d*w,t[8]=r*f+h*S+c*w,this},t.multiplyScalar=function(e){var t=this.mat;return t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,this},e.math.Matrix3.rotationAxisAngle=function(t,i){var n=Math.cos(i),s=Math.sin(i),r=new e.math.Matrix3,a=r.mat;return a[0]=n+t.x*t.x*(1-n),a[1]=t.z*s+t.y*t.x*(1-n),a[2]=-t.y*s+t.z*t.x*(1-n),a[3]=-t.z*s+t.x*t.y*(1-n),a[4]=n+t.y*t.y*(1-n),a[5]=t.x*s+t.z*t.y*(1-n),a[6]=t.y*s+t.x*t.z*(1-n),a[7]=-t.x*s+t.y*t.z*(1-n),a[8]=n+t.z*t.z*(1-n),r},t.assignFrom=function(t){if(this===t)return e.log("cc.math.Matrix3.assign(): current matrix equals matIn"),this;var i=this.mat,n=t.mat;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this},t.equals=function(t){if(this===t)return!0;for(var i=e.math.EPSILON,n=this.mat,s=t.mat,r=0;r<9;++r)if(!(n[r]+i>s[r]&&n[r]-i<s[r]))return!1;return!0},e.math.Matrix3.createByRotationX=function(t){var i=new e.math.Matrix3,n=i.mat;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=Math.cos(t),n[5]=Math.sin(t),n[6]=0,n[7]=-Math.sin(t),n[8]=Math.cos(t),i},e.math.Matrix3.createByRotationY=function(t){var i=new e.math.Matrix3,n=i.mat;return n[0]=Math.cos(t),n[1]=0,n[2]=-Math.sin(t),n[3]=0,n[4]=1,n[5]=0,n[6]=Math.sin(t),n[7]=0,n[8]=Math.cos(t),i},e.math.Matrix3.createByRotationZ=function(t){var i=new e.math.Matrix3,n=i.mat;return n[0]=Math.cos(t),n[1]=-Math.sin(t),n[2]=0,n[3]=Math.sin(t),n[4]=Math.cos(t),n[5]=0,n[6]=0,n[7]=0,n[8]=1,i},e.math.Matrix3.createByRotation=function(t){var i=new e.math.Matrix3,n=i.mat;return n[0]=Math.cos(t),n[1]=Math.sin(t),n[2]=0,n[3]=-Math.sin(t),n[4]=Math.cos(t),n[5]=0,n[6]=0,n[7]=0,n[8]=1,i},e.math.Matrix3.createByScale=function(t,i){var n=new e.math.Matrix3;return n.identity(),n.mat[0]=t,n.mat[4]=i,n},e.math.Matrix3.createByTranslation=function(t,i){var n=new e.math.Matrix3;return n.identity(),n.mat[6]=t,n.mat[7]=i,n},e.math.Matrix3.createByQuaternion=function(t){if(!t)return null;var i=new e.math.Matrix3,n=i.mat;return n[0]=1-2*(t.y*t.y+t.z*t.z),n[1]=2*(t.x*t.y-t.w*t.z),n[2]=2*(t.x*t.z+t.w*t.y),n[3]=2*(t.x*t.y+t.w*t.z),n[4]=1-2*(t.x*t.x+t.z*t.z),n[5]=2*(t.y*t.z-t.w*t.x),n[6]=2*(t.x*t.z-t.w*t.y),n[7]=2*(t.y*t.z+t.w*t.x),n[8]=1-2*(t.x*t.x+t.y*t.y),i},t.rotationToAxisAngle=function(){return e.math.Quaternion.rotationMatrix(this).toAxisAndAngle()}}(l),function(e){e.math.Matrix4=function(e){e&&e.mat?this.mat=new Float32Array(e.mat):this.mat=new Float32Array(16)},e.kmMat4=e.math.Matrix4;var t=e.math.Matrix4.prototype;t.fill=function(e){for(var t=this.mat,i=0;i<16;i++)t[i]=e[i];return this},e.kmMat4Identity=function(e){var t=e.mat;return t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,t[0]=t[5]=t[10]=t[15]=1,e},t.identity=function(){var e=this.mat;return e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0,e[0]=e[5]=e[10]=e[15]=1,this},t.get=function(e,t){return this.mat[e+4*t]},t.set=function(e,t,i){this.mat[e+4*t]=i},t.swap=function(e,t,i,n){var s=this.mat,r=s[e+4*t];s[e+4*t]=s[i+4*n],s[i+4*n]=r},e.math.Matrix4._gaussj=function(e,t){var i,n,s,r,a,o,h,l,d,c=0,u=0,p=[0,0,0,0],m=[0,0,0,0],_=[0,0,0,0];for(i=0;i<4;i++){for(h=0,n=0;n<4;n++)if(1!==_[n])for(s=0;s<4;s++)0===_[s]&&(o=Math.abs(e.get(n,s)))>=h&&(h=o,u=n,c=s);if(++_[c],u!==c){for(r=0;r<4;r++)e.swap(u,r,c,r);for(r=0;r<4;r++)t.swap(u,r,c,r)}if(m[i]=u,p[i]=c,0===e.get(c,c))return!1;for(d=1/e.get(c,c),e.set(c,c,1),r=0;r<4;r++)e.set(c,r,e.get(c,r)*d);for(r=0;r<4;r++)t.set(c,r,t.get(c,r)*d);for(a=0;a<4;a++)if(a!==c){for(l=e.get(a,c),e.set(a,c,0),r=0;r<4;r++)e.set(a,r,e.get(a,r)-e.get(c,r)*l);for(r=0;r<4;r++)t.set(a,r,e.get(a,r)-t.get(c,r)*l)}}for(r=3;r>=0;r--)if(m[r]!==p[r])for(s=0;s<4;s++)e.swap(s,m[r],s,p[r]);return!0};var i=(new e.math.Matrix4).identity();e.kmMat4Inverse=function(t,n){var s=new e.math.Matrix4(n),r=new e.math.Matrix4(i);return!1===e.math.Matrix4._gaussj(s,r)?null:(t.assignFrom(s),t)},t.inverse=function(){var t=new e.math.Matrix4(this),n=new e.math.Matrix4(i);return!1===e.math.Matrix4._gaussj(t,n)?null:t},t.isIdentity=function(){var e=this.mat;return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]},t.transpose=function(){var e=this.mat,t=e[1],i=e[2],n=e[3],s=e[4],r=e[6],a=e[7],o=e[8],h=e[9],l=e[11],d=e[12],c=e[13],u=e[14];return e[1]=s,e[2]=o,e[3]=d,e[4]=t,e[6]=h,e[7]=c,e[8]=i,e[9]=r,e[11]=u,e[12]=n,e[13]=a,e[14]=l,this},e.kmMat4Multiply=function(e,t,i){var n=e.mat,s=t.mat,r=i.mat,a=s[0],o=s[1],h=s[2],l=s[3],d=s[4],c=s[5],u=s[6],p=s[7],m=s[8],_=s[9],g=s[10],T=s[11],f=s[12],S=s[13],w=s[14],v=s[15],L=r[0],M=r[1],C=r[2],y=r[3],B=r[4],F=r[5],E=r[6],P=r[7],b=r[8],A=r[9],O=r[10],I=r[11],R=r[12],D=r[13],x=r[14],N=r[15];return n[0]=L*a+M*d+C*m+y*f,n[1]=L*o+M*c+C*_+y*S,n[2]=L*h+M*u+C*g+y*w,n[3]=L*l+M*p+C*T+y*v,n[4]=B*a+F*d+E*m+P*f,n[5]=B*o+F*c+E*_+P*S,n[6]=B*h+F*u+E*g+P*w,n[7]=B*l+F*p+E*T+P*v,n[8]=b*a+A*d+O*m+I*f,n[9]=b*o+A*c+O*_+I*S,n[10]=b*h+A*u+O*g+I*w,n[11]=b*l+A*p+O*T+I*v,n[12]=R*a+D*d+x*m+N*f,n[13]=R*o+D*c+x*_+N*S,n[14]=R*h+D*u+x*g+N*w,n[15]=R*l+D*p+x*T+N*v,e},t.multiply=function(e){var t=this.mat,i=e.mat,n=t[0],s=t[1],r=t[2],a=t[3],o=t[4],h=t[5],l=t[6],d=t[7],c=t[8],u=t[9],p=t[10],m=t[11],_=t[12],g=t[13],T=t[14],f=t[15],S=i[0],w=i[1],v=i[2],L=i[3],M=i[4],C=i[5],y=i[6],B=i[7],F=i[8],E=i[9],P=i[10],b=i[11],A=i[12],O=i[13],I=i[14],R=i[15];return t[0]=S*n+w*o+v*c+L*_,t[1]=S*s+w*h+v*u+L*g,t[2]=S*r+w*l+v*p+L*T,t[3]=S*a+w*d+v*m+L*f,t[4]=M*n+C*o+y*c+B*_,t[5]=M*s+C*h+y*u+B*g,t[6]=M*r+C*l+y*p+B*T,t[7]=M*a+C*d+y*m+B*f,t[8]=F*n+E*o+P*c+b*_,t[9]=F*s+E*h+P*u+b*g,t[10]=F*r+E*l+P*p+b*T,t[11]=F*a+E*d+P*m+b*f,t[12]=A*n+O*o+I*c+R*_,t[13]=A*s+O*h+I*u+R*g,t[14]=A*r+O*l+I*p+R*T,t[15]=A*a+O*d+I*m+R*f,this},e.getMat4MultiplyValue=function(e,t){var i=e.mat,n=t.mat,s=new Float32Array(16);return s[0]=i[0]*n[0]+i[4]*n[1]+i[8]*n[2]+i[12]*n[3],s[1]=i[1]*n[0]+i[5]*n[1]+i[9]*n[2]+i[13]*n[3],s[2]=i[2]*n[0]+i[6]*n[1]+i[10]*n[2]+i[14]*n[3],s[3]=i[3]*n[0]+i[7]*n[1]+i[11]*n[2]+i[15]*n[3],s[4]=i[0]*n[4]+i[4]*n[5]+i[8]*n[6]+i[12]*n[7],s[5]=i[1]*n[4]+i[5]*n[5]+i[9]*n[6]+i[13]*n[7],s[6]=i[2]*n[4]+i[6]*n[5]+i[10]*n[6]+i[14]*n[7],s[7]=i[3]*n[4]+i[7]*n[5]+i[11]*n[6]+i[15]*n[7],s[8]=i[0]*n[8]+i[4]*n[9]+i[8]*n[10]+i[12]*n[11],s[9]=i[1]*n[8]+i[5]*n[9]+i[9]*n[10]+i[13]*n[11],s[10]=i[2]*n[8]+i[6]*n[9]+i[10]*n[10]+i[14]*n[11],s[11]=i[3]*n[8]+i[7]*n[9]+i[11]*n[10]+i[15]*n[11],s[12]=i[0]*n[12]+i[4]*n[13]+i[8]*n[14]+i[12]*n[15],s[13]=i[1]*n[12]+i[5]*n[13]+i[9]*n[14]+i[13]*n[15],s[14]=i[2]*n[12]+i[6]*n[13]+i[10]*n[14]+i[14]*n[15],s[15]=i[3]*n[12]+i[7]*n[13]+i[11]*n[14]+i[15]*n[15],s},e.kmMat4Assign=function(t,i){if(t===i)return e.log("cc.kmMat4Assign(): pOut equals pIn"),t;var n=t.mat,s=i.mat;return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],t},t.assignFrom=function(t){if(this===t)return e.log("cc.mat.Matrix4.assignFrom(): mat4 equals current matrix"),this;var i=this.mat,n=t.mat;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},t.equals=function(t){if(this===t)return e.log("cc.kmMat4AreEqual(): pMat1 and pMat2 are same object."),!0;for(var i=this.mat,n=t.mat,s=e.math.EPSILON,r=0;r<16;r++)if(!(i[r]+s>n[r]&&i[r]-s<n[r]))return!1;return!0},e.math.Matrix4.createByRotationX=function(t,i){var n=(i=i||new e.math.Matrix4).mat;return n[0]=1,n[3]=n[2]=n[1]=0,n[4]=0,n[5]=Math.cos(t),n[6]=Math.sin(t),n[7]=0,n[8]=0,n[9]=-Math.sin(t),n[10]=Math.cos(t),n[11]=0,n[14]=n[13]=n[12]=0,n[15]=1,i},e.math.Matrix4.createByRotationY=function(t,i){var n=(i=i||new e.math.Matrix4).mat;return n[0]=Math.cos(t),n[1]=0,n[2]=-Math.sin(t),n[3]=0,n[7]=n[6]=n[4]=0,n[5]=1,n[8]=Math.sin(t),n[9]=0,n[10]=Math.cos(t),n[11]=0,n[14]=n[13]=n[12]=0,n[15]=1,i},e.math.Matrix4.createByRotationZ=function(t,i){var n=(i=i||new e.math.Matrix4).mat;return n[0]=Math.cos(t),n[1]=Math.sin(t),n[3]=n[2]=0,n[4]=-Math.sin(t),n[5]=Math.cos(t),n[7]=n[6]=0,n[11]=n[9]=n[8]=0,n[10]=1,n[14]=n[13]=n[12]=0,n[15]=1,i},e.math.Matrix4.createByPitchYawRoll=function(t,i,n,s){s=s||new e.math.Matrix4;var r=Math.cos(t),a=Math.sin(t),o=Math.cos(i),h=Math.sin(i),l=Math.cos(n),d=Math.sin(n),c=a*h,u=r*h,p=s.mat;return p[0]=o*l,p[4]=o*d,p[8]=-h,p[1]=c*l-r*d,p[5]=c*d+r*l,p[9]=a*o,p[2]=u*l+a*d,p[6]=u*d-a*l,p[10]=r*o,p[3]=p[7]=p[11]=0,p[15]=1,s},e.math.Matrix4.createByQuaternion=function(t,i){var n=(i=i||new e.math.Matrix4).mat;return n[0]=1-2*(t.y*t.y+t.z*t.z),n[1]=2*(t.x*t.y+t.z*t.w),n[2]=2*(t.x*t.z-t.y*t.w),n[3]=0,n[4]=2*(t.x*t.y-t.z*t.w),n[5]=1-2*(t.x*t.x+t.z*t.z),n[6]=2*(t.z*t.y+t.x*t.w),n[7]=0,n[8]=2*(t.x*t.z+t.y*t.w),n[9]=2*(t.y*t.z-t.x*t.w),n[10]=1-2*(t.x*t.x+t.y*t.y),n[11]=0,n[14]=n[13]=n[12]=0,n[15]=1,i},e.math.Matrix4.createByRotationTranslation=function(t,i,n){var s=(n=n||new e.math.Matrix4).mat,r=t.mat;return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=0,s[4]=r[3],s[5]=r[4],s[6]=r[5],s[7]=0,s[8]=r[6],s[9]=r[7],s[10]=r[8],s[11]=0,s[12]=i.x,s[13]=i.y,s[14]=i.z,s[15]=1,n},e.math.Matrix4.createByScale=function(t,i,n,s){var r=(s=s||new e.math.Matrix4).mat;return r[0]=t,r[5]=i,r[10]=n,r[15]=1,r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=r[12]=r[13]=r[14]=0,s},e.kmMat4Translation=function(e,t,i,n){return e.mat[0]=e.mat[5]=e.mat[10]=e.mat[15]=1,e.mat[1]=e.mat[2]=e.mat[3]=e.mat[4]=e.mat[6]=e.mat[7]=e.mat[8]=e.mat[9]=e.mat[11]=0,e.mat[12]=t,e.mat[13]=i,e.mat[14]=n,e},e.math.Matrix4.createByTranslation=function(t,i,n,s){return(s=s||new e.math.Matrix4).identity(),s.mat[12]=t,s.mat[13]=i,s.mat[14]=n,s},t.getUpVec3=function(){var t=this.mat;return new e.math.Vec3(t[4],t[5],t[6]).normalize()},t.getRightVec3=function(){var t=this.mat;return new e.math.Vec3(t[0],t[1],t[2]).normalize()},t.getForwardVec3=function(){var t=this.mat;return new e.math.Vec3(t[8],t[9],t[10]).normalize()},e.kmMat4PerspectiveProjection=function(t,i,n,s,r){var a=e.degreesToRadians(i/2),o=r-s,h=Math.sin(a);if(0===o||0===h||0===n)return null;var l=Math.cos(a)/h;return t.identity(),t.mat[0]=l/n,t.mat[5]=l,t.mat[10]=-(r+s)/o,t.mat[11]=-1,t.mat[14]=-2*s*r/o,t.mat[15]=0,t},e.math.Matrix4.createPerspectiveProjection=function(t,i,n,s){var r=e.degreesToRadians(t/2),a=s-n,o=Math.sin(r);if(0===a||0===o||0===i)return null;var h=Math.cos(r)/o,l=new e.math.Matrix4,d=l.mat;return l.identity(),d[0]=h/i,d[5]=h,d[10]=-(s+n)/a,d[11]=-1,d[14]=-2*n*s/a,d[15]=0,l},e.kmMat4OrthographicProjection=function(e,t,i,n,s,r,a){return e.identity(),e.mat[0]=2/(i-t),e.mat[5]=2/(s-n),e.mat[10]=-2/(a-r),e.mat[12]=-(i+t)/(i-t),e.mat[13]=-(s+n)/(s-n),e.mat[14]=-(a+r)/(a-r),e},e.math.Matrix4.createOrthographicProjection=function(t,i,n,s,r,a){var o=new e.math.Matrix4,h=o.mat;return o.identity(),h[0]=2/(i-t),h[5]=2/(s-n),h[10]=-2/(a-r),h[12]=-(i+t)/(i-t),h[13]=-(s+n)/(s-n),h[14]=-(a+r)/(a-r),o},e.kmMat4LookAt=function(t,i,n,s){var r=new e.math.Vec3(n),a=new e.math.Vec3(s);r.subtract(i),r.normalize(),a.normalize();var o=new e.math.Vec3(r);o.cross(a),o.normalize();var h=new e.math.Vec3(o);h.cross(r),o.normalize(),t.identity(),t.mat[0]=o.x,t.mat[4]=o.y,t.mat[8]=o.z,t.mat[1]=h.x,t.mat[5]=h.y,t.mat[9]=h.z,t.mat[2]=-r.x,t.mat[6]=-r.y,t.mat[10]=-r.z;var l=e.math.Matrix4.createByTranslation(-i.x,-i.y,-i.z);return t.multiply(l),t};var n=new e.math.Matrix4;t.lookAt=function(t,i,s){var r=new e.math.Vec3(i),a=new e.math.Vec3(s),o=this.mat;r.subtract(t),r.normalize(),a.normalize();var h=new e.math.Vec3(r);h.cross(a),h.normalize();var l=new e.math.Vec3(h);return l.cross(r),h.normalize(),this.identity(),o[0]=h.x,o[4]=h.y,o[8]=h.z,o[1]=l.x,o[5]=l.y,o[9]=l.z,o[2]=-r.x,o[6]=-r.y,o[10]=-r.z,n=e.math.Matrix4.createByTranslation(-t.x,-t.y,-t.z,n),this.multiply(n),this},e.kmMat4RotationAxisAngle=function(t,i,n){var s=Math.cos(n),r=Math.sin(n),a=new e.math.Vec3(i);return a.normalize(),t.mat[0]=s+a.x*a.x*(1-s),t.mat[1]=a.z*r+a.y*a.x*(1-s),t.mat[2]=-a.y*r+a.z*a.x*(1-s),t.mat[3]=0,t.mat[4]=-a.z*r+a.x*a.y*(1-s),t.mat[5]=s+a.y*a.y*(1-s),t.mat[6]=a.x*r+a.z*a.y*(1-s),t.mat[7]=0,t.mat[8]=a.y*r+a.x*a.z*(1-s),t.mat[9]=-a.x*r+a.y*a.z*(1-s),t.mat[10]=s+a.z*a.z*(1-s),t.mat[11]=0,t.mat[12]=0,t.mat[13]=0,t.mat[14]=0,t.mat[15]=1,t},e.math.Matrix4.createByAxisAndAngle=function(t,i,n){n=n||new e.math.Matrix4;var s=this.mat,r=Math.cos(i),a=Math.sin(i),o=new e.math.Vec3(t);return o.normalize(),s[0]=r+o.x*o.x*(1-r),s[1]=o.z*a+o.y*o.x*(1-r),s[2]=-o.y*a+o.z*o.x*(1-r),s[3]=0,s[4]=-o.z*a+o.x*o.y*(1-r),s[5]=r+o.y*o.y*(1-r),s[6]=o.x*a+o.z*o.y*(1-r),s[7]=0,s[8]=o.y*a+o.x*o.z*(1-r),s[9]=-o.x*a+o.y*o.z*(1-r),s[10]=r+o.z*o.z*(1-r),s[11]=0,s[12]=s[13]=s[14]=0,s[15]=1,n},t.extractRotation=function(){var t=new e.math.Matrix3,i=this.mat,n=t.mat;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[4],n[4]=i[5],n[5]=i[6],n[6]=i[8],n[7]=i[9],n[8]=i[10],t},t.extractPlane=function(t){var i=new e.math.Plane,n=this.mat;switch(t){case e.math.Plane.RIGHT:i.a=n[3]-n[0],i.b=n[7]-n[4],i.c=n[11]-n[8],i.d=n[15]-n[12];break;case e.math.Plane.LEFT:i.a=n[3]+n[0],i.b=n[7]+n[4],i.c=n[11]+n[8],i.d=n[15]+n[12];break;case e.math.Plane.BOTTOM:i.a=n[3]+n[1],i.b=n[7]+n[5],i.c=n[11]+n[9],i.d=n[15]+n[13];break;case e.math.Plane.TOP:i.a=n[3]-n[1],i.b=n[7]-n[5],i.c=n[11]-n[9],i.d=n[15]-n[13];break;case e.math.Plane.FAR:i.a=n[3]-n[2],i.b=n[7]-n[6],i.c=n[11]-n[10],i.d=n[15]-n[14];break;case e.math.Plane.NEAR:i.a=n[3]+n[2],i.b=n[7]+n[6],i.c=n[11]+n[10],i.d=n[15]+n[14];break;default:e.log("cc.math.Matrix4.extractPlane: Invalid plane index")}var s=Math.sqrt(i.a*i.a+i.b*i.b+i.c*i.c);return i.a/=s,i.b/=s,i.c/=s,i.d/=s,i},t.toAxisAndAngle=function(){var t=this.extractRotation();return e.math.Quaternion.rotationMatrix(t).toAxisAndAngle()}}(l),function(e){e.math.Plane=function(e,t,i,n){e&&void 0===t?(this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d):(this.a=e||0,this.b=t||0,this.c=i||0,this.d=n||0)},e.kmPlane=e.math.Plane;var t=e.math.Plane.prototype;e.math.Plane.LEFT=0,e.math.Plane.RIGHT=1,e.math.Plane.BOTTOM=2,e.math.Plane.TOP=3,e.math.Plane.NEAR=4,e.math.Plane.FAR=5,e.math.Plane.POINT_INFRONT_OF_PLANE=0,e.math.Plane.POINT_BEHIND_PLANE=1,e.math.Plane.POINT_ON_PLANE=2,t.dot=function(e){return this.a*e.x+this.b*e.y+this.c*e.z+this.d*e.w},t.dotCoord=function(e){return this.a*e.x+this.b*e.y+this.c*e.z+this.d},t.dotNormal=function(e){return this.a*e.x+this.b*e.y+this.c*e.z},e.math.Plane.fromPointNormal=function(t,i){return new e.math.Plane(i.x,i.y,i.z,-i.dot(t))},e.math.Plane.fromPoints=function(t,i,n){var s=new e.math.Vec3(i),r=new e.math.Vec3(n),a=new e.math.Plane;return s.subtract(t),r.subtract(t),s.cross(r),s.normalize(),a.a=s.x,a.b=s.y,a.c=s.z,a.d=s.scale(-1).dot(t),a},t.normalize=function(){var t=new e.math.Vec3(this.a,this.b,this.c),i=1/t.length();return t.normalize(),this.a=t.x,this.b=t.y,this.c=t.z,this.d=this.d*i,this},t.classifyPoint=function(t){var i=this.a*t.x+this.b*t.y+this.c*t.z+this.d;return i>.001?e.math.Plane.POINT_INFRONT_OF_PLANE:i<-.001?e.math.Plane.POINT_BEHIND_PLANE:e.math.Plane.POINT_ON_PLANE}}(l),function(e){e.math.Quaternion=function(e,t,i,n){e&&void 0===t?(this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w):(this.x=e||0,this.y=t||0,this.z=i||0,this.w=n||0)},e.kmQuaternion=e.math.Quaternion;var t=e.math.Quaternion.prototype;t.conjugate=function(e){return this.x=-e.x,this.y=-e.y,this.z=-e.z,this.w=e.w,this},t.dot=function(e){return this.w*e.w+this.x*e.x+this.y*e.y+this.z*e.z},t.exponential=function(){return this},t.identity=function(){return this.x=0,this.y=0,this.z=0,this.w=1,this},t.inverse=function(){var t=this.length();return Math.abs(t)>e.math.EPSILON?(this.x=0,this.y=0,this.z=0,this.w=0,this):(this.conjugate(this).scale(1/t),this)},t.isIdentity=function(){return 0===this.x&&0===this.y&&0===this.z&&1===this.w},t.length=function(){return Math.sqrt(this.lengthSq())},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.multiply=function(e){var t=this.x,i=this.y,n=this.z,s=this.w;return this.w=s*e.w-t*e.x-i*e.y-n*e.z,this.x=s*e.x+t*e.w+i*e.z-n*e.y,this.y=s*e.y+i*e.w+n*e.x-t*e.z,this.z=s*e.z+n*e.w+t*e.y-i*e.x,this},t.normalize=function(){var t=this.length();if(Math.abs(t)<=e.math.EPSILON)throw new Error("current quaternion is an invalid value");return this.scale(1/t),this},t.rotationAxis=function(e,t){var i=.5*t,n=Math.sin(i);return this.w=Math.cos(i),this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this},e.math.Quaternion.rotationMatrix=function(t){if(!t)return null;var i,n,s,r,a=[],o=t.mat,h=0;a[0]=o[0],a[1]=o[3],a[2]=o[6],a[4]=o[1],a[5]=o[4],a[6]=o[7],a[8]=o[2],a[9]=o[5],a[10]=o[8],a[15]=1;var l=a[0],d=l[0]+l[5]+l[10]+1;return d>e.math.EPSILON?(h=2*Math.sqrt(d),i=(l[9]-l[6])/h,n=(l[2]-l[8])/h,s=(l[4]-l[1])/h,r=.25*h):l[0]>l[5]&&l[0]>l[10]?(i=.25*(h=2*Math.sqrt(1+l[0]-l[5]-l[10])),n=(l[4]+l[1])/h,s=(l[2]+l[8])/h,r=(l[9]-l[6])/h):l[5]>l[10]?(h=2*Math.sqrt(1+l[5]-l[0]-l[10]),i=(l[4]+l[1])/h,n=.25*h,s=(l[9]+l[6])/h,r=(l[2]-l[8])/h):(h=2*Math.sqrt(1+l[10]-l[0]-l[5]),i=(l[2]+l[8])/h,n=(l[9]+l[6])/h,s=.25*h,r=(l[4]-l[1])/h),new e.math.Quaternion(i,n,s,r)},e.math.Quaternion.rotationYawPitchRoll=function(t,i,n){var s,r,a,o,h,l,d,c,u,p,m;s=e.degreesToRadians(i)/2,r=e.degreesToRadians(t)/2,a=e.degreesToRadians(n)/2,o=Math.cos(s),h=Math.cos(r),l=Math.cos(a),d=Math.sin(s),p=h*l,m=(c=Math.sin(r))*(u=Math.sin(a));var _=new e.math.Quaternion;return _.w=o*p+d*m,_.x=d*p-o*m,_.y=o*c*l+d*h*u,_.z=o*h*u-d*c*l,_.normalize(),_},t.slerp=function(t,i){if(this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w)return this;var n=this.dot(t),s=Math.acos(n),r=Math.sqrt(1-e.math.square(n)),a=Math.sin(i*s)/r,o=Math.sin((1-i)*s)/r,h=new e.math.Quaternion(t);return this.scale(o),h.scale(a),this.add(h),this},t.toAxisAndAngle=function(){var t,i,n,s=new e.math.Vec3;return t=Math.acos(this.w),(i=Math.sqrt(e.math.square(this.x)+e.math.square(this.y)+e.math.square(this.z)))>-e.math.EPSILON&&i<e.math.EPSILON||i<2*Math.PI+e.math.EPSILON&&i>2*Math.PI-e.math.EPSILON?(n=0,s.x=0,s.y=0,s.z=1):(n=2*t,s.x=this.x/i,s.y=this.y/i,s.z=this.z/i,s.normalize()),{axis:s,angle:n}},t.scale=function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},t.assignFrom=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},t.add=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},e.math.Quaternion.rotationBetweenVec3=function(t,i,n){var s=new e.math.Vec3(t),r=new e.math.Vec3(i);s.normalize(),r.normalize();var a=s.dot(r),o=new e.math.Quaternion;if(a>=1)return o.identity(),o;if(a<1e-6-1)if(Math.abs(n.lengthSq())<e.math.EPSILON)o.rotationAxis(n,Math.PI);else{var h=new e.math.Vec3(1,0,0);h.cross(t),Math.abs(h.lengthSq())<e.math.EPSILON&&(h.fill(0,1,0),h.cross(t)),h.normalize(),o.rotationAxis(h,Math.PI)}else{var l=Math.sqrt(2*(1+a)),d=1/l;s.cross(r),o.x=s.x*d,o.y=s.y*d,o.z=s.z*d,o.w=.5*l,o.normalize()}return o},t.multiplyVec3=function(t){var i=this.x,n=this.y,s=this.z,r=new e.math.Vec3(t),a=new e.math.Vec3(i,n,s),o=new e.math.Vec3(i,n,s);return a.cross(t),o.cross(a),a.scale(2*q.w),o.scale(2),r.add(a),r.add(o),r}}(l),l.math.AABB=function(e,t){this.min=e||new l.math.Vec3,this.max=t||new l.math.Vec3},l.math.AABB.prototype.containsPoint=function(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z},l.math.AABB.containsPoint=function(e,t){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y&&e.z>=t.min.z&&e.z<=t.max.z},l.math.AABB.prototype.assignFrom=function(e){this.min.assignFrom(e.min),this.max.assignFrom(e.max)},l.math.AABB.assign=function(e,t){return e.min.assignFrom(t.min),e.max.assignFrom(t.max),e},function(e){e.math.Matrix4Stack=function(e,t){this.top=e,this.stack=t||[],this.lastUpdated=0},e.km_mat4_stack=e.math.Matrix4Stack;var t=e.math.Matrix4Stack.prototype;t.initialize=function(){this.stack.length=0,this.top=null},e.km_mat4_stack_push=function(t,i){t.stack.push(t.top),t.top=new e.math.Matrix4(i)},e.km_mat4_stack_pop=function(e,t){e.top=e.stack.pop()},e.km_mat4_stack_release=function(e){e.stack=null,e.top=null},t.push=function(t){t=t||this.top,this.stack.push(this.top),this.top=new e.math.Matrix4(t)},t.pop=function(){this.top=this.stack.pop()},t.release=function(){this.stack=null,this.top=null,this._matrixPool=null},t._getFromPool=function(t){var i=this._matrixPool;if(0===i.length)return new e.math.Matrix4(t);var n=i.pop();return n.assignFrom(t),n},t._putInPool=function(e){this._matrixPool.push(e)}}(l),function(e){e.KM_GL_MODELVIEW=5888,e.KM_GL_PROJECTION=5889,e.KM_GL_TEXTURE=5890,e.modelview_matrix_stack=new e.math.Matrix4Stack,e.projection_matrix_stack=new e.math.Matrix4Stack,e.texture_matrix_stack=new e.math.Matrix4Stack,e.current_stack=null;e.lazyInitialize=function(){var t=new e.math.Matrix4;e.modelview_matrix_stack.initialize(),e.projection_matrix_stack.initialize(),e.texture_matrix_stack.initialize(),e.current_stack=e.modelview_matrix_stack,e.initialized=!0,t.identity(),e.modelview_matrix_stack.push(t),e.projection_matrix_stack.push(t),e.texture_matrix_stack.push(t)},e.lazyInitialize(),e.kmGLFreeAll=function(){e.modelview_matrix_stack.release(),e.modelview_matrix_stack=null,e.projection_matrix_stack.release(),e.projection_matrix_stack=null,e.texture_matrix_stack.release(),e.texture_matrix_stack=null,e.initialized=!1,e.current_stack=null},e.kmGLPushMatrix=function(){e.current_stack.push(e.current_stack.top)},e.kmGLPushMatrixWitMat4=function(t){e.current_stack.stack.push(e.current_stack.top),t.assignFrom(e.current_stack.top),e.current_stack.top=t},e.kmGLPopMatrix=function(){e.current_stack.top=e.current_stack.stack.pop()},e.kmGLMatrixMode=function(t){switch(t){case e.KM_GL_MODELVIEW:e.current_stack=e.modelview_matrix_stack;break;case e.KM_GL_PROJECTION:e.current_stack=e.projection_matrix_stack;break;case e.KM_GL_TEXTURE:e.current_stack=e.texture_matrix_stack;break;default:throw new Error("Invalid matrix mode specified")}e.current_stack.lastUpdated=e.director.getTotalFrames()},e.kmGLLoadIdentity=function(){e.current_stack.top.identity()},e.kmGLLoadMatrix=function(t){e.current_stack.top.assignFrom(t)},e.kmGLMultMatrix=function(t){e.current_stack.top.multiply(t)};var t=new e.math.Matrix4;e.kmGLTranslatef=function(i,n,s){var r=e.math.Matrix4.createByTranslation(i,n,s,t);e.current_stack.top.multiply(r)};var i=new e.math.Vec3;e.kmGLRotatef=function(n,s,r,a){i.fill(s,r,a);var o=e.math.Matrix4.createByAxisAndAngle(i,e.degreesToRadians(n),t);e.current_stack.top.multiply(o)},e.kmGLScalef=function(i,n,s){var r=e.math.Matrix4.createByScale(i,n,s,t);e.current_stack.top.multiply(r)},e.kmGLGetMatrix=function(t,i){switch(t){case e.KM_GL_MODELVIEW:i.assignFrom(e.modelview_matrix_stack.top);break;case e.KM_GL_PROJECTION:i.assignFrom(e.projection_matrix_stack.top);break;case e.KM_GL_TEXTURE:i.assignFrom(e.texture_matrix_stack.top);break;default:throw new Error("Invalid matrix mode specified")}}}(l),l.LabelBMFont=l.SpriteBatchNode.extend({_opacityModifyRGB:!1,_string:"",_config:null,_fntFile:"",_initialString:"",_alignment:l.TEXT_ALIGNMENT_CENTER,_width:-1,_lineBreakWithoutSpaces:!1,_imageOffset:null,_textureLoaded:!1,_className:"LabelBMFont",_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_WEBGL?new l.LabelBMFont.WebGLRenderCmd(this):new l.LabelBMFont.CanvasRenderCmd(this)},_setString:function(e,t){t?this._initialString=e:this._string=e;var i=this._children;if(i)for(var n=0;n<i.length;n++){var s=i[n];s&&s.setVisible(!1)}this._textureLoaded&&(this._string&&this._string.length>0&&this.createFontChars(),t&&this.updateLabel())},ctor:function(e,t,i,n,s){l.SpriteBatchNode.prototype.ctor.call(this),this._imageOffset=l.p(0,0),this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this.initWithString(e,t,i,n,s)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(e,t){this.addEventListener("load",e,t)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(e){this._opacityModifyRGB=e;var t=this._children;if(t)for(var i=0;i<t.length;i++){var n=t[i];n&&(n.opacityModifyRGB=this._opacityModifyRGB)}},_changeTextureColor:function(){this._renderCmd._changeTextureColor()},init:function(){return this.initWithString(null,null,null,null,null)},initWithString:function(e,t,i,n,s){var r=this,a=e||"";r._config&&l.log("cc.LabelBMFont.initWithString(): re-init is no longer supported");var o;if(t){var h=l.loader.getRes(t);if(!h&&!(h=l.FntFrameCache[t]||l.FntFrameCache[l.path.basename(t)]))return l.log("cc.LabelBMFont.initWithString(): Impossible to create font. Please check file"),!1;r._config=h,r._fntFile=t;var d=h.atlasName,c=l.spriteFrameCache.getSpriteFrame(d)||l.spriteFrameCache.getSpriteFrame(l.path.basename(d));c?(o=c.getTexture(),this._spriteFrame=c):o=l.textureCache.addImage(h.atlasName);var u=o.isLoaded();r._textureLoaded=u,u||o.addEventListener("load",function(e){var t=this;t._textureLoaded=!0,t.initWithTexture(e,t._initialString.length),t.setString(t._initialString,!0),t.dispatchEvent("load")},r)}else{o=new l.Texture2D;var p=new Image;o.initWithElement(p),r._textureLoaded=!1}return!!r.initWithTexture(o,a.length)&&(r._alignment=n||l.TEXT_ALIGNMENT_LEFT,r._imageOffset=s||l.p(0,0),r._width=void 0===i?-1:i,r._realOpacity=255,r._realColor=l.color(255,255,255,255),r._contentSize.width=0,r._contentSize.height=0,r.setAnchorPoint(.5,.5),r.setString(a,!0),!0)},createFontChars:function(){var e,t=this._string,i=t?t.length:0,n=this,s=this._renderCmd,r=s._texture||this._texture,a=0,o=l.size(0,0),h=0,d=1,c=n._config,u=c.kerningDict,p=c.commonHeight,m=c.fontDefDictionary;for(e=0;e<i-1;e++)10===t.charCodeAt(e)&&d++;var _,g=p*d,T=-(p-p*d),f=-1;for(e=0;e<i;e++){var S=t.charCodeAt(e);if(0!==S)if(10!==S){var w=u[f<<16|65535&S]||0;(_=m[S])||(l.log("cocos2d: LabelBMFont: character not found "+t[e]),_={rect:{x:0,y:0,width:0,height:0},xOffset:0,yOffset:0,xAdvance:0});var v=l.rect(_.rect.x,_.rect.y,_.rect.width,_.rect.height);(v=l.rectPixelsToPoints(v)).x+=n._imageOffset.x,v.y+=n._imageOffset.y;var L=!1;if(this._spriteFrame){r.width;var M=this._spriteFrame._rect;if(this._spriteFrame._rotated){L=!0;var C=v.x;v.x=v.y+M.x,v.y=C+M.y}else v.x=v.x+M.x,v.y=v.y+M.y}var y=n.getChildByTag(e);y?s._updateCharTexture(y,v,S,L):((y=new l.Sprite).initWithTexture(r,v,L),y._newTextureWhenChangeColor=!0,this.addChild(y,0,e)),y.opacityModifyRGB=this._opacityModifyRGB,s._updateCharColorAndOpacity(y);var B=c.commonHeight-_.yOffset,F=l.p(a+_.xOffset+.5*_.rect.width+w,T+B-.5*v.height*l.contentScaleFactor());y.setPosition(l.pointPixelsToPoints(F)),f=S,h<(a+=_.xAdvance+w)&&(h=a)}else a=0,T-=c.commonHeight}_&&_.xAdvance<_.rect.width?o.width=h-_.xAdvance+_.rect.width:o.width=h,o.height=g,n.setContentSize(l.sizePixelsToPoints(o))},updateString:function(e){var t=this,i=t._children;if(i)for(var n=0,s=i.length;n<s;n++){var r=i[n];r&&(r.visible=!1)}t._config&&t._string&&t._string.length>0&&t.createFontChars(),e||t.updateLabel()},getString:function(){return this._initialString},setString:function(e,t){e=String(e),void 0===t&&(t=!0),void 0!==e&&"string"==typeof e||(e+=""),this._initialString=e,this._setString(e,t)},_setStringForSetter:function(e){this.setString(e,!1)},setCString:function(e){this.setString(e,!0)},_getCharsWidth:function(e,t){if(t<=0)return 0;var i=this.getChildByTag(e),n=this.getChildByTag(e+t);return this._getLetterPosXLeft(n)-this._getLetterPosXLeft(i)},_checkWarp:function(e,t,i,n){for(var s=this,r=e[t],a=0,o=0;o<t;o++)a+=e[o].length;a=a+t-n;var h=s._getCharsWidth(a,e[t].length-1);if(h>i&&r.length>1){for(var d,c=r.length*(i/h)|0,u=r.substr(c),p=h-this._getCharsWidth(a+c,u.length-1),m=0,_=0;p>i&&_++<100;)c*=i/p,c|=0,u=r.substr(c),p=h-this._getCharsWidth(a+c,u.length-1);for(_=0;p<i&&_++<100;){if(u){var g=l.LabelTTF._wordRex.exec(u);m=g?g[0].length:1,d=u}s._lineBreakWithoutSpaces&&(m=0),c+=m,u=r.substr(c),p=h-this._getCharsWidth(a+c,u.length-1)}0===(c-=m)&&(c=1,d=d.substr(1));var T,f=r.substr(0,c);l.LabelTTF.wrapInspection&&l.LabelTTF._symbolRex.test(d||u)&&(m=(T=l.LabelTTF._lastWordRex.exec(f))?T[0].length:0,s._lineBreakWithoutSpaces&&(m=0),c-=m,d=r.substr(c),f=r.substr(0,c)),l.LabelTTF._firsrEnglish.test(d)&&(T=l.LabelTTF._lastEnglish.exec(f))&&f!==T[0]&&(m=T[0].length,s._lineBreakWithoutSpaces&&(m=0),c-=m,d=r.substr(c),f=r.substr(0,c)),e[t]=d||u,e.splice(t,0,f)}},updateLabel:function(){var e=this;e.string=e._initialString;var t,i,n;if(e._width>0){var s=e.string.split("\n"),r="",a=0,o=0;for(t=0;t<s.length;t++)o=s.length,this._checkWarp(s,t,e._width*this._scaleX,a),o<s.length&&a++,t>0&&(r+="\n"),r+=s[t];r+=String.fromCharCode(0),e._setString(r,!1)}if(e._alignment!==l.TEXT_ALIGNMENT_LEFT){t=0;for(var h=0,d=e._string.length,c=[],u=0;u<d;u++)if(10!==e._string[u].charCodeAt(0)&&0!==e._string[u].charCodeAt(0))c.push(e._string[t]);else{var p=0,m=c.length;if(0===m){h++;continue}var _=t+m-1+h;if(_<0)continue;var g=e.getChildByTag(_);if(null==g)continue;p=g.getPositionX()+g._getWidth()/2;var T=0;switch(e._alignment){case l.TEXT_ALIGNMENT_CENTER:T=e.width/2-p/2;break;case l.TEXT_ALIGNMENT_RIGHT:T=e.width-p}if(0!==T)for(i=0;i<m;i++)(_=t+i+h)<0||(n=e.getChildByTag(_))&&(n.x+=T);t+=m,h++,c.length=0}}},setAlignment:function(e){this._alignment=e,this.updateLabel()},_getAlignment:function(){return this._alignment},setBoundingWidth:function(e){this._width=e,this.updateLabel()},_getBoundingWidth:function(){return this._width},setLineBreakWithoutSpace:function(e){this._lineBreakWithoutSpaces=e,this.updateLabel()},setScale:function(e,t){l.Node.prototype.setScale.call(this,e,t),this.updateLabel()},setScaleX:function(e){l.Node.prototype.setScaleX.call(this,e),this.updateLabel()},setScaleY:function(e){l.Node.prototype.setScaleY.call(this,e),this.updateLabel()},setFntFile:function(e){var t=this;if(null!=e&&e!==t._fntFile){var i=l.loader.getRes(e);if(!i)return void l.log("cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file");t._fntFile=e,t._config=i;var n=l.textureCache.addImage(i.atlasName),s=n.isLoaded();t._textureLoaded=s,s?(t.setTexture(n),t._string&&t._string.length>0&&t.createFontChars()):n.addEventListener("load",function(e){var t=this;t._textureLoaded=!0,t.setTexture(e),t._string&&t._string.length>0&&t.createFontChars(),t._changeTextureColor(),t.updateLabel(),t.dispatchEvent("load")},t)}},getFntFile:function(){return this._fntFile},setTexture:function(e){this._texture=e,this._renderCmd.setTexture(e)},setAnchorPoint:function(e,t){l.Node.prototype.setAnchorPoint.call(this,e,t),this.updateLabel()},_setAnchorX:function(e){l.Node.prototype._setAnchorX.call(this,e),this.updateLabel()},_setAnchorY:function(e){l.Node.prototype._setAnchorY.call(this,e),this.updateLabel()},_atlasNameFromFntFile:function(e){},_kerningAmountForFirst:function(e,t){var i=0,n=e<<16|65535&t;if(this._configuration.kerningDictionary){var s=this._configuration.kerningDictionary[n.toString()];s&&(i=s.amount)}return i},_getLetterPosXLeft:function(e){return e.getPositionX()*this._scaleX-e._getWidth()*this._scaleX*e._getAnchorX()},_getLetterPosXRight:function(e){return e.getPositionX()*this._scaleX+e._getWidth()*this._scaleX*e._getAnchorX()},_isspace_unicode:function(e){return(e=e.charCodeAt(0))>=9&&e<=13||32===e||133===e||160===e||5760===e||e>=8192&&e<=8202||8232===e||8233===e||8239===e||8287===e||12288===e},_utf8_trim_ws:function(e){var t=e.length;if(!(t<=0)){var i=t-1;if(this._isspace_unicode(e[i])){for(var n=i-1;n>=0&&this._isspace_unicode(e[n]);--n)i=n;this._utf8_trim_from(e,i)}}},_utf8_trim_from:function(e,t){var i=e.length;t>=i||t<0||e.splice(t,i)}}),function(){var e=l.LabelBMFont.prototype;l.EventHelper.prototype.apply(e),e.string,l.defineGetterSetter(e,"string",e.getString,e._setStringForSetter),e.boundingWidth,l.defineGetterSetter(e,"boundingWidth",e._getBoundingWidth,e.setBoundingWidth),e.textAlign,l.defineGetterSetter(e,"textAlign",e._getAlignment,e.setAlignment),l.defineGetterSetter(e,"texture",e.getTexture,e.setTexture)}(),l.LabelBMFont.create=function(e,t,i,n,s){return new l.LabelBMFont(e,t,i,n,s)},l.FntFrameCache={};var y={FNT_HEAD:/fntframes [^\n]*(\n|$)/gi,FNT_FRAME_NAME:/fntframe [^\n]*(\n|$)/gi,INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/,_parseStrToObj:function(e){var t=e.match(this.ITEM_EXP),i={};if(t)for(var n=0,s=t.length;n<s;n++){var r=t[n],a=r.indexOf("="),o=r.substring(0,a),h=r.substring(a+1);h.match(this.INT_EXP)?h=parseInt(h):'"'===h[0]&&(h=h.substring(1,h.length-1)),i[o]=h}return i},_parseFntContent:function(e,t,i,n){var s=this,r=s._parseStrToObj(t.match(s.COMMON_EXP)[0]);if(e.commonHeight=r.lineHeight,l._renderType===l.game.RENDER_TYPE_WEBGL){var a=l.configuration.getMaxTextureSize();(r.scaleW>a.width||r.scaleH>a.height)&&l.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}1!==r.pages&&l.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");var o=s._parseStrToObj(t.match(s.PAGE_EXP)[0]);0!==o.id&&l.log("cc.LabelBMFont._parseImageFileName() : file could not be found"),e.atlasName=n?l.path.join(l.path.dirname(n.path)+o.file):l.path.changeBasename(i,o.file);for(var h=t.match(s.CHAR_EXP),d=e.fontDefDictionary={},c=0,u=h.length;c<u;c++){var p=s._parseStrToObj(h[c]);d[p.id]={rect:{x:p.x,y:p.y,width:p.width,height:p.height},xOffset:p.xoffset,yOffset:p.yoffset,xAdvance:p.xadvance}}var m=e.kerningDict={},_=t.match(s.KERNING_EXP);if(_)for(var c=0,u=_.length;c<u;c++){var g=s._parseStrToObj(_[c]);m[g.first<<16|65535&g.second]=g.amount}return e},parseFnt:function(e,t){var i=this,n={},s=e.match(i.FNT_HEAD);if(s){var r=i._parseStrToObj(s[0]);if(r&&r.count)for(var a=(e=e.substr(s[0].length)).split("----"),o=0;o<r.count;++o){var h=a[o],d=h.match(i.FNT_FRAME_NAME);if(d){var c=i._parseStrToObj(d[0]);if(c&&c.name){n={};var u=l.path.join(l.path.dirname(t),c.name);l.FntFrameCache[u]=this._parseFntContent(n,h.substr(d[0].length),t,{path:c.name})}}}}else n=this._parseFntContent(n,e,t);return n},load:function(e,t,i,n){var s=this;l.loader.loadTxt(e,function(e,i){if(e)return n(e);n(null,s.parseFnt(i,t))})}};l.loader.register(["fnt"],y),function(){l.LabelBMFont.CanvasRenderCmd=function(e){this._rootCtor(e)};var e=l.LabelBMFont.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.LabelBMFont.CanvasRenderCmd,e._updateCharTexture=function(e,t,i){32===i?e.setTextureRect(t,!1,l.size(0,0)):(e.setTextureRect(t,!1),e.visible=!0)},e._updateCharColorAndOpacity=function(e){e._displayedColor=this._displayedColor,e._renderCmd.setDirtyFlag(l.Node._dirtyFlags.colorDirty),e._displayedOpacity=this._displayedOpacity,e._renderCmd.setDirtyFlag(l.Node._dirtyFlags.opacityDirty)},e.setTexture=function(e){for(var t=this._node,i=t._children,n=this._displayedColor,s=0;s<i.length;s++){var r=i[s],a=r._renderCmd,o=a._displayedColor;(t._texture===a._texture||o.r===n.r&&o.g===n.g&&o.b===n.b)&&(r.texture=e)}t._texture=e},e._changeTextureColor=function(){var e=this._node,t=e._texture,i=t.getContentSize(),n=e._texture,s=n.getHtmlElementObj(),r=this._displayedColor,a=l.rect(0,0,s.width,s.height);if(t&&i.width>0){if(!s)return;var o=n._generateColorTexture(r.r,r.g,r.b,a);e.setTexture(o)}},e._updateChildrenDisplayedOpacity=function(e){l.Node.prototype.updateDisplayedOpacity.call(e,this._displayedOpacity)},e._updateChildrenDisplayedColor=function(e){l.Node.prototype.updateDisplayedColor.call(e,this._displayedColor)}}(),function(){l.LabelBMFont.WebGLRenderCmd=function(e){this._rootCtor(e)};var e=l.LabelBMFont.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.LabelBMFont.WebGLRenderCmd,e.setTexture=function(e){this._node.setOpacityModifyRGB(this._node._texture.hasPremultipliedAlpha())},e._updateCharTexture=function(e,t,i,n){e.setTextureRect(t,n),e.visible=!0},e._changeTextureColor=function(){},e._updateCharColorAndOpacity=function(){}}(),l.LabelAtlas=l.LabelBMFont.extend({_className:"LabelAtlas",ctor:function(e,t,i,n,s){l.SpriteBatchNode.prototype.ctor.call(this),this._imageOffset=l.p(0,0),this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,t&&l.LabelAtlas.prototype.initWithString.call(this,e,t,i,n,s)},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_WEBGL?new l.LabelBMFont.WebGLRenderCmd(this):new l.LabelBMFont.CanvasRenderCmd(this)},_createFntConfig:function(e,t,i,n){var s={};s.commonHeight=i;for(var r=s.fontDefDictionary={},a=e.pixelsWidth,o=e.pixelsHeight,h=n.charCodeAt(0),l=0,d=i;d<=o;d+=i)for(var c=0;c<a;c+=t)r[h+l]={rect:{x:c,y:d-i,width:t,height:i},xOffset:0,yOffset:0,xAdvance:t},++l;return s.kerningDict={},s},initWithString:function(e,t,i,n,s){var r,a,o,h,d=this,c=e+""||"";if(this._initialString=c,d._string=c,void 0===i){var u=l.loader.getRes(t);if(1!==parseInt(u.version,10))return l.log("cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version"),!1;r=l.path.changeBasename(t,u.textureFilename);var p=l.contentScaleFactor();a=parseInt(u.itemWidth,10)/p,o=parseInt(u.itemHeight,10)/p,h=String.fromCharCode(parseInt(u.firstChar,10))}else r=t,a=i||0,o=n||0,h=s||" ";var m;if(t){d._fntFile="dummy_fnt_file:"+r;var _=r,g=l.spriteFrameCache.getSpriteFrame(_)||l.spriteFrameCache.getSpriteFrame(l.path.basename(_));g?(m=g.getTexture(),this._spriteFrame=g):m=l.textureCache.addImage(r);var T=this._createFntConfig(m,a,o,h);T.atlasName=r,d._config=T;var f=m.isLoaded();d._textureLoaded=f,f||m.addEventListener("load",function(e){var t=this;t._textureLoaded=!0,t.initWithTexture(e,t._initialString.length),t.setString(t._initialString,!0),t.dispatchEvent("load")},d)}else{m=new l.Texture2D;var S=new Image;m.initWithElement(S),d._textureLoaded=!1}return!!d.initWithTexture(m,c.length)&&(d._alignment=l.TEXT_ALIGNMENT_LEFT,d._imageOffset=l.p(0,0),d._width=-1,d._realOpacity=255,d._realColor=l.color(255,255,255,255),d._contentSize.width=0,d._contentSize.height=0,d.setString(c,!0),!0)},setFntFile:function(){l.warn("setFntFile doesn't support with LabelAtlas.")}}),l.LabelAtlas.create=function(e,t,i,n,s){return new l.LabelAtlas(e,t,i,n,s)},function(){l.LabelAtlas.CanvasRenderCmd=function(e){l.AtlasNode.CanvasRenderCmd.call(this,e),this._needDraw=!1};var e=l.LabelAtlas.CanvasRenderCmd.prototype=Object.create(l.AtlasNode.CanvasRenderCmd.prototype);e.constructor=l.LabelAtlas.CanvasRenderCmd,e.setCascade=function(){var e=this._node;e._cascadeOpacityEnabled=!0,e._cascadeColorEnabled=!1},e.updateAtlasValues=function(){for(var e=this._node,t=e._string||"",i=t.length,n=this._textureToRender,s=e._itemWidth,r=e._itemHeight,a=0,o=-1;a<i;a++){var h=t.charCodeAt(a)-e._mapStartChar.charCodeAt(0),d=parseInt(h%e._itemsPerRow,10),c=parseInt(h/e._itemsPerRow,10);if(!(d<0||c<0)){var u=l.rect(d*s,c*r,s,r),p=n._contentSize;if(!(u.x<0||u.y<0||u.x+u.width>p.width||u.y+u.height>p.height)){o++;var m=t.charCodeAt(a),_=e.getChildByTag(a);_?32===m?(_.init(),_.setTextureRect(l.rect(0,0,10,10),!1,l.size(0,0))):(_.initWithTexture(n,u),_.visible=!0):(_=new l.Sprite,32===m?(_.init(),_.setTextureRect(l.rect(0,0,10,10),!1,l.size(0,0))):_.initWithTexture(n,u),l.Node.prototype.addChild.call(e,_,0,a)),_.setPosition(o*s+s/2,r/2)}}}this.updateContentSize(a,o+1)},e.updateContentSize=function(e,t){var i=this._node,n=i._contentSize;e!==t&&e*i._itemWidth===n.width&&i._itemHeight===n.height&&i.setContentSize(t*i._itemWidth,i._itemHeight)},e.setString=function(e){var t=this._node;if(t._children)for(var i=t._children,n=i.length,s=0;s<n;s++){var r=i[s];r&&!r._lateChild&&(r.visible=!1)}},e._addChild=function(){child._lateChild=!0}}(),function(){l.LabelAtlas.WebGLRenderCmd=function(e){l.AtlasNode.WebGLRenderCmd.call(this,e),this._needDraw=!0};var e=l.LabelAtlas.WebGLRenderCmd.prototype=Object.create(l.AtlasNode.WebGLRenderCmd.prototype);e.constructor=l.LabelAtlas.WebGLRenderCmd,e._updateColor=function(){if(this._colorF32Array){var e=this._displayedColor,t=this._displayedOpacity/255;this._node._opacityModifyRGB?(this._colorF32Array[0]=e.r*t/255,this._colorF32Array[1]=e.g*t/255,this._colorF32Array[2]=e.b*t/255,this._colorF32Array[3]=t):(this._colorF32Array[0]=e.r/255,this._colorF32Array[1]=e.g/255,this._colorF32Array[2]=e.b/255,this._colorF32Array[3]=t)}},e.setCascade=function(){var e=this._node;e._cascadeOpacityEnabled=!0,e._cascadeColorEnabled=!0},e.rendering=function(e){if(l.AtlasNode.WebGLRenderCmd.prototype.rendering.call(this,e),l.LABELATLAS_DEBUG_DRAW){var t=this._node,i=t.getContentSize(),n=t.getBoundingBoxToWorld(),s=n.x,r=n.y;i.width=n.width,i.height=n.height;var a=[l.p(s,r),l.p(s+i.width,r),l.p(i.width+s,i.height+r),l.p(s,r+i.height)];l._drawingUtil.drawPoly(a,4,!0)}},e.updateAtlasValues=function(){var e=this._node,t=e._string,i=t.length,n=this._textureAtlas,s=n.texture,r=s.pixelsWidth,a=s.pixelsHeight,o=e._itemWidth,h=e._itemHeight;e._ignoreContentScaleFactor||(o=e._itemWidth*l.contentScaleFactor(),h=e._itemHeight*l.contentScaleFactor()),i>n.getCapacity()&&l.log("cc.LabelAtlas._updateAtlasValues(): Invalid String length");for(var d=n.quads,c=e._itemWidth,u=e._itemHeight,p=0,m=-1;p<i;p++){var _=t.charCodeAt(p)-e._mapStartChar.charCodeAt(0),g=_%e._itemsPerRow,T=0|_/e._itemsPerRow;if(!(g<0||T<0)&&!(g*c+c>r||T*u+u>a)){m++;var f,S,w,v;l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(S=(f=(2*g*o+1)/(2*r))+(2*o-2)/(2*r),v=(w=(2*T*h+1)/(2*a))+(2*h-2)/(2*a)):(S=(f=g*o/r)+o/r,v=(w=T*h/a)+h/a);var L=d[p],M=L.tl,C=L.tr,y=L.bl,B=L.br;M.texCoords.u=f,M.texCoords.v=w,C.texCoords.u=S,C.texCoords.v=w,y.texCoords.u=f,y.texCoords.v=v,B.texCoords.u=S,B.texCoords.v=v,y.vertices.x=m*c,y.vertices.y=0,y.vertices.z=0,B.vertices.x=m*c+c,B.vertices.y=0,B.vertices.z=0,M.vertices.x=m*c,M.vertices.y=e._itemHeight,M.vertices.z=0,C.vertices.x=m*c+c,C.vertices.y=e._itemHeight,C.vertices.z=0}}if(this._updateColor(),this.updateContentSize(p,m+1),i>0){n.dirty=!0;var F=n.totalQuads;i>F&&n.increaseTotalQuadsWith(i-F)}},e.updateContentSize=function(e,t){var i=this._node,n=i._contentSize;e!==t&&e*i._itemWidth===n.width&&i._itemHeight===n.height&&i.setContentSize(t*i._itemWidth,i._itemHeight)},e.setString=function(e){var t=e.length;t>this._textureAtlas.totalQuads&&this._textureAtlas.resizeCapacity(t)},e._addChild=function(){}}(),l._globalFontSize=l.ITEM_SIZE,l._globalFontName="Arial",l._globalFontNameRelease=!1,l.MenuItem=l.Node.extend({_enabled:!1,_target:null,_callback:null,_isSelected:!1,_className:"MenuItem",ctor:function(e,t){var i=l.Node.prototype;i.ctor.call(this),this._target=null,this._callback=null,this._isSelected=!1,this._enabled=!1,i.setAnchorPoint.call(this,.5,.5),this._target=t||null,this._callback=e||null,this._callback&&(this._enabled=!0)},isSelected:function(){return this._isSelected},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},setTarget:function(e,t){this._target=t,this._callback=e},isEnabled:function(){return this._enabled},setEnabled:function(e){this._enabled=e},initWithCallback:function(e,t){return this.anchorX=.5,this.anchorY=.5,this._target=t,this._callback=e,this._enabled=!0,this._isSelected=!1,!0},rect:function(){var e=this._position,t=this._contentSize,i=this._anchorPoint;return l.rect(e.x-t.width*i.x,e.y-t.height*i.y,t.width,t.height)},selected:function(){this._isSelected=!0},unselected:function(){this._isSelected=!1},setCallback:function(e,t){this._target=t,this._callback=e},activate:function(){if(this._enabled){var e=this._target,t=this._callback;if(!t)return;e&&l.isString(t)?e[t](this):e&&l.isFunction(t)?t.call(e,this):t(this)}}});var d=l.MenuItem.prototype;d.enabled,l.defineGetterSetter(d,"enabled",d.isEnabled,d.setEnabled),l.MenuItem.create=function(e,t){return new l.MenuItem(e,t)},l.MenuItemLabel=l.MenuItem.extend({_disabledColor:null,_label:null,_originalScale:0,_colorBackup:null,ctor:function(e,t,i){l.MenuItem.prototype.ctor.call(this,t,i),this._disabledColor=null,this._label=null,this._colorBackup=null,e&&(this._originalScale=1,this._colorBackup=l.color.WHITE,this._disabledColor=l.color(126,126,126),this.setLabel(e),e.textureLoaded&&!e.textureLoaded()&&e.addEventListener("load",function(e){this.width=e.width,this.height=e.height,this.parent instanceof l.Menu&&this.parent.updateAlign()},this),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0))},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(e){this._disabledColor=e},getLabel:function(){return this._label},setLabel:function(e){e&&(this.addChild(e),e.anchorX=0,e.anchorY=0,this.width=e.width,this.height=e.height,e.setCascadeColorEnabled(!0)),this._label&&this.removeChild(this._label,!0),this._label=e},setEnabled:function(e){this._enabled!==e&&(e?this.setColor(this._colorBackup):(this._colorBackup=this.color,this.setColor(this._disabledColor))),l.MenuItem.prototype.setEnabled.call(this,e)},initWithLabel:function(e,t,i){return this.initWithCallback(t,i),this._originalScale=1,this._colorBackup=l.color.WHITE,this._disabledColor=l.color(126,126,126),this.setLabel(e),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},setString:function(e){this._label.string=e,this.width=this._label.width,this.height=this._label.height},getString:function(){return this._label.string},activate:function(){this._enabled&&(this.stopAllActions(),this.scale=this._originalScale,l.MenuItem.prototype.activate.call(this))},selected:function(){if(this._enabled){l.MenuItem.prototype.selected.call(this);var e=this.getActionByTag(l.ZOOM_ACTION_TAG);e?this.stopAction(e):this._originalScale=this.scale;var t=l.scaleTo(.1,1.2*this._originalScale);t.setTag(l.ZOOM_ACTION_TAG),this.runAction(t)}},unselected:function(){if(this._enabled){l.MenuItem.prototype.unselected.call(this),this.stopActionByTag(l.ZOOM_ACTION_TAG);var e=l.scaleTo(.1,this._originalScale);e.setTag(l.ZOOM_ACTION_TAG),this.runAction(e)}}});var d=l.MenuItemLabel.prototype;d.string,l.defineGetterSetter(d,"string",d.getString,d.setString),d.disabledColor,l.defineGetterSetter(d,"disabledColor",d.getDisabledColor,d.setDisabledColor),d.label,l.defineGetterSetter(d,"label",d.getLabel,d.setLabel),l.MenuItemLabel.create=function(e,t,i){return new l.MenuItemLabel(e,t,i)},l.MenuItemAtlasFont=l.MenuItemLabel.extend({ctor:function(e,t,i,n,s,r,a){var o;e&&e.length>0&&(o=new l.LabelAtlas(e,t,i,n,s)),l.MenuItemLabel.prototype.ctor.call(this,o,r,a)},initWithString:function(e,t,i,n,s,r,a){if(!e||0===e.length)throw new Error("cc.MenuItemAtlasFont.initWithString(): value should be non-null and its length should be greater than 0");var o=new l.LabelAtlas;return o.initWithString(e,t,i,n,s),this.initWithLabel(o,r,a),!0}}),l.MenuItemAtlasFont.create=function(e,t,i,n,s,r,a){return new l.MenuItemAtlasFont(e,t,i,n,s,r,a)},l.MenuItemFont=l.MenuItemLabel.extend({_fontSize:null,_fontName:null,ctor:function(e,t,i){var n;e&&e.length>0?(this._fontName=l._globalFontName,this._fontSize=l._globalFontSize,n=new l.LabelTTF(e,this._fontName,this._fontSize)):(this._fontSize=0,this._fontName=""),l.MenuItemLabel.prototype.ctor.call(this,n,t,i)},initWithString:function(e,t,i){if(!e||0===e.length)throw new Error("Value should be non-null and its length should be greater than 0");this._fontName=l._globalFontName,this._fontSize=l._globalFontSize;var n=new l.LabelTTF(e,this._fontName,this._fontSize);return this.initWithLabel(n,t,i),!0},setFontSize:function(e){this._fontSize=e,this._recreateLabel()},getFontSize:function(){return this._fontSize},setFontName:function(e){this._fontName=e,this._recreateLabel()},getFontName:function(){return this._fontName},_recreateLabel:function(){var e=new l.LabelTTF(this._label.string,this._fontName,this._fontSize);this.setLabel(e)}}),l.MenuItemFont.setFontSize=function(e){l._globalFontSize=e},l.MenuItemFont.fontSize=function(){return l._globalFontSize},l.MenuItemFont.setFontName=function(e){l._globalFontNameRelease&&(l._globalFontName=""),l._globalFontName=e,l._globalFontNameRelease=!0};var d=l.MenuItemFont.prototype;d.fontSize,l.defineGetterSetter(d,"fontSize",d.getFontSize,d.setFontSize),d.fontName,l.defineGetterSetter(d,"fontName",d.getFontName,d.setFontName),l.MenuItemFont.fontName=function(){return l._globalFontName},l.MenuItemFont.create=function(e,t,i){return new l.MenuItemFont(e,t,i)},l.MenuItemSprite=l.MenuItem.extend({_normalImage:null,_selectedImage:null,_disabledImage:null,ctor:function(e,t,i,n,s){if(l.MenuItem.prototype.ctor.call(this),this._normalImage=null,this._selectedImage=null,this._disabledImage=null,this._loader=new l.Sprite.LoadManager,void 0!==e){t=t||null;var r,a,o;return void 0!==s?(r=i,l.isFunction(s)?(o=s,a=n):(o=n,a=s)):void 0!==n&&l.isFunction(n)?(r=i,o=n):void 0!==n&&l.isFunction(i)?(a=n,o=i,r=null):void 0===i&&(r=null),this._loader.clear(),e.textureLoaded&&!e.textureLoaded()?(this._loader.once(e,function(){this.initWithNormalSprite(e,t,r,o,a)},this),!1):(this.initWithNormalSprite(e,t,r,o,a),!0)}},getNormalImage:function(){return this._normalImage},setNormalImage:function(e){this._normalImage!==e&&(e&&(this.addChild(e,0,l.NORMAL_TAG),e.anchorX=0,e.anchorY=0),this._normalImage&&this.removeChild(this._normalImage,!0),this._normalImage=e,this._normalImage&&(this.width=this._normalImage.width,this.height=this._normalImage.height,this._updateImagesVisibility(),e.textureLoaded&&!e.textureLoaded()&&e.addEventListener("load",function(e){this.width=e.width,this.height=e.height,this.parent instanceof l.Menu&&this.parent.updateAlign()},this)))},getSelectedImage:function(){return this._selectedImage},setSelectedImage:function(e){this._selectedImage!==e&&(e&&(this.addChild(e,0,l.SELECTED_TAG),e.anchorX=0,e.anchorY=0),this._selectedImage&&this.removeChild(this._selectedImage,!0),this._selectedImage=e,this._updateImagesVisibility())},getDisabledImage:function(){return this._disabledImage},setDisabledImage:function(e){this._disabledImage!==e&&(e&&(this.addChild(e,0,l.DISABLE_TAG),e.anchorX=0,e.anchorY=0),this._disabledImage&&this.removeChild(this._disabledImage,!0),this._disabledImage=e,this._updateImagesVisibility())},initWithNormalSprite:function(e,t,i,n,s){if(this._loader.clear(),e.textureLoaded&&!e.textureLoaded())return this._loader.once(e,function(){this.initWithNormalSprite(e,t,i,n,s)},this),!1;this.initWithCallback(n,s),this.setNormalImage(e),this.setSelectedImage(t),this.setDisabledImage(i);var r=this._normalImage;return r&&(this.width=r.width,this.height=r.height),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},selected:function(){l.MenuItem.prototype.selected.call(this),this._normalImage&&(this._disabledImage&&(this._disabledImage.visible=!1),this._selectedImage?(this._normalImage.visible=!1,this._selectedImage.visible=!0):this._normalImage.visible=!0)},unselected:function(){l.MenuItem.prototype.unselected.call(this),this._normalImage&&(this._normalImage.visible=!0,this._selectedImage&&(this._selectedImage.visible=!1),this._disabledImage&&(this._disabledImage.visible=!1))},setEnabled:function(e){this._enabled!==e&&(l.MenuItem.prototype.setEnabled.call(this,e),this._updateImagesVisibility())},_updateImagesVisibility:function(){var e=this._normalImage,t=this._selectedImage,i=this._disabledImage;this._enabled?(e&&(e.visible=!0),t&&(t.visible=!1),i&&(i.visible=!1)):i?(e&&(e.visible=!1),t&&(t.visible=!1),i&&(i.visible=!0)):(e&&(e.visible=!0),t&&(t.visible=!1))}});var d=l.MenuItemSprite.prototype;d.normalImage,l.defineGetterSetter(d,"normalImage",d.getNormalImage,d.setNormalImage),d.selectedImage,l.defineGetterSetter(d,"selectedImage",d.getSelectedImage,d.setSelectedImage),d.disabledImage,l.defineGetterSetter(d,"disabledImage",d.getDisabledImage,d.setDisabledImage),l.MenuItemSprite.create=function(e,t,i,n,s){return new l.MenuItemSprite(e,t,i,n,s||void 0)},l.MenuItemImage=l.MenuItemSprite.extend({ctor:function(e,t,i,n,s){var r=null,a=null,o=null,h=null,d=null;void 0===e||null===e?l.MenuItemSprite.prototype.ctor.call(this):(r=new l.Sprite(e),t&&(a=new l.Sprite(t)),void 0===n?h=i:void 0===s?(h=i,d=n):s&&(o=new l.Sprite(i),h=n,d=s),l.MenuItemSprite.prototype.ctor.call(this,r,a,o,h,d))},setNormalSpriteFrame:function(e){this.setNormalImage(new l.Sprite(e))},setSelectedSpriteFrame:function(e){this.setSelectedImage(new l.Sprite(e))},setDisabledSpriteFrame:function(e){this.setDisabledImage(new l.Sprite(e))},initWithNormalImage:function(e,t,i,n,s){var r=null,a=null,o=null;return e&&(r=new l.Sprite(e)),t&&(a=new l.Sprite(t)),i&&(o=new l.Sprite(i)),this.initWithNormalSprite(r,a,o,n,s)}}),l.MenuItemImage.create=function(e,t,i,n,s){return new l.MenuItemImage(e,t,i,n,s)},l.MenuItemToggle=l.MenuItem.extend({subItems:null,_selectedIndex:0,_opacity:null,_color:null,ctor:function(){l.MenuItem.prototype.ctor.call(this),this._selectedIndex=0,this.subItems=[],this._opacity=0,this._color=l.color.WHITE,arguments.length>0&&this.initWithItems(Array.prototype.slice.apply(arguments))},getOpacity:function(){return this._opacity},setOpacity:function(e){if(this._opacity=e,this.subItems&&this.subItems.length>0)for(var t=0;t<this.subItems.length;t++)this.subItems[t].opacity=e;this._color.a=e},getColor:function(){var e=this._color;return l.color(e.r,e.g,e.b,e.a)},setColor:function(e){var t=this._color;if(t.r=e.r,t.g=e.g,t.b=e.b,this.subItems&&this.subItems.length>0)for(var i=0;i<this.subItems.length;i++)this.subItems[i].setColor(e);void 0===e.a||e.a_undefined||this.setOpacity(e.a)},getSelectedIndex:function(){return this._selectedIndex},setSelectedIndex:function(e){if(e!==this._selectedIndex){this._selectedIndex=e;var t=this.getChildByTag(l.CURRENT_ITEM);t&&t.removeFromParent(!1);var i=this.subItems[this._selectedIndex];this.addChild(i,0,l.CURRENT_ITEM);var n=i.width,s=i.height;this.width=n,this.height=s,i.setPosition(n/2,s/2)}},getSubItems:function(){return this.subItems},setSubItems:function(e){this.subItems=e},initWithItems:function(e){var t=e.length;l.isFunction(e[e.length-2])?(this.initWithCallback(e[e.length-2],e[e.length-1]),t-=2):l.isFunction(e[e.length-1])?(this.initWithCallback(e[e.length-1],null),t-=1):this.initWithCallback(null,null);var i=this.subItems;i.length=0;for(var n=0;n<t;n++)e[n]&&i.push(e[n]);return this._selectedIndex=l.UINT_MAX,this.setSelectedIndex(0),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},addSubItem:function(e){this.subItems.push(e)},activate:function(){if(this._enabled){var e=(this._selectedIndex+1)%this.subItems.length;this.setSelectedIndex(e)}l.MenuItem.prototype.activate.call(this)},selected:function(){l.MenuItem.prototype.selected.call(this),this.subItems[this._selectedIndex].selected()},unselected:function(){l.MenuItem.prototype.unselected.call(this),this.subItems[this._selectedIndex].unselected()},setEnabled:function(e){if(this._enabled!==e){l.MenuItem.prototype.setEnabled.call(this,e);var t=this.subItems;if(t&&t.length>0)for(var i=0;i<t.length;i++)t[i].enabled=e}},selectedItem:function(){return this.subItems[this._selectedIndex]},getSelectedItem:function(){return this.subItems[this._selectedIndex]},onEnter:function(){l.Node.prototype.onEnter.call(this),this.setSelectedIndex(this._selectedIndex)}});var d=l.MenuItemToggle.prototype;d.selectedIndex,l.defineGetterSetter(d,"selectedIndex",d.getSelectedIndex,d.setSelectedIndex),l.MenuItemToggle.create=function(){arguments.length>0&&null==arguments[arguments.length-1]&&l.log("parameters should not be ending with null in Javascript");var e=new l.MenuItemToggle;return e.initWithItems(Array.prototype.slice.apply(arguments)),e},l.MENU_STATE_WAITING=0,l.MENU_STATE_TRACKING_TOUCH=1,l.MENU_HANDLER_PRIORITY=-128,l.DEFAULT_PADDING=5,l.Menu=l.Layer.extend({enabled:!1,_selectedItem:null,_state:-1,_touchListener:null,_className:"Menu",ctor:function(e){l.Layer.prototype.ctor.call(this),this._color=l.color.WHITE,this.enabled=!1,this._opacity=255,this._selectedItem=null,this._state=-1,this._touchListener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this._onTouchBegan,onTouchMoved:this._onTouchMoved,onTouchEnded:this._onTouchEnded,onTouchCancelled:this._onTouchCancelled});var t,i=arguments.length;if(e instanceof Array)t=e;else if(0===i)t=[];else if(i>0){t=[];for(var n=0;n<i;n++)arguments[n]&&t.push(arguments[n])}this.initWithArray(t)},onEnter:function(){var e=this._touchListener;e._isRegistered()||l.eventManager.addListener(e,this),l.Node.prototype.onEnter.call(this)},isEnabled:function(){return this.enabled},setEnabled:function(e){this.enabled=e},initWithItems:function(e){var t=[];if(e)for(var i=0;i<e.length;i++)e[i]&&t.push(e[i]);return this.initWithArray(t)},initWithArray:function(e){if(l.Layer.prototype.init.call(this)){this.enabled=!0;var t=l.winSize;if(this.setPosition(t.width/2,t.height/2),this.setContentSize(t),this.setAnchorPoint(.5,.5),this.ignoreAnchorPointForPosition(!0),e)for(var i=0;i<e.length;i++)this.addChild(e[i],i);return this._selectedItem=null,this._state=l.MENU_STATE_WAITING,this.cascadeColor=!0,this.cascadeOpacity=!0,!0}return!1},addChild:function(e,t,i){if(!(e instanceof l.MenuItem))throw new Error("cc.Menu.addChild() : Menu only supports MenuItem objects as children");l.Layer.prototype.addChild.call(this,e,t,i)},updateAlign:function(){switch(this._align){case"vertically":this.alignItemsVertically();break;case"horizontally":this.alignItemsHorizontally()}},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(l.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(e){this._align="vertically";var t,i,n,s,r,a=-e,o=this._children;if(o&&o.length>0){for(i=0,t=o.length;i<t;i++)a+=o[i].height*o[i].scaleY+e;var h=a/2;for(i=0,t=o.length;i<t;i++)s=(r=o[i]).height,n=r.scaleY,r.setPosition(0,h-s*n/2),h-=s*n+e}},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(l.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(e){this._align="horizontally";var t,i,n,s,r,a=-e,o=this._children;if(o&&o.length>0){for(t=0,i=o.length;t<i;t++)a+=o[t].width*o[t].scaleX+e;var h=-a/2;for(t=0,i=o.length;t<i;t++)n=(r=o[t]).scaleX,s=o[t].width,r.setPosition(h+s*n/2,0),h+=s*n+e}},alignItemsInColumns:function(){arguments.length>0&&null==arguments[arguments.length-1]&&l.log("parameters should not be ending with null in Javascript");var e,t=[];for(e=0;e<arguments.length;e++)t.push(arguments[e]);var i,n,s,r=-5,a=0,o=0,h=0,d=this._children;if(d&&d.length>0)for(e=0,s=d.length;e<s;e++)a>=t.length||(i=t[a])&&(o=o>=(n=d[e].height)||isNaN(n)?o:n,++h>=i&&(r+=o+5,h=0,o=0,++a));var c=l.director.getWinSize();a=0,o=0,i=0;var u=0,p=0,m=r/2;if(d&&d.length>0)for(e=0,s=d.length;e<s;e++){var _=d[e];0===i&&(i=t[a],p=u=c.width/(1+i)),o=o>=(n=_._getHeight())||isNaN(n)?o:n,_.setPosition(p-c.width/2,m-n/2),p+=u,++h>=i&&(m-=o+5,h=0,i=0,o=0,++a)}},alignItemsInRows:function(){arguments.length>0&&null==arguments[arguments.length-1]&&l.log("parameters should not be ending with null in Javascript");var e,t=[];for(e=0;e<arguments.length;e++)t.push(arguments[e]);var i,n,s,r,a=[],o=[],h=-10,d=-5,c=0,u=0,p=0,m=this._children;if(m&&m.length>0)for(e=0,s=m.length;e<s;e++)n=m[e],c>=t.length||(i=t[c])&&(u=u>=(r=n.width)||isNaN(r)?u:r,d+=n.height+5,++p>=i&&(a.push(u),o.push(d),h+=u+10,p=0,u=0,d=-5,++c));var _=l.director.getWinSize();c=0,u=0,i=0;var g=-h/2,T=0;if(m&&m.length>0)for(e=0,s=m.length;e<s;e++)n=m[e],0===i&&(i=t[c],T=o[c]),u=u>=(r=n._getWidth())||isNaN(r)?u:r,n.setPosition(g+a[c]/2,T-_.height/2),T-=n.height+10,++p>=i&&(g+=u+5,p=0,i=0,u=0,++c)},removeChild:function(e,t){null!=e&&(e instanceof l.MenuItem?(this._selectedItem===e&&(this._selectedItem=null),l.Node.prototype.removeChild.call(this,e,t)):l.log("cc.Menu.removeChild():Menu only supports MenuItem objects as children"))},_onTouchBegan:function(e,t){var i=t.getCurrentTarget();if(i._state!==l.MENU_STATE_WAITING||!i._visible||!i.enabled)return!1;for(var n=i.parent;null!=n;n=n.parent)if(!n.isVisible())return!1;return i._selectedItem=i._itemForTouch(e),!!i._selectedItem&&(i._state=l.MENU_STATE_TRACKING_TOUCH,i._selectedItem.selected(),i._selectedItem.setNodeDirty(),!0)},_onTouchEnded:function(e,t){var i=t.getCurrentTarget();i._state===l.MENU_STATE_TRACKING_TOUCH?(i._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty(),i._selectedItem.activate()),i._state=l.MENU_STATE_WAITING):l.log("cc.Menu.onTouchEnded(): invalid state")},_onTouchCancelled:function(e,t){var i=t.getCurrentTarget();i._state===l.MENU_STATE_TRACKING_TOUCH?(i._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty()),i._state=l.MENU_STATE_WAITING):l.log("cc.Menu.onTouchCancelled(): invalid state")},_onTouchMoved:function(e,t){var i=t.getCurrentTarget();if(i._state===l.MENU_STATE_TRACKING_TOUCH){var n=i._itemForTouch(e);n!==i._selectedItem&&(i._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty()),i._selectedItem=n,i._selectedItem&&(i._selectedItem.selected(),i._selectedItem.setNodeDirty()))}else l.log("cc.Menu.onTouchMoved(): invalid state")},onExit:function(){this._state===l.MENU_STATE_TRACKING_TOUCH&&(this._selectedItem&&(this._selectedItem.unselected(),this._selectedItem=null),this._state=l.MENU_STATE_WAITING),l.Node.prototype.onExit.call(this)},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},_itemForTouch:function(e){var t,i=e.getLocation(),n=this._children;if(n&&n.length>0)for(var s=n.length-1;s>=0;s--)if((t=n[s]).isVisible()&&t.isEnabled()){var r=t.convertToNodeSpace(i),a=t.rect();if(a.x=0,a.y=0,l.rectContainsPoint(a,r))return t}return null}});var d=l.Menu.prototype;d.enabled,l.Menu.create=function(e){var t=arguments.length;t>0&&null==arguments[t-1]&&l.log("parameters should not be ending with null in Javascript");return 0===t?new l.Menu:1===t?new l.Menu(e):new l.Menu(Array.prototype.slice.call(arguments,0))},l.NodeGrid=l.Node.extend({grid:null,_target:null,_gridRect:null,ctor:function(e){l.Node.prototype.ctor.call(this),void 0===e&&(e=l.rect()),this._gridRect=e},getGrid:function(){return this.grid},setGrid:function(e){this.grid=e},setGridRect:function(e){this._gridRect=e},getGridRect:function(){return this._gridRect},setTarget:function(e){this._target=e},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_WEBGL?new l.NodeGrid.WebGLRenderCmd(this):new l.Node.CanvasRenderCmd(this)}});var d=l.NodeGrid.prototype;d.grid,d.target,l.defineGetterSetter(d,"target",null,d.setTarget),l.NodeGrid.create=function(){return new l.NodeGrid},function(){l.NodeGrid.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!1,this._gridBeginCommand=new l.CustomRenderCmd(this,this.onGridBeginDraw),this._gridEndCommand=new l.CustomRenderCmd(this,this.onGridEndDraw)};var e=l.NodeGrid.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.NodeGrid.WebGLRenderCmd,e.visit=function(e){var t=this._node;if(t._visible){(e=e||this.getParentRenderCmd())&&(this._curLevel=e._curLevel+1);var i=l.current_stack;i.stack.push(i.top),this._syncStatus(e),i.top=this._stackMatrix,l.renderer.pushRenderCommand(this._gridBeginCommand),t._target&&t._target.visit();var n=t._children;if(n&&n.length>0){var s=n.length;t.sortAllChildren();for(var r=0;r<s;r++){var a=n[r];a&&a.visit()}}l.renderer.pushRenderCommand(this._gridEndCommand),this._dirtyFlag=0,i.top=i.stack.pop()}},e.onGridBeginDraw=function(){var e=this._node.grid;e&&e._active&&e.beforeDraw()},e.onGridEndDraw=function(){var e=this._node.grid;e&&e._active&&e.afterDraw(this._node)}}(),l.PointObject=l.Class.extend({_ratio:null,_offset:null,_child:null,ctor:function(e,t){this.initWithCCPoint(e,t)},getRatio:function(){return this._ratio},setRatio:function(e){this._ratio=e},getOffset:function(){return this._offset},setOffset:function(e){this._offset=e},getChild:function(){return this._child},setChild:function(e){this._child=e},initWithCCPoint:function(e,t){return this._ratio=e,this._offset=t,this._child=null,!0}}),l.PointObject.create=function(e,t){return new l.PointObject(e,t)},l.ParallaxNode=l.Node.extend({parallaxArray:null,_lastPosition:null,_className:"ParallaxNode",getParallaxArray:function(){return this.parallaxArray},setParallaxArray:function(e){this.parallaxArray=e},ctor:function(){l.Node.prototype.ctor.call(this),this.parallaxArray=[],this._lastPosition=l.p(-100,-100)},addChild:function(e,t,i,n){if(3!==arguments.length){if(!e)throw new Error("cc.ParallaxNode.addChild(): child should be non-null");var s=new l.PointObject(i,n);s.setChild(e),this.parallaxArray.push(s),e.setPosition(this._position.x*i.x+n.x,this._position.y*i.y+n.y),l.Node.prototype.addChild.call(this,e,t,e.tag)}else l.log("ParallaxNode: use addChild(child, z, ratio, offset) instead")},removeChild:function(e,t){for(var i=this.parallaxArray,n=0;n<i.length;n++)if(i[n].getChild()===e){i.splice(n,1);break}l.Node.prototype.removeChild.call(this,e,t)},removeAllChildren:function(e){this.parallaxArray.length=0,l.Node.prototype.removeAllChildren.call(this,e)},_updateParallaxPosition:function(){var e=this._absolutePosition();if(!l.pointEqualToPoint(e,this._lastPosition)){for(var t=this.parallaxArray,i=0,n=t.length;i<n;i++){var s=t[i];s.getChild().setPosition(-e.x+e.x*s.getRatio().x+s.getOffset().x,-e.y+e.y*s.getRatio().y+s.getOffset().y)}this._lastPosition=e}},_absolutePosition:function(){for(var e=this._position,t=this;null!==t.parent;)t=t.parent,e=l.pAdd(e,t.getPosition());return e},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.ParallaxNode.CanvasRenderCmd(this):new l.ParallaxNode.WebGLRenderCmd(this)}}),l.ParallaxNode.create=function(){return new l.ParallaxNode},function(){l.ParallaxNode.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!1};var e=l.ParallaxNode.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.ParallaxNode.CanvasRenderCmd,e.updateStatus=function(){this._node._updateParallaxPosition(),this.originUpdateStatus()},e._syncStatus=function(e){this._node._updateParallaxPosition(),this._originSyncStatus(e)}}(),l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){if(l._renderType===l.game.RENDER_TYPE_WEBGL){l.ParallaxNode.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!1};var e=l.ParallaxNode.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.ParallaxNode.WebGLRenderCmd,e.updateStatus=function(){this._node._updateParallaxPosition(),this.originUpdateStatus()},e._syncStatus=function(e){this._node._updateParallaxPosition(),this._originSyncStatus(e)}}}),l.PNGReader=l.Class.extend({ctor:function(e){var t,i,n,s,r,a,o,h,l,d,c,u,p,m;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},r=null;;){switch(t=this.readUInt32(),l=function(){var e,t;for(t=[],a=e=0;e<4;a=++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":r&&this.animation.frames.push(r),this.pos+=4,r={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},s=this.readUInt16(),n=this.readUInt16()||100,r.delay=1e3*s/n,r.disposeOp=this.data[this.pos++],r.blendOp=this.data[this.pos++],r.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,t-=4),e=(null!=r?r.data:void 0)||this.imgData,a=u=0;0<=t?u<t:u>t;a=0<=t?++u:--u)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(t),(d=255-this.transparency.indexed.length)>0)for(a=p=0;0<=d?p<d:p>d;a=0<=d?++p:--p)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":o=(c=this.read(t)).indexOf(0),h=String.fromCharCode.apply(String,c.slice(0,o)),this.text[h]=String.fromCharCode.apply(String,c.slice(o+1));break;case"IEND":return r&&this.animation.frames.push(r),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(m=this.colorType)||6===m,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(Uint8Array!=Array&&(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}},read:function(e){var t,i;for(i=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)i.push(this.data[this.pos++]);return i},readUInt32:function(){var e,t,i,n;return e=this.data[this.pos++]<<24,t=this.data[this.pos++]<<16,i=this.data[this.pos++]<<8,n=this.data[this.pos++],e|t|i|n},readUInt16:function(){var e,t;return e=this.data[this.pos++]<<8,t=this.data[this.pos++],e|t},decodePixels:function(e){var t,i,n,s,r,a,o,h,l,d,c,u,p,m,_,g,T,f,S,w,v,L,M;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);for(e=new Zlib.Inflate(e,{index:0,verify:!1}).decompress(),g=(u=this.pixelBitlength/8)*this.width,p=new Uint8Array(g*this.height),a=e.length,_=0,m=0,i=0;m<a;){switch(e[m++]){case 0:for(s=S=0;S<g;s=S+=1)p[i++]=e[m++];break;case 1:for(s=w=0;w<g;s=w+=1)t=e[m++],r=s<u?0:p[i-u],p[i++]=(t+r)%256;break;case 2:for(s=v=0;v<g;s=v+=1)t=e[m++],n=(s-s%u)/u,T=_&&p[(_-1)*g+n*u+s%u],p[i++]=(T+t)%256;break;case 3:for(s=L=0;L<g;s=L+=1)t=e[m++],n=(s-s%u)/u,r=s<u?0:p[i-u],T=_&&p[(_-1)*g+n*u+s%u],p[i++]=(t+Math.floor((r+T)/2))%256;break;case 4:for(s=M=0;M<g;s=M+=1)t=e[m++],n=(s-s%u)/u,r=s<u?0:p[i-u],0===_?T=f=0:(T=p[(_-1)*g+n*u+s%u],f=n&&p[(_-1)*g+(n-1)*u+s%u]),o=r+T-f,h=Math.abs(o-r),d=Math.abs(o-T),c=Math.abs(o-f),l=h<=d&&h<=c?r:d<=c?T:f,p[i++]=(t+l)%256;break;default:throw new Error("Invalid filter algorithm: "+e[m-1])}_++}return p},copyToImageData:function(e,t){var i,n,s,r,a,o,h,l,d,c,u;if(n=this.colors,d=null,i=this.hasAlphaChannel,this.palette.length&&(d=null!=(u=this._decodedPalette)?u:this._decodedPalette=this.decodePalette(),n=4,i=!0),s=e.data||e,l=s.length,a=d||t,r=o=0,1===n)for(;r<l;)h=d?4*t[r/4]:o,c=a[h++],s[r++]=c,s[r++]=c,s[r++]=c,s[r++]=i?a[h++]:255,o=h;else for(;r<l;)h=d?4*t[r/4]:o,s[r++]=a[h++],s[r++]=a[h++],s[r++]=a[h++],s[r++]=i?a[h++]:255,o=h},decodePalette:function(){var e,t,i,n,s,r,a,o,h;for(i=this.palette,r=this.transparency.indexed||[],s=new Uint8Array((r.length||0)+i.length),n=0,e=0,t=a=0,o=i.length;a<o;t=a+=3)s[n++]=i[t],s[n++]=i[t+1],s[n++]=i[t+2],s[n++]=null!=(h=r[e++])?h:255;return s},render:function(e){var t,i;return e.width=this.width,e.height=this.height,t=e.getContext("2d"),i=t.createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),t.putImageData(i,0,0)}}),l.tiffReader={_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(e){return this._tiffData[e]},getUint16:function(e){return this._littleEndian?this._tiffData[e+1]<<8|this._tiffData[e]:this._tiffData[e]<<8|this._tiffData[e+1]},getUint32:function(e){var t=this._tiffData;return this._littleEndian?t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]:t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]},checkLittleEndian:function(){var e=this.getUint16(0);if(18761===e)this.littleEndian=!0;else{if(19789!==e)throw console.log(e),TypeError("Invalid byte order value.");this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(42!==this.getUint16(2))throw RangeError("You forgot your towel!");return!0},getFieldTypeName:function(e){var t=this.fieldTypeNames;return e in t?t[e]:null},getFieldTagName:function(e){var t=this.fieldTagNames;return e in t?t[e]:(console.log("Unknown Field Tag:",e),"Tag"+e)},getFieldTypeLength:function(e){return-1!==["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(e)?1:-1!==["SHORT","SSHORT"].indexOf(e)?2:-1!==["LONG","SLONG","FLOAT"].indexOf(e)?4:-1!==["RATIONAL","SRATIONAL","DOUBLE"].indexOf(e)?8:null},getFieldValues:function(e,t,i,n){var s=[],r=this.getFieldTypeLength(t);if(r*i<=4)!1===this.littleEndian?s.push(n>>>8*(4-r)):s.push(n);else for(var a=0;a<i;a++){var o=r*a;r>=8?-1!==["RATIONAL","SRATIONAL"].indexOf(t)?(s.push(this.getUint32(n+o)),s.push(this.getUint32(n+o+4))):l.log("Can't handle this field type or size"):s.push(this.getBytes(r,n+o))}return"ASCII"===t&&s.forEach(function(e,t,i){i[t]=String.fromCharCode(e)}),s},getBytes:function(e,t){if(e<=0)l.log("No bytes requested");else{if(e<=1)return this.getUint8(t);if(e<=2)return this.getUint16(t);if(e<=3)return this.getUint32(t)>>>8;if(e<=4)return this.getUint32(t);l.log("Too many bytes requested")}},getBits:function(e,t,i){i=i||0;var n,s,r=t+Math.floor(i/8),a=i+e,o=32-e;return a<=0?console.log("No bits requested"):a<=8?(n=24+i,s=this.getUint8(r)):a<=16?(n=16+i,s=this.getUint16(r)):a<=32?(n=i,s=this.getUint32(r)):console.log("Too many bits requested"),{bits:s<<n>>>o,byteOffset:r+Math.floor(a/8),bitOffset:a%8}},parseFileDirectory:function(e){for(var t=this.getUint16(e),i=[],n=e+2,s=0;s<t;n+=12,s++){var r=this.getUint16(n),a=this.getUint16(n+2),o=this.getUint32(n+4),h=this.getUint32(n+8),l=this.getFieldTagName(r),d=this.getFieldTypeName(a),c=this.getFieldValues(l,d,o,h);i[l]={type:d,values:c}}this._fileDirectories.push(i);var u=this.getUint32(n);0!==u&&this.parseFileDirectory(u)},clampColorSample:function(e,t){var i=Math.pow(2,8-t);return Math.floor(e*i+(i-1))},parseTIFF:function(e,t){if(t=t||document.createElement("canvas"),this._tiffData=e,this.canvas=t,this.checkLittleEndian(),this.hasTowel()){var i=this.getUint32(4);this._fileDirectories.length=0,this.parseFileDirectory(i);var n=this._fileDirectories[0],s=n.ImageWidth.values[0],r=n.ImageLength.values[0];this.canvas.width=s,this.canvas.height=r;var a=[],o=n.Compression?n.Compression.values[0]:1,h=n.SamplesPerPixel.values[0],d=[],c=0,u=!1;if(n.BitsPerSample.values.forEach(function(e,t,i){d[t]={bitsPerSample:e,hasBytesPerSample:!1,bytesPerSample:void 0},e%8==0&&(d[t].hasBytesPerSample=!0,d[t].bytesPerSample=e/8),c+=e},this),c%8==0){u=!0;var p=c/8}var m=n.StripOffsets.values,_=m.length;if(n.StripByteCounts)g=n.StripByteCounts.values;else{if(l.log("Missing StripByteCounts!"),1!==_)throw Error("Cannot recover from missing StripByteCounts");var g=[Math.ceil(s*r*c/8)]}for(X=0;X<_;X++){var T=m[X];a[X]=[];for(var f=g[X],S=0,w=0,v=1,L=!0,M=[],C=0,y=0,B=0;S<f;S+=v)switch(o){case 1:for(var F=0,M=[];F<h;F++){if(!d[F].hasBytesPerSample){var E=this.getBits(d[F].bitsPerSample,T+S,w);throw M.push(E.bits),S=E.byteOffset-T,w=E.bitOffset,RangeError("Cannot handle sub-byte bits per sample")}var P=d[F].bytesPerSample*F;M.push(this.getBytes(d[F].bytesPerSample,T+S+P))}if(a[X].push(M),!u)throw v=0,RangeError("Cannot handle sub-byte bits per pixel");v=p;break;case 2:case 3:case 4:case 5:case 6:case 7:break;case 32773:if(L){L=!1;var b=1,A=1,O=this.getInt8(T+S);O>=0&&O<=127?b=O+1:O>=-127&&O<=-1?A=1-O:L=!0}else{for(var I=this.getUint8(T+S),F=0;F<A;F++){if(!d[y].hasBytesPerSample)throw RangeError("Cannot handle sub-byte bits per sample");B=B<<8*C|I,++C===d[y].bytesPerSample&&(M.push(B),B=C=0,y++),y===h&&(a[X].push(M),M=[],y=0)}0===--b&&(L=!0)}v=1}}if(t.getContext){var R=this.canvas.getContext("2d");R.fillStyle="rgba(255, 255, 255, 0)";var D=n.RowsPerStrip?n.RowsPerStrip.values[0]:r,x=a.length,N=r%D,G=0===N?D:N,W=D,k=0,U=n.PhotometricInterpretation.values[0],H=[],V=0;if(n.ExtraSamples&&(V=(H=n.ExtraSamples.values).length),n.ColorMap)var z=n.ColorMap.values,Y=Math.pow(2,d[0].bitsPerSample);for(var X=0;X<x;X++){X+1===x&&(W=G);for(var j=a[X].length,K=k*X,q=0,Q=0;Q<j;q++)for(var Z=0;Z<s;Z++,Q++){var J=a[X][Q],$=0,ee=0,te=0,ie=1;if(V>0)for(var ne=0;ne<V;ne++)if(1===H[ne]||2===H[ne]){ie=J[3+ne]/256;break}switch(U){case 0:if(d[0].hasBytesPerSample)var se=Math.pow(16,2*d[0].bytesPerSample);J.forEach(function(e,t,i){i[t]=se-e});case 1:$=ee=te=this.clampColorSample(J[0],d[0].bitsPerSample);break;case 2:$=this.clampColorSample(J[0],d[0].bitsPerSample),ee=this.clampColorSample(J[1],d[1].bitsPerSample),te=this.clampColorSample(J[2],d[2].bitsPerSample);break;case 3:if(void 0===z)throw Error("Palette image missing color map");var re=J[0];$=this.clampColorSample(z[re],16),ee=this.clampColorSample(z[Y+re],16),te=this.clampColorSample(z[2*Y+re],16);break;default:throw RangeError("Unknown Photometric Interpretation:",U)}R.fillStyle="rgba("+$+", "+ee+", "+te+", "+ie+")",R.fillRect(Z,K+q,1,1)}k=W}}return this.canvas}},fieldTagNames:{315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},fieldTypeNames:{1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"}},l.Particle=function(e,t,i,n,s,r,a,o,h,d,c,u){this.pos=e||l.p(0,0),this.startPos=t||l.p(0,0),this.color=i||{r:0,g:0,b:0,a:255},this.deltaColor=n||{r:0,g:0,b:0,a:255},this.size=s||0,this.deltaSize=r||0,this.rotation=a||0,this.deltaRotation=o||0,this.timeToLive=h||0,this.atlasIndex=d||0,this.modeA=c||new l.Particle.ModeA,this.modeB=u||new l.Particle.ModeB,this.isChangeColor=!1,this.drawPos=l.p(0,0)},l.Particle.ModeA=function(e,t,i){this.dir=e||l.p(0,0),this.radialAccel=t||0,this.tangentialAccel=i||0},l.Particle.ModeB=function(e,t,i,n){this.angle=e||0,this.degreesPerSecond=t||0,this.radius=i||0,this.deltaRadius=n||0},l.Particle.TemporaryPoints=[l.p(),l.p(),l.p(),l.p()],l.ParticleSystem=l.Node.extend({_className:"ParticleSystem",_plistFile:"",_elapsed:0,_dontTint:!1,modeA:null,modeB:null,_pointZeroForParticle:l.p(0,0),_particles:null,_emitCounter:0,_particleIdx:0,_batchNode:null,atlasIndex:0,_transformSystemDirty:!1,_allocatedParticles:0,_isActive:!1,particleCount:0,duration:0,_sourcePosition:null,_posVar:null,life:0,lifeVar:0,angle:0,angleVar:0,startSize:0,startSizeVar:0,endSize:0,endSizeVar:0,_startColor:null,_startColorVar:null,_endColor:null,_endColorVar:null,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,emissionRate:0,_totalParticles:0,_texture:null,_blendFunc:null,_opacityModifyRGB:!1,positionType:null,autoRemoveOnFinish:!1,emitterMode:0,_textureLoaded:null,ctor:function(e){if(l.Node.prototype.ctor.call(this),this.emitterMode=l.ParticleSystem.MODE_GRAVITY,this.modeA=new l.ParticleSystem.ModeA,this.modeB=new l.ParticleSystem.ModeB,this._blendFunc={src:l.BLEND_SRC,dst:l.BLEND_DST},this._particles=[],this._sourcePosition=l.p(0,0),this._posVar=l.p(0,0),this._startColor=l.color(255,255,255,255),this._startColorVar=l.color(255,255,255,255),this._endColor=l.color(255,255,255,255),this._endColorVar=l.color(255,255,255,255),this._plistFile="",this._elapsed=0,this._dontTint=!1,this._pointZeroForParticle=l.p(0,0),this._emitCounter=0,this._particleIdx=0,this._batchNode=null,this.atlasIndex=0,this._transformSystemDirty=!1,this._allocatedParticles=0,this._isActive=!1,this.particleCount=0,this.duration=0,this.life=0,this.lifeVar=0,this.angle=0,this.angleVar=0,this.startSize=0,this.startSizeVar=0,this.endSize=0,this.endSizeVar=0,this.startSpin=0,this.startSpinVar=0,this.endSpin=0,this.endSpinVar=0,this.emissionRate=0,this._totalParticles=0,this._texture=null,this._opacityModifyRGB=!1,this.positionType=l.ParticleSystem.TYPE_FREE,this.autoRemoveOnFinish=!1,this._textureLoaded=!0,!e||l.isNumber(e)){var t=e||100;this.setDrawMode(l.ParticleSystem.TEXTURE_MODE),this.initWithTotalParticles(t)}else l.isString(e)?this.initWithFile(e):l.isObject(e)&&this.initWithDictionary(e,"")},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.ParticleSystem.CanvasRenderCmd(this):new l.ParticleSystem.WebGLRenderCmd(this)},ignoreColor:function(e){this._dontTint=e},initTexCoordsWithRect:function(e){this._renderCmd.initTexCoordsWithRect(e)},getBatchNode:function(){return this._batchNode},setBatchNode:function(e){this._renderCmd.setBatchNode(e)},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(e){this.atlasIndex=e},getDrawMode:function(){return this._renderCmd.getDrawMode()},setDrawMode:function(e){this._renderCmd.setDrawMode(e)},getShapeType:function(){return this._renderCmd.getShapeType()},setShapeType:function(e){this._renderCmd.setShapeType(e)},isActive:function(){return this._isActive},getParticleCount:function(){return this.particleCount},setParticleCount:function(e){this.particleCount=e},getDuration:function(){return this.duration},setDuration:function(e){this.duration=e},getSourcePosition:function(){return{x:this._sourcePosition.x,y:this._sourcePosition.y}},setSourcePosition:function(e){this._sourcePosition.x=e.x,this._sourcePosition.y=e.y},getPosVar:function(){return{x:this._posVar.x,y:this._posVar.y}},setPosVar:function(e){this._posVar.x=e.x,this._posVar.y=e.y},getLife:function(){return this.life},setLife:function(e){this.life=e},getLifeVar:function(){return this.lifeVar},setLifeVar:function(e){this.lifeVar=e},getAngle:function(){return this.angle},setAngle:function(e){this.angle=e},getAngleVar:function(){return this.angleVar},setAngleVar:function(e){this.angleVar=e},getGravity:function(){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.getGravity() : Particle Mode should be Gravity");var e=this.modeA.gravity;return l.p(e.x,e.y)},setGravity:function(e){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.setGravity() : Particle Mode should be Gravity"),this.modeA.gravity=e},getSpeed:function(){return this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.getSpeed() : Particle Mode should be Gravity"),this.modeA.speed},setSpeed:function(e){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.setSpeed() : Particle Mode should be Gravity"),this.modeA.speed=e},getSpeedVar:function(){return this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.getSpeedVar() : Particle Mode should be Gravity"),this.modeA.speedVar},setSpeedVar:function(e){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.setSpeedVar() : Particle Mode should be Gravity"),this.modeA.speedVar=e},getTangentialAccel:function(){return this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.getTangentialAccel() : Particle Mode should be Gravity"),this.modeA.tangentialAccel},setTangentialAccel:function(e){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.setTangentialAccel() : Particle Mode should be Gravity"),this.modeA.tangentialAccel=e},getTangentialAccelVar:function(){return this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.getTangentialAccelVar() : Particle Mode should be Gravity"),this.modeA.tangentialAccelVar},setTangentialAccelVar:function(e){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.setTangentialAccelVar() : Particle Mode should be Gravity"),this.modeA.tangentialAccelVar=e},getRadialAccel:function(){return this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.getRadialAccel() : Particle Mode should be Gravity"),this.modeA.radialAccel},setRadialAccel:function(e){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.setRadialAccel() : Particle Mode should be Gravity"),this.modeA.radialAccel=e},getRadialAccelVar:function(){return this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.getRadialAccelVar() : Particle Mode should be Gravity"),this.modeA.radialAccelVar},setRadialAccelVar:function(e){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.setRadialAccelVar() : Particle Mode should be Gravity"),this.modeA.radialAccelVar=e},getRotationIsDir:function(){return this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.getRotationIsDir() : Particle Mode should be Gravity"),this.modeA.rotationIsDir},setRotationIsDir:function(e){this.emitterMode!==l.ParticleSystem.MODE_GRAVITY&&l.log("cc.ParticleBatchNode.setRotationIsDir() : Particle Mode should be Gravity"),this.modeA.rotationIsDir=e},getStartRadius:function(){return this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.getStartRadius() : Particle Mode should be Radius"),this.modeB.startRadius},setStartRadius:function(e){this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.setStartRadius() : Particle Mode should be Radius"),this.modeB.startRadius=e},getStartRadiusVar:function(){return this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.getStartRadiusVar() : Particle Mode should be Radius"),this.modeB.startRadiusVar},setStartRadiusVar:function(e){this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.setStartRadiusVar() : Particle Mode should be Radius"),this.modeB.startRadiusVar=e},getEndRadius:function(){return this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.getEndRadius() : Particle Mode should be Radius"),this.modeB.endRadius},setEndRadius:function(e){this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.setEndRadius() : Particle Mode should be Radius"),this.modeB.endRadius=e},getEndRadiusVar:function(){return this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.getEndRadiusVar() : Particle Mode should be Radius"),this.modeB.endRadiusVar},setEndRadiusVar:function(e){this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.setEndRadiusVar() : Particle Mode should be Radius"),this.modeB.endRadiusVar=e},getRotatePerSecond:function(){return this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.getRotatePerSecond() : Particle Mode should be Radius"),this.modeB.rotatePerSecond},setRotatePerSecond:function(e){this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.setRotatePerSecond() : Particle Mode should be Radius"),this.modeB.rotatePerSecond=e},getRotatePerSecondVar:function(){return this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.getRotatePerSecondVar() : Particle Mode should be Radius"),this.modeB.rotatePerSecondVar},setRotatePerSecondVar:function(e){this.emitterMode!==l.ParticleSystem.MODE_RADIUS&&l.log("cc.ParticleBatchNode.setRotatePerSecondVar() : Particle Mode should be Radius"),this.modeB.rotatePerSecondVar=e},setScale:function(e,t){this._transformSystemDirty=!0,l.Node.prototype.setScale.call(this,e,t)},setRotation:function(e){this._transformSystemDirty=!0,l.Node.prototype.setRotation.call(this,e)},setScaleX:function(e){this._transformSystemDirty=!0,l.Node.prototype.setScaleX.call(this,e)},setScaleY:function(e){this._transformSystemDirty=!0,l.Node.prototype.setScaleY.call(this,e)},getStartSize:function(){return this.startSize},setStartSize:function(e){this.startSize=e},getStartSizeVar:function(){return this.startSizeVar},setStartSizeVar:function(e){this.startSizeVar=e},getEndSize:function(){return this.endSize},setEndSize:function(e){this.endSize=e},getEndSizeVar:function(){return this.endSizeVar},setEndSizeVar:function(e){this.endSizeVar=e},getStartColor:function(){return l.color(this._startColor.r,this._startColor.g,this._startColor.b,this._startColor.a)},setStartColor:function(e){this._startColor.r=e.r,this._startColor.g=e.g,this._startColor.b=e.b,this._startColor.a=e.a},getStartColorVar:function(){return l.color(this._startColorVar.r,this._startColorVar.g,this._startColorVar.b,this._startColorVar.a)},setStartColorVar:function(e){this._startColorVar.r=e.r,this._startColorVar.g=e.g,this._startColorVar.b=e.b,this._startColorVar.a=e.a},getEndColor:function(){return l.color(this._endColor.r,this._endColor.g,this._endColor.b,this._endColor.a)},setEndColor:function(e){this._endColor.r=e.r,this._endColor.g=e.g,this._endColor.b=e.b,this._endColor.a=e.a},getEndColorVar:function(){return l.color(this._endColorVar.r,this._endColorVar.g,this._endColorVar.b,this._endColorVar.a)},setEndColorVar:function(e){this._endColorVar.r=e.r,this._endColorVar.g=e.g,this._endColorVar.b=e.b,this._endColorVar.a=e.a},getStartSpin:function(){return this.startSpin},setStartSpin:function(e){this.startSpin=e},getStartSpinVar:function(){return this.startSpinVar},setStartSpinVar:function(e){this.startSpinVar=e},getEndSpin:function(){return this.endSpin},setEndSpin:function(e){this.endSpin=e},getEndSpinVar:function(){return this.endSpinVar},setEndSpinVar:function(e){this.endSpinVar=e},getEmissionRate:function(){return this.emissionRate},setEmissionRate:function(e){this.emissionRate=e},getTotalParticles:function(){return this._totalParticles},setTotalParticles:function(e){this._renderCmd.setTotalParticles(e)},getTexture:function(){return this._texture},setTexture:function(e){e&&(e.isLoaded()?this.setTextureWithRect(e,l.rect(0,0,e.width,e.height)):(this._textureLoaded=!1,e.addEventListener("load",function(e){this._textureLoaded=!0,this.setTextureWithRect(e,l.rect(0,0,e.width,e.height))},this)))},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){void 0===t?this._blendFunc!==e&&(this._blendFunc=e,this._updateBlendFunc()):this._blendFunc.src===e&&this._blendFunc.dst===t||(this._blendFunc={src:e,dst:t},this._updateBlendFunc())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(e){this._opacityModifyRGB=e},isBlendAdditive:function(){return this._blendFunc.src===l.SRC_ALPHA&&this._blendFunc.dst===l.ONE||this._blendFunc.src===l.ONE&&this._blendFunc.dst===l.ONE},setBlendAdditive:function(e){var t=this._blendFunc;e?(t.src=l.SRC_ALPHA,t.dst=l.ONE):this._renderCmd._setBlendAdditive()},getPositionType:function(){return this.positionType},setPositionType:function(e){this.positionType=e},isAutoRemoveOnFinish:function(){return this.autoRemoveOnFinish},setAutoRemoveOnFinish:function(e){this.autoRemoveOnFinish=e},getEmitterMode:function(){return this.emitterMode},setEmitterMode:function(e){this.emitterMode=e},init:function(){return this.initWithTotalParticles(150)},initWithFile:function(e){this._plistFile=e;var t=l.loader.getRes(e);return t?this.initWithDictionary(t,""):(l.log("cc.ParticleSystem.initWithFile(): Particles: file not found"),!1)},getBoundingBoxToWorld:function(){return l.rect(0,0,l._canvas.width,l._canvas.height)},initWithDictionary:function(e,t){var i=!1,n=null,s=this._valueForKey,r=parseInt(s("maxParticles",e));if(this.initWithTotalParticles(r)){this.angle=parseFloat(s("angle",e)),this.angleVar=parseFloat(s("angleVariance",e)),this.duration=parseFloat(s("duration",e)),this._blendFunc.src=parseInt(s("blendFuncSource",e)),this._blendFunc.dst=parseInt(s("blendFuncDestination",e));var a=this._startColor;a.r=255*parseFloat(s("startColorRed",e)),a.g=255*parseFloat(s("startColorGreen",e)),a.b=255*parseFloat(s("startColorBlue",e)),a.a=255*parseFloat(s("startColorAlpha",e));var o=this._startColorVar;o.r=255*parseFloat(s("startColorVarianceRed",e)),o.g=255*parseFloat(s("startColorVarianceGreen",e)),o.b=255*parseFloat(s("startColorVarianceBlue",e)),o.a=255*parseFloat(s("startColorVarianceAlpha",e));var h=this._endColor;h.r=255*parseFloat(s("finishColorRed",e)),h.g=255*parseFloat(s("finishColorGreen",e)),h.b=255*parseFloat(s("finishColorBlue",e)),h.a=255*parseFloat(s("finishColorAlpha",e));var d=this._endColorVar;if(d.r=255*parseFloat(s("finishColorVarianceRed",e)),d.g=255*parseFloat(s("finishColorVarianceGreen",e)),d.b=255*parseFloat(s("finishColorVarianceBlue",e)),d.a=255*parseFloat(s("finishColorVarianceAlpha",e)),this.startSize=parseFloat(s("startParticleSize",e)),this.startSizeVar=parseFloat(s("startParticleSizeVariance",e)),this.endSize=parseFloat(s("finishParticleSize",e)),this.endSizeVar=parseFloat(s("finishParticleSizeVariance",e)),this.setPosition(parseFloat(s("sourcePositionx",e)),parseFloat(s("sourcePositiony",e))),this._posVar.x=parseFloat(s("sourcePositionVariancex",e)),this._posVar.y=parseFloat(s("sourcePositionVariancey",e)),this.startSpin=parseFloat(s("rotationStart",e)),this.startSpinVar=parseFloat(s("rotationStartVariance",e)),this.endSpin=parseFloat(s("rotationEnd",e)),this.endSpinVar=parseFloat(s("rotationEndVariance",e)),this.emitterMode=parseInt(s("emitterType",e)),this.emitterMode===l.ParticleSystem.MODE_GRAVITY){var c=this.modeA;c.gravity.x=parseFloat(s("gravityx",e)),c.gravity.y=parseFloat(s("gravityy",e)),c.speed=parseFloat(s("speed",e)),c.speedVar=parseFloat(s("speedVariance",e));var u=s("radialAcceleration",e);c.radialAccel=u?parseFloat(u):0,u=s("radialAccelVariance",e),c.radialAccelVar=u?parseFloat(u):0,u=s("tangentialAcceleration",e),c.tangentialAccel=u?parseFloat(u):0,u=s("tangentialAccelVariance",e),c.tangentialAccelVar=u?parseFloat(u):0;var p=s("rotationIsDir",e);null!==p?(p=p.toString().toLowerCase(),c.rotationIsDir="true"===p||"1"===p):c.rotationIsDir=!1}else{if(this.emitterMode!==l.ParticleSystem.MODE_RADIUS)return l.log("cc.ParticleSystem.initWithDictionary(): Invalid emitterType in config file"),!1;var m=this.modeB;m.startRadius=parseFloat(s("maxRadius",e)),m.startRadiusVar=parseFloat(s("maxRadiusVariance",e)),m.endRadius=parseFloat(s("minRadius",e)),m.endRadiusVar=0,m.rotatePerSecond=parseFloat(s("rotatePerSecond",e)),m.rotatePerSecondVar=parseFloat(s("rotatePerSecondVariance",e))}if(this.life=parseFloat(s("particleLifespan",e)),this.lifeVar=parseFloat(s("particleLifespanVariance",e)),this.emissionRate=this._totalParticles/this.life,!this._batchNode){this._opacityModifyRGB=!1;var _=s("textureFileName",e),g=l.path.changeBasename(this._plistFile,_),T=l.textureCache.getTextureForKey(g);if(T)this.setTexture(T);else{var f=s("textureImageData",e);if(f&&0!==f.length){if(!(n=l.unzipBase64AsArray(f,1)))return l.log("cc.ParticleSystem: error decoding or ungzipping textureImageData"),!1;var S=l.getImageFormatByData(n);if(S!==l.FMT_TIFF&&S!==l.FMT_PNG)return l.log("cc.ParticleSystem: unknown image format with Data"),!1;var w=document.createElement("canvas");S===l.FMT_PNG?new l.PNGReader(n).render(w):l.tiffReader.parseTIFF(n,w),l.textureCache.cacheImage(g,w);var v=l.textureCache.getTextureForKey(g);v||l.log("cc.ParticleSystem.initWithDictionary() : error loading the texture"),this.setTexture(v)}else{if(!(T=l.textureCache.addImage(g)))return!1;this.setTexture(T)}}}i=!0}return i},initWithTotalParticles:function(e){this._totalParticles=e;var t,i=this._particles;for(i.length=0,t=0;t<e;t++)i[t]=new l.Particle;if(!i)return l.log("Particle system: not enough memory"),!1;if(this._allocatedParticles=e,this._batchNode)for(t=0;t<this._totalParticles;t++)i[t].atlasIndex=t;return this._isActive=!0,this._blendFunc.src=l.BLEND_SRC,this._blendFunc.dst=l.BLEND_DST,this.positionType=l.ParticleSystem.TYPE_FREE,this.emitterMode=l.ParticleSystem.MODE_GRAVITY,this.autoRemoveOnFinish=!1,this._transformSystemDirty=!1,this.scheduleUpdateWithPriority(1),this._renderCmd._initWithTotalParticles(e),!0},destroyParticleSystem:function(){this.unscheduleUpdate()},addParticle:function(){if(this.isFull())return!1;var e=this._renderCmd.addParticle();return this.initParticle(e),++this.particleCount,!0},initParticle:function(e){var t=l.randomMinus1To1;e.timeToLive=this.life+this.lifeVar*t(),e.timeToLive=Math.max(0,e.timeToLive),e.pos.x=this._sourcePosition.x+this._posVar.x*t(),e.pos.y=this._sourcePosition.y+this._posVar.y*t();var i,n,s=this._startColor,r=this._startColorVar,a=this._endColor,o=this._endColorVar;i={r:l.clampf(s.r+r.r*t(),0,255),g:l.clampf(s.g+r.g*t(),0,255),b:l.clampf(s.b+r.b*t(),0,255),a:l.clampf(s.a+r.a*t(),0,255)},n={r:l.clampf(a.r+o.r*t(),0,255),g:l.clampf(a.g+o.g*t(),0,255),b:l.clampf(a.b+o.b*t(),0,255),a:l.clampf(a.a+o.a*t(),0,255)},e.color=i;var h=e.deltaColor,d=e.timeToLive;h.r=(n.r-i.r)/d,h.g=(n.g-i.g)/d,h.b=(n.b-i.b)/d,h.a=(n.a-i.a)/d;var c=this.startSize+this.startSizeVar*t();if(c=Math.max(0,c),e.size=c,this.endSize===l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE)e.deltaSize=0;else{var u=this.endSize+this.endSizeVar*t();u=Math.max(0,u),e.deltaSize=(u-c)/d}var p=this.startSpin+this.startSpinVar*t(),m=this.endSpin+this.endSpinVar*t();e.rotation=p,e.deltaRotation=(m-p)/d,this.positionType===l.ParticleSystem.TYPE_FREE?e.startPos=this.convertToWorldSpace(this._pointZeroForParticle):this.positionType===l.ParticleSystem.TYPE_RELATIVE&&(e.startPos.x=this._position.x,e.startPos.y=this._position.y);var _=l.degreesToRadians(this.angle+this.angleVar*t());if(this.emitterMode===l.ParticleSystem.MODE_GRAVITY){var g=this.modeA,T=e.modeA,f=g.speed+g.speedVar*t();T.dir.x=Math.cos(_),T.dir.y=Math.sin(_),l.pMultIn(T.dir,f),T.radialAccel=g.radialAccel+g.radialAccelVar*t(),T.tangentialAccel=g.tangentialAccel+g.tangentialAccelVar*t(),g.rotationIsDir&&(e.rotation=-l.radiansToDegrees(l.pToAngle(T.dir)))}else{var S=this.modeB,w=e.modeB,v=S.startRadius+S.startRadiusVar*t(),L=S.endRadius+S.endRadiusVar*t();w.radius=v,w.deltaRadius=S.endRadius===l.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(L-v)/d,w.angle=_,w.degreesPerSecond=l.degreesToRadians(S.rotatePerSecond+S.rotatePerSecondVar*t())}},stopSystem:function(){this._isActive=!1,this._elapsed=this.duration,this._emitCounter=0},resetSystem:function(){this._isActive=!0,this._elapsed=0;var e=this._particles;for(this._particleIdx=0;this._particleIdx<this.particleCount;++this._particleIdx)e[this._particleIdx].timeToLive=0},isFull:function(){return this.particleCount>=this._totalParticles},updateQuadWithParticle:function(e,t){this._renderCmd.updateQuadWithParticle(e,t)},postStep:function(){this._renderCmd.postStep()},update:function(e){if(this._isActive&&this.emissionRate){var t=1/this.emissionRate;for(this.particleCount<this._totalParticles&&(this._emitCounter+=e);this.particleCount<this._totalParticles&&this._emitCounter>t;)this.addParticle(),this._emitCounter-=t;this._elapsed+=e,-1!==this.duration&&this.duration<this._elapsed&&this.stopSystem()}this._particleIdx=0;var i=l.Particle.TemporaryPoints[0];if(this.positionType===l.ParticleSystem.TYPE_FREE?l.pIn(i,this.convertToWorldSpace(this._pointZeroForParticle)):this.positionType===l.ParticleSystem.TYPE_RELATIVE&&(i.x=this._position.x,i.y=this._position.y),this._visible){for(var n=l.Particle.TemporaryPoints[1],s=l.Particle.TemporaryPoints[2],r=l.Particle.TemporaryPoints[3],a=this._particles;this._particleIdx<this.particleCount;){l.pZeroIn(n),l.pZeroIn(s),l.pZeroIn(r);var o=a[this._particleIdx];if(o.timeToLive-=e,o.timeToLive>0){if(this.emitterMode===l.ParticleSystem.MODE_GRAVITY){var h=r,d=n,c=s;o.pos.x||o.pos.y?(l.pIn(d,o.pos),l.pNormalizeIn(d)):l.pZeroIn(d),l.pIn(c,d),l.pMultIn(d,o.modeA.radialAccel);var u=c.x;c.x=-c.y,c.y=u,l.pMultIn(c,o.modeA.tangentialAccel),l.pIn(h,d),l.pAddIn(h,c),l.pAddIn(h,this.modeA.gravity),l.pMultIn(h,e),l.pAddIn(o.modeA.dir,h),l.pIn(h,o.modeA.dir),l.pMultIn(h,e),l.pAddIn(o.pos,h)}else{var p=o.modeB;p.angle+=p.degreesPerSecond*e,p.radius+=p.deltaRadius*e,o.pos.x=-Math.cos(p.angle)*p.radius,o.pos.y=-Math.sin(p.angle)*p.radius}this._renderCmd._updateDeltaColor(o,e),o.size+=o.deltaSize*e,o.size=Math.max(0,o.size),o.rotation+=o.deltaRotation*e;var m=n;if(this.positionType===l.ParticleSystem.TYPE_FREE||this.positionType===l.ParticleSystem.TYPE_RELATIVE){var _=s;l.pIn(_,i),l.pSubIn(_,o.startPos),l.pIn(m,o.pos),l.pSubIn(m,_)}else l.pIn(m,o.pos);this._batchNode&&(m.x+=this._position.x,m.y+=this._position.y),this._renderCmd.updateParticlePosition(o,m),++this._particleIdx}else{var g=o.atlasIndex;if(this._particleIdx!==this.particleCount-1){var T=a[this._particleIdx];a[this._particleIdx]=a[this.particleCount-1],a[this.particleCount-1]=T}if(this._batchNode&&(this._batchNode.disableParticle(this.atlasIndex+g),a[this.particleCount-1].atlasIndex=g),0===--this.particleCount&&this.autoRemoveOnFinish)return this.unscheduleUpdate(),void this._parent.removeChild(this,!0)}}this._transformSystemDirty=!1}this._batchNode||this.postStep()},updateWithNoTime:function(){this.update(0)},_valueForKey:function(e,t){if(t){var i=t[e];return null!=i?i:""}return""},_updateBlendFunc:function(){if(this._batchNode)l.log("Can't change blending functions when the particle is being batched");else{var e=this._texture;if(e&&e instanceof l.Texture2D){this._opacityModifyRGB=!1;var t=this._blendFunc;t.src===l.BLEND_SRC&&t.dst===l.BLEND_DST&&(e.hasPremultipliedAlpha()?this._opacityModifyRGB=!0:(t.src=l.SRC_ALPHA,t.dst=l.ONE_MINUS_SRC_ALPHA))}}},clone:function(){var e=new l.ParticleSystem;if(e.initWithTotalParticles(this.getTotalParticles())){e.setAngle(this.getAngle()),e.setAngleVar(this.getAngleVar()),e.setDuration(this.getDuration());var t=this.getBlendFunc();if(e.setBlendFunc(t.src,t.dst),e.setStartColor(this.getStartColor()),e.setStartColorVar(this.getStartColorVar()),e.setEndColor(this.getEndColor()),e.setEndColorVar(this.getEndColorVar()),e.setStartSize(this.getStartSize()),e.setStartSizeVar(this.getStartSizeVar()),e.setEndSize(this.getEndSize()),e.setEndSizeVar(this.getEndSizeVar()),e.setPosition(l.p(this.x,this.y)),e.setPosVar(l.p(this.getPosVar().x,this.getPosVar().y)),e.setPositionType(this.getPositionType()),e.setStartSpin(this.getStartSpin()||0),e.setStartSpinVar(this.getStartSpinVar()||0),e.setEndSpin(this.getEndSpin()||0),e.setEndSpinVar(this.getEndSpinVar()||0),e.setEmitterMode(this.getEmitterMode()),this.getEmitterMode()===l.ParticleSystem.MODE_GRAVITY){var i=this.getGravity();e.setGravity(l.p(i.x,i.y)),e.setSpeed(this.getSpeed()),e.setSpeedVar(this.getSpeedVar()),e.setRadialAccel(this.getRadialAccel()),e.setRadialAccelVar(this.getRadialAccelVar()),e.setTangentialAccel(this.getTangentialAccel()),e.setTangentialAccelVar(this.getTangentialAccelVar())}else this.getEmitterMode()===l.ParticleSystem.MODE_RADIUS&&(e.setStartRadius(this.getStartRadius()),e.setStartRadiusVar(this.getStartRadiusVar()),e.setEndRadius(this.getEndRadius()),e.setEndRadiusVar(this.getEndRadiusVar()),e.setRotatePerSecond(this.getRotatePerSecond()),e.setRotatePerSecondVar(this.getRotatePerSecondVar()));if(e.setLife(this.getLife()),e.setLifeVar(this.getLifeVar()),e.setEmissionRate(this.getEmissionRate()),!this.getBatchNode()){e.setOpacityModifyRGB(this.isOpacityModifyRGB());var n=this.getTexture();if(n){var s=n.getContentSize();e.setTextureWithRect(n,l.rect(0,0,s.width,s.height))}}}return e},setDisplayFrame:function(e){if(e){var t=e.getOffsetInPixels();0===t.x&&0===t.y||l.log("cc.ParticleSystem.setDisplayFrame(): QuadParticle only supports SpriteFrames with no offsets");var i=e.getTexture();this._texture!==i&&this.setTexture(i)}},setTextureWithRect:function(e,t){this._texture!==e&&(this._texture=e,this._updateBlendFunc()),this.initTexCoordsWithRect(t)},listenBackToForeground:function(e){}});var d=l.ParticleSystem.prototype;d.opacityModifyRGB,l.defineGetterSetter(d,"opacityModifyRGB",d.isOpacityModifyRGB,d.setOpacityModifyRGB),d.batchNode,l.defineGetterSetter(d,"batchNode",d.getBatchNode,d.setBatchNode),d.drawMode,l.defineGetterSetter(d,"drawMode",d.getDrawMode,d.setDrawMode),d.shapeType,l.defineGetterSetter(d,"shapeType",d.getShapeType,d.setShapeType),d.active,l.defineGetterSetter(d,"active",d.isActive),d.sourcePos,l.defineGetterSetter(d,"sourcePos",d.getSourcePosition,d.setSourcePosition),d.posVar,l.defineGetterSetter(d,"posVar",d.getPosVar,d.setPosVar),d.gravity,l.defineGetterSetter(d,"gravity",d.getGravity,d.setGravity),d.speed,l.defineGetterSetter(d,"speed",d.getSpeed,d.setSpeed),d.speedVar,l.defineGetterSetter(d,"speedVar",d.getSpeedVar,d.setSpeedVar),d.tangentialAccel,l.defineGetterSetter(d,"tangentialAccel",d.getTangentialAccel,d.setTangentialAccel),d.tangentialAccelVar,l.defineGetterSetter(d,"tangentialAccelVar",d.getTangentialAccelVar,d.setTangentialAccelVar),d.radialAccel,l.defineGetterSetter(d,"radialAccel",d.getRadialAccel,d.setRadialAccel),d.radialAccelVar,l.defineGetterSetter(d,"radialAccelVar",d.getRadialAccelVar,d.setRadialAccelVar),d.rotationIsDir,l.defineGetterSetter(d,"rotationIsDir",d.getRotationIsDir,d.setRotationIsDir),d.startRadius,l.defineGetterSetter(d,"startRadius",d.getStartRadius,d.setStartRadius),d.startRadiusVar,l.defineGetterSetter(d,"startRadiusVar",d.getStartRadiusVar,d.setStartRadiusVar),d.endRadius,l.defineGetterSetter(d,"endRadius",d.getEndRadius,d.setEndRadius),d.endRadiusVar,l.defineGetterSetter(d,"endRadiusVar",d.getEndRadiusVar,d.setEndRadiusVar),d.rotatePerS,l.defineGetterSetter(d,"rotatePerS",d.getRotatePerSecond,d.setRotatePerSecond),d.rotatePerSVar,l.defineGetterSetter(d,"rotatePerSVar",d.getRotatePerSecondVar,d.setRotatePerSecondVar),d.startColor,l.defineGetterSetter(d,"startColor",d.getStartColor,d.setStartColor),d.startColorVar,l.defineGetterSetter(d,"startColorVar",d.getStartColorVar,d.setStartColorVar),d.endColor,l.defineGetterSetter(d,"endColor",d.getEndColor,d.setEndColor),d.endColorVar,l.defineGetterSetter(d,"endColorVar",d.getEndColorVar,d.setEndColorVar),d.totalParticles,l.defineGetterSetter(d,"totalParticles",d.getTotalParticles,d.setTotalParticles),d.texture,l.defineGetterSetter(d,"texture",d.getTexture,d.setTexture),l.ParticleSystem.create=function(e){return new l.ParticleSystem(e)},l.ParticleSystem.createWithTotalParticles=l.ParticleSystem.create,l.ParticleSystem.ModeA=function(e,t,i,n,s,r,a,o){this.gravity=e||l.p(0,0),this.speed=t||0,this.speedVar=i||0,this.tangentialAccel=n||0,this.tangentialAccelVar=s||0,this.radialAccel=r||0,this.radialAccelVar=a||0,this.rotationIsDir=o||!1},l.ParticleSystem.ModeB=function(e,t,i,n,s,r){this.startRadius=e||0,this.startRadiusVar=t||0,this.endRadius=i||0,this.endRadiusVar=n||0,this.rotatePerSecond=s||0,this.rotatePerSecondVar=r||0},l.ParticleSystem.SHAPE_MODE=0,l.ParticleSystem.TEXTURE_MODE=1,l.ParticleSystem.STAR_SHAPE=0,l.ParticleSystem.BALL_SHAPE=1,l.ParticleSystem.DURATION_INFINITY=-1,l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE=-1,l.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS=-1,l.ParticleSystem.MODE_GRAVITY=0,l.ParticleSystem.MODE_RADIUS=1,l.ParticleSystem.TYPE_FREE=0,l.ParticleSystem.TYPE_RELATIVE=1,l.ParticleSystem.TYPE_GROUPED=2,function(){l.ParticleSystem.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._drawMode=l.ParticleSystem.TEXTURE_MODE,this._shapeType=l.ParticleSystem.BALL_SHAPE,this._pointRect=l.rect(0,0,0,0),this._tintCache=null};var e=l.ParticleSystem.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.ParticleSystem.CanvasRenderCmd,e.getDrawMode=function(){return this._drawMode},e.setDrawMode=function(e){this._drawMode=e},e.getShapeType=function(){return this._shapeType},e.setShapeType=function(e){this._shapeType=e},e.setBatchNode=function(e){this._batchNode!==e&&(this._node._batchNode=e)},e.updateQuadWithParticle=function(e,t){},e.updateParticlePosition=function(e,t){l.pIn(e.drawPos,t)},e.rendering=function(e,t,i){var n=e||l._renderContext,s=n.getContext(),r=this._node,a=this._pointRect;n.setTransform(this._worldTransform,t,i),n.save(),r.isBlendAdditive()?s.globalCompositeOperation="lighter":s.globalCompositeOperation="source-over";var o,h,d,c,u=this._node.particleCount,p=this._node._particles;if(r.drawMode!==l.ParticleSystem.SHAPE_MODE&&r._texture){if(!r._texture._textureLoaded)return void n.restore();var m=r._texture.getHtmlElementObj();if(!m.width||!m.height)return void n.restore();var _=m;for(o=0;o<u;o++)if(h=p[o],d=0|.5*h.size,0!==(c=h.color.a/255)){s.globalAlpha=c,s.save(),s.translate(0|h.drawPos.x,-(0|h.drawPos.y));var g=4*Math.floor(h.size/4),T=a.width,f=a.height;s.scale(Math.max(1/T*g,1e-6),Math.max(1/f*g,1e-6)),h.rotation&&s.rotate(l.degreesToRadians(h.rotation)),_=h.isChangeColor?this._changeTextureColor(r._texture,h.color,this._pointRect):m,s.drawImage(_,-(0|T/2),-(0|f/2)),s.restore()}}else{var S=l._drawingUtil;for(o=0;o<u;o++)d=0|.5*(h=p[o]).size,0!==(c=h.color.a/255)&&(s.globalAlpha=c,s.save(),s.translate(0|h.drawPos.x,-(0|h.drawPos.y)),r.shapeType===l.ParticleSystem.STAR_SHAPE?(h.rotation&&s.rotate(l.degreesToRadians(h.rotation)),S.drawStar(n,d,h.color)):S.drawColorBall(n,d,h.color),s.restore())}n.restore(),l.g_NumberOfDraws++},e._changeTextureColor=function(e,t,i){this._tintCache||(this._tintCache=document.createElement("canvas"));var n=this._tintCache,s=e.getContentSize();return n.width=s.width,n.height=s.height,e._generateColorTexture(t.r,t.g,t.b,i,n)},e.initTexCoordsWithRect=function(e){this._pointRect=e},e.setTotalParticles=function(e){this._node._totalParticles=e<200?e:200},e.addParticle=function(){var e,t=this._node,i=t._particles;return t.particleCount<i.length?e=i[t.particleCount]:(e=new l.Particle,i.push(e)),e},e._setupVBO=function(){},e._allocMemory=function(){return!0},e.postStep=function(){},e._setBlendAdditive=function(){var e=this._node._blendFunc;e.src=l.BLEND_SRC,e.dst=l.BLEND_DST},e._initWithTotalParticles=function(e){},e._updateDeltaColor=function(e,t){this._node._dontTint||(e.color.r+=e.deltaColor.r*t,e.color.g+=e.deltaColor.g*t,e.color.b+=e.deltaColor.b*t,e.color.a+=e.deltaColor.a*t,e.isChangeColor=!0)}}(),function(){l.ParticleSystem.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._matrix=null,this._buffersVBO=[0,0],this._quads=[],this._indices=[],this._quadsArrayBuffer=null};var e=l.ParticleSystem.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.ParticleSystem.WebGLRenderCmd,e.getDrawMode=function(){},e.setDrawMode=function(e){},e.getShapeType=function(){},e.setShapeType=function(e){},e.setBatchNode=function(e){var t=this._node;if(t._batchNode!==e){var i=t._batchNode;if(t._batchNode=e,e)for(var n=t._particles,s=0;s<t._totalParticles;s++)n[s].atlasIndex=s;e?i||(t._batchNode.textureAtlas._copyQuadsToTextureAtlas(this._quads,t.atlasIndex),l._renderContext.deleteBuffer(this._buffersVBO[1])):(this._allocMemory(),this.initIndices(t._totalParticles),t.setTexture(i.getTexture()),this._setupVBO())}},e.initIndices=function(e){for(var t=this._indices,i=0,n=e;i<n;++i){var s=6*i,r=4*i;t[s+0]=r+0,t[s+1]=r+1,t[s+2]=r+2,t[s+5]=r+1,t[s+4]=r+2,t[s+3]=r+3}},e.isDifferentTexture=function(e,t){return e===t},e.updateParticlePosition=function(e,t){this.updateQuadWithParticle(e,t)},e.updateQuadWithParticle=function(e,t){var i=null,n=this._node;n._batchNode?(i=n._batchNode.textureAtlas.quads[n.atlasIndex+e.atlasIndex],n._batchNode.textureAtlas.dirty=!0):i=this._quads[n._particleIdx];var s,r,a,o;n._opacityModifyRGB?(s=0|e.color.r*e.color.a/255,r=0|e.color.g*e.color.a/255,a=0|e.color.b*e.color.a/255):(s=0|e.color.r,r=0|e.color.g,a=0|e.color.b),o=0|e.color.a;var h=i.bl.colors,d=i.br.colors,c=i.tl.colors,u=i.tr.colors;h.r=d.r=c.r=u.r=s,h.g=d.g=c.g=u.g=r,h.b=d.b=c.b=u.b=a,h.a=d.a=c.a=u.a=o;var p=e.size/2;if(e.rotation){var m=-p,_=-p,g=p,T=p,f=t.x,S=t.y,w=-l.degreesToRadians(e.rotation),v=Math.cos(w),L=Math.sin(w),M=m*v-_*L+f,C=m*L+_*v+S,y=g*v-_*L+f,B=g*L+_*v+S,F=g*v-T*L+f,E=g*L+T*v+S,P=m*v-T*L+f,b=m*L+T*v+S;i.bl.vertices.x=M,i.bl.vertices.y=C,i.br.vertices.x=y,i.br.vertices.y=B,i.tl.vertices.x=P,i.tl.vertices.y=b,i.tr.vertices.x=F,i.tr.vertices.y=E}else i.bl.vertices.x=t.x-p,i.bl.vertices.y=t.y-p,i.br.vertices.x=t.x+p,i.br.vertices.y=t.y-p,i.tl.vertices.x=t.x-p,i.tl.vertices.y=t.y+p,i.tr.vertices.x=t.x+p,i.tr.vertices.y=t.y+p},e.rendering=function(e){var t=this._node;if(t._texture){var i=e||l._renderContext;this._matrix||(this._matrix=new l.math.Matrix4,this._matrix.identity());var n=this._worldTransform;this._matrix.mat[0]=n.a,this._matrix.mat[4]=n.c,this._matrix.mat[12]=n.tx,this._matrix.mat[1]=n.b,this._matrix.mat[5]=n.d,this._matrix.mat[13]=n.ty,this._glProgramState.apply(this._matrix),l.glBindTexture2D(t._texture),l.glBlendFuncForParticle(t._blendFunc.src,t._blendFunc.dst),i.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),i.enableVertexAttribArray(l.VERTEX_ATTRIB_COLOR),i.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),i.bindBuffer(i.ARRAY_BUFFER,this._buffersVBO[0]),i.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,24,0),i.vertexAttribPointer(l.VERTEX_ATTRIB_COLOR,4,i.UNSIGNED_BYTE,!0,24,12),i.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,24,16),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),i.drawElements(i.TRIANGLES,6*t._particleIdx,i.UNSIGNED_SHORT,0)}},e.initTexCoordsWithRect=function(e){var t=this._node,i=t.texture,n=l.contentScaleFactor(),s=l.rect(e.x*n,e.y*n,e.width*n,e.height*n),r=e.width,a=e.height;i&&(r=i.pixelsWidth,a=i.pixelsHeight);var o,h,d,c;l.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(o=(2*s.x+1)/(2*r),h=(2*s.y+1)/(2*a),d=o+(2*s.width-2)/(2*r),c=h+(2*s.height-2)/(2*a)):(o=s.x/r,h=s.y/a,d=o+s.width/r,c=h+s.height/a);var u=c;c=h,h=u;var p,m=0,_=0;t._batchNode?(p=t._batchNode.textureAtlas.quads,m=t.atlasIndex,_=t.atlasIndex+t._totalParticles):(p=this._quads,m=0,_=t._totalParticles);for(var g=m;g<_;g++){p[g]||(p[g]=l.V3F_C4B_T2F_QuadZero());var T=p[g];T.bl.texCoords.u=o,T.bl.texCoords.v=h,T.br.texCoords.u=d,T.br.texCoords.v=h,T.tl.texCoords.u=o,T.tl.texCoords.v=c,T.tr.texCoords.u=d,T.tr.texCoords.v=c}},e.setTotalParticles=function(e){var t=this._node;if(e>t._allocatedParticles){var i=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._indices=new Uint16Array(6*e);var n=new ArrayBuffer(e*i),s=t._particles;s.length=0;var r=this._quads;r.length=0;for(var a=0;a<e;a++)s[a]=new l.Particle,r[a]=new l.V3F_C4B_T2F_Quad(null,null,null,null,n,a*i);if(t._allocatedParticles=e,t._totalParticles=e,t._batchNode)for(var o=0;o<e;o++)s[o].atlasIndex=o;this._quadsArrayBuffer=n,this.initIndices(e),this._setupVBO(),t._texture&&this.initTexCoordsWithRect(l.rect(0,0,t._texture.width,t._texture.height))}else t._totalParticles=e;t.resetSystem()},e.addParticle=function(){var e=this._node;return e._particles[e.particleCount]},e._setupVBO=function(){var e=l._renderContext;this._buffersVBO[0]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._buffersVBO[0]),e.bufferData(e.ARRAY_BUFFER,this._quadsArrayBuffer,e.DYNAMIC_DRAW),this._buffersVBO[1]=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW)},e._allocMemory=function(){var e=this._node;if(e._batchNode)return l.log("cc.ParticleSystem._allocMemory(): Memory should not be allocated when not using batchNode"),!1;var t=l.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=e._totalParticles,n=this._quads;n.length=0,this._indices=new Uint16Array(6*i);for(var s=new ArrayBuffer(t*i),r=0;r<i;r++)n[r]=new l.V3F_C4B_T2F_Quad(null,null,null,null,s,r*t);return n&&this._indices?(this._quadsArrayBuffer=s,!0):(l.log("cocos2d: Particle system: not enough memory"),!1)},e.postStep=function(){var e=l._renderContext;e.bindBuffer(e.ARRAY_BUFFER,this._buffersVBO[0]),e.bufferSubData(e.ARRAY_BUFFER,0,this._quadsArrayBuffer)},e._setBlendAdditive=function(){var e=this._node._blendFunc;this._texture&&!this._texture.hasPremultipliedAlpha()?(e.src=l.SRC_ALPHA,e.dst=l.ONE_MINUS_SRC_ALPHA):(e.src=l.BLEND_SRC,e.dst=l.BLEND_DST)},e._initWithTotalParticles=function(e){if(!this._allocMemory())return!1;this.initIndices(e),this._setupVBO(),this._shaderProgram=l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR)},e._updateDeltaColor=function(e,t){e.color.r+=e.deltaColor.r*t,e.color.g+=e.deltaColor.g*t,e.color.b+=e.deltaColor.b*t,e.color.a+=e.deltaColor.a*t,e.isChangeColor=!0}}(),l.ParticleFire=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?300:150)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(60),this.setSpeedVar(20),this.setAngle(90),this.setAngleVar(10);var t=l.director.getWinSize();return this.setPosition(t.width/2,60),this.setPosVar(l.p(40,20)),this.setLife(3),this.setLifeVar(.25),this.setStartSize(54),this.setStartSizeVar(10),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(l.color(194,64,31,255)),this.setStartColorVar(l.color(0,0,0,0)),this.setEndColor(l.color(0,0,0,255)),this.setEndColorVar(l.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),l.ParticleFire.create=function(){return new l.ParticleFire},l.ParticleFireworks=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?1500:150)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,-90)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(180),this.setSpeedVar(50);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setAngle(90),this.setAngleVar(20),this.setLife(3.5),this.setLifeVar(1),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(l.color(128,128,128,255)),this.setStartColorVar(l.color(128,128,128,255)),this.setEndColor(l.color(26,26,26,51)),this.setEndColorVar(l.color(26,26,26,51)),this.setStartSize(8),this.setStartSizeVar(2),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setBlendAdditive(!1),!0}return!1}}),l.ParticleFireworks.create=function(){return new l.ParticleFireworks},l.ParticleSun=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?350:150)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setBlendAdditive(!0),this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(20),this.setSpeedVar(5),this.setAngle(90),this.setAngleVar(360);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(l.p(0,0)),this.setLife(1),this.setLifeVar(.5),this.setStartSize(30),this.setStartSizeVar(10),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(l.color(194,64,31,255)),this.setStartColorVar(l.color(0,0,0,0)),this.setEndColor(l.color(0,0,0,255)),this.setEndColorVar(l.color(0,0,0,0)),!0}return!1}}),l.ParticleSun.create=function(){return new l.ParticleSun},l.ParticleGalaxy=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?200:100)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,0)),this.setSpeed(60),this.setSpeedVar(10),this.setRadialAccel(-80),this.setRadialAccelVar(0),this.setTangentialAccel(80),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(l.p(0,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(37),this.setStartSizeVar(10),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(l.color(31,64,194,255)),this.setStartColorVar(l.color(0,0,0,0)),this.setEndColor(l.color(0,0,0,255)),this.setEndColorVar(l.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),l.ParticleGalaxy.create=function(){return new l.ParticleGalaxy},l.ParticleFlower=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?250:100)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,0)),this.setSpeed(80),this.setSpeedVar(10),this.setRadialAccel(-60),this.setRadialAccelVar(0),this.setTangentialAccel(15),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(l.p(0,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(30),this.setStartSizeVar(10),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(l.color(128,128,128,255)),this.setStartColorVar(l.color(128,128,128,128)),this.setEndColor(l.color(0,0,0,255)),this.setEndColorVar(l.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),l.ParticleFlower.create=function(){return new l.ParticleFlower},l.ParticleMeteor=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?150:100)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(-200,200)),this.setSpeed(15),this.setSpeedVar(5),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setTangentialAccel(0),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(l.p(0,0)),this.setLife(2),this.setLifeVar(1),this.setStartSize(60),this.setStartSizeVar(10),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(l.color(51,102,179)),this.setStartColorVar(l.color(0,0,51,26)),this.setEndColor(l.color(0,0,0,255)),this.setEndColorVar(l.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),l.ParticleMeteor.create=function(){return new l.ParticleMeteor},l.ParticleSpiral=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?500:100)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,0)),this.setSpeed(150),this.setSpeedVar(0),this.setRadialAccel(-380),this.setRadialAccelVar(0),this.setTangentialAccel(45),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(0);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(l.p(0,0)),this.setLife(12),this.setLifeVar(0),this.setStartSize(20),this.setStartSizeVar(0),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(l.color(128,128,128,255)),this.setStartColorVar(l.color(128,128,128,0)),this.setEndColor(l.color(128,128,128,255)),this.setEndColorVar(l.color(128,128,128,0)),this.setBlendAdditive(!1),!0}return!1}}),l.ParticleSpiral.create=function(){return new l.ParticleSpiral},l.ParticleExplosion=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?700:300)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(.1),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,0)),this.setSpeed(70),this.setSpeedVar(40),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setTangentialAccel(0),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height/2),this.setPosVar(l.p(0,0)),this.setLife(5),this.setLifeVar(2),this.setStartSize(15),this.setStartSizeVar(10),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getDuration()),this.setStartColor(l.color(179,26,51,255)),this.setStartColorVar(l.color(128,128,128,0)),this.setEndColor(l.color(128,128,128,0)),this.setEndColorVar(l.color(128,128,128,0)),this.setBlendAdditive(!1),!0}return!1}}),l.ParticleExplosion.create=function(){return new l.ParticleExplosion},l.ParticleSmoke=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?200:100)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(25),this.setSpeedVar(10),this.setAngle(90),this.setAngleVar(5);var t=l.director.getWinSize();return this.setPosition(t.width/2,0),this.setPosVar(l.p(20,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(60),this.setStartSizeVar(10),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(l.color(204,204,204,255)),this.setStartColorVar(l.color(5,5,5,0)),this.setEndColor(l.color(0,0,0,255)),this.setEndColorVar(l.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),l.ParticleSmoke.create=function(){return new l.ParticleSmoke},l.ParticleSnow=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?700:250)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(0,-1)),this.setSpeed(5),this.setSpeedVar(1),this.setRadialAccel(0),this.setRadialAccelVar(1),this.setTangentialAccel(0),this.setTangentialAccelVar(1);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height+10),this.setPosVar(l.p(t.width/2,0)),this.setAngle(-90),this.setAngleVar(5),this.setLife(45),this.setLifeVar(15),this.setStartSize(10),this.setStartSizeVar(5),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(10),this.setStartColor(l.color(255,255,255,255)),this.setStartColorVar(l.color(0,0,0,0)),this.setEndColor(l.color(255,255,255,0)),this.setEndColorVar(l.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),l.ParticleSnow.create=function(){return new l.ParticleSnow},l.ParticleRain=l.ParticleSystem.extend({ctor:function(){l.ParticleSystem.prototype.ctor.call(this,l._renderType===l.game.RENDER_TYPE_WEBGL?1e3:300)},initWithTotalParticles:function(e){if(l.ParticleSystem.prototype.initWithTotalParticles.call(this,e)){this.setDuration(l.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(l.ParticleSystem.MODE_GRAVITY),this.setGravity(l.p(10,-10)),this.setRadialAccel(0),this.setRadialAccelVar(1),this.setTangentialAccel(0),this.setTangentialAccelVar(1),this.setSpeed(130),this.setSpeedVar(30),this.setAngle(-90),this.setAngleVar(5);var t=l.director.getWinSize();return this.setPosition(t.width/2,t.height),this.setPosVar(l.p(t.width/2,0)),this.setLife(4.5),this.setLifeVar(0),this.setStartSize(4),this.setStartSizeVar(2),this.setEndSize(l.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(20),this.setStartColor(l.color(179,204,255,255)),this.setStartColorVar(l.color(0,0,0,0)),this.setEndColor(l.color(179,204,255,128)),this.setEndColorVar(l.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),l.ParticleRain.create=function(){return new l.ParticleRain},l.PARTICLE_DEFAULT_CAPACITY=500,l.ParticleBatchNode=l.Node.extend({textureAtlas:null,_blendFunc:null,_className:"ParticleBatchNode",ctor:function(e,t){l.Node.prototype.ctor.call(this),this._blendFunc={src:l.BLEND_SRC,dst:l.BLEND_DST},l.isString(e)?this.init(e,t):e instanceof l.Texture2D&&this.initWithTexture(e,t)},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.ParticleBatchNode.CanvasRenderCmd(this):new l.ParticleBatchNode.WebGLRenderCmd(this)},initWithTexture:function(e,t){return this.textureAtlas=new l.TextureAtlas,this.textureAtlas.initWithTexture(e,t),this._children.length=0,this._renderCmd._initWithTexture(),!0},initWithFile:function(e,t){var i=l.textureCache.addImage(e);return this.initWithTexture(i,t)},init:function(e,t){var i=l.textureCache.addImage(e);return this.initWithTexture(i,t)},visit:function(e){var t=this._renderCmd,i=e?e._renderCmd:null;this._visible?(t.visit(i),l.renderer.pushRenderCommand(t),t._dirtyFlag=0):t._propagateFlagsDown(i)},addChild:function(e,t,i){if(!e)throw new Error("cc.ParticleBatchNode.addChild() : child should be non-null");if(!(e instanceof l.ParticleSystem))throw new Error("cc.ParticleBatchNode.addChild() : only supports cc.ParticleSystem as children");if(t=null==t?e.zIndex:t,i=null==i?e.tag:i,e.getTexture()!==this.textureAtlas.texture)throw new Error("cc.ParticleSystem.addChild() : the child is not using the same texture id");var n=e.getBlendFunc();if(0===this._children.length)this.setBlendFunc(n);else if(n.src!==this._blendFunc.src||n.dst!==this._blendFunc.dst)return void l.log("cc.ParticleSystem.addChild() : Can't add a ParticleSystem that uses a different blending function");var s=this._addChildHelper(e,t,i),r=0;if(0!==s){var a=this._children[s-1];r=a.getAtlasIndex()+a.getTotalParticles()}else r=0;this.insertChild(e,r),e.setBatchNode(this)},insertChild:function(e,t){var i=e.getTotalParticles(),n=this.textureAtlas,s=n.totalQuads;e.setAtlasIndex(t),s+i>n.getCapacity()&&(this._increaseAtlasCapacityTo(s+i),n.fillWithEmptyQuadsFromIndex(n.getCapacity()-i,i)),e.getAtlasIndex()+i!==s&&n.moveQuadsFromIndex(t,t+i),n.increaseTotalQuadsWith(i),this._updateAllAtlasIndexes()},removeChild:function(e,t){if(null!=e){if(!(e instanceof l.ParticleSystem))throw new Error("cc.ParticleBatchNode.removeChild(): only supports cc.ParticleSystem as children");if(-1!==this._children.indexOf(e)){l.Node.prototype.removeChild.call(this,e,t);var i=this.textureAtlas;i.removeQuadsAtIndex(e.getAtlasIndex(),e.getTotalParticles()),i.fillWithEmptyQuadsFromIndex(i.totalQuads,e.getTotalParticles()),e.setBatchNode(null),this._updateAllAtlasIndexes()}else l.log("cc.ParticleBatchNode.removeChild(): doesn't contain the sprite. Can't remove it")}},reorderChild:function(e,t){if(!e)throw new Error("cc.ParticleBatchNode.reorderChild(): child should be non-null");if(!(e instanceof l.ParticleSystem))throw new Error("cc.ParticleBatchNode.reorderChild(): only supports cc.QuadParticleSystems as children");if(-1!==this._children.indexOf(e)){if(t!==e.zIndex){if(this._children.length>1){var i=this._getCurrentIndex(e,t);if(i.oldIndex!==i.newIndex){this._children.splice(i.oldIndex,1),this._children.splice(i.newIndex,0,e);var n=e.getAtlasIndex();this._updateAllAtlasIndexes();for(var s=0,r=this._children,a=0;a<r.length;a++)if(r[a]===e){s=e.getAtlasIndex();break}this.textureAtlas.moveQuadsFromIndex(n,e.getTotalParticles(),s),e.updateWithNoTime()}}e._setLocalZOrder(t)}}else l.log("cc.ParticleBatchNode.reorderChild(): Child doesn't belong to batch")},removeChildAtIndex:function(e,t){this.removeChild(this._children[i],t)},removeAllChildren:function(e){for(var t=this._children,i=0;i<t.length;i++)t[i].setBatchNode(null);l.Node.prototype.removeAllChildren.call(this,e),this.textureAtlas.removeAllQuads()},disableParticle:function(e){var t=this.textureAtlas.quads[e];t.br.vertices.x=t.br.vertices.y=t.tr.vertices.x=t.tr.vertices.y=t.tl.vertices.x=t.tl.vertices.y=t.bl.vertices.x=t.bl.vertices.y=0,this.textureAtlas._setDirty(!0)},getTexture:function(){return this.textureAtlas.texture},setTexture:function(e){this.textureAtlas.texture=e;var t=this._blendFunc;e&&!e.hasPremultipliedAlpha()&&t.src===l.BLEND_SRC&&t.dst===l.BLEND_DST&&(t.src=l.SRC_ALPHA,t.dst=l.ONE_MINUS_SRC_ALPHA)},setBlendFunc:function(e,t){void 0===t?(this._blendFunc.src=e.src,this._blendFunc.dst=e.dst):(this._blendFunc.src=e,this._blendFunc.src=t)},getBlendFunc:function(){return new l.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},_updateAllAtlasIndexes:function(){for(var e=0,t=this._children,i=0;i<t.length;i++){var n=t[i];n.setAtlasIndex(e),e+=n.getTotalParticles()}},_increaseAtlasCapacityTo:function(e){l.log("cocos2d: cc.ParticleBatchNode: resizing TextureAtlas capacity from ["+this.textureAtlas.getCapacity()+"] to ["+e+"]."),this.textureAtlas.resizeCapacity(e)||l.log("cc.ParticleBatchNode._increaseAtlasCapacityTo() : WARNING: Not enough memory to resize the atlas")},_searchNewPositionInChildrenForZ:function(e){for(var t=this._children,i=t.length,n=0;n<i;n++)if(t[n].zIndex>e)return n;return i},_getCurrentIndex:function(e,t){for(var i=!1,n=!1,s=0,r=0,a=0,o=this._children,h=o.length,l=0;l<h;l++){var d=o[l];if(d.zIndex>t&&!n&&(s=l,n=!0,i&&n))break;if(e===d&&(r=l,i=!0,n||(a=-1),i&&n))break}return n||(s=h),s+=a,{newIndex:s,oldIndex:r}},_addChildHelper:function(e,t,i){if(!e)throw new Error("cc.ParticleBatchNode._addChildHelper(): child should be non-null");if(e.parent)return l.log("cc.ParticleBatchNode._addChildHelper(): child already added. It can't be added again"),null;this._children||(this._children=[]);var n=this._searchNewPositionInChildrenForZ(t);return this._children.splice(n,0,e),e.tag=i,e._setLocalZOrder(t),e.parent=this,this._running&&(e._performRecursive(l.Node._stateCallbackType.onEnter),e._performRecursive(l.Node._stateCallbackType.onEnterTransitionDidFinish)),n},_updateBlendFunc:function(){this.textureAtlas.texture.hasPremultipliedAlpha()||(this._blendFunc.src=l.SRC_ALPHA,this._blendFunc.dst=l.ONE_MINUS_SRC_ALPHA)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(e){this.textureAtlas=e}});var d=l.ParticleBatchNode.prototype;d.texture,l.defineGetterSetter(d,"texture",d.getTexture,d.setTexture),l.ParticleBatchNode.create=function(e,t){return new l.ParticleBatchNode(e,t)},function(){l.ParticleBatchNode.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!1};var e=l.ParticleBatchNode.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.ParticleBatchNode.CanvasRenderCmd,e._initWithTexture=function(){}}(),function(){l.ParticleBatchNode.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._matrix=new l.math.Matrix4,this._matrix.identity()};var e=l.ParticleBatchNode.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.ParticleBatchNode.WebGLRenderCmd,e.rendering=function(e){var t=this._node;if(0!==t.textureAtlas.totalQuads){var i=this._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._glProgramState.apply(this._matrix),l.glBlendFuncForParticle(t._blendFunc.src,t._blendFunc.dst),t.textureAtlas.drawQuads()}},e._initWithTexture=function(){this._shaderProgram=l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR)}}(),l.ProgressTimer=l.Node.extend({_type:null,_percentage:0,_sprite:null,_midPoint:null,_barChangeRate:null,_reverseDirection:!1,_className:"ProgressTimer",ctor:function(e){l.Node.prototype.ctor.call(this),this._type=l.ProgressTimer.TYPE_RADIAL,this._percentage=0,this._midPoint=l.p(0,0),this._barChangeRate=l.p(0,0),this._reverseDirection=!1,this._sprite=null,e&&this.initWithSprite(e)},onEnter:function(){this._super(),l._renderType===l.game.RENDER_TYPE_WEBGL&&(this._renderCmd.initCmd(),this._renderCmd._updateProgress())},cleanup:function(){l._renderType===l.game.RENDER_TYPE_WEBGL&&this._renderCmd.releaseData(),this._super()},getMidpoint:function(){return l.p(this._midPoint.x,this._midPoint.y)},setMidpoint:function(e){this._midPoint=l.pClamp(e,l.p(0,0),l.p(1,1))},getBarChangeRate:function(){return l.p(this._barChangeRate.x,this._barChangeRate.y)},setBarChangeRate:function(e){this._barChangeRate=l.pClamp(e,l.p(0,0),l.p(1,1))},getType:function(){return this._type},getPercentage:function(){return this._percentage},getSprite:function(){return this._sprite},setPercentage:function(e){this._percentage!==e&&(this._percentage=l.clampf(e,0,100),this._renderCmd._updateProgress())},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},isReverseDirection:function(){return this._reverseDirection},setColor:function(e){this._sprite.color=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.colorDirty)},setOpacity:function(e){this._sprite.opacity=e,this._renderCmd.setDirtyFlag(l.Node._dirtyFlags.opacityDirty)},getColor:function(){return this._sprite.color},getOpacity:function(){return this._sprite.opacity},setReverseProgress:function(e){this._reverseDirection!==e&&(this._reverseDirection=e,this._renderCmd.resetVertexData())},setSprite:function(e){this._sprite!==e&&(this._sprite=e,e?(this.setContentSize(e.width,e.height),e.ignoreAnchorPointForPosition(!0)):this.setContentSize(0,0),this._renderCmd.resetVertexData())},setType:function(e){e!==this._type&&(this._type=e,this._renderCmd.resetVertexData())},setReverseDirection:function(e){this._reverseDirection!==e&&(this._reverseDirection=e,this._renderCmd.resetVertexData())},initWithSprite:function(e){return this.percentage=0,this.setAnchorPoint(.5,.5),this._type=l.ProgressTimer.TYPE_RADIAL,this._reverseDirection=!1,this.midPoint=l.p(.5,.5),this.barChangeRate=l.p(1,1),this.setSprite(e),this._renderCmd.resetVertexData(),!0},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.ProgressTimer.CanvasRenderCmd(this):new l.ProgressTimer.WebGLRenderCmd(this)}});var d=l.ProgressTimer.prototype;d.midPoint,l.defineGetterSetter(d,"midPoint",d.getMidpoint,d.setMidpoint),d.barChangeRate,l.defineGetterSetter(d,"barChangeRate",d.getBarChangeRate,d.setBarChangeRate),d.type,l.defineGetterSetter(d,"type",d.getType,d.setType),d.percentage,l.defineGetterSetter(d,"percentage",d.getPercentage,d.setPercentage),d.sprite,l.defineGetterSetter(d,"sprite",d.getSprite,d.setSprite),d.reverseDir,l.defineGetterSetter(d,"reverseDir",d.isReverseDirection,d.setReverseDirection),l.ProgressTimer.create=function(e){return new l.ProgressTimer(e)},l.ProgressTimer.TEXTURE_COORDS_COUNT=4,l.ProgressTimer.TEXTURE_COORDS=75,l.ProgressTimer.TYPE_RADIAL=0,l.ProgressTimer.TYPE_BAR=1,l.ProgressTo=l.ActionInterval.extend({_to:0,_from:0,ctor:function(e,t){l.ActionInterval.prototype.ctor.call(this),this._to=0,this._from=0,void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=t,!0)},clone:function(){var e=new l.ProgressTo;return e.initWithDuration(this._duration,this._to),e},reverse:function(){return l.log("cc.ProgressTo.reverse(): reverse hasn't been supported."),null},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),this._from=e.percentage},update:function(e){this.target instanceof l.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*e)}}),l.progressTo=function(e,t){return new l.ProgressTo(e,t)},l.ProgressTo.create=l.progressTo,l.ProgressFromTo=l.ActionInterval.extend({_to:0,_from:0,ctor:function(e,t,i){l.ActionInterval.prototype.ctor.call(this),this._to=0,this._from=0,void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=i,this._from=t,!0)},clone:function(){var e=new l.ProgressFromTo;return e.initWithDuration(this._duration,this._from,this._to),e},reverse:function(){return l.progressFromTo(this._duration,this._to,this._from)},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e)},update:function(e){this.target instanceof l.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*e)}}),l.progressFromTo=function(e,t,i){return new l.ProgressFromTo(e,t,i)},l.ProgressFromTo.create=l.progressFromTo,function(){l.ProgressTimer.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._PI180=Math.PI/180,this._barRect=l.rect(0,0,0,0),this._origin=l.p(0,0),this._radius=0,this._startAngle=270,this._endAngle=270,this._counterClockWise=!1,this._canUseDirtyRegion=!0};var e=l.ProgressTimer.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.ProgressTimer.CanvasRenderCmd,e.rendering=function(e,t,i){var n=e||l._renderContext,s=n.getContext(),r=this._node,a=r._sprite,o=a._renderCmd._textureCoord,h=a._renderCmd._displayedOpacity/255;if(0!==o.width&&0!==o.height&&a._texture&&o.validRect&&0!==h){n.setTransform(this._worldTransform,t,i),n.setCompositeOperation(a._blendFuncStr),n.setGlobalAlpha(h);var d=a._rect,c=a._offsetPosition,u=c.x,p=-c.y-d.height,m=d.width,_=d.height;if(n.save(),a._flippedX&&(u=-u-m,s.scale(-1,1)),a._flippedY&&(p=c.y,s.scale(1,-1)),r._type===l.ProgressTimer.TYPE_BAR){var g=this._barRect;s.beginPath(),s.rect(g.x,g.y,g.width,g.height),s.clip(),s.closePath()}else if(r._type===l.ProgressTimer.TYPE_RADIAL){var T=this._origin.x,f=this._origin.y;s.beginPath(),s.arc(T,f,this._radius,this._PI180*this._startAngle,this._PI180*this._endAngle,this._counterClockWise),s.lineTo(T,f),s.clip(),s.closePath()}var S=(a._renderCmd._textureToRender||a._texture).getHtmlElementObj();a._renderCmd._colorized?s.drawImage(S,0,0,o.width,o.height,u,p,m,_):s.drawImage(S,o.renderX,o.renderY,o.width,o.height,u,p,m,_),n.restore(),l.g_NumberOfDraws++}},e.releaseData=function(){},e.resetVertexData=function(){},e._updateProgress=function(){this.setDirtyFlag(l.Node._dirtyFlags.contentDirty);var e=this._node,t=e._sprite,i=t.width,n=t.height,s=e._midPoint;if(e._type===l.ProgressTimer.TYPE_RADIAL){this._radius=Math.round(Math.sqrt(i*i+n*n));var r,a,o=!1,h=this._origin;h.x=i*s.x,h.y=-n*s.y,e._reverseDirection?(a=270,r=270-3.6*e._percentage):(r=-90,a=3.6*e._percentage-90),t._flippedX&&(h.x-=i*(2*e._midPoint.x),r=-r,a=-a,r-=180,a-=180,o=!o),t._flippedY&&(h.y+=n*(2*e._midPoint.y),o=!o,r=-r,a=-a),this._startAngle=r,this._endAngle=a,this._counterClockWise=o}else{var d=e._barChangeRate,c=e._percentage/100,u=this._barRect,p=l.size(i*(1-d.x),n*(1-d.y)),m=l.size((i-p.width)*c,(n-p.height)*c),_=l.size(p.width+m.width,p.height+m.height),g=l.p(i*s.x,n*s.y),T=g.x-_.width/2;s.x>.5&&_.width/2>=i-g.x&&(T=i-_.width);var f=g.y-_.height/2;s.y>.5&&_.height/2>=n-g.y&&(f=n-_.height),u.x=0;var S=1;t._flippedX&&(u.x-=_.width,S=-1),T>0&&(u.x+=T*S),u.y=0;var w=1;t._flippedY&&(u.y+=_.height,w=-1),f>0&&(u.y-=f*w),u.width=_.width,u.height=-_.height}},e._syncStatus=function(e){var t=this._node;if(t._sprite){var i=l.Node._dirtyFlags,n=this._dirtyFlag,s=e?e._node:null;s&&s._cascadeColorEnabled&&e._dirtyFlag&i.colorDirty&&(n|=i.colorDirty),s&&s._cascadeOpacityEnabled&&e._dirtyFlag&i.opacityDirty&&(n|=i.opacityDirty),e&&e._dirtyFlag&i.transformDirty&&(n|=i.transformDirty),this._dirtyFlag=n;var r=t._sprite._renderCmd,a=r._dirtyFlag,o=a&i.colorDirty,h=a&i.opacityDirty;o&&(r._syncDisplayColor(),r._dirtyFlag&=~i.colorDirty,this._dirtyFlag&=~i.colorDirty),h&&(r._syncDisplayOpacity(),r._dirtyFlag&=~i.opacityDirty,this._dirtyFlag&=~i.opacityDirty),(o||h)&&r._updateColor(),n&i.transformDirty&&this.transform(e),n&i.orderDirty&&(this._dirtyFlag&=~i.orderDirty)}},e.updateStatus=function(){var e=this._node;if(e._sprite){var t=l.Node._dirtyFlags,i=this._dirtyFlag,n=e._sprite._renderCmd,s=n._dirtyFlag,r=s&t.colorDirty,a=s&t.opacityDirty;r&&(n._updateDisplayColor(),n._dirtyFlag=n._dirtyFlag&t.colorDirty^n._dirtyFlag,this._dirtyFlag=this._dirtyFlag&t.colorDirty^this._dirtyFlag),a&&(n._updateDisplayOpacity(),n._dirtyFlag=n._dirtyFlag&t.opacityDirty^n._dirtyFlag,this._dirtyFlag=this._dirtyFlag&t.opacityDirty^this._dirtyFlag),(r||a)&&n._updateColor(),i&t.transformDirty&&this.transform(this.getParentRenderCmd(),!0),i&t.contentDirty&&this._notifyRegionStatus&&this._notifyRegionStatus(l.Node.CanvasRenderCmd.RegionStatus.Dirty),this._dirtyFlag=0}}}(),function(){l.ProgressTimer.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._progressDirty=!0,this._bl=l.p(),this._tr=l.p(),this.initCmd()};var e=l.ProgressTimer.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.ProgressTimer.WebGLRenderCmd,e.transform=function(e,t){this.originTransform(e,t);var i=this._node._sprite;i._renderCmd.transform(this,t);var n=i._offsetPosition.x,s=n+i._rect.width,r=i._offsetPosition.y,a=r+i._rect.height,o=this._worldTransform;this._bl.x=n*o.a+r*o.c+o.tx,this._bl.y=n*o.b+r*o.d+o.ty,this._tr.x=s*o.a+a*o.c+o.tx,this._tr.y=s*o.b+a*o.d+o.ty,this._updateProgressData()},e.rendering=function(e){var t=this._node,i=e||l._renderContext;if(0!==this._vertexDataCount&&t._sprite){this._glProgramState.apply(),this._shaderProgram._updateProjectionUniform();var n=t._sprite._blendFunc;l.glBlendFunc(n.src,n.dst),l.glBindTexture2D(t._sprite.texture),i.bindBuffer(i.ARRAY_BUFFER,this._vertexWebGLBuffer),i.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),i.enableVertexAttribArray(l.VERTEX_ATTRIB_COLOR),i.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),this._vertexDataDirty&&(i.bufferSubData(i.ARRAY_BUFFER,0,this._float32View),this._vertexDataDirty=!1);var s=l.V3F_C4B_T2F.BYTES_PER_ELEMENT;i.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,s,0),i.vertexAttribPointer(l.VERTEX_ATTRIB_COLOR,4,i.UNSIGNED_BYTE,!0,s,12),i.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,s,16),t._type===l.ProgressTimer.TYPE_RADIAL?i.drawArrays(i.TRIANGLE_FAN,0,this._vertexDataCount):t._type===l.ProgressTimer.TYPE_BAR&&(t._reverseDirection?(i.drawArrays(i.TRIANGLE_STRIP,0,this._vertexDataCount/2),i.drawArrays(i.TRIANGLE_STRIP,4,this._vertexDataCount/2),l.g_NumberOfDraws++):i.drawArrays(i.TRIANGLE_STRIP,0,this._vertexDataCount)),l.g_NumberOfDraws++}},e._syncStatus=function(e){var t=this._node;if(t._sprite){var i=l.Node._dirtyFlags,n=this._dirtyFlag,s=e?e._node:null;s&&s._cascadeColorEnabled&&e._dirtyFlag&i.colorDirty&&(n|=i.colorDirty),s&&s._cascadeOpacityEnabled&&e._dirtyFlag&i.opacityDirty&&(n|=i.opacityDirty),e&&e._dirtyFlag&i.transformDirty&&(n|=i.transformDirty),this._dirtyFlag=n;var r=t._sprite._renderCmd,a=r._dirtyFlag,o=(n|a)&i.colorDirty,h=(n|a)&i.opacityDirty;o&&(r._syncDisplayColor(),r._dirtyFlag&=~i.colorDirty,this._dirtyFlag&=~i.colorDirty),h&&(r._syncDisplayOpacity(),r._dirtyFlag&=~i.opacityDirty,this._dirtyFlag&=~i.opacityDirty),(o||h)&&this._updateColor(),n&i.transformDirty&&this.transform(e),n&i.textureDirty&&(this._updateProgressData(),this._dirtyFlag&=~i.textureDirty),r._dirtyFlag=0}},e.updateStatus=function(){var e=this._node;if(e._sprite){var t=l.Node._dirtyFlags,i=this._dirtyFlag,n=e._sprite._renderCmd,s=n._dirtyFlag,r=(i|s)&t.colorDirty,a=(i|s)&t.opacityDirty;r&&(n._updateDisplayColor(),n._dirtyFlag=n._dirtyFlag&t.colorDirty^n._dirtyFlag,this._dirtyFlag=this._dirtyFlag&t.colorDirty^this._dirtyFlag),a&&(n._updateDisplayOpacity(),n._dirtyFlag=n._dirtyFlag&t.opacityDirty^n._dirtyFlag,this._dirtyFlag=this._dirtyFlag&t.opacityDirty^this._dirtyFlag),(r||a)&&this._updateColor(),i&t.transformDirty&&this.transform(this.getParentRenderCmd(),!0),i&t.orderDirty&&(this._dirtyFlag=this._dirtyFlag&t.orderDirty^this._dirtyFlag),i&t.textureDirty&&(this._updateProgressData(),this._dirtyFlag=this._dirtyFlag&t.textureDirty^this._dirtyFlag)}},e.releaseData=function(){if(this._vertexData){var e=this._vertexWebGLBuffer;setTimeout(function(){l._renderContext.deleteBuffer(e)},.1),this._vertexWebGLBuffer=null,this._vertexData=null,this._float32View=null,this._vertexArrayBuffer=null,this._vertexDataCount=0}},e.initCmd=function(){if(!this._vertexData){this._vertexWebGLBuffer=l._renderContext.createBuffer();var e=l.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._vertexArrayBuffer=new ArrayBuffer(8*e),this._float32View=new Float32Array(this._vertexArrayBuffer),this._vertexData=[];for(var t=0;t<8;t++)this._vertexData[t]=new l.V3F_C4B_T2F(null,null,null,this._vertexArrayBuffer,t*e);gl.bindBuffer(gl.ARRAY_BUFFER,this._vertexWebGLBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._float32View,gl.DYNAMIC_DRAW),this._vertexDataCount=0,this._vertexDataDirty=!0,this._shaderProgram=l.shaderCache.programForKey(l.SHADER_SPRITE_POSITION_TEXTURECOLOR)}},e.resetVertexData=function(){this._vertexDataCount=0},e._updateProgressData=function(){var e=this._node._type;e===l.ProgressTimer.TYPE_RADIAL?this._updateRadial():e===l.ProgressTimer.TYPE_BAR&&this._updateBar(),this._vertexDataDirty=!0},e._updateProgress=function(){this.setDirtyFlag(l.Node._dirtyFlags.textureDirty)},e._updateBar=function(){var e=this._node;if(e._sprite){var t=e._percentage/100,i=e._barChangeRate,n=l.pMult(l.p(1-i.x+t*i.x,1-i.y+t*i.y),.5),s=l.pSub(e._midPoint,n),r=l.pAdd(e._midPoint,n);s.x<0&&(r.x+=-s.x,s.x=0),r.x>1&&(s.x-=r.x-1,r.x=1),s.y<0&&(r.y+=-s.y,s.y=0),r.y>1&&(s.y-=r.y-1,r.y=1);var a;this._reverseDirection?(a=this._vertexData,this._vertexDataCount||(this._vertexDataCount=8,this._textureCoordFromAlphaPoint(a[0].texCoords,0,1),this._vertexFromAlphaPoint(a[0].vertices,0,1),this._textureCoordFromAlphaPoint(a[1].texCoords,0,0),this._vertexFromAlphaPoint(a[1].vertices,0,0),this._textureCoordFromAlphaPoint(a[6].texCoords,1,1),this._vertexFromAlphaPoint(a[6].vertices,1,1),this._textureCoordFromAlphaPoint(a[7].texCoords,1,0),this._vertexFromAlphaPoint(a[7].vertices,1,0)),this._textureCoordFromAlphaPoint(a[2].texCoords,s.x,r.y),this._vertexFromAlphaPoint(a[2].vertices,s.x,r.y),this._textureCoordFromAlphaPoint(a[3].texCoords,s.x,s.y),this._vertexFromAlphaPoint(a[3].vertices,s.x,s.y),this._textureCoordFromAlphaPoint(a[4].texCoords,r.x,r.y),this._vertexFromAlphaPoint(a[4].vertices,r.x,r.y),this._textureCoordFromAlphaPoint(a[5].texCoords,r.x,s.y),this._vertexFromAlphaPoint(a[5].vertices,r.x,s.y)):(this._vertexDataCount||(this._vertexDataCount=4),a=this._vertexData,this._textureCoordFromAlphaPoint(a[0].texCoords,s.x,r.y),this._vertexFromAlphaPoint(a[0].vertices,s.x,r.y),this._textureCoordFromAlphaPoint(a[1].texCoords,s.x,s.y),this._vertexFromAlphaPoint(a[1].vertices,s.x,s.y),this._textureCoordFromAlphaPoint(a[2].texCoords,r.x,r.y),this._vertexFromAlphaPoint(a[2].vertices,r.x,r.y),this._textureCoordFromAlphaPoint(a[3].texCoords,r.x,s.y),this._vertexFromAlphaPoint(a[3].vertices,r.x,s.y)),this._updateColor()}},e._updateRadial=function(){var e=this._node;if(e._sprite){var t,i,n=e._midPoint,s=e._percentage/100,r=2*l.PI*(e._reverseDirection?s:1-s),a=l.p(n.x,1),o=l.pRotateByAngle(a,n,r),h=0;if(0===s)i=a,h=0;else if(1===s)i=a,h=4;else{var d=l.FLT_MAX,c=l.ProgressTimer.TEXTURE_COORDS_COUNT;for(t=0;t<=c;++t){var u=(t+(c-1))%c,p=this._boundaryTexCoord(t%c),m=this._boundaryTexCoord(u);0===t?m=l.pLerp(p,m,1-n.x):4===t&&(p=l.pLerp(p,m,1-n.x));var _=l.p(0,0);if(l.pLineIntersect(p,m,n,o,_)){if(!(0!==t&&4!==t||0<=_.x&&_.x<=1))continue;_.y>=0&&_.y<d&&(d=_.y,h=t)}}i=l.pAdd(n,l.pMult(l.pSub(o,n),d))}var g=!0;this._vertexDataCount!==h+3&&(g=!1,this._vertexDataCount=h+3),this._updateColor();var T=this._vertexData;if(!g)for(this._textureCoordFromAlphaPoint(T[0].texCoords,n.x,n.y),this._vertexFromAlphaPoint(T[0].vertices,n.x,n.y),this._textureCoordFromAlphaPoint(T[1].texCoords,a.x,a.y),this._vertexFromAlphaPoint(T[1].vertices,a.x,a.y),t=0;t<h;t++){var f=this._boundaryTexCoord(t);this._textureCoordFromAlphaPoint(T[t+2].texCoords,f.x,f.y),this._vertexFromAlphaPoint(T[t+2].vertices,f.x,f.y)}this._textureCoordFromAlphaPoint(T[this._vertexDataCount-1].texCoords,i.x,i.y),this._vertexFromAlphaPoint(T[this._vertexDataCount-1].vertices,i.x,i.y)}},e._boundaryTexCoord=function(e){if(e<l.ProgressTimer.TEXTURE_COORDS_COUNT){var t=l.ProgressTimer.TEXTURE_COORDS;return this._node._reverseDirection?l.p(t>>7-(e<<1)&1,t>>7-(1+(e<<1))&1):l.p(t>>1+(e<<1)&1,t>>(e<<1)&1)}return l.p(0,0)},e._textureCoordFromAlphaPoint=function(e,t,i){var n=this._node._sprite;if(!n)return e.u=0,void(e.v=0);var s=n._renderCmd._vertices,r=s[1],a=s[2],o=l.p(r.u,r.v),h=l.p(a.u,a.v);if(n.textureRectRotated){var d=t;t=i,i=d}e.u=o.x*(1-t)+h.x*t,e.v=o.y*(1-i)+h.y*i},e._vertexFromAlphaPoint=function(e,t,i){e.x=this._bl.x*(1-t)+this._tr.x*t,e.y=this._bl.y*(1-i)+this._tr.y*i,e.z=this._node._vertexZ},e._updateColor=function(){var e=this._node._sprite;if(this._vertexDataCount&&e){var t=this._displayedColor,i=e._renderCmd._displayedColor,n=i.r,s=i.g,r=i.b,a=e._renderCmd._displayedOpacity/255;e._opacityModifyRGB&&(n*=a,s*=a,r*=a),t.r=n,t.g=s,t.b=r,t.a=e._renderCmd._displayedOpacity;for(var o=this._vertexData,h=0,l=this._vertexDataCount;h<l;++h)o[h].colors=t;this._vertexDataDirty=!0}}}(),l.IMAGE_FORMAT_JPEG=0,l.IMAGE_FORMAT_PNG=1,l.IMAGE_FORMAT_RAWDATA=9,l.NextPOT=function(e){return e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1},l.RenderTexture=l.Node.extend({sprite:null,clearFlags:0,clearDepthVal:0,autoDraw:!1,_texture:null,_pixelFormat:0,clearStencilVal:0,_clearColor:null,_className:"RenderTexture",ctor:function(e,t,i,n){l.Node.prototype.ctor.call(this),this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this._pixelFormat=l.Texture2D.PIXEL_FORMAT_RGBA8888,this._clearColor=new l.Color(0,0,0,255),void 0!==e&&void 0!==t&&(i=i||l.Texture2D.PIXEL_FORMAT_RGBA8888,n=n||0,this.initWithWidthAndHeight(e,t,i,n)),this.setAnchorPoint(0,0)},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.RenderTexture.CanvasRenderCmd(this):new l.RenderTexture.WebGLRenderCmd(this)},visit:function(e){var t=this._renderCmd,i=e?e._renderCmd:null;if(this._visible){var n=l.renderer;t.visit(i),n.pushRenderCommand(t),this.sprite.visit(this),t._dirtyFlag=0}else t._propagateFlagsDown(i)},cleanup:function(){l.Node.prototype.onExit.call(this),this._renderCmd.cleanup()},getSprite:function(){return this.sprite},setSprite:function(e){this.sprite=e},setVirtualViewport:function(e,t,i){this._renderCmd.setVirtualViewport(e,t,i)},initWithWidthAndHeight:function(e,t,i,n){return this._renderCmd.initWithWidthAndHeight(e,t,i,n)},begin:function(){l.renderer._turnToCacheMode(this.__instanceId),this._renderCmd.begin()},beginWithClear:function(e,t,i,n,s,r){var a=l._renderContext;s=s||a.COLOR_BUFFER_BIT,r=r||a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT,this._beginWithClear(e,t,i,n,s,r,a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT|a.STENCIL_BUFFER_BIT)},_beginWithClear:function(e,t,i,n,s,r,a){this.begin(),this._renderCmd._beginWithClear(e,t,i,n,s,r,a)},end:function(){this._renderCmd.end()},clear:function(e,t,i,n){this.beginWithClear(e,t,i,n),this.end()},clearRect:function(e,t,i,n){this._renderCmd.clearRect(e,t,i,n)},clearDepth:function(e){this._renderCmd.clearDepth(e)},clearStencil:function(e){this._renderCmd.clearStencil(e)},getClearFlags:function(){return this.clearFlags},setClearFlags:function(e){this.clearFlags=e},getClearColor:function(){return this._clearColor},setClearColor:function(e){var t=this._clearColor;t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a,this._renderCmd.updateClearColor(e)},getClearDepth:function(){return this.clearDepthVal},setClearDepth:function(e){this.clearDepthVal=e},getClearStencil:function(){return this.clearStencilVal},setClearStencil:function(e){this.clearStencilVal=e},isAutoDraw:function(){return this.autoDraw},setAutoDraw:function(e){this.autoDraw=e},saveToFile:function(e,t){l.log("saveToFile isn't supported on Cocos2d-Html5")},newCCImage:function(e){return l.log("saveToFile isn't supported on cocos2d-html5"),null},listenToBackground:function(e){},listenToForeground:function(e){}});var d=l.RenderTexture.prototype;d.clearColorVal,l.defineGetterSetter(d,"clearColorVal",d.getClearColor,d.setClearColor),l.RenderTexture.create=function(e,t,i,n){return new l.RenderTexture(e,t,i,n)},function(){l.RenderTexture.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!1,this._clearColorStr="rgba(255,255,255,1)",this._cacheCanvas=document.createElement("canvas"),this._cacheContext=new l.CanvasContextWrapper(this._cacheCanvas.getContext("2d"))};var e=l.RenderTexture.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.RenderTexture.CanvasRenderCmd,e.cleanup=function(){this._cacheContext=null,this._cacheCanvas=null},e.clearStencil=function(e){},e.setVirtualViewport=function(e,t,i){},e.updateClearColor=function(e){this._clearColorStr="rgba("+(0|e.r)+","+(0|e.g)+","+(0|e.b)+","+e.a/255+")"},e.initWithWidthAndHeight=function(e,t,i,n){var s=this._node,r=this._cacheCanvas,a=l.contentScaleFactor();r.width=0|e*a,r.height=0|t*a;var o=new l.Texture2D;o.initWithElement(r),o.handleLoadedTexture();var h=s.sprite=new l.Sprite(o);return h.setBlendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),s.autoDraw=!1,s.addChild(h),!0},e.begin=function(){},e._beginWithClear=function(e,t,i,n,s,r,a){e=e||0,t=t||0,i=i||0,n=isNaN(n)?255:n;var o=this._cacheContext.getContext(),h=this._cacheCanvas;o.setTransform(1,0,0,1,0,0),this._cacheContext.setFillStyle("rgba("+(0|e)+","+(0|t)+","+(0|i)+","+n/255+")"),o.clearRect(0,0,h.width,h.height),o.fillRect(0,0,h.width,h.height)},e.end=function(){var e=this._node,t=l.contentScaleFactor();l.renderer._renderingToCacheCanvas(this._cacheContext,e.__instanceId,t,t);var i=e.sprite._renderCmd;i._notifyRegionStatus&&i._notifyRegionStatus(l.Node.CanvasRenderCmd.RegionStatus.Dirty)},e.clearRect=function(e,t,i,n){this._cacheContext.clearRect(e,t,i,-n)},e.clearDepth=function(e){l.log("clearDepth isn't supported on Cocos2d-Html5")}}(),function(){l.RenderTexture.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._fBO=null,this._oldFBO=null,this._textureCopy=null,this._depthRenderBuffer=null,this._rtTextureRect=new l.Rect,this._fullRect=new l.Rect,this._fullViewport=new l.Rect};var e=l.RenderTexture.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.RenderTexture.WebGLRenderCmd,e.setVirtualViewport=function(e,t,i){this._rtTextureRect.x=e.x,this._rtTextureRect.y=e.y,this._fullRect=t,this._fullViewport=i},e.needDraw=function(){return this._needDraw&&this._node.autoDraw},e.rendering=function(e){var t=e||l._renderContext,i=this._node;if(i.autoDraw){i.begin();var n=i.clearFlags;if(n){var s=[0,0,0,0],r=0,a=0;n&t.COLOR_BUFFER_BIT&&(s=t.getParameter(t.COLOR_CLEAR_VALUE),t.clearColor(i._clearColor.r/255,i._clearColor.g/255,i._clearColor.b/255,i._clearColor.a/255)),n&t.DEPTH_BUFFER_BIT&&(r=t.getParameter(t.DEPTH_CLEAR_VALUE),t.clearDepth(i.clearDepthVal)),n&t.STENCIL_BUFFER_BIT&&(a=t.getParameter(t.STENCIL_CLEAR_VALUE),t.clearStencil(i.clearStencilVal)),t.clear(n),n&t.COLOR_BUFFER_BIT&&t.clearColor(s[0],s[1],s[2],s[3]),n&t.DEPTH_BUFFER_BIT&&t.clearDepth(r),n&t.STENCIL_BUFFER_BIT&&t.clearStencil(a)}i.sortAllChildren();for(var o=i._children,h=0;h<o.length;h++){var d=o[h];d!==i.sprite&&d.visit(i.sprite)}i.end()}},e.clearStencil=function(e){var t=l._renderContext,i=t.getParameter(t.STENCIL_CLEAR_VALUE);t.clearStencil(e),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(i)},e.cleanup=function(){this._node;this._textureCopy=null;var e=l._renderContext;e.deleteFramebuffer(this._fBO),this._depthRenderBuffer&&e.deleteRenderbuffer(this._depthRenderBuffer)},e.updateClearColor=function(e){},e.initWithWidthAndHeight=function(e,t,i,n){var s=this._node;i===l.Texture2D.PIXEL_FORMAT_A8&&l.log("cc.RenderTexture._initWithWidthAndHeightForWebGL() : only RGB and RGBA formats are valid for a render texture;");var r=l._renderContext,a=l.contentScaleFactor();this._fullRect=new l.Rect(0,0,e,t),this._fullViewport=new l.Rect(0,0,e,t),e=0|e*a,t=0|t*a,this._oldFBO=r.getParameter(r.FRAMEBUFFER_BINDING);var o,h;l.configuration.supportsNPOT()?(o=e,h=t):(o=l.NextPOT(e),h=l.NextPOT(t));for(var d=o*h*4,c=new Uint8Array(d),u=0;u<o*h*4;u++)c[u]=0;this._pixelFormat=i;var p=s._texture=new l.Texture2D;if(!s._texture)return!1;p.initWithData(c,s._pixelFormat,o,h,l.size(e,t));var m=r.getParameter(r.RENDERBUFFER_BINDING);if(l.configuration.checkForGLExtension("GL_QCOM")){if(this._textureCopy=new l.Texture2D,!this._textureCopy)return!1;this._textureCopy.initWithData(c,s._pixelFormat,o,h,l.size(e,t))}this._fBO=r.createFramebuffer(),r.bindFramebuffer(r.FRAMEBUFFER,this._fBO),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,p._webTextureObj,0),0!==n&&(this._depthRenderBuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this._depthRenderBuffer),r.renderbufferStorage(r.RENDERBUFFER,n,o,h),n===r.DEPTH_STENCIL?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,this._depthRenderBuffer):n===r.STENCIL_INDEX||n===r.STENCIL_INDEX8?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.STENCIL_ATTACHMENT,r.RENDERBUFFER,this._depthRenderBuffer):n===r.DEPTH_COMPONENT16&&r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this._depthRenderBuffer)),r.checkFramebufferStatus(r.FRAMEBUFFER)!==r.FRAMEBUFFER_COMPLETE&&l.log("Could not attach texture to the framebuffer"),p.setAliasTexParameters();var _=s.sprite=new l.Sprite(p);return _.scaleY=-1,_.setBlendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.bindRenderbuffer(r.RENDERBUFFER,m),r.bindFramebuffer(r.FRAMEBUFFER,this._oldFBO),s.autoDraw=!1,s.addChild(_),!0},e.begin=function(){var e=this._node;l.kmGLMatrixMode(l.KM_GL_PROJECTION),l.kmGLPushMatrix(),l.kmGLMatrixMode(l.KM_GL_MODELVIEW),l.kmGLPushMatrix();var t=l._renderContext,i=l.director;i.setProjection(i.getProjection());var n=e._texture.getContentSizeInPixels(),s=l.director.getWinSizeInPixels(),r=s.width/n.width,a=s.height/n.height,o=l.math.Matrix4.createOrthographicProjection(-1/r,1/r,-1/a,1/a,-1,1);l.kmGLMultMatrix(o);var h=new l.Rect(0,0,0,0);h.width=this._fullViewport.width,h.height=this._fullViewport.height;var d=h.width/this._fullRect.width,c=h.height/this._fullRect.height;h.x=(this._fullRect.x-this._rtTextureRect.x)*d,h.y=(this._fullRect.y-this._rtTextureRect.y)*c,t.viewport(h.x,h.y,h.width,h.height),this._oldFBO=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this._fBO),l.configuration.checkForGLExtension("GL_QCOM")&&(t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._textureCopy._webTextureObj,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e._texture._webTextureObj,0))},e._beginWithClear=function(e,t,i,n,s,r,a){e/=255,t/=255,i/=255,n/=255;var o=l._renderContext,h=[0,0,0,0],d=0,c=0;a&o.COLOR_BUFFER_BIT&&(h=o.getParameter(o.COLOR_CLEAR_VALUE),o.clearColor(e,t,i,n)),a&o.DEPTH_BUFFER_BIT&&(d=o.getParameter(o.DEPTH_CLEAR_VALUE),o.clearDepth(s)),a&o.STENCIL_BUFFER_BIT&&(c=o.getParameter(o.STENCIL_CLEAR_VALUE),o.clearStencil(r)),o.clear(a),a&o.COLOR_BUFFER_BIT&&o.clearColor(h[0],h[1],h[2],h[3]),a&o.DEPTH_BUFFER_BIT&&o.clearDepth(d),a&o.STENCIL_BUFFER_BIT&&o.clearStencil(c)},e.end=function(){var e=this._node;l.renderer._renderingToBuffer(e.__instanceId);var t=l._renderContext,i=l.director;t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO),i.setViewport(),l.kmGLMatrixMode(l.KM_GL_PROJECTION),l.kmGLPopMatrix(),l.kmGLMatrixMode(l.KM_GL_MODELVIEW),l.kmGLPopMatrix()},e.clearRect=function(e,t,i,n){},e.clearDepth=function(e){var t=this._node;t.begin();var i=l._renderContext,n=i.getParameter(i.DEPTH_CLEAR_VALUE);i.clearDepth(e),i.clear(i.DEPTH_BUFFER_BIT),i.clearDepth(n),t.end()}}(),l.SHADER_POSITION_UCOLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()                              \n{ \n    gl_FragColor = v_fragmentColor;      \n}\n",l.SHADER_POSITION_UCOLOR_VERT="attribute vec4 a_position;\nuniform    vec4 u_color;\nuniform float u_pointSize;\nvarying lowp vec4 v_fragmentColor; \nvoid main(void)   \n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    gl_PointSize = u_pointSize;          \n    v_fragmentColor = u_color;           \n}",l.SHADER_POSITION_COLOR_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvoid main() \n{ \n     gl_FragColor = v_fragmentColor; \n} ",l.SHADER_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color;             \n}",l.SHADER_SPRITE_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color;             \n}",l.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG="// #extension GL_OES_standard_derivatives : enable\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()\t\n{ \n// #if defined GL_OES_standard_derivatives\t\n// gl_FragColor = v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0 - length(v_texcoord)); \n// #else\t\ngl_FragColor = v_color * step(0.0, 1.0 - length(v_texcoord)); \n// #endif \n}",l.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT="attribute mediump vec4 a_position; \nattribute mediump vec2 a_texcoord; \nattribute mediump vec4 a_color;\t\nvarying mediump vec4 v_color; \nvarying mediump vec2 v_texcoord;\t\nvoid main() \n{ \n     v_color = a_color;//vec4(a_color.rgb * a_color.a, a_color.a); \n     v_texcoord = a_texcoord; \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n}",l.SHADER_POSITION_TEXTURE_FRAG="precision lowp float;   \nvarying vec2 v_texCoord;  \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord);   \n}",l.SHADER_POSITION_TEXTURE_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;               \n}",l.SHADER_POSITION_TEXTURE_UCOLOR_FRAG="precision lowp float;  \nuniform vec4 u_color; \nvarying vec2 v_texCoord; \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord) * u_color;    \n}",l.SHADER_POSITION_TEXTURE_UCOLOR_VERT="attribute vec4 a_position;\nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;                 \n}",l.SHADER_POSITION_TEXTURE_A8COLOR_FRAG="precision lowp float;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = vec4( v_fragmentColor.rgb,         \n        v_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a   \n    ); \n}",l.SHADER_POSITION_TEXTURE_A8COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",l.SHADER_POSITION_TEXTURE_COLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = v_fragmentColor * texture2D(CC_Texture0, v_texCoord); \n}",l.SHADER_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",l.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",l.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    vec4 c = texture2D(CC_Texture0, v_texCoord); \n    gl_FragColor.xyz = vec3(0.2126*c.r + 0.7152*c.g + 0.0722*c.b); \n     gl_FragColor.w = c.w ; \n}",l.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG="precision lowp float;   \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord;   \nuniform float CC_alpha_value; \nvoid main() \n{  \n    vec4 texColor = texture2D(CC_Texture0, v_texCoord);  \n    if ( texColor.a <= CC_alpha_value )          \n        discard; \n    gl_FragColor = texColor * v_fragmentColor;  \n}",l.SHADEREX_SWITCHMASK_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform sampler2D u_texture;  \nuniform sampler2D   u_mask;   \nvoid main()  \n{  \n    vec4 texColor   = texture2D(u_texture, v_texCoord);  \n    vec4 maskColor  = texture2D(u_mask, v_texCoord); \n    vec4 finalColor = vec4(texColor.r, texColor.g, texColor.b, maskColor.a * texColor.a);        \n    gl_FragColor    = v_fragmentColor * finalColor; \n}",l.shaderCache={TYPE_POSITION_TEXTURECOLOR:0,TYPE_POSITION_TEXTURECOLOR_ALPHATEST:1,TYPE_POSITION_COLOR:2,TYPE_POSITION_TEXTURE:3,TYPE_POSITION_TEXTURE_UCOLOR:4,TYPE_POSITION_TEXTURE_A8COLOR:5,TYPE_POSITION_UCOLOR:6,TYPE_POSITION_LENGTH_TEXTURECOLOR:7,TYPE_SPRITE_POSITION_TEXTURECOLOR:8,TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST:9,TYPE_SPRITE_POSITION_COLOR:10,TYPE_SPRITE_POSITION_TEXTURECOLOR_GRAY:11,TYPE_MAX:11,_keyMap:[l.SHADER_POSITION_TEXTURECOLOR,l.SHADER_POSITION_TEXTURECOLORALPHATEST,l.SHADER_POSITION_COLOR,l.SHADER_POSITION_TEXTURE,l.SHADER_POSITION_TEXTURE_UCOLOR,l.SHADER_POSITION_TEXTUREA8COLOR,l.SHADER_POSITION_UCOLOR,l.SHADER_POSITION_LENGTHTEXTURECOLOR,l.SHADER_SPRITE_POSITION_TEXTURECOLOR,l.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST,l.SHADER_SPRITE_POSITION_COLOR,l.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY],_programs:{},_init:function(){return this.loadDefaultShaders(),!0},_loadDefaultShader:function(e,t){switch(t){case l.SHADER_POSITION_TEXTURECOLOR:e.initWithVertexShaderByteArray(l.SHADER_POSITION_TEXTURE_COLOR_VERT,l.SHADER_POSITION_TEXTURE_COLOR_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS);break;case l.SHADER_SPRITE_POSITION_TEXTURECOLOR:e.initWithVertexShaderByteArray(l.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,l.SHADER_POSITION_TEXTURE_COLOR_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS);break;case l.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY:e.initWithVertexShaderByteArray(l.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,l.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS);break;case l.SHADER_POSITION_TEXTURECOLORALPHATEST:e.initWithVertexShaderByteArray(l.SHADER_POSITION_TEXTURE_COLOR_VERT,l.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS);break;case l.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST:e.initWithVertexShaderByteArray(l.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,l.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS);break;case l.SHADER_POSITION_COLOR:e.initWithVertexShaderByteArray(l.SHADER_POSITION_COLOR_VERT,l.SHADER_POSITION_COLOR_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR);break;case l.SHADER_SPRITE_POSITION_COLOR:e.initWithVertexShaderByteArray(l.SHADER_SPRITE_POSITION_COLOR_VERT,l.SHADER_POSITION_COLOR_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR);break;case l.SHADER_POSITION_TEXTURE:e.initWithVertexShaderByteArray(l.SHADER_POSITION_TEXTURE_VERT,l.SHADER_POSITION_TEXTURE_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS);break;case l.SHADER_POSITION_TEXTURE_UCOLOR:e.initWithVertexShaderByteArray(l.SHADER_POSITION_TEXTURE_UCOLOR_VERT,l.SHADER_POSITION_TEXTURE_UCOLOR_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS);break;case l.SHADER_POSITION_TEXTUREA8COLOR:e.initWithVertexShaderByteArray(l.SHADER_POSITION_TEXTURE_A8COLOR_VERT,l.SHADER_POSITION_TEXTURE_A8COLOR_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS);break;case l.SHADER_POSITION_UCOLOR:e.initWithVertexShaderByteArray(l.SHADER_POSITION_UCOLOR_VERT,l.SHADER_POSITION_UCOLOR_FRAG),e.addAttribute("aVertex",l.VERTEX_ATTRIB_POSITION);break;case l.SHADER_POSITION_LENGTHTEXTURECOLOR:e.initWithVertexShaderByteArray(l.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT,l.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG),e.addAttribute(l.ATTRIBUTE_NAME_POSITION,l.VERTEX_ATTRIB_POSITION),e.addAttribute(l.ATTRIBUTE_NAME_TEX_COORD,l.VERTEX_ATTRIB_TEX_COORDS),e.addAttribute(l.ATTRIBUTE_NAME_COLOR,l.VERTEX_ATTRIB_COLOR);break;default:return void l.log("cocos2d: cc.shaderCache._loadDefaultShader, error shader type")}e.link(),e.updateUniforms()},loadDefaultShaders:function(){for(var e=0;e<this.TYPE_MAX;++e){var t=this._keyMap[e];this.programForKey(t)}},reloadDefaultShaders:function(){var e=this.programForKey(l.SHADER_POSITION_TEXTURECOLOR);e.reset(),this._loadDefaultShader(e,l.SHADER_POSITION_TEXTURECOLOR),(e=this.programForKey(l.SHADER_SPRITE_POSITION_TEXTURECOLOR)).reset(),this._loadDefaultShader(e,l.SHADER_SPRITE_POSITION_TEXTURECOLOR),(e=this.programForKey(l.SHADER_POSITION_TEXTURECOLORALPHATEST)).reset(),this._loadDefaultShader(e,l.SHADER_POSITION_TEXTURECOLORALPHATEST),(e=this.programForKey(l.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST)).reset(),this._loadDefaultShader(e,l.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),(e=this.programForKey(l.SHADER_POSITION_COLOR)).reset(),this._loadDefaultShader(e,l.SHADER_POSITION_COLOR),(e=this.programForKey(l.SHADER_POSITION_TEXTURE)).reset(),this._loadDefaultShader(e,l.SHADER_POSITION_TEXTURE),(e=this.programForKey(l.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG)).reset(),this._loadDefaultShader(e,l.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG),(e=this.programForKey(l.SHADER_POSITION_TEXTURE_UCOLOR)).reset(),this._loadDefaultShader(e,l.SHADER_POSITION_TEXTURE_UCOLOR),(e=this.programForKey(l.SHADER_POSITION_TEXTUREA8COLOR)).reset(),this._loadDefaultShader(e,l.SHADER_POSITION_TEXTUREA8COLOR),(e=this.programForKey(l.SHADER_POSITION_UCOLOR)).reset(),this._loadDefaultShader(e,l.SHADER_POSITION_UCOLOR)},programForKey:function(e){if(!this._programs[e]){var t=new l.GLProgram;this._loadDefaultShader(t,e),this._programs[e]=t}return this._programs[e]},getProgram:function(e){return this.programForKey(e)},addProgram:function(e,t){this._programs[t]=e}},l.GLProgram=l.Class.extend({_glContext:null,_programObj:null,_vertShader:null,_fragShader:null,_uniforms:null,_hashForUniforms:null,_usesTime:!1,_projectionUpdated:-1,_updateUniformLocation:function(e){if(!e)return!1;var t,i=this._hashForUniforms[e];if(i){t=!1;for(var n=arguments.length-1,s=0;s<n;++s)arguments[s+1]!==i[s]&&(i[s]=arguments[s+1],t=!0)}else i=[arguments[1],arguments[2],arguments[3],arguments[4]],this._hashForUniforms[e]=i,t=!0;return t},_description:function(){return"<CCGLProgram = "+this.toString()+" | Program = "+this._programObj.toString()+", VertexShader = "+this._vertShader.toString()+", FragmentShader = "+this._fragShader.toString()+">"},_compileShader:function(e,t,i){if(!i||!e)return!1;i=(l.GLProgram._isHighpSupported()?"precision highp float;\n":"precision mediump float;\n")+"uniform mat4 CC_PMatrix;         \nuniform mat4 CC_MVMatrix;        \nuniform mat4 CC_MVPMatrix;       \nuniform vec4 CC_Time;            \nuniform vec4 CC_SinTime;         \nuniform vec4 CC_CosTime;         \nuniform vec4 CC_Random01;        \nuniform sampler2D CC_Texture0;   \n//CC INCLUDES END                \n"+i,this._glContext.shaderSource(e,i),this._glContext.compileShader(e);var n=this._glContext.getShaderParameter(e,this._glContext.COMPILE_STATUS);return n||(l.log("cocos2d: ERROR: Failed to compile shader:\n"+this._glContext.getShaderSource(e)),t===this._glContext.VERTEX_SHADER?l.log("cocos2d: \n"+this.vertexShaderLog()):l.log("cocos2d: \n"+this.fragmentShaderLog())),!0===n},ctor:function(e,t,i){this._uniforms={},this._hashForUniforms={},this._glContext=i||l._renderContext,e&&t&&this.init(e,t)},destroyProgram:function(){this._vertShader=null,this._fragShader=null,this._uniforms=null,this._hashForUniforms=null,this._glContext.deleteProgram(this._programObj)},initWithVertexShaderByteArray:function(e,t){var i=this._glContext;this._programObj=i.createProgram(),this._vertShader=null,this._fragShader=null,e&&(this._vertShader=i.createShader(i.VERTEX_SHADER),this._compileShader(this._vertShader,i.VERTEX_SHADER,e)||l.log("cocos2d: ERROR: Failed to compile vertex shader")),t&&(this._fragShader=i.createShader(i.FRAGMENT_SHADER),this._compileShader(this._fragShader,i.FRAGMENT_SHADER,t)||l.log("cocos2d: ERROR: Failed to compile fragment shader")),this._vertShader&&i.attachShader(this._programObj,this._vertShader),l.checkGLErrorDebug(),this._fragShader&&i.attachShader(this._programObj,this._fragShader);for(var n in this._hashForUniforms)delete this._hashForUniforms[n];return l.checkGLErrorDebug(),!0},initWithString:function(e,t){return this.initWithVertexShaderByteArray(e,t)},initWithVertexShaderFilename:function(e,t){var i=l.loader.getRes(e);if(!i)throw new Error("Please load the resource firset : "+e);var n=l.loader.getRes(t);if(!n)throw new Error("Please load the resource firset : "+t);return this.initWithVertexShaderByteArray(i,n)},init:function(e,t){return this.initWithVertexShaderFilename(e,t)},addAttribute:function(e,t){this._glContext.bindAttribLocation(this._programObj,t,e)},link:function(){return this._programObj?(this._glContext.linkProgram(this._programObj),this._vertShader&&this._glContext.deleteShader(this._vertShader),this._fragShader&&this._glContext.deleteShader(this._fragShader),this._vertShader=null,this._fragShader=null,!(l.game.config[l.game.CONFIG_KEY.debugMode]&&!this._glContext.getProgramParameter(this._programObj,this._glContext.LINK_STATUS))||(l.log("cocos2d: ERROR: Failed to link program: "+this._glContext.getProgramInfoLog(this._programObj)),l.glDeleteProgram(this._programObj),this._programObj=null,!1)):(l.log("cc.GLProgram.link(): Cannot link invalid program"),!1)},use:function(){l.glUseProgram(this._programObj)},updateUniforms:function(){this._uniforms[l.UNIFORM_PMATRIX_S]=this._glContext.getUniformLocation(this._programObj,l.UNIFORM_PMATRIX_S),this._uniforms[l.UNIFORM_MVMATRIX_S]=this._glContext.getUniformLocation(this._programObj,l.UNIFORM_MVMATRIX_S),this._uniforms[l.UNIFORM_MVPMATRIX_S]=this._glContext.getUniformLocation(this._programObj,l.UNIFORM_MVPMATRIX_S),this._uniforms[l.UNIFORM_TIME_S]=this._glContext.getUniformLocation(this._programObj,l.UNIFORM_TIME_S),this._uniforms[l.UNIFORM_SINTIME_S]=this._glContext.getUniformLocation(this._programObj,l.UNIFORM_SINTIME_S),this._uniforms[l.UNIFORM_COSTIME_S]=this._glContext.getUniformLocation(this._programObj,l.UNIFORM_COSTIME_S),this._usesTime=null!=this._uniforms[l.UNIFORM_TIME_S]||null!=this._uniforms[l.UNIFORM_SINTIME_S]||null!=this._uniforms[l.UNIFORM_COSTIME_S],this._uniforms[l.UNIFORM_RANDOM01_S]=this._glContext.getUniformLocation(this._programObj,l.UNIFORM_RANDOM01_S),this._uniforms[l.UNIFORM_SAMPLER_S]=this._glContext.getUniformLocation(this._programObj,l.UNIFORM_SAMPLER_S),this.use(),this.setUniformLocationWith1i(this._uniforms[l.UNIFORM_SAMPLER_S],0)},_addUniformLocation:function(e){var t=this._glContext.getUniformLocation(this._programObj,e);this._uniforms[e]=t},getUniformLocationForName:function(e){if(!e)throw new Error("cc.GLProgram.getUniformLocationForName(): uniform name should be non-null");if(!this._programObj)throw new Error("cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized");return this._uniforms[e]||this._glContext.getUniformLocation(this._programObj,e)},getUniformMVPMatrix:function(){return this._uniforms[l.UNIFORM_MVPMATRIX_S]},getUniformSampler:function(){return this._uniforms[l.UNIFORM_SAMPLER_S]},setUniformLocationWith1i:function(e,t){var i=this._glContext;if("string"==typeof e){if(this._updateUniformLocation(e,t)){var n=this.getUniformLocationForName(e);i.uniform1i(n,t)}}else i.uniform1i(e,t)},setUniformLocationWith2i:function(e,t,i){var n=this._glContext;if("string"==typeof e){if(this._updateUniformLocation(e,t,i)){var s=this.getUniformLocationForName(e);n.uniform2i(s,t,i)}}else n.uniform2i(e,t,i)},setUniformLocationWith3i:function(e,t,i,n){var s=this._glContext;if("string"==typeof e){if(this._updateUniformLocation(e,t,i,n)){var r=this.getUniformLocationForName(e);s.uniform3i(r,t,i,n)}}else s.uniform3i(e,t,i,n)},setUniformLocationWith4i:function(e,t,i,n,s){var r=this._glContext;if("string"==typeof e){if(this._updateUniformLocation(e,t,i,n,s)){var a=this.getUniformLocationForName(e);r.uniform4i(a,t,i,n,s)}}else r.uniform4i(e,t,i,n,s)},setUniformLocationWith2iv:function(e,t){var i="string"==typeof e?this.getUniformLocationForName(e):e;this._glContext.uniform2iv(i,t)},setUniformLocationWith3iv:function(e,t){var i="string"==typeof e?this.getUniformLocationForName(e):e;this._glContext.uniform3iv(i,t)},setUniformLocationWith4iv:function(e,t){var i="string"==typeof e?this.getUniformLocationForName(e):e;this._glContext.uniform4iv(i,t)},setUniformLocationI32:function(e,t){this.setUniformLocationWith1i(e,t)},setUniformLocationWith1f:function(e,t){var i=this._glContext;if("string"==typeof e){if(this._updateUniformLocation(e,t)){var n=this.getUniformLocationForName(e);i.uniform1f(n,t)}}else i.uniform1f(e,t)},setUniformLocationWith2f:function(e,t,i){var n=this._glContext;if("string"==typeof e){if(this._updateUniformLocation(e,t,i)){var s=this.getUniformLocationForName(e);n.uniform2f(s,t,i)}}else n.uniform2f(e,t,i)},setUniformLocationWith3f:function(e,t,i,n){var s=this._glContext;if("string"==typeof e){if(this._updateUniformLocation(e,t,i,n)){var r=this.getUniformLocationForName(e);s.uniform3f(r,t,i,n)}}else s.uniform3f(e,t,i,n)},setUniformLocationWith4f:function(e,t,i,n,s){var r=this._glContext;if("string"==typeof e){if(this._updateUniformLocation(e,t,i,n,s)){var a=this.getUniformLocationForName(e);r.uniform4f(a,t,i,n,s)}}else r.uniform4f(e,t,i,n,s)},setUniformLocationWith2fv:function(e,t){var i="string"==typeof e?this.getUniformLocationForName(e):e;this._glContext.uniform2fv(i,t)},setUniformLocationWith3fv:function(e,t){var i="string"==typeof e?this.getUniformLocationForName(e):e;this._glContext.uniform3fv(i,t)},setUniformLocationWith4fv:function(e,t){var i="string"==typeof e?this.getUniformLocationForName(e):e;this._glContext.uniform4fv(i,t)},setUniformLocationWithMatrix3fv:function(e,t){var i="string"==typeof e?this.getUniformLocationForName(e):e;this._glContext.uniformMatrix3fv(i,!1,t)},setUniformLocationWithMatrix4fv:function(e,t){var i="string"==typeof e?this.getUniformLocationForName(e):e;this._glContext.uniformMatrix4fv(i,!1,t)},setUniformLocationF32:function(){if(!(arguments.length<2))switch(arguments.length){case 2:this.setUniformLocationWith1f(arguments[0],arguments[1]);break;case 3:this.setUniformLocationWith2f(arguments[0],arguments[1],arguments[2]);break;case 4:this.setUniformLocationWith3f(arguments[0],arguments[1],arguments[2],arguments[3]);break;case 5:this.setUniformLocationWith4f(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}},setUniformsForBuiltins:function(){var e=new l.math.Matrix4,t=new l.math.Matrix4,i=new l.math.Matrix4;if(l.kmGLGetMatrix(l.KM_GL_PROJECTION,e),l.kmGLGetMatrix(l.KM_GL_MODELVIEW,t),l.kmMat4Multiply(i,e,t),this.setUniformLocationWithMatrix4fv(this._uniforms[l.UNIFORM_PMATRIX_S],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[l.UNIFORM_MVMATRIX_S],t.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[l.UNIFORM_MVPMATRIX_S],i.mat,1),this._usesTime){var n=l.director,s=n.getTotalFrames()*n.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[l.UNIFORM_TIME_S],s/10,s,2*s,4*s),this.setUniformLocationWith4f(this._uniforms[l.UNIFORM_SINTIME_S],s/8,s/4,s/2,Math.sin(s)),this.setUniformLocationWith4f(this._uniforms[l.UNIFORM_COSTIME_S],s/8,s/4,s/2,Math.cos(s))}-1!==this._uniforms[l.UNIFORM_RANDOM01_S]&&this.setUniformLocationWith4f(this._uniforms[l.UNIFORM_RANDOM01_S],Math.random(),Math.random(),Math.random(),Math.random())},_setUniformsForBuiltinsForRenderer:function(e){if(e&&e._renderCmd){var t=new l.math.Matrix4,i=new l.math.Matrix4;if(l.kmGLGetMatrix(l.KM_GL_PROJECTION,t),l.kmMat4Multiply(i,t,e._renderCmd._stackMatrix),this.setUniformLocationWithMatrix4fv(this._uniforms[l.UNIFORM_PMATRIX_S],t.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[l.UNIFORM_MVMATRIX_S],e._renderCmd._stackMatrix.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[l.UNIFORM_MVPMATRIX_S],i.mat,1),this._usesTime){var n=l.director,s=n.getTotalFrames()*n.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[l.UNIFORM_TIME_S],s/10,s,2*s,4*s),this.setUniformLocationWith4f(this._uniforms[l.UNIFORM_SINTIME_S],s/8,s/4,s/2,Math.sin(s)),this.setUniformLocationWith4f(this._uniforms[l.UNIFORM_COSTIME_S],s/8,s/4,s/2,Math.cos(s))}-1!==this._uniforms[l.UNIFORM_RANDOM01_S]&&this.setUniformLocationWith4f(this._uniforms[l.UNIFORM_RANDOM01_S],Math.random(),Math.random(),Math.random(),Math.random())}},setUniformForModelViewProjectionMatrix:function(){this._glContext.uniformMatrix4fv(this._uniforms[l.UNIFORM_MVPMATRIX_S],!1,l.getMat4MultiplyValue(l.projection_matrix_stack.top,l.modelview_matrix_stack.top))},setUniformForModelViewProjectionMatrixWithMat4:function(e){l.kmMat4Multiply(e,l.projection_matrix_stack.top,l.modelview_matrix_stack.top),this._glContext.uniformMatrix4fv(this._uniforms[l.UNIFORM_MVPMATRIX_S],!1,e.mat)},setUniformForModelViewAndProjectionMatrixWithMat4:function(){this._glContext.uniformMatrix4fv(this._uniforms[l.UNIFORM_MVMATRIX_S],!1,l.modelview_matrix_stack.top.mat),this._glContext.uniformMatrix4fv(this._uniforms[l.UNIFORM_PMATRIX_S],!1,l.projection_matrix_stack.top.mat)},_setUniformForMVPMatrixWithMat4:function(e){if(!e)throw new Error("modelView matrix is undefined.");this._glContext.uniformMatrix4fv(this._uniforms[l.UNIFORM_MVMATRIX_S],!1,e.mat),this._glContext.uniformMatrix4fv(this._uniforms[l.UNIFORM_PMATRIX_S],!1,l.projection_matrix_stack.top.mat)},_updateProjectionUniform:function(){var e=l.projection_matrix_stack;e.lastUpdated!==this._projectionUpdated&&(this._glContext.uniformMatrix4fv(this._uniforms[l.UNIFORM_PMATRIX_S],!1,e.top.mat),this._projectionUpdated=e.lastUpdated)},vertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getVertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getFragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},fragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._fragShader)},programLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},getProgramLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},reset:function(){this._vertShader=null,this._fragShader=null,this._uniforms.length=0,this._glContext.deleteProgram(this._programObj),this._programObj=null;for(var e in this._hashForUniforms)this._hashForUniforms[e].length=0,delete this._hashForUniforms[e]},getProgram:function(){return this._programObj},retain:function(){},release:function(){}}),l.GLProgram.create=function(e,t){return new l.GLProgram(e,t)},l.GLProgram._highpSupported=null,l.GLProgram._isHighpSupported=function(){var e=l._renderContext;if(e.getShaderPrecisionFormat&&null==l.GLProgram._highpSupported){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);l.GLProgram._highpSupported=0!==t.precision}return l.GLProgram._highpSupported},l.setProgram=function(e,t){e.shaderProgram=t;var i=e.children;if(i)for(var n=0;n<i.length;n++)l.setProgram(i[n],t)};var B={GL_FLOAT:0,GL_INT:1,GL_FLOAT_VEC2:2,GL_FLOAT_VEC3:3,GL_FLOAT_VEC4:4,GL_FLOAT_MAT4:5,GL_CALLBACK:6,GL_TEXTURE:7};l.UniformValue=function(e,t){this._uniform=e,this._glprogram=t,this._value=null,this._currentBoundValue=null,this._type=-1},l.UniformValue.prototype={setFloat:function(e){this._value=e,this._type=B.GL_FLOAT},setInt:function(e){this._value=e,this._type=B.GL_INT},setVec2:function(e,t){this._value=[e,t],this._type=B.GL_FLOAT_VEC2},setVec2v:function(e){this._value=e.slice(0),this._type=B.GL_FLOAT_VEC2},setVec3:function(e,t,i){this._value=[e,t,i],this._type=B.GL_FLOAT_VEC3},setVec3v:function(e){this._value=e.slice(0),this._type=B.GL_FLOAT_VEC3},setVec4:function(e,t,i,n){this._value=[e,t,i,n],this._type=B.GL_FLOAT_VEC4},setVec4v:function(e){this._value=e.slice(0),this._type=B.GL_FLOAT_VEC4},setMat4:function(e){this._value=e.slice(0),this._type=B.GL_FLOAT_MAT4},setCallback:function(e){this._value=e,this._type=B.GL_CALLBACK},setTexture:function(e,t){this._value=t,this._textureId=e,this._type=B.GL_TEXTURE},apply:function(){if(this._currentBoundValue!==this._value||this._type===B.GL_CALLBACK)switch(this._currentBoundValue=this._value,this._type){case B.GL_INT:this._glprogram.setUniformLocationWith1i(this._uniform.location,this._value);break;case B.GL_FLOAT:this._glprogram.setUniformLocationWith1f(this._uniform.location,this._value);break;case B.GL_FLOAT_VEC2:this._glprogram.setUniformLocationWith2f(this._uniform.location,this._value[0],this._value[1]);break;case B.GL_FLOAT_VEC3:this._glprogram.setUniformLocationWith3f(this._uniform.location,this._value[0],this._value[1],this._value[2]);break;case B.GL_FLOAT_VEC4:this._glprogram.setUniformLocationWith4f(this._uniform.location,this._value[0],this._value[1],this._value[2],this._value[3]);break;case B.GL_FLOAT_MAT4:this._glprogram.setUniformLocationWithMatrix4fv(this._uniform.location,this._value);break;case B.GL_CALLBACK:this._value(this._glprogram,this._uniform);break;case B.GL_TEXTURE:this._glprogram.setUniformLocationWith1i(this._uniform.location,this._value),l.glBindTexture2DN(this._value,this._textureId)}}},l.GLProgramState=function(e){this._glprogram=e,this._uniforms=[],this._uniformsByName={},this._uniformsByLocation={},this._boundTextureUnits={},this._textureUnitIndex=1;for(var t=e._glContext.getProgramParameter(e._programObj,e._glContext.ACTIVE_UNIFORMS),i=0,n=0;n<t;++n){var s=e._glContext.getActiveUniform(e._programObj,n);if(0!==s.name.indexOf("CC_")){s.location=e._glContext.getUniformLocation(e._programObj,s.name),s.name=s.name.replace("[]","");var r=new l.UniformValue(s,e);this._uniforms.push(r),this._uniformsByName[s.name]=i,this._uniformsByLocation[s.location]=i,i++}}},l.GLProgramState.prototype={apply:function(e){this._glprogram.use(),e&&this._glprogram._setUniformForMVPMatrixWithMat4(e);for(var t=0;t<this._uniforms.length;++t){var i=this._uniforms[t];i._currentBoundValue!==i._value&&i.apply()}},setGLProgram:function(e){this._glprogram=e},getGLProgram:function(){return this._glprogram},getUniformCount:function(){return this._uniforms.length},getUniformValue:function(e){return"string"==typeof e?this._uniforms[this._uniformsByName[e]]:this._uniforms[this._uniformsByLocation[e]]},setUniformInt:function(e,t){var i=this.getUniformValue(e);i?i.setInt(t):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformFloat:function(e,t){var i=this.getUniformValue(e);i?i.setFloat(t):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformVec2:function(e,t,i){var n=this.getUniformValue(e);n?n.setVec2(t,i):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformVec2v:function(e,t){var i=this.getUniformValue(e);i?i.setVec2v(t):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformVec3:function(e,t,i,n){var s=this.getUniformValue(e);s?s.setVec3(t,i,n):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformVec3v:function(e,t){var i=this.getUniformValue(e);i?i.setVec3v(t):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformVec4:function(e,t,i,n,s){var r=this.getUniformValue(e);r?r.setVec4(t,i,n,s):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformVec4v:function(e,t){var i=this.getUniformValue(e);i?i.setVec4v(t):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformMat4:function(e,t){var i=this.getUniformValue(e);i?i.setMat4(t):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformCallback:function(e,t){var i=this.getUniformValue(e);i?i.setCallback(t):l.log("cocos2d: warning: Uniform not found: "+e)},setUniformTexture:function(e,t){var i=this.getUniformValue(e);if(i){var n=this._boundTextureUnits[e];n?i.setTexture(t,n):(i.setTexture(t,this._textureUnitIndex),this._boundTextureUnits[e]=this._textureUnitIndex++)}}},l.GLProgramState._cache={},l.GLProgramState.getOrCreateWithGLProgram=function(e){var t=l.GLProgramState._cache[e.__instanceId];return t||(t=new l.GLProgramState(e),l.GLProgramState._cache[e.__instanceId]=t),t},l._currentProjectionMatrix=-1,l.ENABLE_GL_STATE_CACHE&&(l.MAX_ACTIVETEXTURE=16,l._currentShaderProgram=-1,l._currentBoundTexture=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l._blendingSource=-1,l._blendingDest=-1,l._GLServerState=0,l.TEXTURE_ATLAS_USE_VAO&&(l._uVAO=0)),l.glInvalidateStateCache=function(){if(l.kmGLFreeAll(),l._currentProjectionMatrix=-1,l.ENABLE_GL_STATE_CACHE){l._currentShaderProgram=-1;for(var e=0;e<l.MAX_ACTIVETEXTURE;e++)l._currentBoundTexture[e]=-1;l._blendingSource=-1,l._blendingDest=-1,l._GLServerState=0}},l.glUseProgram=l.ENABLE_GL_STATE_CACHE?function(e){e!==l._currentShaderProgram&&(l._currentShaderProgram=e,l._renderContext.useProgram(e))}:function(e){l._renderContext.useProgram(e)},l.glDeleteProgram=function(e){l.ENABLE_GL_STATE_CACHE&&e===l._currentShaderProgram&&(l._currentShaderProgram=-1),gl.deleteProgram(e)},l.setBlending=function(e,t){var i=l._renderContext;e===i.ONE&&t===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),l._renderContext.blendFunc(e,t))},l.glBlendFunc=l.ENABLE_GL_STATE_CACHE?function(e,t){e===l._blendingSource&&t===l._blendingDest||(l._blendingSource=e,l._blendingDest=t,l.setBlending(e,t))}:l.setBlending,l.glBlendFuncForParticle=function(e,t){if(e!==l._blendingSource||t!==l._blendingDest){l._blendingSource=e,l._blendingDest=t;var i=l._renderContext;e===i.ONE&&t===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,t,e,t))}},l.glBlendResetToCache=function(){var e=l._renderContext;e.blendEquation(e.FUNC_ADD),l.ENABLE_GL_STATE_CACHE?l.setBlending(l._blendingSource,l._blendingDest):l.setBlending(e.BLEND_SRC,e.BLEND_DST)},l.setProjectionMatrixDirty=function(){l._currentProjectionMatrix=-1},l.glBindTexture2D=function(e){l.glBindTexture2DN(0,e)},l.glBindTexture2DN=l.ENABLE_GL_STATE_CACHE?function(e,t){if(l._currentBoundTexture[e]!==t){l._currentBoundTexture[e]=t;var i=l._renderContext;i.activeTexture(i.TEXTURE0+e),t?i.bindTexture(i.TEXTURE_2D,t._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)}}:function(e,t){var i=l._renderContext;i.activeTexture(i.TEXTURE0+e),t?i.bindTexture(i.TEXTURE_2D,t._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)},l.glDeleteTexture=function(e){l.glDeleteTextureN(0,e)},l.glDeleteTextureN=function(e,t){l.ENABLE_GL_STATE_CACHE&&t===l._currentBoundTexture[e]&&(l._currentBoundTexture[e]=-1),l._renderContext.deleteTexture(t._webTextureObj)},l.glBindVAO=function(e){l.TEXTURE_ATLAS_USE_VAO&&l.ENABLE_GL_STATE_CACHE&&l._uVAO!==e&&(l._uVAO=e)},l.glEnable=function(e){l.ENABLE_GL_STATE_CACHE},l.GridAction=l.ActionInterval.extend({_gridSize:null,_gridNodeTarget:null,ctor:function(e,t){l.sys._checkWebGLRenderMode(),l.ActionInterval.prototype.ctor.call(this),this._gridSize=l.size(0,0),t&&this.initWithDuration(e,t)},_cacheTargetAsGridNode:function(e){this._gridNodeTarget=e},clone:function(){var e=new l.GridAction,t=this._gridSize;return e.initWithDuration(this._duration,l.size(t.width,t.height)),e},startWithTarget:function(e){l.ActionInterval.prototype.startWithTarget.call(this,e),l.renderer.childrenOrderDirty=!0,this._cacheTargetAsGridNode(e);var t=this.getGrid(),i=this._gridNodeTarget.getGrid();if(i&&i.getReuseGrid()>0){var n=i.getGridSize();i.isActive()&&n.width===this._gridSize.width&&n.height===this._gridSize.height&&i.reuse()}else i&&i.isActive()&&i.setActive(!1),this._gridNodeTarget.setGrid(t),this._gridNodeTarget.getGrid().setActive(!0)},reverse:function(){return new l.ReverseTime(this)},initWithDuration:function(e,t){return!!l.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._gridSize.width=t.width,this._gridSize.height=t.height,!0)},getGrid:function(){l.log("cc.GridAction.getGrid(): it should be overridden in subclass.")}}),l.gridAction=function(e,t){return new l.GridAction(e,t)},l.GridAction.create=l.gridAction,l.Grid3DAction=l.GridAction.extend({getGrid:function(){return new l.Grid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect())},getGridRect:function(){return this._gridNodeTarget.getGridRect()},vertex:function(e){return this.getVertex(e)},getVertex:function(e){return this.target.grid.getVertex(e)},originalVertex:function(e){return this.getOriginalVertex(e)},getOriginalVertex:function(e){return this.target.grid.originalVertex(e)},setVertex:function(e,t){this.target.grid.setVertex(e,t)}}),l.grid3DAction=function(e,t){return new l.Grid3DAction(e,t)},l.Grid3DAction.create=l.grid3DAction,l.TiledGrid3DAction=l.GridAction.extend({tile:function(e){return this.getTile(e)},getTile:function(e){return this.target.grid.tile(e)},originalTile:function(e){return this.getOriginalTile(e)},getOriginalTile:function(e){return this.target.grid.originalTile(e)},setTile:function(e,t){this.target.grid.setTile(e,t)},getGrid:function(){return new l.TiledGrid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect())}}),l.tiledGrid3DAction=function(e,t){return new l.TiledGrid3DAction(e,t)},l.TiledGrid3DAction.create=l.tiledGrid3DAction,l.StopGrid=l.ActionInstant.extend({startWithTarget:function(e){l.ActionInstant.prototype.startWithTarget.call(this,e),l.renderer.childrenOrderDirty=!0;var t=this.target.grid;t&&t.isActive()&&t.setActive(!1)}}),l.stopGrid=function(){return new l.StopGrid},l.StopGrid.create=l.stopGrid,l.ReuseGrid=l.ActionInstant.extend({_times:null,ctor:function(e){l.ActionInstant.prototype.ctor.call(this),void 0!==e&&this.initWithTimes(e)},initWithTimes:function(e){return this._times=e,!0},startWithTarget:function(e){l.ActionInstant.prototype.startWithTarget.call(this,e),l.renderer.childrenOrderDirty=!0,this.target.grid&&this.target.grid.isActive()&&this.target.grid.setReuseGrid(this.target.grid.getReuseGrid()+this._times)}}),l.reuseGrid=function(e){return new l.ReuseGrid(e)},l.ReuseGrid.create=l.reuseGrid,l.Waves3D=l.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n){l.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n){return!!l.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(e){for(var t=this._gridSize,i=this._amplitude,n=l.p(0,0),s=this._amplitudeRate,r=this._waves,a=0;a<t.width+1;++a)for(var o=0;o<t.height+1;++o){n.x=a,n.y=o;var h=this.originalVertex(n);h.z+=Math.sin(Math.PI*e*r*2+.01*(h.y+h.x))*i*s,this.setVertex(n,h)}}}),l.waves3D=function(e,t,i,n){return new l.Waves3D(e,t,i,n)},l.Waves3D.create=l.waves3D,l.FlipX3D=l.Grid3DAction.extend({ctor:function(e){void 0!==e?l.GridAction.prototype.ctor.call(this,e,l.size(1,1)):l.GridAction.prototype.ctor.call(this)},initWithDuration:function(e){return l.Grid3DAction.prototype.initWithDuration.call(this,e,l.size(1,1))},initWithSize:function(e,t){return 1!==e.width||1!==e.height?(l.log("Grid size must be (1,1)"),!1):l.Grid3DAction.prototype.initWithDuration.call(this,t,e)},update:function(e){var t=Math.PI*e,i=Math.sin(t);t/=2;var n=Math.cos(t),s=new l.Vertex3F,r=l.p(0,0);r.x=r.y=1;var a=this.originalVertex(r);r.x=r.y=0;var o,h,d,c,u,p=this.originalVertex(r),m=a.x,_=p.x;m>_?(h=l.p(0,0),d=l.p(0,1),c=l.p(1,0),u=l.p(1,1),o=m):(c=l.p(0,0),u=l.p(0,1),h=l.p(1,0),d=l.p(1,1),o=_),s.x=o-o*n,s.z=Math.abs(parseFloat(o*i/4));var g=this.originalVertex(h);g.x=s.x,g.z+=s.z,this.setVertex(h,g),(g=this.originalVertex(d)).x=s.x,g.z+=s.z,this.setVertex(d,g),(g=this.originalVertex(c)).x-=s.x,g.z-=s.z,this.setVertex(c,g),(g=this.originalVertex(u)).x-=s.x,g.z-=s.z,this.setVertex(u,g)}}),l.flipX3D=function(e){return new l.FlipX3D(e)},l.FlipX3D.create=l.flipX3D,l.FlipY3D=l.FlipX3D.extend({ctor:function(e){void 0!==e?l.GridAction.prototype.ctor.call(this,e,l.size(1,1)):l.GridAction.prototype.ctor.call(this)},update:function(e){var t=Math.PI*e,i=Math.sin(t);t/=2;var n=Math.cos(t),s=new l.Vertex3F,r=l.p(0,0);r.x=r.y=1;var a=this.originalVertex(r);r.x=r.y=0;var o,h,d,c,u,p=this.originalVertex(r),m=a.y,_=p.y;m>_?(h=l.p(0,0),d=l.p(0,1),c=l.p(1,0),u=l.p(1,1),o=m):(d=l.p(0,0),h=l.p(0,1),u=l.p(1,0),c=l.p(1,1),o=_),s.y=o-o*n,s.z=Math.abs(parseFloat(o*i)/4);var g=this.originalVertex(h);g.y=s.y,g.z+=s.z,this.setVertex(h,g),(g=this.originalVertex(d)).y-=s.y,g.z-=s.z,this.setVertex(d,g),(g=this.originalVertex(c)).y=s.y,g.z+=s.z,this.setVertex(c,g),(g=this.originalVertex(u)).y-=s.y,g.z-=s.z,this.setVertex(u,g)}}),l.flipY3D=function(e){return new l.FlipY3D(e)},l.FlipY3D.create=l.flipY3D,l.Lens3D=l.Grid3DAction.extend({_position:null,_radius:0,_lensEffect:0,_concave:!1,_dirty:!1,ctor:function(e,t,i,n){l.GridAction.prototype.ctor.call(this),this._position=l.p(0,0),void 0!==n&&this.initWithDuration(e,t,i,n)},getLensEffect:function(){return this._lensEffect},setLensEffect:function(e){this._lensEffect=e},setConcave:function(e){this._concave=e},getPosition:function(){return this._position},setPosition:function(e){l.pointEqualToPoint(e,this._position)||(this._position.x=e.x,this._position.y=e.y,this._dirty=!0)},initWithDuration:function(e,t,i,n){return!!l.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(i),this._radius=n,this._lensEffect=.7,this._dirty=!0,!0)},update:function(e){if(this._dirty){for(var t,i,n,s,r,a=this._gridSize.width,o=this._gridSize.height,h=this._radius,d=this._lensEffect,c=l.p(0,0),u=l.p(0,0),p=0;p<a+1;++p)for(var m=0;m<o+1;++m)c.x=p,c.y=m,t=this.originalVertex(c),u.x=this._position.x-t.x,u.y=this._position.y-t.y,(i=l.pLength(u))<h&&(0===(r=(i=h-i)/h)&&(r=.001),n=Math.log(r)*d,s=Math.exp(n)*h,(i=l.pLength(u))>0&&(u.x=u.x/i,u.y=u.y/i,u.x=u.x*s,u.y=u.y*s,t.z+=l.pLength(u)*d)),this.setVertex(c,t);this._dirty=!1}}}),l.lens3D=function(e,t,i,n){return new l.Lens3D(e,t,i,n)},l.Lens3D.create=l.lens3D,l.Ripple3D=l.Grid3DAction.extend({_position:null,_radius:0,_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n,s,r){l.GridAction.prototype.ctor.call(this),this._position=l.p(0,0),void 0!==r&&this.initWithDuration(e,t,i,n,s,r)},getPosition:function(){return this._position},setPosition:function(e){this._position.x=e.x,this._position.y=e.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n,s,r){return!!l.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(i),this._radius=n,this._waves=s,this._amplitude=r,this._amplitudeRate=1,!0)},update:function(e){for(var t,i,n=this._gridSize.width,s=this._gridSize.height,r=l.p(0,0),a=this._radius,o=this._waves,h=this._amplitude,d=this._amplitudeRate,c=l.p(0,0),u=0;u<n+1;++u)for(var p=0;p<s+1;++p){if(r.x=u,r.y=p,t=this.originalVertex(r),c.x=this._position.x-t.x,c.y=this._position.y-t.y,(i=l.pLength(c))<a){i=a-i;var m=Math.pow(i/a,2);t.z+=Math.sin(e*Math.PI*o*2+.1*i)*h*d*m}this.setVertex(r,t)}}}),l.ripple3D=function(e,t,i,n,s,r){return new l.Ripple3D(e,t,i,n,s,r)},l.Ripple3D.create=l.ripple3D,l.Shaky3D=l.Grid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(e,t,i,n){l.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!l.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._randRange=i,this._shakeZ=n,!0)},update:function(e){for(var t,i=this._gridSize.width,n=this._gridSize.height,s=this._randRange,r=this._shakeZ,a=l.p(0,0),o=0;o<i+1;++o)for(var h=0;h<n+1;++h)a.x=o,a.y=h,(t=this.originalVertex(a)).x+=l.rand()%(2*s)-s,t.y+=l.rand()%(2*s)-s,r&&(t.z+=l.rand()%(2*s)-s),this.setVertex(a,t)}}),l.shaky3D=function(e,t,i,n){return new l.Shaky3D(e,t,i,n)},l.Shaky3D.create=l.shaky3D,l.Liquid=l.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n){l.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n){return!!l.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(e){for(var t,i=this._gridSize.width,n=this._gridSize.height,s=l.p(0,0),r=this._waves,a=this._amplitude,o=this._amplitudeRate,h=1;h<i;++h)for(var d=1;d<n;++d)s.x=h,s.y=d,(t=this.originalVertex(s)).x=t.x+Math.sin(e*Math.PI*r*2+.01*t.x)*a*o,t.y=t.y+Math.sin(e*Math.PI*r*2+.01*t.y)*a*o,this.setVertex(s,t)}}),l.liquid=function(e,t,i,n){return new l.Liquid(e,t,i,n)},l.Liquid.create=l.liquid,l.Waves=l.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,_vertical:!1,_horizontal:!1,ctor:function(e,t,i,n,s,r){l.GridAction.prototype.ctor.call(this),void 0!==r&&this.initWithDuration(e,t,i,n,s,r)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n,s,r){return!!l.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,this._horizontal=s,this._vertical=r,!0)},update:function(e){for(var t,i=this._gridSize.width,n=this._gridSize.height,s=l.p(0,0),r=this._vertical,a=this._horizontal,o=this._waves,h=this._amplitude,d=this._amplitudeRate,c=0;c<i+1;++c)for(var u=0;u<n+1;++u)s.x=c,s.y=u,t=this.originalVertex(s),r&&(t.x=t.x+Math.sin(e*Math.PI*o*2+.01*t.y)*h*d),a&&(t.y=t.y+Math.sin(e*Math.PI*o*2+.01*t.x)*h*d),this.setVertex(s,t)}}),l.waves=function(e,t,i,n,s,r){return new l.Waves(e,t,i,n,s,r)},l.Waves.create=l.waves,l.Twirl=l.Grid3DAction.extend({_position:null,_twirls:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n,s){l.GridAction.prototype.ctor.call(this),this._position=l.p(0,0),void 0!==s&&this.initWithDuration(e,t,i,n,s)},getPosition:function(){return this._position},setPosition:function(e){this._position.x=e.x,this._position.y=e.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n,s){return!!l.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(i),this._twirls=n,this._amplitude=s,this._amplitudeRate=1,!0)},update:function(e){for(var t,i,n,s,r=this._position,a=this._gridSize.width,o=this._gridSize.height,h=l.p(0,0),d=.1*this._amplitude*this._amplitudeRate,c=this._twirls,u=l.p(0,0),p=0;p<a+1;++p)for(var m=0;m<o+1;++m)h.x=p,h.y=m,t=this.originalVertex(h),u.x=p-a/2,u.y=m-o/2,i=l.pLength(u)*Math.cos(Math.PI/2+e*Math.PI*c*2)*d,n=Math.sin(i)*(t.y-r.y)+Math.cos(i)*(t.x-r.x),s=Math.cos(i)*(t.y-r.y)-Math.sin(i)*(t.x-r.x),t.x=r.x+n,t.y=r.y+s,this.setVertex(h,t)}}),l.twirl=function(e,t,i,n,s){return new l.Twirl(e,t,i,n,s)},l.Twirl.create=l.twirl,l.ShakyTiles3D=l.TiledGrid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(e,t,i,n){l.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!l.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._randRange=i,this._shakeZ=n,!0)},update:function(e){for(var t=this._gridSize,i=this._randRange,n=l.p(0,0),s=0;s<t.width;++s)for(var r=0;r<t.height;++r){n.x=s,n.y=r;var a=this.originalTile(n);a.bl.x+=l.rand()%(2*i)-i,a.br.x+=l.rand()%(2*i)-i,a.tl.x+=l.rand()%(2*i)-i,a.tr.x+=l.rand()%(2*i)-i,a.bl.y+=l.rand()%(2*i)-i,a.br.y+=l.rand()%(2*i)-i,a.tl.y+=l.rand()%(2*i)-i,a.tr.y+=l.rand()%(2*i)-i,this._shakeZ&&(a.bl.z+=l.rand()%(2*i)-i,a.br.z+=l.rand()%(2*i)-i,a.tl.z+=l.rand()%(2*i)-i,a.tr.z+=l.rand()%(2*i)-i),this.setTile(n,a)}}}),l.shakyTiles3D=function(e,t,i,n){return new l.ShakyTiles3D(e,t,i,n)},l.ShakyTiles3D.create=l.shakyTiles3D,l.ShatteredTiles3D=l.TiledGrid3DAction.extend({_randRange:0,_once:!1,_shatterZ:!1,ctor:function(e,t,i,n){l.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},initWithDuration:function(e,t,i,n){return!!l.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._once=!1,this._randRange=i,this._shatterZ=n,!0)},update:function(e){if(!1===this._once){for(var t,i=this._gridSize,n=this._randRange,s=l.p(0,0),r=0;r<i.width;++r)for(var a=0;a<i.height;++a)s.x=r,s.y=a,(t=this.originalTile(s)).bl.x+=l.rand()%(2*n)-n,t.br.x+=l.rand()%(2*n)-n,t.tl.x+=l.rand()%(2*n)-n,t.tr.x+=l.rand()%(2*n)-n,t.bl.y+=l.rand()%(2*n)-n,t.br.y+=l.rand()%(2*n)-n,t.tl.y+=l.rand()%(2*n)-n,t.tr.y+=l.rand()%(2*n)-n,this._shatterZ&&(t.bl.z+=l.rand()%(2*n)-n,t.br.z+=l.rand()%(2*n)-n,t.tl.z+=l.rand()%(2*n)-n,t.tr.z+=l.rand()%(2*n)-n),this.setTile(s,t);this._once=!0}}}),l.shatteredTiles3D=function(e,t,i,n){return new l.ShatteredTiles3D(e,t,i,n)},l.ShatteredTiles3D.create=l.shatteredTiles3D,l.Tile=function(e,t,i){this.position=e||l.p(0,0),this.startPosition=t||l.p(0,0),this.delta=i||l.p(0,0)},l.ShuffleTiles=l.TiledGrid3DAction.extend({_seed:0,_tilesCount:0,_tilesOrder:null,_tiles:null,ctor:function(e,t,i){l.GridAction.prototype.ctor.call(this),this._tilesOrder=[],this._tiles=[],void 0!==i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!l.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._seed=i,this._tilesOrder.length=0,this._tiles.length=0,!0)},shuffle:function(e,t){for(var i=t-1;i>=0;i--){var n=0|l.rand()%(i+1),s=e[i];e[i]=e[n],e[n]=s}},getDelta:function(e){var t=this._gridSize,i=e.width*t.height+e.height;return l.size(this._tilesOrder[i]/t.height-e.width,this._tilesOrder[i]%t.height-e.height)},placeTile:function(e,t){var i=this.originalTile(e),n=this.target.grid.getStep(),s=t.position;i.bl.x+=s.x*n.x,i.bl.y+=s.y*n.y,i.br.x+=s.x*n.x,i.br.y+=s.y*n.y,i.tl.x+=s.x*n.x,i.tl.y+=s.y*n.y,i.tr.x+=s.x*n.x,i.tr.y+=s.y*n.y,this.setTile(e,i)},startWithTarget:function(e){l.TiledGrid3DAction.prototype.startWithTarget.call(this,e);var t=this._gridSize;this._tilesCount=t.width*t.height;var i=this._tilesOrder;i.length=0;for(var n=0;n<this._tilesCount;++n)i[n]=n;this.shuffle(i,this._tilesCount);var s=this._tiles;s.length=0;for(var r=0,a=l.size(0,0),o=0;o<t.width;++o)for(var h=0;h<t.height;++h)s[r]=new l.Tile,s[r].position=l.p(o,h),s[r].startPosition=l.p(o,h),a.width=o,a.height=h,s[r].delta=this.getDelta(a),++r},update:function(e){for(var t,i=0,n=this._gridSize,s=this._tiles,r=l.p(0,0),a=0;a<n.width;++a)for(var o=0;o<n.height;++o)r.x=a,r.y=o,(t=s[i]).position.x=t.delta.width*e,t.position.y=t.delta.height*e,this.placeTile(r,t),++i}}),l.shuffleTiles=function(e,t,i){return new l.ShuffleTiles(e,t,i)},l.ShuffleTiles.create=l.shuffleTiles,l.FadeOutTRTiles=l.TiledGrid3DAction.extend({testFunc:function(e,t){var i=this._gridSize.width*t,n=this._gridSize.height*t;return i===this._gridSize.width&&n===this._gridSize.height?0:i+n===0?1:Math.pow((e.x+e.y)/(i+n),6)},turnOnTile:function(e){this.setTile(e,this.originalTile(e))},turnOffTile:function(e){this.setTile(e,new l.Quad3)},transformTile:function(e,t){var i=this.originalTile(e),n=this.target.grid.getStep();i.bl.x+=n.x/2*(1-t),i.bl.y+=n.y/2*(1-t),i.br.x-=n.x/2*(1-t),i.br.y+=n.y/2*(1-t),i.tl.x+=n.x/2*(1-t),i.tl.y-=n.y/2*(1-t),i.tr.x-=n.x/2*(1-t),i.tr.y-=n.y/2*(1-t),this.setTile(e,i)},update:function(e){for(var t,i=this._gridSize,n=l.p(0,0),s=0;s<i.width;++s)for(var r=0;r<i.height;++r)n.x=s,n.y=r,0===(t=this.testFunc(n,e))?this.turnOffTile(n):t<1?this.transformTile(n,t):this.turnOnTile(n)}}),l.fadeOutTRTiles=function(e,t){return new l.FadeOutTRTiles(e,t)},l.FadeOutTRTiles.create=l.fadeOutTRTiles,l.FadeOutBLTiles=l.FadeOutTRTiles.extend({testFunc:function(e,t){var i=this._gridSize.width*(1-t),n=this._gridSize.height*(1-t);return i+n===0?0:e.x+e.y===0?1:Math.pow((i+n)/(e.x+e.y),6)}}),l.fadeOutBLTiles=function(e,t){return new l.FadeOutBLTiles(e,t)},l.FadeOutBLTiles.create=l.fadeOutBLTiles,l.FadeOutUpTiles=l.FadeOutTRTiles.extend({testFunc:function(e,t){var i=this._gridSize.height*t;return i===this._gridSize.height?0:0===i?1:Math.pow(e.y/i,6)},transformTile:function(e,t){var i=this.originalTile(e),n=this.target.grid.getStep();i.bl.y+=n.y/2*(1-t),i.br.y+=n.y/2*(1-t),i.tl.y-=n.y/2*(1-t),i.tr.y-=n.y/2*(1-t),this.setTile(e,i)}}),l.fadeOutUpTiles=function(e,t){return new l.FadeOutUpTiles(e,t)},l.FadeOutUpTiles.create=l.fadeOutUpTiles,l.FadeOutDownTiles=l.FadeOutUpTiles.extend({testFunc:function(e,t){var i=this._gridSize.height*(1-t);return 0===i?0:0===e.y?1:Math.pow(i/e.y,6)}}),l.fadeOutDownTiles=function(e,t){return new l.FadeOutDownTiles(e,t)},l.FadeOutDownTiles.create=l.fadeOutDownTiles,l.TurnOffTiles=l.TiledGrid3DAction.extend({_seed:null,_tilesCount:0,_tilesOrder:null,ctor:function(e,t,i){l.GridAction.prototype.ctor.call(this),this._tilesOrder=[],void 0!==t&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return!!l.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._seed=i||0,this._tilesOrder.length=0,!0)},shuffle:function(e,t){for(var i=t-1;i>=0;i--){var n=0|l.rand()%(i+1),s=e[i];e[i]=e[n],e[n]=s}},turnOnTile:function(e){this.setTile(e,this.originalTile(e))},turnOffTile:function(e){this.setTile(e,new l.Quad3)},startWithTarget:function(e){l.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._tilesCount=this._gridSize.width*this._gridSize.height;var t=this._tilesOrder;t.length=0;for(var i=0;i<this._tilesCount;++i)t[i]=i;this.shuffle(t,this._tilesCount)},update:function(e){for(var t,i=0|e*this._tilesCount,n=this._gridSize,s=l.p(0,0),r=this._tilesOrder,a=0;a<this._tilesCount;a++)t=r[a],s.x=0|t/n.height,s.y=t%(0|n.height),a<i?this.turnOffTile(s):this.turnOnTile(s)}}),l.turnOffTiles=function(e,t,i){return new l.TurnOffTiles(e,t,i)},l.TurnOffTiles.create=l.turnOffTiles,l.WavesTiles3D=l.TiledGrid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n){l.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n){return!!l.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(e){for(var t,i=this._gridSize,n=this._waves,s=this._amplitude,r=this._amplitudeRate,a=l.p(0,0),o=0;o<i.width;o++)for(var h=0;h<i.height;h++)a.x=o,a.y=h,(t=this.originalTile(a)).bl.z=Math.sin(e*Math.PI*n*2+.01*(t.bl.y+t.bl.x))*s*r,t.br.z=t.bl.z,t.tl.z=t.bl.z,t.tr.z=t.bl.z,this.setTile(a,t)}}),l.wavesTiles3D=function(e,t,i,n){return new l.WavesTiles3D(e,t,i,n)},l.WavesTiles3D.create=l.wavesTiles3D,l.JumpTiles3D=l.TiledGrid3DAction.extend({_jumps:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,i,n){l.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(e,t,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,i,n){return!!l.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._jumps=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(e){for(var t,i=Math.sin(Math.PI*e*this._jumps*2)*this._amplitude*this._amplitudeRate,n=Math.sin(Math.PI*(e*this._jumps*2+1))*this._amplitude*this._amplitudeRate,s=this._gridSize,r=this.target.grid,a=l.p(0,0),o=0;o<s.width;o++)for(var h=0;h<s.height;h++)a.x=o,a.y=h,t=r.originalTile(a),(o+h)%2==0?(t.bl.z+=i,t.br.z+=i,t.tl.z+=i,t.tr.z+=i):(t.bl.z+=n,t.br.z+=n,t.tl.z+=n,t.tr.z+=n),r.setTile(a,t)}}),l.jumpTiles3D=function(e,t,i,n){return new l.JumpTiles3D(e,t,i,n)},l.JumpTiles3D.create=l.jumpTiles3D,l.SplitRows=l.TiledGrid3DAction.extend({_rows:0,_winSize:null,ctor:function(e,t){l.GridAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return this._rows=t,l.TiledGrid3DAction.prototype.initWithDuration.call(this,e,l.size(1,t))},update:function(e){for(var t,i,n=this._gridSize,s=this._winSize.width,r=l.p(0,0),a=0;a<n.height;++a)r.y=a,t=this.originalTile(r),i=1,a%2==0&&(i=-1),t.bl.x+=i*s*e,t.br.x+=i*s*e,t.tl.x+=i*s*e,t.tr.x+=i*s*e,this.setTile(r,t)},startWithTarget:function(e){l.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._winSize=l.director.getWinSizeInPixels()}}),l.splitRows=function(e,t){return new l.SplitRows(e,t)},l.SplitRows.create=l.splitRows,l.SplitCols=l.TiledGrid3DAction.extend({_cols:0,_winSize:null,ctor:function(e,t){l.GridAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return this._cols=t,l.TiledGrid3DAction.prototype.initWithDuration.call(this,e,l.size(t,1))},update:function(e){for(var t,i,n=this._gridSize.width,s=this._winSize.height,r=l.p(0,0),a=0;a<n;++a)r.x=a,t=this.originalTile(r),i=1,a%2==0&&(i=-1),t.bl.y+=i*s*e,t.br.y+=i*s*e,t.tl.y+=i*s*e,t.tr.y+=i*s*e,this.setTile(r,t);l.renderer.childrenOrderDirty=!0},startWithTarget:function(e){l.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._winSize=l.director.getWinSizeInPixels()}}),l.splitCols=function(e,t){return new l.SplitCols(e,t)},l.SplitCols.create=l.splitCols,l.PageTurn3D=l.Grid3DAction.extend({getGrid:function(){var e=new l.Grid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect());return e.setNeedDepthTestForBlit(!0),e},clone:function(){var e=new l.PageTurn3D;return e.initWithDuration(this._duration,this._gridSize),e},update:function(e){for(var t=Math.max(0,e-.25),i=-100-t*t*500,n=Math.sqrt(e),s=n>.5?Math.PI/2*n:Math.PI/2*(1-n),r=(2-e)*Math.PI,a=Math.sin(s),o=Math.cos(s),h=this._gridSize,d=l.p(0,0),c=0;c<=h.width;++c)for(var u=0;u<=h.height;++u){d.x=c,d.y=u;var p=this.getOriginalVertex(d);p.x-=this.getGridRect().x;var m=Math.sqrt(p.x*p.x+(p.y-i)*(p.y-i)),_=m*a,g=Math.asin(p.x/m)/a,T=Math.cos(g);g<=Math.PI?p.x=_*Math.sin(g):p.x=0,p.y=m+i-_*(1-T)*a,p.z=_*(1-T)*o,p.x=p.z*Math.sin(r)+p.x*Math.cos(r),p.z=p.z*Math.cos(r)-p.x*Math.cos(r),p.z/=7,p.z<.5&&(p.z=.5),p.x+=this.getGridRect().x,this.setVertex(d,p)}}}),l.pageTurn3D=function(e,t){return new l.PageTurn3D(e,t)},l.PageTurn3D.create=l.pageTurn3D,l.MotionStreak=l.Node.extend({texture:null,fastMode:!1,startingPositionInitialized:!1,_blendFunc:null,_stroke:0,_fadeDelta:0,_minSeg:0,_maxPoints:0,_nuPoints:0,_previousNuPoints:0,_pointVertexes:null,_pointState:null,_vertices:null,_colorPointer:null,_texCoords:null,_verticesBuffer:null,_colorPointerBuffer:null,_texCoordsBuffer:null,_className:"MotionStreak",ctor:function(e,t,i,n,s){l.Node.prototype.ctor.call(this),this._positionR=l.p(0,0),this._blendFunc=new l.BlendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),this.fastMode=!1,this.startingPositionInitialized=!1,this.texture=null,this._stroke=0,this._fadeDelta=0,this._minSeg=0,this._maxPoints=0,this._nuPoints=0,this._previousNuPoints=0,this._pointVertexes=null,this._pointState=null,this._vertices=null,this._colorPointer=null,this._texCoords=null,this._verticesBuffer=null,this._colorPointerBuffer=null,this._texCoordsBuffer=null,void 0!==s&&this.initWithFade(e,t,i,n,s)},getTexture:function(){return this.texture},setTexture:function(e){this.texture!==e&&(this.texture=e)},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){void 0===t?this._blendFunc=e:(this._blendFunc.src=e,this._blendFunc.dst=t)},getOpacity:function(){return l.log("cc.MotionStreak.getOpacity has not been supported."),0},setOpacity:function(e){l.log("cc.MotionStreak.setOpacity has not been supported.")},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},isFastMode:function(){return this.fastMode},setFastMode:function(e){this.fastMode=e},isStartingPositionInitialized:function(){return this.startingPositionInitialized},setStartingPositionInitialized:function(e){this.startingPositionInitialized=e},getStroke:function(){return this._stroke},setStroke:function(e){this._stroke=e},initWithFade:function(e,t,i,n,s){if(!s)throw new Error("cc.MotionStreak.initWithFade(): Invalid filename or texture");l.isString(s)&&(s=l.textureCache.addImage(s)),l.Node.prototype.setPosition.call(this,l.p(0,0)),this.anchorX=0,this.anchorY=0,this.ignoreAnchor=!0,this.startingPositionInitialized=!1,this.fastMode=!0,this._minSeg=-1===t?i/5:t,this._minSeg*=this._minSeg,this._stroke=i,this._fadeDelta=1/e;var r=2+(0|60*e);return this._maxPoints=r,this._nuPoints=0,this._pointState=new Float32Array(r),this._pointVertexes=new Float32Array(2*r),this._vertices=new Float32Array(4*r),this._texCoords=new Float32Array(4*r),this._colorPointer=new Uint8Array(8*r),this._verticesBuffer=gl.createBuffer(),this._texCoordsBuffer=gl.createBuffer(),this._colorPointerBuffer=gl.createBuffer(),this._blendFunc.src=gl.SRC_ALPHA,this._blendFunc.dst=gl.ONE_MINUS_SRC_ALPHA,this.texture=s,this.color=n,this.scheduleUpdate(),gl.bindBuffer(gl.ARRAY_BUFFER,this._verticesBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._vertices,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._texCoordsBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._texCoords,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._colorPointerBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._colorPointer,gl.DYNAMIC_DRAW),!0},tintWithColor:function(e){this.color=e;for(var t=this._colorPointer,i=0,n=2*this._nuPoints;i<n;i++)t[4*i]=e.r,t[4*i+1]=e.g,t[4*i+2]=e.b},reset:function(){this._nuPoints=0},setPosition:function(e,t){this.startingPositionInitialized=!0,void 0===t?(this._positionR.x=e.x,this._positionR.y=e.y):(this._positionR.x=e,this._positionR.y=t)},getPositionX:function(){return this._positionR.x},setPositionX:function(e){this._positionR.x=e,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},getPositionY:function(){return this._positionR.y},setPositionY:function(e){this._positionR.y=e,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},update:function(e){if(this.startingPositionInitialized){this._renderCmd._updateDisplayColor(),e*=this._fadeDelta;var t,i,n,s,r=0,a=this._nuPoints,o=this._pointState,h=this._pointVertexes,d=this._vertices,c=this._colorPointer;for(t=0;t<a;t++)if(o[t]-=e,o[t]<=0)r++;else{i=t-r,r>0?(o[i]=o[t],h[2*i]=h[2*t],h[2*i+1]=h[2*t+1],s=2*t,d[2*(n=2*i)]=d[2*s],d[2*n+1]=d[2*s+1],d[2*(n+1)]=d[2*(s+1)],d[2*(n+1)+1]=d[2*(s+1)+1],s*=4,c[(n*=4)+0]=c[s+0],c[n+1]=c[s+1],c[n+2]=c[s+2],c[n+4]=c[s+4],c[n+5]=c[s+5],c[n+6]=c[s+6]):n=8*i;var u=255*o[i];c[n+3]=u,c[n+7]=u}var p=!0;if((a-=r)>=this._maxPoints)p=!1;else if(a>0){var m=l.pDistanceSQ(l.p(h[2*(a-1)],h[2*(a-1)+1]),this._positionR)<this._minSeg,_=1!==a&&l.pDistanceSQ(l.p(h[2*(a-2)],h[2*(a-2)+1]),this._positionR)<2*this._minSeg;(m||_)&&(p=!1)}if(p){h[2*a]=this._positionR.x,h[2*a+1]=this._positionR.y,o[a]=1;var g=8*a,T=this.getDisplayedColor();c[g]=T.r,c[g+1]=T.g,c[g+2]=T.b,c[g+4]=T.r,c[g+5]=T.g,c[g+6]=T.b,c[g+3]=255,c[g+7]=255,a>0&&this.fastMode&&(a>1?l.vertexLineToPolygon(h,this._stroke,this._vertices,a,1):l.vertexLineToPolygon(h,this._stroke,this._vertices,0,2)),a++}if(this.fastMode||l.vertexLineToPolygon(h,this._stroke,this._vertices,0,a),a&&this._previousNuPoints!==a){var f=1/a,S=this._texCoords;for(t=0;t<a;t++)S[4*t]=0,S[4*t+1]=f*t,S[2*(2*t+1)]=1,S[2*(2*t+1)+1]=f*t;this._previousNuPoints=a}this._nuPoints=a}},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_WEBGL?new l.MotionStreak.WebGLRenderCmd(this):null}}),l.MotionStreak.create=function(e,t,i,n,s){return new l.MotionStreak(e,t,i,n,s)},l.MotionStreak.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._matrix=new l.math.Matrix4,this._matrix.identity(),this._shaderProgram=l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR)},l.MotionStreak.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype),l.MotionStreak.WebGLRenderCmd.prototype.constructor=l.Sprite.WebGLRenderCmd,l.MotionStreak.WebGLRenderCmd.prototype.rendering=function(e){var t=this._node;if(!(t._nuPoints<=1)&&t.texture&&t.texture.isLoaded()){e=e||l._renderContext;var i=this._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._glProgramState.apply(this._matrix),l.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),l.glBindTexture2D(t.texture),e.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),e.enableVertexAttribArray(l.VERTEX_ATTRIB_COLOR),e.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),e.bindBuffer(e.ARRAY_BUFFER,t._verticesBuffer),e.bufferData(e.ARRAY_BUFFER,t._vertices,e.DYNAMIC_DRAW),e.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t._texCoordsBuffer),e.bufferData(e.ARRAY_BUFFER,t._texCoords,e.DYNAMIC_DRAW),e.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t._colorPointerBuffer),e.bufferData(e.ARRAY_BUFFER,t._colorPointer,e.DYNAMIC_DRAW),e.vertexAttribPointer(l.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,0,0),e.drawArrays(e.TRIANGLE_STRIP,0,2*t._nuPoints),l.g_NumberOfDraws++}},l.DrawNode=l.Node.extend({_buffer:null,_blendFunc:null,_lineWidth:1,_drawColor:null,getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(e,t){void 0===t?(this._blendFunc.src=e.src,this._blendFunc.dst=e.dst):(this._blendFunc.src=e,this._blendFunc.dst=t)},setLineWidth:function(e){this._lineWidth=e},getLineWidth:function(){return this._lineWidth},setDrawColor:function(e){var t=this._drawColor;t.r=e.r,t.g=e.g,t.b=e.b,t.a=null==e.a?255:e.a},getDrawColor:function(){return l.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)}}),l.DrawNode.create=function(){return new l.DrawNode},l.DrawNode.TYPE_DOT=0,l.DrawNode.TYPE_SEGMENT=1,l.DrawNode.TYPE_POLY=2,l.game.addEventListener(l.game.EVENT_RENDERER_INITED,function(){function e(e,t,i){i.x=e.x*t,i.y=e.y*t}if(l._renderType===l.game.RENDER_TYPE_CANVAS)l._DrawNodeElement=function(e,t,i,n,s,r,a,o,h){var l=this;l.type=e,l.verts=t||null,l.fillColor=i||null,l.lineWidth=n||0,l.lineColor=s||null,l.lineCap=r||"butt",l.isClosePolygon=a||!1,l.isFill=o||!1,l.isStroke=h||!1},l.extend(l.DrawNode.prototype,{_className:"DrawNodeCanvas",ctor:function(){l.Node.prototype.ctor.call(this);var e=this._renderCmd;e._buffer=this._buffer=[],e._drawColor=this._drawColor=l.color(255,255,255,255),e._blendFunc=this._blendFunc=new l.BlendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),this.init(),this._localBB=new l.Rect},setLocalBB:function(e,t,i,n){var s=this._localBB;void 0===t?(s.x=e.x,s.y=e.y,s.width=e.width,s.height=e.height):(s.x=e,s.y=t,s.width=i,s.height=n)},drawRect:function(e,t,i,n,s){n=null==n?this._lineWidth:n,null==(s=s||this.getDrawColor()).a&&(s.a=255);var r=[e,l.p(t.x,e.y),t,l.p(e.x,t.y)],a=new l._DrawNodeElement(l.DrawNode.TYPE_POLY);a.verts=r,a.lineWidth=n,a.lineColor=s,a.isClosePolygon=!0,a.isStroke=!0,a.lineCap="butt",a.fillColor=i,i&&(null==i.a&&(i.a=255),a.isFill=!0),this._buffer.push(a)},drawCircle:function(e,t,i,n,s,r,a){r=r||this._lineWidth,null==(a=a||this.getDrawColor()).a&&(a.a=255);for(var o=2*Math.PI/n,h=[],d=0;d<=n;d++){var c=d*o,u=t*Math.cos(c+i)+e.x,p=t*Math.sin(c+i)+e.y;h.push(l.p(u,p))}s&&h.push(l.p(e.x,e.y));var m=new l._DrawNodeElement(l.DrawNode.TYPE_POLY);m.verts=h,m.lineWidth=r,m.lineColor=a,m.isClosePolygon=!0,m.isStroke=!0,this._buffer.push(m)},drawQuadBezier:function(e,t,i,n,s,r){s=s||this._lineWidth,null==(r=r||this.getDrawColor()).a&&(r.a=255);for(var a=[],o=0,h=0;h<n;h++){var d=Math.pow(1-o,2)*e.x+2*(1-o)*o*t.x+o*o*i.x,c=Math.pow(1-o,2)*e.y+2*(1-o)*o*t.y+o*o*i.y;a.push(l.p(d,c)),o+=1/n}a.push(l.p(i.x,i.y));var u=new l._DrawNodeElement(l.DrawNode.TYPE_POLY);u.verts=a,u.lineWidth=s,u.lineColor=r,u.isStroke=!0,u.lineCap="round",this._buffer.push(u)},drawCubicBezier:function(e,t,i,n,s,r,a){r=r||this._lineWidth,null==(a=a||this.getDrawColor()).a&&(a.a=255);for(var o=[],h=0,d=0;d<s;d++){var c=Math.pow(1-h,3)*e.x+3*Math.pow(1-h,2)*h*t.x+3*(1-h)*h*h*i.x+h*h*h*n.x,u=Math.pow(1-h,3)*e.y+3*Math.pow(1-h,2)*h*t.y+3*(1-h)*h*h*i.y+h*h*h*n.y;o.push(l.p(c,u)),h+=1/s}o.push(l.p(n.x,n.y));var p=new l._DrawNodeElement(l.DrawNode.TYPE_POLY);p.verts=o,p.lineWidth=r,p.lineColor=a,p.isStroke=!0,p.lineCap="round",this._buffer.push(p)},drawCatmullRom:function(e,t,i,n){this.drawCardinalSpline(e,.5,t,i,n)},drawCardinalSpline:function(e,t,i,n,s){n=n||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);for(var r,a,o=[],h=1/e.length,d=0;d<i+1;d++){var c=d/i;1===c?(r=e.length-1,a=1):a=(c-h*(r=0|c/h))/h;var u=l.cardinalSplineAt(l.getControlPointAt(e,r-1),l.getControlPointAt(e,r-0),l.getControlPointAt(e,r+1),l.getControlPointAt(e,r+2),t,a);o.push(u)}var p=new l._DrawNodeElement(l.DrawNode.TYPE_POLY);p.verts=o,p.lineWidth=n,p.lineColor=s,p.isStroke=!0,p.lineCap="round",this._buffer.push(p)},drawDot:function(e,t,i){null==(i=i||this.getDrawColor()).a&&(i.a=255);var n=new l._DrawNodeElement(l.DrawNode.TYPE_DOT);n.verts=[e],n.lineWidth=t,n.fillColor=i,this._buffer.push(n)},drawDots:function(e,t,i){if(e&&0!=e.length){null==(i=i||this.getDrawColor()).a&&(i.a=255);for(var n=0,s=e.length;n<s;n++)this.drawDot(e[n],t,i)}},drawSegment:function(e,t,i,n){i=i||this._lineWidth,null==(n=n||this.getDrawColor()).a&&(n.a=255);var s=new l._DrawNodeElement(l.DrawNode.TYPE_POLY);s.verts=[e,t],s.lineWidth=2*i,s.lineColor=n,s.isStroke=!0,s.lineCap="round",this._buffer.push(s)},drawPoly_:function(e,t,i,n){i=null==i?this._lineWidth:i,null==(n=n||this.getDrawColor()).a&&(n.a=255);var s=new l._DrawNodeElement(l.DrawNode.TYPE_POLY);s.verts=e,s.fillColor=t,s.lineWidth=i,s.lineColor=n,s.isClosePolygon=!0,s.isStroke=!0,s.lineCap="round",t&&(s.isFill=!0),this._buffer.push(s)},drawPoly:function(e,t,i,n){for(var s=[],r=0;r<e.length;r++)s.push(l.p(e[r].x,e[r].y));return this.drawPoly_(s,t,i,n)},clear:function(){this._buffer.length=0},_createRenderCmd:function(){return new l.DrawNode.CanvasRenderCmd(this)}});else if(l._renderType===l.game.RENDER_TYPE_WEBGL){var t=null,i=[],n=l.p(),s=l.p(),r=new Uint32Array(1),a=l.p(),o=l.p(),h=l.p(),d=l.p(),c=[];l.extend(l.DrawNode.prototype,{_bufferCapacity:0,_vertexCount:0,_offset:0,_occupiedSize:0,_f32Buffer:null,_ui32Buffer:null,_dirty:!1,_className:"DrawNodeWebGL",manualRelease:!1,ctor:function(e,i){l.Node.prototype.ctor.call(this),t||(t=new T(l._renderContext,20*l.DRAWNODE_TOTAL_VERTICES)),this._renderCmd._shaderProgram=l.shaderCache.programForKey(l.SHADER_POSITION_LENGTHTEXTURECOLOR),this._blendFunc=new l.BlendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),this._drawColor=l.color(255,255,255,255),this._bufferCapacity=e||64,this.manualRelease=i,this._dirty=!0},onEnter:function(){l.Node.prototype.onEnter.call(this),this._occupiedSize<this._bufferCapacity&&this._ensureCapacity(this._bufferCapacity)},onExit:function(){this.manualRelease||this.release(),l.Node.prototype.onExit.call(this)},release:function(){this._occupiedSize>0&&(this._vertexCount=0,t.freeBuffer(this._offset,20*this._occupiedSize),this._occupiedSize=0)},_ensureCapacity:function(e){var i=this,n=i._occupiedSize,s=i._offset;if(e>n||i._bufferCapacity>n){var r=Math.max(Math.min(n+n,200),e,i._bufferCapacity);0!==n&&(t.freeBuffer(s,20*n),i._occupiedSize=0);var a=i._offset=t.requestBuffer(20*r);if(a>=0){if(i._occupiedSize=i._bufferCapacity=r,i._f32Buffer=new Float32Array(t.data,a,5*i._occupiedSize),i._ui32Buffer=new Uint32Array(t.data,a,5*i._occupiedSize),0!==n&&s!==a)for(var o=s/4+5*n,h=a/4,d=s/4;d<o;h++,d++)t.dataArray[h]=t.dataArray[d];return!0}return l.warn("Failed to allocate buffer for DrawNode: buffer for "+r+" vertices requested"),!1}return!0},drawRect:function(e,t,n,s,r){s=null==s?this._lineWidth:s,r=r||this._drawColor,i.length=0,i.push(e.x,e.y,t.x,e.y,t.x,t.y,e.x,t.y),null==n?this._drawSegments(i,s,r,!0):this.drawPoly(i,n,s,r),i.length=0},drawCircle:function(e,t,r,a,o,h,l){h=h||this._lineWidth,l=l||this._drawColor;var d,c,u=2*Math.PI/a;for(i.length=0,d=0;d<=a;d++){var p=d*u,m=t*Math.cos(p+r)+e.x,_=t*Math.sin(p+r)+e.y;i.push(m,_)}for(o&&i.push(e.x,e.y),h*=.5,d=0,c=i.length-2;d<c;d+=2)n.x=i[d],n.y=i[d+1],s.x=i[d+2],s.y=i[d+3],this.drawSegment(n,s,h,l);i.length=0},drawQuadBezier:function(e,t,n,s,r,a){r=r||this._lineWidth,a=a||this._drawColor;var o=0;i.length=0;for(var h=0;h<s;h++){var l=Math.pow(1-o,2)*e.x+2*(1-o)*o*t.x+o*o*n.x,d=Math.pow(1-o,2)*e.y+2*(1-o)*o*t.y+o*o*n.y;i.push(l,d),o+=1/s}i.push(n.x,n.y),this._drawSegments(i,r,a,!1),i.length=0},drawCubicBezier:function(e,t,n,s,r,a,o){a=a||this._lineWidth,o=o||this._drawColor;var h=0;i.length=0;for(var l=0;l<r;l++){var d=Math.pow(1-h,3)*e.x+3*Math.pow(1-h,2)*h*t.x+3*(1-h)*h*h*n.x+h*h*h*s.x,c=Math.pow(1-h,3)*e.y+3*Math.pow(1-h,2)*h*t.y+3*(1-h)*h*h*n.y+h*h*h*s.y;i.push(d,c),h+=1/r}i.push(s.x,s.y),this._drawSegments(i,a,o,!1),i.length=0},drawCatmullRom:function(e,t,i,n){this.drawCardinalSpline(e,.5,t,i,n)},drawCardinalSpline:function(e,t,r,a,o){a=a||this._lineWidth,o=o||this._drawColor;var h,d,c=1/e.length;i.length=0;for(var u=0;u<r+1;u++){var p=u/r;1===p?(h=e.length-1,d=1):d=(p-c*(h=0|p/c))/c,l.cardinalSplineAt(l.getControlPointAt(e,h-1),l.getControlPointAt(e,h-0),l.getControlPointAt(e,h+1),l.getControlPointAt(e,h+2),t,d,n),i.push(n.x,n.y)}a*=.5;for(var m=0,_=i.length-2;m<_;m+=2)n.x=i[m],n.y=i[m+1],s.x=i[m+2],s.y=i[m+3],this.drawSegment(n,s,a,o);i.length=0},drawDots:function(e,t,i){if(e&&0!==e.length){i=i||this._drawColor;for(var n=0,s=e.length;n<s;n++)this.drawDot(e[n],t,i)}},_render:function(){var e=l._renderContext;this._offset<0||this._vertexCount<=0||(this._dirty?(t.updateSubData(this._offset,this._f32Buffer),this._dirty=!1):e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.enableVertexAttribArray(l.VERTEX_ATTRIB_POSITION),e.enableVertexAttribArray(l.VERTEX_ATTRIB_COLOR),e.enableVertexAttribArray(l.VERTEX_ATTRIB_TEX_COORDS),e.vertexAttribPointer(l.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,20,0),e.vertexAttribPointer(l.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,20,8),e.vertexAttribPointer(l.VERTEX_ATTRIB_TEX_COORDS,2,e.FLOAT,!1,20,12),e.drawArrays(e.TRIANGLES,this._offset/20,this._vertexCount),l.incrementGLDraws(1))},appendVertexData:function(e,t,i,n,s){var a=this._f32Buffer,o=5*this._vertexCount;a[o]=e,a[o+1]=t,r[0]=i.a<<24|i.b<<16|i.g<<8|i.r,this._ui32Buffer[o+2]=r[0],a[o+3]=n,a[o+4]=s,this._vertexCount++},drawDot:function(e,t,i){null==(i=i||this._drawColor).a&&(i.a=255);var n=e.x-t,s=e.y-t,r=e.x+t,a=e.y+t;this._ensureCapacity(this._vertexCount+6)&&(this.appendVertexData(n,s,i,-1,-1),this.appendVertexData(n,a,i,-1,1),this.appendVertexData(r,a,i,1,1),this.appendVertexData(n,s,i,-1,-1),this.appendVertexData(r,a,i,1,1),this.appendVertexData(r,s,i,1,-1),this._dirty=!0)},drawSegment:function(t,i,n,s){null==(s=s||this.getDrawColor()).a&&(s.a=255),n=n||.5*this._lineWidth;if(this._ensureCapacity(this._vertexCount+18)){var r=t,c=i;a.x=r.y-c.y,a.y=c.x-r.x,l.pNormalizeIn(a),o.x=-a.y,o.y=a.x,e(a,n,h),e(o,n,d);var u=c.x-h.x-d.x,p=c.y-h.y-d.y,m=-(a.x+o.x),_=-(a.y+o.y),g=c.x+h.x-d.x,T=c.y+h.y-d.y,f=a.x-o.x,S=a.y-o.y,w=c.x-h.x,v=c.y-h.y,L=-a.x,M=-a.y,C=c.x+h.x,y=c.y+h.y,B=a.x,F=a.y,E=r.x-h.x,P=r.y-h.y,b=L,A=M,O=r.x+h.x,I=r.y+h.y,R=a.x,D=a.y,x=r.x-h.x+d.x,N=r.y-h.y+d.y,G=o.x-a.x,W=o.y-a.y,k=r.x+h.x+d.x,U=r.y+h.y+d.y,H=a.x+o.x,V=a.y+o.y;this.appendVertexData(u,p,s,m,_),this.appendVertexData(g,T,s,f,S),this.appendVertexData(w,v,s,L,M),this.appendVertexData(C,y,s,B,F),this.appendVertexData(g,T,s,f,S),this.appendVertexData(w,v,s,L,M),this.appendVertexData(C,y,s,B,F),this.appendVertexData(E,P,s,b,A),this.appendVertexData(w,v,s,L,M),this.appendVertexData(C,y,s,B,F),this.appendVertexData(E,P,s,b,A),this.appendVertexData(O,I,s,R,D),this.appendVertexData(x,N,s,G,W),this.appendVertexData(E,P,s,b,A),this.appendVertexData(O,I,s,R,D),this.appendVertexData(x,N,s,G,W),this.appendVertexData(k,U,s,H,V),this.appendVertexData(O,I,s,R,D),this._dirty=!0}},drawPoly:function(e,t,n,s){if("object"==typeof e[0]){i.length=0;for(f=0;f<e.length;f++)i.push(e[f].x,e[f].y);e=i}if(null!=t){null==t.a&&(t.a=255),null==s.a&&(s.a=255),n=null==n?this._lineWidth:n,n*=.5;var r,o,d,u,p,m,_,g,T,f,S=e.length;for(c.length=0,f=0;f<S;f+=2)r=e[(f-2+S)%S],o=e[(f-1+S)%S],d=e[f],u=e[f+1],p=e[(f+2)%S],m=e[(f+3)%S],a.x=o-u,a.y=d-r,h.x=u-m,h.y=p-d,l.pNormalizeIn(a),l.pNormalizeIn(h),_=a.x*h.x+a.y*h.y+1,g=(a.x+h.x)/_,T=(a.y+h.y)/_,c.push(g,T,h.x,h.y);var w=n>0,v=3*(3*(S/=2)-2);if(this._ensureCapacity(this._vertexCount+v)){var L=0==w?.5:0;for(f=0;f<S-2;f++)r=e[0]-c[0]*L,o=e[1]-c[1]*L,d=e[2*f+2]-c[4*(f+1)]*L,u=e[2*f+3]-c[4*(f+1)+1]*L,p=e[2*f+4]-c[4*(f+2)]*L,m=e[2*f+5]-c[4*(f+2)+1]*L,this.appendVertexData(r,o,t,0,0),this.appendVertexData(d,u,t,0,0),this.appendVertexData(p,m,t,0,0);var M,C,y,B,F,E,P,b,A,O,I,R,D=w?n:.5,x=w?s:t;for(f=0;f<S;f++){var N=(f+1)%S;r=e[2*f],o=e[2*f+1],d=e[2*N],u=e[2*N+1],a.x=c[4*f+2],a.y=c[4*f+3],h.x=w?-a.x:0,h.y=w?-a.y:0,F=r-(M=c[4*f])*D,E=o-(C=c[4*f+1])*D,P=d-(y=c[4*N])*D,b=u-(B=c[4*N+1])*D,A=r+M*D,O=o+C*D,I=d+y*D,R=u+B*D,this.appendVertexData(F,E,x,h.x,h.y),this.appendVertexData(P,b,x,h.x,h.y),this.appendVertexData(I,R,x,a.x,a.y),this.appendVertexData(F,E,x,h.x,h.y),this.appendVertexData(A,O,x,a.x,a.y),this.appendVertexData(I,R,x,a.x,a.y)}c.length=0,i.length=0,this._dirty=!0}}else this._drawSegments(e,n,s,!0)},_drawSegments:function(e,t,i,n){if(!((t=null==t?this._lineWidth:t)<=0)){null==(i=i||this._drawColor).a&&(i.a=255),t*=.5;var s,r,o,d,u,p,m,_,g,T,f=e.length;for(c.length=0,T=0;T<f;T+=2)s=e[(T-2+f)%f],r=e[(T-1+f)%f],o=e[T],d=e[T+1],u=e[(T+2)%f],p=e[(T+3)%f],a.x=r-d,a.y=o-s,h.x=d-p,h.y=u-o,l.pNormalizeIn(a),l.pNormalizeIn(h),m=a.x*h.x+a.y*h.y+1,_=(a.x+h.x)/m,g=(a.y+h.y)/m,c.push(_,g,h.x,h.y);var S=3*(3*(f/=2)-2);if(this._ensureCapacity(this._vertexCount+S)){var w,v,L,M,C,y,B,F,E,P,b,A,O=n?f:f-1;for(T=0;T<O;T++){var I=(T+1)%f;s=e[2*T],r=e[2*T+1],o=e[2*I],d=e[2*I+1],a.x=c[4*T+2],a.y=c[4*T+3],C=s-(w=c[4*T])*t,y=r-(v=c[4*T+1])*t,B=o-(L=c[4*I])*t,F=d-(M=c[4*I+1])*t,E=s+w*t,P=r+v*t,b=o+L*t,A=d+M*t,this.appendVertexData(C,y,i,-a.x,-a.y),this.appendVertexData(B,F,i,-a.x,-a.y),this.appendVertexData(b,A,i,a.x,a.y),this.appendVertexData(C,y,i,-a.x,-a.y),this.appendVertexData(E,P,i,a.x,a.y),this.appendVertexData(b,A,i,a.x,a.y)}c.length=0,this._dirty=!0}}},clear:function(){this.release(),this._dirty=!0},_createRenderCmd:function(){return new l.DrawNode.WebGLRenderCmd(this)}})}}),l.DrawNode.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._buffer=null,this._drawColor=null,this._blendFunc=null},l.DrawNode.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype),l.DrawNode.CanvasRenderCmd.prototype.constructor=l.DrawNode.CanvasRenderCmd,l.DrawNode.CanvasRenderCmd.prototype.getLocalBB=function(){return this._node._localBB},l.extend(l.DrawNode.CanvasRenderCmd.prototype,{rendering:function(e,t,i){var n=e||l._renderContext,s=(n.getContext(),this._node,this._displayedOpacity/255);if(0!==s){n.setTransform(this._worldTransform,t,i),n.setGlobalAlpha(s),this._blendFunc&&this._blendFunc.src===l.SRC_ALPHA&&this._blendFunc.dst===l.ONE&&n.setCompositeOperation("lighter");for(var r=this._buffer,a=0,o=r.length;a<o;a++){var h=r[a];switch(h.type){case l.DrawNode.TYPE_DOT:this._drawDot(n,h,t,i);break;case l.DrawNode.TYPE_SEGMENT:this._drawSegment(n,h,t,i);break;case l.DrawNode.TYPE_POLY:this._drawPoly(n,h,t,i)}}}},_drawDot:function(e,t){var i=t.fillColor,n=t.verts[0],s=t.lineWidth,r=e.getContext();e.setFillStyle("rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b)+","+i.a/255+")"),r.beginPath(),r.arc(n.x,-n.y,s,0,2*Math.PI,!1),r.closePath(),r.fill()},_drawSegment:function(e,t,i){var n=t.lineColor,s=t.verts[0],r=t.verts[1],a=t.lineWidth,o=t.lineCap,h=e.getContext();e.setStrokeStyle("rgba("+(0|n.r)+","+(0|n.g)+","+(0|n.b)+","+n.a/255+")"),h.lineWidth=a*i,h.beginPath(),h.lineCap=o,h.moveTo(s.x,-s.y),h.lineTo(r.x,-r.y),h.stroke()},_drawPoly:function(e,t,i){var n=t.verts,s=t.lineCap;if(null!=n){var r=t.fillColor,a=t.lineWidth,o=t.lineColor,h=t.isClosePolygon,l=t.isFill,d=t.isStroke,c=e.getContext(),u=n[0];c.lineCap=s,r&&e.setFillStyle("rgba("+(0|r.r)+","+(0|r.g)+","+(0|r.b)+","+r.a/255+")"),a&&(c.lineWidth=a*i),o&&e.setStrokeStyle("rgba("+(0|o.r)+","+(0|o.g)+","+(0|o.b)+","+o.a/255+")"),c.beginPath(),c.moveTo(u.x,-u.y);for(var p=1,m=n.length;p<m;p++)c.lineTo(n[p].x,-n[p].y);h&&c.closePath(),l&&c.fill(),d&&c.stroke()}}}),l.DrawNode.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._matrix=new l.math.Matrix4,this._matrix.identity()},l.DrawNode.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype),l.DrawNode.WebGLRenderCmd.prototype.constructor=l.DrawNode.WebGLRenderCmd,l.DrawNode.WebGLRenderCmd.prototype.rendering=function(e){var t=this._node;if(t._vertexCount>0){var i=this._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,l.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),this._glProgramState.apply(this._matrix),t._render()}},l.stencilBits=-1,l.ClippingNode=l.Node.extend({inverted:!1,_alphaThreshold:0,_stencil:null,_className:"ClippingNode",_originStencilProgram:null,ctor:function(e){e=e||null,l.Node.prototype.ctor.call(this),this._stencil=e,e&&(this._originStencilProgram=e.getShaderProgram()),this.alphaThreshold=1,this.inverted=!1,this._renderCmd.initStencilBits()},onEnter:function(){l.Node.prototype.onEnter.call(this),this._stencil&&this._stencil._performRecursive(l.Node._stateCallbackType.onEnter)},onEnterTransitionDidFinish:function(){l.Node.prototype.onEnterTransitionDidFinish.call(this),this._stencil&&this._stencil._performRecursive(l.Node._stateCallbackType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._stencil._performRecursive(l.Node._stateCallbackType.onExitTransitionDidStart),l.Node.prototype.onExitTransitionDidStart.call(this)},onExit:function(){this._stencil._performRecursive(l.Node._stateCallbackType.onExit),l.Node.prototype.onExit.call(this)},visit:function(e){this._renderCmd.clippingVisit(e&&e._renderCmd)},_visitChildren:function(){l.renderer;this._reorderChildDirty&&this.sortAllChildren();for(var e,t=this._children,i=0,n=t.length;i<n;i++)(e=t[i])&&e._visible&&e.visit(this);this._renderCmd._dirtyFlag=0},getAlphaThreshold:function(){return this._alphaThreshold},setAlphaThreshold:function(e){1===e&&e!==this._alphaThreshold&&this._renderCmd.resetProgramByStencil(),this._alphaThreshold=e},isInverted:function(){return this.inverted},setInverted:function(e){this.inverted=e},getStencil:function(){return this._stencil},setStencil:function(e){this._stencil!==e&&(e&&(this._originStencilProgram=e.getShaderProgram()),this._renderCmd.setStencil(e))},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.ClippingNode.CanvasRenderCmd(this):new l.ClippingNode.WebGLRenderCmd(this)}});var d=l.ClippingNode.prototype;d.stencil,l.defineGetterSetter(d,"stencil",d.getStencil,d.setStencil),d.alphaThreshold,l.defineGetterSetter(d,"alphaThreshold",d.getAlphaThreshold,d.setAlphaThreshold),l.ClippingNode.create=function(e){return new l.ClippingNode(e)},function(){l.ClippingNode.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!1,this._godhelpme=!1,this._clipElemType=!1,this._rendererSaveCmd=new l.CustomRenderCmd(this,this._saveCmdCallback),this._rendererClipCmd=new l.CustomRenderCmd(this,this._clipCmdCallback),this._rendererRestoreCmd=new l.CustomRenderCmd(this,this._restoreCmdCallback)};var e=l.ClippingNode.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.ClippingNode.CanvasRenderCmd,e.resetProgramByStencil=function(){},e.initStencilBits=function(){},e.setStencil=function(e){if(null!=e)if(this._node._stencil=e,e instanceof l.DrawNode){if(e._buffer)for(var t=0;t<e._buffer.length;t++)e._buffer[t].isFill=!1,e._buffer[t].isStroke=!1;e._renderCmd.rendering=function(e,t,i){},e._renderCmd._canUseDirtyRegion=!0,this._rendererSaveCmd._canUseDirtyRegion=!0,this._rendererClipCmd._canUseDirtyRegion=!0,this._rendererRestoreCmd._canUseDirtyRegion=!0}else e._parent=this._node},e._saveCmdCallback=function(e,t,i){var n=e||l._renderContext,s=n.getContext();if(this._clipElemType){var r=l.ClippingNode.CanvasRenderCmd._getSharedCache(),a=s.canvas;r.width=a.width,r.height=a.height,r.getContext("2d").drawImage(a,0,0)}else n.save(),n.setTransform(this._worldTransform,t,i),this._node.inverted&&(s.beginPath(),s.rect(0,0,s.canvas.width,-s.canvas.height),s.clip())},e._setStencilCompositionOperation=function(e){if(e){var t=this._node;if(e._renderCmd&&e._renderCmd._blendFuncStr&&(e._renderCmd._blendFuncStr=t.inverted?"destination-out":"destination-in"),e._children)for(var i=e._children,n=0,s=i.length;n<s;n++)this._setStencilCompositionOperation(i[n])}},e._clipCmdCallback=function(e){var t=this._node,i=(e||l._renderContext).getContext();if(this._clipElemType)this._setStencilCompositionOperation(t._stencil);else{var n=this._node._stencil;if(n instanceof l.DrawNode){i.beginPath();var s=n._renderCmd._transform;i.transform(s.a,s.b,s.c,s.d,s.tx,-s.ty);for(var r=0;r<n._buffer.length;r++){var a=n._buffer[r].verts,o=a[0];i.moveTo(o.x,-o.y);for(var h=a.length-1;h>0;h--)i.lineTo(a[h].x,-a[h].y)}}i.clip()}},e._restoreCmdCallback=function(e){var t=l.ClippingNode.CanvasRenderCmd._getSharedCache(),i=e||l._renderContext,n=i.getContext();this._clipElemType?(n.save(),n.setTransform(1,0,0,1,0,0),n.globalCompositeOperation="destination-over",n.drawImage(t,0,0),n.restore(),this._dirtyFlag=0):i.restore()},e.transform=function(e,t){this.originTransform(e,t);var i=this._node;i._stencil&&i._stencil._renderCmd&&(i._stencil._renderCmd.transform(this,!0),i._stencil._dirtyFlag&=~l.Node._dirtyFlags.transformDirty)},e._cangodhelpme=function(e){return!0!==e&&!1!==e||(l.ClippingNode.CanvasRenderCmd.prototype._godhelpme=e),l.ClippingNode.CanvasRenderCmd.prototype._godhelpme},e.clippingVisit=function(e){var t=this._node;if(e=e||this.getParentRenderCmd(),this.visit(e),this._clipElemType=!(!this._cangodhelpme()&&t._stencil instanceof l.DrawNode),t._stencil&&t._stencil.visible){if(l.renderer.pushRenderCommand(this._rendererSaveCmd),this._clipElemType?t._visitChildren():t._stencil.visit(t),l.renderer.pushRenderCommand(this._rendererClipCmd),this._clipElemType)t._stencil.visit(t);else{this._cangodhelpme(!0);var i,n=t._children,s=n.length;if(s>0)for(t.sortAllChildren(),i=0;i<s;i++)n[i].visit(t);this._cangodhelpme(!1)}l.renderer.pushRenderCommand(this._rendererRestoreCmd),this._dirtyFlag=0}else this.inverted&&t._visitChildren()},l.ClippingNode.CanvasRenderCmd._sharedCache=null,l.ClippingNode.CanvasRenderCmd._getSharedCache=function(){return l.ClippingNode.CanvasRenderCmd._sharedCache||(l.ClippingNode.CanvasRenderCmd._sharedCache=document.createElement("canvas"))}}(),function(){l.ClippingNode.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!1,this._beforeVisitCmd=new l.CustomRenderCmd(this,this._onBeforeVisit),this._afterDrawStencilCmd=new l.CustomRenderCmd(this,this._onAfterDrawStencil),this._afterVisitCmd=new l.CustomRenderCmd(this,this._onAfterVisit),this._currentStencilEnabled=null,this._mask_layer_le=null};var e=l.ClippingNode.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.ClippingNode.WebGLRenderCmd,l.ClippingNode.WebGLRenderCmd._init_once=null,l.ClippingNode.WebGLRenderCmd._visit_once=null,l.ClippingNode.WebGLRenderCmd._layer=-1,e.initStencilBits=function(){l.ClippingNode.WebGLRenderCmd._init_once=!0,l.ClippingNode.WebGLRenderCmd._init_once&&(l.stencilBits=l._renderContext.getParameter(l._renderContext.STENCIL_BITS),l.stencilBits<=0&&l.log("Stencil buffer is not enabled."),l.ClippingNode.WebGLRenderCmd._init_once=!1)},e.transform=function(e,t){var i=this._node;this.originTransform(e,t),i._stencil&&(i._stencil._renderCmd.transform(this,!0),i._stencil._dirtyFlag&=~l.Node._dirtyFlags.transformDirty)},e.clippingVisit=function(e){var t=this._node;if(e=e||this.getParentRenderCmd(),this.visit(e),l.stencilBits<1)t._visitChildren();else if(t._stencil&&t._stencil.visible){if(l.ClippingNode.WebGLRenderCmd._layer+1===l.stencilBits)return l.ClippingNode.WebGLRenderCmd._visit_once=!0,l.ClippingNode.WebGLRenderCmd._visit_once&&(l.log("Nesting more than "+l.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its children."),l.ClippingNode.WebGLRenderCmd._visit_once=!1),void t._visitChildren();l.renderer.pushRenderCommand(this._beforeVisitCmd),t._stencil.visit(t),l.renderer.pushRenderCommand(this._afterDrawStencilCmd);var i=t._children;if(i&&i.length>0){var n=i.length;t.sortAllChildren();for(var s=0;s<n;s++)i[s].visit(t)}l.renderer.pushRenderCommand(this._afterVisitCmd),this._dirtyFlag=0}else t.inverted&&t._visitChildren()},e.setStencil=function(e){var t=this._node;t._stencil&&(t._stencil._parent=null),t._stencil=e,t._stencil&&(t._stencil._parent=t)},e.resetProgramByStencil=function(){var e=this._node;if(e._stencil){var t=e._originStencilProgram;a(e._stencil,t)}},e._onBeforeVisit=function(e){var t=e||l._renderContext,i=this._node;l.ClippingNode.WebGLRenderCmd._layer++;var n=1<<l.ClippingNode.WebGLRenderCmd._layer,s=n-1;if(this._mask_layer_le=n|s,this._currentStencilEnabled=t.isEnabled(t.STENCIL_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.enable(t.STENCIL_TEST),t.depthMask(!1),t.stencilFunc(t.NEVER,n,n),t.stencilOp(t.REPLACE,t.KEEP,t.KEEP),t.stencilMask(n),t.clear(t.STENCIL_BUFFER_BIT),i.alphaThreshold<1){var r=l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLORALPHATEST);l.glUseProgram(r.getProgram()),r.setUniformLocationWith1f(l.UNIFORM_ALPHA_TEST_VALUE_S,i.alphaThreshold),r.setUniformLocationWithMatrix4fv(l.UNIFORM_MVMATRIX_S,l.renderer.mat4Identity.mat),l.setProgram(i._stencil,r)}},e._onAfterDrawStencil=function(e){var t=e||l._renderContext;t.depthMask(!0),t.stencilFunc(this._node.inverted?t.NOTEQUAL:t.EQUAL,this._mask_layer_le,this._mask_layer_le),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e._onAfterVisit=function(e){var t=e||l._renderContext;if(l.ClippingNode.WebGLRenderCmd._layer--,this._currentStencilEnabled){var i=1<<l.ClippingNode.WebGLRenderCmd._layer,n=i|i-1;t.stencilMask(i),t.stencilFunc(t.EQUAL,n,n)}else t.disable(t.STENCIL_TEST)}}(),l.IMEKeyboardNotificationInfo=function(e,t,i){this.begin=e||l.rect(0,0,0,0),this.end=t||l.rect(0,0,0,0),this.duration=i||0},l.IMEDelegate=l.Class.extend({ctor:function(){l.imeDispatcher.addDelegate(this)},removeDelegate:function(){l.imeDispatcher.removeDelegate(this)},attachWithIME:function(){return l.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return l.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!1},didAttachWithIME:function(){},canDetachWithIME:function(){return!1},didDetachWithIME:function(){},insertText:function(e,t){},deleteBackward:function(){},getContentText:function(){return""},keyboardWillShow:function(e){},keyboardDidShow:function(e){},keyboardWillHide:function(e){},keyboardDidHide:function(e){}}),l.IMEDispatcher=l.Class.extend({_domInputControl:null,impl:null,_currentInputString:"",_lastClickPosition:null,ctor:function(){this.impl=new l.IMEDispatcher.Impl,this._lastClickPosition=l.p(0,0)},init:function(){if(!l.sys.isMobile){this._domInputControl=l.$("#imeDispatcherInput"),this._domInputControl||(this._domInputControl=l.$new("input"),this._domInputControl.setAttribute("type","text"),this._domInputControl.setAttribute("id","imeDispatcherInput"),this._domInputControl.resize(0,0),this._domInputControl.translates(0,0),this._domInputControl.style.opacity="0",this._domInputControl.style.fontSize="1px",this._domInputControl.setAttribute("tabindex",2),this._domInputControl.style.position="absolute",this._domInputControl.style.top=0,this._domInputControl.style.left=0,document.body.appendChild(this._domInputControl));var e=this;this._domInputControl.addEventListener("input",function(){e._processDomInputString(e._domInputControl.value)},!1),this._domInputControl.addEventListener("keydown",function(t){t.keyCode===l.KEY.tab?(t.stopPropagation(),t.preventDefault()):t.keyCode===l.KEY.enter&&(e.dispatchInsertText("\n",1),t.stopPropagation(),t.preventDefault())},!1),/msie/i.test(navigator.userAgent)&&this._domInputControl.addEventListener("keyup",function(t){t.keyCode===l.KEY.backspace&&e._processDomInputString(e._domInputControl.value)},!1),window.addEventListener("mousedown",function(t){var i=t.pageX||0,n=t.pageY||0;e._lastClickPosition.x=i,e._lastClickPosition.y=n},!1)}},_processDomInputString:function(e){var t,i,n=this._currentInputString.length<e.length?this._currentInputString.length:e.length;for(i=0;i<n&&e[i]===this._currentInputString[i];i++);var s=this._currentInputString.length-i,r=e.length-i;for(t=0;t<s;t++)this.dispatchDeleteBackward();for(t=0;t<r;t++)this.dispatchInsertText(e[i+t],1);this._currentInputString=e},dispatchInsertText:function(e,t){!this.impl||!e||t<=0||this.impl._delegateWithIme&&this.impl._delegateWithIme.insertText(e,t)},dispatchDeleteBackward:function(){this.impl&&this.impl._delegateWithIme&&this.impl._delegateWithIme.deleteBackward()},getContentText:function(){if(this.impl&&this.impl._delegateWithIme){var e=this.impl._delegateWithIme.getContentText();return e||""}return""},dispatchKeyboardWillShow:function(e){if(this.impl)for(var t=0;t<this.impl._delegateList.length;t++){var i=this.impl._delegateList[t];i&&i.keyboardWillShow(e)}},dispatchKeyboardDidShow:function(e){if(this.impl)for(var t=0;t<this.impl._delegateList.length;t++){var i=this.impl._delegateList[t];i&&i.keyboardDidShow(e)}},dispatchKeyboardWillHide:function(e){if(this.impl)for(var t=0;t<this.impl._delegateList.length;t++){var i=this.impl._delegateList[t];i&&i.keyboardWillHide(e)}},dispatchKeyboardDidHide:function(e){if(this.impl)for(var t=0;t<this.impl._delegateList.length;t++){var i=this.impl._delegateList[t];i&&i.keyboardDidHide(e)}},addDelegate:function(e){e&&this.impl&&(this.impl._delegateList.indexOf(e)>-1||this.impl._delegateList.splice(0,0,e))},attachDelegateWithIME:function(e){if(!this.impl||!e)return!1;if(-1===this.impl._delegateList.indexOf(e))return!1;if(this.impl._delegateWithIme){if(!this.impl._delegateWithIme.canDetachWithIME()||!e.canAttachWithIME())return!1;var t=this.impl._delegateWithIme;return this.impl._delegateWithIme=null,t.didDetachWithIME(),this._focusDomInput(e),!0}return!!e.canAttachWithIME()&&(this._focusDomInput(e),!0)},_focusDomInput:function(e){if(l.sys.isMobile){this.impl._delegateWithIme=e,e.didAttachWithIME(),this._currentInputString=e.string||"";var t,i=e.getTipMessage?e.getTipMessage():"please enter your word:",n=window.Window;null!=(t=n&&n.prototype.prompt&&n.prototype.prompt!=prompt?n.prototype.prompt.call(window,i,this._currentInputString):prompt(i,this._currentInputString))&&this._processDomInputString(t),this.dispatchInsertText("\n",1)}else this.impl._delegateWithIme=e,this._currentInputString=e.string||"",e.didAttachWithIME(),this._domInputControl.focus(),this._domInputControl.value=this._currentInputString,this._domInputControlTranslate()},_domInputControlTranslate:function(){/msie/i.test(navigator.userAgent)?(this._domInputControl.style.left=this._lastClickPosition.x+"px",this._domInputControl.style.top=this._lastClickPosition.y+"px"):this._domInputControl.translates(this._lastClickPosition.x,this._lastClickPosition.y)},detachDelegateWithIME:function(e){return!(!this.impl||!e)&&(this.impl._delegateWithIme===e&&(!!e.canDetachWithIME()&&(this.impl._delegateWithIme=null,e.didDetachWithIME(),l._canvas.focus(),!0)))},removeDelegate:function(e){this.impl&&e&&-1!==this.impl._delegateList.indexOf(e)&&(this.impl._delegateWithIme&&e===this.impl._delegateWithIme&&(this.impl._delegateWithIme=null),l.arrayRemoveObject(this.impl._delegateList,e))},processKeycode:function(e){e<32?e===l.KEY.backspace?this.dispatchDeleteBackward():e===l.KEY.enter?this.dispatchInsertText("\n",1):e===l.KEY.tab||l.KEY.escape:e<255&&this.dispatchInsertText(String.fromCharCode(e),1)}}),l.IMEDispatcher.Impl=l.Class.extend({_delegateWithIme:null,_delegateList:null,ctor:function(){this._delegateList=[]},findDelegate:function(e){for(var t=0;t<this._delegateList.length;t++)if(this._delegateList[t]===e)return t;return null}}),l.imeDispatcher=new l.IMEDispatcher,document.body?l.imeDispatcher.init():window.addEventListener("load",function(){l.imeDispatcher.init()},!1),l.TextFieldDelegate=l.Class.extend({onTextFieldAttachWithIME:function(e){return!1},onTextFieldDetachWithIME:function(e){return!1},onTextFieldInsertText:function(e,t,i){return!1},onTextFieldDeleteBackward:function(e,t,i){return!1},onDraw:function(e){return!1}}),l.TextFieldTTF=l.LabelTTF.extend({delegate:null,colorSpaceHolder:null,_colorText:null,_lens:null,_inputText:"",_placeHolder:"",_charCount:0,_className:"TextFieldTTF",ctor:function(e,t,i,n,s){this.colorSpaceHolder=l.color(127,127,127),this._colorText=l.color(255,255,255,255),l.LabelTTF.prototype.ctor.call(this),void 0!==s?(this.initWithPlaceHolder("",t,i,n,s),e&&this.setPlaceHolder(e)):void 0===n&&void 0!==i&&(this.initWithString("",arguments[1],arguments[2]),e&&this.setPlaceHolder(e))},onEnter:function(){l.LabelTTF.prototype.onEnter.call(this),l.imeDispatcher.addDelegate(this)},onExit:function(){l.LabelTTF.prototype.onExit.call(this),l.imeDispatcher.removeDelegate(this)},getDelegate:function(){return this.delegate},setDelegate:function(e){this.delegate=e},getCharCount:function(){return this._charCount},getColorSpaceHolder:function(){return l.color(this.colorSpaceHolder)},setColorSpaceHolder:function(e){this.colorSpaceHolder.r=e.r,this.colorSpaceHolder.g=e.g,this.colorSpaceHolder.b=e.b,this.colorSpaceHolder.a=l.isUndefined(e.a)?255:e.a,this._inputText.length||this.setColor(this.colorSpaceHolder)},setTextColor:function(e){this._colorText.r=e.r,this._colorText.g=e.g,this._colorText.b=e.b,this._colorText.a=l.isUndefined(e.a)?255:e.a,this._inputText.length&&this.setColor(this._colorText)},initWithPlaceHolder:function(e,t,i,n,s){switch(arguments.length){case 5:return e&&this.setPlaceHolder(e),this.initWithString(this._placeHolder,n,s,t,i);case 3:return e&&this.setPlaceHolder(e),this.initWithString(this._placeHolder,arguments[1],arguments[2]);default:throw new Error("Argument must be non-nil ")}},setString:function(e){e=String(e),this._inputText=e||"",this._inputText.length?(l.LabelTTF.prototype.setString.call(this,this._inputText),this.setColor(this._colorText)):(l.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder)),l._renderType===l.game.RENDER_TYPE_CANVAS&&this._renderCmd._updateTexture(),this._charCount=this._inputText.length},getString:function(){return this._inputText},setPlaceHolder:function(e){this._placeHolder=e||"",this._inputText.length||(l.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder))},getPlaceHolder:function(){return this._placeHolder},draw:function(e){var t=e||l._renderContext;this.delegate&&this.delegate.onDraw(this)||l.LabelTTF.prototype.draw.call(this,t)},attachWithIME:function(){return l.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return l.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!this.delegate||!this.delegate.onTextFieldAttachWithIME(this)},didAttachWithIME:function(){},canDetachWithIME:function(){return!this.delegate||!this.delegate.onTextFieldDetachWithIME(this)},didDetachWithIME:function(){},deleteBackward:function(){var e=this._inputText.length;if(0!==e){if(!this.delegate||!this.delegate.onTextFieldDeleteBackward(this,this._inputText[e-1],1))return e<=1?(this._inputText="",this._charCount=0,l.LabelTTF.prototype.setString.call(this,this._placeHolder),void this.setColor(this.colorSpaceHolder)):void(this.string=this._inputText.substring(0,e-1))}},removeDelegate:function(){l.imeDispatcher.removeDelegate(this)},_tipMessage:"please enter your word:",setTipMessage:function(e){null!=e&&(this._tipMessage=e)},getTipMessage:function(){return this._tipMessage},insertText:function(e,t){var i=e,n=i.indexOf("\n");if(n>-1&&(i=i.substring(0,n)),i.length>0){if(this.delegate&&this.delegate.onTextFieldInsertText(this,i,i.length))return;var s=this._inputText+i;this._charCount=s.length,this.string=s}-1!==n&&(this.delegate&&this.delegate.onTextFieldInsertText(this,"\n",1)||this.detachWithIME())},getContentText:function(){return this._inputText},keyboardWillShow:function(e){},keyboardDidShow:function(e){},keyboardWillHide:function(e){},keyboardDidHide:function(e){}});var d=l.TextFieldTTF.prototype;d.charCount,l.defineGetterSetter(d,"charCount",d.getCharCount),d.placeHolder,l.defineGetterSetter(d,"placeHolder",d.getPlaceHolder,d.setPlaceHolder),l.TextFieldTTF.create=function(e,t,i,n,s){return new l.TextFieldTTF(e,t,i,n,s)},l.Codec.GZip=function(e){this.data=e,this.debug=!1,this.gpflags=void 0,this.files=0,this.unzipped=[],this.buf32k=new Array(32768),this.bIdx=0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void 0,this.literalTree=new Array(l.Codec.GZip.LITERALS),this.distanceTree=new Array(32),this.treepos=0,this.Places=null,this.len=0,this.fpos=new Array(17),this.fpos[0]=0,this.flens=void 0,this.fmax=void 0},l.Codec.GZip.gunzip=function(e){return e.constructor===Array||(e.constructor,String),new l.Codec.GZip(e).gunzip()[0][0]},l.Codec.GZip.HufNode=function(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1},l.Codec.GZip.LITERALS=288,l.Codec.GZip.NAMEMAX=256,l.Codec.GZip.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],l.Codec.GZip.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l.Codec.GZip.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],l.Codec.GZip.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],l.Codec.GZip.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],l.Codec.GZip.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],l.Codec.GZip.prototype.gunzip=function(){return this.outputArr=[],this.nextFile(),this.unzipped},l.Codec.GZip.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},l.Codec.GZip.prototype.byteAlign=function(){this.bb=1},l.Codec.GZip.prototype.readBit=function(){var e;return this.bits++,e=1&this.bb,this.bb>>=1,0===this.bb&&(this.bb=this.readByte(),e=1&this.bb,this.bb=this.bb>>1|128),e},l.Codec.GZip.prototype.readBits=function(e){for(var t=0,i=e;i--;)t=t<<1|this.readBit();return e&&(t=l.Codec.GZip.bitReverse[t]>>8-e),t},l.Codec.GZip.prototype.flushBuffer=function(){this.bIdx=0},l.Codec.GZip.prototype.addBuffer=function(e){this.buf32k[this.bIdx++]=e,this.outputArr.push(String.fromCharCode(e)),32768===this.bIdx&&(this.bIdx=0)},l.Codec.GZip.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]===this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},l.Codec.GZip.prototype.Rec=function(){var e,t=this.Places[this.treepos];if(17===this.len)return-1;if(this.treepos++,this.len++,(e=this.IsPat())>=0)t.b0=e;else if(t.b0=32768,this.Rec())return-1;if((e=this.IsPat())>=0)t.b1=e,t.jump=null;else if(t.b1=32768,t.jump=this.Places[this.treepos],t.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},l.Codec.GZip.prototype.CreateTree=function(e,t,i,n){var s;for(this.Places=e,this.treepos=0,this.flens=i,this.fmax=t,s=0;s<17;s++)this.fpos[s]=0;return this.len=0,this.Rec()?-1:0},l.Codec.GZip.prototype.DecodeValue=function(e){for(var t,i,n=0,s=e[n];;)if(this.readBit()){if(!(32768&s.b1))return s.b1;for(s=s.jump,t=e.length,i=0;i<t;i++)if(e[i]===s){n=i;break}}else{if(!(32768&s.b0))return s.b0;s=e[++n]}return-1},l.Codec.GZip.prototype.DeflateLoop=function(){var e,t,i;do{if(e=this.readBit(),0===(t=this.readBits(2))){var n,s;for(this.byteAlign(),n=this.readByte(),n|=this.readByte()<<8,s=this.readByte(),65535&(n^~(s|=this.readByte()<<8))&&document.write("BlockLen checksum mismatch\n");n--;)g=this.readByte(),this.addBuffer(g)}else if(1===t)for(;;)if((r=l.Codec.GZip.bitReverse[this.readBits(7)]>>1)>23?(r=r<<1|this.readBit())>199?r=(r-=128)<<1|this.readBit():(r-=48)>143&&(r+=136):r+=256,r<256)this.addBuffer(r);else{if(256===r)break;for(r-=257,m=this.readBits(l.Codec.GZip.cplext[r])+l.Codec.GZip.cplens[r],r=l.Codec.GZip.bitReverse[this.readBits(5)]>>3,l.Codec.GZip.cpdext[r]>8?(_=this.readBits(8),_|=this.readBits(l.Codec.GZip.cpdext[r]-8)<<8):_=this.readBits(l.Codec.GZip.cpdext[r]),_+=l.Codec.GZip.cpdist[r],r=0;r<m;r++){g=this.buf32k[this.bIdx-_&32767];this.addBuffer(g)}}else if(2===t){var r,a,o,h,d,c=new Array(320);for(o=257+this.readBits(5),h=1+this.readBits(5),d=4+this.readBits(4),r=0;r<19;r++)c[r]=0;for(r=0;r<d;r++)c[l.Codec.GZip.border[r]]=this.readBits(3);for(m=this.distanceTree.length,i=0;i<m;i++)this.distanceTree[i]=new l.Codec.GZip.HufNode;if(this.CreateTree(this.distanceTree,19,c,0))return this.flushBuffer(),1;a=o+h,i=0;for(;i<a;)if(0,(r=this.DecodeValue(this.distanceTree))<16)c[i++]=r;else if(16===r){var u;if(r=3+this.readBits(2),i+r>a)return this.flushBuffer(),1;for(u=i?c[i-1]:0;r--;)c[i++]=u}else{if(r=17===r?3+this.readBits(3):11+this.readBits(7),i+r>a)return this.flushBuffer(),1;for(;r--;)c[i++]=0}for(m=this.literalTree.length,i=0;i<m;i++)this.literalTree[i]=new l.Codec.GZip.HufNode;if(this.CreateTree(this.literalTree,o,c,0))return this.flushBuffer(),1;for(m=this.literalTree.length,i=0;i<m;i++)this.distanceTree[i]=new l.Codec.GZip.HufNode;var p=new Array;for(i=o;i<c.length;i++)p[i-o]=c[i];if(this.CreateTree(this.distanceTree,h,p,0))return this.flushBuffer(),1;for(;;)if((r=this.DecodeValue(this.literalTree))>=256){var m,_;if(0==(r-=256))break;for(r--,m=this.readBits(l.Codec.GZip.cplext[r])+l.Codec.GZip.cplens[r],r=this.DecodeValue(this.distanceTree),l.Codec.GZip.cpdext[r]>8?(_=this.readBits(8),_|=this.readBits(l.Codec.GZip.cpdext[r]-8)<<8):_=this.readBits(l.Codec.GZip.cpdext[r]),_+=l.Codec.GZip.cpdist[r];m--;){var g=this.buf32k[this.bIdx-_&32767];this.addBuffer(g)}}else this.addBuffer(r)}}while(!e);return this.flushBuffer(),this.byteAlign(),0},l.Codec.GZip.prototype.unzipFile=function(e){var t;for(this.gunzip(),t=0;t<this.unzipped.length;t++)if(this.unzipped[t][1]===e)return this.unzipped[t][0]},l.Codec.GZip.prototype.nextFile=function(){this.outputArr=[],this.modeZIP=!1;var e=[];if(e[0]=this.readByte(),e[1]=this.readByte(),120===e[0]&&218===e[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),31===e[0]&&139===e[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80===e[0]&&75===e[1]&&(this.modeZIP=!0,e[2]=this.readByte(),e[3]=this.readByte(),3===e[2]&&4===e[3])){e[0]=this.readByte(),e[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8;var t=this.readByte();t|=this.readByte()<<8,this.readByte(),this.readByte(),this.readByte(),this.readByte();this.readByte();this.readByte()<<8,this.readByte()<<16,this.readByte()<<24;this.readByte();this.readByte()<<8,this.readByte()<<16,this.readByte()<<24;var i=this.readByte();i|=this.readByte()<<8;var n=this.readByte();for(n|=this.readByte()<<8,r=0,this.nameBuf=[];i--;){var s=this.readByte();"/"===s|":"===s?r=0:r<l.Codec.GZip.NAMEMAX-1&&(this.nameBuf[r++]=String.fromCharCode(s))}this.fileout||(this.fileout=this.nameBuf);for(var r=0;r<n;)s=this.readByte(),r++;8===t&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},l.Codec.GZip.prototype.skipdir=function(){var e,t,i,n,s=[];if(8&this.gpflags&&(s[0]=this.readByte(),s[1]=this.readByte(),s[2]=this.readByte(),s[3]=this.readByte(),e=this.readByte(),e|=this.readByte()<<8,e|=this.readByte()<<16,e|=this.readByte()<<24,t=this.readByte(),t|=this.readByte()<<8,t|=this.readByte()<<16,t|=this.readByte()<<24),this.modeZIP&&this.nextFile(),s[0]=this.readByte(),8!==s[0])return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),4&this.gpflags)for(s[0]=this.readByte(),s[2]=this.readByte(),this.len=s[0]+256*s[1],i=0;i<this.len;i++)this.readByte();if(8&this.gpflags)for(i=0,this.nameBuf=[];n=this.readByte();)"7"!==n&&":"!==n||(i=0),i<l.Codec.GZip.NAMEMAX-1&&(this.nameBuf[i++]=n);if(16&this.gpflags)for(;n=this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),t=this.readByte(),t|=this.readByte()<<8,t|=this.readByte()<<16,t|=this.readByte()<<24,this.modeZIP&&this.nextFile()},function(){"use strict";function e(e){throw e}function t(e,t){var i=e.split("."),n=S;!(i[0]in n)&&n.execScript&&n.execScript("var "+i[0]);for(var s;i.length&&(s=i.shift());)i.length||t===T?n=n[s]?n[s]:n[s]={}:n[s]=t}function i(e){if("string"==typeof e){var t,i,n=e.split("");for(t=0,i=n.length;t<i;t++)n[t]=(255&n[t].charCodeAt(0))>>>0;e=n}for(var s,r=1,a=0,o=e.length,h=0;0<o;){o-=s=1024<o?1024:o;do{r+=e[h++],a+=r}while(--s);r%=65521,a%=65521}return(a<<16|r)>>>0}function n(t,i){this.index="number"==typeof i?i:0,this.i=0,this.buffer=t instanceof(w?Uint8Array:Array)?t:new(w?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&e(Error("invalid index")),this.buffer.length<=this.index&&this.f()}function s(e){this.buffer=new(w?Uint16Array:Array)(2*e),this.length=0}function r(e){var t,i,n,s,r,a,o,h,l,d=e.length,c=0,u=Number.POSITIVE_INFINITY;for(h=0;h<d;++h)e[h]>c&&(c=e[h]),e[h]<u&&(u=e[h]);for(t=1<<c,i=new(w?Uint32Array:Array)(t),n=1,s=0,r=2;n<=c;){for(h=0;h<d;++h)if(e[h]===n){for(a=0,o=s,l=0;l<n;++l)a=a<<1|1&o,o>>=1;for(l=a;l<t;l+=r)i[l]=n<<16|h;++s}++n,s<<=1,r<<=1}return[i,c,u]}function a(e,t){this.h=P,this.w=0,this.input=e,this.b=0,t&&(t.lazy&&(this.w=t.lazy),"number"==typeof t.compressionType&&(this.h=t.compressionType),t.outputBuffer&&(this.a=w&&t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.b=t.outputIndex)),this.a||(this.a=new(w?Uint8Array:Array)(32768))}function o(e,t){this.length=e,this.G=t}function h(t,i){function n(t,i){var n,s=t.G,r=[],a=0;n=D[t.length],r[a++]=65535&n,r[a++]=n>>16&255,r[a++]=n>>24;var o;switch(f){case 1===s:o=[0,s-1,0];break;case 2===s:o=[1,s-2,0];break;case 3===s:o=[2,s-3,0];break;case 4===s:o=[3,s-4,0];break;case 6>=s:o=[4,s-5,1];break;case 8>=s:o=[5,s-7,1];break;case 12>=s:o=[6,s-9,2];break;case 16>=s:o=[7,s-13,2];break;case 24>=s:o=[8,s-17,3];break;case 32>=s:o=[9,s-25,3];break;case 48>=s:o=[10,s-33,4];break;case 64>=s:o=[11,s-49,4];break;case 96>=s:o=[12,s-65,5];break;case 128>=s:o=[13,s-97,5];break;case 192>=s:o=[14,s-129,6];break;case 256>=s:o=[15,s-193,6];break;case 384>=s:o=[16,s-257,7];break;case 512>=s:o=[17,s-385,7];break;case 768>=s:o=[18,s-513,8];break;case 1024>=s:o=[19,s-769,8];break;case 1536>=s:o=[20,s-1025,9];break;case 2048>=s:o=[21,s-1537,9];break;case 3072>=s:o=[22,s-2049,10];break;case 4096>=s:o=[23,s-3073,10];break;case 6144>=s:o=[24,s-4097,11];break;case 8192>=s:o=[25,s-6145,11];break;case 12288>=s:o=[26,s-8193,12];break;case 16384>=s:o=[27,s-12289,12];break;case 24576>=s:o=[28,s-16385,13];break;case 32768>=s:o=[29,s-24577,13];break;default:e("invalid distance")}n=o,r[a++]=n[0],r[a++]=n[1],r[a++]=n[2];var h,l;for(h=0,l=r.length;h<l;++h)_[g++]=r[h];v[r[0]]++,L[r[3]]++,S=t.length+i-1,u=null}var s,r,a,h,l,d,c,u,p,m={},_=w?new Uint16Array(2*i.length):[],g=0,S=0,v=new(w?Uint32Array:Array)(286),L=new(w?Uint32Array:Array)(30),M=t.w;if(!w){for(a=0;285>=a;)v[a++]=0;for(a=0;29>=a;)L[a++]=0}for(v[256]=1,s=0,r=i.length;s<r;++s){for(a=l=0,h=3;a<h&&s+a!==r;++a)l=l<<8|i[s+a];if(m[l]===T&&(m[l]=[]),d=m[l],!(0<S--)){for(;0<d.length&&32768<s-d[0];)d.shift();if(s+3>=r){for(u&&n(u,-1),a=0,h=r-s;a<h;++a)p=i[s+a],_[g++]=p,++v[p];break}if(0<d.length){var C=T,y=T,B=0,F=T,E=T,P=T,b=T,A=i.length,E=0,b=d.length;e:for(;E<b;E++){if(C=d[b-E-1],F=3,3<B){for(P=B;3<P;P--)if(i[C+P-1]!==i[s+P-1])continue e;F=B}for(;258>F&&s+F<A&&i[C+F]===i[s+F];)++F;if(F>B&&(y=C,B=F),258===F)break}c=new o(B,s-y),u?u.length<c.length?(p=i[s-1],_[g++]=p,++v[p],n(c,0)):n(u,-1):c.length<M?u=c:n(c,0)}else u?n(u,-1):(p=i[s],_[g++]=p,++v[p])}d.push(s)}return _[g++]=256,v[256]++,t.L=v,t.K=L,w?_.subarray(0,g):_}function l(e,t){function i(e){var t=M[e][C[e]];t===T?(i(e+1),i(e+1)):--v[t],++C[e]}var n,r,a,o,h,l=e.length,d=new s(572),c=new(w?Uint8Array:Array)(l);if(!w)for(o=0;o<l;o++)c[o]=0;for(o=0;o<l;++o)0<e[o]&&d.push(o,e[o]);if(n=Array(d.length/2),r=new(w?Uint32Array:Array)(d.length/2),1===n.length)return c[d.pop().index]=1,c;for(o=0,h=d.length/2;o<h;++o)n[o]=d.pop(),r[o]=n[o].value;var u,p,m,_,g,T=r.length,f=new(w?Uint16Array:Array)(t),S=new(w?Uint8Array:Array)(t),v=new(w?Uint8Array:Array)(T),L=Array(t),M=Array(t),C=Array(t),y=(1<<t)-T,B=1<<t-1;for(f[t-1]=T,p=0;p<t;++p)y<B?S[p]=0:(S[p]=1,y-=B),y<<=1,f[t-2-p]=(f[t-1-p]/2|0)+T;for(f[0]=S[0],L[0]=Array(f[0]),M[0]=Array(f[0]),p=1;p<t;++p)f[p]>2*f[p-1]+S[p]&&(f[p]=2*f[p-1]+S[p]),L[p]=Array(f[p]),M[p]=Array(f[p]);for(u=0;u<T;++u)v[u]=t;for(m=0;m<f[t-1];++m)L[t-1][m]=r[m],M[t-1][m]=m;for(u=0;u<t;++u)C[u]=0;for(1===S[t-1]&&(--v[0],++C[t-1]),p=t-2;0<=p;--p){for(_=u=0,g=C[p+1],m=0;m<f[p];m++)(_=L[p+1][g]+L[p+1][g+1])>r[u]?(L[p][m]=_,M[p][m]=T,g+=2):(L[p][m]=r[u],M[p][m]=u,++u);C[p]=0,1===S[p]&&i(p)}for(a=v,o=0,h=n.length;o<h;++o)c[n[o].index]=a[o];return c}function d(t){var i,n,s,r,a=new(w?Uint16Array:Array)(t.length),o=[],h=[],l=0;for(i=0,n=t.length;i<n;i++)o[t[i]]=1+(0|o[t[i]]);for(i=1,n=16;i<=n;i++)h[i]=l,(l+=0|o[i])>1<<i&&e("overcommitted"),l<<=1;for(65536>l&&e("undercommitted"),i=0,n=t.length;i<n;i++)for(l=h[t[i]],h[t[i]]+=1,s=a[i]=0,r=t[i];s<r;s++)a[i]=a[i]<<1|1&l,l>>>=1;return a}function c(e,t){this.input=e,this.a=new(w?Uint8Array:Array)(32768),this.h=x.j;var i,n={};!t&&(t={})||"number"!=typeof t.compressionType||(this.h=t.compressionType);for(i in t)n[i]=t[i];n.outputBuffer=this.a,this.z=new a(this.input,n)}function u(t,i){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=w?new Uint8Array(t):t,this.s=!1,this.m=G,this.B=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.l=i.bufferSize),i.bufferType&&(this.m=i.bufferType),i.resize&&(this.B=i.resize)),this.m){case N:this.b=32768,this.a=new(w?Uint8Array:Array)(32768+this.l+258);break;case G:this.b=0,this.a=new(w?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:e(Error("invalid inflate mode"))}}function p(t,i){for(var n,s=t.g,r=t.e,a=t.input,o=t.c;r<i;)(n=a[o++])===T&&e(Error("input buffer is broken")),s|=n<<r,r+=8;return n=s&(1<<i)-1,t.g=s>>>i,t.e=r-i,t.c=o,n}function m(t,i){for(var n,s,r,a=t.g,o=t.e,h=t.input,l=t.c,d=i[0],c=i[1];o<c;)(n=h[l++])===T&&e(Error("input buffer is broken")),a|=n<<o,o+=8;return s=d[a&(1<<c)-1],r=s>>>16,t.g=a>>r,t.e=o-r,t.c=l,65535&s}function _(e){function t(e,t,i){var n,s,r,a;for(a=0;a<e;)switch(n=m(this,t)){case 16:for(r=3+p(this,2);r--;)i[a++]=s;break;case 17:for(r=3+p(this,3);r--;)i[a++]=0;s=0;break;case 18:for(r=11+p(this,7);r--;)i[a++]=0;s=0;break;default:s=i[a++]=n}return i}var i,n,s,a,o=p(e,5)+257,h=p(e,5)+1,l=p(e,4)+4,d=new(w?Uint8Array:Array)(V.length);for(a=0;a<l;++a)d[V[a]]=p(e,3);i=r(d),n=new(w?Uint8Array:Array)(o),s=new(w?Uint8Array:Array)(h),e.o(r(t.call(e,o,i,n)),r(t.call(e,h,i,s)))}function g(t,i){var n,s;switch(this.input=t,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.M=i.verify)),n=t[this.c++],s=t[this.c++],15&n){case _e:this.method=_e;break;default:e(Error("unsupported compression method"))}0!=((n<<8)+s)%31&&e(Error("invalid fcheck flag:"+((n<<8)+s)%31)),32&s&&e(Error("fdict flag is not supported")),this.A=new u(t,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}var T=void 0,f=!0,S=window,w="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;n.prototype.f=function(){var e,t=this.buffer,i=t.length,n=new(w?Uint8Array:Array)(i<<1);if(w)n.set(t);else for(e=0;e<i;++e)n[e]=t[e];return this.buffer=n},n.prototype.d=function(e,t,i){var n,s=this.buffer,r=this.index,a=this.i,o=s[r];if(i&&1<t&&(e=8<t?(B[255&e]<<24|B[e>>>8&255]<<16|B[e>>>16&255]<<8|B[e>>>24&255])>>32-t:B[e]>>8-t),8>t+a)o=o<<t|e,a+=t;else for(n=0;n<t;++n)o=o<<1|e>>t-n-1&1,8==++a&&(a=0,s[r++]=B[o],o=0,r===s.length&&(s=this.f()));s[r]=o,this.buffer=s,this.i=a,this.index=r},n.prototype.finish=function(){var e,t=this.buffer,i=this.index;return 0<this.i&&(t[i]<<=8-this.i,t[i]=B[t[i]],i++),w?e=t.subarray(0,i):(t.length=i,e=t),e};var v,L=new(w?Uint8Array:Array)(256);for(v=0;256>v;++v){for(var M=y=v,C=7,y=y>>>1;y;y>>>=1)M<<=1,M|=1&y,--C;L[v]=(M<<C&255)>>>0}var B=L,F=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];w&&new Uint32Array(F),s.prototype.getParent=function(e){return 2*((e-2)/4|0)},s.prototype.push=function(e,t){var i,n,s,r=this.buffer;for(i=this.length,r[this.length++]=t,r[this.length++]=e;0<i&&(n=this.getParent(i),r[i]>r[n]);)s=r[i],r[i]=r[n],r[n]=s,s=r[i+1],r[i+1]=r[n+1],r[n+1]=s,i=n;return this.length},s.prototype.pop=function(){var e,t,i,n,s,r=this.buffer;for(t=r[0],e=r[1],this.length-=2,r[0]=r[this.length],r[1]=r[this.length+1],s=0;!((n=2*s+2)>=this.length)&&(n+2<this.length&&r[n+2]>r[n]&&(n+=2),r[n]>r[s]);)i=r[s],r[s]=r[n],r[n]=i,i=r[s+1],r[s+1]=r[n+1],r[n+1]=i,s=n;return{index:e,value:t,length:this.length}};var E,P=2,b={NONE:0,r:1,j:P,N:3},A=[];for(E=0;288>E;E++)switch(f){case 143>=E:A.push([E+48,8]);break;case 255>=E:A.push([E-144+400,9]);break;case 279>=E:A.push([E-256+0,7]);break;case 287>=E:A.push([E-280+192,8]);break;default:e("invalid literal: "+E)}a.prototype.n=function(){var t,i,s,r,a=this.input;switch(this.h){case 0:for(s=0,r=a.length;s<r;){var o=i=w?a.subarray(s,s+65535):a.slice(s,s+65535),c=(s+=i.length)===r,u=T,p=T,m=T,_=T,g=T,S=this.a,v=this.b;if(w){for(S=new Uint8Array(this.a.buffer);S.length<=v+o.length+5;)S=new Uint8Array(S.length<<1);S.set(this.a)}if(u=c?1:0,S[v++]=0|u,p=o.length,m=65536+~p&65535,S[v++]=255&p,S[v++]=p>>>8&255,S[v++]=255&m,S[v++]=m>>>8&255,w)S.set(o,v),v+=o.length,S=S.subarray(0,v);else{for(_=0,g=o.length;_<g;++_)S[v++]=o[_];S.length=v}this.b=v,this.a=S}break;case 1:var L=new n(new Uint8Array(this.a.buffer),this.b);L.d(1,1,f),L.d(1,2,f);var M,C,y,B=h(this,a);for(M=0,C=B.length;M<C;M++)if(y=B[M],n.prototype.d.apply(L,A[y]),256<y)L.d(B[++M],B[++M],f),L.d(B[++M],5),L.d(B[++M],B[++M],f);else if(256===y)break;this.a=L.finish(),this.b=this.a.length;break;case P:var F,E,b,O,I,R,D,x,N,G,W,k,U,H,V,z=new n(new Uint8Array(this.a),this.b),Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=Array(19);for(F=P,z.d(1,1,f),z.d(F,2,f),E=h(this,a),D=d(R=l(this.L,15)),N=d(x=l(this.K,7)),b=286;257<b&&0===R[b-1];b--);for(O=30;1<O&&0===x[O-1];O--);var j,K,q,Q,Z,J,$=b,ee=O,te=new(w?Uint32Array:Array)($+ee),ie=new(w?Uint32Array:Array)(316),ne=new(w?Uint8Array:Array)(19);for(j=K=0;j<$;j++)te[K++]=R[j];for(j=0;j<ee;j++)te[K++]=x[j];if(!w)for(j=0,Q=ne.length;j<Q;++j)ne[j]=0;for(j=Z=0,Q=te.length;j<Q;j+=K){for(K=1;j+K<Q&&te[j+K]===te[j];++K);if(q=K,0===te[j])if(3>q)for(;0<q--;)ie[Z++]=0,ne[0]++;else for(;0<q;)(J=138>q?q:138)>q-3&&J<q&&(J=q-3),10>=J?(ie[Z++]=17,ie[Z++]=J-3,ne[17]++):(ie[Z++]=18,ie[Z++]=J-11,ne[18]++),q-=J;else if(ie[Z++]=te[j],ne[te[j]]++,3>--q)for(;0<q--;)ie[Z++]=te[j],ne[te[j]]++;else for(;0<q;)(J=6>q?q:6)>q-3&&J<q&&(J=q-3),ie[Z++]=16,ie[Z++]=J-3,ne[16]++,q-=J}for(t=w?ie.subarray(0,Z):ie.slice(0,Z),G=l(ne,7),H=0;19>H;H++)X[H]=G[Y[H]];for(I=19;4<I&&0===X[I-1];I--);for(W=d(G),z.d(b-257,5,f),z.d(O-1,5,f),z.d(I-4,4,f),H=0;H<I;H++)z.d(X[H],3,f);for(H=0,V=t.length;H<V;H++)if(k=t[H],z.d(W[k],G[k],f),16<=k){switch(H++,k){case 16:U=2;break;case 17:U=3;break;case 18:U=7;break;default:e("invalid code: "+k)}z.d(t[H],U,f)}var se,re,ae,oe,he,le,de,ce,ue=[D,R],pe=[N,x];for(he=ue[0],le=ue[1],de=pe[0],ce=pe[1],se=0,re=E.length;se<re;++se)if(ae=E[se],z.d(he[ae],le[ae],f),256<ae)z.d(E[++se],E[++se],f),oe=E[++se],z.d(de[oe],ce[oe],f),z.d(E[++se],E[++se],f);else if(256===ae)break;this.a=z.finish(),this.b=this.a.length;break;default:e("invalid compression type")}return this.a};var O,I,R=[];for(O=3;258>=O;O++)I=function(){var t=O;switch(f){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case 12>=t:return[265,t-11,1];case 14>=t:return[266,t-13,1];case 16>=t:return[267,t-15,1];case 18>=t:return[268,t-17,1];case 22>=t:return[269,t-19,2];case 26>=t:return[270,t-23,2];case 30>=t:return[271,t-27,2];case 34>=t:return[272,t-31,2];case 42>=t:return[273,t-35,3];case 50>=t:return[274,t-43,3];case 58>=t:return[275,t-51,3];case 66>=t:return[276,t-59,3];case 82>=t:return[277,t-67,4];case 98>=t:return[278,t-83,4];case 114>=t:return[279,t-99,4];case 130>=t:return[280,t-115,4];case 162>=t:return[281,t-131,5];case 194>=t:return[282,t-163,5];case 226>=t:return[283,t-195,5];case 257>=t:return[284,t-227,5];case 258===t:return[285,t-258,0];default:e("invalid length: "+t)}}(),R[O]=I[2]<<24|I[1]<<16|I[0];var D=w?new Uint32Array(R):R,x=b;c.prototype.n=function(){var t,n,s,r,a,o,h,l=0;switch(h=this.a,t=_e){case _e:n=Math.LOG2E*Math.log(32768)-8;break;default:e(Error("invalid compression method"))}switch(s=n<<4|t,h[l++]=s,t){case _e:switch(this.h){case x.NONE:a=0;break;case x.r:a=1;break;case x.j:a=2;break;default:e(Error("unsupported compression type"))}break;default:e(Error("invalid compression method"))}return r=a<<6|0,h[l++]=r|31-(256*s+r)%31,o=i(this.input),this.z.b=l,h=this.z.n(),l=h.length,w&&((h=new Uint8Array(h.buffer)).length<=l+4&&(this.a=new Uint8Array(h.length+4),this.a.set(h),h=this.a),h=h.subarray(0,l+4)),h[l++]=o>>24&255,h[l++]=o>>16&255,h[l++]=o>>8&255,h[l++]=255&o,h},t("Zlib.Deflate",c),t("Zlib.Deflate.compress",function(e,t){return new c(e,t).n()}),t("Zlib.Deflate.CompressionType",x),t("Zlib.Deflate.CompressionType.NONE",x.NONE),t("Zlib.Deflate.CompressionType.FIXED",x.r),t("Zlib.Deflate.CompressionType.DYNAMIC",x.j);var N=0,G=1,W={D:N,C:G};u.prototype.p=function(){for(;!this.s;){var t=p(this,3);switch(1&t&&(this.s=f),t>>>=1){case 0:var i=this.input,n=this.c,s=this.a,r=this.b,a=T,o=T,h=T,l=s.length,d=T;switch(this.e=this.g=0,(a=i[n++])===T&&e(Error("invalid uncompressed block header: LEN (first byte)")),o=a,(a=i[n++])===T&&e(Error("invalid uncompressed block header: LEN (second byte)")),o|=a<<8,(a=i[n++])===T&&e(Error("invalid uncompressed block header: NLEN (first byte)")),h=a,(a=i[n++])===T&&e(Error("invalid uncompressed block header: NLEN (second byte)")),h|=a<<8,o===~h&&e(Error("invalid uncompressed block header: length verify")),n+o>i.length&&e(Error("input buffer is broken")),this.m){case N:for(;r+o>s.length;){if(d=l-r,o-=d,w)s.set(i.subarray(n,n+d),r),r+=d,n+=d;else for(;d--;)s[r++]=i[n++];this.b=r,s=this.f(),r=this.b}break;case G:for(;r+o>s.length;)s=this.f({v:2});break;default:e(Error("invalid inflate mode"))}if(w)s.set(i.subarray(n,n+o),r),r+=o,n+=o;else for(;o--;)s[r++]=i[n++];this.c=n,this.b=r,this.a=s;break;case 1:this.o(te,ne);break;case 2:_(this);break;default:e(Error("unknown BTYPE: "+t))}}return this.t()};var k,U,H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=w?new Uint16Array(H):H,z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],Y=w?new Uint16Array(z):z,X=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],j=w?new Uint8Array(X):X,K=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],q=w?new Uint16Array(K):K,Q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z=w?new Uint8Array(Q):Q,J=new(w?Uint8Array:Array)(288);for(k=0,U=J.length;k<U;++k)J[k]=143>=k?8:255>=k?9:279>=k?7:8;var $,ee,te=r(J),ie=new(w?Uint8Array:Array)(30);for($=0,ee=ie.length;$<ee;++$)ie[$]=5;var ne=r(ie);u.prototype.o=function(e,t){var i=this.a,n=this.b;this.u=e;for(var s,r,a,o,h=i.length-258;256!==(s=m(this,e));)if(256>s)n>=h&&(this.b=n,i=this.f(),n=this.b),i[n++]=s;else for(o=Y[r=s-257],0<j[r]&&(o+=p(this,j[r])),s=m(this,t),a=q[s],0<Z[s]&&(a+=p(this,Z[s])),n>=h&&(this.b=n,i=this.f(),n=this.b);o--;)i[n]=i[n++-a];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},u.prototype.I=function(e,t){var i=this.a,n=this.b;this.u=e;for(var s,r,a,o,h=i.length;256!==(s=m(this,e));)if(256>s)n>=h&&(i=this.f(),h=i.length),i[n++]=s;else for(o=Y[r=s-257],0<j[r]&&(o+=p(this,j[r])),s=m(this,t),a=q[s],0<Z[s]&&(a+=p(this,Z[s])),n+o>h&&(i=this.f(),h=i.length);o--;)i[n]=i[n++-a];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},u.prototype.f=function(){var e,t,i=new(w?Uint8Array:Array)(this.b-32768),n=this.b-32768,s=this.a;if(w)i.set(s.subarray(32768,i.length));else for(e=0,t=i.length;e<t;++e)i[e]=s[e+32768];if(this.k.push(i),this.q+=i.length,w)s.set(s.subarray(n,n+32768));else for(e=0;32768>e;++e)s[e]=s[n+e];return this.b=32768,s},u.prototype.J=function(e){var t,i,n,s,r=this.input.length/this.c+1|0,a=this.input,o=this.a;return e&&("number"==typeof e.v&&(r=e.v),"number"==typeof e.F&&(r+=e.F)),2>r?(i=(a.length-this.c)/this.u[2],s=i/2*258|0,n=s<o.length?o.length+s:o.length<<1):n=o.length*r,w?(t=new Uint8Array(n)).set(o):t=o,this.a=t},u.prototype.t=function(){var e,t,i,n,s,r=0,a=this.a,o=this.k,h=new(w?Uint8Array:Array)(this.q+(this.b-32768));if(0===o.length)return w?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(t=0,i=o.length;t<i;++t)for(n=0,s=(e=o[t]).length;n<s;++n)h[r++]=e[n];for(t=32768,i=this.b;t<i;++t)h[r++]=a[t];return this.k=[],this.buffer=h},u.prototype.H=function(){var e,t=this.b;return w?this.B?(e=new Uint8Array(t)).set(this.a.subarray(0,t)):e=this.a.subarray(0,t):(this.a.length>t&&(this.a.length=t),e=this.a),this.buffer=e},g.prototype.p=function(){var t,n=this.input;return t=this.A.p(),this.c=this.A.c,this.M&&(n[this.c++]<<24|n[this.c++]<<16|n[this.c++]<<8|n[this.c++])>>>0!==i(t)&&e(Error("invalid adler-32 checksum")),t},t("Zlib.Inflate",g),t("Zlib.Inflate.BufferType",W),W.ADAPTIVE=W.C,W.BLOCK=W.D,t("Zlib.Inflate.prototype.decompress",g.prototype.p);var se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];w&&new Uint16Array(se);var re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];w&&new Uint16Array(re);var ae=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];w&&new Uint8Array(ae);var oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];w&&new Uint16Array(oe);var he=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];w&&new Uint8Array(he);var le,de,ce=new(w?Uint8Array:Array)(288);for(le=0,de=ce.length;le<de;++le)ce[le]=143>=le?8:255>=le?9:279>=le?7:8;r(ce);var ue,pe,me=new(w?Uint8Array:Array)(30);for(ue=0,pe=me.length;ue<pe;++ue)me[ue]=5;r(me);var _e=8}.call(this);var d=window;d=d.Zlib=d.Zlib,d.Deflate=d.Deflate,d.Deflate.compress=d.Deflate.compress,d.Inflate=d.Inflate,d.Inflate.BufferType=d.Inflate.BufferType,d.Inflate.prototype.decompress=d.Inflate.prototype.decompress,l.TGA_OK=0,l.TGA_ERROR_FILE_OPEN=1,l.TGA_ERROR_READING_FILE=2,l.TGA_ERROR_INDEXED_COLOR=3,l.TGA_ERROR_MEMORY=4,l.TGA_ERROR_COMPRESSED_FILE=5,l.ImageTGA=function(e,t,i,n,s,r,a){this.status=e||0,this.type=t||0,this.pixelDepth=i||0,this.width=n||0,this.height=s||0,this.imageData=r||[],this.flipped=a||0},l.tgaLoadHeader=function(e,t,i){var n=2;if(n+1>t)return!1;var s=new l.BinaryStreamReader(e);if(s.setOffset(n),i.type=s.readByte(),(n+=10)+4+1>t)return!1;if(s.setOffset(n),i.width=s.readUnsignedShort(),i.height=s.readUnsignedInteger(),i.pixelDepth=s.readByte(),(n+=5)+1>t)return!1;var r=s.readByte();return i.flipped=0,32&r&&(i.flipped=1),!0},l.tgaLoadImageData=function(e,t,i){var n,s,r,a;if(n=0|i.pixelDepth/2,18+(s=i.height*i.width*n)>t)return!1;if(i.imageData=l.__getSubArray(e,18,18+s),n>=3)for(r=0;r<s;r+=n)a=i.imageData[r],i.imageData[r]=i.imageData[r+2],i.imageData[r+2]=a;return!0},l.tgaRGBtogreyscale=function(e){var t,i;if(8!==e.pixelDepth){var n=e.pixelDepth/8,s=new Uint8Array(e.height*e.width);if(null!==s){for(t=0,i=0;i<e.width*e.height;t+=n,i++)s[i]=.3*e.imageData[t]+.59*e.imageData[t+1]+.11*e.imageData[t+2];e.pixelDepth=8,e.type=3,e.imageData=s}}},l.tgaDestroy=function(e){e&&(e.imageData=null,e=null)},l.tgaLoadRLEImageData=function(e,t,i){var n,s,r,a=0,o=0,h=0,d=[],c=0,u=18;for(n=i.pixelDepth/8,s=i.height*i.width,r=0;r<s;r++){if(0!==c)c--,o=0!==h;else{if(u+1>t)break;c=e[u],u+=1,(h=128&c)&&(c-=128),o=0}if(!o){if(u+n>t)break;if(d=l.__getSubArray(e,u,u+n),u+=n,n>=3){var p=d[0];d[0]=d[2],d[2]=p}}for(var m=0;m<n;m++)i.imageData[a+m]=d[m];a+=n}return!0},l.tgaFlipImage=function(e){for(var t=e.pixelDepth/8,i=e.width*t,n=0;n<e.height/2;n++){var s=l.__getSubArray(e.imageData,n*i,n*i+i);l.__setDataToArray(l.__getSubArray(e.imageData,(e.height-(n+1))*i,i),e.imageData,n*i),l.__setDataToArray(s,e.imageData,(e.height-(n+1))*i)}e.flipped=0},l.__getSubArray=function(e,t,i){return e instanceof Array?e.slice(t,i):e.subarray(t,i)},l.__setDataToArray=function(e,t,i){for(var n=0;n<e.length;n++)t[i+n]=e[n]},l.BinaryStreamReader=l.Class.extend({_binaryData:null,_offset:0,ctor:function(e){this._binaryData=e},setBinaryData:function(e){this._binaryData=e,this._offset=0},getBinaryData:function(){return this._binaryData},_checkSize:function(e){if(!(this._offset+Math.ceil(e/8)<this._data.length))throw new Error("Index out of bound")},_decodeFloat:function(e,t){var i=e+t+1,n=i>>3;this._checkSize(i);var s=Math.pow(2,t-1)-1,r=this._readBits(e+t,1,n),a=this._readBits(e,t,n),o=0,h=2,l=0;do{for(var d=this._readByte(++l,n),c=e%8||8,u=1<<c;u>>=1;)d&u&&(o+=1/h),h*=2}while(e-=c);return this._offset+=n,a===1+(s<<1)?o?NaN:r?-1/0:1/0:(1+-2*r)*(a||o?a?Math.pow(2,a-s)*(1+o):Math.pow(2,1-s)*o:0)},_readByte:function(e,t){return this._data[this._offset+t-e-1]},_decodeInt:function(e,t){var i=this._readBits(0,e,e/8),n=Math.pow(2,e),s=t&&i>=n/2?i-n:i;return this._offset+=e/8,s},_shl:function(e,t){for(++t;--t;e=1073741824==(1073741824&(e%=2147483648))?2*e:2*(e-1073741824)+2147483647+1);return e},_readBits:function(e,t,i){var n=(e+t)%8,s=e%8,r=i-(e>>3)-1,a=i+(-(e+t)>>3),o=r-a,h=this._readByte(r,i)>>s&(1<<(o?8-s:t))-1;for(o&&n&&(h+=(this._readByte(a++,i)&(1<<n)-1)<<(o--<<3)-s);o;)h+=this._shl(this._readByte(a++,i),(o--<<3)-s);return h},readInteger:function(){return this._decodeInt(32,!0)},readUnsignedInteger:function(){return this._decodeInt(32,!1)},readSingle:function(){return this._decodeFloat(23,8)},readShort:function(){return this._decodeInt(16,!0)},readUnsignedShort:function(){return this._decodeInt(16,!1)},readByte:function(){var e=this._data[this._offset];return this._offset+=1,e},readData:function(e,t){return this._binaryData instanceof Array?this._binaryData.slice(e,t):this._binaryData.subarray(e,t)},setOffset:function(e){this._offset=e},getOffset:function(){return this._offset}}),l.TMX_ORIENTATION_ORTHO=0,l.TMX_ORIENTATION_HEX=1,l.TMX_ORIENTATION_ISO=2,l.TMXTiledMap=l.Node.extend({properties:null,mapOrientation:null,objectGroups:null,_mapSize:null,_tileSize:null,_tileProperties:null,_className:"TMXTiledMap",ctor:function(e,t){l.Node.prototype.ctor.call(this),this._mapSize=l.size(0,0),this._tileSize=l.size(0,0),void 0!==t?this.initWithXML(e,t):void 0!==e&&this.initWithTMXFile(e)},getMapSize:function(){return l.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(e){this._mapSize.width=e.width,this._mapSize.height=e.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(e){this._mapSize.width=e},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(e){this._mapSize.height=e},getTileSize:function(){return l.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(e){this._tileSize.width=e.width,this._tileSize.height=e.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(e){this._tileSize.width=e},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(e){this._tileSize.height=e},getMapOrientation:function(){return this.mapOrientation},setMapOrientation:function(e){this.mapOrientation=e},getObjectGroups:function(){return this.objectGroups},setObjectGroups:function(e){this.objectGroups=e},getProperties:function(){return this.properties},setProperties:function(e){this.properties=e},initWithTMXFile:function(e){if(!e||0===e.length)throw new Error("cc.TMXTiledMap.initWithTMXFile(): tmxFile should be non-null or non-empty string.");this.width=0,this.height=0;var t=new l.TMXMapInfo(e);if(!t)return!1;var i=t.getTilesets();return i&&0!==i.length||l.log("cc.TMXTiledMap.initWithTMXFile(): Map not found. Please check the filename."),this._buildWithMapInfo(t),!0},initWithXML:function(e,t){this.width=0,this.height=0;var i=new l.TMXMapInfo(e,t),n=i.getTilesets();return n&&0!==n.length||l.log("cc.TMXTiledMap.initWithXML(): Map not found. Please check the filename."),this._buildWithMapInfo(i),!0},_buildWithMapInfo:function(e){this._mapSize=e.getMapSize(),this._tileSize=e.getTileSize(),this.mapOrientation=e.orientation,this.objectGroups=e.getObjectGroups(),this.properties=e.properties,this._tileProperties=e.getTileProperties();var t=0,i=e.getLayers();if(i)for(var n=null,s=0,r=i.length;s<r;s++)if((n=i[s])&&n.visible){var a=this._parseLayer(n,e);this.addChild(a,t,t),this.width=Math.max(this.width,a.width),this.height=Math.max(this.height,a.height),t++}},allLayers:function(){for(var e=[],t=this._children,i=0,n=t.length;i<n;i++){var s=t[i];s&&s instanceof l.TMXLayer&&e.push(s)}return e},getLayer:function(e){if(!e||0===e.length)throw new Error("cc.TMXTiledMap.getLayer(): layerName should be non-null or non-empty string.");for(var t=this._children,i=0;i<t.length;i++){var n=t[i];if(n&&n.layerName===e)return n}return null},getObjectGroup:function(e){if(!e||0===e.length)throw new Error("cc.TMXTiledMap.getObjectGroup(): groupName should be non-null or non-empty string.");if(this.objectGroups)for(var t=0;t<this.objectGroups.length;t++){var i=this.objectGroups[t];if(i&&i.groupName===e)return i}return null},getProperty:function(e){return this.properties[e.toString()]},propertiesForGID:function(e){return l.log("propertiesForGID is deprecated. Please use getPropertiesForGID instead."),this.getPropertiesForGID[e]},getPropertiesForGID:function(e){return this._tileProperties[e]},_parseLayer:function(e,t){var i=this._tilesetForLayer(e,t),n=new l.TMXLayer(i,e,t);return e.ownTiles=!1,n},_tilesetForLayer:function(e,t){var i=e._layerSize,n=t.getTilesets();if(n)for(var s=n.length-1;s>=0;s--){var r=n[s];if(r)for(var a=0;a<i.height;a++)for(var o=0;o<i.width;o++){var h=o+i.width*a,d=e._tiles[h];if(0!==d&&(d&l.TMX_TILE_FLIPPED_MASK)>>>0>=r.firstGid)return r}}return l.log("cocos2d: Warning: TMX Layer "+e.name+" has no tiles"),null}});var d=l.TMXTiledMap.prototype;d.mapWidth,l.defineGetterSetter(d,"mapWidth",d._getMapWidth,d._setMapWidth),d.mapHeight,l.defineGetterSetter(d,"mapHeight",d._getMapHeight,d._setMapHeight),d.tileWidth,l.defineGetterSetter(d,"tileWidth",d._getTileWidth,d._setTileWidth),d.tileHeight,l.defineGetterSetter(d,"tileHeight",d._getTileHeight,d._setTileHeight),l.TMXTiledMap.create=function(e,t){return new l.TMXTiledMap(e,t)},l.TMX_PROPERTY_NONE=0,l.TMX_PROPERTY_MAP=1,l.TMX_PROPERTY_LAYER=2,l.TMX_PROPERTY_OBJECTGROUP=3,l.TMX_PROPERTY_OBJECT=4,l.TMX_PROPERTY_TILE=5,l.TMX_TILE_HORIZONTAL_FLAG=2147483648,l.TMX_TILE_VERTICAL_FLAG=1073741824,l.TMX_TILE_DIAGONAL_FLAG=536870912,l.TMX_TILE_FLIPPED_ALL=(l.TMX_TILE_HORIZONTAL_FLAG|l.TMX_TILE_VERTICAL_FLAG|l.TMX_TILE_DIAGONAL_FLAG)>>>0,l.TMX_TILE_FLIPPED_MASK=~l.TMX_TILE_FLIPPED_ALL>>>0,l.TMXLayerInfo=l.Class.extend({properties:null,name:"",_layerSize:null,_tiles:null,visible:null,_opacity:null,ownTiles:!0,_minGID:1e5,_maxGID:0,offset:null,ctor:function(){this.properties=[],this.name="",this._layerSize=null,this._tiles=null,this.visible=!0,this._opacity=0,this.ownTiles=!0,this._minGID=1e5,this._maxGID=0,this.offset=l.p(0,0)},getProperties:function(){return this.properties},setProperties:function(e){this.properties=e}}),l.TMXTilesetInfo=l.Class.extend({name:"",firstGid:0,_tileSize:null,spacing:0,margin:0,sourceImage:"",imageSize:null,ctor:function(){this._tileSize=l.size(0,0),this.imageSize=l.size(0,0)},rectForGID:function(e,t){var i=t||l.rect(0,0,0,0);i.width=this._tileSize.width,i.height=this._tileSize.height,e&=l.TMX_TILE_FLIPPED_MASK,e-=parseInt(this.firstGid,10);var n=parseInt((this.imageSize.width-2*this.margin+this.spacing)/(this._tileSize.width+this.spacing),10);return i.x=parseInt(e%n*(this._tileSize.width+this.spacing)+this.margin,10),i.y=parseInt(parseInt(e/n,10)*(this._tileSize.height+this.spacing)+this.margin,10),i}}),l.TMXMapInfo=l.SAXParser.extend({properties:null,orientation:null,parentElement:null,parentGID:null,layerAttrs:0,storingCharacters:!1,tmxFileName:null,currentString:null,_objectGroups:null,_mapSize:null,_tileSize:null,_layers:null,_tilesets:null,_tileProperties:null,_resources:"",_currentFirstGID:0,ctor:function(e,t){l.SAXParser.prototype.ctor.apply(this),this._mapSize=l.size(0,0),this._tileSize=l.size(0,0),this._layers=[],this._tilesets=[],this._objectGroups=[],this.properties=[],this._tileProperties={},this._currentFirstGID=0,void 0!==t?this.initWithXML(e,t):void 0!==e&&this.initWithTMXFile(e)},getOrientation:function(){return this.orientation},setOrientation:function(e){this.orientation=e},getMapSize:function(){return l.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(e){this._mapSize.width=e.width,this._mapSize.height=e.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(e){this._mapSize.width=e},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(e){this._mapSize.height=e},getTileSize:function(){return l.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(e){this._tileSize.width=e.width,this._tileSize.height=e.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(e){this._tileSize.width=e},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(e){this._tileSize.height=e},getLayers:function(){return this._layers},setLayers:function(e){this._layers.push(e)},getTilesets:function(){return this._tilesets},setTilesets:function(e){this._tilesets.push(e)},getObjectGroups:function(){return this._objectGroups},setObjectGroups:function(e){this._objectGroups.push(e)},getParentElement:function(){return this.parentElement},setParentElement:function(e){this.parentElement=e},getParentGID:function(){return this.parentGID},setParentGID:function(e){this.parentGID=e},getLayerAttribs:function(){return this.layerAttrs},setLayerAttribs:function(e){this.layerAttrs=e},getStoringCharacters:function(){return this.storingCharacters},setStoringCharacters:function(e){this.storingCharacters=e},getProperties:function(){return this.properties},setProperties:function(e){this.properties=e},initWithTMXFile:function(e){return this._internalInit(e,null),this.parseXMLFile(e)},initWithXML:function(e,t){return this._internalInit(null,t),this.parseXMLString(e)},parseXMLFile:function(e,t){var i=(t=t||!1)?e:l.loader.getRes(e);if(!i)throw new Error("Please load the resource first : "+e);var n,s,r=this._parseXML(i).documentElement,a=r.getAttribute("version"),o=r.getAttribute("orientation");if("map"===r.nodeName){"1.0"!==a&&null!==a&&l.log("cocos2d: TMXFormat: Unsupported TMX version:"+a),"orthogonal"===o?this.orientation=l.TMX_ORIENTATION_ORTHO:"isometric"===o?this.orientation=l.TMX_ORIENTATION_ISO:"hexagonal"===o?this.orientation=l.TMX_ORIENTATION_HEX:null!==o&&l.log("cocos2d: TMXFomat: Unsupported orientation:"+o);var h=l.size(0,0);h.width=parseFloat(r.getAttribute("width")),h.height=parseFloat(r.getAttribute("height")),this.setMapSize(h),(h=l.size(0,0)).width=parseFloat(r.getAttribute("tilewidth")),h.height=parseFloat(r.getAttribute("tileheight")),this.setTileSize(h);var d=r.querySelectorAll("map > properties >  property");if(d){var c={};for(n=0;n<d.length;n++)c[d[n].getAttribute("name")]=d[n].getAttribute("value");this.properties=c}}var u=r.getElementsByTagName("tileset");for("map"!==r.nodeName&&(u=[]).push(r),n=0;n<u.length;n++){var p=u[n],m=p.getAttribute("source");if(m){var _=t?l.path.join(this._resources,m):l.path.changeBasename(e,m);this.parseXMLFile(_)}else{var g=new l.TMXTilesetInfo;g.name=p.getAttribute("name")||"",g.firstGid=parseInt(p.getAttribute("firstgid"))||0,g.spacing=parseInt(p.getAttribute("spacing"))||0,g.margin=parseInt(p.getAttribute("margin"))||0;var T=l.size(0,0);T.width=parseFloat(p.getAttribute("tilewidth")),T.height=parseFloat(p.getAttribute("tileheight")),g._tileSize=T;var f=p.getElementsByTagName("image")[0].getAttribute("source"),S=-1;if(this.tmxFileName&&(S=this.tmxFileName.lastIndexOf("/")),-1!==S){var w=this.tmxFileName.substr(0,S+1);g.sourceImage=w+f}else g.sourceImage=this._resources+(this._resources?"/":"")+f;if(this.setTilesets(g),D=p.getElementsByTagName("tile"))for(var v=0;v<D.length;v++){var L=D[v];this.parentGID=parseInt(g.firstGid)+parseInt(L.getAttribute("id")||0);var M=L.querySelectorAll("properties > property");if(M){var C={};for(s=0;s<M.length;s++)C[M[s].getAttribute("name")]=M[s].getAttribute("value");this._tileProperties[this.parentGID]=C}}}}var y=r.getElementsByTagName("layer");if(y)for(n=0;n<y.length;n++){var B=y[n],F=B.getElementsByTagName("data")[0],E=new l.TMXLayerInfo;E.name=B.getAttribute("name");var P=l.size(0,0);P.width=parseFloat(B.getAttribute("width")),P.height=parseFloat(B.getAttribute("height")),E._layerSize=P;var b=B.getAttribute("visible");E.visible=!("0"==b);var A=B.getAttribute("opacity")||1;E._opacity=A?parseInt(255*parseFloat(A)):255,E.offset=l.p(parseFloat(B.getAttribute("x"))||0,parseFloat(B.getAttribute("y"))||0);var O="";for(s=0;s<F.childNodes.length;s++)O+=F.childNodes[s].nodeValue;O=O.trim();var I=F.getAttribute("compression"),R=F.getAttribute("encoding");if(I&&"gzip"!==I&&"zlib"!==I)return l.log("cc.TMXMapInfo.parseXMLFile(): unsupported compression method"),null;var D;switch(I){case"gzip":D=l.unzipBase64AsArray(O,4);break;case"zlib":var x=new Zlib.Inflate(l.Codec.Base64.decodeAsArray(O,1));D=l.uint8ArrayToUint32Array(x.decompress());break;case null:case"":if("base64"===R)D=l.Codec.Base64.decodeAsArray(O,4);else if("csv"===R){D=[];for(var N=O.split(","),G=0;G<N.length;G++)D.push(parseInt(N[G]))}else{var W=F.getElementsByTagName("tile");D=[];for(var k=0;k<W.length;k++)D.push(parseInt(W[k].getAttribute("gid")))}break;default:this.layerAttrs===l.TMXLayerInfo.ATTRIB_NONE&&l.log("cc.TMXMapInfo.parseXMLFile(): Only base64 and/or gzip/zlib maps are supported")}D&&(E._tiles=new Uint32Array(D));var U=B.querySelectorAll("properties > property");if(U){var H={};for(s=0;s<U.length;s++)H[U[s].getAttribute("name")]=U[s].getAttribute("value");E.properties=H}this.setLayers(E)}var V=r.getElementsByTagName("objectgroup");if(V)for(n=0;n<V.length;n++){var z=V[n],Y=new l.TMXObjectGroup;Y.groupName=z.getAttribute("name"),Y.setPositionOffset(l.p(parseFloat(z.getAttribute("x"))*this.getTileSize().width||0,parseFloat(z.getAttribute("y"))*this.getTileSize().height||0));var X=z.querySelectorAll("objectgroup > properties > property");if(X)for(s=0;s<X.length;s++){var j={};j[X[s].getAttribute("name")]=X[s].getAttribute("value"),Y.properties=j}var K=z.querySelectorAll("object"),q=l.director.getContentScaleFactor();if(K)for(s=0;s<K.length;s++){var Q=K[s],Z={};Z.name=Q.getAttribute("name")||"",Z.type=Q.getAttribute("type")||"",Z.width=parseInt(Q.getAttribute("width"))||0,Z.height=parseInt(Q.getAttribute("height"))||0,Z.x=((0|(Q.getAttribute("x")||0))+Y.getPositionOffset().x)/q;var J=(0|(Q.getAttribute("y")||0))+Y.getPositionOffset().y/q;Z.y=(parseInt(this.getMapSize().height*this.getTileSize().height)-J-Z.height)/l.director.getContentScaleFactor(),Z.rotation=parseInt(Q.getAttribute("rotation"))||0;var $=Q.querySelectorAll("properties > property");if($)for(var ee=0;ee<$.length;ee++)Z[$[ee].getAttribute("name")]=$[ee].getAttribute("value");var te=Q.querySelectorAll("polygon");if(te&&te.length>0){var ie=te[0].getAttribute("points");ie&&(Z.points=this._parsePointsString(ie))}var ne=Q.querySelectorAll("polyline");if(ne&&ne.length>0){var se=ne[0].getAttribute("points");se&&(Z.polylinePoints=this._parsePointsString(se))}Y.setObjects(Z)}this.setObjectGroups(Y)}return r},_parsePointsString:function(e){if(!e)return null;for(var t=[],i=e.split(" "),n=0;n<i.length;n++){var s=i[n].split(",");t.push({x:s[0],y:s[1]})}return t},parseXMLString:function(e){return this.parseXMLFile(e,!0)},getTileProperties:function(){return this._tileProperties},setTileProperties:function(e){this._tileProperties.push(e)},getCurrentString:function(){return this.currentString},setCurrentString:function(e){this.currentString=e},getTMXFileName:function(){return this.tmxFileName},setTMXFileName:function(e){this.tmxFileName=e},_internalInit:function(e,t){this._tilesets.length=0,this._layers.length=0,this.tmxFileName=e,t&&(this._resources=t),this._objectGroups.length=0,this.properties.length=0,this._tileProperties.length=0,this.currentString="",this.storingCharacters=!1,this.layerAttrs=l.TMXLayerInfo.ATTRIB_NONE,this.parentElement=l.TMX_PROPERTY_NONE,this._currentFirstGID=0}});var d=l.TMXMapInfo.prototype;d.mapWidth,l.defineGetterSetter(d,"mapWidth",d._getMapWidth,d._setMapWidth),d.mapHeight,l.defineGetterSetter(d,"mapHeight",d._getMapHeight,d._setMapHeight),d.tileWidth,l.defineGetterSetter(d,"tileWidth",d._getTileWidth,d._setTileWidth),d.tileHeight,l.defineGetterSetter(d,"tileHeight",d._getTileHeight,d._setTileHeight),l.TMXMapInfo.create=function(e,t){return new l.TMXMapInfo(e,t)},l.loader.register(["tmx","tsx"],l._txtLoader),l.TMXLayerInfo.ATTRIB_NONE=1,l.TMXLayerInfo.ATTRIB_BASE64=2,l.TMXLayerInfo.ATTRIB_GZIP=4,l.TMXLayerInfo.ATTRIB_ZLIB=8,l.TMXObjectGroup=l.Class.extend({properties:null,groupName:"",_positionOffset:null,_objects:null,ctor:function(){this.groupName="",this._positionOffset=l.p(0,0),this.properties=[],this._objects=[]},getPositionOffset:function(){return l.p(this._positionOffset)},setPositionOffset:function(e){this._positionOffset.x=e.x,this._positionOffset.y=e.y},getProperties:function(){return this.properties},setProperties:function(e){this.properties.push(e)},getGroupName:function(){return this.groupName.toString()},setGroupName:function(e){this.groupName=e},propertyNamed:function(e){return this.properties[e]},objectNamed:function(e){return this.getObject(e)},getObject:function(e){if(this._objects&&this._objects.length>0)for(var t=this._objects,i=0,n=t.length;i<n;i++){var s=t[i].name;if(s&&s===e)return t[i]}return null},getObjects:function(){return this._objects},setObjects:function(e){this._objects.push(e)}}),l.TMXLayer=l.SpriteBatchNode.extend({tiles:null,tileset:null,layerOrientation:null,properties:null,layerName:"",_textures:null,_texGrids:null,_spriteTiles:null,_layerSize:null,_mapTileSize:null,_opacity:255,_minGID:null,_maxGID:null,_vertexZvalue:null,_useAutomaticVertexZ:null,_reusedTile:null,_atlasIndexArray:null,_contentScaleFactor:null,_className:"TMXLayer",ctor:function(e,t,i){l.SpriteBatchNode.prototype.ctor.call(this),this._descendants=[],this._layerSize=l.size(0,0),this._mapTileSize=l.size(0,0),this._spriteTiles={},void 0!==i&&this.initWithTilesetInfo(e,t,i)},_createRenderCmd:function(){return l._renderType===l.game.RENDER_TYPE_CANVAS?new l.TMXLayer.CanvasRenderCmd(this):new l.TMXLayer.WebGLRenderCmd(this)},_fillTextureGrids:function(e,t){var i=this._textures[t];if(i.isLoaded()){e.imageSize.width&&e.imageSize.height||(e.imageSize.width=i.width,e.imageSize.height=i.height);for(var n=e._tileSize.width,s=e._tileSize.height,r=i._contentSize.width,a=i._contentSize.height,o=e.spacing,h=e.margin,l=Math.floor((r-2*h+o)/(n+o)),d=Math.floor((a-2*h+o)/(s+o))*l,c=e.firstGid,u=e.firstGid+d,p=this._texGrids,m=null,_=!!p[c];c<u&&(_&&!p[c]&&(_=!1),_||!p[c]);++c)m={texId:t,x:0,y:0,width:n,height:s,t:0,l:0,r:0,b:0},e.rectForGID(c,m),m.t=m.y/a,m.l=m.x/r,m.r=(m.x+m.width)/r,m.b=(m.y+m.height)/a,p[c]=m}else i.addEventListener("load",function(){this._fillTextureGrids(e,t)},this)},initWithTilesetInfo:function(e,t,i){var n=t._layerSize;parseInt(n.width*n.height);this.layerName=t.name,this.tiles=t._tiles,this.properties=t.properties,this._layerSize=n,this._minGID=t._minGID,this._maxGID=t._maxGID,this._opacity=t._opacity,this.tileset=e,this.layerOrientation=i.orientation,this._mapTileSize=i.getTileSize();var s=i._tilesets;if(s){this._textures=[],this._texGrids=[];var r,a,o,h=s.length;for(r=0;r<h;++r)a=s[r],o=l.textureCache.addImage(a.sourceImage),this._textures.push(o),this._fillTextureGrids(a,r),a===e&&(this._texture=o)}var d=this._calculateLayerOffset(t.offset);return this.setPosition(l.pointPixelsToPoints(d)),this._parseInternalProperties(),this.setContentSize(l.sizePixelsToPoints(l.size(this._layerSize.width*this._mapTileSize.width,this._layerSize.height*this._mapTileSize.height))),this._useAutomaticVertexZ=!1,this._vertexZvalue=0,!0},getLayerSize:function(){return l.size(this._layerSize.width,this._layerSize.height)},setLayerSize:function(e){this._layerSize.width=e.width,this._layerSize.height=e.height},_getLayerWidth:function(){return this._layerSize.width},_setLayerWidth:function(e){this._layerSize.width=e},_getLayerHeight:function(){return this._layerSize.height},_setLayerHeight:function(e){this._layerSize.height=e},getMapTileSize:function(){return l.size(this._mapTileSize.width,this._mapTileSize.height)},setMapTileSize:function(e){this._mapTileSize.width=e.width,this._mapTileSize.height=e.height},_getTileWidth:function(){return this._mapTileSize.width},_setTileWidth:function(e){this._mapTileSize.width=e},_getTileHeight:function(){return this._mapTileSize.height},_setTileHeight:function(e){this._mapTileSize.height=e},getTiles:function(){return this.tiles},setTiles:function(e){this.tiles=e},getTileset:function(){return this.tileset},setTileset:function(e){this.tileset=e},getLayerOrientation:function(){return this.layerOrientation},setLayerOrientation:function(e){this.layerOrientation=e},getProperties:function(){return this.properties},setProperties:function(e){this.properties=e},getProperty:function(e){return this.properties[e]},getLayerName:function(){return this.layerName},setLayerName:function(e){this.layerName=e},releaseMap:function(){this._spriteTiles={}},getTileAt:function(e,t){if(void 0===e)throw new Error("cc.TMXLayer.getTileAt(): pos should be non-null");var i=e;if(void 0===t&&(i=e.x,t=e.y),i>=this._layerSize.width||t>=this._layerSize.height||i<0||t<0)throw new Error("cc.TMXLayer.getTileAt(): invalid position");if(!this.tiles)return l.log("cc.TMXLayer.getTileAt(): TMXLayer: the tiles map has been released"),null;var n=null,s=this.getTileGIDAt(i,t);if(0===s)return n;var r=0|i+t*this._layerSize.width;if(!(n=this._spriteTiles[r])){var a=this._texGrids[s],o=this._textures[a.texId];a=l.rectPixelsToPoints(a),(n=new l.Sprite(o,a)).setPosition(this.getPositionAt(i,t));var h=this._vertexZForPos(i,t);n.setVertexZ(h),n.setAnchorPoint(0,0),n.setOpacity(this._opacity),this.addChild(n,h,r)}return n},getTileGIDAt:function(e,t){if(void 0===e)throw new Error("cc.TMXLayer.getTileGIDAt(): pos should be non-null");var i=e;if(void 0===t&&(i=e.x,t=e.y),i>=this._layerSize.width||t>=this._layerSize.height||i<0||t<0)throw new Error("cc.TMXLayer.getTileGIDAt(): invalid position");if(!this.tiles)return l.log("cc.TMXLayer.getTileGIDAt(): TMXLayer: the tiles map has been released"),null;var n=0|i+t*this._layerSize.width;return(this.tiles[n]&l.TMX_TILE_FLIPPED_MASK)>>>0},setTileGID:function(e,t,i,n){if(void 0===t)throw new Error("cc.TMXLayer.setTileGID(): pos should be non-null");var s;if(void 0!==n?s=l.p(t,i):(s=t,n=i),s.x>=this._layerSize.width||s.y>=this._layerSize.height||s.x<0||s.y<0)throw new Error("cc.TMXLayer.setTileGID(): invalid position");if(this.tiles)if(0!==e&&e<this.tileset.firstGid)l.log("cc.TMXLayer.setTileGID(): invalid gid:"+e);else{n=n||0;var r=this.getTileFlagsAt(s),a=this.getTileGIDAt(s);if(a!==e||r!==n){var o=(e|n)>>>0;if(0===e)this.removeTileAt(s);else if(0===a)this._updateTileForGID(o,s);else{var h=s.x+s.y*this._layerSize.width,d=this.getChildByTag(h);if(d){var c=this._texGrids[e],u=this._textures[c.texId];c=l.rectPixelsToPoints(c),d.setTexture(u),d.setTextureRect(c,!1),null!=n&&this._setupTileSprite(d,s,o),this.tiles[h]=o}else this._updateTileForGID(o,s)}}}else l.log("cc.TMXLayer.setTileGID(): TMXLayer: the tiles map has been released")},addChild:function(e,t,i){l.Node.prototype.addChild.call(this,e,t,i),void 0!==i&&(this._spriteTiles[i]=e,e._vertexZ=this._vertexZ+l.renderer.assignedZStep*i/this.tiles.length)},removeChild:function(e,t){this._spriteTiles[e.tag]&&(this._spriteTiles[e.tag]=null),l.Node.prototype.removeChild.call(this,e,t)},getTileFlagsAt:function(e,t){if(!e)throw new Error("cc.TMXLayer.getTileFlagsAt(): pos should be non-null");if(void 0!==t&&(e=l.p(e,t)),e.x>=this._layerSize.width||e.y>=this._layerSize.height||e.x<0||e.y<0)throw new Error("cc.TMXLayer.getTileFlagsAt(): invalid position");if(!this.tiles)return l.log("cc.TMXLayer.getTileFlagsAt(): TMXLayer: the tiles map has been released"),null;var i=0|e.x+e.y*this._layerSize.width;return(this.tiles[i]&l.TMX_TILE_FLIPPED_ALL)>>>0},removeTileAt:function(e,t){if(!e)throw new Error("cc.TMXLayer.removeTileAt(): pos should be non-null");if(void 0!==t&&(e=l.p(e,t)),e.x>=this._layerSize.width||e.y>=this._layerSize.height||e.x<0||e.y<0)throw new Error("cc.TMXLayer.removeTileAt(): invalid position");if(this.tiles){if(0!==this.getTileGIDAt(e)){var i=0|e.x+e.y*this._layerSize.width;this.tiles[i]=0;var n=this._spriteTiles[i];n&&this.removeChild(n,!0)}}else l.log("cc.TMXLayer.removeTileAt(): TMXLayer: the tiles map has been released")},getPositionAt:function(e,t){void 0!==t&&(e=l.p(e,t));var i=l.p(0,0);switch(this.layerOrientation){case l.TMX_ORIENTATION_ORTHO:i=this._positionForOrthoAt(e);break;case l.TMX_ORIENTATION_ISO:i=this._positionForIsoAt(e);break;case l.TMX_ORIENTATION_HEX:i=this._positionForHexAt(e)}return l.pointPixelsToPoints(i)},_positionForIsoAt:function(e){return l.p(this._mapTileSize.width/2*(this._layerSize.width+e.x-e.y-1),this._mapTileSize.height/2*(2*this._layerSize.height-e.x-e.y-2))},_positionForOrthoAt:function(e){return l.p(e.x*this._mapTileSize.width,(this._layerSize.height-e.y-1)*this._mapTileSize.height)},_positionForHexAt:function(e){var t=e.x%2==1?-this._mapTileSize.height/2:0;return l.p(e.x*this._mapTileSize.width*3/4,(this._layerSize.height-e.y-1)*this._mapTileSize.height+t)},_calculateLayerOffset:function(e){var t=l.p(0,0);switch(this.layerOrientation){case l.TMX_ORIENTATION_ORTHO:t=l.p(e.x*this._mapTileSize.width,-e.y*this._mapTileSize.height);break;case l.TMX_ORIENTATION_ISO:t=l.p(this._mapTileSize.width/2*(e.x-e.y),this._mapTileSize.height/2*(-e.x-e.y));break;case l.TMX_ORIENTATION_HEX:0===e.x&&0===e.y||l.log("offset for hexagonal map not implemented yet")}return t},_updateTileForGID:function(e,t){if(this._texGrids[e]){var i=0|t.x+t.y*this._layerSize.width;i<this.tiles.length&&(this.tiles[i]=e)}},_parseInternalProperties:function(){var e=this.getProperty("cc_vertexz");if(e)if("automatic"===e){this._useAutomaticVertexZ=!0;var t=this.getProperty("cc_alpha_func"),i=0;t&&(i=parseFloat(t)),l._renderType===l.game.RENDER_TYPE_WEBGL&&(this.shaderProgram=l.shaderCache.programForKey(l.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),this.shaderProgram.use(),this.shaderProgram.setUniformLocationWith1f(l.UNIFORM_ALPHA_TEST_VALUE_S,i))}else this._vertexZvalue=parseInt(e,10)},_setupTileSprite:function(e,t,i){t.x,t.y,this._layerSize.width;var n=this.getPositionAt(t);if(e.setPosition(n),e.setVertexZ(this._vertexZForPos(t)),e.setAnchorPoint(0,0),e.setOpacity(this._opacity),e.setFlippedX(!1),e.setFlippedY(!1),e.setRotation(0),(i&l.TMX_TILE_DIAGONAL_FLAG)>>>0){e.setAnchorPoint(.5,.5),e.setPosition(n.x+e.width/2,n.y+e.height/2);var s=(i&(l.TMX_TILE_HORIZONTAL_FLAG|l.TMX_TILE_VERTICAL_FLAG)>>>0)>>>0;s===l.TMX_TILE_HORIZONTAL_FLAG?e.setRotation(90):s===l.TMX_TILE_VERTICAL_FLAG?e.setRotation(270):s===(l.TMX_TILE_VERTICAL_FLAG|l.TMX_TILE_HORIZONTAL_FLAG)>>>0?(e.setRotation(90),e.setFlippedX(!0)):(e.setRotation(270),e.setFlippedX(!0))}else(i&l.TMX_TILE_HORIZONTAL_FLAG)>>>0&&e.setFlippedX(!0),(i&l.TMX_TILE_VERTICAL_FLAG)>>>0&&e.setFlippedY(!0)},_vertexZForPos:function(e,t){void 0===t&&(t=e.y,e=e.x);var i=0;if(this._useAutomaticVertexZ)switch(this.layerOrientation){case l.TMX_ORIENTATION_ISO:i=-(this._layerSize.width+this._layerSize.height-(e+t));break;case l.TMX_ORIENTATION_ORTHO:i=-(this._layerSize.height-t);break;case l.TMX_ORIENTATION_HEX:l.log("TMX Hexa zOrder not supported");break;default:l.log("TMX invalid value")}else i=this._vertexZvalue;return i}});var d=l.TMXLayer.prototype;d.layerWidth,l.defineGetterSetter(d,"layerWidth",d._getLayerWidth,d._setLayerWidth),d.layerHeight,l.defineGetterSetter(d,"layerHeight",d._getLayerHeight,d._setLayerHeight),d.tileWidth,l.defineGetterSetter(d,"tileWidth",d._getTileWidth,d._setTileWidth),d.tileHeight,l.defineGetterSetter(d,"tileHeight",d._getTileHeight,d._setTileHeight),l.TMXLayer.create=function(e,t,i){return new l.TMXLayer(e,t,i)},function(){l.TMXLayer.CanvasRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0};var e=l.TMXLayer.CanvasRenderCmd.prototype=Object.create(l.Node.CanvasRenderCmd.prototype);e.constructor=l.TMXLayer.CanvasRenderCmd,e.visit=function(e){var t=this._node,i=l.renderer;if((e=e||this.getParentRenderCmd())&&(this._curLevel=e._curLevel+1),t._visible){isNaN(t._customZ)&&(t._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),this._syncStatus(e);var n,s,r=t._children,a=t._spriteTiles,o=r.length;if(o>0){for(t.sortAllChildren(),s=0;s<o&&(n=r[s])._localZOrder<0;s++)n._renderCmd.visit(this);for(i.pushRenderCommand(this);s<o;s++)0===(n=r[s])._localZOrder&&a[n.tag]?(isNaN(n._customZ)&&(n._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),n._renderCmd.updateStatus()):n._renderCmd.visit(this)}else i.pushRenderCommand(this);this._dirtyFlag=0}},e.rendering=function(e,t,i){var n=this._node,s=n._rotationX||n._rotationY,r=n.layerOrientation,a=n.tiles,o=n._opacity/255;if(a&&!(o<=0)){var h=n._mapTileSize.width,d=n._mapTileSize.height,c=n.tileset._tileSize.width/l.director._contentScaleFactor,u=n.tileset._tileSize.height/l.director._contentScaleFactor,p=c-h,m=u-d,_=l.winSize.width,g=l.winSize.height,T=n._layerSize.height,f=n._layerSize.width,S=n._texGrids,w=n._spriteTiles,v=this._worldTransform,L=-n._contentSize.width*n._anchorPoint.x,M=-n._contentSize.height*n._anchorPoint.y,C=v.a,y=v.b,B=v.c,F=v.d,E=L*C+M*B+v.tx,P=L*y+M*F+v.ty,b=e||l._renderContext,A=b.getContext(),O=0,I=0,R=f,D=T;s||r!==l.TMX_ORIENTATION_ORTHO||(O=Math.floor(-(E-p*C)/(h*C)),I=Math.floor((P-m*F+d*T*F-g)/(d*F)),R=Math.ceil((_-E+p*C)/(h*C)),D=T-Math.floor(-(P+m*F)/(d*F)),O<0&&(O=0),I<0&&(I=0),R>f&&(R=f),D>T&&(D=T));var x,N,G,W,k,U,H,V,z,Y,X,j,K,q,Q,Z,J=I*f,$=l.TMX_TILE_FLIPPED_MASK,ee=c,te=u,ie=c*C,ne=u*F,se=!1,re=!1;W=J+O;for(x in w)if(x<W&&w[x])V=w[x]._renderCmd,0===w[x]._localZOrder&&V.rendering&&V.rendering(e,t,i);else if(x>=W)break;for(b.setTransform(v,t,i),b.setGlobalAlpha(o),N=I;N<D;++N){for(G=O;G<R;++G)if(W=J+G,w[W])V=w[W]._renderCmd,0===w[W]._localZOrder&&V.rendering&&(V.rendering(e,t,i),b.setTransform(v,t,i),b.setGlobalAlpha(o));else if(k=n.tiles[W],(U=S[(k&$)>>>0])&&(H=n._textures[U.texId])&&H._htmlElementObj){switch(r){case l.TMX_ORIENTATION_ORTHO:Y=G*h,X=-(T-N-1)*d;break;case l.TMX_ORIENTATION_ISO:Y=h/2*(f+G-N-1),X=-d/2*(2*T-G-N-2);break;case l.TMX_ORIENTATION_HEX:Y=G*h*3/4,X=-(T-N-1)*d+(G%2==1?-d/2:0)}if(j=Y+c,z=X-u,!s&&r===l.TMX_ORIENTATION_ISO){if((Q=X*F-P)<-g-ne){G+=Math.floor(2*(-g-Q)/ne)-1;continue}if((Z=E+j*C)<-ie){G+=Math.floor(2*-Z/ie)-1;continue}if(q=E+Y*C,K=z*F-P,q>_||K>0){G=R;continue}}k>l.TMX_TILE_DIAGONAL_FLAG&&(se=(k&l.TMX_TILE_HORIZONTAL_FLAG)>>>0,re=(k&l.TMX_TILE_VERTICAL_FLAG)>>>0),se&&(Y=-j,A.scale(-1,1)),re&&(z=-X,A.scale(1,-1)),A.drawImage(H._htmlElementObj,U.x,U.y,U.width,U.height,Y,z,ee,te),se&&A.scale(-1,1),re&&A.scale(1,-1),l.g_NumberOfDraws++}J+=f}for(x in w)x>W&&w[x]&&(V=w[x]._renderCmd,0===w[x]._localZOrder&&V.rendering&&V.rendering(e,t,i))}}}(),function(){l.TMXLayer.WebGLRenderCmd=function(e){this._rootCtor(e),this._needDraw=!0,this._vertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],this._color=new Uint32Array(1),this._shaderProgram=l.shaderCache.programForKey(l.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST);var t=90*Math.PI/180;this._sin90=Math.sin(t),this._cos90=Math.cos(t),t*=3,this._sin270=Math.sin(t),this._cos270=Math.cos(t)};var e=l.TMXLayer.WebGLRenderCmd.prototype=Object.create(l.Node.WebGLRenderCmd.prototype);e.constructor=l.TMXLayer.WebGLRenderCmd,e.uploadData=function(e,t,i){var n=this._node,s=n._rotationX||n._rotationY,r=n.layerOrientation,a=n.tiles;if(!a)return 0;l.view._scaleX,l.view._scaleY;var o=n._mapTileSize.width,h=n._mapTileSize.height,d=n.tileset._tileSize.width/l.director._contentScaleFactor,c=n.tileset._tileSize.height/l.director._contentScaleFactor,u=d-o,p=c-h,m=l.winSize.width,_=l.winSize.height,g=n._layerSize.height,T=n._layerSize.width,f=n._texGrids,S=n._spriteTiles,w=this._worldTransform,v=w.a,L=w.b,M=w.c,C=w.d,y=w.tx,B=w.ty,F=-n._contentSize.width*n._anchorPoint.x,E=-n._contentSize.height*n._anchorPoint.y,P=F*v+E*M+y,b=F*L+E*C+B,A=n._opacity,O=this._displayedColor.r,I=this._displayedColor.g,R=this._displayedColor.b;if(n._opacityModifyRGB){var D=A/255;O*=D,I*=D,R*=D}this._color[0]=A<<24|R<<16|I<<8|O;var x=0,N=0,G=T,W=g;s||r!==l.TMX_ORIENTATION_ORTHO||(x=Math.floor(-(P-u*v)/(o*v)),N=Math.floor((b-p*C+h*g*C-_)/(h*C)),G=Math.ceil((m-P+u*v)/(o*v)),W=g-Math.floor(-(b+p*C)/(h*C)),x<0&&(x=0),N<0&&(N=0),G>T&&(G=T),W>g&&(W=g));var k,U,H,V,z,Y,X,j,K,q,Q,Z,J,$,ee=i,te=N*T,ie=l.TMX_TILE_FLIPPED_MASK,ne=d*v,se=c*C,re=v,ae=L,oe=M,he=C,le=y,de=B,ce=!1,ue=!1,pe=!1,me=this._vertices;for(k=N;k<W;++k){for(U=x;U<G;++U)if(ee+24>e.length&&(l.renderer._increaseBatchingSize((ee-i)/6),l.renderer._batchRendering(),i=0,ee=0),H=te+U,!S[H]&&(V=n.tiles[H],z=f[(V&ie)>>>0])){switch(r){case l.TMX_ORIENTATION_ORTHO:j=U*o,K=(g-k-1)*h,H=n._vertexZ+l.renderer.assignedZStep*H/a.length;break;case l.TMX_ORIENTATION_ISO:j=o/2*(T+U-k-1),K=h/2*(2*g-U-k-2),H=n._vertexZ+l.renderer.assignedZStep*(n.height-K)/n.height;break;case l.TMX_ORIENTATION_HEX:j=U*o*3/4,K=(g-k-1)*h+(U%2==1?-h/2:0),H=n._vertexZ+l.renderer.assignedZStep*(n.height-K)/n.height}if(q=j+d,X=K+c,!s&&r===l.TMX_ORIENTATION_ISO){if((J=b+K*C)>_+se){U+=Math.floor(2*(J-_)/se)-1;continue}if(($=P+q*v)<-ne){U+=Math.floor(2*-$/ne)-1;continue}if(Z=P+j*v,Q=b+X*C,Z>m||Q<0){U=G;continue}}for(V>l.TMX_TILE_DIAGONAL_FLAG&&(ce=!0,ue=(V&l.TMX_TILE_HORIZONTAL_FLAG)>>>0,pe=(V&l.TMX_TILE_VERTICAL_FLAG)>>>0),me[0].x=j*re+X*oe+le,me[0].y=j*ae+X*he+de,me[1].x=j*re+K*oe+le,me[1].y=j*ae+K*he+de,me[2].x=q*re+X*oe+le,me[2].y=q*ae+X*he+de,me[3].x=q*re+K*oe+le,me[3].y=q*ae+K*he+de,Y=0;Y<4;++Y){switch(e[ee]=me[Y].x,e[ee+1]=me[Y].y,e[ee+2]=H,t[ee+3]=this._color[0],Y){case 0:e[ee+4]=ue?z.r:z.l,e[ee+5]=pe?z.b:z.t;break;case 1:e[ee+4]=ue?z.r:z.l,e[ee+5]=pe?z.t:z.b;break;case 2:e[ee+4]=ue?z.l:z.r,e[ee+5]=pe?z.b:z.t;break;case 3:e[ee+4]=ue?z.l:z.r,e[ee+5]=pe?z.t:z.b}ee+=6}ce&&(re=v,ae=L,oe=M,he=C,le=y,de=B,ue=!1,pe=!1,ce=!1)}te+=T}return(ee-i)/6}}(),l.SCENE_FADE=4208917214,l.TRANSITION_ORIENTATION_LEFT_OVER=0,l.TRANSITION_ORIENTATION_RIGHT_OVER=1,l.TRANSITION_ORIENTATION_UP_OVER=0,l.TRANSITION_ORIENTATION_DOWN_OVER=1,l.TransitionScene=l.Scene.extend({_inScene:null,_outScene:null,_duration:null,_isInSceneOnTop:!1,_isSendCleanupToScene:!1,_className:"TransitionScene",ctor:function(e,t){l.Scene.prototype.ctor.call(this),void 0!==e&&void 0!==t&&this.initWithDuration(e,t)},_setNewScene:function(e){this.unschedule(this._setNewScene);var t=l.director;this._isSendCleanupToScene=t.isSendCleanupToScene(),t.runScene(this._inScene),l.eventManager.setEnabled(!0),this._outScene.visible=!0},_sceneOrder:function(){this._isInSceneOnTop=!0},visit:function(){this._isInSceneOnTop?(this._outScene.visit(),this._inScene.visit()):(this._inScene.visit(),this._outScene.visit()),l.Node.prototype.visit.call(this)},onEnter:function(){l.Node.prototype.onEnter.call(this),l.eventManager.setEnabled(!1),this._outScene._performRecursive(l.Node._stateCallbackType.onExitTransitionDidStart),this._inScene._performRecursive(l.Node._stateCallbackType.onEnter)},onExit:function(){l.Node.prototype.onExit.call(this),l.eventManager.setEnabled(!0),this._outScene._performRecursive(l.Node._stateCallbackType.onExit),this._inScene._performRecursive(l.Node._stateCallbackType.onEnterTransitionDidFinish)},cleanup:function(){l.Node.prototype.cleanup.call(this),this._isSendCleanupToScene&&this._outScene._performRecursive(l.Node._stateCallbackType.cleanup)},initWithDuration:function(e,t){if(!t)throw new Error("cc.TransitionScene.initWithDuration(): Argument scene must be non-nil");if(this.init()){if(this._duration=e,this.attr({x:0,y:0,anchorX:0,anchorY:0}),this._inScene=t,this._outScene=l.director.getRunningScene(),this._outScene||(this._outScene=new l.Scene,this._outScene.init()),this._inScene===this._outScene)throw new Error("cc.TransitionScene.initWithDuration(): Incoming scene must be different from the outgoing scene");return this._sceneOrder(),!0}return!1},finish:function(){this._inScene.attr({visible:!0,x:0,y:0,scale:1,rotation:0}),this._outScene.attr({visible:!1,x:0,y:0,scale:1,rotation:0}),this.schedule(this._setNewScene,0)},hideOutShowIn:function(){this._inScene.visible=!0,this._outScene.visible=!1}}),l.TransitionScene.create=function(e,t){return new l.TransitionScene(e,t)},l.TransitionSceneOriented=l.TransitionScene.extend({_orientation:0,ctor:function(e,t,i){l.TransitionScene.prototype.ctor.call(this),void 0!=i&&this.initWithDuration(e,t,i)},initWithDuration:function(e,t,i){return l.TransitionScene.prototype.initWithDuration.call(this,e,t)&&(this._orientation=i),!0}}),l.TransitionSceneOriented.create=function(e,t,i){return new l.TransitionSceneOriented(e,t,i)},l.TransitionRotoZoom=l.TransitionScene.extend({ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:.5,anchorY:.5}),this._outScene.attr({scale:1,anchorX:.5,anchorY:.5});var e=l.sequence(l.spawn(l.scaleBy(this._duration/2,.001),l.rotateBy(this._duration/2,720)),l.delayTime(this._duration/2));this._outScene.runAction(e),this._inScene.runAction(l.sequence(e.reverse(),l.callFunc(this.finish,this)))}}),l.TransitionRotoZoom.create=function(e,t){return new l.TransitionRotoZoom(e,t)},l.TransitionJumpZoom=l.TransitionScene.extend({ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this);var e=l.director.getWinSize();this._inScene.attr({scale:.5,x:e.width,y:0,anchorX:.5,anchorY:.5}),this._outScene.anchorX=.5,this._outScene.anchorY=.5;var t=l.jumpBy(this._duration/4,l.p(-e.width,0),e.width/4,2),i=l.scaleTo(this._duration/4,1),n=l.scaleTo(this._duration/4,.5),s=l.sequence(n,t),r=l.sequence(t,i),a=l.delayTime(this._duration/2);this._outScene.runAction(s),this._inScene.runAction(l.sequence(a,r,l.callFunc(this.finish,this)))}}),l.TransitionJumpZoom.create=function(e,t){return new l.TransitionJumpZoom(e,t)},l.TransitionMoveInL=l.TransitionScene.extend({ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this),this.initScenes();var e=this.action();this._inScene.runAction(l.sequence(this.easeActionWithAction(e),l.callFunc(this.finish,this)))},initScenes:function(){this._inScene.setPosition(-l.director.getWinSize().width,0)},action:function(){return l.moveTo(this._duration,l.p(0,0))},easeActionWithAction:function(e){return new l.EaseOut(e,2)}}),l.TransitionMoveInL.create=function(e,t){return new l.TransitionMoveInL(e,t)},l.TransitionMoveInR=l.TransitionMoveInL.extend({ctor:function(e,t){l.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(l.director.getWinSize().width,0)}}),l.TransitionMoveInR.create=function(e,t){return new l.TransitionMoveInR(e,t)},l.TransitionMoveInT=l.TransitionMoveInL.extend({ctor:function(e,t){l.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(0,l.director.getWinSize().height)}}),l.TransitionMoveInT.create=function(e,t){return new l.TransitionMoveInT(e,t)},l.TransitionMoveInB=l.TransitionMoveInL.extend({ctor:function(e,t){l.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(0,-l.director.getWinSize().height)}}),l.TransitionMoveInB.create=function(e,t){return new l.TransitionMoveInB(e,t)},l.ADJUST_FACTOR=.5,l.TransitionSlideInL=l.TransitionScene.extend({ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this),this.initScenes();var e=this.action(),t=this.action(),i=l.sequence(this.easeActionWithAction(e),l.callFunc(this.finish,this)),n=this.easeActionWithAction(t);this._inScene.runAction(i),this._outScene.runAction(n)},initScenes:function(){this._inScene.setPosition(-l.director.getWinSize().width+l.ADJUST_FACTOR,0)},action:function(){return l.moveBy(this._duration,l.p(l.director.getWinSize().width-l.ADJUST_FACTOR,0))},easeActionWithAction:function(e){return new l.EaseInOut(e,2)}}),l.TransitionSlideInL.create=function(e,t){return new l.TransitionSlideInL(e,t)},l.TransitionSlideInR=l.TransitionSlideInL.extend({ctor:function(e,t){l.TransitionSlideInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(l.director.getWinSize().width-l.ADJUST_FACTOR,0)},action:function(){return l.moveBy(this._duration,l.p(-(l.director.getWinSize().width-l.ADJUST_FACTOR),0))}}),l.TransitionSlideInR.create=function(e,t){return new l.TransitionSlideInR(e,t)},l.TransitionSlideInB=l.TransitionSlideInL.extend({ctor:function(e,t){l.TransitionSlideInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},initScenes:function(){this._inScene.setPosition(0,-(l.director.getWinSize().height-l.ADJUST_FACTOR))},action:function(){return l.moveBy(this._duration,l.p(0,l.director.getWinSize().height-l.ADJUST_FACTOR))}}),l.TransitionSlideInB.create=function(e,t){return new l.TransitionSlideInB(e,t)},l.TransitionSlideInT=l.TransitionSlideInL.extend({ctor:function(e,t){l.TransitionSlideInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(0,l.director.getWinSize().height-l.ADJUST_FACTOR)},action:function(){return l.moveBy(this._duration,l.p(0,-(l.director.getWinSize().height-l.ADJUST_FACTOR)))}}),l.TransitionSlideInT.create=function(e,t){return new l.TransitionSlideInT(e,t)},l.TransitionShrinkGrow=l.TransitionScene.extend({ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:2/3,anchorY:.5}),this._outScene.attr({scale:1,anchorX:1/3,anchorY:.5});var e=l.scaleTo(this._duration,.01),t=l.scaleTo(this._duration,1);this._inScene.runAction(l.sequence(this.easeActionWithAction(t),l.callFunc(this.finish,this))),this._outScene.runAction(this.easeActionWithAction(e))},easeActionWithAction:function(e){return new l.EaseOut(e,2)}}),l.TransitionShrinkGrow.create=function(e,t){return new l.TransitionShrinkGrow(e,t)},l.TransitionFade=l.TransitionScene.extend({_color:null,ctor:function(e,t,i){l.TransitionScene.prototype.ctor.call(this),this._color=l.color(),t&&this.initWithDuration(e,t,i)},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this);var e=new l.LayerColor(this._color);this._inScene.visible=!1,this.addChild(e,2,l.SCENE_FADE);var t=this.getChildByTag(l.SCENE_FADE),i=l.sequence(l.fadeIn(this._duration/2),l.callFunc(this.hideOutShowIn,this),l.fadeOut(this._duration/2),l.callFunc(this.finish,this));t.runAction(i)},onExit:function(){l.TransitionScene.prototype.onExit.call(this),this.removeChildByTag(l.SCENE_FADE,!1)},initWithDuration:function(e,t,i){return i=i||l.color.BLACK,l.TransitionScene.prototype.initWithDuration.call(this,e,t)&&(this._color.r=i.r,this._color.g=i.g,this._color.b=i.b,this._color.a=0),!0}}),l.TransitionFade.create=function(e,t,i){return new l.TransitionFade(e,t,i)},l.TransitionCrossFade=l.TransitionScene.extend({ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this);var e=l.color(0,0,0,0),t=l.director.getWinSize(),i=new l.LayerColor(e),n=new l.RenderTexture(t.width,t.height);n.sprite.anchorX=.5,n.sprite.anchorY=.5,n.attr({x:t.width/2,y:t.height/2,anchorX:.5,anchorY:.5}),n.begin(),this._inScene.visit(),n.end();var s=new l.RenderTexture(t.width,t.height);s.setPosition(t.width/2,t.height/2),s.sprite.anchorX=s.anchorX=.5,s.sprite.anchorY=s.anchorY=.5,s.begin(),this._outScene.visit(),s.end(),n.sprite.setBlendFunc(l.ONE,l.ONE),s.sprite.setBlendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),i.addChild(n),i.addChild(s),n.sprite.opacity=255,s.sprite.opacity=255;var r=l.sequence(l.fadeTo(this._duration,0),l.callFunc(this.hideOutShowIn,this),l.callFunc(this.finish,this));s.sprite.runAction(r),this.addChild(i,2,l.SCENE_FADE)},onExit:function(){this.removeChildByTag(l.SCENE_FADE,!1),l.TransitionScene.prototype.onExit.call(this)}}),l.TransitionCrossFade.create=function(e,t){return new l.TransitionCrossFade(e,t)},l.TransitionTurnOffTiles=l.TransitionScene.extend({_gridProxy:null,ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),this._gridProxy=new l.NodeGrid,t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy._performRecursive(l.Node._stateCallbackType.onEnter);var e=l.director.getWinSize(),t=0|12*(e.width/e.height),i=l.turnOffTiles(this._duration,l.size(t,12)),n=this.easeActionWithAction(i);this._gridProxy.runAction(l.sequence(n,l.callFunc(this.finish,this),l.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(e){return e}}),l.TransitionTurnOffTiles.create=function(e,t){return new l.TransitionTurnOffTiles(e,t)},l.TransitionSplitCols=l.TransitionScene.extend({_gridProxy:null,_switchTargetToInscene:function(){this._gridProxy.setTarget(this._inScene)},ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),this._gridProxy=new l.NodeGrid,t&&this.initWithDuration(e,t)},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy._performRecursive(l.Node._stateCallbackType.onEnter);var e=this.action(),t=l.sequence(e,l.callFunc(this._switchTargetToInscene,this),e.reverse());this._gridProxy.runAction(l.sequence(this.easeActionWithAction(t),l.callFunc(this.finish,this),l.stopGrid()))},onExit:function(){this._gridProxy.setTarget(null),this._gridProxy._performRecursive(l.Node._stateCallbackType.onExit),l.TransitionScene.prototype.onExit.call(this)},visit:function(){this._gridProxy.visit()},easeActionWithAction:function(e){return new l.EaseInOut(e,3)},action:function(){return l.splitCols(this._duration/2,3)}}),l.TransitionSplitCols.create=function(e,t){return new l.TransitionSplitCols(e,t)},l.TransitionSplitRows=l.TransitionSplitCols.extend({ctor:function(e,t){l.TransitionSplitCols.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},action:function(){return l.splitRows(this._duration/2,3)}}),l.TransitionSplitRows.create=function(e,t){return new l.TransitionSplitRows(e,t)},l.TransitionFadeTR=l.TransitionScene.extend({_gridProxy:null,ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),this._gridProxy=new l.NodeGrid,t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy._performRecursive(l.Node._stateCallbackType.onEnter);var e=l.director.getWinSize(),t=0|12*(e.width/e.height),i=this.actionWithSize(l.size(t,12));this._gridProxy.runAction(l.sequence(this.easeActionWithAction(i),l.callFunc(this.finish,this),l.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(e){return e},actionWithSize:function(e){return l.fadeOutTRTiles(this._duration,e)}}),l.TransitionFadeTR.create=function(e,t){return new l.TransitionFadeTR(e,t)},l.TransitionFadeBL=l.TransitionFadeTR.extend({ctor:function(e,t){l.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return l.fadeOutBLTiles(this._duration,e)}}),l.TransitionFadeBL.create=function(e,t){return new l.TransitionFadeBL(e,t)},l.TransitionFadeUp=l.TransitionFadeTR.extend({ctor:function(e,t){l.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return new l.FadeOutUpTiles(this._duration,e)}}),l.TransitionFadeUp.create=function(e,t){return new l.TransitionFadeUp(e,t)},l.TransitionFadeDown=l.TransitionFadeTR.extend({ctor:function(e,t){l.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return l.fadeOutDownTiles(this._duration,e)}}),l.TransitionFadeDown.create=function(e,t){return new l.TransitionFadeDown(e,t)},l.SCENE_RADIAL=49153,l.TransitionProgress=l.TransitionScene.extend({_to:0,_from:0,_sceneToBeModified:null,_className:"TransitionProgress",ctor:function(e,t){l.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_setAttrs:function(e,t,i){e.attr({x:t,y:i,anchorX:.5,anchorY:.5})},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this),this._setupTransition();var e=l.director.getWinSize(),t=new l.RenderTexture(e.width,e.height);t.sprite.anchorX=.5,t.sprite.anchorY=.5,this._setAttrs(t,e.width/2,e.height/2),t.clear(0,0,0,1),t.begin(),this._sceneToBeModified.visit(),t.end(),this._sceneToBeModified===this._outScene&&this.hideOutShowIn();var i=this._progressTimerNodeWithRenderTexture(t),n=l.sequence(l.progressFromTo(this._duration,this._from,this._to),l.callFunc(this.finish,this));i.runAction(n),this.addChild(i,2,l.SCENE_RADIAL)},onExit:function(){this.removeChildByTag(l.SCENE_RADIAL,!0),l.TransitionScene.prototype.onExit.call(this)},_setupTransition:function(){this._sceneToBeModified=this._outScene,this._from=100,this._to=0},_progressTimerNodeWithRenderTexture:function(e){return l.log("cc.TransitionProgress._progressTimerNodeWithRenderTexture(): should be overridden in subclass"),null},_sceneOrder:function(){this._isInSceneOnTop=!1}}),l.TransitionProgress.create=function(e,t){return new l.TransitionProgress(e,t)},l.TransitionProgressRadialCCW=l.TransitionProgress.extend({ctor:function(e,t){l.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=l.director.getWinSize(),i=new l.ProgressTimer(e.sprite);return l._renderType===l.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=l.ProgressTimer.TYPE_RADIAL,i.reverseDir=!1,i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),l.TransitionProgressRadialCCW.create=function(e,t){return new l.TransitionProgressRadialCCW(e,t)},l.TransitionProgressRadialCW=l.TransitionProgress.extend({ctor:function(e,t){l.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=l.director.getWinSize(),i=new l.ProgressTimer(e.sprite);return l._renderType===l.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=l.ProgressTimer.TYPE_RADIAL,i.reverseDir=!0,i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),l.TransitionProgressRadialCW.create=function(e,t){var i=new l.TransitionProgressRadialCW;return null!==i&&i.initWithDuration(e,t)?i:new l.TransitionProgressRadialCW(e,t)},l.TransitionProgressHorizontal=l.TransitionProgress.extend({ctor:function(e,t){l.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=l.director.getWinSize(),i=new l.ProgressTimer(e.sprite);return l._renderType===l.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=l.ProgressTimer.TYPE_BAR,i.midPoint=l.p(1,0),i.barChangeRate=l.p(1,0),i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),l.TransitionProgressHorizontal.create=function(e,t){return new l.TransitionProgressHorizontal(e,t)},l.TransitionProgressVertical=l.TransitionProgress.extend({ctor:function(e,t){l.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=l.director.getWinSize(),i=new l.ProgressTimer(e.sprite);return l._renderType===l.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=l.ProgressTimer.TYPE_BAR,i.midPoint=l.p(0,0),i.barChangeRate=l.p(0,1),i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),l.TransitionProgressVertical.create=function(e,t){return new l.TransitionProgressVertical(e,t)},l.TransitionProgressInOut=l.TransitionProgress.extend({ctor:function(e,t){l.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=l.director.getWinSize(),i=new l.ProgressTimer(e.sprite);return l._renderType===l.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=l.ProgressTimer.TYPE_BAR,i.midPoint=l.p(.5,.5),i.barChangeRate=l.p(1,1),i.percentage=0,this._setAttrs(i,t.width/2,t.height/2),i},_sceneOrder:function(){this._isInSceneOnTop=!1},_setupTransition:function(){this._sceneToBeModified=this._inScene,this._from=0,this._to=100}}),l.TransitionProgressInOut.create=function(e,t){return new l.TransitionProgressInOut(e,t)},l.TransitionProgressOutIn=l.TransitionProgress.extend({ctor:function(e,t){l.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=l.director.getWinSize(),i=new l.ProgressTimer(e.sprite);return l._renderType===l.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=l.ProgressTimer.TYPE_BAR,i.midPoint=l.p(.5,.5),i.barChangeRate=l.p(1,1),i.percentage=100,this._setAttrs(i,t.width/2,t.height/2),i}}),l.TransitionProgressOutIn.create=function(e,t){return new l.TransitionProgressOutIn(e,t)},l.TransitionPageTurn=l.TransitionScene.extend({ctor:function(e,t,i){l.TransitionScene.prototype.ctor.call(this),this._gridProxy=new l.NodeGrid,this.initWithDuration(e,t,i)},_back:!0,_gridProxy:null,_className:"TransitionPageTurn",initWithDuration:function(e,t,i){return this._back=i,l.TransitionScene.prototype.initWithDuration.call(this,e,t),!0},actionWithSize:function(e){return this._back?l.reverseTime(l.pageTurn3D(this._duration,e)):l.pageTurn3D(this._duration,e)},onEnter:function(){l.TransitionScene.prototype.onEnter.call(this);var e,t,i=l.director.getWinSize();i.width>i.height?(e=16,t=12):(e=12,t=16);var n=this.actionWithSize(l.size(e,t)),s=this._gridProxy;this._back?(s.setTarget(this._inScene),s._performRecursive(l.Node._stateCallbackType.onEnter),this._inScene.visible=!1,s.runAction(l.sequence(n,l.callFunc(this.finish,this),l.stopGrid())),this._inScene.runAction(l.show())):(s.setTarget(this._outScene),s._performRecursive(l.Node._stateCallbackType.onEnter),s.runAction(l.sequence(n,l.callFunc(this.finish,this),l.stopGrid())))},visit:function(){this._back?this._outScene.visit():this._inScene.visit(),this._gridProxy.visit()},_sceneOrder:function(){this._isInSceneOnTop=this._back}}),l.TransitionPageTurn.create=function(e,t,i){return new l.TransitionPageTurn(e,t,i)},String.prototype.contains=function(e){return this.indexOf(e)>-1},String.prototype.trim=function(e){return e?this.trimEnd(e).trimStart(e):this.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"")},String.prototype.trimEnd=function(e){return this.endsWith(e)?this.substring(0,this.length-e.length):this},String.prototype.trimStart=function(e){return this.startsWith(e)?this.slice(e.length):this},String.prototype.startsWith=function(e){return 0==this.indexOf(e)},String.prototype.endsWith=function(e){return e.length<=this.length&&this.substr(this.length-e.length,e.length)==e},String.prototype.remove=function(e,t){return this.substring(0,e)+this.substring(e+t,this.length)},String.prototype.insert=function(e,t){return this.substring(0,e)+t+this.substring(e,this.length)},String.prototype.getHash=function(){for(var e=31,t=0,i=this.length;t<i;)e^=(e<<5)+(e>>2)+this.charCodeAt(t++);return e},String._formaterC=/%(\d?\.?\d?)?([dsful]{1,2})/,String.formatC=function(){for(var e=arguments[0],t=String._formaterC,i=null,n=1;n<arguments.length;n++){i=arguments[n];var s=t.exec(e);if(!s)break;if(s.length>2&&s[1]){var r=s[2],a=s[1],o=a.indexOf("."),h=6;switch(-1!=o&&(a=a.substr(o+1)),h=parseInt(a),r){case"d":case"lu":case"l":if((i=i.toString()).length<h)for(h-=i.length;h;)i="0"+i,h--;break;case"f":i=i.toFixed(h).toString()}}e=e.replace(s[0],i)}return e},String._formater=[],String.format=function(){for(var e=arguments[0],t=0,i=1;i<arguments.length;i++){t=i-1;var n=String._formater[t];void 0===n&&(n=new RegExp("\\{"+t+"\\}","ig"),String._formater[t]=n),e=e.replace(n,arguments[i].toString())}return e},Array.indexOf=function(e,t){for(var i=0;i<e.length;i++)if(t===e[i])return i;return-1},Array.contains=function(e,t){return-1!=e.indexOf(t)},Array.remove=function(e,t){var i=e.indexOf(t);-1!=i&&e.splice(i,1)},Object.defineProperty(Array.prototype,"remove",{value:function(e){return Array.remove(this,e),this},enumerable:!1});var F=function(){return parseInt(1e8*Math.random())},E={};E.EventName={},E.EventName.OPEN_UNLOCK_UP_LAYER="open_unlock_up_layer",E.EventName.UNLOCK_UP="unlock_up",E.EventName.GP_UPDATE_GROUP="gp_update_group",E.EventName.GP_CREATE_MENU_LAYER="gp_create_menu_layer",E.EventName.GP_REMOVE_MENU_LAYER="gp_remove_menu_layer",E.EventName.GP_MONSTER_EAT_CARROT="gp_monster_eat_carrot",E.EventName.GP_UPDATE_CARROT_BLOOD="gp_update_carrot_blood",E.EventName.GP_CREATE_TOWER="gp_create_tower",E.EventName.GP_REMOVE_BULLET="gp_remove_bullet",E.EventName.GP_DESTROY="gp_destroy_target",E.EventName.GP_GAME_OVER="gp_game_over";var P={};P.IS_UP_UNLOCK_KEY="is_up_unlock_key";var b={},A=GamePlatform.isCN();b.NetWork_Hint=A?"网络错误({0})，请求数据失败":"Network error{0},request data failed",b.NetWork_Hint1=A?"连接服务器超时,请重新登录。":"Connection to server timed out,Please login again.",b.NetWork_Hint2=A?"账号无效":"Invalid account",b.NetWork_Hint3=A?"服务器故障":"Server failure",b.NetWork_Hint4=A?"请求被重置":"The request is reset",b.NetWork_Hint5=A?"网络错误，请求服务器数据失败了！":"Network error,request server data failed",b.NetWork_Hint6=A?"请重新打开面板！":"Please reopen the panel",b.NetWork_Hint7=A?"请重新连接！":"Please reconnect!",b.NetWork_Hint8=A?"网络连接失败,请重试！":"Network connection failed, please try again!",b.NetWork_Hint9=A?"保存游戏数据出错: {0}":"Saving game data error: {0}",b.NetWork_Hint10=A?"服务器出现异常！请稍后重试":"Server exception! Please try again later!",b.NetWork_Hint11=A?"网络似乎不给力，\n请重试。":"Network not work, please try again.",b.NetWork_Hint12=A?"获取用户数据失败！\n请检查网络！":"Get user data failed! Please check network!",b.NetWork_Hint13=A?"授权":"authorization",b.NetWork_Hint14=A?"正在登录......":"login.....",b.NetWork_Hint15=A?"玩命加载中...":"loading.....",b.NetWork_Hint16=A?"确定重新启动游戏吗?":"Do you decide to restart the game.",b.Dialog_Hint=A?"宝石不足,无法兑换!":"Gems not enough, can't exchange",b.Dialog_Hint1=A?"累计登录的天数未达成,无法获取奖励!":"Total login days not reached, can't claim the rewards!",b.Dialog_Hint2=A?"已经领取过奖励了! 请勿重复领取...":"Already claimed reward! Please don't claim again…",b.Dialog_Hint3=A?"领取成功!":"Claim success!",b.Dialog_Hint4=A?"兑换成功":"Exchange success",b.Dialog_Hint5=A?"已达最大可通关层次,敬请期待新的层次开放!":"Reach the max level, please wait for the new level.",b.Dialog_Hint6=A?"活动已结束！敬请期待下次活动！":"Event already finished! Please look forward to the new event",b.Dialog_Hint7=A?"获取物品ID失败，请关闭面板重新点击物品进行购买！":"Get item ID failed, Please repurchase.",b.Dialog_Hint8=A?"获取好友信息失败。请稍后重试!":"Get friend information failed. Please try again later.",b.Dialog_Hint9=A?"确定要用宝石解锁天天向上吗？":"Do you decide to unlock UP! UP! by gems?",b.Dialog_Hint10=A?"残局分享成功":"Stage share success",b.Dialog_Hint11=A?"恭喜你帮 {0} \n打通了第{1}关":"Congratulations！ You help {0} pass the No.{1} level",b.Record_Text=A?"第%d天":"%d day",b.Mail_Text=A?"最多显示30封邮件":"Most display 30 mails",b.Mail_Text1=A?"恭喜获得：":"Congratulations:",b.Mail_Text2=A?"咦~还没有人给我写邮件":"No mails",b.Mail_Text3=A?"送给你%lu颗":"send you %lu",b.Mail_Text4=A?"一年前收到":"Received a year ago",b.Mail_Text5=A?"来自未来":"From the future",b.Share_Title=A?"保卫萝卜-迅玩版":"Carrot Defense",b.Share_Title1=A?"连主题都是爱你的形状":"",b.Share_Title2=A?"快看我超萌超酷的藏品":"",b.Share_Title3=A?"通关！无敌是多么寂寞":"",b.Share_Title4=A?"大吉大利，萝卜等你":"",b.Share_Title5=A?"每日一战，不见不散":"",b.Share_Title6=A?"天天向上，就差你一个":"",b.Share_Title7=A?"我比tfboys还要努力":"",b.Share_Title8=A?"看我实力与美貌并存":"",b.Share_Title9=A?"你的好友排名竟然是……":"",b.Share_Title10=A?"无敌的寂寞，你懂么":"",b.Share_Title11=A?"大吉大利，今晚丛林主题":"",b.Share_Title12=A?"C哩C哩，开启冰川主题":"",b.Share_Title13=A?"天际主题，目标绝地岛":"",b.Share_Title14=A?"我的热情点亮整个沙漠":"",b.Share_Title15=A?"极地主题，一首凉凉送你":"",b.Share_Title16=A?"浮冰主题，萝卜不怕":"",b.Share_Title17=A?"冰岛乱斗，萝卜需要你":"",b.Share_Title18=A?"神秘庄园萝卜事件":"",b.Share_Title19=A?"获得新角色—阿达":"",b.Share_Title20=A?"获得新角色—阿呆":"",b.Share_Title21=A?"获得新角色—阿秋":"",b.ShareText1=A?"大吉大利，今晚开战！":"",b.ShareText2=A?"我已开启了这么多炮塔，腻不腻害！":"",b.ShareText3=A?"我们不一样，我高智商第一时间通关":"",b.ShareText4=A?"召唤新萝卜，又双叒叕来萌翻你！":"",b.ShareText5=A?"七连绝胜，忍不住为自己打call":"",b.ShareText6=A?"随手分享，水逆退散":"",b.ShareText7=A?"又完成一关，每天进步一点点":"",b.ShareText8=A?"塔防达人在此，来看你能排第几":"",b.ShareText9=A?"塔防mvp在此，你来抢第2吧":"",b.ShareText10=A?"与欧气无关，超越全凭实力":"",b.ShareText11=A?"在这里，守望丛林和你的回忆！":"",b.ShareText12=A?"快夸我，不服来solo！":"",b.ShareText13=A?"看！那有一朵可爱的云":"",b.ShareText14=A?"敢来入侵我沙漠萝卜，打得你落地成盒":"",b.ShareText15=A?"帅气的我登场了，给你一个超模的凝视":"",b.ShareText16=A?"走进冰爽世界，小小萝卜圈地自萌！":"",b.ShareText17=A?"保卫萝卜，胜利在望！":"",b.ShareText18=A?"av8d快来一起嗨嗨嗨！":"",b.ShareText19=A?"从未见过如此火气冲天的萝卜！":"",b.ShareText20=A?"我在终点等你，请开始你的表演":"",b.ShareText21=A?"你是我的大本命，我是不是你的理想型？":"",b.ShareText22=A?"微笑，仿佛你从未被吃掉过":"",b.ShareText23=A?"今天能吃下的，就别搁到明天":"",b.ShareText24=A?"做一些不可能的事，其实蛮好玩的":"",b.ShareText25=A?"工作好有趣，特别是看别人工作":"",b.Share_Qun=A?"本群胡萝北排名发榜啦，看看你排第几":"The carrot ranking of group is coming, check where are you!",b.Share_Text=A?"#保卫萝卜-迅玩版# 看我爬到多少层了！来追我呀！！":"Carrot Defense Look where I am, come and catch me!",b.Share_Text1=A?"保卫萝卜-迅玩版#我的极地冒险通关啦！期待新的旅程早日开启！！":"Carrot Defense I passed all levels! Look forward the new journey!",b.Share_Text2=A?"全新冒险“天天向上”正式开启，赶快来挑战吧！":"New adcentury UP! UP! unlock now, come and challenge it!",b.Share_Text3=A?"全部宝石,一天不差":"All gems, All days",b.Share_Text4=A?"我收集这么多炮塔啦！":"I already collected so many towers!",b.Share_Text5=A?"冰川主题已开启,快来感受一下!":"Glacier theme is unlock, just try it!",b.Share_Text6=A?"看那有一朵可爱的云,天际主题已开启!":"Look, there is a lovely cloud, The Skyline theme unlock!",b.Share_Text7=A?"沙漠主题开启,金萝卜可没那么容易!":"Desert theme unlock, the golden carrot not easy!",b.Share_Text8=A?"欢迎来到极地主题,小怪物们哪里跑!":"Welcome to Ice theme, don't run, monsters!",b.Share_Text9=A?"浮冰主题开启,保卫萝卜势在必行!":"Floating ice theme unlock, go to protect the carrot!",b.Share_Text10=A?"冰岛主题来袭,胜利在望!":"Iceland theme unlock, victory is in sight!",b.Share_Text11=A?"萝卜在我手里,你再不来我可就把它吃掉了!":"The carrot in my hand, I will eat it if you didn't come!",b.Share_Text12=A?"解锁新角色--阿秋,我是不是比阿波美哦?":"Unlock new carrot -- Ms.Qiu Do you think I'm beautiful then Mr.Bo?",b.Share_Text13=A?"解锁新角色--阿呆,想吃我没那么容易!":"Unlock new carrot -- Mr.Dai Eat me is not easy.",b.Share_Text14=A?"解锁新角色--阿达,看看我的火气有多大!":"Unlock new carrot -- Mr.Da Look how angry I am!",b.Share_Text15=A?"我解锁了全新角色，你快来看看啊！！！":"I unlock the new carrot, Did you want one?",b.Share_Text16=A?"今天，也要和阿波一起很努力的保卫萝卜!":"Today, try your best to protect the carrot!",b.Share_Text17=A?"可爱而不负憧憬的旅程，从阿波开启":"Cut journey with Mr.Bo!",b.Share_Text18=A?"旋转跳跃闭着眼，萝卜也能肩负塔防重任？":"The carrot can shoulder the defense task!",b.Share_Text19=A?"谁说小可爱没有大脾气？先过阿波这一关！":"Cut carrot has big temper! ",b.Share_Text20=A?"塔防还能这样玩，跟随史上最萌萝卜开启大冒险":"Play tower defense game with the super cut carrot!",b.Share_Text21=A?"在冰川沙漠中，捍卫属于自己的萝卜":"Portect your carrot in glacier and desert!",b.Share_Text22=A?"这是一场奇妙的旅程，这里有只呆萌的萝卜等你守护":"It was a wonderful journey, there is a super cut carrot waiting your portect!",b.Share_Text23=A?"丑萌的小怪物想吃萝卜？谁给你的勇气？！":"Who give you the courage to eat carrot?",b.Share_Text24=A?"求高手帮我解一下这个残局吧！":"I need your help to pass this level!",b.Share_Text25=A?"无需下载，点开即玩，软萌的萝卜需要你我一起保卫！":"No need download, click to play, super cute carrot need your protect!",b.Share_Text26=A?"砍价成功\n欢迎回到保卫萝卜世界":"",b.Share_Text27=A?"只能帮同一个小伙伴砍价一次哦":"",b.Share_Text28=A?"好友的砍价次数已满":"",b.Share_Text29=A?"砍价失败，\n每人只能帮10个好友砍价":"",b.Share_Text30=A?"想要免费的阿秋~帮我砍价呗":"",b.waiting_For_You=A?"有%d个好友已经在保卫萝卜了哦～":"",b.Name=A?"萝卜守护者":"Carrot Guardian",b.Life=A?"生命星":"Life star",b.Diamond=A?"宝石":"Gems",b.Prop_1=A?"超级炸弹":"BOMB",b.Prop_2=A?"急救包":"HEAL",b.Prop_3=A?"极速攻击":"ATTACK BOOST",b.Prop_4=A?"全屏冰冻":"FROZEN",b.Prop_5=A?"全屏减速":"DECELERATION";var O={};O.kUsersConfigFile="UserData.data",O.kUsersConfigFileICloud="UserData.data",O.kLevelDefineFile="Data/LevelDefines.data",O.kObjectDefineFile="Data/ObjectDefines.data",O.kGamePlayedFile="Config.data",O.kIsPause="pause",O.kPlayedLevel="playedlevel",O.kPlayedFinalLevel="PlayedFinalLevel",O.kUserName="username",O.kPlayedScores="scores",O.kTimeTag="timetag",O.kChannelConfig="channelConfig",O.kObjectGroup="OBJECT",O.kTowerGroup="TOWERS",O.kMonsterGroup="MONSTER",O.kLevelCount="LevelCount",O.kHaveAnimation="HaveAnimation",O.kObjType="Type",O.kObjSize="Size",O.kObjName="Name",O.kObjHP="HP",O.kObjMoney="Money",O.kObjPic="Pic",O.kObjSpeed="Speed",O.kOTowerPower="TowerPower",O.kOTExPower="ExPower",O.kOTSlowSpeed="SlowSpeed",O.kOTPowerPort="PowerPort",O.kOTShootHP="ShootHP",O.kOTLastSecond="LastSecond",O.kOTExplodeRng="ExplodeRng",O.kOTShootRange="ShootRange",O.kOTShootSpeed="ShootSpeed",O.kOTSlowSpeed="SlowSpeed",O.kOTSlowPicSpan="SlowPicSpan",O.kOTMaxFadeSecd="MaxFadeSecd",O.kOTSlowPicCount="SlowPicCount",O.kOTRotateDegrs="RotateDegrs",O.KOTShootMusic="ShootMusic",O.kObjSep="，",O.kObjBuyMoney="BuyMoney",O.kOProjFlySpeed="ProjFlySpeed",O.kOProjFlySpSecd="PFlySpanSecd",O.kOProjRotateDgs="PFlyRotateDgrs",O.kOProjFlyPCount="PFlyPicCount",O.kOProjFlyPic="PFlyPic",O.kOProjExpSpSecd="PExpSpanSecd",O.kOProjExpFade="PExpFadeSecd",O.kOProjExpPCount="PExpPicCount",O.kOProjExpPic="PExpPic",O.kOTSpanSecd="TowerSpanSecd",O.kOTPicCount="TowerPicCount",O.kGSaveData="SaveData",O.kGTowers="Towers",O.kGProjectiles="Projectiles",O.kGCreeps="Creeps",O.kGCreepIndex="CreepIndex",O.kGObjects="Objects",O.kGMoney="Money",O.kGWave="Waves",O.kGPos="Pos",O.kGType="Type",O.kGLevel="Level",O.kGHP="HP",O.kGRotate="Rotate",O.kGProjRt="ProjRt",O.kGCross="Cross",O.kLThemes="Themes",O.kLThemeCount="ThemeCount",O.kLThemeName="ThemeName",O.kLThemeDescrip="ThemeDescrip",O.kLThemePath="ThemePath",O.kLThemeGroup="ThemeGroup",O.kLThemePic="ThemePic",O.kLThemeMusic="ThemeMusic",O.kTLostMonster="MonsterToLose",O.kLWaves="Waves",O.kLMoney="Money",O.kLMonsterSpan="MonsterSpan",O.kLEveryListSpan="ListSpan",O.kLHPGrowthRate="HPGrowthRate",O.kLLevelName="LevelName",O.kLSmallPic="SmallPic",O.kLBGPic="BGPic",O.kLItemsPic="ItemsPic",O.kLMonsterPic="MonsterPic",O.kLObjectPic="ObjectPic",O.kLDecrip="Decription",O.kLMapPath="MapPath",O.kLTowerTypes="TowerTypes",O.kLMonsterTypes="MonsterTypes",O.kLMonsterList="MonsterList",O.kLLevelHard="LevelHard",O.kLEasyNHValue="EasyNHValue",O.kLWave="Wave",O.KLPathNum="PathNum",O.kLMonsterTpye="MonsterType",O.kLMonsterCount="MonsterCount",O.kLMHPIncPer="MHPIncPer",O.kMPath="PATH",O.kMProperty="style",O.kMPObj="prop",O.UM_APPKEY="5029f2ac5270153d8900001e",O.TOWERHOUSETAG=503,O.SECONDTOWERHOUSETAG=504,O.STARFULLCOUNT=10,O.STARFULLCOUNT2=10,O.STARGROWTIME=300,O.STARGROWTIME2=300,O.CARROT_APPID="1065816577",O.APPSFLYER_ID="L4ff7yygMdy6XL88YXjrF",O.VUNGLE_ID="5655255572fa6cd42300001a",O.DAYDAYUPLEVELCOUNT=149,O.MAINLEVELCOUNT=135,O.MAINTHEMEMAPCOUNT=14,O.SHOWCASTLELEVEL=30,O.SHOWHIGHSTOREY=37,O.SHOWEVERYDAYCHALLAENGE=20,O.SHOWINTERSTITIAL=25,O.SHOWMEETAQIU=15,O.SHOWMEETAQIULEFT=27,O.SHOWMEETADAI=25,O.SHOWMEETADA=40;var I=1003,R=1001,D=1e3,x=4012,N=4013,G=4014,W=4015,k=1e3,U=1200,H=1300,V=100,z=101,Y=102,X=103,j=104,K=105,Q=106,Z=107,J={TOWERSELCENTER:-29,AIRWITHCREAT:-28,COUNTDOWN:-27,MONSTERCOME:-26,LASTWAVETIP:-25,SHOWUPDATE:-24,MONSTERMONEY:-23,AIRWITHBUILD:-22,SELPOINT:-21,MONSTERCOMEOUT:-20,TOWERHOUSE:-19,HOWTOPLAY:-18,MENUBG:-17,MENUCENTER:-16,BOSSHPBG:-15,BOSSHPNUM:-14,BOSSRUNTIMEBG:-13,BOSSRUNTIMENUM:-12,HOUSELIFE:-11,GUIDSKIP:-10,WAVENUM:-9,WAVES:-8,BARITEMNUMOVER:-7,BARITEMNUMUNDER:-6,PAUSE:-5,SPEED:-4,MENUBTN:-3,SELDISABLE:-2,MONSTERHPBG:-1,MONSTERHP:0,TOWERSELBG:1,UNKNOW:2,TOWERUPDATE:3,TOWERSELL:4,SMALLOBJECT1:5,LONGOBJECT1:6,BIGOBJECT1:7,SMALLOBJECT5:8,BIGOBJECT4:9,GATE:10,SMALLOBJECT3:11,BIGOBJECT2:12,BIGOBJECT3:13,LONGOBJECT2:14,SMALLOBJECT4:15,SMALLOBJECT6:16,OBJECTEND:17,LM1:18,LM2:19,LM3:20,LM41:21,LM51:22,LM42:23,LM52:24,LM43:25,LM53:26,LM44:27,LM54:28,LM45:29,LM55:30,FTM:31,FLM1:32,FLM2:33,FLM3:34,BMT:35,SBL1:36,SBL2:37,SBL3:38,SBFT:39,SBFL1:40,SBFL2:41,BM1:42,BM2:43,BM3:44,BM4:45,SBB:46,BOMB:47,MONSTEREND:48,TBOTTLE:49,TSHIT:50,TSTAR:51,TSUN:52,TBALL:53,TICEFAN:54,TMOON:55,TFLASHLIGHT:56,TARROW:57,TROCKET:58,TPLANE:59,TFISH:60,TANCHOR:61,TCUTTLE:62,TMAGNET:63,TSNOW:64,TFIREBOTTLE:65,TBOOMERANG:66,TPIN:67,TBLUESTAR:68,TRANDOM:69,CSNOW:70,CROCKET:71,TOWEREND:72},$={MTEFFECT:-1,MTSMALLBOSS:0,MTBIGBOSS:1,MTFINALWAVE:2,MTMENUSELECT:3,MTTOWERBUILD:4,MTTOWERDESELECT:5,MTTOWERSELECT:6,MTTOWERSELL:7,MTTOWERUPDATA:8,MTPSTAR:9,MTPFAN:10,MTPBOOMERANG:11,MTMSTCM:12,MTBOOSCOME:13,MTPAGESELECT:14,MTSHOOTSELECT:15,MTSELECTFAULT:16,MTMSTCRASH:17,MTCOUNTDOWN:18,MTGOPLAY:19,MTOBJECT:20,MTPERFECT:21,MTLOSEGAME:22,MTCLEARALLOBJ:23,MTCARROT:24,MTCLOCK:25,MTUNLOCK:26,MTBOMB:27,MTCUTWHALE:28,MTPGIFTBOX:29,MTPCHANGE:30,MTPFEED:31,MTPSOUNDS:32,MTPBUYITEM:33,MTSTARTBGMSC:34,MTGAMES2WAY:35,MTGAMESBOSS:36,MTGAMESGATE:37,MTGAMESNORMAL:38,MTWARBGMSC:39,MTWHALECOME:40,MTACCOMPLISH:41,MTPROPBOMB:42,MTPROPBLOOD:43,MTPROPSPEED:44,MTPROPICE:45,MTPROPSLOW:46,MTMAPSTEP1:47,MTMAPSTEP2:48,MTMAPSTEP3:49,MTMAPSTEP4:50,MTMAPSTEP5:51,MTMAPSTEP6:52,MTROULETTESTART:53,MTROULETTEROCK:54,MTROULETTEEND:55,MTROULETTEBIGBOUN:56,MTSPANIMATEMSC:57,MTTEMPLEUPTREE:58,MTTEMPLEHOME:59,MTFLOORLOSE:60,MTFLOORWIN:61,MTLUCKBAG:62,MTBALLOON:63},ee={PROJBOOM:1,TOWERAIR:2,TOWERBUFF:3,OBJECTSEL:4,LSELECT:5,DUST:6,MONEYS:7,UPDATETIP:8,LASTWAVE:9,SELGROUPCHILD:10,MSTCOMEARROW:11},te={SMALLHOUSE:-5,BIGHOUSE:-4,FEEDCOOKIE:-3,FEEDMILK:-2,CATALYST:-1,UNKNOWPET:0,LANDPET11:1,LANDPET12:2,FLYPET11:3,FATPET11:4,BOSSPET11:5,LANDPET21:6,LANDPET22:7,FLYPET21:8,FATPET21:9,BOSSPET21:10,LANDPET31:11,LANDPET32:12,FLYPET31:13,FATPET31:14,BOSSPET31:15,LANDPET61:16,LANDPET62:17,FLYPET61:18,FATPET61:19,BOSSPET61:20,WHALEPET:21},ie={UNKNOWSTATE:1,HADEGG:2,HADNEST:3,HATCHING:4,BREAKOUT:5,BORN:6,GROWING:7,GROWUP:8,STATEEND:9},ne={Move:0,Jump:1},se={UNKNOWDATATYPE:0,BUILDTOWER:1,KILLMONSTER:2,FINDTOWER:3,KILLOBJECT:4,EARNMONEY:5},re={UNKNOWGUIDE:0,PLAYEDGUIDE:1,JEWELBOXGUIDE:2,BOSSMDGUIDE:3,DOUBLEPATHGUIDE:4,FORTMODEGUIDE:5,TRANSFERGUIDE:6,PROPSGUIDE:19,SLOWBBGUIDE:20,STOPBBGUIDE:21,SHOOPSPGUIDE:22,CARROTHPGUIDE:23,CLEARBBGUIDE:24,FBPLAYEDGUIDE:25,FBPLAYEDGUIDE1:26},ae={ADWALL_A:1e4,ADWALL_B:10001,ADWALL_C:10002},oe={DIAMOND_JIDI:1,DIAMOND_BOTTLE:2,DIAMOND_BOX:3,JEWEL_JIDI:4,LIFE_FOREVER:5,UNLOCK_SKY:6,UNLOCK_DESERT:7,UNLOCK_GLACIER:8,REMOVE_AD:9,LIFE_FOREVER_PCUT:10,DIAMOND_PCUT:11,GIRLCARROT:12,FATCARROT:13,GLODPACKAGE:14,BIGPACKAGE:15,OLDCARROT:16,PCUT_GIRLCARROT:17,PCUT_FATCARROT:18,PCUT_OLDCARROT:19,PCUT_DIAMOND480:20,PCUT_DIAMOND750:21,PCUT_BIGPACKAGE:22,PCUT_UNLOCK_SKY:23,PCUT_UNLOCK_GLACIER:2,EMPTY_001:24,EMPTY_002:25,DIAMOND300:26,DIAMOND480:27,DIAMOND750:28,UNLOCK_THIRD:29,UNLOCK_ICELAND:30,UNLOCK_TEMPLE:31,UNLOCK_HIGHER:32,HIGHER_PACKAGE:33,HIGHER_STAYFLOOR:34,LIFE_10:35,PCUT_DIAMOND300:36,PCUT_DIAMOND150:37,PCUT_DIAMOND100:38,PCUT_BOMB4:39,PCUT_BLOOD4:40,PCUT_SPEED10:41,PCUT_ICE6:42,PCUT_SLOW6:43,PCUT_STAR25:44,PCUT_UNLOCK_DESERT:45,BUY_PROP_100:46,BUY_PROP_101:47,BUY_PROP_102:48,BUY_PROP_103:49,BUY_PROP_104:50,DIAMOND_PCUT_GAMEMENU:51,SUPER_PACKAGE_1:52,SUPER_PACKAGE_2:53,SUPER_PACKAGE_3:54,SUPER_PACKAGE_4:55,SUPER_PACKAGE_5:56},he=960,le={SALE_FIGUREGIRL_10:0,SALE_FIGUREFAT_15:1,SALE_FIGUREOLD_15:2,SALE_STONE_750_15:3,SALE_STONE_480_10:4,SALE_STONE_300_6:5,SALE_STONE_150_4:61,SALE_STONE_100_2:7,SALE_BOMB_4_2:8,SALE_BLOOD_4_2:9,SALE_SPEED_10_2:10,SALE_ICE_6_2:11,SALE_SLOW_6_2:12,SALE_PACKAGEPLATINUM_6:13,SALE_STAR_25_4:14,SALE_THEME_4_6:15,SALE_THEME_5_4:16,SALE_THEME_6_6:17,SALE_LIFE_FOREVER_12:18},de={PROP_99:99,PROP_100:100,PROP_101:101,PROP_102:102,PROP_103:103,PROP_104:104},ce={SHOPDLG:1,ROULETTEDLG:2,BUYDLG:3},ue={CARROT_NORMAL:1685,CARROT_GIRL:1686,CARROT_FAT:1687,CARROT_OLD:1688},pe={BOTTOM_BAR_BOMB:100,BOTTOM_BAR_BLOOD:101,BOTTOM_BAR_SPEED:102,BOTTOM_BAR_ICE:103,BOTTOM_BAR_SLOW:104,BOTTOM_BARITEM_COUNT:105,BOTTOM_BAR_MISSION:106,BOTTOM_BAR_MISSION_CHILD1:107,BOTTOM_BAR_MISSION_CHILD2:108,BOTTOM_BAR_MISSION_CHILD3:109,BOTTOM_BAR_BOSSMODETIME:110},me={HIGHER_FLOOR_NULL:0,HIGHER_FLOOR_UP:1,HIGHER_FLOOR_DOWN:2,HIGHER_FLOOR_STAY:3},_e={UNKNOWPT:0,CUTCREEPHP:1,CUTBOSSHP:2,ADDPOWER:3,ADDGOLD:4,NODOWNLEVEL:5,CUTALLMONSTERHP:6,ADDCARROTHP:7,ADDTIME:8,CUTSUPERBHP:9,CUTGATEHP:10},ge={NORMALMODE:0,HIGHERMODE:1,CHALLENGEMODE:2,FEASTMODE:3,HARDMODE:4,DOUBLECARROT:5},Te={AD_MAIN:0,AD_MAP:1,AD_LEFT:2,AD_RIGHT:3,AD_GO_MAP:4},fe={UNKNOWBB:0,SLOWBB:1,STOPBB:2,SHOOTBB:3,ADDHPBB:4,CLEARBB:5},Se={text_Achie:1,text_Honor:2,text_Level:3,text_AllPass:4,text_Roulette:5,text_Love:6,text_higher:7},we={LOADING_TARGET_WAIT:-1,LOADING_TARGET_INVALIDE:0,LOADING_TARGET_MAIN:1,LOADING_TARGET_GAME:2,LOADING_TARGET_THEME:3,LOADING_TARGET_THEMETEMPLE:4,LOADING_TARGET_PETZOO:5,LOADING_TARGET_RECOMMEND:6,LOADING_TARGET_HELP:7,LOADING_TARGET_PETSHOP:8,LOADING_TARGET_LEVELSEL:9,LOADING_TARGET_LEVELSELCIRCLE:10,LOADING_TARGET_STOREY:11,LOADING_TARGET_STOREY_L:12,LOADING_TARGET_STOREY_V:13};we.WAIT=-1,we.INVALIDE=0,we.MAIN=1,we.GAME=2,we.THEME=3,we.THEMETEMPLE=4,we.PETZOO=5,we.RECOMMEND=6,we.HELP=7,we.PETSHOP=8,we.LEVELSEL=9,we.LEVELSELCIRCLE=10,we.STOREY=11,we.STOREY_L=12,we.STOREY_V=13,we.SETTING=14,we.MEETFRIEND=15;var ve={SHOWVAD:0,VADSTARTPLAY:1,VADPLAYED:2},Le={NORMALMODE:1,MANORMODE:2,DOUBLECARROT:3},Me={};Me.CarrotGla=3,Me.CarrotSky=4,Me.CarrotDes=5,Me.BuyPolarRegion=6,Me.buySeventh=7,Me.BuyIceland=8;var Ce={};Ce.Qun_Share=1,Ce.OpenTheme_PassAllStage=2,Ce.OpenTheme_CarrotThird_Share=3,Ce.OpenTheme_CarrotSky_Share=4,Ce.OpenTheme_CarrotDes_Share=5,Ce.OpenTheme_CarrotGla_Share=6,Ce.OpenTheme_BuySeventh_Share=7,Ce.OpenTheme_BuyIceland_Share=8,Ce.BuyLuobo_CarrotGirl_Share=9,Ce.BuyLuobo_CarrotFat_Share=10,Ce.BuyLuobo_CarrotOld_Share=11;var ye={};ye.Turret_Share=1,ye.DailywarAllOk_Share=2;var Be={};Be.OpenTheme_CarrotThird_First=0,Be.OpenTheme_CarrotSky_First=1,Be.OpenTheme_CarrotDes_First=2,Be.OpenTheme_CarrotGla_First=3,Be.OpenTheme_BuySeventh_First=4,Be.OpenTheme_BuyIceland_First=5,Be.BuyLuobo_CarrotFat_First=6,Be.BuyLuobo_CarrotGirl_First=7,Be.BuyLuobo_CarrotOld_First=8;var Fe=l.Class.extend({bHaveAnimation:!1,nLevelCount:1,type:J.UNKNOW,szTile:null,strPic:"",strName:"",ctor:function(e,t,i,n,s,r){this.szTile=l.rect(0,0,80,80),arguments.length>0&&(arguments.length>=1&&(this.bHaveAnimation=arguments[0]),arguments.length>=2&&(this.nLevelCount=arguments[1]),arguments.length>=3&&(this.type=arguments[2]),arguments.length>=4&&(this.szTile=arguments[3]),arguments.length>=5&&(this.strName=arguments[4]),arguments.length>=6&&(this.strPic=arguments[5]))}}),Ee=Fe.extend({nHP:0,nMoney:0,ctor:function(e,t,i,n,s,r,a,o){arguments.length>0?(this._super(i,n,s,r,a,o),this.nHP=e,this.nMoney=t):this._super()}});Ee.create=function(e,t,i,n,s,r,a,o){return new Ee(e,t,i,n,s,r,a,o)};var Pe=l.Class.extend({slowSpeed:0,nPowerPort:0,nShootHP:0,nLastSecond:0,nExplodeRange:0,ctor:function(e,t,i,n,s){arguments.length&&(void 0!==e&&(this.slowSpeed=e),void 0!==t&&(this.nPowerPort=t),void 0!==i&&(this.nShootHP=i),void 0!==n&&(this.nLastSecond=n),void 0!==s&&(this.nExplodeRange=s))}}),be=Fe.extend({nPower:null,exPower:null,nShootSpeed:null,nShootRange:null,nBuyMoney:null,nFlyRotateDegrs:null,nProjFlySpeed:0,fProjFlySpanSecd:0,nProjFlyPicCount:0,strProjPic:"",fProjExpSpanSecd:0,fProjExpFadeSecd:0,nProjExpPicCount:0,fSlowSpanSecd:0,fMaxFadeSecd:0,nSlowPicCount:0,nRotateDegrs:0,fSpanSecond:0,nPicCount:0,strShootMuic:"",nBottomPicCount:0,strPicGroup:"",ctor:function(e,t,i,n,s,r,a,o,h,l,d,c,u,p,m,_,g,T,f,S,w,v,L,M,C,y,B){0===arguments.length?(this._super(),this.nPower=[],this.exPower=[],this.nShootSpeed=[],this.nShootRange=[],this.nBuyMoney=[],this.nFlyRotateDegrs=[]):(this._super(e,t,i,n,s,r),void 0!==a&&(this.nPower=a),void 0!==o&&(this.exPower=o),void 0!==h&&(this.nShootSpeed=h),void 0!==l&&(this.nShootRange=l),void 0!==d&&(this.nBuyMoney=d),void 0!==c&&(this.nFlyRotateDegrs=c),void 0!==u&&(this.nProjFlySpeed=u),void 0!==p&&(this.fProjFlySpanSecd=p),void 0!==m&&(this.nProjFlyPicCount=m),void 0!==g&&(this.fProjExpSpanSecd=g),void 0!==f&&(this.fProjExpFadeSecd=f),void 0!==T&&(this.nProjExpPicCount=T),void 0!==S&&(this.fSlowSpanSecd=S),void 0!==v&&(this.fMaxFadeSecd=v),void 0!==w&&(this.nSlowPicCount=w),void 0!==L&&(this.nRotateDegrs=L),void 0!==M&&(this.fSpanSecond=M),void 0!==C&&(this.nPicCount=C),void 0!==_&&(this.strProjPic=_),void 0!==y&&(this.strShootMuic=y),void 0!==B&&(this.strPicGroup=B))}});be.create=function(e,t,i,n,s,r,a,o,h,l,d,c,u,p,m,_,g,T,f,S,w,v,L,M,C,y,B){return new be(e,t,i,n,s,r,a,o,h,l,d,c,u,p,m,_,g,T,f,S,w,v,L,M,C,y,B)};var Ae=Ee.extend({fSpanSecond:0,nPicCount:0,nRunSpeed:0,ctor:function(e,t,i,n,s,r,a,o,h,l,d){0===arguments.length?this._super():(this._super(e,t,i,n,s,r,a,o),void 0!==h&&(this.nPicCount=h),void 0!==l&&(this.fSpanSecond=l),void 0!==d&&(this.nRunSpeed=d))}});Ae.create=function(e,t,i,n,s,r,a,o,h,l,d){return new Ae(e,t,i,n,s,r,a,o,h,l,d)};var Oe=l.Class.extend({objectGroup:null,towerGroup:null,monsterGroup:null,strMonsterPic:null,strItemsPic:null,strObjectPic:null,strGatePic:null,allMusics:null,ctor:function(e,t,i,n,s,r){this.objectGroup={},this.towerGroup={},this.monsterGroup={},this.strMonsterPic="",this.strItemsPic="",this.strObjectPic="",this.strGatePic="",this.allMusics=[];var a=1;if(nr.share().isIPad()&&(a=2),arguments.length>0)return this.objectGroup=e||{},this.towerGroup=t||{},this.monsterGroup=i||{},this.strItemsPic=n||"",this.strMonsterPic=s||"",void(this.strObjectPic=r||"");var o=l.size(40*a,40*a),h=null,d=null,c=Ee.create(4e3,70,!1,1,J.SMALLOBJECT1,l.size(70,70),"SMALLOBJECT1","cloud%02d.png"),u=Ee.create(8e3,150,!1,1,J.LONGOBJECT1,l.size(70,140),"LONGOBJECT1","cloud%02d.png"),p=Ee.create(14e3,300,!1,1,J.BIGOBJECT1,l.size(140,140),"BIGOBJECT1","cloud%02d.png"),m=Ee.create(15e3,1e3,!1,1,J.SMALLOBJECT5,l.size(70,70),"SMALLOBJECT5","cloud%02d.png"),_=Ee.create(28e3,2500,!1,1,J.BIGOBJECT4,l.size(140,140),"BIGOBJECT4","cloud%02d.png"),g=Ee.create(0,0,!1,1,J.TOWERSELBG,l.size(70,70),"TOWERSELBG","range_%d.png"),T=Ee.create(0,0,!1,1,J.TOWERUPDATE,l.size(70,70),"TOWERUPDATE","upgrade%02d.png"),f=Ee.create(0,0,!1,1,J.TOWERSELL,l.size(70,70),"TOWERSELL","sell01.png"),S=Ee.create(0,0,!1,1,J.SELDISABLE,l.size(70,70),"SELDISABLE","forbidden.png"),w=Ee.create(0,0,!1,1,J.WAVENUM,l.size(9,15),"WAVENUM","num_yellow_18.png"),v=Ee.create(0,0,!1,1,J.WAVES,l.size(9,15),"WAVES","num_white_18.png"),L=Ee.create(0,0,!1,1,J.BARITEMNUMOVER,l.size(12,20),"BARITEMNUMOVER","BarCounter01.png"),M=Ee.create(0,0,!1,1,J.BARITEMNUMUNDER,l.size(15,20),"BARITEMNUMUNDER","BarCounter02.png"),C=Ee.create(0,0,!1,1,J.SPEED,l.size(55,40),"SPEED","speed%d%d.png"),y=Ee.create(0,0,!1,1,J.MENUBTN,l.size(30,40),"MENUBTN","menu%d%d.png"),B=Ee.create(0,0,!1,1,J.PAUSE,l.size(30,40),"PAUSE","pause%d%d.png"),F=Ee.create(0,0,!1,1,J.HOUSELIFE,l.size(40,20),"HOUSELIFE","BossHP.png"),E=Ee.create(0,0,!1,1,J.MONSTERHP,l.size(26,5),"MONSTERHP","MonsterHP%d%d.png"),P=Ee.create(0,0,!1,1,J.MENUBG,l.size(480,40),"MENUBG","MenuBG.png"),b=Ee.create(0,0,!0,1,J.TOWERHOUSE,l.size(37,53),"TOWERHOUSE","hlb%d_%d.png"),A=Ee.create(0,0,!0,1,J.MONSTERCOMEOUT,l.size(45,37),"MONSTERCOMEOUT","start%02d.png"),O=Ee.create(0,0,!0,1,J.MENUCENTER,l.size(150,40),"MENUCENTER","MenuCenter_%02d_CN.png"),I=Ee.create(0,0,!0,1,J.BOSSHPBG,l.size(580,80),"BOSSHPBG","menublood_%02d.png"),R=Ee.create(0,0,!0,1,J.BOSSRUNTIMEBG,l.size(45,37),"BOSSRUNTIMEBG","honor_%d.png"),D=Ee.create(0,0,!1,1,J.BOSSHPNUM,l.size(11,15),"BOSSHPNUM","res/Themes/Items/menublood_num%s.png"),x=Ee.create(0,0,!1,1,J.BOSSRUNTIMENUM,l.size(9,15),"BOSSRUNTIMENUM","clock_num-hd.png"),N=Ee.create(1e3,1e4,!1,1,J.GATE,l.size(93,73),"GATE","%d_Gate%d%d.png");h=[c,u,p,m,_,g,T,f,S,w,v,L,M,C,y,B,F,E,P,b,A,O,I,R,D,x,N],d=[c.type,u.type,p.type,m.type,_.type,g.type,T.type,f.type,S.type,w.type,v.type,L.type,M.type,C.type,y.type,B.type,F.type,E.type,P.type,b.type,A.type,O.type,I.type,R.type,D.type,x.type,N.type],this.objectGroup={};for(var G in d)this.objectGroup[d[G]]=h[G];var W=null,k=null,U=null,H=null,V=null,z=null,Y=null,X=null,j=null,K=null,q=null,Q=null,Z=null,$=null,ee=null,te=null,ie=null,ne=null,se=null,re=null,ae=null,oe=null,he=null,le=null,de=null,ce=null,ue=null,pe=null,me=null;le=[60,80,100],de=[600,400,250],ce=[95*a,120*a,150*a],ue=[100,180,260],pe=[60,60,60],W=be.create(!0,3,J.TBOTTLE,o,"tbottle","Bottle%d%d.png",le,null,de,ce,ue,pe,320*a,.1,3,"PBottle%d%d.png",.08,2,.16,0,0,0,0,.04,3,"res/Music/Towers/Bottle.mp3","res/Themes/Towers/TBottle-hd.plist"),le=[30,50,80],de=[1200,1050,900],ce=[70*a,70*a,80*a],ue=[120,220,260];me=[new Pe(.8,1,0,4,0),new Pe(.7,1,0,5,0),new Pe(.5,1,0,6,0)];k=be.create(!0,3,J.TSHIT,o,"tshit","Shit%d%d.png",le,me,de,ce,ue,null,240*a,.1,2,"PShit%d%d.png",.08,2,.16,.1,2,0,0,.08,4,"res/Music/Towers/Shit.mp3","res/Themes/Towers/TShit-hd.plist"),le=[150,240,350],de=[1800,1400,1e3],ce=[105*a,120*a,135*a],ue=[160,220,260],pe=[60,60,60],me=[new Pe(1,1,50,0,95*a),new Pe(1,1,80,0,95*a),new Pe(1,1,120,0,95*a)],U=be.create(!0,3,J.TSTAR,o,"tstar","Star%d%d.png",le,me,de,ce,ue,pe,220*a,.1,1,"PStar%d%d.png",.05,2,.18,.05,6,.3,22,.05,3,"res/Music/Towers/Star.mp3","res/Themes/Towers/TStar-hd.plist"),le=[100,160,250],ce=[105*a,105*a,120*a],de=[1600,1300,1e3],ue=[180,260,320],H=be.create(!0,3,J.TSUN,o,"tsun","Sun%d%d.png",le,null,de,ce,ue,null,8e7,.1,4,"PSun%d%d.png",.03,9,.18,.05,0,.4,16,.05,1,"res/Music/Towers/Sun.mp3","res/Themes/Towers/TSun-hd.plist"),le=[10,16,30],ce=[105*a,120*a,135*a],ue=[160,320,380],me=[new Pe(1.5,1,0,0,120*a),new Pe(1.2,2,0,0,120*a),new Pe(1,3,0,0,120*a)],V=be.create(!0,3,J.TBALL,o,"tball","Ball%d%d.png",le,me,null,ce,ue,null,8e7,.05,4,"PBall%d%d.png",.03,2,.18,0,0,0,0,.05,1,"res/Music/Towers/Ball.mp3","res/Themes/Towers/TBall-hd.plist"),le=[80,120,170],de=[1500,1300,1100],ce=[95*a,105*a,120*a],ue=[160,220,320],pe=[80,80,80],me=[new Pe(.7,1,0,4,0),new Pe(.6,1,0,4,0),new Pe(.5,1,0,5,0)],z=be.create(!0,3,J.TICEFAN,o,"ticefan","IceFan%d%d.png",le,me,de,ce,ue,pe,180*a,.1,1,"PIceFan%d%d.png",.03,2,.18,.1,1,0,0,.05,3,"res/Music/Towers/Fan.mp3","res/Themes/Towers/TIceFan-hd.plist"),le=[20,35,50],ce=[105*a,105*a,120*a],de=[1200,1100,1e3],ue=[180,260,320],me=[new Pe(.65,8,16,1,5),new Pe(.55,7,16,1.1,10),new Pe(.4,5,16,1.3,12)],Y=be.create(!0,3,J.TMOON,o,"tmoon","Moon%d%d.png",le,me,de,ce,ue,null,8e7,.1,4,"PMoon%d%d.png",.1,3,.18,.05,1,.4,16,.05,1,"res/Music/Towers/Moon.mp3","res/Themes/Towers/TMoon-hd.plist"),le=[30,40,50],ce=[135*a,150*a,170*a],de=[8e3,7e3,6e3],ue=[260,320,380],pe=[60,60,60],me=[new Pe(1,1,1,20,90*a),new Pe(1.5,1,1,20,90*a),new Pe(2,1,1,30,90*a)],X=be.create(!0,3,J.TFLASHLIGHT,o,"tflashght","FlashLight%d%d.png",le,me,de,ce,ue,null,8e7,.1,3,"PFlashLight%d%d.png",.05,5,.18,0,0,.8,0,.1,4,"res/Music/Towers/FlashLight.mp3","res/Themes/Towers/TFlashLight-hd.plist"),le=[80,130,260],de=[1200,1100,1e3],ce=[120*a,120*a,135*a],ue=[220,260,320],me=[new Pe(0,1,40,4,120),new Pe(12,2,50,4,120),new Pe(16,3,60,5,135)],j=be.create(!0,3,J.TARROW,o,"tarrow","Arrow%d%d.png",le,me,de,ce,ue,null,350*a,.1,2,"PArrow%d%d.png",.03,5,.18,.1,5,.5,0,.05,4,"res/Music/Towers/Arrow.mp3","res/Themes/Towers/TArrow-hd.plist"),le=[150,200,300],de=[2100,1800,1500],ce=[135*a,150*a,170*a],ue=[220,320,380],pe=[60,60,60],me=[new Pe(1,1,10,0,90*a),new Pe(1,1,17,0,90*a),new Pe(1,1,25,0,90*a)],K=be.create(!0,3,J.TROCKET,o,"trocket","Rocket%d%d.png",le,me,de,ce,ue,pe,160*a,.1,5,"PRocket%d%d.png",.03,2,.18,.05,5,.2,0,.05,3,"res/Music/Towers/Rocket.mp3","res/Themes/Towers/TRocket-hd.plist"),le=[250,350,500],ce=[135*a,150*a,170*a],de=[2e3,1600,1200],ue=[220,320,380],q=be.create(!0,3,J.TPLANE,o,"tplane","Plane%d%d.png",le,null,de,ce,ue,null,8e7,.1,2,"PPlane%d%d.png",.05,5,.18,0,0,.8,0,.05,3,"res/Music/Towers/Plane.mp3","res/Themes/Towers/TPlane-hd.plist"),le=[150,200,250],ce=[105*a,120*a,135*a],de=[750,550,350],ue=[180,260,320],me=[new Pe(1e-6,2,5,2,0),new Pe(1e-6,2,8,2,180),new Pe(1e-6,2,10,2,0)],Q=be.create(!0,3,J.TFISH,o,"tfish","Fish%d%d.png",le,me,de,ce,ue,null,180*a,.1,3,"PFish%d%d.png",.05,2,.18,.1,1,.2,90,.05,3,"res/Music/Towers/Fish.mp3","res/Themes/Towers/TFish-hd.plist"),le=[160,240,350],de=[1400,1100,800],ce=[120*a,135*a,150*a],ue=[180,260,320],pe=[60,60,60],me=[new Pe(.2,1,50,1,95*a),new Pe(.1,1,65,2,95*a),new Pe(.1,1,80,3,95*a)],Z=be.create(!0,3,J.TANCHOR,o,"tanchor","Anchor%d%d.png",le,me,de,ce,ue,pe,180*a,.1,1,"PAnchor%d%d.png",.05,3,.18,.05,6,.3,22,.05,3,"res/Music/Towers/Anchor.mp3","res/Themes/Towers/TAnchor-hd.plist"),le=[120,150,200],de=[1200,1e3,800],ce=[105*a,120*a,135*a],ue=[220,260,320],me=[new Pe(.5,4,90,5,120),new Pe(.5,8,45,0,140),new Pe(.5,12,30,0,160)],$=be.create(!0,3,J.TCUTTLE,o,"tcuttle","Cuttle%d%d.png",le,me,de,ce,ue,null,160*a,.1,2,"PCuttle%d%d.png",.05,4,.18,0,0,0,0,.05,3,"res/Music/Towers/Cuttle.mp3","res/Themes/Towers/TCuttle-hd.plist"),le=[120,160,220],de=[2e3,1600,1200],ce=[105*a,105*a,135*a],ue=[220,220,320],pe=[60,60,60],me=[new Pe(1,1,50,0,80*a),new Pe(2,1,80,0,95*a),new Pe(4,1,120,0,95*a)],ee=be.create(!0,3,J.TMAGNET,o,"tmagnet","Magnet%d%d.png",le,me,de,ce,ue,pe,220*a,.1,1,"PMagnet%d%d.png",.05,2,.18,.05,6,.3,22,.05,3,"res/Music/Towers/Magnet.mp3","res/Themes/Towers/TMagnet-hd.plist"),le=[120,250,400],ce=[105*a,105*a,120*a],de=[7500,6500,5500],ue=[220,260,320],me=[new Pe(1e-6,1,16,1.4,100*a),new Pe(1e-6,1,16,1.8,100*a),new Pe(1e-6,1,16,2.5,100*a)],te=be.create(!0,3,J.TSNOW,o,"tsnow","Snow%d%d.png",le,me,de,ce,ue,null,8e7,.1,5,"PSnow%d%d.png",.05,2,.18,0,1,0,0,.05,1,"res/Music/Towers/Snow.mp3","res/Themes/Towers/TSnow-hd.plist"),le=[20,40,50],ce=[105*a,120*a,150*a],ue=[220,260,320],pe=[60,60,60],me=[new Pe(1,1,10,0,70*a),new Pe(1,1,15,0,90*a),new Pe(1,1,20,0,120*a)],ie=be.create(!0,3,J.TFIREBOTTLE,o,"tfirebottle","FBottle%d%d.png",le,me,null,ce,ue,pe,8e7,.1,2,"PFBottle%d%d.png",.1,2,.16,0,0,0,0,.05,3,"res/Music/Towers/FireBottle.mp3","res/Themes/Towers/TFireBottle-hd.plist"),le=[180,240,320],de=[1500,1100,900],ce=[95*a,105*a,120*a],ue=[160,220,320],pe=[160,160,160],me=[new Pe(.5,100,20,250,90*a),new Pe(.4,150,30,400,90*a),new Pe(.3,150,45,550,90*a)],ne=be.create(!0,3,J.TBOOMERANG,o,"tboomerang","Boomerang%d%d.png",le,me,de,ce,ue,pe,180*a,.1,1,"PBoomerang%d%d.png",.03,2,.18,.1,1,0,0,.05,3,"res/Music/Towers/Boomerang.mp3","res/Themes/Towers/TBoomerang-hd.plist"),le=[50,80,100],de=[900,600,350],ce=[105*a,105*a,135*a],ue=[160,260,320],me=[new Pe(1,1,50,2,0),new Pe(1,1,80,3,0),new Pe(1,1,80,5,0)],se=be.create(!0,3,J.TPIN,o,"tpin","Pin%d%d.png",le,me,de,ce,ue,null,300*a,.1,2,"PPin%d%d.png",.03,4,.18,.05,4,.5,0,.05,3,"res/Music/Towers/Pin.mp3","res/Themes/Towers/TPin-hd.plist"),le=[100,150,250],de=[2e3,1500,1200],ce=[95*a,105*a,120*a],ue=[180,260,320],pe=[60,60,60],me=[new Pe(.75,1,5,4,90*a),new Pe(.6,1,20,5,110*a),new Pe(.4,1,40,5,130*a)],re=be.create(!0,3,J.TBLUESTAR,o,"tbluestar","BStar%d%d.png",le,me,de,ce,ue,pe,160*a,.1,1,"PBStar%d%d.png",.03,2,.18,.05,6,.2,22,.05,3,"res/Music/Towers/Star.mp3","res/Themes/Towers/TBlueStar-hd.plist"),ue=[200,200,200],ae=be.create(!0,3,J.TRANDOM,o,"trandom","Random%d%d.png",null,null,null,null,ue,null,160*a,.1,3,"PRocket%d%d.png",.03,2,.18,.05,5,.2,0,.05,3,"res/Music/Towers/Rocket.mp3","res/Themes/Towers/TRandom-hd.plist"),le=[300],ce=[120*a],de=[1e4],me=[new Pe(1e-6,200,5,4,0)],oe=be.create(!0,1,J.CSNOW,o,"csnow","CSnow%d%d.png",le,me,de,ce,null,me,8e7,.05,8,"CPSnow%d%d.png",.1,3,.18,.05,3,.4,16,.1,4,"res/Music/Towers/Moon.mp3","res/Themes/Towers/CSnow-hd.plist"),le=[200],de=[2e3],ce=[150*a],me=[new Pe(1,1,15,0,90*a)],h=[W,k,U,H,V,z,Y,X,j,K,q,Q,Z,$,ee,te,ie,ne,se,re,ae,oe,he=be.create(!0,1,J.CROCKET,o,"crocket","CRocket%d%d.png",le,me,de,ce,null,null,160*a,.05,3,"CPRocket%d%d.png",.03,4,.18,.05,6,.2,0,.1,4,"res/Music/Towers/Rocket.mp3","res/Themes/Towers/CRocket-hd.plist")],d=[W.type,k.type,U.type,H.type,V.type,z.type,Y.type,X.type,j.type,K.type,q.type,Q.type,Z.type,$.type,ee.type,te.type,ie.type,ne.type,se.type,re.type,ae.type,oe.type,he.type],this.towerGroup={};for(G=0;G<d.length;G++)this.towerGroup[d[G]]=h[G];var _e=Ae.create(10,14,!0,1,J.LM1,o,"LM1","L1%d.png",3,.15,60*a),ge=Ae.create(10,14,!0,1,J.LM2,o,"LM2","L2%d.png",3,.15,60*a),Te=Ae.create(10,14,!0,1,J.LM3,o,"LM3","L3%d.png",3,.15,60*a),fe=Ae.create(10,14,!0,3,J.LM41,o,"LM41","FT1%d.png",3,.15,60*a),Se=Ae.create(10,14,!0,5,J.LM51,o,"LM51","FTS1%d.png",3,.15,90*a),we=Ae.create(10,14,!0,3,J.LM42,o,"LM42","FT2%d.png",3,.15,60*a),ve=Ae.create(10,14,!0,5,J.LM52,o,"LM52","FTS2%d.png",3,.15,90*a),Le=Ae.create(10,14,!0,3,J.LM43,o,"LM43","FT3%d.png",3,.15,60*a),Me=Ae.create(10,14,!0,5,J.LM53,o,"LM53","FTS3%d.png",3,.15,90*a),Ce=Ae.create(10,14,!0,3,J.LM44,o,"LM44","FT4%d.png",3,.15,60*a),ye=Ae.create(10,14,!0,5,J.LM54,o,"LM54","FTS4%d.png",3,.15,90*a),Be=Ae.create(10,14,!0,3,J.LM45,o,"LM45","FT5%d.png",3,.15,60*a),Fe=Ae.create(10,14,!0,5,J.LM55,o,"LM55","FTS5%d.png",3,.15,90*a),Oe=Ae.create(10,14,!0,1,J.FTM,o,"FTM","P1%d.png",3,.2,50*a),Ie=Ae.create(10,14,!0,1,J.FLM1,o,"FLM1","F1%d.png",3,.15,100*a),Re=Ae.create(10,14,!0,1,J.FLM2,o,"FLM2","F2%d.png",3,.15,100*a),De=Ae.create(10,14,!0,1,J.FLM3,o,"FLM3","F2%d.png",3,.15,80*a),xe=Ae.create(1e4,268,!0,1,J.BMT,o,"LeaderMonster","B1%d.png",3,.15,30*a),Ne=Ae.create(1e3,168,!0,1,J.SBL1,o,"SBL1","SL1%d.png",3,.15,60*a),Ge=Ae.create(1e3,168,!0,1,J.SBL2,o,"SBL2","SL2%d.png",3,.15,60*a),We=Ae.create(1e3,168,!0,1,J.SBL3,o,"SBL3","SL3%d.png",3,.15,60*a),ke=Ae.create(1e3,168,!0,1,J.SBFT,o,"SBFT","SP1%d.png",3,.2,50*a),Ue=Ae.create(1e3,168,!0,1,J.SBFL1,o,"SBFL1","SF1%d.png",3,.15,100*a),He=Ae.create(1e3,168,!0,1,J.SBFL2,o,"SBFL2","SF2%d.png",3,.15,100*a),Ve=Ae.create(1e3,999,!0,1,J.BM1,l.size(180,180),"OBL","BM1%d.png",3,.15,50*a),ze=Ae.create(1e3,999,!0,1,J.BM2,l.size(180,180),"OBFL","BM2%d.png",3,.15,50*a),Ye=Ae.create(1e3,999,!0,1,J.BM3,l.size(180,180),"OBFT","BM3%d.png",3,.15,50*a),Xe=Ae.create(1e3,999,!0,1,J.BM4,l.size(190,190),"OBB","BM4%d.png",3,.15,50*a),je=Ae.create(1e4,999,!0,1,J.SBB,l.size(180,180),"SBB","BB1%d.png",3,.15,5*a),Ke=Ae.create(0,0,!0,1,J.TOWERSELCENTER,o,"TOWERSELCENTER","select_%02d.png",4,.1,0),qe=Ae.create(0,0,!0,1,J.SELPOINT,o,"SELPOINT","point%02d.png",3,.1,0),Qe=Ae.create(6,0,!0,1,J.AIRWITHBUILD,l.size(75,70),"AIRWITHBUILD","air%d%d.png",5,.08,250),Ze=Ae.create(270,150,!0,1,J.AIRWITHCREAT,l.size(75,70),"AIRWITHCREAT","mcm%02d.png",2,.03,250),Je=Ae.create(300,20,!0,1,J.MONSTERMONEY,l.size(50,30),"MONSTERMONEY","money%02d.png",1,.2,200),$e=Ae.create(0,0,!0,1,J.SHOWUPDATE,l.size(20,20),"SHOWUPDATE","showupgrade%02d.png",2,.2,0),et=Ae.create(0,0,!0,1,J.LASTWAVETIP,l.size(210,90),"LASTWAVETIP","finalwave.png",1,.25,750),tt=Ae.create(180,300,!0,1,J.COUNTDOWN,l.size(210,90),"COUNTDOWN","countdown_%d%d.png",3,.8,1),it=Ae.create(3,200,!0,1,J.MONSTERCOME,l.size(38,56),"MONSTERCOME","arrow.png",1,.1,300),nt=Ae.create(3,180,!0,1,J.BOMB,o,"OBJECTTOBOMB","BOMB%d%d.png",6,.05,90*a);h=[_e,ge,Te,fe,Se,we,ve,Le,Me,Ce,ye,Be,Fe,Oe,Ie,Re,De,xe,Ne,Ge,We,ke,Ue,He,Ve,ze,Ye,Xe,je,Ke,qe,Qe,Ze,Je,$e,et,tt,it,nt],d=[_e.type,ge.type,Te.type,fe.type,Se.type,we.type,ve.type,Le.type,Me.type,Ce.type,ye.type,Be.type,Fe.type,Oe.type,Ie.type,Re.type,De.type,xe.type,Ne.type,Ge.type,We.type,ke.type,Ue.type,He.type,Ve.type,ze.type,Ye.type,Xe.type,je.type,Ke.type,qe.type,Qe.type,Ze.type,Je.type,$e.type,et.type,tt.type,it.type,nt.type],this.monsterGroup={};for(G=0;G<d.length;G++)this.monsterGroup[d[G]]=h[G];this.strMonsterPic="res/Themes/Theme%d/Monsters-hd.plist",this.strItemsPic="res/Themes/Items/Items%02d-hd.plist",this.strObjectPic="res/Themes/Theme%d/Objects-hd.plist",this.strGatePic="res/Themes/Theme%d/GateBoss-hd.plist";var st=["res/Music/Monsters/LittleBoss.mp3","res/Music/Monsters/BigBoss.mp3","res/Music/Items/Finalwave.mp3","res/Music/Items/MenuSelect.mp3","res/Music/Items/TowerBulid.mp3","res/Music/Items/TowerDeselect.mp3","res/Music/Items/TowerSelect.mp3","res/Music/Items/TowerSell.mp3","res/Music/Items/TowerUpdata.mp3","res/Music/Towers/PStar.mp3","res/Music/Towers/PFan.mp3","res/Music/Towers/PBoomerang.mp3","res/Music/Items/MC.mp3","res/Music/Monsters/Bcm.mp3","res/Music/Main/Select.mp3","res/Music/Items/ShootSelect.mp3","res/Music/Items/SelectFault.mp3","res/Music/Items/Crash.mp3","res/Music/Items/CountDown.mp3","res/Music/Items/GO.mp3","res/Music/Items/Object.mp3","res/Music/Items/Perfect.mp3","res/Music/Items/Lose.mp3","res/Music/Items/Ach.mp3","res/Music/Items/carrot%d%d.mp3","res/Music/Items/clock.mp3","res/Music/Main/Unlock.mp3","res/Music/Items/bomb.mp3","res/Music/Items/CutWhale.mp3","res/Music/Feeds/GiftBox%02d.mp3","res/Music/Feeds/PetChange%02d.mp3","res/Music/Feeds/Feed%02d.mp3","res/Music/Feeds/PetSound%02d.mp3","res/Music/Items/BuyItem.mp3","res/Music/Main/BGMusic.mp3","res/Music/Items/2ways.mp3","res/Music/Items/Boss.mp3","res/Music/Items/Gate.mp3","res/Music/Items/Risk.mp3","res/Music/Items/BGres/Music%02d.mp3","res/Music/Monsters/Whale.mp3","res/Music/Main/Accomplish.mp3","res/Music/Items/PropBomb.mp3","res/Music/Items/PropBlood.mp3","res/Music/Items/PropSpeed.mp3","res/Music/Items/PropIce.mp3","res/Music/Items/PropSlow.mp3","res/Music/Items/MapStep1.mp3","res/Music/Items/MapStep2.mp3","res/Music/Items/MapStep3.mp3","res/Music/Items/MapStep4.mp3","res/Music/Items/MapStep5.mp3","res/Music/Items/carrot13.mp3","res/Music/Items/start.mp3","res/Music/Items/rock.mp3","res/Music/Items/end.mp3","res/Music/Items/BigBoun.mp3","res/Music/Items/donghua.mp3","res/Music/Main/TempleUpTree.mp3","res/Music/Main/TempleHome.mp3","res/Music/Items/Higher_Lose.mp3","res/Music/Items/Higher_Perfect.mp3","res/Music/Items/LuckyBag.mp3","res/Music/Items/Balloon.mp3"];this.allMusics=st}}),Ie="@null",Re="@max",De="@last",xe="@current",Ne=0,Ge=1,We=2,ke=3,Ue=0,He=1,Ve=2,ze=3,Ye=function(e,t){},Xe=function(e,t){},je=function(e){},Ke=function(e){},qe=function(){},Qe=function(){},Ze=function(e,t,i,n){},Je=function(){},$e=function(){},et=function(){},tt=function(e){},it=function(e){},nt=function(e){},st=function(e,t){},rt=function(e,t,i,n){},at=function(e,t,i,n){},ot=function(e,t,i,n,s){},ht=function(e,t,i){},lt=function(e,t,i){},dt=function(e,t,i){},ct=function(e,t,i){},ut=function(e,t,i){},pt=function(e,t){},mt=function(){},_t=function(e,t,i){},gt=function(e,t,i,n,s){},Tt={setDebugLog:function(e,t){Xe(e,t)},setSessionInterval:function(e){je(e)},setOnline:function(e){Ke(e)},enableCrashReport:function(){qe()},enableOnlineConfig:function(){Qe()},getOnlineConfig:function(e,t){void 0===t&&(t="");var i,n=Ze(e,null,0,null);if(n>0){Ze(e,"",n+1,t),i=""}else-1==n&&(i=t);return i},init:function(e,t){Ye(e,t)},onSubStart:function(e){return tt(e)},onSubEnd:function(e){it(e)},onPassFail:function(e){nt(e)},onEvent:function(e,t){st(e,t)},onBalance:function(e,t,i,n){rt(e,t,i,n)},onLevelUp:function(e,t,i,n){at(e,t,i,n)},onBuy:function(e,t,i,n,s){ot(e,t,i,n,s)},onUse:function(e,t,i){ht(e,t,i)},onExchange:function(e,t,i){lt(e,t,i)},onCollect:function(e,t,i){dt(e,t,i)},onReward:function(e,t,i){ct(e,t,i)},onShare:function(e,t,i){ut(e,t,i)},clearStatus:function(){mt()},setStatus:function(e,t,i){_t(e,t,i)},setUser:function(e,t,i,n,s){gt(e,t,i,n,s)}},ft={};ft.Z0=0,ft.Z1=1,ft.Z2=2,ft.Z3=3,ft.Z4=4,ft.Z5=5;var St=ft.Z0,wt=ft.Z1,vt=ft.Z2,Lt=ft.Z3,Mt=ft.Z4,Ct=ft.Z5,yt={WATERPIPE_UP:0,WATERPIPE_DOWN:1,WATERPIPE_LEFT:2,WATERPIPE_RIGHT:3},Bt=yt.WATERPIPE_UP,Ft=yt.WATERPIPE_DOWN,Et=yt.WATERPIPE_LEFT,Pt=yt.WATERPIPE_RIGHT,bt=l.Sprite.extend({initCenterSprite:function(){var e=wr.getModel().getObjectByType(J.TOWERSELCENTER),t=String.formatC(e.strPic,1),i=l.spriteFrameCache.getSpriteFrame(t);this.initWithSpriteFrame(i),this.nType=J.UNKNOW,this.nCurLevel=0;for(var n=[],s=1;s<=e.nPicCount;++s)n.push(l.spriteFrameCache.getSpriteFrame(String.formatC(e.strPic,s)));var r=new l.Animation(n,e.fSpanSecond),a=l.repeatForever(l.animate(r));return a.setTag(rr.REPEATACTION),this.runAction(a),this},initTowerSPWithType:function(e){var t=wr.getModel(),i=e,n=t.getObjectByType(i),s=n.nBuyMoney[0]<=t.getAllMoney(),r=String.formatC(n.strPic,0,s?1:0),a=l.spriteFrameCache.getSpriteFrame(r);return this.initWithSpriteFrame(a),this.nCurLevel=s?1:0,this.nType=i,this},initSelBGSprite:function(e){var t=wr.getModel().getObjectByType(J.TOWERSELBG),i=String.formatC(t.strPic,e),n=l.spriteFrameCache.getSpriteFrame(i);return this.initWithSpriteFrame(n),this.nType=J.TOWERSELBG,this.nCurLevel=e,this},initUpdateSpriteWithTower:function(e){var t=.5;nr.share().isIPad()&&(t=1);var i=wr.getModel(),n=i.getObjectByType(J.TOWERUPDATE),s=e,r=0;s.nCurLevel!=s.define.nLevelCount&&(r=s.define.nBuyMoney[s.nCurLevel]),r>i.getAllMoney()&&(r=-r);var a=String.formatC(n.strPic,0==r?2:r<0?0:1),o=l.spriteFrameCache.getSpriteFrame(a);this.initWithSpriteFrame(o);var h=new l.LabelAtlas("000","num_brown_12.png",12*t,20*t,"./0123456789");return h.setString(String.formatC("%ld",Math.abs(r))),h.setAnchorPoint(.5,.5),h.setPosition(44*t,11*t),this.addChild(h,1,1),0==r&&h.setVisible(!1),this.nType=J.TOWERUPDATE,this.nCurLevel=r,this},initSellSpriteWithTower:function(e){var t=.5;nr.share().isIPad()&&(t=1);for(var i=e,n=wr.getModel().getObjectByType(J.TOWERSELL),s=0,r=0;r<i.nCurLevel;r++)s+=i.define.nBuyMoney[r];s*=.8;var a=l.spriteFrameCache.getSpriteFrame(n.strPic);this.initWithSpriteFrame(a);var o=new l.LabelAtlas("000","num_brown_12.png",12*t,20*t,"./0123456789");return o.setString(String.formatC("%ld",s)),o.setAnchorPoint(.5,.5),o.setPosition(44*t,11*t),this.addChild(o,1,1),this.nType=J.TOWERSELL,this.nCurLevel=s,this},initDisableBuild:function(e){var t=wr.getModel().getObjectByType(J.SELDISABLE),i=l.spriteFrameCache.getSpriteFrame(t.strPic);return this.initWithSpriteFrame(i),this.setPosition(e),this},changePicWithMoney:function(e,t){var i=wr.getModel(),n=t,s=null;if(e<J.OBJECTEND){var r=0;if(e==J.TOWERSELL){for(var a=0;a<n.nCurLevel;a++)r+=n.define.nBuyMoney[a];r*=.8}else n.nCurLevel<n.define.nLevelCount&&(r=n.define.nBuyMoney[n.nCurLevel])>i.getAllMoney()&&(r=-r);if(this.nCurLevel==r)return;this.nCurLevel=r;var o=this.getChildByTag(1);if(o.setString(String.formatC("%ld",Math.abs(r))),e==J.TOWERSELL)return;0==r?o.setVisible(!1):o.setVisible(!0);var h=i.getObjectByType(e),d=String.formatC(h.strPic,0==r?2:r<0?0:1);s=l.spriteFrameCache.getSpriteFrame(d)}else{var c=(h=i.getObjectByType(e)).nBuyMoney[0]>i.getAllMoney()?0:1;if(c==this.nCurLevel)return;this.nCurLevel=c,s=l.spriteFrameCache.getSpriteFrame(String.formatC(h.strPic,0,c))}s&&this.setSpriteFrame(s)},changeSelBGRangePic:function(e){var t=e,i=t.define.nShootRange[t.nCurLevel-1];if(this.nCurLevel!=i){var n=wr.getModel().getObjectByType(J.TOWERSELBG),s=String.formatC(n.strPic,i),r=l.spriteFrameCache.getSpriteFrame(s);this.setSpriteFrame(r),this.nCurLevel=i}}}),At=l.Sprite.extend({fLastTiming:0,nOnLastingTime:0,bOnTiming:!1,CD2:null,CD1:null,fMove:0,nAllTimes:0,isLocked:!1,isForbidden:!1,showBottomBarCDSp:function(){var e=new l.Sprite("#BarCD.png");e.setPosition(this.getPosition()),this.getParent().addChild(e,ft.Z5),e.runAction(l.spawn(l.scaleTo(.3,1.3),l.fadeOut(.3),l.callFunc(this.TimingOver.bind(this))))},initWithFrameName:function(e){return this.initWithSpriteFrameName(e)},TimingOver:function(){this.bOnTiming=!1},onTiming:function(){if(this.nOnLastingTime=0,this.bOnTiming=!0,null==this.CD1?(this.CD1=new l.Sprite("#BarCD1.png"),this.CD1.setPosition(this.getPosition()),this.getParent().addChild(this.CD1,ft.Z2)):this.CD1.setVisible(!0),null==this.CD2)this.CD2=new l.Sprite("#BarCD2.png"),this.CD2.setAnchorPoint(.5,1),this.CD2.setPosition(this.x,this.y+this.height/2),this.getParent().addChild(this.CD2,ft.Z2);else{var e=l.spriteFrameCache.getSpriteFrame("BarCD2.png");this.CD2.setSpriteFrame(e),this.CD2.setPosition(this.x,this.y+this.height/2),this.CD2.setVisible(!0)}this.nAllTimes=this.fLastTiming/.1,this.fMove=this.CD2.getTextureRect().height/this.nAllTimes,this.schedule(this.onTimer,.1)},onTimer:function(){if(this.nOnLastingTime+=1,this.nAllTimes==this.nOnLastingTime)return this.bOnTiming=!1,this.CD1.setVisible(!1),this.CD2.setVisible(!1),this.unschedule(this.onTimer),void this.showBottomBarCDSp();var e=this.nOnLastingTime*this.fMove,t=l.spriteFrameCache.getSpriteFrame("BarCD2.png");this.CD2.setSpriteFrame(t);var i=this.CD2.getTextureRect();this.CD2.setTextureRect(l.rect(i.x,i.y,i.width,i.height-e)),this.CD2.setPosition(this.x,this.y+i.height/2)}}),Ot=l.Sprite.extend({m_nDirect:0,initWithFrameName:function(e){return this.initWithSpriteFrameName(e)},SetDirection:function(e){this.m_nDirect=e},GetDirection:function(){return this.m_nDirect}}),It=l.Sprite.extend({m_tower:null,m_index:0,initWithFrameName:function(e){return this.initWithSpriteFrameName(e)},SetTower:function(e){this.m_tower=e},GetTower:function(){return this.m_tower},SetIndex:function(e){this.m_Index=e},GetIndex:function(){return this.m_Index},SetTempPt:function(e){this.m_ptTemp=e},GetTempPt:function(){return this.m_ptTemp},SetNewPosition:function(e){this.setPosition(e),this.m_tower&&this.m_tower.setPosition(e)}}),Rt={shotCurScree:function(){var e=document.getElementById("gameCanvas");return e?(l.director.drawScene(),e.toDataURL("image/jpeg",.75)):null},update:function(e,t){void 0===t&&(t=null)},share:function(e){if(lp&&this.shotCurScree()){var t=new l.LayerColor(l.color(255,255,255,220));l.director.getRunningScene().addChild(t,9999),new l.LabelTTF("loading").setFontSize(40);var i=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0},onTouchMoved:function(){},onTouchEnded:function(){}});l.eventManager.addListener(i,t)}},cutString:function(e,t){var i=/[\u4e00-\u9fa5]/g,n=e.substring(0,t),s=~~(n.match(i)&&n.match(i).length),r=2*n.length-s;return e.substr(0,t)+(r<e.length?"...":"")},createPhotoSprite:function(){var e=l.spriteFrameCache.getSpriteFrame("UserHead.png"),t=new l.Sprite(e),i=66/t.width;return t.setScale(i),t},loadUserPhoto:function(e,t){if(e)l.textureCache.addImage(e,function(e){if("string"!=typeof e){var i=new l.SpriteFrame;if(i.initWithTexture(e,l.rect(0,0,e.width,e.height)),t){t.setSpriteFrame(i);var n=66/t.width;t.setScale(n)}}},{});else{var i=l.spriteFrameCache.getSpriteFrame("UserHead.png");if(t&&i){t.setSpriteFrame(i);var n=66/t.width;t.setScale(n)}}},drawTextImage:function(e,t,i,n,s,r,a){var o=t.width,h=t.height,l=i.length,d=o/n.length,c=r;"center"==s?c-=d*l/2:"right"==s?c-=d*l:"left"==s&&(c=c);for(var u=0;u<l;++u){var p=i[u],m=n.indexOf(p)*d,_=c+u*d,g=a;e.drawImage(t,m,0,d,h,_,g,d,h)}},intToColor:function(e){e=e||0;var t=new l.Color;return t.b=255&e,t.g=e>>8&255,t.r=e>>16&255,t},uic:function(e,t,i,n){var s=1;GamePlatform.getCurrentPlatForm()===PlatformType.FaceBook&&(s=3);var r={name:{cmd:2,category:{key:"textcategory",value:1},content:{key:"text"},result:{key:"text_check_ret"}},photo:{cmd:1,category:{key:"piccategory",value:1},content:{key:"picurl"},result:{key:"pic_check_ret_"}}},a={};a[l.sys.OS_IOS]=0,a[l.sys.OS_ANDROID]=1,a[l.sys.OS_UNKNOWN]=2;var o=[];o.push(String.format("{0}={1}","gameid",2639)),o.push(String.format("{0}={1}","busi_sign",encodeURIComponent("Et1k4frB06qWREB2GfsE"))),o.push(String.format("{0}={1}","accounttype",s)),o.push(String.format("{0}={1}","account",encodeURIComponent(e))),o.push(String.format("{0}={1}","platid",a[l.sys.os]||a[l.sys.OS_UNKNOWN])),o.push(String.format("{0}={1}","world",0)),o.push(String.format("{0}={1}","cmd",r[t].cmd)),o.push(String.format("{0}={1}","callbackdata","DATA")),o.push(String.format("{0}={1}",r[t].category.key,r[t].category.value)),o.push(String.format("{0}={1}",r[t].content.key,encodeURIComponent(i)));var h=String.format("https://uic.gamesafe.qq.com/uiccgi.cgi?{0}",o.join("&")),d=function(e,i){var s=!0;if(e){var a=JSON.parse(i),o=r[t].result.key;s=0!==a.ret||1!==a.data[o]}n(s)},c=l.loader.getXMLHttpRequest();c.timeout=1e3,c.onreadystatechange=function(){0!==c.readyState?4!==c.readyState||(200===c.status?d(!0,c.responseText):d(!1,String.format(b.NetWork_Hint,c.status))):d(!1,b.NetWork_Hint4)},c.onerror=function(){d(!1,b.NetWork_Hint5)},c.open("GET",h,!0),c.send()}},Dt={bargainDlgSwitch:!1,waitingForYounDlgSwitch:!1},xt=["res/latestRes?v=135","res/Default-568h@2x.png?v=37","res/Default-Landscape@2x~ipad.png?v=37","res/Default-Landscape~ipad.png?v=37","res/Default-Portrait@2x~ipad.png?v=37","res/Default-Portrait~ipad.png?v=37","res/Default.png?v=37","res/Icon-72@2x.png?v=37","res/LaunchImage-700-568h@2x.png?v=37","res/LaunchImage-800-667h@2x.png?v=37","res/LaunchImage-800-Landscape-736h@3x.png?v=37","res/LaunchImage-800-Portrait-736h@3x.png?v=37","res/Music/Feeds/BuyItem.mp3?v=37","res/Music/Items/2ways.mp3?v=37","res/Music/Items/Ach.mp3?v=37","res/Music/Items/BGMusic01.mp3?v=37","res/Music/Items/Balloon.mp3?v=37","res/Music/Items/BigBoun.mp3?v=37","res/Music/Items/Boss.mp3?v=37","res/Music/Items/BuyItem.mp3?v=37","res/Music/Items/CountDown.mp3?v=37","res/Music/Items/CountDown_reborn.mp3?v=37","res/Music/Items/Crash.mp3?v=37","res/Music/Items/Finalwave.mp3?v=37","res/Music/Items/GO.mp3?v=37","res/Music/Items/Gate.mp3?v=37","res/Music/Items/Higher_Lose.mp3?v=37","res/Music/Items/Higher_Perfect.mp3?v=37","res/Music/Items/Lose.mp3?v=37","res/Music/Items/LuckyBag.mp3?v=37","res/Music/Items/MC.mp3?v=37","res/Music/Items/MapStep1.mp3?v=37","res/Music/Items/MapStep2.mp3?v=37","res/Music/Items/MapStep3.mp3?v=37","res/Music/Items/MapStep4.mp3?v=37","res/Music/Items/MapStep5.mp3?v=37","res/Music/Items/MenuSelect.mp3?v=37","res/Music/Items/Object.mp3?v=37","res/Music/Items/Perfect.mp3?v=37","res/Music/Items/PropBlood.mp3?v=37","res/Music/Items/PropBomb.mp3?v=37","res/Music/Items/PropIce.mp3?v=37","res/Music/Items/PropSlow.mp3?v=37","res/Music/Items/PropSpeed.mp3?v=37","res/Music/Items/Reborn.mp3?v=37","res/Music/Items/Risk.mp3?v=37","res/Music/Items/SelectFault.mp3?v=37","res/Music/Items/ShootSelect.mp3?v=37","res/Music/Items/TowerBulid.mp3?v=37","res/Music/Items/TowerDeselect.mp3?v=37","res/Music/Items/TowerSelect.mp3?v=37","res/Music/Items/TowerSell.mp3?v=37","res/Music/Items/TowerUpdata.mp3?v=37","res/Music/Items/bomb.mp3?v=37","res/Music/Items/carrot11.mp3?v=37","res/Music/Items/carrot12.mp3?v=37","res/Music/Items/carrot13.mp3?v=37","res/Music/Items/carrot21.mp3?v=37","res/Music/Items/carrot22.mp3?v=37","res/Music/Items/carrot31.mp3?v=37","res/Music/Items/carrot32.mp3?v=37","res/Music/Items/carrot41.mp3?v=37","res/Music/Items/carrot42.mp3?v=37","res/Music/Items/clock.mp3?v=37","res/Music/Items/donghua.mp3?v=37","res/Music/Items/end.mp3?v=37","res/Music/Items/rock.mp3?v=37","res/Music/Items/start.mp3?v=37","res/Music/Main/Accomplish.mp3?v=37","res/Music/Main/BGMusic.mp3?v=37","res/Music/Main/Select.mp3?v=37","res/Music/Main/TempleHome.mp3?v=37","res/Music/Main/TempleUpTree.mp3?v=37","res/Music/Main/Unlock.mp3?v=37","res/Music/Monsters/Bcm.mp3?v=37","res/Music/Monsters/BigBoss.mp3?v=37","res/Music/Monsters/Fat141.mp3?v=37","res/Music/Monsters/Fat142.mp3?v=37","res/Music/Monsters/Fat143.mp3?v=37","res/Music/Monsters/Fat241.mp3?v=37","res/Music/Monsters/Fat242.mp3?v=37","res/Music/Monsters/Fat243.mp3?v=37","res/Music/Monsters/Fat341.mp3?v=37","res/Music/Monsters/Fat342.mp3?v=37","res/Music/Monsters/Fat343.mp3?v=37","res/Music/Monsters/Fat441.mp3?v=37","res/Music/Monsters/Fat442.mp3?v=37","res/Music/Monsters/Fat443.mp3?v=37","res/Music/Monsters/Fat541.mp3?v=37","res/Music/Monsters/Fat542.mp3?v=37","res/Music/Monsters/Fat543.mp3?v=37","res/Music/Monsters/Fat641.mp3?v=37","res/Music/Monsters/Fat642.mp3?v=37","res/Music/Monsters/Fat643.mp3?v=37","res/Music/Monsters/Fly151.mp3?v=37","res/Music/Monsters/Fly152.mp3?v=37","res/Music/Monsters/Fly153.mp3?v=37","res/Music/Monsters/Fly161.mp3?v=37","res/Music/Monsters/Fly162.mp3?v=37","res/Music/Monsters/Fly163.mp3?v=37","res/Music/Monsters/Fly251.mp3?v=37","res/Music/Monsters/Fly252.mp3?v=37","res/Music/Monsters/Fly253.mp3?v=37","res/Music/Monsters/Fly261.mp3?v=37","res/Music/Monsters/Fly262.mp3?v=37","res/Music/Monsters/Fly263.mp3?v=37","res/Music/Monsters/Fly351.mp3?v=37","res/Music/Monsters/Fly352.mp3?v=37","res/Music/Monsters/Fly353.mp3?v=37","res/Music/Monsters/Fly361.mp3?v=37","res/Music/Monsters/Fly362.mp3?v=37","res/Music/Monsters/Fly363.mp3?v=37","res/Music/Monsters/Fly451.mp3?v=37","res/Music/Monsters/Fly452.mp3?v=37","res/Music/Monsters/Fly453.mp3?v=37","res/Music/Monsters/Fly461.mp3?v=37","res/Music/Monsters/Fly462.mp3?v=37","res/Music/Monsters/Fly463.mp3?v=37","res/Music/Monsters/Fly551.mp3?v=37","res/Music/Monsters/Fly552.mp3?v=37","res/Music/Monsters/Fly553.mp3?v=37","res/Music/Monsters/Fly561.mp3?v=37","res/Music/Monsters/Fly562.mp3?v=37","res/Music/Monsters/Fly563.mp3?v=37","res/Music/Monsters/Fly651.mp3?v=37","res/Music/Monsters/Fly652.mp3?v=37","res/Music/Monsters/Fly653.mp3?v=37","res/Music/Monsters/Fly661.mp3?v=37","res/Music/Monsters/Fly662.mp3?v=37","res/Music/Monsters/Fly663.mp3?v=37","res/Music/Monsters/Land111.mp3?v=37","res/Music/Monsters/Land112.mp3?v=37","res/Music/Monsters/Land113.mp3?v=37","res/Music/Monsters/Land121.mp3?v=37","res/Music/Monsters/Land122.mp3?v=37","res/Music/Monsters/Land123.mp3?v=37","res/Music/Monsters/Land131.mp3?v=37","res/Music/Monsters/Land132.mp3?v=37","res/Music/Monsters/Land133.mp3?v=37","res/Music/Monsters/Land211.mp3?v=37","res/Music/Monsters/Land221.mp3?v=37","res/Music/Monsters/Land222.mp3?v=37","res/Music/Monsters/Land231.mp3?v=37","res/Music/Monsters/Land232.mp3?v=37","res/Music/Monsters/Land311.mp3?v=37","res/Music/Monsters/Land312.mp3?v=37","res/Music/Monsters/Land321.mp3?v=37","res/Music/Monsters/Land322.mp3?v=37","res/Music/Monsters/Land323.mp3?v=37","res/Music/Monsters/Land331.mp3?v=37","res/Music/Monsters/Land332.mp3?v=37","res/Music/Monsters/Land333.mp3?v=37","res/Music/Monsters/Land411.mp3?v=37","res/Music/Monsters/Land412.mp3?v=37","res/Music/Monsters/Land413.mp3?v=37","res/Music/Monsters/Land421.mp3?v=37","res/Music/Monsters/Land422.mp3?v=37","res/Music/Monsters/Land423.mp3?v=37","res/Music/Monsters/Land431.mp3?v=37","res/Music/Monsters/Land432.mp3?v=37","res/Music/Monsters/Land433.mp3?v=37","res/Music/Monsters/Land511.mp3?v=37","res/Music/Monsters/Land512.mp3?v=37","res/Music/Monsters/Land513.mp3?v=37","res/Music/Monsters/Land521.mp3?v=37","res/Music/Monsters/Land522.mp3?v=37","res/Music/Monsters/Land523.mp3?v=37","res/Music/Monsters/Land531.mp3?v=37","res/Music/Monsters/Land532.mp3?v=37","res/Music/Monsters/Land533.mp3?v=37","res/Music/Monsters/Land611.mp3?v=37","res/Music/Monsters/Land612.mp3?v=37","res/Music/Monsters/Land613.mp3?v=37","res/Music/Monsters/Land621.mp3?v=37","res/Music/Monsters/Land622.mp3?v=37","res/Music/Monsters/Land623.mp3?v=37","res/Music/Monsters/Land631.mp3?v=37","res/Music/Monsters/Land632.mp3?v=37","res/Music/Monsters/Land633.mp3?v=37","res/Music/Monsters/LittleBoss.mp3?v=37","res/Music/Monsters/Whale.mp3?v=37","res/Music/Towers/Anchor.mp3?v=37","res/Music/Towers/Arrow.mp3?v=37","res/Music/Towers/Ball.mp3?v=37","res/Music/Towers/Boomerang.mp3?v=37","res/Music/Towers/Bottle.mp3?v=37","res/Music/Towers/Cuttle.mp3?v=37","res/Music/Towers/Fan.mp3?v=37","res/Music/Towers/FireBottle.mp3?v=37","res/Music/Towers/Fish.mp3?v=37","res/Music/Towers/FlashLight.mp3?v=37","res/Music/Towers/Moon.mp3?v=37","res/Music/Towers/PBoomerang.mp3?v=37","res/Music/Towers/PStar.mp3?v=37","res/Music/Towers/Pin.mp3?v=37","res/Music/Towers/Plane.mp3?v=37","res/Music/Towers/Rocket.mp3?v=37","res/Music/Towers/Shit.mp3?v=37","res/Music/Towers/Snow.mp3?v=37","res/Music/Towers/Star.mp3?v=37","res/Music/Towers/Sun.mp3?v=37","res/RouletteDlg/stone_add.png?v=37","res/RouletteDlg/stone_bg.png?v=37","res/RouletteDlg/wheel_bigwin_bg.png?v=37","res/RouletteDlg/wheel_mainframe.png?v=37","res/RouletteDlg/wheel_shine_1.png?v=37","res/RouletteDlg/wheel_shine_2.png?v=37","res/RouletteDlg/wheel_spin.png?v=37","res/RouletteDlg/wheel_start_bg.png?v=37","res/RouletteDlg/wheel_win_bg.png?v=37","res/RouletteDlg/wheel_win_stone_1888.png?v=37","res/RouletteDlg/wheel_win_stone_66.png?v=37","res/RouletteDlg/wheel_win_stone_666.png?v=37","res/RouletteDlg/wheel_win_stone_999.png?v=37","res/RouletteDlg/wheel_win_wait.png?v=37","res/Themes/DayMaps/BG1_1_1.tmx?v=37","res/Themes/DayMaps/BG1_1_2.tmx?v=37","res/Themes/DayMaps/BG1_1_4.tmx?v=37","res/Themes/DayMaps/BG1_1_46.tmx?v=37","res/Themes/DayMaps/BG1_1_47.tmx?v=37","res/Themes/DayMaps/BG1_2_3.tmx?v=37","res/Themes/DayMaps/BG1_2_48.tmx?v=37","res/Themes/DayMaps/BG1_2_49.tmx?v=37","res/Themes/DayMaps/BG1_2_5.tmx?v=37","res/Themes/DayMaps/BG2_1_10.tmx?v=37","res/Themes/DayMaps/BG2_1_50.tmx?v=37","res/Themes/DayMaps/BG2_1_51.tmx?v=37","res/Themes/DayMaps/BG2_1_6.tmx?v=37","res/Themes/DayMaps/BG2_1_7.tmx?v=37","res/Themes/DayMaps/BG2_1_8.tmx?v=37","res/Themes/DayMaps/BG2_1_9.tmx?v=37","res/Themes/DayMaps/BG2_2_52.tmx?v=37","res/Themes/DayMaps/BG3_1_11.tmx?v=37","res/Themes/DayMaps/BG3_1_12.tmx?v=37","res/Themes/DayMaps/BG3_1_13.tmx?v=37","res/Themes/DayMaps/BG3_1_14.tmx?v=37","res/Themes/DayMaps/BG3_1_15.tmx?v=37","res/Themes/DayMaps/BG3_1_53.tmx?v=37","res/Themes/DayMaps/BG3_2_54.tmx?v=37","res/Themes/DayMaps/BG3_2_55.tmx?v=37","res/Themes/DayMaps/BG4_1_16.tmx?v=37","res/Themes/DayMaps/BG4_1_17.tmx?v=37","res/Themes/DayMaps/BG4_1_18.tmx?v=37","res/Themes/DayMaps/BG4_1_19.tmx?v=37","res/Themes/DayMaps/BG4_1_20.tmx?v=37","res/Themes/DayMaps/BG4_1_57.tmx?v=37","res/Themes/DayMaps/BG4_2_56.tmx?v=37","res/Themes/DayMaps/BG5_1_21.tmx?v=37","res/Themes/DayMaps/BG5_1_22.tmx?v=37","res/Themes/DayMaps/BG5_1_23.tmx?v=37","res/Themes/DayMaps/BG5_1_24.tmx?v=37","res/Themes/DayMaps/BG5_1_25.tmx?v=37","res/Themes/DayMaps/BG5_1_59.tmx?v=37","res/Themes/DayMaps/BG5_1_60.tmx?v=37","res/Themes/DayMaps/BG5_1_61.tmx?v=37","res/Themes/DayMaps/BG5_2_58.tmx?v=37","res/Themes/DayMaps/BG6_1_26.tmx?v=37","res/Themes/DayMaps/BG6_1_27.tmx?v=37","res/Themes/DayMaps/BG6_1_28.tmx?v=37","res/Themes/DayMaps/BG6_1_29.tmx?v=37","res/Themes/DayMaps/BG6_1_30.tmx?v=37","res/Themes/DayMaps/BG6_1_64.tmx?v=37","res/Themes/DayMaps/BG6_1_65.tmx?v=37","res/Themes/DayMaps/BG6_2_62.tmx?v=37","res/Themes/DayMaps/BG6_2_63.tmx?v=37","res/Themes/DayMaps/BG7_1_31.tmx?v=37","res/Themes/DayMaps/BG7_1_32.tmx?v=37","res/Themes/DayMaps/BG7_1_33.tmx?v=37","res/Themes/DayMaps/BG7_1_34.tmx?v=37","res/Themes/DayMaps/BG7_1_35.tmx?v=37","res/Themes/DayMaps/BG7_1_66.tmx?v=37","res/Themes/DayMaps/BG7_1_67.tmx?v=37","res/Themes/DayMaps/BG7_1_68.tmx?v=37","res/Themes/DayMaps/BG8_1_36.tmx?v=37","res/Themes/DayMaps/BG8_1_37.tmx?v=37","res/Themes/DayMaps/BG8_1_38.tmx?v=37","res/Themes/DayMaps/BG8_1_39.tmx?v=37","res/Themes/DayMaps/BG8_1_40.tmx?v=37","res/Themes/DayMaps/BG8_1_69.tmx?v=37","res/Themes/DayMaps/BG8_1_70.tmx?v=37","res/Themes/DayMaps/BG8_1_71.tmx?v=37","res/Themes/DayMaps/BG8_2_72.tmx?v=37","res/Themes/DayMaps/BG9_1_41.tmx?v=37","res/Themes/DayMaps/BG9_1_42.tmx?v=37","res/Themes/DayMaps/BG9_1_43.tmx?v=37","res/Themes/DayMaps/BG9_1_45.tmx?v=37","res/Themes/DayMaps/BG9_1_73.tmx?v=37","res/Themes/DayMaps/BG9_1_74.tmx?v=37","res/Themes/DayMaps/BG9_2_44.tmx?v=37","res/Themes/DayMaps/BG9_2_75.tmx?v=37","res/Themes/DoubleCarrotMaps/1111.tmx?v=37","res/Themes/Items/BarCounter01.png?v=37","res/Themes/Items/BarCounter02.png?v=37","res/Themes/Items/BossItems-hd.plist?v=37","res/Themes/Items/Common_loading_bg-hd.plist?v=37","res/Themes/Items/Common_shine_bg-hd.plist?v=37","res/Themes/Items/Common_woodbg-hd.plist?v=37","res/Themes/Items/FTMonsters-hd.plist?v=37","res/Themes/Items/GateItems-hd.plist?v=37","res/Themes/Items/Items00-hd.plist?v=37","res/Themes/Items/Items01-hd.plist?v=37","res/Themes/Items/Items03-hd.plist?v=37","res/Themes/Items/Items04-hd.plist?v=37","res/Themes/Items/Items07-hd.plist?v=37","res/Themes/Items/Items08-hd.plist?v=37","res/Themes/Items/ModeTour-hd.plist?v=37","res/Themes/Items/NewProp-hd.plist?v=37","res/Themes/Items/PropMagic-hd.plist?v=37","res/Themes/Items/SpringAct.plist?v=37","res/Themes/Items/clock_num-hd.png?v=37","res/Themes/Items/countdown_11_floor_num.png?v=37","res/Themes/Items/floor_chart_gold_num.png?v=37","res/Themes/Items/floor_chart_wood_num.png?v=37","res/Themes/Items/floor_curve_num.png?v=37","res/Themes/Items/floor_curve_tip_num.png?v=37","res/Themes/Items/floor_mode_num.png?v=37","res/Themes/Items/floor_shareimg_num.png?v=37","res/Themes/Items/floor_sign_num.png?v=37","res/Themes/Items/love-hd.plist?v=37","res/Themes/Items/muser_rank_num.png?v=37","res/Themes/Items/num_blue_18.png?v=37","res/Themes/Items/num_brown_12.png?v=37","res/Themes/Items/num_brown_18.png?v=37","res/Themes/Items/num_orange_14.png?v=37","res/Themes/Items/num_white_18.png?v=37","res/Themes/Items/num_white_24.png?v=37","res/Themes/Items/num_yellow_18.png?v=37","res/Themes/Items/pingfen-hd.plist?v=37","res/Themes/LevelSelect/Floor_cloud_1-hd.plist?v=37","res/Themes/LevelSelect/Floor_cloud_2_1-hd.plist?v=37","res/Themes/LevelSelect/Floor_cloud_2_2-hd.plist?v=37","res/Themes/LevelSelect/Floor_cloud_2_2-hd.png?v=37","res/Themes/LevelSelect/Floor_cloud_2_3-hd.plist?v=37","res/Themes/LevelSelect/Floor_cloud_2_3-hd.png?v=37","res/Themes/LevelSelect/Floor_cloud_3-hd.plist?v=37","res/Themes/LevelSelect/Floor_cloud_4_1-hd.plist?v=37","res/Themes/LevelSelect/Floor_cloud_4_2-hd.plist?v=37","res/Themes/LevelSelect/Floor_cloud_4_2-hd.png?v=37","res/Themes/LevelSelect/Floor_cloud_5-hd.plist?v=37","res/Themes/LevelSelect/LevelSel03-hd.plist?v=37","res/Themes/LevelSelect/LevelSel04-hd.plist?v=37","res/Themes/LevelSelect/Roulette-hd.plist?v=37","res/Themes/LevelSelect/Shop01-hd.plist?v=37","res/Themes/LevelSelect/Shop01-hd.png?v=37","res/Themes/LevelSelect/Shop02-hd.plist?v=37","res/Themes/LevelSelect/Shop02-hd.png?v=37","res/Themes/LevelSelect/StoneToProp-hd.plist?v=37","res/Themes/LevelSelect/Storey1-hd.plist?v=37","res/Themes/LevelSelect/Storey2-hd.plist?v=37","res/Themes/LevelSelect/Storey3-hd.plist?v=37","res/Themes/LevelSelect/basemap1-hd.plist?v=37","res/Themes/LevelSelect/basemap2-hd.plist?v=37","res/Themes/LevelSelect/basemap_part1.plist?v=37","res/Themes/LevelSelect/cloud-hd.plist?v=37","res/Themes/LevelSelect/cloud_part1.plist?v=37","res/Themes/LevelSelect/discount-hd.plist?v=37","res/Themes/LevelSelect/floor_balloon_protected_num.png?v=37","res/Themes/LevelSelect/floor_btn_num.png?v=37","res/Themes/LevelSelect/routemap1-hd.plist?v=37","res/Themes/Maps/BG01-hd.plist?v=37","res/Themes/Maps/BG01.tmx?v=37","res/Themes/Maps/BG02-hd.plist?v=37","res/Themes/Maps/BG02.tmx?v=37","res/Themes/Maps/BG03-hd.plist?v=37","res/Themes/Maps/BG03.tmx?v=37","res/Themes/Maps/BG03_1.tmx?v=37","res/Themes/Maps/BG03_2.tmx?v=37","res/Themes/Maps/BG03_3.tmx?v=37","res/Themes/Maps/BG04-hd.plist?v=37","res/Themes/Maps/BG04.tmx?v=37","res/Themes/Maps/BG05-hd.plist?v=37","res/Themes/Maps/BG05.tmx?v=37","res/Themes/Maps/BG05_1.tmx?v=37","res/Themes/Maps/BG05_2.tmx?v=37","res/Themes/Maps/BG05_3.tmx?v=37","res/Themes/Maps/BG06-hd.plist?v=37","res/Themes/Maps/BG06.tmx?v=37","res/Themes/Maps/BG06_1.tmx?v=37","res/Themes/Maps/BG06_2.tmx?v=37","res/Themes/Maps/BG06_3.tmx?v=37","res/Themes/Maps/BG07-hd.plist?v=37","res/Themes/Maps/BG07.tmx?v=37","res/Themes/Maps/BG08-hd.plist?v=37","res/Themes/Maps/BG08.tmx?v=37","res/Themes/Maps/BG08_1.tmx?v=37","res/Themes/Maps/BG08_2.tmx?v=37","res/Themes/Maps/BG08_3.tmx?v=37","res/Themes/Maps/BG09-hd.plist?v=37","res/Themes/Maps/BG09.tmx?v=37","res/Themes/Maps/BG09_1.tmx?v=37","res/Themes/Maps/BG09_2.tmx?v=37","res/Themes/Maps/BG09_3.tmx?v=37","res/Themes/Maps/BG10-hd.plist?v=37","res/Themes/Maps/BG10.tmx?v=37","res/Themes/Maps/BG100-hd.plist?v=37","res/Themes/Maps/BG100.tmx?v=37","res/Themes/Maps/BG100_1.tmx?v=37","res/Themes/Maps/BG100_2.tmx?v=37","res/Themes/Maps/BG100_3.tmx?v=37","res/Themes/Maps/BG101-hd.plist?v=37","res/Themes/Maps/BG101.tmx?v=37","res/Themes/Maps/BG101_1.tmx?v=37","res/Themes/Maps/BG101_2.tmx?v=37","res/Themes/Maps/BG101_3.tmx?v=37","res/Themes/Maps/BG102-hd.plist?v=37","res/Themes/Maps/BG102.tmx?v=37","res/Themes/Maps/BG103-hd.plist?v=37","res/Themes/Maps/BG103.tmx?v=37","res/Themes/Maps/BG104-hd.plist?v=37","res/Themes/Maps/BG104.tmx?v=37","res/Themes/Maps/BG105-hd.plist?v=37","res/Themes/Maps/BG105.tmx?v=37","res/Themes/Maps/BG106-hd.plist?v=37","res/Themes/Maps/BG106.tmx?v=37","res/Themes/Maps/BG106_1.tmx?v=37","res/Themes/Maps/BG106_2.tmx?v=37","res/Themes/Maps/BG106_3.tmx?v=37","res/Themes/Maps/BG107-hd.plist?v=37","res/Themes/Maps/BG107.tmx?v=37","res/Themes/Maps/BG108-hd.plist?v=37","res/Themes/Maps/BG108.tmx?v=37","res/Themes/Maps/BG108_1.tmx?v=37","res/Themes/Maps/BG108_2.tmx?v=37","res/Themes/Maps/BG108_3.tmx?v=37","res/Themes/Maps/BG109-hd.plist?v=37","res/Themes/Maps/BG109.tmx?v=37","res/Themes/Maps/BG10_1.tmx?v=37","res/Themes/Maps/BG10_2.tmx?v=37","res/Themes/Maps/BG10_3.tmx?v=37","res/Themes/Maps/BG11-hd.plist?v=37","res/Themes/Maps/BG11.tmx?v=37","res/Themes/Maps/BG110-hd.plist?v=37","res/Themes/Maps/BG110.tmx?v=37","res/Themes/Maps/BG111-hd.plist?v=37","res/Themes/Maps/BG111.tmx?v=37","res/Themes/Maps/BG111_1.tmx?v=37","res/Themes/Maps/BG111_2.tmx?v=37","res/Themes/Maps/BG111_3.tmx?v=37","res/Themes/Maps/BG112-hd.plist?v=37","res/Themes/Maps/BG112.tmx?v=37","res/Themes/Maps/BG112_1.tmx?v=37","res/Themes/Maps/BG113-hd.plist?v=37","res/Themes/Maps/BG113.tmx?v=37","res/Themes/Maps/BG113_1.tmx?v=37","res/Themes/Maps/BG113_2.tmx?v=37","res/Themes/Maps/BG113_3.tmx?v=37","res/Themes/Maps/BG114-hd.plist?v=37","res/Themes/Maps/BG114.tmx?v=37","res/Themes/Maps/BG115-hd.plist?v=37","res/Themes/Maps/BG115.tmx?v=37","res/Themes/Maps/BG115_1.tmx?v=37","res/Themes/Maps/BG115_2.tmx?v=37","res/Themes/Maps/BG115_3.tmx?v=37","res/Themes/Maps/BG116-hd.plist?v=37","res/Themes/Maps/BG116.tmx?v=37","res/Themes/Maps/BG117-hd.plist?v=37","res/Themes/Maps/BG117.tmx?v=37","res/Themes/Maps/BG118-hd.plist?v=37","res/Themes/Maps/BG118.tmx?v=37","res/Themes/Maps/BG118_1.tmx?v=37","res/Themes/Maps/BG118_2.tmx?v=37","res/Themes/Maps/BG118_3.tmx?v=37","res/Themes/Maps/BG119-hd.plist?v=37","res/Themes/Maps/BG119.tmx?v=37","res/Themes/Maps/BG119_1.tmx?v=37","res/Themes/Maps/BG119_2.tmx?v=37","res/Themes/Maps/BG119_3.tmx?v=37","res/Themes/Maps/BG12-hd.plist?v=37","res/Themes/Maps/BG12.tmx?v=37","res/Themes/Maps/BG120-hd.plist?v=37","res/Themes/Maps/BG120.tmx?v=37","res/Themes/Maps/BG121-hd.plist?v=37","res/Themes/Maps/BG121.tmx?v=37","res/Themes/Maps/BG122-hd.plist?v=37","res/Themes/Maps/BG122.tmx?v=37","res/Themes/Maps/BG122_1.tmx?v=37","res/Themes/Maps/BG122_2.tmx?v=37","res/Themes/Maps/BG122_3.tmx?v=37","res/Themes/Maps/BG123-hd.plist?v=37","res/Themes/Maps/BG123.tmx?v=37","res/Themes/Maps/BG123_1.tmx?v=37","res/Themes/Maps/BG123_2.tmx?v=37","res/Themes/Maps/BG123_3.tmx?v=37","res/Themes/Maps/BG124-hd.plist?v=37","res/Themes/Maps/BG124.tmx?v=37","res/Themes/Maps/BG125-hd.plist?v=37","res/Themes/Maps/BG125.tmx?v=37","res/Themes/Maps/BG125_1.tmx?v=37","res/Themes/Maps/BG125_2.tmx?v=37","res/Themes/Maps/BG125_3.tmx?v=37","res/Themes/Maps/BG126-hd.plist?v=37","res/Themes/Maps/BG126.tmx?v=37","res/Themes/Maps/BG126_1.tmx?v=37","res/Themes/Maps/BG127-hd.plist?v=37","res/Themes/Maps/BG127.tmx?v=37","res/Themes/Maps/BG128-hd.plist?v=37","res/Themes/Maps/BG128.tmx?v=37","res/Themes/Maps/BG128_1.tmx?v=37","res/Themes/Maps/BG129-hd.plist?v=37","res/Themes/Maps/BG129.tmx?v=37","res/Themes/Maps/BG12_1.tmx?v=37","res/Themes/Maps/BG12_2.tmx?v=37","res/Themes/Maps/BG12_3.tmx?v=37","res/Themes/Maps/BG13-hd.plist?v=37","res/Themes/Maps/BG13.tmx?v=37","res/Themes/Maps/BG130-hd.plist?v=37","res/Themes/Maps/BG130.tmx?v=37","res/Themes/Maps/BG130_1.tmx?v=37","res/Themes/Maps/BG130_2.tmx?v=37","res/Themes/Maps/BG130_3.tmx?v=37","res/Themes/Maps/BG131-hd.plist?v=37","res/Themes/Maps/BG131.tmx?v=37","res/Themes/Maps/BG131_1.tmx?v=37","res/Themes/Maps/BG132-hd.plist?v=37","res/Themes/Maps/BG132.tmx?v=37","res/Themes/Maps/BG132_1.tmx?v=37","res/Themes/Maps/BG132_2.tmx?v=37","res/Themes/Maps/BG132_3.tmx?v=37","res/Themes/Maps/BG133-hd.plist?v=37","res/Themes/Maps/BG133.tmx?v=37","res/Themes/Maps/BG134-hd.plist?v=37","res/Themes/Maps/BG134.tmx?v=37","res/Themes/Maps/BG134_1.tmx?v=37","res/Themes/Maps/BG134_2.tmx?v=37","res/Themes/Maps/BG134_3.tmx?v=37","res/Themes/Maps/BG135-hd.plist?v=37","res/Themes/Maps/BG135.tmx?v=37","res/Themes/Maps/BG135_1.tmx?v=37","res/Themes/Maps/BG135_2.tmx?v=37","res/Themes/Maps/BG135_3.tmx?v=37","res/Themes/Maps/BG136-hd.plist?v=37","res/Themes/Maps/BG136.tmx?v=37","res/Themes/Maps/BG136_1.tmx?v=37","res/Themes/Maps/BG136_2.tmx?v=37","res/Themes/Maps/BG136_3.tmx?v=37","res/Themes/Maps/BG137-hd.plist?v=37","res/Themes/Maps/BG137.tmx?v=37","res/Themes/Maps/BG138-hd.plist?v=37","res/Themes/Maps/BG138.tmx?v=37","res/Themes/Maps/BG138_1.tmx?v=37","res/Themes/Maps/BG138_2.tmx?v=37","res/Themes/Maps/BG138_3.tmx?v=37","res/Themes/Maps/BG139-hd.plist?v=37","res/Themes/Maps/BG139.tmx?v=37","res/Themes/Maps/BG14-hd.plist?v=37","res/Themes/Maps/BG14.tmx?v=37","res/Themes/Maps/BG140-hd.plist?v=37","res/Themes/Maps/BG140.tmx?v=37","res/Themes/Maps/BG141-hd.plist?v=37","res/Themes/Maps/BG141.tmx?v=37","res/Themes/Maps/BG142-hd.plist?v=37","res/Themes/Maps/BG142.tmx?v=37","res/Themes/Maps/BG142_1.tmx?v=37","res/Themes/Maps/BG142_2.tmx?v=37","res/Themes/Maps/BG142_3.tmx?v=37","res/Themes/Maps/BG143-hd.plist?v=37","res/Themes/Maps/BG143.tmx?v=37","res/Themes/Maps/BG144-hd.plist?v=37","res/Themes/Maps/BG144.tmx?v=37","res/Themes/Maps/BG144_1.tmx?v=37","res/Themes/Maps/BG144_2.tmx?v=37","res/Themes/Maps/BG144_3.tmx?v=37","res/Themes/Maps/BG145-hd.plist?v=37","res/Themes/Maps/BG145.tmx?v=37","res/Themes/Maps/BG145_1.tmx?v=37","res/Themes/Maps/BG145_2.tmx?v=37","res/Themes/Maps/BG145_3.tmx?v=37","res/Themes/Maps/BG146-hd.plist?v=37","res/Themes/Maps/BG146.tmx?v=37","res/Themes/Maps/BG146_1.tmx?v=37","res/Themes/Maps/BG147-hd.plist?v=37","res/Themes/Maps/BG147.tmx?v=37","res/Themes/Maps/BG147_1.tmx?v=37","res/Themes/Maps/BG147_2.tmx?v=37","res/Themes/Maps/BG147_3.tmx?v=37","res/Themes/Maps/BG148-hd.plist?v=37","res/Themes/Maps/BG148.tmx?v=37","res/Themes/Maps/BG149-hd.plist?v=37","res/Themes/Maps/BG149.tmx?v=37","res/Themes/Maps/BG149_1.tmx?v=37","res/Themes/Maps/BG149_2.tmx?v=37","res/Themes/Maps/BG149_3.tmx?v=37","res/Themes/Maps/BG15-hd.plist?v=37","res/Themes/Maps/BG15.tmx?v=37","res/Themes/Maps/BG150-hd.plist?v=37","res/Themes/Maps/BG150.tmx?v=37","res/Themes/Maps/BG151-hd.plist?v=37","res/Themes/Maps/BG151.tmx?v=37","res/Themes/Maps/BG152-hd.plist?v=37","res/Themes/Maps/BG152.tmx?v=37","res/Themes/Maps/BG152_1.tmx?v=37","res/Themes/Maps/BG152_2.tmx?v=37","res/Themes/Maps/BG152_3.tmx?v=37","res/Themes/Maps/BG153-hd.plist?v=37","res/Themes/Maps/BG153.tmx?v=37","res/Themes/Maps/BG153_1.tmx?v=37","res/Themes/Maps/BG154-hd.plist?v=37","res/Themes/Maps/BG154.tmx?v=37","res/Themes/Maps/BG155-hd.plist?v=37","res/Themes/Maps/BG155.tmx?v=37","res/Themes/Maps/BG155_1.tmx?v=37","res/Themes/Maps/BG155_2.tmx?v=37","res/Themes/Maps/BG155_3.tmx?v=37","res/Themes/Maps/BG156-hd.plist?v=37","res/Themes/Maps/BG156.tmx?v=37","res/Themes/Maps/BG157-hd.plist?v=37","res/Themes/Maps/BG157.tmx?v=37","res/Themes/Maps/BG158-hd.plist?v=37","res/Themes/Maps/BG158.tmx?v=37","res/Themes/Maps/BG159-hd.plist?v=37","res/Themes/Maps/BG159.tmx?v=37","res/Themes/Maps/BG16-hd.plist?v=37","res/Themes/Maps/BG16.tmx?v=37","res/Themes/Maps/BG160-hd.plist?v=37","res/Themes/Maps/BG160.tmx?v=37","res/Themes/Maps/BG161-hd.plist?v=37","res/Themes/Maps/BG161.tmx?v=37","res/Themes/Maps/BG162-hd.plist?v=37","res/Themes/Maps/BG162.tmx?v=37","res/Themes/Maps/BG163-hd.plist?v=37","res/Themes/Maps/BG163.tmx?v=37","res/Themes/Maps/BG164-hd.plist?v=37","res/Themes/Maps/BG164.tmx?v=37","res/Themes/Maps/BG165-hd.plist?v=37","res/Themes/Maps/BG165.tmx?v=37","res/Themes/Maps/BG166-hd.plist?v=37","res/Themes/Maps/BG166.tmx?v=37","res/Themes/Maps/BG167-hd.plist?v=37","res/Themes/Maps/BG167.tmx?v=37","res/Themes/Maps/BG168-hd.plist?v=37","res/Themes/Maps/BG168.tmx?v=37","res/Themes/Maps/BG169-hd.plist?v=37","res/Themes/Maps/BG169.tmx?v=37","res/Themes/Maps/BG16_1.tmx?v=37","res/Themes/Maps/BG16_2.tmx?v=37","res/Themes/Maps/BG16_3.tmx?v=37","res/Themes/Maps/BG17-hd.plist?v=37","res/Themes/Maps/BG17.tmx?v=37","res/Themes/Maps/BG170-hd.plist?v=37","res/Themes/Maps/BG170.tmx?v=37","res/Themes/Maps/BG17_1.tmx?v=37","res/Themes/Maps/BG17_2.tmx?v=37","res/Themes/Maps/BG17_3.tmx?v=37","res/Themes/Maps/BG18-hd.plist?v=37","res/Themes/Maps/BG18.tmx?v=37","res/Themes/Maps/BG19-hd.plist?v=37","res/Themes/Maps/BG19.tmx?v=37","res/Themes/Maps/BG20-hd.plist?v=37","res/Themes/Maps/BG20.tmx?v=37","res/Themes/Maps/BG20_1.tmx?v=37","res/Themes/Maps/BG20_2.tmx?v=37","res/Themes/Maps/BG20_3.tmx?v=37","res/Themes/Maps/BG21-hd.plist?v=37","res/Themes/Maps/BG21.tmx?v=37","res/Themes/Maps/BG22-hd.plist?v=37","res/Themes/Maps/BG22.tmx?v=37","res/Themes/Maps/BG22_1.tmx?v=37","res/Themes/Maps/BG22_2.tmx?v=37","res/Themes/Maps/BG22_3.tmx?v=37","res/Themes/Maps/BG23-hd.plist?v=37","res/Themes/Maps/BG23.tmx?v=37","res/Themes/Maps/BG24-hd.plist?v=37","res/Themes/Maps/BG24.tmx?v=37","res/Themes/Maps/BG24_1.tmx?v=37","res/Themes/Maps/BG24_2.tmx?v=37","res/Themes/Maps/BG24_3.tmx?v=37","res/Themes/Maps/BG25-hd.plist?v=37","res/Themes/Maps/BG25.tmx?v=37","res/Themes/Maps/BG25_1.tmx?v=37","res/Themes/Maps/BG25_2.tmx?v=37","res/Themes/Maps/BG25_3.tmx?v=37","res/Themes/Maps/BG26-hd.plist?v=37","res/Themes/Maps/BG26.tmx?v=37","res/Themes/Maps/BG27-hd.plist?v=37","res/Themes/Maps/BG27.tmx?v=37","res/Themes/Maps/BG28-hd.plist?v=37","res/Themes/Maps/BG28.tmx?v=37","res/Themes/Maps/BG28_1.tmx?v=37","res/Themes/Maps/BG29-hd.plist?v=37","res/Themes/Maps/BG29.tmx?v=37","res/Themes/Maps/BG30-hd.plist?v=37","res/Themes/Maps/BG30.tmx?v=37","res/Themes/Maps/BG31-hd.plist?v=37","res/Themes/Maps/BG31.tmx?v=37","res/Themes/Maps/BG32-hd.plist?v=37","res/Themes/Maps/BG32.tmx?v=37","res/Themes/Maps/BG32_1.tmx?v=37","res/Themes/Maps/BG32_2.tmx?v=37","res/Themes/Maps/BG32_3.tmx?v=37","res/Themes/Maps/BG33-hd.plist?v=37","res/Themes/Maps/BG33.tmx?v=37","res/Themes/Maps/BG34-hd.plist?v=37","res/Themes/Maps/BG34.tmx?v=37","res/Themes/Maps/BG35-hd.plist?v=37","res/Themes/Maps/BG35.tmx?v=37","res/Themes/Maps/BG35_1.tmx?v=37","res/Themes/Maps/BG35_2.tmx?v=37","res/Themes/Maps/BG35_3.tmx?v=37","res/Themes/Maps/BG36-hd.plist?v=37","res/Themes/Maps/BG36.tmx?v=37","res/Themes/Maps/BG37-hd.plist?v=37","res/Themes/Maps/BG37.tmx?v=37","res/Themes/Maps/BG37_1.tmx?v=37","res/Themes/Maps/BG37_2.tmx?v=37","res/Themes/Maps/BG37_3.tmx?v=37","res/Themes/Maps/BG38-hd.plist?v=37","res/Themes/Maps/BG38.tmx?v=37","res/Themes/Maps/BG39-hd.plist?v=37","res/Themes/Maps/BG39.tmx?v=37","res/Themes/Maps/BG39_1.tmx?v=37","res/Themes/Maps/BG39_2.tmx?v=37","res/Themes/Maps/BG39_3.tmx?v=37","res/Themes/Maps/BG40-hd.plist?v=37","res/Themes/Maps/BG40.tmx?v=37","res/Themes/Maps/BG40_1.tmx?v=37","res/Themes/Maps/BG41-hd.plist?v=37","res/Themes/Maps/BG41.tmx?v=37","res/Themes/Maps/BG41_1.tmx?v=37","res/Themes/Maps/BG41_2.tmx?v=37","res/Themes/Maps/BG41_3.tmx?v=37","res/Themes/Maps/BG42-hd.plist?v=37","res/Themes/Maps/BG42.tmx?v=37","res/Themes/Maps/BG42_1.tmx?v=37","res/Themes/Maps/BG42_2.tmx?v=37","res/Themes/Maps/BG42_3.tmx?v=37","res/Themes/Maps/BG43-hd.plist?v=37","res/Themes/Maps/BG43.tmx?v=37","res/Themes/Maps/BG43_1.tmx?v=37","res/Themes/Maps/BG44-hd.plist?v=37","res/Themes/Maps/BG44.tmx?v=37","res/Themes/Maps/BG44_1.tmx?v=37","res/Themes/Maps/BG44_2.tmx?v=37","res/Themes/Maps/BG44_3.tmx?v=37","res/Themes/Maps/BG45-hd.plist?v=37","res/Themes/Maps/BG45.tmx?v=37","res/Themes/Maps/BG46-hd.plist?v=37","res/Themes/Maps/BG46.tmx?v=37","res/Themes/Maps/BG46_1.tmx?v=37","res/Themes/Maps/BG46_2.tmx?v=37","res/Themes/Maps/BG46_3.tmx?v=37","res/Themes/Maps/BG47-hd.plist?v=37","res/Themes/Maps/BG47.tmx?v=37","res/Themes/Maps/BG48-hd.plist?v=37","res/Themes/Maps/BG48.tmx?v=37","res/Themes/Maps/BG49-hd.plist?v=37","res/Themes/Maps/BG49.tmx?v=37","res/Themes/Maps/BG49_1.tmx?v=37","res/Themes/Maps/BG49_2.tmx?v=37","res/Themes/Maps/BG49_3.tmx?v=37","res/Themes/Maps/BG50-hd.plist?v=37","res/Themes/Maps/BG50.tmx?v=37","res/Themes/Maps/BG51-hd.plist?v=37","res/Themes/Maps/BG51.tmx?v=37","res/Themes/Maps/BG51_1.tmx?v=37","res/Themes/Maps/BG51_2.tmx?v=37","res/Themes/Maps/BG51_3.tmx?v=37","res/Themes/Maps/BG52-hd.plist?v=37","res/Themes/Maps/BG52.tmx?v=37","res/Themes/Maps/BG53-hd.plist?v=37","res/Themes/Maps/BG53.tmx?v=37","res/Themes/Maps/BG54-hd.plist?v=37","res/Themes/Maps/BG54.tmx?v=37","res/Themes/Maps/BG54_1.tmx?v=37","res/Themes/Maps/BG54_2.tmx?v=37","res/Themes/Maps/BG54_3.tmx?v=37","res/Themes/Maps/BG55-hd.plist?v=37","res/Themes/Maps/BG55.tmx?v=37","res/Themes/Maps/BG56-hd.plist?v=37","res/Themes/Maps/BG56.tmx?v=37","res/Themes/Maps/BG56_1.tmx?v=37","res/Themes/Maps/BG57-hd.plist?v=37","res/Themes/Maps/BG57.tmx?v=37","res/Themes/Maps/BG58-hd.plist?v=37","res/Themes/Maps/BG58.tmx?v=37","res/Themes/Maps/BG58_1.tmx?v=37","res/Themes/Maps/BG59-hd.plist?v=37","res/Themes/Maps/BG59.tmx?v=37","res/Themes/Maps/BG60-hd.plist?v=37","res/Themes/Maps/BG60.tmx?v=37","res/Themes/Maps/BG60_1.tmx?v=37","res/Themes/Maps/BG60_2.tmx?v=37","res/Themes/Maps/BG60_3.tmx?v=37","res/Themes/Maps/BG61-hd.plist?v=37","res/Themes/Maps/BG61.tmx?v=37","res/Themes/Maps/BG62-hd.plist?v=37","res/Themes/Maps/BG62.tmx?v=37","res/Themes/Maps/BG62_1.tmx?v=37","res/Themes/Maps/BG63-hd.plist?v=37","res/Themes/Maps/BG63.tmx?v=37","res/Themes/Maps/BG63_1.tmx?v=37","res/Themes/Maps/BG63_2.tmx?v=37","res/Themes/Maps/BG63_3.tmx?v=37","res/Themes/Maps/BG64-hd.plist?v=37","res/Themes/Maps/BG64.tmx?v=37","res/Themes/Maps/BG65-hd.plist?v=37","res/Themes/Maps/BG65.tmx?v=37","res/Themes/Maps/BG65_1.tmx?v=37","res/Themes/Maps/BG65_2.tmx?v=37","res/Themes/Maps/BG65_3.tmx?v=37","res/Themes/Maps/BG66-hd.plist?v=37","res/Themes/Maps/BG66.tmx?v=37","res/Themes/Maps/BG66_1.tmx?v=37","res/Themes/Maps/BG66_2.tmx?v=37","res/Themes/Maps/BG66_3.tmx?v=37","res/Themes/Maps/BG67-hd.plist?v=37","res/Themes/Maps/BG67.tmx?v=37","res/Themes/Maps/BG67_1.tmx?v=37","res/Themes/Maps/BG67_2.tmx?v=37","res/Themes/Maps/BG67_3.tmx?v=37","res/Themes/Maps/BG68-hd.plist?v=37","res/Themes/Maps/BG68.tmx?v=37","res/Themes/Maps/BG68_1.tmx?v=37","res/Themes/Maps/BG68_2.tmx?v=37","res/Themes/Maps/BG68_3.tmx?v=37","res/Themes/Maps/BG69-hd.plist?v=37","res/Themes/Maps/BG69.tmx?v=37","res/Themes/Maps/BG69_1.tmx?v=37","res/Themes/Maps/BG69_2.tmx?v=37","res/Themes/Maps/BG69_3.tmx?v=37","res/Themes/Maps/BG70-hd.plist?v=37","res/Themes/Maps/BG70.tmx?v=37","res/Themes/Maps/BG70_1.tmx?v=37","res/Themes/Maps/BG70_2.tmx?v=37","res/Themes/Maps/BG70_3.tmx?v=37","res/Themes/Maps/BG71-hd.plist?v=37","res/Themes/Maps/BG71.tmx?v=37","res/Themes/Maps/BG71_1.tmx?v=37","res/Themes/Maps/BG71_2.tmx?v=37","res/Themes/Maps/BG71_3.tmx?v=37","res/Themes/Maps/BG72-hd.plist?v=37","res/Themes/Maps/BG72.tmx?v=37","res/Themes/Maps/BG73-hd.plist?v=37","res/Themes/Maps/BG73.tmx?v=37","res/Themes/Maps/BG74-hd.plist?v=37","res/Themes/Maps/BG74.tmx?v=37","res/Themes/Maps/BG74_1.tmx?v=37","res/Themes/Maps/BG74_2.tmx?v=37","res/Themes/Maps/BG74_3.tmx?v=37","res/Themes/Maps/BG75-hd.plist?v=37","res/Themes/Maps/BG75.tmx?v=37","res/Themes/Maps/BG76-hd.plist?v=37","res/Themes/Maps/BG76.tmx?v=37","res/Themes/Maps/BG76_1.tmx?v=37","res/Themes/Maps/BG76_2.tmx?v=37","res/Themes/Maps/BG76_3.tmx?v=37","res/Themes/Maps/BG77-hd.plist?v=37","res/Themes/Maps/BG77.tmx?v=37","res/Themes/Maps/BG78-hd.plist?v=37","res/Themes/Maps/BG78.tmx?v=37","res/Themes/Maps/BG78_1.tmx?v=37","res/Themes/Maps/BG78_2.tmx?v=37","res/Themes/Maps/BG78_3.tmx?v=37","res/Themes/Maps/BG79-hd.plist?v=37","res/Themes/Maps/BG79.tmx?v=37","res/Themes/Maps/BG80-hd.plist?v=37","res/Themes/Maps/BG80.tmx?v=37","res/Themes/Maps/BG80_1.tmx?v=37","res/Themes/Maps/BG80_2.tmx?v=37","res/Themes/Maps/BG80_3.tmx?v=37","res/Themes/Maps/BG81-hd.plist?v=37","res/Themes/Maps/BG81.tmx?v=37","res/Themes/Maps/BG82-hd.plist?v=37","res/Themes/Maps/BG82.tmx?v=37","res/Themes/Maps/BG83-hd.plist?v=37","res/Themes/Maps/BG83.tmx?v=37","res/Themes/Maps/BG83_1.tmx?v=37","res/Themes/Maps/BG83_2.tmx?v=37","res/Themes/Maps/BG83_3.tmx?v=37","res/Themes/Maps/BG84-hd.plist?v=37","res/Themes/Maps/BG84.tmx?v=37","res/Themes/Maps/BG84_ 2.tmx?v=37","res/Themes/Maps/BG84_1.tmx?v=37","res/Themes/Maps/BG84_2.tmx?v=37","res/Themes/Maps/BG84_3.tmx?v=37","res/Themes/Maps/BG85-hd.plist?v=37","res/Themes/Maps/BG85.tmx?v=37","res/Themes/Maps/BG86-hd.plist?v=37","res/Themes/Maps/BG86.tmx?v=37","res/Themes/Maps/BG86_1.tmx?v=37","res/Themes/Maps/BG86_2.tmx?v=37","res/Themes/Maps/BG86_3.tmx?v=37","res/Themes/Maps/BG87-hd.plist?v=37","res/Themes/Maps/BG87.tmx?v=37","res/Themes/Maps/BG87_1.tmx?v=37","res/Themes/Maps/BG87_2.tmx?v=37","res/Themes/Maps/BG87_3.tmx?v=37","res/Themes/Maps/BG88-hd.plist?v=37","res/Themes/Maps/BG88.tmx?v=37","res/Themes/Maps/BG89-hd.plist?v=37","res/Themes/Maps/BG89.tmx?v=37","res/Themes/Maps/BG89_1.tmx?v=37","res/Themes/Maps/BG89_2.tmx?v=37","res/Themes/Maps/BG89_3.tmx?v=37","res/Themes/Maps/BG90-hd.plist?v=37","res/Themes/Maps/BG90.tmx?v=37","res/Themes/Maps/BG90_1.tmx?v=37","res/Themes/Maps/BG90_2.tmx?v=37","res/Themes/Maps/BG90_3.tmx?v=37","res/Themes/Maps/BG91-hd.plist?v=37","res/Themes/Maps/BG91.tmx?v=37","res/Themes/Maps/BG91_1.tmx?v=37","res/Themes/Maps/BG92-hd.plist?v=37","res/Themes/Maps/BG92.tmx?v=37","res/Themes/Maps/BG92_1.tmx?v=37","res/Themes/Maps/BG92_2.tmx?v=37","res/Themes/Maps/BG92_3.tmx?v=37","res/Themes/Maps/BG93-hd.plist?v=37","res/Themes/Maps/BG93.tmx?v=37","res/Themes/Maps/BG94-hd.plist?v=37","res/Themes/Maps/BG94.tmx?v=37","res/Themes/Maps/BG94_1.tmx?v=37","res/Themes/Maps/BG95-hd.plist?v=37","res/Themes/Maps/BG95.tmx?v=37","res/Themes/Maps/BG96-hd.plist?v=37","res/Themes/Maps/BG96.tmx?v=37","res/Themes/Maps/BG96_1.tmx?v=37","res/Themes/Maps/BG96_2.tmx?v=37","res/Themes/Maps/BG96_3.tmx?v=37","res/Themes/Maps/BG97-hd.plist?v=37","res/Themes/Maps/BG97.tmx?v=37","res/Themes/Maps/BG98-hd.plist?v=37","res/Themes/Maps/BG98.tmx?v=37","res/Themes/Maps/BG98_1.tmx?v=37","res/Themes/Maps/BG98_2.tmx?v=37","res/Themes/Maps/BG98_3.tmx?v=37","res/Themes/Maps/BG99-hd.plist?v=37","res/Themes/Maps/BG99.tmx?v=37","res/Themes/Theme1/BG-hd.plist?v=37","res/Themes/Theme1/BG.plist?v=37","res/Themes/Theme1/Monsters-hd.plist?v=37","res/Themes/Theme1/Objects-hd.plist?v=37","res/Themes/Theme2/BG-hd.plist?v=37","res/Themes/Theme2/GateBoss-hd.plist?v=37","res/Themes/Theme2/Monsters-hd.plist?v=37","res/Themes/Theme2/Objects-hd.plist?v=37","res/Themes/Theme3/BG-hd.plist?v=37","res/Themes/Theme3/GateBoss-hd.plist?v=37","res/Themes/Theme3/Monsters-hd.plist?v=37","res/Themes/Theme3/Objects-hd.plist?v=37","res/Themes/Theme4/BG-hd.plist?v=37","res/Themes/Theme4/GateBoss-hd.plist?v=37","res/Themes/Theme4/Monsters-hd.plist?v=37","res/Themes/Theme4/Objects-hd.plist?v=37","res/Themes/Theme5/BG-hd.plist?v=37","res/Themes/Theme5/GateBoss-hd.plist?v=37","res/Themes/Theme5/Monsters-hd.plist?v=37","res/Themes/Theme5/Objects-hd.plist?v=37","res/Themes/Theme6/BG-hd.plist?v=37","res/Themes/Theme6/GateBoss-hd.plist?v=37","res/Themes/Theme6/Monsters-hd.plist?v=37","res/Themes/Theme6/Objects-hd.plist?v=37","res/Themes/Towers/CRocket-hd.plist?v=37","res/Themes/Towers/CSnow-hd.plist?v=37","res/Themes/Towers/TAnchor-hd.plist?v=37","res/Themes/Towers/TArrow-hd.plist?v=37","res/Themes/Towers/TBall-hd.plist?v=37","res/Themes/Towers/TBlueStar-hd.plist?v=37","res/Themes/Towers/TBoomerang-hd.plist?v=37","res/Themes/Towers/TBottle-hd.plist?v=37","res/Themes/Towers/TCuttle-hd.plist?v=37","res/Themes/Towers/TFireBottle-hd.plist?v=37","res/Themes/Towers/TFish-hd.plist?v=37","res/Themes/Towers/TFlashLight-hd.plist?v=37","res/Themes/Towers/TIceFan-hd.plist?v=37","res/Themes/Towers/TMagnet-hd.plist?v=37","res/Themes/Towers/TMoon-hd.plist?v=37","res/Themes/Towers/TPin-hd.plist?v=37","res/Themes/Towers/TPlane-hd.plist?v=37","res/Themes/Towers/TRandom-hd.plist?v=37","res/Themes/Towers/TRocket-hd.plist?v=37","res/Themes/Towers/TShit-hd.plist?v=37","res/Themes/Towers/TSnow-hd.plist?v=37","res/Themes/Towers/TStar-hd.plist?v=37","res/Themes/Towers/TSun-hd.plist?v=37","res/Themes/scene/FloorReborn.plist?v=37","res/Themes/scene/FloorShare.plist?v=37","res/Themes/scene/Storey.plist?v=37","res/Themes/scene/WeiboComic-hd.plist?v=37","res/Themes/scene/cdkey-hd.plist?v=37","res/Themes/scene/gameover01.plist?v=37","res/Themes/scene/gameover01.png?v=37","res/Themes/scene/gameover_lose.plist?v=37","res/Themes/scene/gameover_win.plist?v=37","res/Themes/scene/mainscene-hd.plist?v=37","res/Themes/scene/mainscene-hd.png?v=37","res/Themes/scene/themelocked.plist?v=37","res/Themes/scene/themelocked.png?v=37","res/Themes_cn/Items/FTMonsters-hd.plist?v=37","res/Themes_cn/Items/GateItems-hd_cn.plist?v=37","res/Themes_cn/Items/GateItems-hd_cn.png?v=37","res/Themes_cn/Items/Items03-hd_cn.plist?v=37","res/Themes_cn/Items/Items04-hd_cn.plist?v=37","res/Themes_cn/Items/ModeTour-hd_cn.plist?v=37","res/Themes_cn/Items/NewProp-hd_cn.plist?v=37","res/Themes_cn/Items/pingfen-hd_cn.plist?v=37","res/Themes_cn/LevelSelect/AwardBG_cn.plist?v=37","res/Themes_cn/LevelSelect/LevelSel03-hd.plist?v=37","res/Themes_cn/LevelSelect/LevelSel04-hd.plist?v=37","res/Themes_cn/LevelSelect/Roulette-hd_cn.plist?v=37","res/Themes_cn/LevelSelect/Shop01-hd_cn.plist?v=37","res/Themes_cn/LevelSelect/Shop01-hd_cn.png?v=37","res/Themes_cn/LevelSelect/StoneToProp-hd_cn.plist?v=37","res/Themes_cn/LevelSelect/StoneToProp-hd_cn.png?v=37","res/Themes_cn/LevelSelect/basemap2-hd_cn.plist?v=37","res/Themes_cn/LevelSelect/basemap2-hd_cn.png?v=37","res/Themes_cn/LevelSelect/discount-hd_cn.plist?v=37","res/Themes_cn/Maps/BG01-hd_cn.plist?v=37","res/Themes_cn/Maps/BG01-hd_cn.png?v=37","res/Themes_cn/Maps/BG02-hd_cn.plist?v=37","res/Themes_cn/Maps/BG02-hd_cn.png?v=37","res/Themes_cn/Maps/BG03-hd_cn.plist?v=37","res/Themes_cn/Maps/BG03-hd_cn.png?v=37","res/Themes_cn/Maps/BG04-hd_cn.plist?v=37","res/Themes_cn/Maps/BG04-hd_cn.png?v=37","res/Themes_cn/Maps/BG05-hd_cn.plist?v=37","res/Themes_cn/Maps/BG05-hd_cn.png?v=37","res/Themes_cn/Maps/BG06-hd_cn.plist?v=37","res/Themes_cn/Maps/BG06-hd_cn.png?v=37","res/Themes_cn/Maps/BG07-hd_cn.plist?v=37","res/Themes_cn/Maps/BG07-hd_cn.png?v=37","res/Themes_cn/Maps/BG08-hd_cn.plist?v=37","res/Themes_cn/Maps/BG08-hd_cn.png?v=37","res/Themes_cn/Maps/BG09-hd_cn.plist?v=37","res/Themes_cn/Maps/BG09-hd_cn.png?v=37","res/Themes_cn/Maps/BG10-hd_cn.plist?v=37","res/Themes_cn/Maps/BG10-hd_cn.png?v=37","res/Themes_cn/Maps/BG100-hd_cn.plist?v=37","res/Themes_cn/Maps/BG100-hd_cn.png?v=37","res/Themes_cn/Maps/BG101-hd_cn.plist?v=37","res/Themes_cn/Maps/BG101-hd_cn.png?v=37","res/Themes_cn/Maps/BG102-hd_cn.plist?v=37","res/Themes_cn/Maps/BG102-hd_cn.png?v=37","res/Themes_cn/Maps/BG103-hd_cn.plist?v=37","res/Themes_cn/Maps/BG103-hd_cn.png?v=37","res/Themes_cn/Maps/BG104-hd_cn.plist?v=37","res/Themes_cn/Maps/BG104-hd_cn.png?v=37","res/Themes_cn/Maps/BG105-hd_cn.plist?v=37","res/Themes_cn/Maps/BG105-hd_cn.png?v=37","res/Themes_cn/Maps/BG106-hd_cn.plist?v=37","res/Themes_cn/Maps/BG106-hd_cn.png?v=37","res/Themes_cn/Maps/BG107-hd_cn.plist?v=37","res/Themes_cn/Maps/BG107-hd_cn.png?v=37","res/Themes_cn/Maps/BG108-hd_cn.plist?v=37","res/Themes_cn/Maps/BG108-hd_cn.png?v=37","res/Themes_cn/Maps/BG109-hd_cn.plist?v=37","res/Themes_cn/Maps/BG109-hd_cn.png?v=37","res/Themes_cn/Maps/BG11-hd_cn.plist?v=37","res/Themes_cn/Maps/BG11-hd_cn.png?v=37","res/Themes_cn/Maps/BG110-hd_cn.plist?v=37","res/Themes_cn/Maps/BG110-hd_cn.png?v=37","res/Themes_cn/Maps/BG111-hd_cn.plist?v=37","res/Themes_cn/Maps/BG111-hd_cn.png?v=37","res/Themes_cn/Maps/BG112-hd_cn.plist?v=37","res/Themes_cn/Maps/BG112-hd_cn.png?v=37","res/Themes_cn/Maps/BG113-hd_cn.plist?v=37","res/Themes_cn/Maps/BG113-hd_cn.png?v=37","res/Themes_cn/Maps/BG114-hd_cn.plist?v=37","res/Themes_cn/Maps/BG114-hd_cn.png?v=37","res/Themes_cn/Maps/BG115-hd_cn.plist?v=37","res/Themes_cn/Maps/BG115-hd_cn.png?v=37","res/Themes_cn/Maps/BG116-hd_cn.plist?v=37","res/Themes_cn/Maps/BG116-hd_cn.png?v=37","res/Themes_cn/Maps/BG117-hd_cn.plist?v=37","res/Themes_cn/Maps/BG117-hd_cn.png?v=37","res/Themes_cn/Maps/BG118-hd_cn.plist?v=37","res/Themes_cn/Maps/BG118-hd_cn.png?v=37","res/Themes_cn/Maps/BG119-hd_cn.plist?v=37","res/Themes_cn/Maps/BG119-hd_cn.png?v=37","res/Themes_cn/Maps/BG12-hd_cn.plist?v=37","res/Themes_cn/Maps/BG12-hd_cn.png?v=37","res/Themes_cn/Maps/BG120-hd_cn.plist?v=37","res/Themes_cn/Maps/BG120-hd_cn.png?v=37","res/Themes_cn/Maps/BG121-hd_cn.plist?v=37","res/Themes_cn/Maps/BG121-hd_cn.png?v=37","res/Themes_cn/Maps/BG122-hd_cn.plist?v=37","res/Themes_cn/Maps/BG122-hd_cn.png?v=37","res/Themes_cn/Maps/BG123-hd_cn.plist?v=37","res/Themes_cn/Maps/BG123-hd_cn.png?v=37","res/Themes_cn/Maps/BG124-hd_cn.plist?v=37","res/Themes_cn/Maps/BG124-hd_cn.png?v=37","res/Themes_cn/Maps/BG125-hd_cn.plist?v=37","res/Themes_cn/Maps/BG125-hd_cn.png?v=37","res/Themes_cn/Maps/BG126-hd_cn.plist?v=37","res/Themes_cn/Maps/BG126-hd_cn.png?v=37","res/Themes_cn/Maps/BG127-hd_cn.plist?v=37","res/Themes_cn/Maps/BG127-hd_cn.png?v=37","res/Themes_cn/Maps/BG128-hd_cn.plist?v=37","res/Themes_cn/Maps/BG128-hd_cn.png?v=37","res/Themes_cn/Maps/BG129-hd_cn.plist?v=37","res/Themes_cn/Maps/BG129-hd_cn.png?v=37","res/Themes_cn/Maps/BG13-hd_cn.plist?v=37","res/Themes_cn/Maps/BG13-hd_cn.png?v=37","res/Themes_cn/Maps/BG130-hd_cn.plist?v=37","res/Themes_cn/Maps/BG130-hd_cn.png?v=37","res/Themes_cn/Maps/BG131-hd_cn.plist?v=37","res/Themes_cn/Maps/BG131-hd_cn.png?v=37","res/Themes_cn/Maps/BG132-hd_cn.plist?v=37","res/Themes_cn/Maps/BG132-hd_cn.png?v=37","res/Themes_cn/Maps/BG133-hd_cn.plist?v=37","res/Themes_cn/Maps/BG133-hd_cn.png?v=37","res/Themes_cn/Maps/BG134-hd_cn.plist?v=37","res/Themes_cn/Maps/BG134-hd_cn.png?v=37","res/Themes_cn/Maps/BG135-hd_cn.plist?v=37","res/Themes_cn/Maps/BG135-hd_cn.png?v=37","res/Themes_cn/Maps/BG136-hd_cn.plist?v=37","res/Themes_cn/Maps/BG136-hd_cn.png?v=37","res/Themes_cn/Maps/BG137-hd_cn.plist?v=37","res/Themes_cn/Maps/BG137-hd_cn.png?v=37","res/Themes_cn/Maps/BG138-hd_cn.plist?v=37","res/Themes_cn/Maps/BG138-hd_cn.png?v=37","res/Themes_cn/Maps/BG139-hd_cn.plist?v=37","res/Themes_cn/Maps/BG139-hd_cn.png?v=37","res/Themes_cn/Maps/BG14-hd_cn.plist?v=37","res/Themes_cn/Maps/BG14-hd_cn.png?v=37","res/Themes_cn/Maps/BG140-hd_cn.plist?v=37","res/Themes_cn/Maps/BG140-hd_cn.png?v=37","res/Themes_cn/Maps/BG141-hd_cn.plist?v=37","res/Themes_cn/Maps/BG141-hd_cn.png?v=37","res/Themes_cn/Maps/BG142-hd_cn.plist?v=37","res/Themes_cn/Maps/BG142-hd_cn.png?v=37","res/Themes_cn/Maps/BG143-hd_cn.plist?v=37","res/Themes_cn/Maps/BG143-hd_cn.png?v=37","res/Themes_cn/Maps/BG144-hd_cn.plist?v=37","res/Themes_cn/Maps/BG144-hd_cn.png?v=37","res/Themes_cn/Maps/BG145-hd_cn.plist?v=37","res/Themes_cn/Maps/BG145-hd_cn.png?v=37","res/Themes_cn/Maps/BG146-hd_cn.plist?v=37","res/Themes_cn/Maps/BG146-hd_cn.png?v=37","res/Themes_cn/Maps/BG147-hd_cn.plist?v=37","res/Themes_cn/Maps/BG147-hd_cn.png?v=37","res/Themes_cn/Maps/BG148-hd_cn.plist?v=37","res/Themes_cn/Maps/BG148-hd_cn.png?v=37","res/Themes_cn/Maps/BG149-hd_cn.plist?v=37","res/Themes_cn/Maps/BG149-hd_cn.png?v=37","res/Themes_cn/Maps/BG15-hd_cn.plist?v=37","res/Themes_cn/Maps/BG15-hd_cn.png?v=37","res/Themes_cn/Maps/BG150-hd_cn.plist?v=37","res/Themes_cn/Maps/BG150-hd_cn.png?v=37","res/Themes_cn/Maps/BG151-hd_cn.plist?v=37","res/Themes_cn/Maps/BG151-hd_cn.png?v=37","res/Themes_cn/Maps/BG152-hd_cn.plist?v=37","res/Themes_cn/Maps/BG152-hd_cn.png?v=37","res/Themes_cn/Maps/BG153-hd_cn.plist?v=37","res/Themes_cn/Maps/BG153-hd_cn.png?v=37","res/Themes_cn/Maps/BG154-hd_cn.plist?v=37","res/Themes_cn/Maps/BG154-hd_cn.png?v=37","res/Themes_cn/Maps/BG155-hd_cn.plist?v=37","res/Themes_cn/Maps/BG155-hd_cn.png?v=37","res/Themes_cn/Maps/BG156-hd_cn.plist?v=37","res/Themes_cn/Maps/BG156-hd_cn.png?v=37","res/Themes_cn/Maps/BG157-hd_cn.plist?v=37","res/Themes_cn/Maps/BG157-hd_cn.png?v=37","res/Themes_cn/Maps/BG158-hd_cn.plist?v=37","res/Themes_cn/Maps/BG158-hd_cn.png?v=37","res/Themes_cn/Maps/BG159-hd_cn.plist?v=37","res/Themes_cn/Maps/BG159-hd_cn.png?v=37","res/Themes_cn/Maps/BG16-hd_cn.plist?v=37","res/Themes_cn/Maps/BG16-hd_cn.png?v=37","res/Themes_cn/Maps/BG160-hd_cn.plist?v=37","res/Themes_cn/Maps/BG160-hd_cn.png?v=37","res/Themes_cn/Maps/BG161-hd_cn.plist?v=37","res/Themes_cn/Maps/BG161-hd_cn.png?v=37","res/Themes_cn/Maps/BG162-hd_cn.plist?v=37","res/Themes_cn/Maps/BG162-hd_cn.png?v=37","res/Themes_cn/Maps/BG163-hd_cn.plist?v=37","res/Themes_cn/Maps/BG163-hd_cn.png?v=37","res/Themes_cn/Maps/BG164-hd_cn.plist?v=37","res/Themes_cn/Maps/BG164-hd_cn.png?v=37","res/Themes_cn/Maps/BG165-hd_cn.plist?v=37","res/Themes_cn/Maps/BG165-hd_cn.png?v=37","res/Themes_cn/Maps/BG166-hd_cn.plist?v=37","res/Themes_cn/Maps/BG166-hd_cn.png?v=37","res/Themes_cn/Maps/BG167-hd_cn.plist?v=37","res/Themes_cn/Maps/BG167-hd_cn.png?v=37","res/Themes_cn/Maps/BG168-hd_cn.plist?v=37","res/Themes_cn/Maps/BG168-hd_cn.png?v=37","res/Themes_cn/Maps/BG169-hd_cn.plist?v=37","res/Themes_cn/Maps/BG169-hd_cn.png?v=37","res/Themes_cn/Maps/BG17-hd_cn.plist?v=37","res/Themes_cn/Maps/BG17-hd_cn.png?v=37","res/Themes_cn/Maps/BG170-hd_cn.plist?v=37","res/Themes_cn/Maps/BG170-hd_cn.png?v=37","res/Themes_cn/Maps/BG18-hd_cn.plist?v=37","res/Themes_cn/Maps/BG18-hd_cn.png?v=37","res/Themes_cn/Maps/BG19-hd_cn.plist?v=37","res/Themes_cn/Maps/BG19-hd_cn.png?v=37","res/Themes_cn/Maps/BG20-hd_cn.plist?v=37","res/Themes_cn/Maps/BG20-hd_cn.png?v=37","res/Themes_cn/Maps/BG21-hd_cn.plist?v=37","res/Themes_cn/Maps/BG21-hd_cn.png?v=37","res/Themes_cn/Maps/BG22-hd_cn.plist?v=37","res/Themes_cn/Maps/BG22-hd_cn.png?v=37","res/Themes_cn/Maps/BG23-hd_cn.plist?v=37","res/Themes_cn/Maps/BG23-hd_cn.png?v=37","res/Themes_cn/Maps/BG24-hd_cn.plist?v=37","res/Themes_cn/Maps/BG24-hd_cn.png?v=37","res/Themes_cn/Maps/BG25-hd_cn.plist?v=37","res/Themes_cn/Maps/BG25-hd_cn.png?v=37","res/Themes_cn/Maps/BG26-hd_cn.plist?v=37","res/Themes_cn/Maps/BG26-hd_cn.png?v=37","res/Themes_cn/Maps/BG27-hd_cn.plist?v=37","res/Themes_cn/Maps/BG27-hd_cn.png?v=37","res/Themes_cn/Maps/BG28-hd_cn.plist?v=37","res/Themes_cn/Maps/BG28-hd_cn.png?v=37","res/Themes_cn/Maps/BG29-hd_cn.plist?v=37","res/Themes_cn/Maps/BG29-hd_cn.png?v=37","res/Themes_cn/Maps/BG30-hd_cn.plist?v=37","res/Themes_cn/Maps/BG30-hd_cn.png?v=37","res/Themes_cn/Maps/BG31-hd_cn.plist?v=37","res/Themes_cn/Maps/BG31-hd_cn.png?v=37","res/Themes_cn/Maps/BG32-hd_cn.plist?v=37","res/Themes_cn/Maps/BG32-hd_cn.png?v=37","res/Themes_cn/Maps/BG33-hd_cn.plist?v=37","res/Themes_cn/Maps/BG33-hd_cn.png?v=37","res/Themes_cn/Maps/BG34-hd_cn.plist?v=37","res/Themes_cn/Maps/BG34-hd_cn.png?v=37","res/Themes_cn/Maps/BG35-hd_cn.plist?v=37","res/Themes_cn/Maps/BG35-hd_cn.png?v=37","res/Themes_cn/Maps/BG36-hd_cn.plist?v=37","res/Themes_cn/Maps/BG36-hd_cn.png?v=37","res/Themes_cn/Maps/BG37-hd_cn.plist?v=37","res/Themes_cn/Maps/BG37-hd_cn.png?v=37","res/Themes_cn/Maps/BG38-hd_cn.plist?v=37","res/Themes_cn/Maps/BG38-hd_cn.png?v=37","res/Themes_cn/Maps/BG39-hd_cn.plist?v=37","res/Themes_cn/Maps/BG39-hd_cn.png?v=37","res/Themes_cn/Maps/BG40-hd_cn.plist?v=37","res/Themes_cn/Maps/BG40-hd_cn.png?v=37","res/Themes_cn/Maps/BG41-hd_cn.plist?v=37","res/Themes_cn/Maps/BG41-hd_cn.png?v=37","res/Themes_cn/Maps/BG42-hd_cn.plist?v=37","res/Themes_cn/Maps/BG42-hd_cn.png?v=37","res/Themes_cn/Maps/BG43-hd_cn.plist?v=37","res/Themes_cn/Maps/BG43-hd_cn.png?v=37","res/Themes_cn/Maps/BG44-hd_cn.plist?v=37","res/Themes_cn/Maps/BG44-hd_cn.png?v=37","res/Themes_cn/Maps/BG45-hd_cn.plist?v=37","res/Themes_cn/Maps/BG45-hd_cn.png?v=37","res/Themes_cn/Maps/BG46-hd_cn.plist?v=37","res/Themes_cn/Maps/BG46-hd_cn.png?v=37","res/Themes_cn/Maps/BG47-hd_cn.plist?v=37","res/Themes_cn/Maps/BG47-hd_cn.png?v=37","res/Themes_cn/Maps/BG48-hd_cn.plist?v=37","res/Themes_cn/Maps/BG48-hd_cn.png?v=37","res/Themes_cn/Maps/BG49-hd_cn.plist?v=37","res/Themes_cn/Maps/BG49-hd_cn.png?v=37","res/Themes_cn/Maps/BG50-hd_cn.plist?v=37","res/Themes_cn/Maps/BG50-hd_cn.png?v=37","res/Themes_cn/Maps/BG51-hd_cn.plist?v=37","res/Themes_cn/Maps/BG51-hd_cn.png?v=37","res/Themes_cn/Maps/BG52-hd_cn.plist?v=37","res/Themes_cn/Maps/BG52-hd_cn.png?v=37","res/Themes_cn/Maps/BG53-hd_cn.plist?v=37","res/Themes_cn/Maps/BG53-hd_cn.png?v=37","res/Themes_cn/Maps/BG54-hd_cn.plist?v=37","res/Themes_cn/Maps/BG54-hd_cn.png?v=37","res/Themes_cn/Maps/BG55-hd_cn.plist?v=37","res/Themes_cn/Maps/BG55-hd_cn.png?v=37","res/Themes_cn/Maps/BG56-hd_cn.plist?v=37","res/Themes_cn/Maps/BG56-hd_cn.png?v=37","res/Themes_cn/Maps/BG57-hd_cn.plist?v=37","res/Themes_cn/Maps/BG57-hd_cn.png?v=37","res/Themes_cn/Maps/BG58-hd_cn.plist?v=37","res/Themes_cn/Maps/BG58-hd_cn.png?v=37","res/Themes_cn/Maps/BG59-hd_cn.plist?v=37","res/Themes_cn/Maps/BG59-hd_cn.png?v=37","res/Themes_cn/Maps/BG60-hd_cn.plist?v=37","res/Themes_cn/Maps/BG60-hd_cn.png?v=37","res/Themes_cn/Maps/BG61-hd_cn.plist?v=37","res/Themes_cn/Maps/BG61-hd_cn.png?v=37","res/Themes_cn/Maps/BG62-hd_cn.plist?v=37","res/Themes_cn/Maps/BG62-hd_cn.png?v=37","res/Themes_cn/Maps/BG63-hd_cn.plist?v=37","res/Themes_cn/Maps/BG63-hd_cn.png?v=37","res/Themes_cn/Maps/BG64-hd_cn.plist?v=37","res/Themes_cn/Maps/BG64-hd_cn.png?v=37","res/Themes_cn/Maps/BG65-hd_cn.plist?v=37","res/Themes_cn/Maps/BG65-hd_cn.png?v=37","res/Themes_cn/Maps/BG66-hd_cn.plist?v=37","res/Themes_cn/Maps/BG66-hd_cn.png?v=37","res/Themes_cn/Maps/BG67-hd_cn.plist?v=37","res/Themes_cn/Maps/BG67-hd_cn.png?v=37","res/Themes_cn/Maps/BG68-hd_cn.plist?v=37","res/Themes_cn/Maps/BG68-hd_cn.png?v=37","res/Themes_cn/Maps/BG69-hd_cn.plist?v=37","res/Themes_cn/Maps/BG69-hd_cn.png?v=37","res/Themes_cn/Maps/BG70-hd_cn.plist?v=37","res/Themes_cn/Maps/BG70-hd_cn.png?v=37","res/Themes_cn/Maps/BG71-hd_cn.plist?v=37","res/Themes_cn/Maps/BG71-hd_cn.png?v=37","res/Themes_cn/Maps/BG72-hd_cn.plist?v=37","res/Themes_cn/Maps/BG72-hd_cn.png?v=37","res/Themes_cn/Maps/BG73-hd_cn.plist?v=37","res/Themes_cn/Maps/BG73-hd_cn.png?v=37","res/Themes_cn/Maps/BG74-hd_cn.plist?v=37","res/Themes_cn/Maps/BG74-hd_cn.png?v=37","res/Themes_cn/Maps/BG75-hd_cn.plist?v=37","res/Themes_cn/Maps/BG75-hd_cn.png?v=37","res/Themes_cn/Maps/BG76-hd_cn.plist?v=37","res/Themes_cn/Maps/BG76-hd_cn.png?v=37","res/Themes_cn/Maps/BG77-hd_cn.plist?v=37","res/Themes_cn/Maps/BG77-hd_cn.png?v=37","res/Themes_cn/Maps/BG78-hd_cn.plist?v=37","res/Themes_cn/Maps/BG78-hd_cn.png?v=37","res/Themes_cn/Maps/BG79-hd_cn.plist?v=37","res/Themes_cn/Maps/BG79-hd_cn.png?v=37","res/Themes_cn/Maps/BG80-hd_cn.plist?v=37","res/Themes_cn/Maps/BG80-hd_cn.png?v=37","res/Themes_cn/Maps/BG81-hd_cn.plist?v=37","res/Themes_cn/Maps/BG81-hd_cn.png?v=37","res/Themes_cn/Maps/BG82-hd_cn.plist?v=37","res/Themes_cn/Maps/BG82-hd_cn.png?v=37","res/Themes_cn/Maps/BG83-hd_cn.plist?v=37","res/Themes_cn/Maps/BG83-hd_cn.png?v=37","res/Themes_cn/Maps/BG84-hd_cn.plist?v=37","res/Themes_cn/Maps/BG84-hd_cn.png?v=37","res/Themes_cn/Maps/BG85-hd_cn.plist?v=37","res/Themes_cn/Maps/BG85-hd_cn.png?v=37","res/Themes_cn/Maps/BG86-hd_cn.plist?v=37","res/Themes_cn/Maps/BG86-hd_cn.png?v=37","res/Themes_cn/Maps/BG87-hd_cn.plist?v=37","res/Themes_cn/Maps/BG87-hd_cn.png?v=37","res/Themes_cn/Maps/BG88-hd_cn.plist?v=37","res/Themes_cn/Maps/BG88-hd_cn.png?v=37","res/Themes_cn/Maps/BG89-hd_cn.plist?v=37","res/Themes_cn/Maps/BG89-hd_cn.png?v=37","res/Themes_cn/Maps/BG90-hd_cn.plist?v=37","res/Themes_cn/Maps/BG90-hd_cn.png?v=37","res/Themes_cn/Maps/BG91-hd_cn.plist?v=37","res/Themes_cn/Maps/BG91-hd_cn.png?v=37","res/Themes_cn/Maps/BG92-hd_cn.plist?v=37","res/Themes_cn/Maps/BG92-hd_cn.png?v=37","res/Themes_cn/Maps/BG93-hd_cn.plist?v=37","res/Themes_cn/Maps/BG93-hd_cn.png?v=37","res/Themes_cn/Maps/BG94-hd_cn.plist?v=37","res/Themes_cn/Maps/BG94-hd_cn.png?v=37","res/Themes_cn/Maps/BG95-hd_cn.plist?v=37","res/Themes_cn/Maps/BG95-hd_cn.png?v=37","res/Themes_cn/Maps/BG96-hd_cn.plist?v=37","res/Themes_cn/Maps/BG96-hd_cn.png?v=37","res/Themes_cn/Maps/BG97-hd_cn.plist?v=37","res/Themes_cn/Maps/BG97-hd_cn.png?v=37","res/Themes_cn/Maps/BG98-hd_cn.plist?v=37","res/Themes_cn/Maps/BG98-hd_cn.png?v=37","res/Themes_cn/Maps/BG99-hd_cn.plist?v=37","res/Themes_cn/Maps/BG99-hd_cn.png?v=37","res/Themes_cn/scene/FloorReborn_cn.plist?v=37","res/Themes_cn/scene/FloorShare_cn.plist?v=37","res/Themes_cn/scene/WeiboComic-hd_cn.plist?v=37","res/Themes_cn/scene/cdkey-hd_cn.plist?v=37","res/Themes_cn/scene/gameover_lose_cn.plist?v=37","res/Themes_cn/scene/mainscene-hd_cn_.png?v=37","res/Themes_cn/scene/setting-hd_cn.plist?v=37","res/Themes_cn/scene/setting-hd_cn.png?v=37","res/favicon.ico?v=37","res/fb_photo.jpg?v=37","res/icon_100.png?v=37","res/icon_120.png?v=37","res/net_loading.png?v=37","res/tencent/mailpanel.plist?v=37","res/tencent/mainScene_btn.plist?v=37","res/tencent/mainScene_btn.png?v=37","res/tencent/rankingup_number1.png?v=37","res/tencent/shop_new.plist?v=37","res/tencent/shop_new.png?v=37","res/tencent/tencent_common.plist?v=37","res/tencent/tencent_common.png?v=37","res/tencent/themelocked_buy1.png?v=37","res/Themes/LevelSelect/LevelSel02-hd.plist?v=45","res/Themes_cn/LevelSelect/Shop02-hd_cn.plist?v=45","res/Themes/LevelSelect/shop-1.plist?v=53","res/Themes/LevelSelect/shop-1.png?v=53","res/Themes/LevelSelect/shop_carrot.plist?v=53","res/Themes/LevelSelect/shopcommon.plist?v=53","res/Themes/LevelSelect/shopcommon.png?v=53","res/Themes/scene/setting-hd.plist?v=53","res/Themes_cn/LevelSelect/modeunlock_cn.png?v=53","res/Themes_cn/scene/help-hd_cn.plist?v=53","res/tencent/lifeReques.plist?v=53","res/tencent/lifeReques.png?v=53","res/Themes/LevelSelect/lifeReques.plist?v=59","res/Themes/LevelSelect/lifeless.plist?v=70","res/Themes/LevelSelect/lifeless.png?v=70","res/nfront_abo_lim.png?v=87","res/Themes/LevelSelect/routemap_part1.plist?v=91","res/Themes/LevelSelect/shop-3.plist?v=91","res/Themes/LevelSelect/shop-3.png?v=91","res/tencent/buy_items.plist?v=91","res/tencent/buy_items.png?v=91","res/tencent/rank_change.plist?v=91","res/tencent/rank_change.png?v=91","res/tencent/rankingup_number2.png?v=91","res/tencent/shortcut_cn.plist?v=91","res/tencent/shortcut_cn.png?v=91","res/tencent/tencent_qun_share.plist?v=91","res/tencent/tencent_qun_share.png?v=91","res/tencent/tencent_share.plist?v=91","res/tencent/tencent_share.png?v=91","res/Themes_cn/scene/mainscene-hd_cn16.png?v=96","res/Themes_cn/scene/mainscene-hd_cn_8.png?v=96","res/tencent/mailpanel.png?v=96","res/Default@2x.png?v=135","res/Themes/DayMaps/BG1_1_1.plist?v=135","res/Themes/DayMaps/BG1_1_1.png?v=135","res/Themes/DayMaps/BG1_1_2.plist?v=135","res/Themes/DayMaps/BG1_1_2.png?v=135","res/Themes/DayMaps/BG1_1_4.plist?v=135","res/Themes/DayMaps/BG1_1_4.png?v=135","res/Themes/DayMaps/BG1_1_46.plist?v=135","res/Themes/DayMaps/BG1_1_46.png?v=135","res/Themes/DayMaps/BG1_1_47.plist?v=135","res/Themes/DayMaps/BG1_1_47.png?v=135","res/Themes/DayMaps/BG1_2_3.plist?v=135","res/Themes/DayMaps/BG1_2_3.png?v=135","res/Themes/DayMaps/BG1_2_48.plist?v=135","res/Themes/DayMaps/BG1_2_48.png?v=135","res/Themes/DayMaps/BG1_2_49.plist?v=135","res/Themes/DayMaps/BG1_2_49.png?v=135","res/Themes/DayMaps/BG1_2_5.plist?v=135","res/Themes/DayMaps/BG1_2_5.png?v=135","res/Themes/DayMaps/BG2_1_10.plist?v=135","res/Themes/DayMaps/BG2_1_10.png?v=135","res/Themes/DayMaps/BG2_1_50.plist?v=135","res/Themes/DayMaps/BG2_1_50.png?v=135","res/Themes/DayMaps/BG2_1_51.plist?v=135","res/Themes/DayMaps/BG2_1_51.png?v=135","res/Themes/DayMaps/BG2_1_6.plist?v=135","res/Themes/DayMaps/BG2_1_6.png?v=135","res/Themes/DayMaps/BG2_1_7.plist?v=135","res/Themes/DayMaps/BG2_1_7.png?v=135","res/Themes/DayMaps/BG2_1_8.plist?v=135","res/Themes/DayMaps/BG2_1_8.png?v=135","res/Themes/DayMaps/BG2_1_9.plist?v=135","res/Themes/DayMaps/BG2_1_9.png?v=135","res/Themes/DayMaps/BG2_2_52.plist?v=135","res/Themes/DayMaps/BG2_2_52.png?v=135","res/Themes/DayMaps/BG3_1_11.plist?v=135","res/Themes/DayMaps/BG3_1_11.png?v=135","res/Themes/DayMaps/BG3_1_12.plist?v=135","res/Themes/DayMaps/BG3_1_12.png?v=135","res/Themes/DayMaps/BG3_1_13.plist?v=135","res/Themes/DayMaps/BG3_1_13.png?v=135","res/Themes/DayMaps/BG3_1_14.plist?v=135","res/Themes/DayMaps/BG3_1_14.png?v=135","res/Themes/DayMaps/BG3_1_15.plist?v=135","res/Themes/DayMaps/BG3_1_15.png?v=135","res/Themes/DayMaps/BG3_1_53.plist?v=135","res/Themes/DayMaps/BG3_1_53.png?v=135","res/Themes/DayMaps/BG3_2_54.plist?v=135","res/Themes/DayMaps/BG3_2_54.png?v=135","res/Themes/DayMaps/BG3_2_55.plist?v=135","res/Themes/DayMaps/BG3_2_55.png?v=135","res/Themes/DayMaps/BG4_1_16.plist?v=135","res/Themes/DayMaps/BG4_1_16.png?v=135","res/Themes/DayMaps/BG4_1_17.plist?v=135","res/Themes/DayMaps/BG4_1_17.png?v=135","res/Themes/DayMaps/BG4_1_18.plist?v=135","res/Themes/DayMaps/BG4_1_18.png?v=135","res/Themes/DayMaps/BG4_1_19.plist?v=135","res/Themes/DayMaps/BG4_1_19.png?v=135","res/Themes/DayMaps/BG4_1_20.plist?v=135","res/Themes/DayMaps/BG4_1_20.png?v=135","res/Themes/DayMaps/BG4_1_57.plist?v=135","res/Themes/DayMaps/BG4_1_57.png?v=135","res/Themes/DayMaps/BG4_2_56.plist?v=135","res/Themes/DayMaps/BG4_2_56.png?v=135","res/Themes/DayMaps/BG5_1_21.plist?v=135","res/Themes/DayMaps/BG5_1_21.png?v=135","res/Themes/DayMaps/BG5_1_22.plist?v=135","res/Themes/DayMaps/BG5_1_22.png?v=135","res/Themes/DayMaps/BG5_1_23.plist?v=135","res/Themes/DayMaps/BG5_1_23.png?v=135","res/Themes/DayMaps/BG5_1_24.plist?v=135","res/Themes/DayMaps/BG5_1_24.png?v=135","res/Themes/DayMaps/BG5_1_25.plist?v=135","res/Themes/DayMaps/BG5_1_25.png?v=135","res/Themes/DayMaps/BG5_1_59.plist?v=135","res/Themes/DayMaps/BG5_1_59.png?v=135","res/Themes/DayMaps/BG5_1_60.plist?v=135","res/Themes/DayMaps/BG5_1_60.png?v=135","res/Themes/DayMaps/BG5_1_61.plist?v=135","res/Themes/DayMaps/BG5_1_61.png?v=135","res/Themes/DayMaps/BG5_2_58.plist?v=135","res/Themes/DayMaps/BG5_2_58.png?v=135","res/Themes/DayMaps/BG6_1_26.plist?v=135","res/Themes/DayMaps/BG6_1_26.png?v=135","res/Themes/DayMaps/BG6_1_27.plist?v=135","res/Themes/DayMaps/BG6_1_27.png?v=135","res/Themes/DayMaps/BG6_1_28.plist?v=135","res/Themes/DayMaps/BG6_1_28.png?v=135","res/Themes/DayMaps/BG6_1_29.plist?v=135","res/Themes/DayMaps/BG6_1_29.png?v=135","res/Themes/DayMaps/BG6_1_30.plist?v=135","res/Themes/DayMaps/BG6_1_30.png?v=135","res/Themes/DayMaps/BG6_1_64.plist?v=135","res/Themes/DayMaps/BG6_1_64.png?v=135","res/Themes/DayMaps/BG6_1_65.plist?v=135","res/Themes/DayMaps/BG6_1_65.png?v=135","res/Themes/DayMaps/BG6_2_62.plist?v=135","res/Themes/DayMaps/BG6_2_62.png?v=135","res/Themes/DayMaps/BG6_2_63.plist?v=135","res/Themes/DayMaps/BG6_2_63.png?v=135","res/Themes/DayMaps/BG7_1_31.plist?v=135","res/Themes/DayMaps/BG7_1_31.png?v=135","res/Themes/DayMaps/BG7_1_32.plist?v=135","res/Themes/DayMaps/BG7_1_32.png?v=135","res/Themes/DayMaps/BG7_1_33.plist?v=135","res/Themes/DayMaps/BG7_1_33.png?v=135","res/Themes/DayMaps/BG7_1_34.plist?v=135","res/Themes/DayMaps/BG7_1_34.png?v=135","res/Themes/DayMaps/BG7_1_35.plist?v=135","res/Themes/DayMaps/BG7_1_35.png?v=135","res/Themes/DayMaps/BG7_1_66.plist?v=135","res/Themes/DayMaps/BG7_1_66.png?v=135","res/Themes/DayMaps/BG7_1_67.plist?v=135","res/Themes/DayMaps/BG7_1_67.png?v=135","res/Themes/DayMaps/BG7_1_68.plist?v=135","res/Themes/DayMaps/BG7_1_68.png?v=135","res/Themes/DayMaps/BG8_1_36.plist?v=135","res/Themes/DayMaps/BG8_1_36.png?v=135","res/Themes/DayMaps/BG8_1_37.plist?v=135","res/Themes/DayMaps/BG8_1_37.png?v=135","res/Themes/DayMaps/BG8_1_38.plist?v=135","res/Themes/DayMaps/BG8_1_38.png?v=135","res/Themes/DayMaps/BG8_1_39.plist?v=135","res/Themes/DayMaps/BG8_1_39.png?v=135","res/Themes/DayMaps/BG8_1_40.plist?v=135","res/Themes/DayMaps/BG8_1_40.png?v=135","res/Themes/DayMaps/BG8_1_69.plist?v=135","res/Themes/DayMaps/BG8_1_69.png?v=135","res/Themes/DayMaps/BG8_1_70.plist?v=135","res/Themes/DayMaps/BG8_1_70.png?v=135","res/Themes/DayMaps/BG8_1_71.plist?v=135","res/Themes/DayMaps/BG8_1_71.png?v=135","res/Themes/DayMaps/BG8_2_72.plist?v=135","res/Themes/DayMaps/BG8_2_72.png?v=135","res/Themes/DayMaps/BG9_1_41.plist?v=135","res/Themes/DayMaps/BG9_1_41.png?v=135","res/Themes/DayMaps/BG9_1_42.plist?v=135","res/Themes/DayMaps/BG9_1_42.png?v=135","res/Themes/DayMaps/BG9_1_43.plist?v=135","res/Themes/DayMaps/BG9_1_43.png?v=135","res/Themes/DayMaps/BG9_1_45.plist?v=135","res/Themes/DayMaps/BG9_1_45.png?v=135","res/Themes/DayMaps/BG9_1_73.plist?v=135","res/Themes/DayMaps/BG9_1_73.png?v=135","res/Themes/DayMaps/BG9_1_74.plist?v=135","res/Themes/DayMaps/BG9_1_74.png?v=135","res/Themes/DayMaps/BG9_2_44.plist?v=135","res/Themes/DayMaps/BG9_2_44.png?v=135","res/Themes/DayMaps/BG9_2_75.plist?v=135","res/Themes/DayMaps/BG9_2_75.png?v=135","res/Themes/Items/BossItems-hd.png?v=135","res/Themes/Items/Common01-hd.plist?v=135","res/Themes/Items/Common01-hd.png?v=135","res/Themes/Items/Common_loading_bg-hd.png?v=135","res/Themes/Items/Common_shine_bg-hd.png?v=135","res/Themes/Items/Common_woodbg-hd.png?v=135","res/Themes/Items/FTMonsters-hd.png?v=135","res/Themes/Items/GateItems-hd.png?v=135","res/Themes/Items/GiftBall-hd.plist?v=135","res/Themes/Items/GiftBall-hd.png?v=135","res/Themes/Items/Items00-hd.png?v=135","res/Themes/Items/Items01-hd.png?v=135","res/Themes/Items/Items02-hd.plist?v=135","res/Themes/Items/Items02-hd.png?v=135","res/Themes/Items/Items03-hd.png?v=135","res/Themes/Items/Items04-hd.png?v=135","res/Themes/Items/Items07-hd.png?v=135","res/Themes/Items/Items08-hd.png?v=135","res/Themes/Items/ModeTour-hd.png?v=135","res/Themes/Items/NewProp-hd.png?v=135","res/Themes/Items/PropMagic-hd.png?v=135","res/Themes/Items/SpringAct.png?v=135","res/Themes/Items/num_images.plist?v=135","res/Themes/Items/num_images.png?v=135","res/Themes/Items/pingfen-hd.png?v=135","res/Themes/LevelSelect/Floor_cloud_1-hd.png?v=135","res/Themes/LevelSelect/Floor_cloud_2_1-hd.png?v=135","res/Themes/LevelSelect/Floor_cloud_3-hd.png?v=135","res/Themes/LevelSelect/Floor_cloud_4_1-hd.png?v=135","res/Themes/LevelSelect/Floor_cloud_5-hd.png?v=135","res/Themes/LevelSelect/LevelSel01-hd.plist?v=135","res/Themes/LevelSelect/LevelSel01-hd.png?v=135","res/Themes/LevelSelect/LevelSel01_part1.plist?v=135","res/Themes/LevelSelect/LevelSel01_part1.png?v=135","res/Themes/LevelSelect/LevelSel02-hd.png?v=135","res/Themes/LevelSelect/LevelSel03-hd.png?v=135","res/Themes/LevelSelect/LevelSel04-hd.png?v=135","res/Themes/LevelSelect/Roulette-hd.png?v=135","res/Themes/LevelSelect/StoneToProp-hd.png?v=135","res/Themes/LevelSelect/Storey1-hd.png?v=135","res/Themes/LevelSelect/Storey2-hd.png?v=135","res/Themes/LevelSelect/Storey3-hd.png?v=135","res/Themes/LevelSelect/StoreyChart-hd.plist?v=135","res/Themes/LevelSelect/StoreyChart-hd.png?v=135","res/Themes/LevelSelect/Storey_Common-hd.plist?v=135","res/Themes/LevelSelect/Storey_Common-hd.png?v=135","res/Themes/LevelSelect/basemap1-hd.png?v=135","res/Themes/LevelSelect/basemap2-hd.png?v=135","res/Themes/LevelSelect/basemap_part1.png?v=135","res/Themes/LevelSelect/cloud-hd.png?v=135","res/Themes/LevelSelect/cloud_part1.png?v=135","res/Themes/LevelSelect/discount-hd.png?v=135","res/Themes/LevelSelect/lifeReques.png?v=135","res/Themes/LevelSelect/routemap1-hd.png?v=135","res/Themes/LevelSelect/routemap_part1.png?v=135","res/Themes/LevelSelect/shop_carrot.png?v=135","res/Themes/Maps/BG01-hd.png?v=135","res/Themes/Maps/BG02-hd.png?v=135","res/Themes/Maps/BG03-hd.png?v=135","res/Themes/Maps/BG04-hd.png?v=135","res/Themes/Maps/BG05-hd.png?v=135","res/Themes/Maps/BG06-hd.png?v=135","res/Themes/Maps/BG07-hd.png?v=135","res/Themes/Maps/BG08-hd.png?v=135","res/Themes/Maps/BG09-hd.png?v=135","res/Themes/Maps/BG10-hd.png?v=135","res/Themes/Maps/BG100-hd.png?v=135","res/Themes/Maps/BG101-hd.png?v=135","res/Themes/Maps/BG102-hd.png?v=135","res/Themes/Maps/BG103-hd.png?v=135","res/Themes/Maps/BG104-hd.png?v=135","res/Themes/Maps/BG105-hd.png?v=135","res/Themes/Maps/BG106-hd.png?v=135","res/Themes/Maps/BG107-hd.png?v=135","res/Themes/Maps/BG108-hd.png?v=135","res/Themes/Maps/BG109-hd.png?v=135","res/Themes/Maps/BG11-hd.png?v=135","res/Themes/Maps/BG110-hd.png?v=135","res/Themes/Maps/BG111-hd.png?v=135","res/Themes/Maps/BG112-hd.png?v=135","res/Themes/Maps/BG113-hd.png?v=135","res/Themes/Maps/BG114-hd.png?v=135","res/Themes/Maps/BG115-hd.png?v=135","res/Themes/Maps/BG116-hd.png?v=135","res/Themes/Maps/BG117-hd.png?v=135","res/Themes/Maps/BG118-hd.png?v=135","res/Themes/Maps/BG119-hd.png?v=135","res/Themes/Maps/BG12-hd.png?v=135","res/Themes/Maps/BG120-hd.png?v=135","res/Themes/Maps/BG121-hd.png?v=135","res/Themes/Maps/BG122-hd.png?v=135","res/Themes/Maps/BG123-hd.png?v=135","res/Themes/Maps/BG124-hd.png?v=135","res/Themes/Maps/BG125-hd.png?v=135","res/Themes/Maps/BG126-hd.png?v=135","res/Themes/Maps/BG127-hd.png?v=135","res/Themes/Maps/BG128-hd.png?v=135","res/Themes/Maps/BG129-hd.png?v=135","res/Themes/Maps/BG13-hd.png?v=135","res/Themes/Maps/BG130-hd.png?v=135","res/Themes/Maps/BG131-hd.png?v=135","res/Themes/Maps/BG132-hd.png?v=135","res/Themes/Maps/BG133-hd.png?v=135","res/Themes/Maps/BG134-hd.png?v=135","res/Themes/Maps/BG135-hd.png?v=135","res/Themes/Maps/BG136-hd.png?v=135","res/Themes/Maps/BG137-hd.png?v=135","res/Themes/Maps/BG138-hd.png?v=135","res/Themes/Maps/BG139-hd.png?v=135","res/Themes/Maps/BG14-hd.png?v=135","res/Themes/Maps/BG140-hd.png?v=135","res/Themes/Maps/BG141-hd.png?v=135","res/Themes/Maps/BG142-hd.png?v=135","res/Themes/Maps/BG143-hd.png?v=135","res/Themes/Maps/BG144-hd.png?v=135","res/Themes/Maps/BG145-hd.png?v=135","res/Themes/Maps/BG146-hd.png?v=135","res/Themes/Maps/BG147-hd.png?v=135","res/Themes/Maps/BG148-hd.png?v=135","res/Themes/Maps/BG149-hd.png?v=135","res/Themes/Maps/BG15-hd.png?v=135","res/Themes/Maps/BG150-hd.png?v=135","res/Themes/Maps/BG151-hd.png?v=135","res/Themes/Maps/BG152-hd.png?v=135","res/Themes/Maps/BG153-hd.png?v=135","res/Themes/Maps/BG154-hd.png?v=135","res/Themes/Maps/BG155-hd.png?v=135","res/Themes/Maps/BG156-hd.png?v=135","res/Themes/Maps/BG157-hd.png?v=135","res/Themes/Maps/BG158-hd.png?v=135","res/Themes/Maps/BG159-hd.png?v=135","res/Themes/Maps/BG16-hd.png?v=135","res/Themes/Maps/BG160-hd.png?v=135","res/Themes/Maps/BG161-hd.png?v=135","res/Themes/Maps/BG162-hd.png?v=135","res/Themes/Maps/BG163-hd.png?v=135","res/Themes/Maps/BG164-hd.png?v=135","res/Themes/Maps/BG165-hd.png?v=135","res/Themes/Maps/BG166-hd.png?v=135","res/Themes/Maps/BG167-hd.png?v=135","res/Themes/Maps/BG168-hd.png?v=135","res/Themes/Maps/BG169-hd.png?v=135","res/Themes/Maps/BG17-hd.png?v=135","res/Themes/Maps/BG170-hd.png?v=135","res/Themes/Maps/BG18-hd.png?v=135","res/Themes/Maps/BG19-hd.png?v=135","res/Themes/Maps/BG20-hd.png?v=135","res/Themes/Maps/BG21-hd.png?v=135","res/Themes/Maps/BG22-hd.png?v=135","res/Themes/Maps/BG23-hd.png?v=135","res/Themes/Maps/BG24-hd.png?v=135","res/Themes/Maps/BG25-hd.png?v=135","res/Themes/Maps/BG26-hd.png?v=135","res/Themes/Maps/BG27-hd.png?v=135","res/Themes/Maps/BG28-hd.png?v=135","res/Themes/Maps/BG29-hd.png?v=135","res/Themes/Maps/BG30-hd.png?v=135","res/Themes/Maps/BG31-hd.png?v=135","res/Themes/Maps/BG32-hd.png?v=135","res/Themes/Maps/BG33-hd.png?v=135","res/Themes/Maps/BG34-hd.png?v=135","res/Themes/Maps/BG35-hd.png?v=135","res/Themes/Maps/BG36-hd.png?v=135","res/Themes/Maps/BG37-hd.png?v=135","res/Themes/Maps/BG38-hd.png?v=135","res/Themes/Maps/BG39-hd.png?v=135","res/Themes/Maps/BG40-hd.png?v=135","res/Themes/Maps/BG41-hd.png?v=135","res/Themes/Maps/BG42-hd.png?v=135","res/Themes/Maps/BG43-hd.png?v=135","res/Themes/Maps/BG44-hd.png?v=135","res/Themes/Maps/BG45-hd.png?v=135","res/Themes/Maps/BG46-hd.png?v=135","res/Themes/Maps/BG47-hd.png?v=135","res/Themes/Maps/BG48-hd.png?v=135","res/Themes/Maps/BG49-hd.png?v=135","res/Themes/Maps/BG50-hd.png?v=135","res/Themes/Maps/BG51-hd.png?v=135","res/Themes/Maps/BG52-hd.png?v=135","res/Themes/Maps/BG53-hd.png?v=135","res/Themes/Maps/BG54-hd.png?v=135","res/Themes/Maps/BG55-hd.png?v=135","res/Themes/Maps/BG56-hd.png?v=135","res/Themes/Maps/BG57-hd.png?v=135","res/Themes/Maps/BG58-hd.png?v=135","res/Themes/Maps/BG59-hd.png?v=135","res/Themes/Maps/BG60-hd.png?v=135","res/Themes/Maps/BG61-hd.png?v=135","res/Themes/Maps/BG62-hd.png?v=135","res/Themes/Maps/BG63-hd.png?v=135","res/Themes/Maps/BG64-hd.png?v=135","res/Themes/Maps/BG65-hd.png?v=135","res/Themes/Maps/BG66-hd.png?v=135","res/Themes/Maps/BG67-hd.png?v=135","res/Themes/Maps/BG68-hd.png?v=135","res/Themes/Maps/BG69-hd.png?v=135","res/Themes/Maps/BG70-hd.png?v=135","res/Themes/Maps/BG71-hd.png?v=135","res/Themes/Maps/BG72-hd.png?v=135","res/Themes/Maps/BG73-hd.png?v=135","res/Themes/Maps/BG74-hd.png?v=135","res/Themes/Maps/BG75-hd.png?v=135","res/Themes/Maps/BG76-hd.png?v=135","res/Themes/Maps/BG77-hd.png?v=135","res/Themes/Maps/BG78-hd.png?v=135","res/Themes/Maps/BG79-hd.png?v=135","res/Themes/Maps/BG80-hd.png?v=135","res/Themes/Maps/BG81-hd.png?v=135","res/Themes/Maps/BG82-hd.png?v=135","res/Themes/Maps/BG83-hd.png?v=135","res/Themes/Maps/BG84-hd.png?v=135","res/Themes/Maps/BG85-hd.png?v=135","res/Themes/Maps/BG86-hd.png?v=135","res/Themes/Maps/BG87-hd.png?v=135","res/Themes/Maps/BG88-hd.png?v=135","res/Themes/Maps/BG89-hd.png?v=135","res/Themes/Maps/BG90-hd.png?v=135","res/Themes/Maps/BG91-hd.png?v=135","res/Themes/Maps/BG92-hd.png?v=135","res/Themes/Maps/BG93-hd.png?v=135","res/Themes/Maps/BG94-hd.png?v=135","res/Themes/Maps/BG95-hd.png?v=135","res/Themes/Maps/BG96-hd.png?v=135","res/Themes/Maps/BG97-hd.png?v=135","res/Themes/Maps/BG98-hd.png?v=135","res/Themes/Maps/BG99-hd.png?v=135","res/Themes/Theme1/BG-hd.png?v=135","res/Themes/Theme1/Monsters-hd.png?v=135","res/Themes/Theme1/Objects-hd.png?v=135","res/Themes/Theme2/BG-hd.png?v=135","res/Themes/Theme2/GateBoss-hd.png?v=135","res/Themes/Theme2/Monsters-hd.png?v=135","res/Themes/Theme2/Objects-hd.png?v=135","res/Themes/Theme3/BG-hd.png?v=135","res/Themes/Theme3/GateBoss-hd.png?v=135","res/Themes/Theme3/Monsters-hd.png?v=135","res/Themes/Theme3/Objects-hd.png?v=135","res/Themes/Theme4/BG-hd.png?v=135","res/Themes/Theme4/GateBoss-hd.png?v=135","res/Themes/Theme4/Monsters-hd.png?v=135","res/Themes/Theme4/Objects-hd.png?v=135","res/Themes/Theme5/BG-hd.png?v=135","res/Themes/Theme5/GateBoss-hd.png?v=135","res/Themes/Theme5/Monsters-hd.png?v=135","res/Themes/Theme5/Objects-hd.png?v=135","res/Themes/Theme6/BG-hd.png?v=135","res/Themes/Theme6/GateBoss-hd.png?v=135","res/Themes/Theme6/Monsters-hd.png?v=135","res/Themes/Theme6/Objects-hd.png?v=135","res/Themes/Theme7/BG-hd.plist?v=135","res/Themes/Theme7/BG-hd.png?v=135","res/Themes/Theme7/GateBoss-hd.plist?v=135","res/Themes/Theme7/GateBoss-hd.png?v=135","res/Themes/Theme7/Monsters-hd.plist?v=135","res/Themes/Theme7/Monsters-hd.png?v=135","res/Themes/Theme7/Objects-hd.plist?v=135","res/Themes/Theme7/Objects-hd.png?v=135","res/Themes/Theme8/BG-hd.plist?v=135","res/Themes/Theme8/BG-hd.png?v=135","res/Themes/Theme8/GateBoss-hd.plist?v=135","res/Themes/Theme8/GateBoss-hd.png?v=135","res/Themes/Theme8/Monsters-hd.plist?v=135","res/Themes/Theme8/Monsters-hd.png?v=135","res/Themes/Theme8/Objects-hd.plist?v=135","res/Themes/Theme8/Objects-hd.png?v=135","res/Themes/Theme9/BG-hd.plist?v=135","res/Themes/Theme9/BG-hd.png?v=135","res/Themes/Theme9/GateBoss-hd.plist?v=135","res/Themes/Theme9/GateBoss-hd.png?v=135","res/Themes/Theme9/Monsters-hd.plist?v=135","res/Themes/Theme9/Monsters-hd.png?v=135","res/Themes/Theme9/Objects-hd.plist?v=135","res/Themes/Theme9/Objects-hd.png?v=135","res/Themes/Towers/CRocket-hd.png?v=135","res/Themes/Towers/CSnow-hd.png?v=135","res/Themes/Towers/TAnchor-hd.png?v=135","res/Themes/Towers/TArrow-hd.png?v=135","res/Themes/Towers/TBall-hd.png?v=135","res/Themes/Towers/TBlueStar-hd.png?v=135","res/Themes/Towers/TBoomerang-hd.png?v=135","res/Themes/Towers/TBottle-hd.png?v=135","res/Themes/Towers/TCuttle-hd.png?v=135","res/Themes/Towers/TFireBottle-hd.png?v=135","res/Themes/Towers/TFish-hd.png?v=135","res/Themes/Towers/TFlashLight-hd.png?v=135","res/Themes/Towers/TIceFan-hd.png?v=135","res/Themes/Towers/TMagnet-hd.png?v=135","res/Themes/Towers/TMoon-hd.png?v=135","res/Themes/Towers/TPin-hd.png?v=135","res/Themes/Towers/TPlane-hd.png?v=135","res/Themes/Towers/TRandom-hd.png?v=135","res/Themes/Towers/TRocket-hd.png?v=135","res/Themes/Towers/TShit-hd.png?v=135","res/Themes/Towers/TSnow-hd.png?v=135","res/Themes/Towers/TStar-hd.png?v=135","res/Themes/Towers/TSun-hd.png?v=135","res/Themes/scene/FloorReborn.png?v=135","res/Themes/scene/WeiboComic-hd.png?v=135","res/Themes/scene/cdkey-hd.png?v=135","res/Themes/scene/everyDayChallenge-hd.plist?v=135","res/Themes/scene/everyDayChallenge-hd.png?v=135","res/Themes/scene/gameover_lose.png?v=135","res/Themes/scene/gameover_win.png?v=135","res/Themes/scene/help-hd.plist?v=135","res/Themes/scene/help-hd.png?v=135","res/Themes/scene/help1-hd.plist?v=135","res/Themes/scene/help1-hd.png?v=135","res/Themes/scene/nfront_abo_lim.png?v=135","res/Themes/scene/setting-hd.png?v=135","res/Themes_cn/Items/Common01-hd_cn.plist?v=135","res/Themes_cn/Items/Common01-hd_cn.png?v=135","res/Themes_cn/Items/FTMonsters-hd.png?v=135","res/Themes_cn/Items/GiftBall-hd_cn.plist?v=135","res/Themes_cn/Items/GiftBall-hd_cn.png?v=135","res/Themes_cn/Items/Items02-hd_cn.plist?v=135","res/Themes_cn/Items/Items02-hd_cn.png?v=135","res/Themes_cn/Items/Items03-hd_cn.png?v=135","res/Themes_cn/Items/Items04-hd_cn.png?v=135","res/Themes_cn/Items/ModeTour-hd_cn.png?v=135","res/Themes_cn/Items/NewProp-hd_cn.png?v=135","res/Themes_cn/Items/pingfen-hd_cn.png?v=135","res/Themes_cn/LevelSelect/AwardBG_cn.png?v=135","res/Themes_cn/LevelSelect/LevelSel01-hd_cn.plist?v=135","res/Themes_cn/LevelSelect/LevelSel01-hd_cn.png?v=135","res/Themes_cn/LevelSelect/LevelSel02-hd_cn.plist?v=135","res/Themes_cn/LevelSelect/LevelSel02-hd_cn.png?v=135","res/Themes_cn/LevelSelect/LevelSel03-hd.png?v=135","res/Themes_cn/LevelSelect/LevelSel04-hd.png?v=135","res/Themes_cn/LevelSelect/Roulette-hd_cn.png?v=135","res/Themes_cn/LevelSelect/Shop02-hd_cn.png?v=135","res/Themes_cn/LevelSelect/Storey1-hd_cn.plist?v=135","res/Themes_cn/LevelSelect/Storey1-hd_cn.png?v=135","res/Themes_cn/LevelSelect/Storey2-hd_cn.plist?v=135","res/Themes_cn/LevelSelect/Storey2-hd_cn.png?v=135","res/Themes_cn/LevelSelect/StoreyChart-hd_cn.plist?v=135","res/Themes_cn/LevelSelect/StoreyChart-hd_cn.png?v=135","res/Themes_cn/LevelSelect/Storey_Common-hd_cn.plist?v=135","res/Themes_cn/LevelSelect/Storey_Common-hd_cn.png?v=135","res/Themes_cn/LevelSelect/discount-hd_cn.png?v=135","res/Themes_cn/scene/FloorReborn_cn.png?v=135","res/Themes_cn/scene/FloorShare_cn.png?v=135","res/Themes_cn/scene/WeiboComic-hd_cn.png?v=135","res/Themes_cn/scene/cdkey-hd_cn.png?v=135","res/Themes_cn/scene/everyDayChallenge-hd_cn.plist?v=135","res/Themes_cn/scene/everyDayChallenge-hd_cn.png?v=135","res/Themes_cn/scene/gameover01_cn.plist?v=135","res/Themes_cn/scene/gameover01_cn.png?v=135","res/Themes_cn/scene/gameover_lose_cn.png?v=135","res/Themes_cn/scene/gameover_win_cn.plist?v=135","res/Themes_cn/scene/gameover_win_cn.png?v=135","res/Themes_cn/scene/help-hd_cn.png?v=135","res/Themes_cn/scene/mainscene-hd_cn.plist?v=135","res/Themes_cn/scene/mainscene-hd_cn.png?v=135","res/Themes_cn/scene/modeunlock_cn.plist?v=135","res/Themes_cn/scene/modeunlock_cn.png?v=135","res/Themes_cn/scene/themelocked_cn.plist?v=135","res/Themes_cn/scene/themelocked_cn.png?v=135","res/loading.js?v=135","res/menu_restart.png?v=135"],Nt=[],Gt={},Wt=GamePlatform.getLanguage(),kt=[String.formatC("res/Themes%s/Items/Common01-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/Items/Common01-hd%s.plist",Wt,Wt),xt[296],xt[1557],xt[1575],xt[1574],xt[1554],xt[1553]],Ut=[xt[1575],xt[1574]],Ht=[String.formatC("res/Themes%s/scene/mainscene-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/scene/mainscene-hd%s.png",Wt,Wt)],Vt=["res/Themes_en/tencent/openAnimation.plist","res/Themes_en/tencent/openAnimation.png"],zt=["res/Themes_en/scene/share_0_en.jpg","res/Themes_en/scene/share_1_en.jpg","res/Themes_en/scene/share_2_en.jpg","res/Themes_en/scene/imagetxt_lb.png","res/Themes_en/FaceBook/fbUsersHead.png"],Yt=["res/Themes_en/FaceBook/rankingup_bg.jpg","res/Themes_en/FaceBook/rankingup_down.png","res/Themes_en/FaceBook/rankingup_number1.png","res/Themes_en/FaceBook/rankingup_fbNumber.png","res/Themes_en/FaceBook/rankingup_up.png"],Xt=[xt[350],xt[1598],xt[351],xt[1599],xt[353],xt[1601],xt[1582],xt[1583],xt[1368],xt[1586],String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.png",Wt,Wt),xt[358],xt[1605]],jt=[xt[352],xt[1600],xt[1384],xt[1606],xt[1584],xt[1585],xt[1368],xt[1586],String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.png",Wt,Wt)],Kt=[xt[1552],xt[293]];Gt.LevelSel=Xt,Gt.LevelSel_Part=jt;var qt=[xt[1817],xt[1818],xt[339],xt[1587],xt[1582],xt[1583],String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.png",Wt,Wt),xt[1368],xt[1586],String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.png",Wt,Wt)],Qt=[xt[307],String.formatC("res/Themes%s/Items/FTMonsters-hd.plist",Wt,Wt),String.formatC("res/Themes%s/Items/FTMonsters-hd.png",Wt,Wt),xt[299],xt[1562],xt[1564],xt[1565],String.formatC("res/Themes%s/Items/Items02-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/Items/Items02-hd%s.png",Wt,Wt)],Zt={};Zt[J.TBOTTLE]=[xt[1832],xt[958]],Zt[J.TSHIT]=[xt[1844],xt[970]],Zt[J.TSTAR]=[xt[1846],xt[972]],Zt[J.TSUN]=[xt[1847],xt[973]],Zt[J.TBALL]=[xt[1829],xt[955]],Zt[J.TICEFAN]=[xt[1837],xt[963]],Zt[J.TMOON]=[xt[1839],xt[965]],Zt[J.TFLASHLIGHT]=[xt[1836],xt[962]],Zt[J.TARROW]=[xt[1828],xt[954]],Zt[J.TROCKET]=[xt[1843],xt[969]],Zt[J.TPLANE]=[xt[1841],xt[967]],Zt[J.TFISH]=[xt[1835],xt[961]],Zt[J.TANCHOR]=[xt[1827],xt[953]],Zt[J.TCUTTLE]=[xt[1833],xt[959]],Zt[J.TMAGNET]=[xt[1838],xt[964]],Zt[J.TSNOW]=[xt[1845],xt[971]],Zt[J.TFIREBOTTLE]=[xt[1834],xt[960]],Zt[J.TBOOMERANG]=[xt[1831],xt[957]],Zt[J.TPIN]=[xt[1840],xt[966]],Zt[J.TBLUESTAR]=[xt[1830],xt[956]],Zt[J.TRANDOM]=[xt[1842],xt[968]];var Jt=[xt[1375],xt[1860]],$t=["res/Themes_en/scene/settingbg-hd_en.png","res/Themes_en/scene/settingbg-hd_en.plist","res/Themes_en/scene/setting-hd_en.png","res/Themes_en/scene/setting-hd_en.plist"],ei=[String.formatC("res/Themes%s/scene/help-hd.plist",GamePlatform.isCN()?"":"_en"),String.formatC("res/Themes%s/scene/help-hd.png",GamePlatform.isCN()?"":"_en"),xt[1567],xt[302]],ti=[String.formatC("res/Themes%s/scene/help1-hd.plist",GamePlatform.isCN()?"":"_en"),String.formatC("res/Themes%s/scene/help1-hd.png",GamePlatform.isCN()?"":"_en")],ii=[String.formatC("res/Themes%s/scene/help-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/scene/help-hd%s.png",Wt,Wt)],ni=[String.formatC("res/Themes%s/LevelSelect/shop-1.png",Wt),String.formatC("res/Themes%s/LevelSelect/shop-1.plist",Wt)],si=[String.formatC("res/Themes%s/LevelSelect/shop-3.plist",Wt),String.formatC("res/Themes%s/LevelSelect/shop-3.png",Wt),xt[1607],xt[1372]],ri=[String.formatC("res/Themes%s/LevelSelect/shopcommon.plist",Wt),String.formatC("res/Themes%s/LevelSelect/shopcommon.png",Wt)],ai=[xt[341],xt[1589],String.formatC("res/Themes%s/LevelSelect/Roulette-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/Roulette-hd%s.png",Wt,Wt)],oi=[xt[979],xt[980],xt[68]],hi=[String.formatC("res/Themes%s/scene/gameover01%s.plist",Wt,Wt),String.formatC("res/Themes%s/scene/gameover01%s.png",Wt,Wt)],li=[String.formatC("res/Themes%s/scene/gamefinal50%s.plist",Wt,Wt),String.formatC("res/Themes%s/scene/gamefinal50%s.png",Wt,Wt)],di=[xt[981],xt[1853],String.formatC("res/Themes%s/scene/gameover_lose%s.plist",Wt,Wt),String.formatC("res/Themes%s/scene/gameover_lose%s.png",Wt,Wt),xt[325],String.formatC("res/Themes%s/tencent/tencent_share.png",Wt),String.formatC("res/Themes%s/tencent/tencent_share.plist",Wt)],ci=[xt[1854],xt[982],String.formatC("res/Themes%s/scene/gameover_win%s.png",Wt,Wt),String.formatC("res/Themes%s/scene/gameover_win%s.plist",Wt,Wt),xt[325],String.formatC("res/Themes%s/tencent/tencent_share.png",Wt),String.formatC("res/Themes%s/tencent/tencent_share.plist",Wt)],ui=[String.formatC("res/Themes%s/tencent/bangkanjia.png",Wt),String.formatC("res/Themes%s/tencent/bangkanjia.plist",Wt)],pi=[String.formatC("res/Themes%s/tencent/ganxiexin.png",Wt),String.formatC("res/Themes%s/tencent/ganxiexin.plist",Wt)],mi=[String.formatC("res/Themes%s/tencent/activity_common.png",Wt),String.formatC("res/Themes%s/tencent/activity_common.plist",Wt),String.formatC("res/Themes%s/tencent/dengdaoni.png",Wt),String.formatC("res/Themes%s/tencent/dengdaoni.plist",Wt)];Gt.GameOverwin=ci,Gt.GameOverlose=di,Gt.MessShare=yi,Gt.GameFinal=oi;var _i=[String.formatC("res/Themes%s/LevelSelect/StoneToProp-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/StoneToProp-hd%s.png",Wt,Wt),xt[346],xt[1590]],gi=[String.formatC("res/Themes%s/LevelSelect/AwardBG%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/AwardBG%s.png",Wt,Wt),String.formatC("res/Themes%s/tencent/tencent_share.png",Wt),String.formatC("res/Themes%s/tencent/tencent_share.plist",Wt)],Ti=[String.formatC("res/Themes%s/LevelSelect/Shop02-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/Shop02-hd%s.png",Wt,Wt)],fi=[String.formatC("res/Themes%s/scene/themelocked%s.png",Wt,Wt),String.formatC("res/Themes%s/scene/themelocked%s.plist",Wt,Wt),String.formatC("res/Themes%s/tencent/buy_items.plist",Wt),String.formatC("res/Themes%s/tencent/buy_items.png",Wt),String.formatC("res/Themes%s/tencent/tencent_share.png",Wt),String.formatC("res/Themes%s/tencent/tencent_share.plist",Wt),xt[325]],Si=[String.formatC("res/Themes%s/scene/themelocked%s.png",Wt,Wt),String.formatC("res/Themes%s/scene/themelocked%s.plist",Wt,Wt)],wi=[String.formatC("res/Themes%s/scene/everyDayChallenge-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/scene/everyDayChallenge-hd%s.plist",Wt,Wt),xt[1852],xt[1851],String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.png",Wt,Wt)],vi=[xt[974],xt[1848],String.formatC("res/Themes%s/scene/FloorReborn%s.png",Wt,Wt),String.formatC("res/Themes%s/scene/FloorReborn%s.plist",Wt,Wt)],Li=[xt[1561],xt[1560],String.formatC("res/Themes%s/Items/GiftBall-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/Items/GiftBall-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/Items/GiftBallText-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/Items/GiftBallText-hd%s.plist",Wt,Wt)],Mi=[xt[1570],xt[305],String.formatC("res/Themes%s/Items/ModeTour-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/Items/ModeTour-hd%s.plist",Wt,Wt)],Ci=[xt[302],xt[1567],String.formatC("res/Themes%s/Items/Items04-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/Items/Items04-hd%s.png",Wt,Wt),xt[295],xt[1556]],yi=["res/Themes/Items/Mess_Comm.plist","res/Themes/Items/Mess_Comm.png",String.formatC("res/Themes%s/Items/Mess%s.plist",Wt,Wt),String.formatC("res/Themes%s/Items/Mess%s.png",Wt,Wt)],Bi=[xt[306],xt[1571],String.formatC("res/Themes%s/Items/NewProp-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/Items/NewProp-hd%s.png",Wt,Wt),xt[295],xt[1556]],Fi=[xt[1559],xt[298],String.formatC("res/Themes%s/Items/GateItems-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/Items/GateItems-hd%s.plist",Wt,Wt)],Ei=[xt[1596],xt[347],xt[348],String.formatC("res/Themes%s/LevelSelect/Storey_Common-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/Storey1-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/Storey2-hd%s.plist",Wt,Wt),xt[1597],xt[1591],xt[1592],String.formatC("res/Themes%s/LevelSelect/Storey_Common-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/Storey1-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/Storey2-hd%s.png",Wt,Wt)],Pi=[xt[349],xt[1593]],bi=[String.formatC("res/Themes%s/LevelSelect/StoreyChart-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/StoreyChart-hd%s.plist",Wt,Wt),xt[1594],xt[1595]],Ai=[xt[340],xt[1588],xt[1582],xt[1583],String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.png",Wt,Wt),xt[1368],xt[1586],String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/tencent/buy_items.plist",Wt),String.formatC("res/Themes%s/tencent/buy_items.png",Wt)],Oi=["res/Themes/Items/rank_change.plist","res/Themes/Items/rank_change.png"],Ii=[String.formatC("res/Themes%s/LevelSelect/discount-hd%s.png",Wt,Wt),String.formatC("res/Themes%s/LevelSelect/discount-hd%s.plist",Wt,Wt),xt[1603],xt[355]],Ri=[String.formatC("res/Themes%s/tencent/tencent_share.png",Wt),String.formatC("res/Themes%s/tencent/tencent_share.plist",Wt)],Di=[String.formatC("res/Themes%s/LevelSelect/lifeReques.png",GamePlatform.isCN()?"":"_en"),String.formatC("res/Themes%s/LevelSelect/lifeReques.plist",GamePlatform.isCN()?"":"_en")],xi=[String.formatC("res/Themes%s/LevelSelect/lifeless.plist",Wt),String.formatC("res/Themes%s/LevelSelect/lifeless.png",Wt)],Ni=[String.formatC("res/Themes%s/tencent/tencent_share.png",Wt),String.formatC("res/Themes%s/tencent/tencent_share.plist",Wt)],Gi=["res/Themes_cn/tencent/tencent_qun_share.png","res/Themes_cn/tencent/tencent_qun_share.plist"],Wi=[String.formatC("res/Themes%s/tencent/buy_items.plist",Wt),String.formatC("res/Themes%s/tencent/buy_items.png",Wt)],ki=[String.formatC("res/Themes%s/tencent/mailpanel.png",Wt),String.formatC("res/Themes%s/tencent/mailpanel.plist",Wt)],Ui=[String.formatC("res/Themes%s/tencent/shortcut_cn.plist",Wt),String.formatC("res/Themes%s/tencent/shortcut_cn.png",Wt)],Hi=[String.formatC("res/Themes%s/tencent/shot_reward.plist",Wt),String.formatC("res/Themes%s/tencent/shot_reward.png",Wt),xt[325]],Vi=[String.formatC("res/Themes%s/tencent/LoginRecord.png",Wt),String.formatC("res/Themes%s/tencent/LoginRecord.plist",Wt)],zi=[String.formatC("res/Themes%s/tencent/share_img.plist",Wt),String.formatC("res/Themes%s/tencent/share_img.png",Wt)],Yi=[String.formatC("res/Themes%s/tencent/stage_share.plist",Wt),String.formatC("res/Themes%s/tencent/stage_share.png",Wt)],Xi=[String.formatC("res/Themes%s/tencent/activity_common.plist",Wt),String.formatC("res/Themes%s/tencent/activity_common.png",Wt)],ji=[xt[977],xt[1849],String.formatC("res/Themes%s/scene/WeiboComic-hd%s.plist",Wt,Wt),String.formatC("res/Themes%s/scene/WeiboComic-hd%s.png",Wt,Wt)],Ki=function(e){var t=window.$flist;if(void 0===t)return e;var i=Ki._cache,n=i[e];if(n&&-1!==n)return t[n];if(void 0===n){var s,r=-1;for(var a in t)if(0===(s=t[a]).indexOf(e)&&"?"==s.charAt(e.length)){r=a,e=s;break}i[e]=r}return e};Ki._cache={};var qi=l.Layer.extend({mDefBg:null,spStarcounter:null,mMainScene:null,mSceneTarget:null,mDelayTick:null,mCurDelay:null,mScaleScene:null,nextSceneData:null,dataLoading:!1,resLoading:!0,resources:null,logo:null,ctor:function(e){l.addTimePoint("Loading_s"),this._super(),this.resources=e},Loading:function(){this.mMainScene=null,this.mDefBg=null,this.mSceneTarget=we.MAIN,this.mScaleScene=!0},onExit:function(){qu.clearOwner(this),this.removeAllChildrenWithCleanup(!0),this.logo&&this.mSceneTarget!==we.INVALIDE&&l.textureCache.removeTextureForKey(this.logo),this._super(),l.addTimePoint("Loading_e"),l.printTimePoint("Loading_s","Loading_e")},loadTargetSceneData:function(e,t){var i=this;e.call(Ql,t,function(n,s){if(n&&0!=n.code&&(s=n.msg),console.log("loadTargetSceneData callback"),s)return console.log("loadTargetSceneData failed!!!!"),void ju.Retry(s,function(){i.loadTargetSceneData(e,t)});i.nextSceneData=n,i.dataLoading=!1,i.netOk()}),this.dataLoading=!0},initWithLoadingScene:function(e,t){this.dataLoading=!1;var i=null,n=null,s=wr.getModel();switch(e){case we.LEVELSEL:i=Ql.entertheme;var r=s.usersData.loginFromMain;s.usersData.loginFromMain=!1,n={type:Le.NORMALMODE,mainenter:r}}i&&this.loadTargetSceneData(i,n),this.mSceneTarget=e,this.mMainScene=null;var a=.5,o=nr.share().getWinSize();nr.share().isIPad()&&(a=1);var h=new l.LabelTTF(String.format("Ver: {0}",l.game.version),"Arial",17);h.x=.5*this.width,h.anchorY=0,h.color=l.color(200,200,200,255),h.y=20,this.addChild(h,999);var d=new l.LayerColor;if(d.color=l.color(0,120,160,200),this.addChild(d),this.mDefBg=new l.Sprite("#loading_bg.png"),this.addChild(this.mDefBg),t){this.mDefBg.setPosition(.5*o.width,.5*o.height),this.mDefBg.setOpacity(0),this.mDefBg.setScale(2),this.mDelayTick=0,this.mCurDelay=0;for(var c=s.usersData.getGameStars(),u=l.spriteFrameCache.getSpriteFrame("loading_star.png"),p=l.spriteFrameCache.getSpriteFrame("loading_star_back.png"),m=387*a,_=380*a,g=m,T=0;T<5;T++){var f=new l.Sprite(p);if(f.setPosition(m,_),this.mDefBg.addChild(f),c>T){var S=new l.Sprite(u);S.setPosition(m,_),S.setScale(.5),this.mDefBg.addChild(S),g=m+81*a}m+=81*a}this.spStarcounter=new l.Sprite("#loading_star_counter.png"),this.mDefBg.addChild(this.spStarcounter),this.spStarcounter.setPosition(559*a,250*a),this.spStarcounter.setTag(898);var w=this.spStarcounter.getChildByTag(5878);if(null==w){w=new l.LabelAtlas(String.formatC("%02d",c+1),"num_white_18.png",18*a,30*a,"./0123456789");var v=l.p(115*a,36*a);c>99&&(w.setScale(.8),v=l.p(115*a,38*a)),w.setPosition(v),this.spStarcounter.addChild(w,0,11)}w.setVisible(!0),c>=5?this.spStarcounter.setVisible(!0):this.spStarcounter.setVisible(!1);var L=new l.Sprite(u);c>=5?L.setPosition(g-81*a,_):L.setPosition(g,_),L.setScale(.5),this.mDefBg.addChild(L),this.mDefBg.runAction(l.spawn(l.scaleTo(.2,1),l.fadeTo(.2,255)));var M=l.callFunc(this.lostLoadingUpdate.bind(this));L.runAction(l.sequence(l.delayTime(1),l.spawn(l.moveTo(.6,o.width/2,o.height/2),l.sequence(l.spawn(l.flipX(!0),l.scaleTo(.1,.15,1.5)),l.spawn(l.flipX(!1),l.scaleTo(.5,11.5)))),M,l.hide()))}else{this.mDefBg.setPosition(.5*o.width,.5*o.height),this.mDelayTick=4,this.mCurDelay=0;var C=null;(C=s.usersData.IsShowEnToCn()?new l.Sprite("#loading_text_whb.png"):new l.Sprite("#loading_text.png")).setPosition(nr.share().getMapOffset().width+468*a,375*a),this.addChild(C);var y=l.callFunc(this.lostLoadingUpdate.bind(this));this.runAction(l.sequence(l.delayTime(.2),y))}return this},lostLoadingStarcount:function(){var e=wr.getModel().usersData.getStarCount(),t=.5;nr.share().isIPad()&&(t=1),this.spStarcounter||(this.spStarcounter=new l.Sprite("#loading_star_counter.png"),this.mDefBg.addChild(this.spStarcounter),this.spStarcounter.setPosition(559*t,250*t),this.spStarcounter.setTag(798));var i=this.spStarcounter.getChildByTag(11);i&&this.spStarcounter.removeChild(i,!0);var n=this.spStarcounter.getChildByTag(5879);if(null==n){n=new l.LabelAtlas(String.formatC("%02d",e),"num_white_18.png",18*t,30*t,"./0123456789");var s=l.p(115*t,36*t);e>99&&(n.setScale(.8),s=l.p(115*t,38*t)),n.setPosition(s),this.spStarcounter.addChild(n,0,11)}n.setVisible(!0),e>=5?this.spStarcounter.setVisible(!0):this.spStarcounter.setVisible(!1)},lostLoadingUpdate:function(){this.scheduleUpdate()},initWithLoadingLogo:function(e){l.addTimePoint("LoadingLogo_s"),this.mDelayTick=0,this.mCurDelay=0,this.mSceneTarget=e,this.mMainScene=null;t=GamePlatform.isCN()?"玩命加载中......":"Loading......";if(e===we.INVALIDE)t=GamePlatform.isCN()?"正在登录......":"Login......";var t=b.NetWork_Hint14,i=nr.share().getWinSize();return this._label=new l.LabelTTF(t,"Arial",24),this._label.setPosition(.5*i.width,.5*i.height-40),this._label.setColor(l.color(180,180,180)),this.addChild(this._label,10),this.schedule(this.updateAp,0),this},updateAp:function(e){this.unschedule(this.updateAp),this.scheduleOnce(this.update,0)},netOk:function(){this.dataLoading||this.resLoading||this.Running()},update:function(e){var t=this;this.unscheduleAllCallbacks();var i=t.resources;qu.clearScene(),i&&i.length?qu.loadResAsync(i,function(){t.resLoading=!1,t.netOk()},function(e,i,n){if(t.mSceneTarget!==we.MAIN){var s=b.NetWork_Hint15;if(void 0==t._label){var r=nr.share().getWinSize();t._label=new l.LabelTTF(s+" 0%","Arial",24),t._label.setPosition(.5*r.width,.5*r.height-40),t._label.setColor(l.color(180,180,180)),t.addChild(t._label,10)}var a=n/i*100|0;a=Math.min(a,100),t._label.setString(s+a+"%")}else{var o=n/i*100|0;o=Math.min(o,100)}}):(this.resLoading=!1,this.netOk())},Running:function(){var e=wr.getModel();switch(e.bRestart,l.director.getScheduler().isWaite=!1,e.mCurSceneTarget=this.mSceneTarget,this.mSceneTarget){case we.MAIN:this.mMainScene=Hu.scene();break;case we.LEVELSEL:this.mMainScene=Yd.scene();break;case we.THEME:e.m_nGameMode==ge.HIGHERMODE?this.mMainScene=uc.scene(0):this.mMainScene=Yd.scene(),e.mCurSceneTarget=we.LEVELSEL;break;case we.THEMETEMPLE:e.m_nGameMode==ge.HIGHERMODE?this.mMainScene=uc.scene(0):this.mMainScene=Po.scene(),e.mCurSceneTarget=we.LEVELSEL;break;case we.GAME:e.initCurLevel();var t=new l.TMXTiledMap(e.getMapPath()),i=qu.readTowersResWithTMX(t);if(e.m_nGameMode==ge.CHALLENGEMODE){void 0==i&&(i=[]);var n=e.curMapConfig,s=e.gameObjectConfig;if(n&&s)for(var r in n.towerType){var a=parseInt(n.towerType[r]);if(a>=0){var o=s.towerGroup[a].strPicGroup;i.push(o),i.push(o.replace(".plist",".png"))}}}i.length?(this.mMainScene=null,qu.loadResAsync(i,function(){var e=Pc.scene(t);e.loadData(function(){qi.runScene(e)})})):this.mMainScene=Pc.scene(t),lp&&SDKInterface.logEvent&&SDKInterface.logEvent("startLevel",1,{mode:"default",level:e.curLevel});break;case we.HELP:this.mMainScene=Eh.scene();break;case we.RECOMMEND:break;case we.LEVELSELCIRCLE:e.m_nGameMode==ge.HIGHERMODE?this.mMainScene=uc.scene(0):this.mMainScene=Po.scene();break;case we.STOREY:this.mMainScene=uc.scene(0);break;case we.STOREY_L:this.mMainScene=uc.scene(2),e.mCurSceneTarget=we.STOREY;break;case we.STOREY_V:this.mMainScene=uc.scene(1),e.mCurSceneTarget=we.STOREY;break;case we.SETTING:this.mMainScene=Xo.scene(),e.mCurSceneTarget=we.SETTING;break;case we.MEETFRIEND:this.mMainScene=Cl.scene();break;default:l.log("Loading scene type is exist :",this.mSceneTarget)}if(this.mSceneTarget!=we.MAIN&&this.mSceneTarget!=we.LEVELSEL||e.setMessData(null),this.mMainScene){var h=this.mMainScene;if(void 0!=h.loadData)if(this._label,this.nextSceneData)h.loadData(this.nextSceneData),qi.runScene(h);else{h.loadData(function(){qi.runScene(h)})}else qi.runScene(h)}},LoadingFadeOutDone:function(e){this.removeChild(e,!0),qi.runScene(this.mMainScene)},addRestBtn:function(e){var t=GamePlatform.isCN()?"res/menu_restart.png":"res/menu_restart_en.png",i=new l.Sprite(t),n=this.getContentSize(),s=new l.MenuItemSprite(i,null,null,this,this.menuCallback.bind(this));s.setTag(111),s.setPosition(n.width-70,60);var r=new l.Menu(s);r.setPosition(0,0),r.setTag(112),e&&e.addChild(r,10001)},menuCallback:function(e){var t=e.getTag();switch(e.setEnabled(!1),t){case 111:var i=b.NetWork_Hint16;ju.showConfirm(i,function(t){e.setEnabled(!0),console.log(i+" id:"+t),t==sa&&l.game.refresh()})}}});qi.runScene=function(e){GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),l.director.runScene(e),Ku.changeScene(e),ju.changeScene(e)},qi.sceneWithLoadingLogo=function(e,t){var i=new l.Scene,n=new qi(e);n.initWithLoadingLogo(t),i.addChild(n),nr.share().scaleScene(i),GamePlatform.getCurrentPlatForm()!=PlatformType.QQ&&0!=window.isOnIOS||(l.view.setDesignResolutionSize(1136,640,l.ResolutionPolicy.EXACT_FIT),l.view.resizeWithBrowserSize(!0)),qi.runScene(i),n.addRestBtn(i)},qi.addResidentTextureCache=function(){},qi.preloadWithLoadingTag=function(e,t,i){var n=wr.getModel();t!=we.MAIN&&t!=we.LEVELSEL||n.setMessData(null);var s=new l.Scene;qi.addResidentTextureCache();var r=new qi(e);r.initWithLoadingScene(t,i),s.addChild(r),nr.share().scaleScene(s),qi.runScene(s),r.addRestBtn(s)},qi.preloadWithMessData=function(e){var t=(e=e||"0_0_0").split("_");if(t.length<3||isNaN(parseInt(t[2]))||isNaN(parseInt(t[2])))this.loadHomeScene();else{if(t[0]==l.playerInfo.id)return wr.getModel().setCurLevel(parseInt(t[1])),void this.preloadWithGameScene(!0,null);qi.sceneWithLoadingLogo([],we.WAIT),Ql.loadMess(t[0],t[1],t[2],function(e,i){if(e&&0==e.code){var n=e.msg.data;n=n.replace(/'/gi,'"');var s=JSON.parse(n);s.beginIndex=s.waves.length-1,s.canAwardTimes=e.msg.canawardnum,s.playerID=t[0],s.needStar=e.msg.coststar,s.playerName=e.msg.name,s.getAwardGem=function(e){void 0===e&&(e=this.beginIndex);var t=wr.getModel(),i=t.m_nGameMode===ge.HIGHERMODE?t.m_oHigher.getCurMapLevel():t.getCurConfig();if(t.bLoopPath||i.bPresentGate)return this.canAwardTimes>0?5:0;var n=this.waves[e],s=t.curMapConfig.nWaves;return this.canAwardTimes>0?Math.min(Math.ceil((n+1)/s*10),10):0};var r=e.msg.hadprops,a=wr.getModel();if(a.usersData.setWaitTime(e.msg.laststartime),r)for(var o=0;o<r.length;o++)a.usersData.setPropByPropid(o+1,r[o]);qi.preloadWithGameScene(!1,s)}else ju.alert(i||e.msg,function(){qi.loadHomeScene()})})}},qi.loadLevelSelScene=function(){var e=Yd.getUsedRes();qi.preloadWithLoadingTag(e,we.LEVELSEL,!1)},qi.loadHomeScene=function(){this.sceneWithLoadingLogo(Ht,we.MAIN)},qi.preloadWithGameScene=function(e,t){l.log("★★★Loading.preloadWithGameScene");var i=wr.getModel();t=t||null,i.setMessData(t),i.changeMapPath();var n=i.getMapPath(),s=i.getCurTheme(),r=[Ki(n)],a=i.usersData.m_nLanguage;i.m_nGameMode==ge.CHALLENGEMODE?(r.push(Ki(String.formatC("res/Themes/DayMaps/BG%s.plist",i.m_oChallenge.m_strMapName))),r.push(Ki(String.formatC("res/Themes/DayMaps/BG%s.png",i.m_oChallenge.m_strMapName))),s=i.m_oChallenge.getCurTheme()):(r.push(Ki(String.formatC("res/Themes/Maps/BG%02lu-hd.plist",i.curLevel))),r.push(Ki(String.formatC("res/Themes/Maps/BG%02lu-hd.png",i.curLevel))),r.push(Ki(String.formatC("res/Themes%s/Maps/BG%02lu-hd%s.plist",a,i.curLevel,a))),r.push(Ki(String.formatC("res/Themes%s/Maps/BG%02lu-hd%s.png",a,i.curLevel,a)))),r.push(Ki(String.formatC("res/Themes/Theme%d/BG-hd.plist",s))),r.push(Ki(String.formatC("res/Themes/Theme%d/BG-hd.png",s))),r.push(Ki(String.formatC("res/Themes/Theme%d/Monsters-hd.plist",s))),r.push(Ki(String.formatC("res/Themes/Theme%d/Monsters-hd.png",s))),r.push(Ki(String.formatC("res/Themes/Theme%d/Objects-hd.plist",s))),r.push(Ki(String.formatC("res/Themes/Theme%d/Objects-hd.png",s)));var o=function(e){var t="";switch(e){case ue.CARROT_FAT:t="res/Themes/Items/Items07-hd.plist";break;case ue.CARROT_GIRL:t="res/Themes/Towers/CSnow-hd.plist";break;case ue.CARROT_OLD:t="res/Themes/Towers/CRocket-hd.plist";break;default:t="res/Themes/Items/Items01-hd.plist"}return Ki(t)},h=o(i.usersData.getCarrotFigure());r.push(h),r.push(h.replace(".plist",".png")),i.m_nGameMode===ge.DOUBLECARROT&&(h=o(i.usersData.getSecondCarrotFigure()),r.push(h),r.push(h.replace(".plist",".png")));var d=i.m_nGameMode===ge.HIGHERMODE?i.m_oHigher.getCurMapLevel():i.getCurConfig();if(d){var c=i.gameObjectConfig;if(d.bPresentGate){if(r=r.concat(Fi),1!=s){var u=String.formatC(c.strGatePic,s);r.push(Ki(u)),r.push(Ki(u.replace(".plist",".png")))}}else d.nBossModeSecond&&(r=r.concat(Kt));if(i.m_nGameMode!=ge.CHALLENGEMODE){var p=[];if(d.towerType)for(var m in d.towerType){var _=parseInt(d.towerType[m]);if(_>=0){_===J.TRANDOM&&!0;var g=c.towerGroup[_].strPicGroup;p.push(g),p.push(g.replace(".plist",".png"))}}r=r.concat(p)}}if(!t){var T=i.usersData.m_nLanguage;i.usersData.openedLevel<=1&&1==i.curLevel?r=r.concat([Ki("res/Themes/Items/Items03-hd.plist"),Ki("res/Themes/Items/Items03-hd.png"),Ki(String.formatC("res/Themes%s/Items/Items03-hd%s.plist",T,T)),Ki(String.formatC("res/Themes%s/Items/Items03-hd%s.png",T,T))]):!GamePlatform.isCN()&&(i.usersData.openedLevel<=2&&2==i.curLevel||i.usersData.openedLevel<=3&&3==i.curLevel)&&(r=r.concat([Ki("res/Themes_en/tencent/guide_panel.plist"),Ki("res/Themes_en/tencent/guide_panel.png")])),GamePlatform.isCN()||1!=i.usersData.getOpenedLevel()||i.usersData.bOpenFirstTime||(r=r.concat(Vt))}if(t){t.beginIndex=t.waves.length-1;var f=t.towers||[];for(var S in f){var w=f[S];r=r.concat(Zt[w])}}qi.preloadWithLoadingTag(Qt.concat(r),we.GAME,e)},qi.preloadWithStoreyScene=function(e,t){var i=wr.getModel();i.m_oHigher.HigherEnter(),i.randomHighterNum=F()%3+1,i.changeMapPath();var n=i.getMapPath();l.log("Loading.....STOREY:...curLevel=%d.;curTheme=%d;...预加载的tileMap是 %s",i.curLevel,i.curTheme,n);var s=[];s.push(Ki(n));var r=i.usersData.m_nLanguage,a=String.formatC("res/Themes/Maps/BG%02lu-hd.plist",i.curLevel),o=String.formatC("res/Themes%s/Maps/BG%02lu-hd%s.plist",r,i.curLevel,r);s.push(Ki(a)),s.push(Ki(o)),a=String.formatC("res/Themes/Maps/BG%02lu-hd.png",i.curLevel),o=String.formatC("res/Themes%s/Maps/BG%02lu-hd%s.png",r,i.curLevel,r),s.push(Ki(a)),s.push(Ki(o)),i.curTheme&&i.curTheme<=9&&(a=String.formatC("res/Themes/Theme%lu/BG-hd.png",i.curTheme),o=String.formatC("res/Themes/Theme%lu/BG-hd.plist",i.curTheme),s.push(Ki(a)),s.push(Ki(o))),qi.preloadWithLoadingTag(Ei.concat(s),e,t)};var Qi=78,Zi=500,Ji=1e3,$i=200,en=200,tn={ItemPause:10,ItemPauseSel:11,PauseMenu:12,ItemSpeed:13,ItemSpeedSel:14,SpeedMenu:15,ItemShowMenu:16,ItemShowMenuSel:17,ShowMenu:18,ItemSkipGuid:19,SkipGuid:20,ItemNewTowerCard:21,NewTowerCard:22,NewModeTips:23,GIFTBALL_CLOSE1:24,GIFTBALL_CLOSE2:25,GIFTBALL_OK1:26,GIFTBALL_OK2:27},nn={TaskFinished:1,TaskComplete:2,TaskLose:3},sn={HPBAR_GATE:1,HPBAR_NORMALBOSS:2,HPBAR_FINALBOSS:3},rn=l.Layer.extend({bBeforeStart:0,bShowSelGroup:0,nGuidStep:0,rcMenuBG:null,_className:"GameHUD",curBuildPoint:l.p(0,0),selGroup:0,selDisableBuild:0,bossHPBG:null,bossHPNumStrech:0,bossRunTimeRight:0,bottomBar:null,topHPBarBG:null,topHPBarProgress:null,spShineBg:null,spCardBg:null,spBottombarShine:null,spGiftBox:null,spDragItem:null,lableMoney:0,lableWaves:0,lableCurWave:0,lableBossRuntime:0,dictBarCounterObjects:0,dictBarCounterObjectsBG:0,bCut:0,bSound:0,bGiftBoxDrop:!1,isGameWait:0,btnIsWaitState:!1,bLockGiftBallNoMoney:!1,bLockGiftBallClick:!0,bLockGiftBallClick1:!0,ptTouchStart:l.p(0,0),ptTouchEnd:l.p(0,0),wavept:0,speedpt:0,centpt:0,wavept2:0,nRandomSpriteID:0,nHPBarStyle:-1,nSlowPropLast:0,curDragDropIndex:0,fOldCurTopBarHpPer:1,strProp:null,curDropItem:0,m_rebornNum:0,m_nTestClick:0,m_lastTime:0,m_isShowVideoReborn:!1,m_curVideoRebornState:-1,listener:null,_spMission:null,_isClickSkip:!1,_isShowFirstAnimation:!1,_bAnimationOver:!1,_animLayer:null,_spComicStart:null,ctor:function(){this._super(),this.rcMenuBG=l.rect(0,0,0,0),this.dictBarCounterObjects={},this.dictBarCounterObjectsBG={},this.init()},init:function(){if(this._super()){var e=nr.share().getMapOffset(),t=wr.getModel(),i=nr.share().getWinSize(),n=t.gameLayer;if(t.bLockMenu=!0,this.rcMenuBG=l.rect(0,i.height-t.szTileRng.height,i.width,t.szTileRng.height),l.game.isDebug){var s=this.menuItemWithFile("btn_green_s.png","btn_green_s.png",99999,l.p(90,109),1.2);(b=new l.LabelTTF("立即结束","Arial",20)).setPosition(.5*s.width,.5*s.height),s.addChild(b,11);var r=new l.Menu(s);r.setPosition(0,0),t.animeLayer.addChild(r,sr.REBORN_Z)}var a=t.getObjectByType(J.MENUBG),o=l.spriteFrameCache.getSpriteFrame(a.strPic),h=null;o&&((h=new l.Sprite(o)).setAnchorPoint(0,1),h.setPosition(0+e.width,640),this.addChild(h,30,J.MENUBG)),a=t.getObjectByType(J.MENUCENTER);var d=String.formatC(a.strPic,1);if(o=l.spriteFrameCache.getSpriteFrame(d)){var c=new l.Sprite(o);c.setAnchorPoint(.5,1),c.setPosition(480+e.width,640),c.setVisible(!t.bLoopPath),this.addChild(c,31,J.MENUCENTER)}var u=(a=t.getObjectByType(J.SPEED)).szTile;u=l.size(2*u.width,2*u.height);var p=l.p(0,0),m=null;t.bLoopPath||(m=this.getMenuItemWithType(J.SPEED,a,p,1,1)),a=t.getObjectByType(J.PAUSE),p=l.p(p.x+u.width+20,0);var _=this.getMenuItemWithType(J.PAUSE,a,p,0);u=(a=t.getObjectByType(J.MENUBTN)).szTile,u=l.size(2*u.width,2*u.height),p=l.p(p.x+u.width+20,0);var g=this.getMenuItemWithType(J.MENUBTN,a,p,0),T=null;(T=t.bLoopPath?new l.Menu(_,g):new l.Menu(m,_,g)).setAnchorPoint(0,1),T.setPosition(636+e.width,640),this.addChild(T,32,J.MENUBTN);var f=(a=t.getObjectByType(J.WAVES)).szTile;if(f=l.size(2*f.width,2*f.height),this.lableMoney=new l.LabelAtlas("000000",a.strPic,f.width,f.height,"./0123456789"),this.lableMoney.setString(String.format("{0}",t.getAllMoney())),this.lableMoney.setAnchorPoint(0,1),this.lableMoney.setPosition(100+e.width,626),this.addChild(this.lableMoney,31,221),this.bBeforeStart=!1,t.nCountDownTime=-2,t.bLoopPath)return this.showTopHPBar(sn.HPBAR_NORMALBOSS),t.nCountDownTime=-t.curMapConfig.nBossModeSecond,this.showBottomBarItems(),!0;this.lableWaves=new l.LabelAtlas("00",a.strPic,f.width,f.height,"./0123456789"),this.lableWaves.setString(String.formatC("%02lu",t.curMapConfig.nWaves)),this.lableWaves.setAnchorPoint(0,1),this.lableWaves.setPosition(456+e.width,626),this.addChild(this.lableWaves,31,222),this.lableCurWave=new l.LabelAtlas("00",a.strPic,f.width,f.height,"./0123456789");var S=t.curWave<=t.curMapConfig.nWaves?t.curWave:t.curMapConfig.nWaves;this.lableCurWave.setString(String.formatC("%02d",S)),this.lableCurWave.setAnchorPoint(0,1),this.lableCurWave.setPosition(394+e.width,626),this.addChild(this.lableCurWave,31,223);var w;if(t.curMapConfig.bPresentGate)t.bKillGate=!1,t.bShowGateNotHitAnimate=!0,t.nEndlessBasicAddHP=0,this.showTopHPBar(sn.HPBAR_GATE);else{var v=new l.Sprite("waves_bg.png");v.setPosition(h.width/2,h.height/2),h.addChild(v),w=String.formatC(t.gameObjectConfig.objectGroup[J.MONSTERCOMEOUT].strPic,1),o=l.spriteFrameCache.getSpriteFrame(w);var L=new l.Sprite(o);if(L.setPosition(t.waypoints[0]),L.setAnchorPoint(.5,.3),t.gameLayer.addChild(L,sr.LPATHSTART),t.waypoints2.length>0){var M=new l.Sprite(o);M.setPosition(t.waypoints2[0]),M.setAnchorPoint(.5,.3),t.gameLayer.addChild(M,sr.LPATHSTART2)}}if(t.m_nGameMode==ge.DOUBLECARROT){if(o=l.spriteFrameCache.getSpriteFrame(t.gameObjectConfig.objectGroup[J.HOUSELIFE].strPic),(P=new l.Sprite(o)).setPosition(t.waypoints[t.waypoints.length-1]),t.gameLayer.addChild(P,sr.LHOUSELIFE,501),(b=new l.LabelAtlas("0","num_orange_14.png",14,24,"./0123456789")).setString(String.formatC("%ld",t.nCarrotHP)),b.setAnchorPoint(.5,.5),b.setPosition(34,29),P.addChild(b),n.houselife=b,w=String.formatC(t.gameObjectConfig.objectGroup[J.TOWERHOUSE].strPic,0,0),o=l.spriteFrameCache.getSpriteFrame(w),(A=new l.Sprite(o)).setPosition(l.pAdd(l.p(0,-40),t.waypoints[t.waypoints.length-2])),A.setAnchorPoint(.5,1),t.gameLayer.addChild(A,sr.LPATHYZ,502),(I=t.usersData.getCarrotFigure())==ue.CARROT_NORMAL||I==ue.CARROT_FAT){w=String.formatC(t.gameObjectConfig.objectGroup[J.TOWERHOUSE].strPic,I-ue.CARROT_NORMAL+1,I==ue.CARROT_NORMAL?10:61),o=l.spriteFrameCache.getSpriteFrame(w);R=new l.Sprite(o);n.house=R,R.setPosition(l.pAdd(A.getPosition(),l.p(0,.5*-A.height))),R.setAnchorPoint(.48,0),t.gameLayer.addChild(R,sr.LPATHEND,O.TOWERHOUSETAG),this.showCarrotAnimate(F()%3+1,1)}o=l.spriteFrameCache.getSpriteFrame(t.gameObjectConfig.objectGroup[J.HOUSELIFE].strPic);var C=new l.Sprite(o);C.setPosition(t.waypoints2[t.waypoints2.length-1]),t.gameLayer.addChild(C,sr.LHOUSELIFE,505);var y=new l.LabelAtlas("0","num_orange_14.png",14,24,"./0123456789");y.setString(String.formatC("%ld",t.nSecondCarrotHP)),y.setAnchorPoint(.5,.5),y.setPosition(34,29),C.addChild(y),n.m_secondHouseLife=y,w=String.formatC(t.gameObjectConfig.objectGroup[J.TOWERHOUSE].strPic,0,0),o=l.spriteFrameCache.getSpriteFrame(w);var B=new l.Sprite(o);B.setPosition(l.pAdd(l.p(0,-40),t.waypoints2[t.waypoints2.length-2])),B.setAnchorPoint(.5,1),t.gameLayer.addChild(B,sr.LPATHYZ,506);var E=t.usersData.getSecondCarrotFigure();if(E==ue.CARROT_FAT){w=String.formatC(t.gameObjectConfig.objectGroup[J.TOWERHOUSE].strPic,E-ue.CARROT_NORMAL+1,E==ue.CARROT_NORMAL?10:61),o=l.spriteFrameCache.getSpriteFrame(w);R=new l.Sprite(o);n.m_secondHouse=R,R.setPosition(l.pAdd(B.getPosition(),l.p(0,.5*-B.height))),R.setAnchorPoint(.48,0),t.gameLayer.addChild(R,sr.LPATHEND,O.SECONDTOWERHOUSETAG),this.showCarrotAnimate(F()%3+1,2)}}else{o=l.spriteFrameCache.getSpriteFrame(t.gameObjectConfig.objectGroup[J.HOUSELIFE].strPic);var P=new l.Sprite(o);P.setPosition(t.waypoints[t.waypoints.length-1]),t.gameLayer.addChild(P,sr.LHOUSELIFE,501);var b=new l.LabelAtlas("0","num_orange_14.png",14,24,"./0123456789");b.setString(String.formatC("%ld",t.m_nGameMode==ge.CHALLENGEMODE?t.nCarrotHP-7:t.nCarrotHP)),b.setAnchorPoint(.5,.5),b.setPosition(34,29),P.addChild(b),n.houselife=b,w=String.formatC(t.gameObjectConfig.objectGroup[J.TOWERHOUSE].strPic,0,0),o=l.spriteFrameCache.getSpriteFrame(w);var A=new l.Sprite(o);A.setPosition(l.pAdd(l.p(0,-40),t.waypoints[t.waypoints.length-2])),A.setAnchorPoint(.5,1),t.gameLayer.addChild(A,sr.LPATHYZ,502);var I=t.usersData.getCarrotFigure();if(I==ue.CARROT_NORMAL||I==ue.CARROT_FAT){w=String.formatC(t.gameObjectConfig.objectGroup[J.TOWERHOUSE].strPic,I-ue.CARROT_NORMAL+1,I==ue.CARROT_NORMAL?10:61),o=l.spriteFrameCache.getSpriteFrame(w);var R=new l.Sprite(o);n.house=R,R.setPosition(l.pAdd(A.getPosition(),l.p(0,.5*-A.height))),R.setAnchorPoint(.48,0),t.gameLayer.addChild(R,sr.LPATHEND,O.TOWERHOUSETAG),this.showCarrotAnimate(F()%3+1)}}return this.showBottomBarItems(),this._isShowFirstAnimation||t.isHasGuide()&&0==t.bRestart&&this.showGuide(),this.registerWithTouchDispatcher(!0),l.addTimePoint("start_battle_e"),l.printTimePoint("start_battle_s","start_battle_e"),!0}return!0},showGuide:function(){var e=wr.getModel(),t=nr.share().getMapOffset();this.hideTopAndBottomBar();n="";if(e.curShowPlayerGuid==re.PLAYEDGUIDE)var i=e.usersData.m_nLanguage,n=String.formatC("res/Themes%s/Items/Items03-hd%s.plist",i,i);else n="res/Themes_en/tencent/guide_panel.plist";qu.addRes(this,n),qu.addRes(this,String.formatC(e.gameObjectConfig.strItemsPic,3));var s=l.spriteFrameCache.getSpriteFrame(e.curShowPlayerGuid==re.PLAYEDGUIDE?"tour_bg.png":"bghowtoplay.png"),r=new l.Sprite(s);r.setPosition(728+t.width,310),e.animeLayer.addChild(r,sr.LGUIDITEM,2003),e.curShowPlayerGuid==re.FBPLAYEDGUIDE&&r.setPosition(200+t.width,310),e.curShowPlayerGuid==re.FBPLAYEDGUIDE1&&this.showBottomBarItems();var a=null;if(e.curShowPlayerGuid==re.PLAYEDGUIDE){for(var o=1;o<4;o++){if((a=new l.Sprite(l.spriteFrameCache.getSpriteFrame(String.formatC("tour_%d_no.png",o)))).setPosition(80,360),a.setVisible(!(o>1)),r.addChild(a,sr.LGUIDITEM,1e3*o+1),(a=new l.Sprite(l.spriteFrameCache.getSpriteFrame(String.formatC("tour_%d_pic.png",o)))).setPosition(214,280),a.setVisible(!(o>1)),r.addChild(a,sr.LGUIDITEM,1e3*o+2),1==o){var h=l.scaleTo(0,.1,.1),d=l.scaleTo(.1,1.2,1.2),c=l.scaleTo(.1,1,1);a.runAction(l.sequence(h,d,c))}var u=l.p(212,144);if((a=new l.Sprite(l.spriteFrameCache.getSpriteFrame(String.formatC("tour_%d_text.png",o)))).setPosition(u.x,o>1?u.y:u.y-500),a.setVisible(!(o>1)),r.addChild(a,sr.LGUIDITEM,1e3*o+3),1==o){var p=l.moveTo(.1,u.x,u.y-20),m=l.moveTo(.1,u.x,u.y);a.runAction(l.sequence(l.delayTime(.2),p,m))}}(a=new l.Sprite(l.spriteFrameCache.getSpriteFrame("tour_rightnow.png"))).setPosition(58,72),r.addChild(a,sr.LGUIDITEM,1004)}else{var _=l.spriteFrameCache.getSpriteFrame(e.curShowPlayerGuid==re.FBPLAYEDGUIDE?"coins.png":"gems.png");_&&((a=new l.Sprite(_)).setPosition(.5*r.width,280),r.addChild(a,sr.LGUIDITEM,1002)),(_=l.spriteFrameCache.getSpriteFrame(e.curShowPlayerGuid==re.FBPLAYEDGUIDE?"coinsreward.png":"gemsreward.png"))&&((a=new l.Sprite(_)).setPosition(.5*r.width,144),r.addChild(a,sr.LGUIDITEM,1003))}var g=e.buildspace[0],T=l.p(0,0);T=e.curShowPlayerGuid==re.PLAYEDGUIDE?l.pAdd(l.p(g.x,g.y),l.p(.5*g.width,.5*g.height)):e.curShowPlayerGuid==re.FBPLAYEDGUIDE?l.p(743,490):l.p(200,26),(a=new l.Sprite(l.spriteFrameCache.getSpriteFrame("tour_circle.png"))).setPosition(T),e.animeLayer.addChild(a,sr.LGUIDCIRCLE,1001),a.runAction(l.repeatForever(l.sequence(l.fadeTo(.6,80),l.fadeTo(.6,255)))),T=e.curShowPlayerGuid==re.PLAYEDGUIDE?l.pAdd(l.p(g.x,g.y),l.p(.2*g.width+30,g.height-30)):e.curShowPlayerGuid==re.FBPLAYEDGUIDE?l.p(743,520):l.p(160,10),a=new l.Sprite(l.spriteFrameCache.getSpriteFrame("tour_pointer.png"));var f=null;e.curShowPlayerGuid==re.FBPLAYEDGUIDE1?(a.setRotation(-90),f=l.moveBy(.6,30,30)):f=l.moveBy(.6,-30,30),a.setAnchorPoint(0,1),a.setPosition(T),e.animeLayer.addChild(a,sr.LWHALE,1002),a.runAction(l.repeatForever(l.sequence(f,f.reverse()))),this.nGuidStep=1;var S=new l.Sprite("tour_skip.png");this.skipMenu=new l.MenuItemSprite(S,null,null,this,this.changeMenuItemState.bind(this)),this.skipMenu.setPosition(342,e.curShowPlayerGuid==re.PLAYEDGUIDE?72:65),this.skipMenu.setTag(tn.SkipGuid);var w=new l.Menu(this.skipMenu);w.setPosition(0,0),r.addChild(w,1,224)},showNewAnimation:function(){var e=wr.getModel(),t=nr.share().getWinSize();e.usersData.bOpenFirstTime=!0,qu.addRes(this,"res/Themes_en/tencent/openAnimation.plist");var i=new l.Sprite("bg_blue.png");i.setAnchorPoint(.5,.5),i.setPosition(.5*t.width,.5*t.height),e.animeLayer.addChild(i,10004),this._animLayer=i,t=i.getContentSize();var n=new l.Sprite("screen1.png");n.setAnchorPoint(0,.5),n.setPosition(t.width,488),n.setVisible(!1),i.addChild(n,9,bu);var s=l.callFunc(this.PlayComicMusic.bind(this));n.runAction(l.sequence(l.show(),s,l.moveTo(.1,.5*t.width,488),l.moveTo(.1,.5*t.width+30,488)));var r=new l.Sprite("screen2.png");r.setAnchorPoint(1,.5),r.setPosition(0,488),i.addChild(r,9,Au),r.setVisible(!1),r.runAction(l.sequence(l.delayTime(1),l.show(),s,l.moveTo(.1,.5*t.width,488),l.moveTo(.1,.5*t.width-30,488)));var a=new l.Sprite("screen3.png");a.setScale(.2),a.setAnchorPoint(.5,1),a.setPosition(.5*t.width,0),i.addChild(a,9,Ou),a.setVisible(!1),a.runAction(l.sequence(l.delayTime(2),l.show(),l.spawn(l.moveTo(.1,.5*t.width,.5*t.height),l.scaleTo(.1,1.2)),l.scaleTo(.1,1)));var o=new l.Sprite("screen4.png");o.setAnchorPoint(.5,0),o.setPosition(.5*t.width,.2*t.height),o.setScale(.8),o.setOpacity(0),i.addChild(o,9,Iu),o.setVisible(!1),o.runAction(l.sequence(l.delayTime(3),l.show(),s,l.spawn(l.scaleTo(.4,1),l.fadeTo(.4,255)),l.delayTime(1),l.callFunc(function(){var e=l.spriteFrameCache.getSpriteFrame("screen5.png");e&&a.setSpriteFrame(e)})));var h=new l.Sprite("screen_start.png");h.setPosition(.82*t.width,91),i.addChild(h,9,Nu),h.setVisible(!1);var d=this,c=l.callFunc(function(){d._bAnimationOver=!0});h.runAction(l.sequence(l.delayTime(5),l.show(),c)),this._spComicStart=h},PlayComicMusic:function(){},showRebornLayer:function(){l.director.getScheduler().setTimeScale(1),l.director.getScheduler().isWaite=!0;var e=wr.getModel();if(e){var t=e.usersData.m_nLanguage;qu.addRes(this,"res/Themes/scene/FloorReborn.plist"),qu.addRes(this,String.formatC("res/Themes%s/scene/FloorReborn%s.plist",t,t));var i=e.m_nGameMode==ge.HIGHERMODE?e.m_oHigher.getDownCount():0,n=nr.share().getMapOffset(),s=nr.share().getWinSize(),r=new l.LayerColor(l.color(0,0,0,220),s.width,s.height);e.animeLayer.addChild(r,sr.REBORN_Z,2048);var a=new l.Sprite("floor_reborn_bg.png");a.setPosition(552+n.width,331),r.addChild(a,sr.REBORN_Z);var o=new l.Sprite(i&&e.m_nGameMode==ge.HIGHERMODE?"floor_reborn_drop.png":"floor_reborn_save.png");if(o.setPosition(520+n.width,239),r.addChild(o,sr.REBORN_Z),i){var h=String.formatC("floor_reborn_drop_%d.png",i),d=new l.Sprite(h);GamePlatform.isCN()?d.setPosition(520+n.width,239):d.setPosition(445+n.width,239),r.addChild(d,sr.REBORN_Z)}var c=null,u=null;c=this.menuItemWithFile("btn_green_b.png","btn_green_b_pressed.png",2050,l.p(520+n.width,179),1.2),u=this.createRebornPrice();var p=c.getContentSize();u.setPosition(.5*p.width,.5*p.height),c.addChild(u,sr.REBORN_Z);var m=new l.Menu(c,null);m.setPosition(0,0),r.addChild(m,sr.REBORN_Z);var _=new l.Sprite("floor_reborn_carrot.png");_.setPosition(291+n.width,340),r.addChild(_,sr.REBORN_Z);var g=l.delayTime(6.5),T=l.moveTo(.3,291+n.width,320),f=l.delayTime(.5),S=l.moveTo(.3,291+n.width,290),w=l.delayTime(.5),v=l.moveTo(.3,291+n.width,250),L=l.delayTime(.5),M=l.moveTo(.3,291+n.width,-300),C=l.sequence(g,T,f,S,w,v,L,M);C.setTag(-2),_.runAction(C);var y=new l.Sprite("floor_reborn_smoke.png");y.setPosition(282+n.width,199),y.setOpacity(0),r.addChild(y,sr.REBORN_Z);var B=l.delayTime(10.2),F=l.fadeIn(0),E=l.moveTo(.7,282+n.width,220),P=l.scaleTo(.7,1.2),b=l.fadeOut(.7),A=l.spawn(E,P,b),O=l.sequence(B,F,A);O.setTag(-5),y.runAction(O),this.m_rebornNum=9,this.showNumAnim()}},createRebornPrice:function(){var e=new l.Node;e.setAnchorPoint(l.p(.5,.5));var t=new l.Sprite("shop_gem.png");t.setAnchorPoint(l.p(0,.5)),e.addChild(t);var i=t.getContentSize(),n=new l.LabelAtlas("200","themelocked_buy1.png",20,28,"./0123456789");n.setAnchorPoint(l.p(0,.5)),e.addChild(n),i.width+=n.getContentSize().width;var s=new l.Sprite("floor_reborn_img.png");s.setAnchorPoint(l.p(0,.5)),e.addChild(s),i.width+=s.getContentSize().width+5,e.setContentSize(i),t.setPosition(l.p(0,.5*i.height)),n.setPosition(l.p(t.getContentSize().width+2,.5*i.height));var r=n.x+n.getContentSize().width+2;return s.setPosition(l.p(r,.5*i.height)),e},showGiftBall:function(){var e=wr.getModel(),t=nr.share().getWinSize(),i=nr.share().getMapOffset();this._packType=-1;var n=new l.LayerColor(l.color(0,0,0,178),t.width,t.height);e.animeLayer.addChild(n,sr.GIFTBALL_Z_START,1221),qu.addRes(this,"res/Themes/Items/GiftBall-hd.plist");var s=e.usersData.m_nLanguage,r=String.formatC("res/Themes%s/Items/GiftBall-hd%s.plist",s,s);qu.addRes(this,r);r=String.formatC("res/Themes%s/Items/GiftBallText-hd%s.plist",s,s);qu.addRes(this,r);var a=new l.Sprite("floor_gift_ball.png");a.setPosition(272+i.width,873),e.animeLayer.addChild(a,sr.GIFTBALL_Z_START+2,1222);var o=l.moveTo(.4,272+i.width,333),h=l.callFunc(this.showSecondGiftBall,this),d=l.callFunc(this.showGiftBallChild,this,a),c=l.callFunc(this.showGiftBallText,this,a),u=l.callFunc(this.showGiftBallClose,this,a),p=l.sequence(o,d,l.delayTime(.1),c,l.delayTime(.3),u,l.delayTime(.2),h);a.runAction(p)},showRebornAnim:function(e){var t=wr.getModel();t.isPlayMess()?t.gameLayer.showStoryWinOrLose(!1):(this.m_curVideoRebornState=e,this.m_isShowVideoReborn?this.showVideoReborn():this.showRebornLayer())},showVideoReborn:function(){var e=wr.getModel();this.m_isShowVideoReborn=!1,e.ys_FbyerReady&&e.usersData.canPlayAD(Pd.LOSE_VIDEO)?(e.lose_show=!0,l.director.getScheduler().isWaite=!0,e.gameCenter&&e.gameCenter.showFyberVideo()):e.lose_show=!1},endVideoRebornByState:function(){var e=wr.getModel();switch(this.m_curVideoRebornState){case 0:this.showRebornLayer();break;case 1:e.gameLayer.showStoryWinOrLose(!0);break;case 2:l.addTimePoint("gameover_s"),qu.loadResAsync(ci,function(){Xc.sceneWin(this.getParent())});e.creepsTask(J.UNKNOW,J.UNKNOW,0,t),this.clearTask();break;case 3:qi.preloadWithStoreyScene(we.STOREY,!1);break;case 4:e.playSoundWithType($.MTLOSEGAME),l.addTimePoint("gameover_s"),qu.loadResAsync(di,function(){Xc.sceneLose(this.getParent())});var t;e.creepsTask(J.UNKNOW,J.UNKNOW,0,t),this.clearTask()}},clearTask:function(){var e=wr.getModel().tasks;if(e)for(var t=e.length,i=0;i<t;i++){var n=e[i];n&&!n.isFinished()&&n.clearFinishCount()}},showNumAnim:function(){var e=wr.getModel();if(this.m_rebornNum<0||this.m_rebornNum>9)return this.spNum&&this.spNum.stopAllActions(),e.playMuiscWithType(0,2),void e.animeLayer.removeChildByTag(2048,!0);var t=nr.share().getMapOffset(),i=String.formatC("floor_reborn_%d.png",this.m_rebornNum);if(void 0==this.spNum){var n=e.animeLayer.getChildByTag(2048);this.spNum=new l.Sprite(i),this.spNum.setPosition(516+t.width,363),n.addChild(this.spNum,sr.REBORN_Z)}else{var s=l.spriteFrameCache.getSpriteFrame(i);s&&this.spNum.setSpriteFrame(s),this.spNum.runAction(l.fadeIn(.1))}if(e.playSoundWithFile("res/Music/Items/CountDown_reborn.mp3"),this.m_rebornNum>0){var r=l.scaleBy(0,.7),a=l.scaleTo(.8,1),o=l.scaleTo(.2,1.3),h=l.fadeOut(.2),d=l.spawn(o,h),c=l.callFunc(this.showNumAnim,this);(_=l.sequence(r,a,d,c)).setTag(-6),this.spNum.runAction(_)}else if(0==this.m_rebornNum){var r=l.scaleBy(0,.7),u=l.scaleTo(1,1.2),p=l.delayTime(1),c=l.callFunc(this.showFailedScene,this),m=l.callFunc(this.showFailedScene,this),_=l.sequence(r,u,c,p,m);_.setTag(-7),this.spNum.runAction(_)}this.m_rebornNum--},showFailedScene:function(){var e=wr.getModel();if(-2==this.m_rebornNum){if(e.m_nGameMode==ge.HIGHERMODE)e.m_oHigher.setCurLevelLose(),e.gameLayer.showStoryWinOrLose(!1);else if(!e.lose_show){e.m_nRecoveryTime=3;var t=e.gameLayer;t.nGameState=0,t.defeated()}}else-1==this.m_rebornNum&&(this.m_rebornNum--,e.playSoundWithFile("res/Music/Items/Reborn.mp3"))},showGiftBallChild:function(e){var t=e;if(t){var i=wr.getModel(),n=t.getContentSize(),s=null;if(1222==t.getTag())switch(i.m_nGameMode==ge.HIGHERMODE?i.m_oHigher.getPackageType():i.mapCompose.getPackageType()){case _e.CUTCREEPHP:s="floor_gift_normal.png";break;case _e.CUTBOSSHP:s="floor_gift_boss.png";break;case _e.ADDGOLD:s="floor_gift_coin.png";break;case _e.CUTALLMONSTERHP:s="floor_gift_all.png";break;case _e.NODOWNLEVEL:s="floor_gift_stay.png",this._packType=_e.NODOWNLEVEL;break;case _e.ADDPOWER:s="floor_gift_tower.png";break;case _e.ADDCARROTHP:s="floor_gift_heart.png"}else switch(i.m_nGameMode==ge.HIGHERMODE?i.m_oHigher.getGiveMagicType():i.mapCompose.getGiveMagicType()){case fe.SLOWBB:s="floor_magic_slow.png";break;case fe.STOPBB:s="floor_magic_ice.png";break;case fe.SHOOTBB:s="floor_magic_speed.png";break;case fe.ADDHPBB:s="floor_magic_heart.png";break;case fe.CLEARBB:s="floor_magic_bomb.png"}var r=new l.Sprite(s);r.setPosition(n.width/2,n.height/2),t.addChild(r,-2),i.playSoundWithType($.MTLUCKBAG);var a=new l.Sprite("floor_gift_snow1.png");a.setPosition(n.width/2,n.height/2-30),t.addChild(a,-1),a.runAction(l.sequence(l.moveBy(.1,0,40),l.spawn(l.moveBy(.3,0,-40),l.fadeOut(.3))));var o=new l.Sprite("floor_gift_snow2.png");o.setPosition(n.width/2,n.height/2-33),t.addChild(o,-1);var h=l.callFunc(this.unLockGiftBallClick.bind(this,t));o.runAction(l.sequence(l.moveBy(.1,0,40),l.spawn(l.moveBy(.8,0,-30),l.fadeOut(.8)),h));var d=nr.share().getMapOffset();if(1222==t.getTag()){var c=new l.Sprite("floor_gift_50.png"),u=new l.Sprite("floor_gift_50.png");(p=new l.MenuItemSprite(c,u,null,this,this.changeMenuItemState.bind(this))).setPosition(270+d.width,179),p.setTag(tn.GIFTBALL_OK1),(m=new l.Menu(p)).setPosition(0,0),i.animeLayer.addChild(m,sr.GIFTBALL_Z_START+2,1226)}else if(1223==t.getTag()){var c=new l.Sprite("floor_gift_get.png"),u=new l.Sprite("floor_gift_get.png"),p=new l.MenuItemSprite(c,u,null,this,this.changeMenuItemState);p.setPosition(685+d.width,179),p.setTag(tn.GIFTBALL_OK2);var m=new l.Menu(p);m.setPosition(0,0),i.animeLayer.addChild(m,sr.GIFTBALL_Z_START+2,1227)}}},unLockGiftBallClick:function(e){e&&(1222==e.getTag()?this.bLockGiftBallClick=!1:this.bLockGiftBallClick1=!1)},showSecondGiftBall:function(){var e=wr.getModel(),t=nr.share().getMapOffset(),i=new l.Sprite("floor_gift_ball.png");i.setPosition(687+t.width,873),e.animeLayer.addChild(i,sr.GIFTBALL_Z_START+2,1223);var n=l.moveTo(.4,687+t.width,333),s=l.callFunc(this.showGiftBallChild,this,i),r=l.callFunc(this.showGiftBallText,this,i),a=l.callFunc(this.showGiftBallClose,this,i),o=l.sequence(n,s,l.delayTime(.1),r,l.delayTime(.3),a);i.runAction(o)},showGiftBallText:function(e){var t=e;if(t){var i=wr.getModel(),n=null,s=null;if(1222==t.getTag())switch(i.m_nGameMode==ge.HIGHERMODE?i.m_oHigher.getPackageType():i.mapCompose.getPackageType()){case _e.CUTCREEPHP:n="floor_gift_normal_title.png";break;case _e.CUTBOSSHP:n="floor_gift_boss_title.png";break;case _e.ADDGOLD:n="floor_gift_coin_title.png";break;case _e.CUTALLMONSTERHP:n="floor_gift_all_title.png";break;case _e.NODOWNLEVEL:n="floor_gift_stay_title.png";break;case _e.ADDPOWER:n="floor_gift_tower_title.png";break;case _e.ADDCARROTHP:n="floor_gift_heart_title.png"}else{switch(i.m_nGameMode==ge.HIGHERMODE?i.m_oHigher.getGiveMagicType():i.mapCompose.getGiveMagicType()){case fe.SLOWBB:n="floor_magic_slow_title.png";break;case fe.STOPBB:n="floor_magic_ice_title.png";break;case fe.SHOOTBB:n="floor_magic_speed_title.png";break;case fe.ADDHPBB:n="floor_magic_heart_title.png";break;case fe.CLEARBB:n="floor_magic_bomb_title.png"}switch(i.m_nGameMode==ge.HIGHERMODE?i.m_oHigher.getGiveCount():i.mapCompose.getGiveCount()){case 1:s="floor_magic_1.png";break;case 2:s="floor_magic_2.png";break;case 3:s="floor_magic_3.png";break;case 4:s="floor_magic_4.png";break;case 5:s="floor_magic_5.png"}}var r=new l.Sprite(n);if(r.setPosition(t.width/2,t.height/2),t.addChild(r,1),r.setOpacity(0),r.runAction(l.fadeIn(.3)),s){var a=new l.Sprite(s);GamePlatform.isCN()?a.setPosition(r.width/2,r.height/2):a.setPosition(r.width/4+26,r.height/2-18),r.addChild(a)}}},showGiftBallClose:function(e){var t=e;if(t){var i=wr.getModel(),n=nr.share().getMapOffset(),s=new l.Sprite("floor_gift_close.png"),r=new l.Sprite("floor_gift_close.png"),a=new l.MenuItemSprite(s,r,null,this,this.changeMenuItemState.bind(this));if(1222==t.getTag())a.setPosition(385+n.width,481),a.setTag(tn.GIFTBALL_CLOSE1),(o=new l.Menu(a)).setPosition(0,0),i.animeLayer.addChild(o,sr.GIFTBALL_Z_START+2,1224);else if(1223==t.getTag()){a.setPosition(800+n.width,481),a.setTag(tn.GIFTBALL_CLOSE2);var o=new l.Menu(a);o.setPosition(0,0),i.animeLayer.addChild(o,sr.GIFTBALL_Z_START+2,1225)}}},showTopAndBottomBar:function(){var e=this.getChildByTag(J.MENUBG);e&&e.setVisible(!0),(e=this.getChildByTag(J.MENUCENTER))&&e.setVisible(!0),(e=this.getChildByTag(J.MENUBTN))&&e.setVisible(!0),(e=this.getChildByTag(221))&&e.setVisible(!0),(e=this.getChildByTag(222))&&e.setVisible(!0),(e=this.getChildByTag(223))&&e.setVisible(!0),this.bottomBar&&this.bottomBar.setVisible(!0)},hideTopAndBottomBar:function(){var e=this.getChildByTag(J.MENUBG);e&&e.setVisible(!1),(e=this.getChildByTag(J.MENUCENTER))&&e.setVisible(!1),(e=this.getChildByTag(J.MENUBTN))&&e.setVisible(!1),(e=this.getChildByTag(221))&&e.setVisible(!1),(e=this.getChildByTag(222))&&e.setVisible(!1),(e=this.getChildByTag(223))&&e.setVisible(!1),this.bottomBar&&this.bottomBar.setVisible(!1)},showBottomBarItems:function(){qu.addRes(this,"res/Themes/Items/Items02-hd.plist");var e,t=null,i=wr.getModel(),n=i.getObjectByType(J.BARITEMNUMOVER),s=i.getObjectByType(J.BARITEMNUMUNDER),r=(n.szTile,s.szTile,0),a=nr.share().getMapOffset().width;if(this.bottomBar=new l.Sprite("BottomBG.png"),this.bottomBar.setAnchorPoint(0,0),this.bottomBar.setPosition(a,0),this.addChild(this.bottomBar,2999),!i.isPlayMess()&&(i.m_nGameMode==ge.NORMALMODE||i.m_nGameMode==ge.DOUBLECARROT)){var o=null;o=i.usersData.getTaskHonor(i.curLevel)?l.spriteFrameCache.getSpriteFrame("adv_bottoolbar_mission_all.png"):l.spriteFrameCache.getSpriteFrame("adv_bottoolbar_mission_bg.png");var h=new l.Sprite(o);h.setPosition(110,26),h.setTag(pe.BOTTOM_BAR_MISSION),this.bottomBar.addChild(h),this._spMission=h,i.usersData.getTaskHonor(i.curLevel)||this.InitTaskState()}var d=null,c=i.usersData,u=new l.Sprite("BarBlank.png");u.setPosition(422,35),this.bottomBar.addChild(u,ft.Z0);var p=new At,m=c.showBottomBomb(4);if(!m||i.bLoopPath)p.isForbidden=i.bLoopPath,p.isLocked=!m,p.initWithSpriteFrameName(m?"BarForbidden.png":"BarLocked.png"),p.setPosition(422,35),p.setTag(pe.BOTTOM_BAR_BOMB),this.bottomBar.addChild(p,ft.Z1);else{var _=0==(r=c.getClearBBCount());if(p.initWithSpriteFrameName(_?"BarBomb02.png":"BarBomb01.png"),p.setPosition(422,35),p.setTag(pe.BOTTOM_BAR_BOMB),p.fLastTiming=60,this.bottomBar.addChild(p,ft.Z1),d=new l.Sprite("BarCounterBG.png"),this.dictBarCounterObjectsBG.BottomBarItem_100=d,d.setPosition(450,60),this.bottomBar.addChild(d,ft.Z4),_||r>99){var g=new l.Sprite(_?"BarCounter00.png":"BarCounter03.png"),T=_?58:60;g.setPosition(450,T),this.bottomBar.addChild(g,ft.Z5),this.dictBarCounterObjects.BottomBarItem_100=g}else{r<10&&r>0?(t=s,e=s.szTile,S=l.p(443,51)):r>=10&&r<=99&&(t=n,e=n.szTile,S=l.p(437,53)),(w=new l.LabelAtlas("00",t.strPic,e.width,e.height,"./0123456789")).setString(String.formatC("%lu",r)),w.setPosition(S),this.bottomBar.addChild(w,ft.Z5),this.dictBarCounterObjects.BottomBarItem_100=w}}if((u=new l.Sprite("BarBlank.png")).setPosition(532,35),this.bottomBar.addChild(u,ft.Z0),p=new At,!c.showBottomBomb(3)||i.bLoopPath)c.showBottomBomb(3)?(p.isForbidden=!0,p.initWithSpriteFrameName("BarForbidden.png")):(p.isLocked=!0,p.initWithSpriteFrameName("BarLocked.png")),p.setPosition(532,35),p.setTag(pe.BOTTOM_BAR_BLOOD),this.bottomBar.addChild(p,ft.Z1);else if(0==(r=c.getCarrotHPCount())?p.initWithSpriteFrameName("BarBlood02.png"):p.initWithSpriteFrameName("BarBlood01.png"),p.setPosition(532,35),p.setTag(pe.BOTTOM_BAR_BLOOD),p.fLastTiming=150,this.bottomBar.addChild(p,ft.Z1),d=new l.Sprite("BarCounterBG.png"),this.dictBarCounterObjectsBG.BottomBarItem_101=d,d.setPosition(560,60),this.bottomBar.addChild(d,ft.Z4),0==r)(g=new l.Sprite("BarCounter00.png")).setPosition(560,58),this.bottomBar.addChild(g,ft.Z5),this.dictBarCounterObjects.BottomBarItem_101=g;else if(r>99)(f=new l.Sprite("BarCounter03.png")).setPosition(560,60),this.bottomBar.addChild(f,ft.Z5),this.dictBarCounterObjects.BottomBarItem_101=f;else{r<10&&r>0?(t=s,e=s.szTile,S=l.p(553,51)):r>=10&&r<=99&&(t=n,e=n.szTile,S=l.p(547,53)),(w=new l.LabelAtlas("00",t.strPic,e.width,e.height,"./0123456789")).setString(String.formatC("%lu",r)),w.setPosition(S),this.bottomBar.addChild(w,ft.Z5),this.dictBarCounterObjects.BottomBarItem_101=w}if((u=new l.Sprite("BarBlank.png")).setPosition(642,35),this.bottomBar.addChild(u,ft.Z0),p=new At,c.showBottomBomb(2))if(0==(r=c.getShootSPCount())?p.initWithSpriteFrameName("BarSpeed02.png"):p.initWithSpriteFrameName("BarSpeed01.png"),p.setPosition(642,35),p.setTag(pe.BOTTOM_BAR_SPEED),p.fLastTiming=40,this.bottomBar.addChild(p,ft.Z1),d=new l.Sprite("BarCounterBG.png"),this.dictBarCounterObjectsBG.BottomBarItem_102=d,d.setPosition(670,60),this.bottomBar.addChild(d,ft.Z4),t=i.getObjectByType(J.BARITEMNUMOVER),e=t.szTile,0==r)(g=new l.Sprite("BarCounter00.png")).setPosition(670,58),this.bottomBar.addChild(g,ft.Z5),this.dictBarCounterObjects.BottomBarItem_102=g;else if(r>99)(f=new l.Sprite("BarCounter03.png")).setPosition(670,60),this.bottomBar.addChild(f,ft.Z5),this.dictBarCounterObjects.BottomBarItem_102=f;else{r<10&&r>0?(t=s,e=s.szTile,S=l.p(663,51)):r>=10&&r<=99&&(t=n,e=n.szTile,S=l.p(657,53)),(w=new l.LabelAtlas("00",t.strPic,e.width,e.height,"./0123456789")).setString(String.formatC("%lu",r)),w.setPosition(S),this.bottomBar.addChild(w,ft.Z5),this.dictBarCounterObjects.BottomBarItem_102=w}else p.isLocked=!0,p.initWithSpriteFrameName("BarLocked.png"),p.setPosition(642,35),p.setTag(pe.BOTTOM_BAR_SPEED),this.bottomBar.addChild(p,ft.Z1);if((u=new l.Sprite("BarBlank.png")).setPosition(752,35),this.bottomBar.addChild(u,ft.Z0),p=new At,c.showBottomBomb(1))if(0==(r=c.getStopBBCount())?p.initWithSpriteFrameName("BarICE02.png"):p.initWithSpriteFrameName("BarICE01.png"),p.setPosition(752,35),p.fLastTiming=40,p.setTag(pe.BOTTOM_BAR_ICE),this.bottomBar.addChild(p,ft.Z1),d=new l.Sprite("BarCounterBG.png"),this.dictBarCounterObjectsBG.BottomBarItem_103=d,d.setPosition(780,60),this.bottomBar.addChild(d,ft.Z4),0==r)(g=new l.Sprite("BarCounter00.png")).setPosition(780,58),this.bottomBar.addChild(g,ft.Z5),this.dictBarCounterObjects.BottomBarItem_103=g;else if(r>99)(f=new l.Sprite("BarCounter03.png")).setPosition(780,60),this.bottomBar.addChild(f,ft.Z5),this.dictBarCounterObjects.BottomBarItem_103=f;else{r<10&&r>0?(t=s,e=s.szTile,S=l.p(773,51)):r>=10&&r<=99&&(t=n,e=n.szTile,S=l.p(767,53)),(w=new l.LabelAtlas("00",t.strPic,e.width,e.height,"./0123456789")).setString(String.formatC("%lu",r)),w.setPosition(S),this.bottomBar.addChild(w,ft.Z5),this.dictBarCounterObjects.BottomBarItem_103=w}else p.isLocked=!0,p.initWithSpriteFrameName("BarLocked.png"),p.setPosition(752,35),p.setTag(pe.BOTTOM_BAR_ICE),this.bottomBar.addChild(p,ft.Z1);if((u=new l.Sprite("BarBlank.png")).setPosition(862,35),this.bottomBar.addChild(u,ft.Z0),p=new At,c.showBottomBomb(0))if(0==(r=c.getSlowBBCount())?p.initWithSpriteFrameName("BarSlow02.png"):p.initWithSpriteFrameName("BarSlow01.png"),p.setPosition(862,35),p.fLastTiming=40,p.setTag(pe.BOTTOM_BAR_SLOW),this.bottomBar.addChild(p,ft.Z1),d=new l.Sprite("BarCounterBG.png"),this.dictBarCounterObjectsBG.BottomBarItem_104=d,d.setPosition(890,60),this.bottomBar.addChild(d,ft.Z4),0==r)(g=new l.Sprite("BarCounter00.png")).setPosition(890,58),this.bottomBar.addChild(g,ft.Z5),this.dictBarCounterObjects.BottomBarItem_104=g;else if(r>99){var f=new l.Sprite("BarCounter03.png");f.setPosition(890,60),this.bottomBar.addChild(f,ft.Z5),this.dictBarCounterObjects.BottomBarItem_104=f}else{var S;r<10&&r>0?(t=s,e=s.szTile,S=l.p(883,51)):r>=10&&r<=99&&(t=n,e=n.szTile,S=l.p(877,53));var w=new l.LabelAtlas("00",t.strPic,e.width,e.height,"./0123456789");w.setString(String.formatC("%lu",r)),w.setPosition(S),this.bottomBar.addChild(w,ft.Z5),this.dictBarCounterObjects.BottomBarItem_104=w}else p.isLocked=!0,p.initWithSpriteFrameName("BarLocked.png"),p.setPosition(862,35),p.setTag(pe.BOTTOM_BAR_SLOW),this.bottomBar.addChild(p,ft.Z1)},showBottomBarTimerAnimate:function(){var e=null;(e=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_BOMB))&&!e.isLocked&&e.onTiming(),(e=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_BLOOD))&&!e.isLocked&&e.onTiming(),(e=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_SPEED))&&!e.isLocked&&e.onTiming(),(e=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_ICE))&&!e.isLocked&&e.onTiming(),(e=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_SLOW))&&!e.isLocked&&e.onTiming()},changeItemZOrder:function(e){var t=wr.getModel();if(e);else{1==t.curTheme&&(t.animeLayer.removeChildByTag(1002,!0),this.removeChildByTag(1007,!0)),t.animeLayer.removeChildByTag(2003,!0);for(var i=null,n=1001;n<1003;n++)(i=t.gameLayer.getChildByTag(n))&&t.gameLayer.removeChild(i,!0);t.animeLayer.removeChildByTag(1001,!0);var s=t.gameLayer.selTowerUpdate;for(var n in s)(i=s[n]).setVisible(!0);1==t.curTheme?String.formatC(t.gameObjectConfig.strItemsPic,3):String.formatC(t.gameObjectConfig.strItemsPic,9),t.curShowPlayerGuid==re.FBPLAYEDGUIDE||t.curShowPlayerGuid==re.FBPLAYEDGUIDE1?(t.setGuidState(!0),l.director.getScheduler().isWaite=!0,(t.curShowPlayerGuid==re.FBPLAYEDGUIDE||this._isClickSkip)&&(t.curShowPlayerGuid=t.curShowPlayerGuid1,t.gameLayer.showGuide())):(t.curShowPlayerGuid=re.UNKNOWGUIDE,t.animeLayer&&t.animeLayer.showCountDownTip(0)),GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&SDKInterface.logEvent&&SDKInterface.logEvent("Guide Over")}},changeGuidTips:function(){var e=this.nGuidStep,t=wr.getModel(),i=t.animeLayer.getChildByTag(2003);switch(e){case 0:case 1:break;case 2:if((m=i.getChildByTag(1001))&&m.setVisible(!1),(m=i.getChildByTag(1002))&&m.setVisible(!1),(m=i.getChildByTag(1003))&&m.setVisible(!1),(m=i.getChildByTag(2001))&&m.setVisible(!0),m=i.getChildByTag(2002)){m.setVisible(!0);var n=l.scaleTo(0,0,0),s=l.scaleTo(.1,.5,.5),r=l.scaleTo(.1,1,1);m.runAction(l.sequence(n,s,r))}if(m=i.getChildByTag(2003)){m.setVisible(!0),m.setPosition(212,-356);var a=l.p(212,144),o=l.moveTo(.1,a.x,a.y-20),h=l.moveTo(.1,a.x,a.y);m.runAction(l.sequence(l.delayTime(.1),o,h))}(m=i.getChildByTag(1004))&&m.setPosition(82,72);var d=(t=wr.getModel()).buildspace[0],c=t.animeLayer.getChildByTag(1002);if(c){c.setVisible(!0),c.stopAllActions(),c.setPosition(l.pAdd(l.p(d.x,d.y),l.p(.2*d.width+30,d.height-30)));var u=l.moveBy(.6,-30,30);c.runAction(l.repeatForever(l.sequence(u,u.reverse())))}break;case 3:if((m=i.getChildByTag(2001))&&m.setVisible(!1),(m=i.getChildByTag(224))&&m.setVisible(!1),(m=i.getChildByTag(2002))&&m.setVisible(!1),(m=i.getChildByTag(2003))&&m.setVisible(!1),(m=i.getChildByTag(3001))&&m.setVisible(!0),m=i.getChildByTag(3002)){m.setVisible(!0);var n=l.scaleTo(0,.1,.1),s=l.scaleTo(.1,1.2,1.2),r=l.scaleTo(.1,1,1);m.runAction(l.sequence(n,s,r))}if(m=i.getChildByTag(3003)){m.setVisible(!0),m.setScale(0);var n=l.scaleTo(.1,2,2),s=l.scaleTo(.1,.7,.7),r=l.scaleTo(.1,1,1);this.nGuidStep=4,m.runAction(l.sequence(l.delayTime(.2),n,s,r,l.delayTime(3),l.callFunc(this.changeGuidTips,this)))}(m=i.getChildByTag(1004))&&m.setPosition(104,72);break;case 4:var p=nr.share().getWinSize(),m=i.getChildByTag(2003);if(!m)break;m.setVisible(!1),this.nGuidStep=5,i.runAction(l.sequence(l.moveBy(.1,0,-20),l.moveTo(.2,i.x,p.height+.6*i.height),l.callFunc(this.changeGuidTips,this)));break;case 5:this.nGuidStep=0,this.changeItemZOrder(!1),this.showTopAndBottomBar()}},showModeTips:function(){var e=nr.share().getWinSize(),t=nr.share().getMapOffset(),i=wr.getModel();qu.addRes(this,"res/Themes/Items/ModeTour-hd.plist");var n=i.usersData.m_nLanguage,s=String.formatC("res/Themes%s/Items/ModeTour-hd%s.plist",n,n);qu.addRes(this,s);var r=l.spriteFrameCache.getSpriteFrame("modetour_bg.png"),a=l.color(0,0,0,180),o=new l.LayerColor(a);o&&(o.setPosition(0,0),o.setContentSize(e),this.addChild(o,3e3,1888));var h=new l.Sprite(r);h.setPosition(480+t.width,336),o.addChild(h);var d=null;switch(i.curShowPlayerGuid){case re.JEWELBOXGUIDE:(d=new l.Sprite("modetour_pic_chance.png")).setPosition(194,244),h.addChild(d),(d=new l.Sprite("modetour_text_chance.png")).setPosition(496,290),h.addChild(d);break;case re.BOSSMDGUIDE:(d=new l.Sprite("modetour_pic_boss.png")).setPosition(194,244),h.addChild(d),(d=new l.Sprite("modetour_text_boss.png")).setPosition(496,290),h.addChild(d);break;case re.DOUBLEPATHGUIDE:(d=new l.Sprite("modetour_pic_2ways.png")).setPosition(194,244),h.addChild(d),(d=new l.Sprite("modetour_text_2ways.png")).setPosition(496,290),h.addChild(d);break;case re.FORTMODEGUIDE:(d=new l.Sprite("modetour_pic_gate.png")).setPosition(194,244),h.addChild(d),(d=new l.Sprite("modetour_text_gate.png")).setPosition(496,290),h.addChild(d);break;case re.TRANSFERGUIDE:(d=new l.Sprite("modetour_pic_transfer.png")).setPosition(194,244),h.addChild(d),(d=new l.Sprite("modetour_text_transfer.png")).setPosition(496,290),h.addChild(d)}var c=new l.Sprite("btn_blue_m.png"),u=new l.Sprite("btn_blue_m_pressed.png"),p=new l.MenuItemSprite(c,u,null,this,this.changeMenuItemState.bind(this));p.setPosition(502,154),p.setTag(tn.NewModeTips),(d=new l.Sprite("btn_blue_ok.png")).setPosition(130,50),p.addChild(d);var m=new l.Menu(p);m.setPosition(0,0),h.addChild(m,2,2),this.forNewTowerCardPlaySound()},showNewTowerCard:function(){var e=wr.getModel(),t=nr.share().getWinSize();qu.addRes(this,String.formatC(e.gameObjectConfig.strItemsPic,4));var i=e.usersData.m_nLanguage,n=String.formatC("res/Themes%s/Items/Items04-hd%s.plist",i,i);qu.addRes(this,n);var s=new l.LayerColor(l.color(0,0,0,178),t.width,t.height);e.animeLayer.addChild(s,3001,3001),qu.addRes(this,"res/Themes/Items/Common_shine_bg-hd.plist"),this.spShineBg=new l.Sprite("shine_bg.png"),this.spShineBg.setScale(.1),this.spShineBg.setPosition(t.width/2,t.height/2),e.animeLayer.addChild(this.spShineBg,3002,3002);var r=l.scaleTo(.2,1),a=l.callFunc(this.newTowerCardShineBgAnimate,this);this.spShineBg.runAction(l.sequence(r,a)),this.spCardBg=new l.Sprite("newtower_bg.png"),this.spCardBg.setScale(.05),this.spCardBg.setPosition(l.p(t.width/2,nr.share().getMapOffset().height+318)),this.spCardBg.setRotation(-90),e.animeLayer.addChild(this.spCardBg,3003,3003);var o=e.gameObjectConfig.towerGroup[e.curNewTowerCard+J.TBOTTLE-1].strName,h=String.formatC("newtower_%s.png",o),d=new l.Sprite(h);d.setPosition(290,290),this.spCardBg.addChild(d);var c=new l.Sprite("btn_green_m.png"),u=new l.Sprite("btn_ok.png");u.setAnchorPoint(0,0),u.setPosition(0,0),c.addChild(u);var p=new l.Sprite("btn_green_m_pressed.png"),m=new l.Sprite("btn_ok.png");m.setAnchorPoint(0,0),m.setPosition(0,0),p.addChild(m);var _=new l.MenuItemSprite(c,p,null,this,this.changeMenuItemState.bind(this));_.setPosition(0,0),_.setTag(tn.NewTowerCard);var g=new l.Menu(_);g.setAnchorPoint(.5,.5),g.setPosition(.5*this.spCardBg.width,.17*this.spCardBg.height),this.spCardBg.addChild(g,2);var T=l.scaleTo(.2,1.2),f=l.rotateTo(.2,0),S=l.callFunc(this.newTowerCardAnimate,this),w=l.sequence(l.spawn(T,f),l.scaleTo(.1,.9),l.scaleTo(.1,1),S);this.spCardBg.runAction(w)},newTowerCardShineBgAnimate:function(){var e=l.fadeTo(.3,128),t=l.fadeTo(.3,255),i=l.repeatForever(l.sequence(e,t));this.spShineBg.runAction(i),this.forNewTowerCardPlaySound()},newTowerCardAnimate:function(){var e=wr.getModel(),t=String.formatC("btower_%s.png",e.gameObjectConfig.towerGroup[e.curNewTowerCard+J.TBOTTLE-1].strName),i=new l.Sprite(t);i.setPosition(290,452),i.setScale(2.5),this.spCardBg.addChild(i);var n=l.sequence(l.scaleTo(.1,.8),l.scaleTo(.1,1));i.runAction(n)},forNewTowerCardPlaySound:function(){wr.getModel().playSoundWithType($.MTUNLOCK)},showNewPropCard:function(e){switch(e){case 0:this.strProp="slow";break;case 1:this.strProp="ice";break;case 2:this.strProp="speed";break;case 3:this.strProp="blood";break;case 4:this.strProp="bomb"}var t=wr.getModel(),i=nr.share().getWinSize();qu.addRes(this,"res/Themes/Items/NewProp-hd.plist");var n=t.usersData.m_nLanguage,s=String.formatC("res/Themes%s/Items/NewProp-hd%s.plist",n,n);qu.addRes(this,s),qu.addRes(this,String.formatC(t.gameObjectConfig.strItemsPic,4));var r=new l.LayerColor(l.color(0,0,0,178),i.width,i.height);t.animeLayer.addChild(r,3001,3001),qu.addRes(this,"res/Themes/Items/Common_shine_bg-hd.plist"),this.spShineBg=new l.Sprite("shine_bg.png"),this.spShineBg.setScale(.1),this.spShineBg.setPosition(i.width/2,i.height/2),t.animeLayer.addChild(this.spShineBg,3002,3002);var a=l.scaleTo(.2,1),o=l.callFunc(this.newTowerCardShineBgAnimate,this);this.spShineBg.runAction(l.sequence(a,o)),this.spCardBg=new l.Sprite("newprop_bg.png"),this.spCardBg.setScale(.05),this.spCardBg.setPosition(l.p(i.width/2,nr.share().getMapOffset().height+318)),this.spCardBg.setRotation(-90),t.animeLayer.addChild(this.spCardBg,3003,3003);var h=String.formatC("newprop_%s.png",this.strProp),d=new l.Sprite(h);d.setPosition(290,290),this.spCardBg.addChild(d);var c=new l.Sprite("btn_green_m.png"),u=new l.Sprite("btn_ok.png");u.setAnchorPoint(0,0),u.setPosition(0,0),c.addChild(u);var p=new l.Sprite("btn_green_m_pressed.png"),m=new l.Sprite("btn_ok.png");m.setAnchorPoint(0,0),m.setPosition(0,0),p.addChild(m);var _=new l.MenuItemSprite(c,p,null,this,this.changeMenuItemState.bind(this));_.setPosition(0,0),_.setTag(tn.NewTowerCard);var g=new l.Menu(_);g.setAnchorPoint(.5,.5),g.setPosition(.5*this.spCardBg.width,.17*this.spCardBg.height),this.spCardBg.addChild(g,2);var T=l.scaleTo(.2,1.2),f=l.rotateTo(.2,0),S=l.callFunc(this.newPropCardAnimate,this),w=l.sequence(l.spawn(T,f),l.scaleTo(.1,.9),l.scaleTo(.1,1),S);this.spCardBg.runAction(w)},newPropCardAnimate:function(){var e=new l.Sprite(String.formatC("bprop_%s.png",this.strProp));e.setPosition(290,452),e.setScale(2.5),this.spCardBg.addChild(e);var t=l.sequence(l.scaleTo(.1,.8),l.scaleTo(.1,1));e.runAction(t)},showBossModeTimeBar:function(){var e=wr.getModel();nr.share().getMapOffset();if(null!=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_BOSSMODETIME)){var t=e.nCountDownTime;return e.nCountDownTime=(Math.abs(e.nCountDownTime)+1)*(t<0?-1:1),void this.changeBossModeTime()}var i=new l.Sprite("boss_bottoolbar_sep.png");i.setPosition(480,35),this.bottomBar.addChild(i,ft.Z0);var n=new l.Sprite("timer_bg.png");n.setPosition(277,35),n.setTag(pe.BOTTOM_BAR_BOSSMODETIME),this.bottomBar.addChild(n,ft.Z1);var s=null;(s=e.m_nGameMode==ge.HIGHERMODE?new l.Sprite("timer_floor.png"):new l.Sprite("timer_gold.png")).setPosition(0,0),s.setAnchorPoint(0,0),n.addChild(s,1,0);var r=new l.LabelAtlas("0","num_white_18.png",18,30,"./0123456789");r.setPosition(52,20),n.addChild(r,1,1);var a=new l.LabelAtlas("0","num_white_18.png",18,30,"./0123456789");a.setPosition(82,20),n.addChild(a,1,2);var o=new l.LabelAtlas("0","num_white_18.png",18,30,"./0123456789");o.setPosition(112,20),n.addChild(o,1,3);var h=String.formatC("%ld",-e.nCountDownTime);if(-e.nCountDownTime>99){var d=h.substr(0,1),c=h.substr(1,1),u=h.substr(2,1);r.setString(d),a.setString(c),o.setString(u)}else if(-e.nCountDownTime>9){var c=h.substr(0,1),u=h.substr(1,1);r.setString("0"),a.setString(c),o.setString(u)}else{u=h.substr(0,1);r.setString("0"),a.setString("0"),o.setString(u)}return},getMenuItemWithType:function(e,t,i,n,s){var r=wr.getModel(),a=String.formatC(t.strPic,n,1);r.m_nGameMode==ge.HIGHERMODE&&"menu01.png"==a&&(a="menu_share.png");var o=l.spriteFrameCache.getSpriteFrame(a),h=new l.Sprite(o),d=3*(e-J.PAUSE)+tn.ItemPause;h.setTag(d),o=l.spriteFrameCache.getSpriteFrame(a);var c=new l.Sprite(o),u=d+1;c.setTag(u);var p=new l.MenuItemSprite(h,c,null,this,this.changeMenuItemState.bind(this));return p.setAnchorPoint(0,1),p.setPosition(i),p.setTag(d+2),p},changeMenuItemWithType:function(e,t,i){t=parseInt(t);var n=wr.getModel().getObjectByType(parseInt((e-tn.ItemPause)/3)+J.PAUSE),s=i.getChildByTag(l.NORMAL_TAG),r=String.formatC(n.strPic,t,1),a=l.spriteFrameCache.getSpriteFrame(r);s.setSpriteFrame(a),s=i.getChildByTag(l.SELECTED_TAG),a=l.spriteFrameCache.getSpriteFrame(r),s.setSpriteFrame(a)},changeMenuItemState:function(e){var t=e;if(!((c=wr.getModel()).bLockMenu&&t.getTag()<tn.SkipGuid))switch(c.playSoundWithType($.MTMENUSELECT),t.getTag()){case tn.PauseMenu:var i=null,n=c.getObjectByType(J.MENUCENTER),s=l.director.getScheduler().isWaite;if(s){for(var r in c.towers)(a=c.towers[r])&&a.fLastShootSystemTime>0&&(a.fLastShootSystemTime=c.getCurSystemTime());if((u=c.usersData.getCarrotFigure())!=ue.CARROT_NORMAL&&u!=ue.CARROT_FAT){var a=c.gameLayer.house;a&&a.fLastShootSystemTime>0&&(a.fLastShootSystemTime=c.getCurSystemTime())}c.playMuiscWithType($.MTWARBGMSC,4),i=String.formatC(n.strPic,1,c.usersData.m_nLanguage),l.director.getScheduler().isWaite=!1,s=!1}else c.playMuiscWithType($.MTWARBGMSC,3),i=String.formatC(n.strPic,2,c.usersData.m_nLanguage),l.director.getScheduler().isWaite=!0,s=!0;this.changeMenuItemWithType(tn.PauseMenu,s?1:0,t),this.btnIsWaitState=s;var o=l.spriteFrameCache.getSpriteFrame(i);if(o){var h=this.getChildByTag(J.MENUCENTER);h&&(this.lableWaves&&(this.lableWaves.setVisible(!s),this.lableCurWave.setVisible(!s)),h.setSpriteFrame(o))}break;case tn.SpeedMenu:var d=l.director.getScheduler().getTimeScale();1==d?(l.director.getScheduler().setTimeScale(2),d=2):(l.director.getScheduler().setTimeScale(1),d=1),this.changeMenuItemWithType(tn.SpeedMenu,parseInt(d),t);break;case tn.ShowMenu:if(c.m_nGameMode==ge.HIGHERMODE){0==l.director.getScheduler().isWaite&&(l.director.getScheduler().isWaite=!0);var c=wr.getModel();GamePlatform.getCurrentPlatForm()==PlatformType.QQ?kl.shareScreenshot(Wl.DAYDAY_SHARE,function(){c.showRewardLayer||(l.director.getScheduler().isWaite=!1)}):kl.shareMessage(b.Share_Title7,b.ShareText7,Wl.DAYDAY_SHARE,0,11,null,function(){c.showRewardLayer||(l.director.getScheduler().isWaite=!1)})}else this.showMenu();break;case tn.SkipGuid:c.curShowPlayerGuid==re.PLAYEDGUIDE?this.nGuidStep=4:this.nGuidStep=5,this._isClickSkip=!0,GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&SDKInterface.logEvent&&SDKInterface.logEvent("SkipGuid"),this.changeGuidTips();break;case tn.NewTowerCard:c.animeLayer.removeChildByTag(3001,!0),c.animeLayer.removeChildByTag(3002,!0),c.animeLayer.removeChildByTag(3003,!0),qu.releaseWithArray(Ci),qu.releaseWithArray(Bi),l.director.getScheduler().isWaite&&(l.director.getScheduler().isWaite=!1),c.animeLayer&&c.animeLayer.showCountDownTip(0);break;case tn.NewModeTips:this.removeChildByTag(1888,!0),qu.releaseWithArray(Mi),c.animeLayer&&c.animeLayer.showCountDownTip(0);break;case tn.GIFTBALL_OK1:if(this.bLockGiftBallClick)return;if((p=c.animeLayer.getChildByTag(998))&&p.isVisible())return;if(c.m_nGameMode==ge.HIGHERMODE&&!c.m_oHigher.pickupPackage()||c.m_nGameMode!=ge.HIGHERMODE&&!c.mapCompose.pickupPackage())return void(c.usersData.enablepay?qu.loadResAsync(Wi,function(){var e=aa.create();c.animeLayer.addChild(e,4e3,998),e.setParent(c.animeLayer,Dr),e.setShowDescription1(ea)}):ju.showLiteralsTip(b.Dialog_Hint));if(dp){var u=this._packType==_e.NODOWNLEVEL?1007:1001;Ql.buyPropById(u,1,c.usersData.getDiamond(),function(e){e&&e.dm&&c.usersData.setDiamond(e.dm)})}Tt.onExchange("幸运礼包-50宝石",1),c.animeLayer.removeChildByTag(1224),c.animeLayer.removeChildByTag(1226),this.showGiftBallOutScreen(1222),this.finishPickupPackage();break;case tn.GIFTBALL_OK2:if(this.bLockGiftBallClick1)return;if((p=c.animeLayer.getChildByTag(998))&&p.isVisible())return;c.animeLayer.removeChildByTag(1225),c.animeLayer.removeChildByTag(1227),this.showGiftBallOutScreen(1223),c.m_nGameMode==ge.HIGHERMODE?c.m_oHigher.pickupMagic():c.mapCompose.pickupMagic();break;case tn.GIFTBALL_CLOSE1:if(this.bLockGiftBallClick)return;if((p=c.animeLayer.getChildByTag(998))&&p.isVisible())return;c.animeLayer.removeChildByTag(1224),c.animeLayer.removeChildByTag(1226),this.showGiftBallOutScreen(1222);break;case tn.GIFTBALL_CLOSE2:if(this.bLockGiftBallClick1)return;var p=c.animeLayer.getChildByTag(998);if(p&&p.isVisible())return;c.animeLayer.removeChildByTag(1225),c.animeLayer.removeChildByTag(1227),this.showGiftBallOutScreen(1223),c.m_nGameMode==ge.HIGHERMODE?c.m_oHigher.pickupMagic():c.mapCompose.pickupMagic()}},showGiftBallOutScreen:function(e){var t=wr.getModel().animeLayer.getChildByTag(e),i=l.callFunc(this.removeGiftBall.bind(this,t));t.runAction(l.sequence(l.moveBy(.2,0,540),i))},removeGiftBall:function(e){var t=wr.getModel();t.animeLayer.removeChild(e,!0);var i=null;1222==e.getTag()?i=t.animeLayer.getChildByTag(1223):1223==e.getTag()&&(i=t.animeLayer.getChildByTag(1222)),null==i&&(t.animeLayer.removeChildByTag(1221),t.animeLayer.showCountDownTip(0),qu.release("res/Themes/Items/GiftBall-hd.plist"))},giftBallNoStoneBuy:function(){var e=wr.getModel();e.animeLayer.removeChildByTag(1224),e.animeLayer.removeChildByTag(1226),this.showGiftBallOutScreen(1222),this.finishPickupPackage(),null==e.animeLayer.getChildByTag(1223)&&(e.animeLayer.removeChildByTag(1221),e.animeLayer.showCountDownTip(0)),e.m_nGameMode==ge.HIGHERMODE?e.m_oHigher.pickupPackage():e.mapCompose.pickupPackage()},finishPickupPackage:function(){var e=wr.getModel(),t=nr.share().getMapOffset(),i=new l.Sprite("floor_gift_tip_shine.png");e.animeLayer.addChild(i,sr.GIFTBALL_Z_END),i.setPosition(t.width+(e.m_nGameMode==ge.HIGHERMODE?110:270),26),i.setScale(.2),i.setOpacity(0);var n=l.callFunc(this.finishPickupPackage1.bind(this,i));i.runAction(l.sequence(l.delayTime(.1),l.spawn(l.scaleTo(.1,1),l.fadeTo(.1,255)),n,l.delayTime(.2),l.fadeOut(.3)))},finishPickupPackage1:function(e){var t=wr.getModel(),i=nr.share().getMapOffset(),n=new l.Sprite("floor_gift_tip_bg.png");n.setPosition(i.width+(t.m_nGameMode==ge.HIGHERMODE?110:270),26),t.animeLayer.addChild(n,sr.GIFTBALL_Z_START);var s=null;switch(t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.getPackageType():t.mapCompose.getPackageType()){case _e.CUTCREEPHP:s="floor_gift_tip_normal.png";break;case _e.CUTBOSSHP:s="floor_gift_tip_boss.png";break;case _e.ADDGOLD:s="floor_gift_tip_coin.png";break;case _e.CUTALLMONSTERHP:s="floor_gift_tip_all.png";break;case _e.NODOWNLEVEL:s="floor_gift_tip_stay.png";break;case _e.ADDPOWER:s="floor_gift_tip_tower.png";break;case _e.ADDCARROTHP:s="floor_gift_tip_heart.png"}var r=new l.Sprite(s);r.setPosition(.5*n.width,.5*n.height),n.addChild(r)},changeBossModeTime:function(){var e=wr.getModel();if(e.gameLastTime++,e.bLoopPath){if(e.nCountDownTime--,e.nCountDownTime<0)return this.unschedule(this.changeBossModeTime),(e=wr.getModel()).playMuiscWithType($.MTWARBGMSC,2),e.m_nGameMode!=ge.HIGHERMODE&&e.playSoundWithType($.MTLOSEGAME),e.bLockMenu=!0,e.gameLayer.defeated(),void(e.bGameStart=!1);if(e.m_nGameMode!=ge.HIGHERMODE){var t=(n=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_BOSSMODETIME)).getChildByTag(0),i=e.nCountDownTime;3!=i&&9!=i||t.runAction(l.sequence(l.scaleTo(.2,3),l.scaleTo(.1,.01,3),l.callFunc(this.changeBossModeMedal,this)))}var n=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_BOSSMODETIME);if(n){var s=n.getChildByTag(1),r=n.getChildByTag(2),a=n.getChildByTag(3),o=String.formatC("%ld",e.nCountDownTime);if(e.nCountDownTime>99){var h=o.substr(0,1),d=o.substr(1,1),c=o.substr(2,1);s.setString(h),r.setString(d),a.setString(c)}else if(e.nCountDownTime>9){var d=o.substr(0,1),c=o.substr(1,1);s.setString("0"),r.setString(d),a.setString(c)}else{c=o.substr(0,1);s.setString("0"),r.setString("0"),a.setString(c)}}}else if(e.curMapConfig.bPresentGate&&15==e.gameLastTime&&e.bShowGateNotHitAnimate)for(var u=e.objects.length,p=0;p<u;p++){var m=e.objects[p];if(m.define.type==J.GATE){var _=new l.Sprite("gate_tip.png");_.setAnchorPoint(.5,0),_.setPosition(m.width/2,m.height),_.setTag(100),_.setScale(.1),m.addChild(_);var g=l.callFunc(this.GateNotHitAnimateCall.bind(this,_)),T=l.sequence(l.scaleTo(.1,1.5),l.scaleTo(.1,1),l.delayTime(3),g);return void _.runAction(T)}}},GateNotHitAnimateCall:function(e){e.runAction(l.repeatForever(l.sequence(l.rotateBy(.1,-30),l.rotateBy(.1,45),l.rotateBy(.1,-15),l.delayTime(3))))},changeBossModeMedal:function(){var e=wr.getModel(),t=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_BOSSMODETIME).getChildByTag(0),i=null;i=e.nCountDownTime>3?l.spriteFrameCache.getSpriteFrame("timer_silver.png"):l.spriteFrameCache.getSpriteFrame("timer_wood.png"),t.setSpriteFrame(i),t.runAction(l.sequence(l.scaleTo(.1,3,3),l.scaleTo(.2,.8),l.scaleTo(.1,1)))},changeBossHP:function(e,t){var i=1-e;t&&(i<.05?i*=6:i=.3+70*(i-.05)/95);var n=this.bossHPBG.getContentSize();this.bossHPNumStrech.setVisible(!0),this.bossHPNumStrech.setScaleX(i*(n.width-46)/this.bossHPNumStrech.width)},towerOnPos:function(e){var t=wr.getModel();for(var i in t.towers){var n=t.towers[i];if(!(n.define.type>J.TRANDOM)&&l.pDistance(n.getPosition(),e)<=.71*n.width)return n}return null},objectOnPos:function(e){var t=wr.getModel(),i=null;for(var n in t.objects)if((r=t.objects[n]).curHP>0&&l.rectContainsPoint(r.getBoundingBox(),e)){i=r;break}if(null==i)for(n=0;n<t.curIndexEnd;n++){var s=t.getIndexOfCreepsByID(n);if(!(s<0)){var r=t.creeps[s];if(r.curHP>0&&l.rectContainsPoint(r.getBoundingBox(),e)){i=r;break}}}return null==i&&t.superBoss&&l.rectContainsPoint(t.superBoss.getBoundingBox(),e)&&(i=t.superBoss),i},changeMoney:function(e){this.lableMoney.setString(e)},showNextWave:function(e){this.lableCurWave&&this.lableCurWave.setString(String.formatC("%02d",e))},showRandomTower:function(){this.bShowSelGroup=!1;var e=this.getChildByTag(123456+this.nRandomSpriteID);null==e?(e=new l.Sprite("Chance00.png"),this.addChild(e,123456,123456+this.nRandomSpriteID)):(e.setVisible(!0),e.setOpacity(255),e.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("Chance00.png"))),this.nRandomSpriteID++,this.nRandomSpriteID=this.nRandomSpriteID%3,e.setPosition(this.curBuildPoint);for(var t=[],i=1;i<6;++i){r=String.formatC("Random1%d.png",i>2?i-2:i);t.push(l.spriteFrameCache.getSpriteFrame(r))}for(var n=new l.Animation(t,.1),s=[],i=1;i<6;++i){var r=String.formatC("air1%d.png",i);s.push(l.spriteFrameCache.getSpriteFrame(r))}var a=new l.Animation(s,.1);e.runAction(l.sequence(l.delayTime(.5),l.animate(n),l.animate(a),l.callFunc(this.buildRandomTower.bind(this,e)),l.fadeOut(.2)))},buildRandomTower:function(e){for(var t=wr.getModel(),i=t.randomTowers?t.randomTowers.length:0,n=null,s=0;s<i;s++){var r=t.randomTowers[s];if(l.rectContainsPoint(r.rcRange,e.getPosition())){n=r.strTowerType;break}}if(!((i=n?n.length:0)<3)){var a=F()%parseInt(i/3);a=parseInt(n.substr(3*a,2))+J.TBOTTLE-1;var o=e.gridIndex;t.addTower(e.getPosition(),a,1,1,o),t.playSoundWithType($.MTTOWERBUILD),this.curBuildPoint=l.p(0,0)}},buildTower:function(e,t){var i=wr.getModel();if(t==J.TRANDOM){this.curBuildPoint=e;var n=i.getObjectByType(J.TRANDOM);i.changeMoney(-n.nBuyMoney[0]),this.showRandomTower()}else i.addTower(e,t,1,3),i.towerTask(t);this.changeMoney(i.getAllMoney())},removeFirstAnimation:function(){},ccTouchBegan:function(e,t){var i=wr.getModel(),n=this.convertTouchToNodeSpace(e);if(this._bAnimationOver&&this._spComicStart&&l.rectContainsPoint(this._spComicStart.getBoundingBox(),n)&&(this._animLayer&&(this._animLayer.removeFromParent(),this._animLayer=null,this._spComicStart=null),this._isShowFirstAnimation=!1,i.isHasGuide()&&0==i.bRestart&&this.showGuide()),this._isShowFirstAnimation)return!1;var s=i.gameLayer,r=i.animeLayer,a=r.getChildByTag(2003);if(a&&l.rectContainsPoint(a.getBoundingBox(),n)&&i.isHasGuide()&&0==i.bRestart)return!1;var o=nr.share().getMapOffset(),h=i.szTileRng,d=Math.floor((n.x-25-o.width)/h.width),c=Math.floor(n.y/h.height),u=l.p((d+.5)*h.width+25+o.width,(c+.5)*h.height);if(this.bGiftBoxDrop&&this.IsGiftBoxClick(n))return this.PickUpGiftBox(),this.bGiftBoxDrop=!1,!0;var p=i.getAllMoney(),m=s.updateTower(n);if(m>0){if(2==m?this.changeMoney(i.getAllMoney()):i.playSoundWithType($.MTTOWERDESELECT),i.curShowPlayerGuid==re.PLAYEDGUIDE)if(2==m&&p>i.getAllMoney())(w=r.getChildByTag(1001))&&w.setVisible(!1),(w=r.getChildByTag(1002))&&w.setVisible(!1),this.nGuidStep=3,i.curShowPlayerGuid=re.UNKNOWGUIDE,this.changeGuidTips(),GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&SDKInterface.logEvent&&SDKInterface.logEvent("GuidTipsUpTower");else{if(w=r.getChildByTag(1001)){v=i.buildspace[0];w.setPosition(l.pAdd(l.p(v.x,v.y),l.p(.5*v.width,.5*v.height)))}if(w=r.getChildByTag(1002)){w.setVisible(!0),w.stopAllActions(),w.setPosition(l.pAdd(l.p(v.x,v.y),l.p(.2*v.width+30,v.height-30)));A=l.moveBy(.6,-30,30);w.runAction(l.repeatForever(l.sequence(A,A.reverse())))}2==m&&(this.nGuidStep=0,this.changeGuidTips())}return!0}if(this.bottomBarItemOnPos(n))return!0;if(i.curShowPlayerGuid==re.FBPLAYEDGUIDE1)return!0;if(this.bShowSelGroup&&this.selGroup.length>0){var _=!1,g=!1,T=!0;for(var f in this.selGroup){var S=this.selGroup[f];if(l.pDistance(S.getPosition(),n)<=.71*S.width){S.nCurLevel>0?(_=!0,T=!1,this.selGroup.length&&(i.usersData.towerBuild++,this.buildTower(this.selGroup[this.selGroup.length-1].getPosition(),S.nType))):S.nType==J.UNKNOW&&(i.playSoundWithType($.MTTOWERDESELECT),_=!0),g=!0;break}}if(!_&&g)return!0;this.bShowSelGroup=!1;for(var f in this.selGroup)(S=this.selGroup[f]).nType>J.UNKNOW?S.runAction(l.scaleTo(.12,0)):S.setVisible(!1);if(i.curShowPlayerGuid==re.PLAYEDGUIDE){var w=r.getChildByTag(1001),v=i.buildspace[0];if(w.setPosition(l.pAdd(l.p(v.x,v.y),l.p(.5*v.width,.5*v.height))),T){if(w=r.getChildByTag(1002)){w.setVisible(!0),w.stopAllActions(),w.setPosition(l.pAdd(l.p(v.x,v.y),l.p(.2*v.width+30,v.height-30)));A=l.moveBy(.6,-30,30);w.runAction(l.repeatForever(l.sequence(A,A.reverse())))}}else(w=r.getChildByTag(1002))&&w.setVisible(!1),this.nGuidStep=2,this.changeGuidTips(),GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&SDKInterface.logEvent&&SDKInterface.logEvent("GuidTipsBuildTower")}return!0}if(l.rectContainsPoint(this.rcMenuBG,n))return!0;if(i.bLockMenu&&!i.isHasGuide())return!0;if(i.curShowPlayerGuid!=re.FBPLAYEDGUIDE){var L=this.towerOnPos(n);if(L){if(i.playSoundWithType($.MTTOWERSELECT),s.towerUpdate(L),i.curShowPlayerGuid==re.PLAYEDGUIDE){GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&SDKInterface.logEvent&&SDKInterface.logEvent("Guide Touch Tower");var M=s.selTowerUpdate,C=l.p(0,0);for(var f in M)(S=M[f]).nType==J.TOWERUPDATE?C=S.getPosition():S.nType!=J.TOWERSELL&&S.setVisible(!1);if(w=r.getChildByTag(1002)){w.setVisible(!0),w.stopAllActions(),w.setPosition(l.pAdd(C,l.p(.1*w.width,.05*w.height)));A=l.moveBy(.6,-30,30);w.runAction(l.repeatForever(l.sequence(A,A.reverse()))),(w=r.getChildByTag(1001)).setPosition(C)}}for(f=0;f<i.slideWayBase.length;f++)for(var y=i.slideWayBase[f],B=0;B<y.length;B++){var E=y[B];if(l.rectContainsPoint(E.getBoundingBox(),n)){this.curDragDropIndex=f,this.spDragItem=E;break}}return!0}if(i.curShowPlayerGuid==re.PLAYEDGUIDE){var P=i.buildspace[0];if(l.rectContainsPoint(P,u)){var b=i.getAllMoney();if(i.changeMoney(100-b),this.showBuyTower(n,u,h),(w=r.getChildByTag(1001))&&w.setPosition(this.selGroup[0].getPosition()),w=r.getChildByTag(1002)){w.stopAllActions(),w.setPosition(l.pAdd(this.selGroup[0].getPosition(),l.p(.1*w.width,.05*w.height)));var A=l.moveBy(.6,-30,30);w.runAction(l.repeatForever(l.sequence(A,A.reverse()))),i.changeMoney(b-i.getAllMoney())}GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&SDKInterface.logEvent&&SDKInterface.logEvent("Guide Touch")}return!0}if(i.towers.length>0){var I=this.objectOnPos(n);if(i.curSelGoods&&I==i.curSelGoods){i.animeLayer&&r.showSelPointWithSprite(I,!1),I.bSelect=!1;for(var f in i.towers)if((R=i.towers[f]).define.type==J.TFLASHLIGHT&&R.projectiles&&R.projectiles.length>0){if((D=R.projectiles[0])&&D.bNoRotate)continue;R.changeShoot(I)}else R.changeShoot(I);if(i.curSelGoods==I)return i.curSelGoods=null,!0}if(I){i.curSelGoods=I,I.bSelect=!0,i.animeLayer&&r.showSelPointWithSprite(I,!0);for(var f in i.towers){var R=i.towers[f];if(R.define.type==J.TFLASHLIGHT&&R.projectiles&&R.projectiles.length>0){var D=R.projectiles[0];if(D&&D.bNoRotate)continue;R.changeShoot(I)}else R.changeShoot(I)}return i.playSoundWithType($.MTSHOOTSELECT),!0}}if(n.x<25+o.width||n.x>+o.width+935){if(this.selDisableBuild)this.selDisableBuild.setOpacity(255),this.selDisableBuild.setPosition(n),this.selDisableBuild.setVisible(!0);else{var x=new bt;x.initDisableBuild(n),this.selDisableBuild=x,this.addChild(x,-3)}return i.playSoundWithType($.MTSELECTFAULT),this.selDisableBuild.runAction(l.fadeOut(1)),!0}if(this.showBuyTower(n,u,h))return!0;if(i.m_nGameMode==ge.DOUBLECARROT){if(i.nCarrotHP>=5&&(S=s.getChildByTag(O.TOWERHOUSETAG))&&l.rectContainsPoint(S.getBoundingBox(),n)){this.showCarrotAnimate(1,1);var N=i.usersData.getCarrotFigure(),G=i.gameObjectConfig.allMusics[$.MTCARROT],W=0;return W=N==ue.CARROT_NORMAL?F()%3+1:F()%2+1,i.playSoundWithFile(String.formatC(G,N+1-ue.CARROT_NORMAL,W)),!0}if(i.nSecondCarrotHP>=5&&(S=s.getChildByTag(O.SECONDTOWERHOUSETAG))&&l.rectContainsPoint(S.getBoundingBox(),n)){this.showCarrotAnimate(1,2);var N=i.usersData.getSecondCarrotFigure(),G=i.gameObjectConfig.allMusics[$.MTCARROT],W=0;return W=N==ue.CARROT_NORMAL?F()%3+1:F()%2+1,i.playSoundWithFile(String.formatC(G,N+1-ue.CARROT_NORMAL,W)),!0}}else if(i.nCarrotHP>=10&&(S=s.getChildByTag(O.TOWERHOUSETAG))&&l.rectContainsPoint(S.getBoundingBox(),n)){this.showCarrotAnimate(1);var N=i.usersData.getCarrotFigure(),G=i.gameObjectConfig.allMusics[$.MTCARROT],W=0;return W=N==ue.CARROT_NORMAL?F()%3+1:F()%2+1,i.playSoundWithFile(String.formatC(G,N+1-ue.CARROT_NORMAL,W)),!0}return this.bShowSelGroup||(this.selDisableBuild?(this.selDisableBuild.setPosition(u),this.selDisableBuild.setOpacity(255),this.selDisableBuild.setVisible(!0)):(this.selDisableBuild=new bt,this.selDisableBuild.initDisableBuild(u),this.addChild(this.selDisableBuild,-3)),i.playSoundWithType($.MTSELECTFAULT),this.selDisableBuild.runAction(l.fadeOut(1))),!0}(I=this.objectOnPos(n))&&743==I.x&&490==I.y&&(GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&SDKInterface.logEvent&&SDKInterface.logEvent("Guide CurLv 2"),this.nGuidStep=5,this.changeGuidTips(),i.curSelGoods=I,I.bSelect=!0,r&&r.showSelPointWithSprite(I,!0))},ccTouchMoved:function(e,t){var i=this.convertTouchToNodeSpace(e),n=e.getPreviousLocationInView();n=l.director.convertToGL(n),n=this.convertToNodeSpace(n);var s=l.pSub(i,n);this.spDragItem&&this.DragMove(s)},ccTouchEnded:function(e,t){this.spDragItem=null;var i=this.convertTouchToNodeSpace(e),n=nr.share().getWinSize(),s=l.rect(0,n.height-80,80,80);if(l.rectContainsPoint(s,i)){var r=Math.floor((new Date).getTime()/1e3);if(r-this.m_lastTime<=1?this.m_nTestClick++:this.m_nTestClick=0,this.m_lastTime=r,9==this.m_nTestClick){this.m_nTestClick=0;for(var a,o=wr.getModel(),h=0;h<o.curIndexEnd;h++){var d=o.getIndexOfCreepsByID(h);if(!(d<0)){var c=o.creeps[d],u=c.define;a+=String.formatC("[%s,%ld,%ld,%ld]\n",u.strName,c.nInitHP,c.curHP,c.curHPTOBe)}}alert(a)}}},DragMove:function(e){var t=2,i=wr.getModel(),n=null,s=function(){var e=l.pSub(p.getPosition(),n);for(var t in i.gameLayer.selTowerUpdate){var s=i.gameLayer.selTowerUpdate[t];s.setPosition(l.pAdd(s.getPosition(),e))}i.gameLayer.showUpdateTip(null)};if(this.spDragItem){n=this.spDragItem.getPosition();for(var r,a,o=i.slideWay[this.curDragDropIndex],h=i.slideWayBase[this.curDragDropIndex],d=0;d<o.length-1;d++){var c=o[d],u=o[d+1];if(c&&u)if(r=c,a=u,r.x==a.x){if(this.spDragItem.x==r.x){t=1;break}}else if(r.y==a.y&&this.spDragItem.y==r.y){t=0;break}}var p=this.spDragItem;if(Math.abs(e.x)>=Math.abs(e.y)&&0==t){if(e.x<0)for(m=p.GetIndex()-1;m>=0;m--){g=0;(T=(_=h[m]).GetTower())&&(g=.5*T.height,T.bShowUpdateTip&&(T.bShowUpdateTip=!1,i.animeLayer.hideUpdateTip(l.pAdd(l.p(0,g),T.getPosition()))));if(m==p.GetIndex()-1)f=l.pAdd(_.getPosition(),l.p(e.x,0)),_.SetTempPt(f);else if(v=h[m+1]){if(!((S=v.GetTempPt()).x-70<_.x)){for(w=m+1;w<=p.GetIndex()-1&&!(w>h.length-1);w++)(_=h[w])&&_.SetNewPosition(_.GetTempPt());return void s()}f=l.pAdd(S,l.p(-70,0)),_.SetTempPt(f)}if(0==m)for(w=0;w<=p.GetIndex()-1&&!(w>h.length-1);w++)if(_=h[w],f.x<r.x)if(0==w)_.SetNewPosition(r);else{v=h[w-1];_.SetNewPosition(l.pAdd(v.getPosition(),l.p(70,0)))}else _.SetNewPosition(_.GetTempPt())}else if(e.x>0)for(m=p.GetIndex()-1;m<=h.length-1;m++){g=0;(T=(_=h[m]).GetTower())&&(g=.5*T.height,T.bShowUpdateTip&&(T.bShowUpdateTip=!1,i.animeLayer.hideUpdateTip(l.pAdd(l.p(0,g),T.getPosition()))));if(m==p.GetIndex()-1)f=l.pAdd(_.getPosition(),l.p(e.x,0)),_.SetTempPt(f);else if(v=h[m-1]){if(!((S=v.GetTempPt()).x+70>_.x)){for(w=p.GetIndex()-1;w<m&&!(w>h.length-1);w++)(_=h[w])&&_.SetNewPosition(_.GetTempPt());return void s()}f=l.pAdd(S,l.p(70,0)),_.SetTempPt(f)}if(m==h.length-1)for(w=h.length-1;w>=p.GetIndex()-1&&!(w<0);w--)if(_=h[w],f.x>a.x)if(w==h.length-1)_.SetNewPosition(a);else{v=h[w+1];_.SetNewPosition(l.pAdd(v.getPosition(),l.p(-70,0)))}else _.SetNewPosition(_.GetTempPt())}}else if(Math.abs(e.x)<Math.abs(e.y)&&1==t)if(e.y>0)for(m=p.GetIndex()-1;m>=0;m--){g=0;(T=(_=h[m]).GetTower())&&(g=.5*T.height,T.bShowUpdateTip&&(T.bShowUpdateTip=!1,i.animeLayer.hideUpdateTip(l.pAdd(l.p(0,g),T.getPosition()))));if(m==p.GetIndex()-1)f=l.pAdd(_.getPosition(),l.p(0,e.y)),_.SetTempPt(f);else if(v=h[m+1]){if(!((S=v.GetTempPt()).y+70>_.y)){for(w=m+1;w<=p.GetIndex()-1&&!(w>h.length-1);w++)(_=h[w])&&_.SetNewPosition(_.GetTempPt());return void s()}f=l.pAdd(S,l.p(0,70)),_.SetTempPt(f)}if(0==m)for(w=0;w<=p.GetIndex()-1&&!(w>h.length-1);w++)if(_=h[w],f.y>r.y)if(0==w)_.SetNewPosition(r);else{v=h[w-1];_.SetNewPosition(l.pAdd(v.getPosition(),l.p(0,-70)))}else _.SetNewPosition(_.GetTempPt())}else if(e.y<0)for(var m=p.GetIndex()-1;m<=h.length-1;m++){var _=h[m],g=0,T=_.GetTower();T&&(g=.5*T.height,T.bShowUpdateTip&&(T.bShowUpdateTip=!1,i.animeLayer.hideUpdateTip(l.pAdd(l.p(0,g),T.getPosition()))));var f;if(m==p.GetIndex()-1)f=l.pAdd(_.getPosition(),l.p(0,e.y)),_.SetTempPt(f);else if(v=h[m-1]){var S=v.GetTempPt();if(!(S.y-70<_.y)){for(w=p.GetIndex()-1;w<m&&!(w>h.length-1);w++)(_=h[w])&&_.SetNewPosition(_.GetTempPt());return void s()}f=l.pAdd(S,l.p(0,-70)),_.SetTempPt(f)}if(m==h.length-1)for(var w=h.length-1;w>=p.GetIndex()-1&&!(w<0);w--)if(_=h[w],f.y<a.y)if(w==h.length-1)_.SetNewPosition(a);else{var v=h[w+1];_.SetNewPosition(l.pAdd(v.getPosition(),l.p(0,70)))}else _.SetNewPosition(_.GetTempPt())}s()}},showCarrotAnimate:function(e,t){if(void 0!=t||void 0!=e){void 0==t&&e&&(t=e,e=0),void 0===e&&(e=0);var i=wr.getModel(),n=i.nCarrotHP;if(1!=t&&i.m_nGameMode==ge.DOUBLECARROT&&(n=i.nSecondCarrotHP),!(n<1)&&i.gameLayer){var s=i.bLockMenu,r=F()%12+2,a=i.usersData.getCarrotFigure();1!=t&&i.m_nGameMode==ge.DOUBLECARROT&&(a=i.usersData.getSecondCarrotFigure());var o=i.gameLayer.getChildByTag(1==t?O.TOWERHOUSETAG:i.m_nGameMode==ge.DOUBLECARROT?O.SECONDTOWERHOUSETAG:O.TOWERHOUSETAG),h=i.gameObjectConfig.objectGroup[J.TOWERHOUSE];if(i.m_nGameMode==ge.DOUBLECARROT)a==ue.CARROT_GIRL||a==ue.CARROT_OLD?(d=o).bInShootting&&(s=!0):a!=ue.CARROT_FAT&&n>5&&(n=5);else if(a==ue.CARROT_GIRL||a==ue.CARROT_OLD){var d=o;d.bInShootting&&(s=!0)}else a!=ue.CARROT_FAT&&n>10&&(n=10);a+=1-ue.CARROT_NORMAL,i.m_nGameMode==ge.DOUBLECARROT&&(5==n?n*=2:n=2*n+1);var c=String.formatC(h.strPic,a,3==a?n>(i.m_nGameMode==ge.DOUBLECARROT?6:11)?61:n==(i.m_nGameMode==ge.DOUBLECARROT?6:11)?41:n:n),u=l.spriteFrameCache.getSpriteFrame(c);if(u&&o.setSpriteFrame(u),s){T=t;this.runAction(l.sequence(l.delayTime(r),l.callFunc(this.showCarrotAnimate.bind(this,T))))}else if(1!=e&&(e=F()%3+1),o.stopAllActions(),o.setRotation(0),a==ue.CARROT_FAT&&n>(i.m_nGameMode==ge.DOUBLECARROT?5:10)&&2!=e){a+=1-ue.CARROT_NORMAL;for(var p=[],m=0;m<7;++m){var _=m;6==m&&(_=0);f=String.formatC(h.strPic,a,(n>(i.m_nGameMode==ge.DOUBLECARROT?6:11)?61:41)+_%3);(u=l.spriteFrameCache.getSpriteFrame(f))&&p.push(u)}var g=new l.Animation(p,.06),T=t;o.runAction(l.sequence(l.animate(g),l.delayTime(r),l.callFunc(this.showCarrotAnimate.bind(this,T))))}else switch(e){case 1:if(n>=(i.m_nGameMode==ge.DOUBLECARROT?5:10)){for(var p=[],m=11;m<19;++m){f=String.formatC(h.strPic,a,m);(u=l.spriteFrameCache.getSpriteFrame(f))&&p.push(u)}(g=new l.Animation(p,.06)).setRestoreOriginalFrame(!0);T=t;o.runAction(l.sequence(l.animate(g),l.delayTime(r),l.callFunc(this.showCarrotAnimate.bind(this,T))))}else{T=t;o.runAction(l.sequence(l.delayTime(r),l.callFunc(this.showCarrotAnimate.bind(this,T))))}break;case 2:if(n>3){T=t;o.runAction(l.sequence(l.rotateTo(.2,-25),l.delayTime(.05),l.rotateTo(.4,8),l.delayTime(.08),l.rotateTo(.4,-25),l.delayTime(.08),l.rotateTo(.4,8),l.delayTime(.08),l.rotateTo(.4,-25),l.delayTime(.08),l.rotateTo(.4,8),l.delayTime(.08),l.rotateTo(.4,-25),l.delayTime(.08),l.rotateTo(.2,0),l.delayTime(r),l.callFunc(this.showCarrotAnimate.bind(this,T))))}break;case 3:if(n>=(i.m_nGameMode==ge.DOUBLECARROT?5:10)){for(var p=[],m=21;m<24;++m){var f=String.formatC(h.strPic,a,m);(u=l.spriteFrameCache.getSpriteFrame(f))&&p.push(u)}T=t;(g=new l.Animation(p,.07)).setRestoreOriginalFrame(!0),o.runAction(l.sequence(l.animate(g),l.animate(g),l.delayTime(r),l.callFunc(this.showCarrotAnimate.bind(this,T))))}else{T=t;o.runAction(l.sequence(l.delayTime(r),l.callFunc(this.showCarrotAnimate.bind(this,T))))}}}}},showBuyTower:function(e,t,i){var n=!1,s=wr.getModel(),r=s.curMapConfig.towerType;if(1==r.length&&r[0]==J.TRANDOM)for(c=0;c<3;c++){var a=this.getChildByTag(123456+c);if(a&&a.getOpacity()>0&&l.rectContainsPoint(a.getBoundingBox(),e))return!0}if(l.pointEqualToPoint(this.curBuildPoint,t))return!0;if(!s.gameLayer.canBuildOnTilePosition(e)&&this.curBuildPoint.x==t.x&&this.curBuildPoint.y==t.y)return!0;for(var o in s.buildspace){y=C=s.buildspace[o];if(l.rectContainsPoint(y,t)){this.bShowSelGroup=!0;F=4;(B=r.length)>8&&(F=parseInt((B+1)/2));var h=parseInt(i.width),d=parseInt(1.2*i.height),c=0,u=.3,p=!1,m=parseInt((B+F-1)/F),_=parseInt(.5*(m+1)),g=(m>1?F:B)*(1+u)-u;if((E=l.p(t.x-(.5*g-.5)*h,t.y+d)).x<h?E.x=u*h+.5*h:E.x+g*h>this.rcMenuBG.width&&(E.x=this.rcMenuBG.width-(g+u-.5)*h),t.y+(1+_)*d>this.rcMenuBG.y?(E.y-=2*d,p=!0):m>1&&(E.y+=(m-1)*d,p=!0),s.playSoundWithType($.MTTOWERSELECT),!this.selGroup||this.selGroup.length<1){this.selGroup=[];for(var T in r){P=r[T];(b=new bt).initTowerSPWithType(P);var f=parseInt(c/F),S=p?-f:f<_?-f:-f-1,w=l.p(c%F*h*(1+u),S*d);b.setPosition(l.pAdd(E,w)),s.animeLayer.addChild(b,ee.SELGROUPCHILD),this.selGroup.push(b),c++}(b=new bt).initCenterSprite(),b.setPosition(t),s.animeLayer.addChild(b,ee.SELGROUPCHILD),this.selGroup.push(b)}c=0;for(var T in this.selGroup)if((b=this.selGroup[T]).nType>J.UNKNOW){var f=parseInt(c/F),w=l.p(c%F*h*(1+u),(p?-f:f<_?-f:-f-1)*d);b.setPosition(l.pAdd(E,w)),b.changePicWithMoney(b.nType,null),b.setScale(.1),b.runAction(l.scaleTo(.12,1)),c++}else b.setVisible(!0),b.setPosition(t);n=!0;break}}for(var v in s.slideWayBase){var L=s.slideWayBase[v];for(var M in L){var C=L[M],y=C.getBoundingBox();if(t=C.getPosition(),l.rectContainsPoint(y,e)){this.bShowSelGroup=!0;var B=r.length,F=4;B>8&&(F=parseInt((B+1)/2));var h=i.width,d=1.2*i.height,c=0,u=.3,p=!1,m=parseInt((B+F-1)/F),_=parseInt(.5*(m+1)),g=(m>1?F:B)*(1+u)-u,E=l.p(t.x-(.5*g-.5)*h,t.y+d);if(E.x<h?E.x=u*h+.5*h:E.x+g*h>this.rcMenuBG.width&&(E.x=this.rcMenuBG.width-(g+u-.5)*h),t.y+(1+_)*d>this.rcMenuBG.y?(E.y-=2*d,p=!0):m>1&&(E.y+=(m-1)*d,p=!0),s.playSoundWithType($.MTTOWERSELECT),!this.selGroup||this.selGroup.length<1){this.selGroup=[];for(var T in r){var P=r[T];(b=new bt).initTowerSPWithType(P);var f=parseInt(c/F),S=parseInt(p?-f:f<_?-f:-f-1),w=l.p(c%F*h*(1+u),S*d);b.setPosition(l.pAdd(E,w)),s.animeLayer.addChild(b,ee.SELGROUPCHILD),this.selGroup.push(b),c++}(b=new bt).initCenterSprite(),b.setPosition(t),s.animeLayer.addChild(b,ee.SELGROUPCHILD),this.selGroup.push(b)}c=0;for(var T in this.selGroup){var b=this.selGroup[T];if(b.nType>J.UNKNOW){var f=parseInt(c/F),w=l.p(c%F*h*(1+u),(p?-f:f<_?-f:-f-1)*d);b.setPosition(l.pAdd(E,w)),b.changePicWithMoney(b.nType,null),b.setScale(.1),b.runAction(l.scaleTo(.12,1)),c++}else b.setVisible(!0),b.setPosition(t)}n=!0;break}}}return n},registerWithTouchDispatcher:function(e){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},keyBackClicked:function(){this.showMenu()},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),this.removeAllChildrenWithCleanup(!0),l.audioEngine.setMusicVolume(1),qu.clearOwner(this),this._super()},showBossHPBar:function(e){var t=nr.share().getWinSize(),i=wr.getModel().getObjectByType(J.BOSSHPBG),n=String.formatC(i.strPic,1),s=l.spriteFrameCache.getSpriteFrame(n);null!=s&&(this.bossHPBG=new l.Sprite(s),this.bossHPBG.setAnchorPoint(.5,1),this.bossHPBG.setPosition(.5*t.width,t.height),this.addChild(this.bossHPBG,31,J.BOSSHPBG),n=String.formatC(i.strPic,2),(s=l.spriteFrameCache.getSpriteFrame(n))&&(this.bossHPNumStrech=new l.Sprite(s),this.bossHPNumStrech.setAnchorPoint(1,0),this.bossHPNumStrech.setPosition(.96*this.bossHPBG.width,0),this.bossHPNumStrech.setScaleX(0),this.bossHPBG.addChild(this.bossHPNumStrech,1)))},hideBossHPBar:function(){this.isGameWait=!0,this.bossHPNumStrech&&this.bossHPNumStrech.setOpacity(0),this.bossHPBG&&(this.bossHPBG.setOpacity(0),this.bossHPBG.stopAllActions(),this.removeChild(this.bossHPBG,!0),this.bossHPBG=null),this.lableCurWave&&(this.lableCurWave.stopAllActions(),this.lableCurWave.setOpacity(255),this.lableCurWave.setScale(1),this.lableCurWave.setRotation(0),this.lableCurWave.setPosition(this.wavept)),this.lableWaves&&(this.lableWaves.stopAllActions(),this.lableWaves.setOpacity(255),this.lableWaves.setScale(1),this.lableWaves.setRotation(0),this.lableWaves.setPosition(this.wavept2));var e=this.getChildByTag(J.MENUCENTER);e&&(e.stopAllActions(),e.setOpacity(255),e.setScale(1),e.setRotation(0),e.setPosition(this.centpt));var t=this.getChildByTag(J.MENUBTN);if(t){var i=t.getChildByTag(tn.SpeedMenu);i&&(i.stopAllActions(),i.setOpacity(255),i.setScale(1),i.setRotation(0),i.setPosition(this.speedpt))}},showTopHPBar:function(e){this.fOldCurTopBarHpPer=1;var t=wr.getModel(),i=nr.share().getWinSize();if(e==sn.HPBAR_GATE){this.nHPBarStyle=sn.HPBAR_GATE,qu.addRes(this,"res/Themes/Items/GateItems-hd.plist");var n=t.usersData.m_nLanguage,s=String.formatC("res/Themes%s/Items/GateItems-hd%s.plist",n,n);qu.addRes(this,s),this.topHPBarBG=new l.Sprite("gate_toptoolbar_back.png"),this.topHPBarBG.setPosition(nr.share().getMapOffset().width+this.topHPBarBG.width/2,i.height-this.topHPBarBG.height/2),this.addChild(this.topHPBarBG,31,J.BOSSHPBG),this.topHPBarProgress=new l.Sprite("gate_progress.png"),this.topHPBarProgress.setAnchorPoint(0,.5),this.topHPBarProgress.setPosition(201,49),this.topHPBarBG.addChild(this.topHPBarProgress,1),(r=new l.Sprite("gate_toptoolbar_face.png")).setPosition(this.topHPBarBG.width/2,this.topHPBarBG.height/2),r.setAnchorPoint(.5,.5),this.topHPBarBG.addChild(r,2)}else if(e==sn.HPBAR_NORMALBOSS){this.nHPBarStyle=sn.HPBAR_NORMALBOSS,qu.addRes(this,"res/Themes/Items/BossItems-hd.plist"),this.topHPBarBG=new l.Sprite("boss_toptoolbar_back.png"),this.topHPBarBG.setPosition(nr.share().getMapOffset().width+this.topHPBarBG.width/2,i.height-this.topHPBarBG.height/2),this.addChild(this.topHPBarBG,31,J.BOSSHPBG),this.topHPBarProgress=new l.Sprite("boss_progress.png"),this.topHPBarProgress.setAnchorPoint(0,.5),this.topHPBarProgress.setPosition(this.topHPBarBG.width/2-this.topHPBarProgress.width/2,this.topHPBarBG.height/2+8),this.topHPBarBG.addChild(this.topHPBarProgress,1);var r=new l.Sprite("boss_toptoolbar_face.png");r.setPosition(this.topHPBarBG.width/2,this.topHPBarBG.height/2),r.setAnchorPoint(.5,.5),this.topHPBarBG.addChild(r,2);var a=String.formatC("boss_monster_%lu.png",t.curLevel);if(l.spriteFrameCache.getSpriteFrame(a)){var o=new l.Sprite(a);o.setPosition(this.topHPBarBG.width/2,this.topHPBarBG.height/2),o.setAnchorPoint(.5,.5),this.topHPBarBG.addChild(o,3)}}else e==sn.HPBAR_FINALBOSS&&(this.nHPBarStyle=sn.HPBAR_FINALBOSS)},changeTopHPBar:function(e){var t=this.fOldCurTopBarHpPer-e;if(t>.004){this.fOldCurTopBarHpPer-=t;var i=null;if(this.nHPBarStyle==sn.HPBAR_GATE?i=l.spriteFrameCache.getSpriteFrame("gate_progress.png"):this.nHPBarStyle==sn.HPBAR_NORMALBOSS?i=l.spriteFrameCache.getSpriteFrame("boss_progress.png"):(this.nHPBarStyle,sn.HPBAR_FINALBOSS),i){this.topHPBarProgress.setSpriteFrame(i);var n=this.topHPBarProgress.width,s=this.topHPBarProgress.getTextureRect();this.topHPBarProgress.setTextureRect(l.rect(s.x,s.y,s.width*this.fOldCurTopBarHpPer,s.height)),this.nHPBarStyle==sn.HPBAR_GATE?this.topHPBarProgress.setPosition(201,49):this.topHPBarProgress.setPosition(this.topHPBarBG.width/2-n/2,this.topHPBarBG.height/2+8)}}},dropBigbomb:function(e){var t=wr.getModel();switch(e){case 1:if(t.superBoss){(g=t.superBoss).hideSlowActions(ar.ESNOW),g.addSpriteWithPicPath(t.getObjectByType(J.TFISH),ar.EICE,!0);T=new Pe(1e-7,1,0,8,0);g.SlowMoveWithPer(T),this.schedule(this.IcePropLastTime,8)}break;case 2:if(t.superBoss){0==(g=t.superBoss).isSlowActionWithType(ar.EMOON)&&g.curHP>0&&g.addSpriteWithPicPath(t.getObjectByType(J.TICEFAN),ar.ECOOLFAN,!0,!0);T=new Pe(.25,1,0,this.nSlowPropLast,0);g.SlowMoveWithPer(T)}break;case 3:for(var i in t.towers)t.towers[i].showSpeedFlashWithTower();return t.nSpeedMultiples=.5,void this.schedule(this.stopTowerSpeedMultiples,10);case 4:if(t.m_nGameMode==ge.DOUBLECARROT){h=t.nCarrotHP;t.nCarrotHP+=1;c=String.formatC("%ld",t.nCarrotHP);t.gameLayer.houselife.setString(c);d=t.usersData.getCarrotFigure();if(h<5){h++;c=String.formatC("%ld",t.nCarrotHP);h=d==ue.CARROT_FAT&&6==t.nCarrotHP?41:2*h+1;u=t.gameObjectConfig.objectGroup[J.TOWERHOUSE];if(c=String.formatC(u.strPic,d-ue.CARROT_NORMAL+1,h),p=l.spriteFrameCache.getSpriteFrame(c)){(m=t.gameLayer.house).stopAllActions(),m.setRotation(0),m.setSpriteFrame(p);var n=F()%12+2,s=1;m.runAction(l.sequence(l.delayTime(n),l.callFunc(this.showCarrotAnimate.bind(this,s))))}}var r=t.nSecondCarrotHP;t.nSecondCarrotHP+=1;var a=String.formatC("%ld",t.nSecondCarrotHP);t.gameLayer.m_secondHouseLife.setString(a);var o=t.usersData.getSecondCarrotFigure();if(r<5||o==ue.CARROT_FAT&&r<7){r++;c=String.formatC("%ld",t.nSecondCarrotHP);r=o==ue.CARROT_FAT&&6==t.nSecondCarrotHP?41:r%2==0&&r<5?2*r+1:5==r?r:2*r+1;u=t.gameObjectConfig.objectGroup[J.TOWERHOUSE];if(c=String.formatC(u.strPic,o-ue.CARROT_NORMAL+1,r),p=l.spriteFrameCache.getSpriteFrame(c)){(m=t.gameLayer.m_secondHouse).stopAllActions(),m.setRotation(0),m.setSpriteFrame(p);var n=F()%12+2,s=2;m.runAction(l.sequence(l.delayTime(n),l.callFunc(this.showCarrotAnimate.bind(this,s))))}}}else{var h=t.nCarrotHP;t.nCarrotHP+=1;c=String.formatC("%ld",t.m_nGameMode==ge.CHALLENGEMODE?t.nCarrotHP-7:t.nCarrotHP);t.gameLayer.houselife.setString(c);var d=t.usersData.getCarrotFigure();if(h<10||d==ue.CARROT_FAT&&h<12){h++;var c=String.formatC("%ld",t.nCarrotHP);d==ue.CARROT_FAT&&11==t.nCarrotHP?h=41:h%2==0&&h<10&&(h+=1);var u=t.gameObjectConfig.objectGroup[J.TOWERHOUSE];c=String.formatC(u.strPic,d-ue.CARROT_NORMAL+1,h);var p=l.spriteFrameCache.getSpriteFrame(c);if(p){var m=t.gameLayer.house;m.stopAllActions(),m.setRotation(0),m.setSpriteFrame(p);n=F()%12+2;m.runAction(l.sequence(l.delayTime(n),l.callFunc(this.showCarrotAnimate,this)))}}}return}for(i=0;i<t.curIndexEnd;i++){var _=t.getIndexOfCreepsByID(i);if(!(_<0||_>=t.creeps.length)){var g=t.creeps[_];switch(e){case 1:g.hideSlowActions(ar.ESNOW),g.addSpriteWithPicPath(t.getObjectByType(J.TFISH),ar.EICE,!0);T=new Pe(1e-7,1,0,8,0);g.SlowMoveWithPer(T);break;case 2:if(0==g.isSlowActionWithType(ar.EMOON)&&g.curHP>0){g.addSpriteWithPicPath(t.getObjectByType(J.TICEFAN),ar.ECOOLFAN,!0,!0);var T=new Pe(.25,1,0,this.nSlowPropLast,0);g.SlowMoveWithPer(T)}break;case 5:g.curHPTOBe=g.curHP=1,g.beShootWithTower(t.getObjectByType(J.TROCKET),2,1,!1)}}}1==e&&(t.bCreepStopCome=!0,this.schedule(this.IcePropLastTime,8))},showMessMenu:function(){var e=wr.getModel(),t=this.getParent();this.registerWithTouchDispatcher(!1),qu.loadResAsync(yi,function(){var i=rp.create();e.bLockMenu=!0,t.addChild(i,4,4)})},showMenu:function(){var e=wr.getModel();if(!(e.bLockMenu||e.curLevelResult>0))if(e.isPlayMess())this.showMessMenu();else{e.bLockMenu=!0,this.registerWithTouchDispatcher(!1),e.playMuiscWithType($.MTWARBGMSC,3);var t=this.getParent(),i=t.getChildByTag(4),n=!1;0==l.director.getScheduler().isWaite&&(l.director.getScheduler().isWaite=!0,n=!0),i?i.showWnd(!0):qu.loadResAsync(Ri,function(){i=An.create(),t.addChild(i,4,4),i.showWnd(!0),i.bWait=n})}},actionShowMenu:function(){var e=l.callFunc(this.showMenu,this);e&&(e.setTag(-1),this.runAction(e))},removePopMenu:function(){this.unschedule(this.removePopMenu);var e=this.getParent(),t=e.getChildByTag(4);t&&e.removeChild(t,!0)},buyBombByTag:function(e){var t=wr.getModel();if(!t.bLockMenu){var i=!0;1==l.director.getScheduler().isWaite?i=!1:l.director.getScheduler().isWaite=!0,qu.loadResAsync(_i,function(){var n=Kc.create();t.animeLayer.addChild(n,9999),n.ShowProp(e),i||(n.isWait=i)})}},bottomBarItemOnPos:function(e){var t=wr.getModel(),i=t.usersData;if(t.gameLayer&&t.gameLayer.getLayerName(),null==this.bottomBar)return!1;if(t.bLockMenu&&0==this.nGuidStep)return!0;var n=t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.getGiveMagicType():t.mapCompose.getGiveMagicType(),s=t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.getGiveCount():t.mapCompose.getGiveCount(),r=this.bottomBar.getChildren();for(var a in r){var o=r[a],h=o.getPosition(),d=o.getContentSize(),c=l.rect(nr.share().getMapOffset().width+h.x-d.width/2,h.y-d.height/2,d.width,d.height),u=o.getTag();if(l.rectContainsPoint(c,e)&&-1!=u){var p=o;if(u==pe.BOTTOM_BAR_BOSSMODETIME)return!0;if(u==pe.BOTTOM_BAR_MISSION){t.playSoundWithType($.MTPAGESELECT),t.curShowPlayerGuid==re.FBPLAYEDGUIDE1&&(GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&SDKInterface.logEvent&&SDKInterface.logEvent("Guide CurLv 3"),this.nGuidStep=5,this.changeGuidTips());var m=bo.create();return t.animeLayer.addChild(m,9999),m.closeBack=function(){t.curShowPlayerGuid==re.FBPLAYEDGUIDE1&&(t.curShowPlayerGuid=t.curShowPlayerGuid1,t.gameLayer.showGuide())},1==l.director.getScheduler().isWaite?m.isWait=!1:l.director.getScheduler().isWaite=!0,!0}if(p.bOnTiming||p.isLocked||p.isForbidden)return!0;var _=null,g=0,T=t.animeLayer,f=0;switch(u){case pe.BOTTOM_BAR_ICE:S=!1;if(n==fe.STOPBB&&s>0&&(this.nSlowPropLast>1&&(this.nSlowPropLast=1,this.unschedule(this.SlowPropLastTime)),t.bCreepStopCome=!0,this.dropBigbomb(1),T.showPropMagic("ice"),t.playSoundWithType($.MTPROPICE),0==(g=t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.subGiveCountLeft():t.mapCompose.subGiveCountLeft())?(g=i.getStopBBCount(),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_ICE)):this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_ICE,!0),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarICE02.png")),Tt.onUse("freeze",1),S=!0),!S){if(0==(g=i.getStopBBCount()))return this.buyBombByTag(u),!0;this.nSlowPropLast>1&&(this.nSlowPropLast=1,this.unschedule(this.SlowPropLastTime)),f=4,g=i.addStopBB(-1,!0),t.bCreepStopCome=!0,this.dropBigbomb(1),T.showPropMagic("ice"),t.playSoundWithType($.MTPROPICE),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_ICE),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarICE02.png")),Tt.onUse("freeze",1)}break;case pe.BOTTOM_BAR_SLOW:S=!1;if(n==fe.SLOWBB&&s>0&&(t.bCreepStopCome||(this.dropBigbomb(2),this.nSlowPropLast=10,this.schedule(this.SlowPropLastTime,1)),T.showPropMagic("slow"),t.playSoundWithType($.MTPROPSLOW),0==(g=t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.subGiveCountLeft():t.mapCompose.subGiveCountLeft())?(g=i.getSlowBBCount(),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_SLOW)):this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_SLOW,!0),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarSlow02.png")),Tt.onUse("slow",1),S=!0),!S){if(0==(g=i.getSlowBBCount()))return this.buyBombByTag(u),!0;f=5,g=i.addSlowBB(-1,!0),t.bCreepStopCome||(this.dropBigbomb(2),this.nSlowPropLast=10,this.schedule(this.SlowPropLastTime,1)),T.showPropMagic("slow"),t.playSoundWithType($.MTPROPSLOW),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_SLOW),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarSlow02.png")),Tt.onUse("slow",1)}break;case pe.BOTTOM_BAR_SPEED:S=!1;if(n==fe.SHOOTBB&&s>0&&(this.dropBigbomb(3),T.showPropMagic("speed"),t.playSoundWithType($.MTPROPSPEED),0==(g=t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.subGiveCountLeft():t.mapCompose.subGiveCountLeft())?(g=i.getShootSPCount(),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_SPEED)):this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_SPEED,!0),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarSpeed02.png")),Tt.onUse("speed",1),S=!0),!S){if(0==(g=i.getShootSPCount()))return this.buyBombByTag(u),!0;f=3,g=i.addShootSP(-1,!0),this.dropBigbomb(3),T.showPropMagic("speed"),t.playSoundWithType($.MTPROPSPEED),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_SPEED),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarSpeed02.png")),Tt.onUse("speed",1)}break;case pe.BOTTOM_BAR_BLOOD:S=!1;if(n==fe.ADDHPBB&&s>0&&(T.showPropMagic("blood"),t.playSoundWithType($.MTPROPBLOOD),0==(g=t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.subGiveCountLeft():t.mapCompose.subGiveCountLeft())?(g=i.getCarrotHPCount(),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_BLOOD)):this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_BLOOD,!0),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarBlood02.png")),Tt.onUse("blood",1),S=!0),!S){if(0==(g=i.getCarrotHPCount()))return this.buyBombByTag(u),!0;f=2,g=i.addCarrotHP(-1,!0),T.showPropMagic("blood"),t.playSoundWithType($.MTPROPBLOOD),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_BLOOD),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarBlood02.png")),Tt.onUse("blood",1)}break;case pe.BOTTOM_BAR_BOMB:var S=!1;if(n==fe.CLEARBB&&s>0&&(T.showPropMagic("bomb"),t.playSoundWithType($.MTPROPBOMB),0==(g=t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.subGiveCountLeft():t.mapCompose.subGiveCountLeft())?(g=i.getClearBBCount(),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_BOMB)):this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_BOMB,!0),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarBomb02.png")),Tt.onUse("bomb",1),S=!0),!S){if(0==(g=i.getClearBBCount()))return this.buyBombByTag(u),!0;f=1,g=i.addClearBB(-1,!0),T.showPropMagic("bomb"),t.playSoundWithType($.MTPROPBOMB),0==g&&(_=l.spriteFrameCache.getSpriteFrame("BarBomb02.png")),this.UpdateBarItemCounter(g,pe.BOTTOM_BAR_BOMB),Tt.onUse("bomb",1)}}return 0!=f&&(l.log("use propid:"+f),t.addCostprops(f)),p.onTiming(),_&&p.setSpriteFrame(_),!0}}return!1},stopTowerSpeedMultiples:function(){this.unschedule(this.stopTowerSpeedMultiples),wr.getModel().nSpeedMultiples=1},buyBarItem:function(e,t,i){var n=wr.getModel().usersData;if(dp);else switch(this.UpdateBarItemCounter(e,t,i),t){case 100:n.addClearBB(this.nBuy),n.DLClearBB-=this.nBuy,n.GMClearBB+=this.nBuy;break;case 101:n.addCarrotHP(this.nBuy),n.DLCarrotHP-=this.nBuy,n.GMCarrotHP+=this.nBuy;break;case 102:n.addShootSP(this.nBuy),n.DLShootSP-=this.nBuy,n.GMShootSP+=this.nBuy;break;case 103:n.addStopBB(this.nBuy),n.DLStopBB-=this.nBuy,n.GMStopBB+=this.nBuy;break;case 104:n.addSlowBB(this.nBuy),n.DLSlowBB-=this.nBuy,n.GMSlowBB+=this.nBuy}},UpdateBarItemCounter:function(e,t,i){var n,s=null,r=wr.getModel(),a=r.usersData.m_nLanguage,o=String.formatC("res/Themes%s/Items/Items02-hd%s.plist",a,a);qu.addRes(this,o);var h=String.formatC("BottomBarItem_%lu",t),d=this.dictBarCounterObjects[h];d&&d.isVisible()&&(delete this.dictBarCounterObjects[h],d.getParent().removeChild(d,!0));var c=this.bottomBar.getChildByTag(t),u=null;switch(t){case 100:u=0==e?l.spriteFrameCache.getSpriteFrame("BarBomb02.png"):l.spriteFrameCache.getSpriteFrame("BarBomb01.png");break;case 101:u=0==e?l.spriteFrameCache.getSpriteFrame("BarBlood02.png"):l.spriteFrameCache.getSpriteFrame("BarBlood01.png");break;case 102:u=0==e?l.spriteFrameCache.getSpriteFrame("BarSpeed02.png"):l.spriteFrameCache.getSpriteFrame("BarSpeed01.png");break;case 103:u=0==e?l.spriteFrameCache.getSpriteFrame("BarICE02.png"):l.spriteFrameCache.getSpriteFrame("BarICE01.png");break;case 104:u=0==e?l.spriteFrameCache.getSpriteFrame("BarSlow02.png"):l.spriteFrameCache.getSpriteFrame("BarSlow01.png")}u&&c.setSpriteFrame(u);var p=this.dictBarCounterObjectsBG[h];if(p)if(p.removeAllChildren(),i){m=l.spriteFrameCache.getSpriteFrame("BarCounterBG_floor.png");p.setSpriteFrame(m);h=String.formatC("BarCounterBG_floor_%ld.png",e);(c=new l.Sprite(h)).setPosition(p.width/2,p.height/2),p.addChild(c)}else{var m=l.spriteFrameCache.getSpriteFrame("BarCounterBG.png");p.setSpriteFrame(m);var _=r.getObjectByType(J.BARITEMNUMOVER),g=r.getObjectByType(J.BARITEMNUMUNDER);_.szTile,g.szTile;if(e>99){var T=new l.Sprite("BarCounter03.png");T.setPosition(450+110*(t-100),60),this.bottomBar.addChild(T,ft.Z5),this.dictBarCounterObjects[h]=T}else if(e>0&&e<=99){var f;e<10&&e>0?(s=g,n=g.szTile,f=l.p(443+110*(t-100),51)):e>=10&&e<=99&&(s=_,n=_.szTile,f=l.p(437+110*(t-100),53));var S=new l.LabelAtlas("00",s.strPic,n.width,n.height,"./0123456789");S.setString(String.formatC("%ld",e)),S.setPosition(f),this.bottomBar.addChild(S,ft.Z5),this.dictBarCounterObjects[h]=S}else if(0==e){var w=new l.Sprite("BarCounter00.png");w.setPosition(450+110*(t-100),58),this.bottomBar.addChild(w,ft.Z5),this.dictBarCounterObjects[h]=w}}},GetDropItem:function(){var e=wr.getActivedModel();if(e){var t=0;switch(this.curDropItem){case pe.BOTTOM_BAR_BOMB:t=e.usersData.getClearBBCount();break;case pe.BOTTOM_BAR_BLOOD:t=e.usersData.getCarrotHPCount();break;case pe.BOTTOM_BAR_SPEED:t=e.usersData.getShootSPCount();break;case pe.BOTTOM_BAR_ICE:t=e.usersData.getStopBBCount();break;case pe.BOTTOM_BAR_SLOW:t=e.usersData.getSlowBBCount()}this.UpdateBarItemCounter(t,this.curDropItem),this.curDropItem=0}},showIceLastMagic:function(){var e=nr.share().getWinSize(),t=this.getChildByTag(Ji+1);null==t?(t=new l.Sprite("magic_ice_topleft.png"),this.addChild(t,29,Ji+1)):t.setVisible(!0),t.setPosition(t.width/2,e.height-t.height/2),t.runAction(l.sequence(l.delayTime(8),l.moveTo(.2,-t.width/2,e.height+t.height/2),l.hide()));var i=this.getChildByTag(Ji+2);null==i?(i=new l.Sprite("magic_ice_topright.png"),this.addChild(i,29,Ji+2)):i.setVisible(!0),i.setPosition(e.width-i.width/2,e.height-i.height/2),i.runAction(l.sequence(l.delayTime(8),l.moveTo(.2,e.width+i.width/2,e.height+i.height/2),l.hide()));var n=this.getChildByTag(Ji+3);null==n?(n=new l.Sprite("magic_ice_botleft.png"),this.addChild(n,29,Ji+3)):n.setVisible(!0),n.setPosition(n.width/2,n.height/2),n.runAction(l.sequence(l.delayTime(8),l.moveTo(.2,-n.width/2,-n.height/2),l.hide()));var s=this.getChildByTag(Ji+4);null==s?(s=new l.Sprite("magic_ice_botright.png"),this.addChild(s,29,Ji+4)):s.setVisible(!0),s.setPosition(e.width-s.width/2,s.height/2),s.runAction(l.sequence(l.delayTime(8),l.moveTo(.2,e.width+s.width/2,-s.height/2),l.hide()))},playGameMusic:function(){var e=wr.getModel();e.BgMusicVolumeSinkInto=0;var t=e.mapConfig.allLevels[e.curLevel-1];l.audioEngine.setMusicVolume(0),e.waypoints2.length?e.playMuiscWithType($.MTGAMES2WAY,1):e.bLoopPath?e.playMuiscWithType($.MTGAMESBOSS,1):t.bPresentGate?e.playMuiscWithType($.MTGAMESGATE,1):e.playMuiscWithType($.MTGAMESNORMAL,1,!0),this.schedule(this.setGameMusicVolume,.2)},setGameMusicVolume:function(e){var t=wr.getModel();t.BgMusicVolumeSinkInto+=.05,l.audioEngine.setMusicVolume(t.BgMusicVolumeSinkInto),1==t.BgMusicVolumeSinkInto&&this.unschedule(this.setGameMusicVolume)},InitTaskState:function(){var e=wr.getModel(),t=0,i=e.curLevel;if(e.tasks){t=e.tasks.length;for(var n=e.usersData.getFinishTask(i),s=0;s<t;s++){if(1&n)this.UpdateTaskState(s+1,nn.TaskFinished);else{var r=e.tasks[s];r.isSuccessful()&&(e.usersData.setLevelFinishTask(e.curLevel,s+1,r.getGoldCoins()),this.UpdateTaskState(s+1,nn.TaskComplete))}n>>=1}}},UpdateTaskState:function(e,t){if(t){var i=this.bottomBar.getChildByTag(pe.BOTTOM_BAR_MISSION);if(i){if(t==nn.TaskComplete&&(this.spBottombarShine||(this.spBottombarShine=new l.Sprite("adv_bottoolbar_shine.png"),i.addChild(this.spBottombarShine,1e4)),this.spBottombarShine)){switch(this.spBottombarShine.setScale(.1),e){case 1:this.spBottombarShine.setPosition(37,44);break;case 2:this.spBottombarShine.setPosition(61,44);break;case 3:this.spBottombarShine.setPosition(85,44)}var n=l.rotateTo(.3,90),s=l.scaleTo(.3,1,1),r=l.rotateTo(.1,90),a=l.scaleTo(.1,.1,.1),o=l.scaleTo(0,0,0);this.spBottombarShine.runAction(l.sequence(l.spawn(n,s),l.spawn(r,a),l.rotateTo(0,180),o))}var h=null;switch(t){case nn.TaskFinished:case nn.TaskComplete:h=l.spriteFrameCache.getSpriteFrame("mission_succeed.png");break;case nn.TaskLose:default:h=l.spriteFrameCache.getSpriteFrame("mission_lose.png")}var d=pe.BOTTOM_BAR_MISSION+e,c=i.getChildByTag(d);if(null==c){var u;switch(e){case 1:u=l.p(37,44);break;case 2:u=l.p(61,44);break;case 3:u=l.p(85,44)}(c=new l.Sprite(h)).setPosition(u),i.addChild(c)}else c.setSpriteFrame(h)}}},IcePropLastTime:function(e){this.unschedule(this.IcePropLastTime),wr.getModel().bCreepStopCome=!1},SlowPropLastTime:function(){1==--this.nSlowPropLast&&this.unschedule(this.SlowPropLastTime),this.dropBigbomb(2)},showDropGiftBox:function(e){if(!this.bGiftBoxDrop){this.bGiftBoxDrop=!0;var t=wr.getModel();if(null==this.spGiftBox&&(qu.addRes(this,"res/Themes/Items/love-hd.plist"),this.spGiftBox=new l.Sprite("magpie_1.png"),t.gameLayer.addChild(this.spGiftBox,19998,19998)),this.spGiftBox){var i=nr.share().getWinSize();this.spGiftBox.setOpacity(255),this.spGiftBox.setRotation(180),this.spGiftBox.setScale(3),this.spGiftBox.setPosition(e.x,i.height+this.spGiftBox.width/2+1);var n=l.callFunc(this.showBoxDance,this);this.spGiftBox.runAction(l.sequence(l.spawn(l.moveTo(.5,e),l.scaleTo(.5,1),l.rotateTo(.5,0)),l.moveBy(.1,0,30),l.moveBy(.1,0,-30),n))}}},showBoxDance:function(){var e=l.spriteFrameCache.getSpriteFrame("magpie_1.png"),t=l.spriteFrameCache.getSpriteFrame("magpie_2.png"),i=l.spriteFrameCache.getSpriteFrame("magpie_3.png"),n=l.spriteFrameCache.getSpriteFrame("magpie_4.png"),s=l.spriteFrameCache.getSpriteFrame("magpie_5.png"),r=l.spriteFrameCache.getSpriteFrame("magpie_6.png"),a=[e,e,t,i,n,s,r,s,r,e],o=new l.Animation(a,.1);this.spGiftBox.runAction(l.repeatForever(l.sequence(l.delayTime(5),l.animate(o))))},IsGiftBoxClick:function(e){if(this.spGiftBox){var t=this.spGiftBox.getBoundingBox();if(l.rectContainsPoint(t,e))return!0}return!1},PickUpGiftBox:function(){this.spGiftBox.stopAllActions(),this.spGiftBox.setOpacity(0)},weiboCallBack:function(){var e=wr.getModel(),t=e.animeLayer.getChildByTag(66666);t&&(t.setVisible(!1),e.animeLayer.removeChild(t,!0),l.director.getScheduler().isWaite=!1,e.bLockMenu=!1,e.usersData.bhadLogin)},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e),a=new l.Sprite(t),o=new l.MenuItemSprite(r,a,null,this,this.menuCallback.bind(this));return o.setTag(i),o.setPosition(n),o},menuCallback:function(e){var t=e.getTag();if(!(this.m_rebornNum<=0&&99999!=t))switch(t){case 2049:this.m_isShowVideoReborn=!0,this.restartByRecovery();break;case 2050:(i=wr.getModel()).lose_show=!1,this.m_isShowVideoReborn=!1,this.restartByRecovery();break;case 99999:var i=wr.getModel();i.bKillGate=!0;var n=i.gameLayer;i.playMuiscWithType($.MTWARBGMSC,2),i.bLockMenu=!0,this.m_isShowVideoReborn=!1,i.isQuick=!0,i.usersData.setLevelFinishTask(i.curLevel,1,0),i.usersData.setLevelFinishTask(i.curLevel,2,0),i.usersData.setLevelFinishTask(i.curLevel,3,0),i.usersData.setLevelClearHonor(i.curLevel),n.victorious(),i.bGameStart=!1}},restartByRecovery:function(){var e=wr.getModel(),t=e.usersData.getDiamond(),i=e.usersData.resurgencediamondddu?e.usersData.resurgencediamondddu:$i;(i<=0||void 0==i)&&(i=200),this.spNum&&(this.spNum.stopAllActions(),e.playMuiscWithType(0,2));var n=this;if(t>=i||e.lose_show)if(dp)n.sendRestart();else{e.lose_show||e.usersData.addDiamond(-i),e.animeLayer.removeChildByTag(2048),e.highterRecovery(),Tt.onExchange("复活-99",1);var s=this.getChildByTag(J.MENUBTN);if(s){var r=s.getChildByTag(tn.SpeedMenu);this.changeMenuItemWithType(tn.SpeedMenu,1,r)}}else ju.alert(b.Dialog_Hint,function(){n.showNumAnim()})},sendRestart:function(){var e=wr.getModel(),t=e.m_nGameMode==ge.HIGHERMODE?1:0,i=e.m_nRecoveryTime+1,n=this;Ql.resurgence(t,i,function(t){e.usersData.setDiamond(t.dm),e.animeLayer.removeChildByTag(2048),n.spNum&&(n.spNum=null),e.highterRecovery(),Tt.onExchange("复活-99",1);var i=n.getChildByTag(J.MENUBTN);if(i){var s=i.getChildByTag(tn.SpeedMenu);n.changeMenuItemWithType(tn.SpeedMenu,1,s)}},function(){n.showNumAnim()})}});rn.create=function(){return new rn};var an=-1,on=0,hn=1,ln=2,dn=3,cn=4,un=5,pn=6,mn=7,_n={};_n.STOPFEAST=an,_n.NOFEASTTYPE=on,_n.DROPDIAMOND=hn,_n.CLIMBNODROP=ln,_n.ADDTOWERPOWER=dn,_n.DOUBLEDROPGOLD=cn,_n.CUTOFFCREEPHP=un,_n.LEVELNONEEDSTAR=pn,_n.ROULETTECUTOFF=mn;var gn=l.Class.extend({m_nGetInfoTimes:0,m_nRandomCreep:1,m_nTotalDropDiamond:-1,m_bStartFeast:!1,m_structNewFeast:null,m_structFeast:null,m_nLastGetTime:0,ctor:function(){this.m_structFeast={},this.m_structNewFeast={},this.m_structNewFeast.mode=this.m_structFeast.mode=on,this.m_structNewFeast.value=this.m_structFeast.value=0,this.m_structNewFeast.exInfo=this.m_structFeast.exInfo=null},showFeastLayer:function(e){if(e){var t=.5;nr.share().isIPad()&&(t=1);var i=nr.share().getWinSize();qu.addRes(e,"res/Themes/Items/SpringAct.plist");var n=new l.Sprite("#spring_mainbg.png");n.setPosition(.5*i.width,.5*i.height),e.addChild(n,999999,999999);var s=String.formatC("spring_ball_%d.png",this.m_structFeast.mode),r=new l.Sprite("#"+s);r.setPosition(564*t,280*t),n.addChild(r),s=this.m_structFeast.mode==hn?String.formatC("spring_content_%d_%d.png",this.m_structFeast.mode,this.m_structFeast.exInfo[3]):String.formatC("spring_content_%d.png",this.m_structFeast.mode);var a=new l.Sprite("#"+s);a.setPosition(568*t,60*t),n.addChild(a),s=String.formatC("spring_day_%d.png",this.m_structFeast.mode);var o=new l.Sprite("#"+s);o.setPosition(568*t,108*t),n.addChild(o);for(var h=[l.p(182*t,510*t),l.p(350*t,420*t),l.p(216*t,300*t),l.p(790*t,466*t),l.p(926*t,550*t),l.p(800*t,288*t),l.p(960*t,344*t)],d=1;d<8;d++){s=this.m_structFeast.mode==d?String.formatC("spring_star_%d_on.png",d):String.formatC("spring_star_%d_off.png",d);var c=new l.Sprite("#"+s);c.setPosition(h[d-1]),n.addChild(c)}}},getCurFeastType:function(){return this.m_structFeast.mode},resetDropDiamond:function(){this.m_structFeast.value=0},getDropDiamondCount:function(e){if(this.m_structFeast.value>=this.m_structFeast.exInfo[0]||this.m_nTotalDropDiamond>=this.m_structFeast.exInfo[2])return 0;if(e<this.m_structFeast.exInfo[4]||this.m_structFeast.exInfo[5]<e)return l.log("》》》本关不能参加奖励宝石活动"),0;if(this.m_nRandomCreep>0)return this.m_nRandomCreep--,0;this.m_nRandomCreep=F()%10+5,this.m_nRandomCreep<=this.m_structFeast.value&&(this.m_nRandomCreep=F()%3+1);var t=F()%3;return 0==t&&(t+=2),this.m_structFeast.value+t>=this.m_structFeast.exInfo[0]&&(t=this.m_structFeast.exInfo[0]-this.m_structFeast.value),this.m_structFeast.value+=t,this.m_nTotalDropDiamond+=t,this.saveData(),l.log("》》》活动奖励宝石%d颗，本关共奖励：%d颗, 总共奖励：%d颗",t,this.m_structFeast.value,this.m_nTotalDropDiamond),t},getAddTowerPower:function(){return l.log("》》》炮塔火力增加%.02f％",100*this.m_structFeast.value),this.m_structFeast.value},getDoubleGold:function(){return l.log("》》》金币掉落增加%.02f％",100*this.m_structFeast.value),this.m_structFeast.value},getCutOffCreepHP:function(){return l.log("》》》怪物血量减少%.02f％",100*-this.m_structFeast.value),this.m_structFeast.value},getRouletteCutOff:function(){return l.log("》》》轮盘抽奖%.02f％折扣",100*-this.m_structFeast.value),this.m_structFeast.value},isNeedUpdateInfo:function(){return this.m_nGetInfoTimes++,this.m_structFeast.mode,this.m_nGetInfoTimes=0,!0},getFeastFromServer:function(){if(this.isNeedUpdateInfo()){var e=l.loader.getXMLHttpRequest();e.open("GET","http://api5.luobo.iqupdate.com/api/activity_weekday.php?week=1&aes=1",!0),e.setRequestHeader("Access-Control-Allow-Origin","*"),e.onreadystatechange=this.onMyHttpRequestCompleted.bind(this),e.send()}},onMyHttpRequestCompleted:function(e){var t=wr.getModel(),i=e.currentTarget;if(4==i.readyState){if(200==i.status){var n=i.responseText;this.m_structFeast.mode>on?this.parseJson(this.m_structNewFeast,n):(this.parseJson(this.m_structFeast,n),this.m_structFeast.mode>on?t.m_bFeast=!0:t.m_bFeast=!1,this.m_nLastGetTime=t.getCurSystemTime())}else this.m_structFeast.mode>on&&(this.m_structNewFeast.mode=an)}},updateInfo:function(){var e=wr.getModel();this.m_structNewFeast.mode==an?(e.m_bFeast=!1,this.m_nLastGetTime=e.getCurSystemTime(),this.m_structNewFeast.mode=this.m_structFeast.mode=on,this.m_structNewFeast.value=this.m_structFeast.value=0):this.m_structNewFeast.mode>on&&(this.m_nLastGetTime=e.getCurSystemTime(),this.m_structFeast.mode=this.m_structNewFeast.mode,this.m_structFeast.value=this.m_structNewFeast.value,this.m_structFeast.exInfo&&delete this.m_structFeast.exInfo,this.m_structFeast.exInfo=this.m_structNewFeast.exInfo,this.m_structNewFeast.mode=on,this.m_structNewFeast.value=0,this.m_structNewFeast.exInfo=null),-1==this.m_nTotalDropDiamond&&(this.m_nTotalDropDiamond=0,this.m_structFeast.mode==hn?this.loadData():this.saveData())},decode:function(e){},parseJson:function(e,t){var i=an;if(!(void 0==t||t.length<=0)){var n,s=t.data();"{"!=s[0]&&this.decode(s),l.log("》》》活动内容：%s",s);for(var r=(n=JSON.parse(s)).activity,a=["monsterPushStone","tower","heatPower","monsterPushGold","monsterBlood","lifeStars","roulette"],o=0;o<7;o++)if(a[o]==r){l.log("》》》活动类型 %s ",r),i=hn+o;break}var h=0;if(i!=hn&&(h=n.value,l.log("》》》活动数值 %.02f ",h)),e.mode=i,e.value=h,e.exInfo&&delete e.exInfo,i==hn){this.m_nRandomCreep=F()%10+5,e.exInfo=[];var d=n.value,c=d.indexOf("-"),u=parseFloat(d.substr(0,c)),p=parseFloat(d.substr(c+1,5))-u;p<1&&(p=1),e.exInfo.push(u+F()%p),e.exInfo.push(n.range),e.exInfo.push(n.max),e.exInfo.push(n.theme+1);var m=n.themeName;d="（",c=m.indexOf(d)+d.size();var _=m.indexOf("）");c=(d=m.substr(c,_-c)).indexOf("~"),e.exInfo.push(parseFloat(d.substr(0,c))),e.exInfo.push(parseFloat(d.substr(c+1,5)))}else e.exInfo=null}},loadData:function(){this.m_nTotalDropDiamond=l.sys.localStorage.getItem("M_TALDDD")},saveData:function(){l.sys.localStorage.setItem("M_TALDDD",this.m_nTotalDropDiamond)}}),Tn=l.Class.extend({moveSpeed:0,moveDurations:null,ctor:function(){this.moveDurations=[]},setSpeed:function(e,t){if(!(e<1)){this.moveSpeed=e;var i=null;for(var n in t){var s=t[n];if(null!=i){var r=l.pSub(i,s),a=0;(a=Math.abs(r.x)>Math.abs(r.y)?r.x/e:r.y/e)<0&&(a=-a);var o=a;this.moveDurations.push(o),i=s}else i=s}}},durationsWithIndex:function(e){return e<this.moveDurations.length?this.moveDurations[e]:0}}),fn=0,Sn=1,wn=2,vn=3,Ln=4,Mn=5,Cn=6,yn=7,Bn=8,Fn=9,En=1,Pn=2,bn=4,An=l.Layer.extend({mBg:null,menuBg:null,m_nClickType:0,bWait:!1,ctor:function(){this._super()},init:function(){if(this._super()){var e=wr.getModel();this.bWait=!1;var t=nr.share().getMapOffset();this.stageType=e.m_nGameMode;var i=e.usersData.m_nLanguage,n=String.formatC("res/Themes%s/Items/Items02-hd%s.plist",i,i);qu.addRes(this,n),qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",i));var s=nr.share().getWinSize(),r=l.color(0,0,0,178),a=new l.LayerColor(r);a&&(a.setPosition(0,0),a.setContentSize(s),this.addChild(a,0));var o=null;if(!(o=l.spriteFrameCache.getSpriteFrame("adv_menu_bg_comm.png")))return!1;this.menuBg=new l.Sprite(o),this.menuBg.setPosition(480+t.width,340),this.addChild(this.menuBg,188,2003);var h=e.getObjectByType(J.WAVES),d=h.szTile;if(d=l.size(2*d.width,2*d.height),e.m_nGameMode==ge.CHALLENGEMODE){var c=new l.Sprite("#adv_menu_daily.png");c.setPosition(249,474),this.menuBg.addChild(c,501)}else if(e.curLevel<136&&e.curLevel>0)(_=new l.LabelAtlas("000",h.strPic,d.width,d.height,"./0123456789")).setString(String.formatC("%.2lu",e.curLevel)),_.setAnchorPoint(.5,.5),_.setPosition(248,472),this.menuBg.addChild(_,31);else if(e.curLevel>135&&e.curLevel<mr){var u=e.curLevel>135&&e.curLevel<156,p=u?135:155,m=new l.Sprite(u?"themenum_d.png":"themenum_q.png");m.setPosition(233,472),this.menuBg.addChild(m,31);var _=new l.LabelAtlas("000",h.strPic,d.width,d.height,"./0123456789");_.setString(String.formatC("%.2lu",e.curLevel-p)),_.setAnchorPoint(0,.5),_.setPosition(242,472),this.menuBg.addChild(_,31)}var g=new l.Sprite("#btn_green_b.png"),T=new l.Sprite("#btn_green_b_pressed.png"),f=new l.Sprite("#adv_menu_continue.png"),S=new l.MenuItemSprite(g,T,null,this,this.menuCallback.bind(this));S.setTag(wn),S.setPosition(250,384),S.addChild(f),f.setPosition(150,50),g=new l.Sprite("#btn_blue_b.png"),T=new l.Sprite("#btn_blue_b_pressed.png"),f=new l.Sprite("#"+e.m_nGameMode==ge.HIGHERMODE?"adv_menu_restart_and.png":"adv_menu_restart.png");var w=new l.MenuItemSprite(g,T,null,this,this.menuCallback.bind(this));w.setTag(vn),w.setPosition(250,274),w.addChild(f),f.setPosition(150,50),g=new l.Sprite("adv_menu_sbtn.png"),T=new l.Sprite("adv_menu_sbtn_pressed.png"),f=new l.Sprite("adv_menu_home_s.png");var v=new l.MenuItemSprite(g,T,null,this,this.menuCallback.bind(this));v.setTag(Cn),v.setPosition(180,163),v.addChild(f),f.setPosition(70,50),g=new l.Sprite("adv_menu_sbtn.png"),T=new l.Sprite("adv_menu_sbtn_pressed.png");var L=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,M=GamePlatform.isCN()?L?"win_qq.png":"win_wechat.png":"win_weibo.png";if(f=new l.Sprite(M),this.pItemweibo=new l.MenuItemSprite(g,T,null,this,this.menuCallback.bind(this)),this.pItemweibo.setTag(Mn),this.pItemweibo.setPosition(320,163),this.pItemweibo.addChild(f),f.setPosition(70,50),!e.usersData.bIsShareWeChat&&GamePlatform.getCurrentPlatForm()!=PlatformType.FaceBook){var C=new l.Sprite("gem_3.png");C.setAnchorPoint(.5,0),C.setPosition(this.pItemweibo.width-15,.5*this.pItemweibo.height),this.pItemweibo.addChild(C,1,3)}var y=null;g=new l.Sprite("#adv_menu_xsbtn.png"),T=new l.Sprite("#adv_menu_xsbtn_pressed.png"),f=new l.Sprite("#adv_menu_comm_s.png"),(y=new l.MenuItemSprite(g,T,null,this,this.menuCallback.bind(this))).setTag(Fn),y.setPosition(350,163),y.addChild(f),f.setPosition(50,50),y.setVisible(!1);var B=new l.Menu(S,w,v,this.pItemweibo,y);B.setPosition(0,0),B.setTag(Sn),this.menuBg.addChild(B,0),this.menuBg.setPosition(480+t.width,890);var F=l.moveTo(.2,480+t.width,310),E=l.moveTo(.1,480+t.width,340);this.menuBg.runAction(l.sequence(F,E))}return!0},restart:function(){var e=wr.getModel(),t=(e.gameLayer,e.usersData.getCarrotFigure()),i=e.usersData.getSecondCarrotFigure();l.director.getScheduler().setTimeScale(1),e.bRestart=!0,e.usersData.setLastPlayedLevel(e.curLevel,!0),e.playMuiscWithType($.MTWARBGMSC,2),e.m_nGameMode==ge.DOUBLECARROT?(t==ue.CARROT_FAT?e.nCarrotHP=7:e.nCarrotHP=5,i==ue.CARROT_FAT?e.nSecondCarrotHP=7:e.nSecondCarrotHP=5):t==ue.CARROT_FAT?e.nCarrotHP=12:e.nCarrotHP=10;qi.preloadWithGameScene(),e.bLockMenu=!1,e.bGameStart=!1},quit:function(){var e=wr.getModel();e.gameLayer;e.bRestart=!1,e.playMuiscWithType($.MTWARBGMSC,2),l.director.getScheduler().setTimeScale(1);this.replaceScene(!1),l.director.getScheduler().isWaite=!0,e.bBackMainScene=!0,e.bLockMenu=!1},replaceScene:function(e){var t=wr.getModel();if(t.m_nGameMode==ge.CHALLENGEMODE)qi.preloadWithLoadingTag(Ht,we.MAIN,e);else if(t.curLevel<136){i=[];i=t.m_nGameMode==ge.HIGHERMODE?Ei:Yd.getUsedRes(),qi.preloadWithLoadingTag(i,we.THEME,e)}else if(t.curLevel>135&&t.curLevel<156){var i=[];i=t.m_nGameMode==ge.HIGHERMODE?Ei:qt,qi.preloadWithLoadingTag(i,we.THEMETEMPLE,e)}else t.curLevel>155&&t.curLevel<mr?qi.preloadWithLoadingTag(Ai,we.MEETFRIEND,e):qi.preloadWithLoadingTag(Ht,we.MAIN,e)},showRestartTip:function(){var e=nr.share().getMapOffset();qu.addRes(this,"res/Themes/Items/Items03-hd.plist");var t=wr.getModel().usersData.m_nLanguage,i=String.formatC("res/Themes%s/Items/Items03-hd%s.plist",t,t);qu.addRes(this,i);var n=l.spriteFrameCache.getSpriteFrame("woodbg_notice.png"),s=new l.Sprite(n);s.setPosition(478+e.width,312),this.addChild(s,188,2004);var r=new l.Sprite("#menu_warn_top.png");r.setPosition(403,421),s.addChild(r),(r=new l.Sprite("#menu_warn_text.png")).setPosition(402,274),s.addChild(r),(r=new l.Sprite("#sepline_s.png")).setPosition(401,210),s.addChild(r);var a=new l.Sprite("#btn_blue_m.png"),o=new l.Sprite("#btn_blue_m_pressed.png"),h=new l.MenuItemSprite(a,o,null,this,this.menuCallback.bind(this));h.setPosition(267,154),h.setTag(yn),(r=new l.Sprite("#btn_blue_m_ok.png")).setPosition(130,50),h.addChild(r),a=new l.Sprite("#btn_green_m.png"),o=new l.Sprite("#btn_green_m_pressed.png");var d=new l.MenuItemSprite(a,o,null,this,this.menuCallback.bind(this));d.setPosition(540,154),d.setTag(Bn),(r=new l.Sprite("#btn_green_m_cancel.png")).setPosition(130,50),d.addChild(r);var c=l.Menu(h,d,null);c.setPosition(0,0),s.addChild(c,2,2)},menuCallback:function(e){l.director.resume();var t=wr.getModel();if(!t.showRewardLayer){t.playSoundWithType($.MTMENUSELECT);var i=e,n=i.getParent();if(n&&n.setEnabled(!1),i.getTag()==wn)this.showWnd(!1),(r=t.gameLayer).gameHUD.registerWithTouchDispatcher(!0),t.playMuiscWithType($.MTWARBGMSC,4),t.bLockMenu=!1,t.bGameStart=!0;else if(i.getTag()==vn){this.clearTask(),(r=t.gameLayer).gameHUD.registerWithTouchDispatcher(!1),t.curKillMonsters<1e4&&(t.usersData.killMonsters+=.2*(t.curKillMonsters-3)),t.usersData.restObtainProp();s=this;this.stageType==ge.CHALLENGEMODE?t.m_oChallenge.canPlay()?t.m_oChallenge.playCurLevel():(t.bRestart=!1,this.replaceScene(!1)):t.usersData.canPlay()?s.restart():(t.bRestart=!1,this.replaceScene(!1)),n&&n.setEnabled(!0)}else if(i.getTag()==Cn)this.clearTask(),t.usersData.restObtainProp(),(r=t.gameLayer)&&r.gameHUD.registerWithTouchDispatcher(!1),t.curKillMonsters<1e4&&(t.usersData.killMonsters+=.2*(t.curKillMonsters-3)),t.m_nGameMode,ge.HIGHERMODE,this.quit();else if(i.getTag()==Mn){this.visible=!lp,n&&n.setEnabled(this.visible);var s=this;kl.shareMessage(null,"",Wl.REWARD_SHARE,0,1,null,function(e){if(e){var t=s.pItemweibo.getChildByTag(3);t&&t.removeFromParent()}}),n&&n.setEnabled(!0),this.visible=!0;t.gameLayer&&t.gameLayer.getLayerName(),Tt.onShare("sina-weibo","share-menu")}else if(i.getTag()==yn)this.m_nClickType==Pn?this.quit():this.m_nClickType==En&&this.restart();else if(i.getTag()==Bn){this.showWnd(!1);var r=t.gameLayer;r.gameHUD.registerWithTouchDispatcher(!0),t.playMuiscWithType($.MTWARBGMSC,4),t.bLockMenu=!1,t.bGameStart=!0}else i.getTag()==Fn&&n.setEnabled(!0)}},clearTask:function(){var e=wr.getModel().tasks;if(e)for(var t=e.length,i=0;i<t;i++){var n=e[i];n&&!n.isFinished()&&n.clearFinishCount()}},showWnd:function(e){e?(this.setVisible(!0),0==l.director.getScheduler().isWaite&&(l.director.getScheduler().isWaite=!0,this.bWait=!0)):(this.bWait&&(l.director.getScheduler().isWaite=!1,this.bWait=!1),this.removeFromParent())},onExit:function(){qu.clearOwner(this),this._super()}});An.create=function(){var e=new An;return e.init(),e};var On=1,In=2,Rn=3,Dn=4,xn=5,Nn={};Nn.MT_NORMAL=On,Nn.MT_DOUBLE=In,Nn.MT_BOSS=Rn,Nn.MT_GATE=Dn,Nn.MT_SUPERBOSS=xn;var Gn=l.Class.extend({curMap:0,curLevel:0,hardPercent:1,m_nPackageType:_e.UNKNOWPT,m_nGiveCount:0,m_nGiveType:fe.UNKNOWBB,curMapLevel:0,mapConfig:null,mapData:null,mapMode:0,ctor:function(){this.mapData=Gd.create()},getCurMapLevel:function(e,t){return l.log("===================getCurMapLevel====================\n"),this.resetPackage(),this.mapConfig=e,this.curLevel=t,this.randomLevel(),this.mapData},getPackageType:function(){if(this.m_nPackageType==_e.UNKNOWPT){var e=wr.getModel();switch(this.mapMode=e.bLoopPath?Rn:On,this.mapMode){case Rn:this.m_nPackageType=-(F()%_e.CUTALLMONSTERHP+1);break;case On:case In:case xn:case Dn:this.m_nPackageType=-(F()%_e.ADDCARROTHP+1)}}return this.m_nPackageType==-_e.NODOWNLEVEL&&(this.m_nPackageType=-_e.ADDGOLD),this.m_nPackageType<0?-this.m_nPackageType:this.m_nPackageType},getGiveCount:function(){var e=wr.getModel();return e.curLevel<16&&e.m_nGameMode!=ge.CHALLENGEMODE?0:this.m_nGiveCount<0?-this.m_nGiveCount:this.m_nGiveCount},subGiveCountLeft:function(){return this.m_nGiveCount<0?0:--this.m_nGiveCount},getGiveMagicType:function(){var e=wr.getModel();return this.m_nGiveType==fe.UNKNOWBB&&(e.bLoopPath?this.m_nGiveType=F()%fe.SHOOTBB+1:this.m_nGiveType=F()%fe.CLEARBB+1),e.curLevel<18?this.m_nGiveType=fe.SLOWBB:e.curLevel<20?this.m_nGiveType=fe.STOPBB:e.curLevel<22?this.m_nGiveType=fe.SHOOTBB:e.curLevel<24?this.m_nGiveType=fe.ADDHPBB:e.curLevel<26&&(this.m_nGiveType=fe.CLEARBB),this.m_nGiveType},getPackageCount:function(e){if(this.m_nPackageType!=e)return 0;switch(this.m_nPackageType){case _e.CUTCREEPHP:case _e.CUTBOSSHP:return.7;case _e.ADDPOWER:return.3;case _e.ADDGOLD:return 2e3;case _e.ADDCARROTHP:return 5;case _e.NODOWNLEVEL:return 1;case _e.CUTALLMONSTERHP:return.8}return 0},createMagicCount:function(){var e=wr.getModel();if(e.m_nGameMode!=ge.CHALLENGEMODE){var t=[2,2,2,3,3,4,3,5],i=e.curTheme-1;i<0?i=0:i>3&&(i=3);var n=t[2*i+1]-t[2*i];n=0==n?t[2*i]:F()%n+t[2*i],this.m_nGiveCount=-n}else this.m_nGiveCount=-2},resetPackage:function(){this.m_nGiveCount=0,this.m_nGiveType=fe.UNKNOWBB,this.m_nPackageType=_e.UNKNOWPT},pickupMagic:function(){this.m_nGiveCount<0&&(this.m_nGiveCount=-this.m_nGiveCount);var e,t=wr.getModel().gameLayer.gameHUD;switch(this.m_nGiveType){case fe.SLOWBB:e=pe.BOTTOM_BAR_SLOW;break;case fe.STOPBB:e=pe.BOTTOM_BAR_ICE;break;case fe.SHOOTBB:e=pe.BOTTOM_BAR_SPEED;break;case fe.ADDHPBB:e=pe.BOTTOM_BAR_BLOOD;break;case fe.CLEARBB:e=pe.BOTTOM_BAR_BOMB}this.m_nGiveCount>0&&t.UpdateBarItemCounter(this.m_nGiveCount,e,!0)},pickupPackage:function(){var e=wr.getModel();if(e.usersData.getDiamond()<200)return!1;this.m_nPackageType<_e.UNKNOWPT&&(this.m_nPackageType=-this.m_nPackageType);var t=this.getPackageCount(_e.ADDGOLD);t>0&&(e.changeMoney(t),e.gameLayer.gameHUD.changeMoney(e.getAllMoney()));var i=this.getPackageCount(_e.ADDCARROTHP);if(i>0){e.usersData.getCarrotFigure()==ue.CARROT_FAT?e.nCarrotHP=12+i:e.nCarrotHP=10+i;var n=String.formatC("%ld",e.m_nGameMode==ge.CHALLENGEMODE?e.nCarrotHP-7:e.nCarrotHP);e.gameLayer.houselife.setString(n)}return this.getPackageCount(_e.ADDPOWER)>0&&e.addTowerBuff(null),!0},randomMap:function(){var e=wr.getModel();this.randomMoney(0!=this.curMap&&e.m_nGameMode!=ge.CHALLENGEMODE),0==this.curMap&&(this.curMap=this.getRandomLevel(this.mapMode,0)),e.curLevel=this.curMap;for(var t=new l.TMXTiledMap(e.getMapPath()),i=t.getObjectGroup("PATH"),n=t.getTileSize().width,s=t.getTileSize().height,r=!1,a=0,o=1,h=i[String.formatC("PT%d",o)],d=-1,c=-1;h;){var u=h.x,p=h.y;-1==d&&-1==c?(d=u,c=p):d==u?(a+=Math.abs(p-c),c=p):(a+=Math.abs(u-d),d=u),r?(h=i[String.formatC("PT%d02",o)],r=!1,d=-1,c=-1):(o++,null==(h=i[String.formatC("PT%d",o)])&&(h=i[String.formatC("PT%d01",o)])&&(r=!0))}this.hardPercent*=this.fromRoadLenGetHard(a);for(var m=0,_=0,g=[],T=t.getProperty("prop"),f=0,S=1;f<T.length;)(S=T.indexOf(",",f))<0&&(S=T.length),g.push(T.substr(f,S-f)),f=S+1;var w=null;f=g.length;for(P=0;P<f;P++){var v=g[P],L=0;-1!=v.indexOf("SC")?L=3:-1!=v.indexOf("BC")?L=4:-1!=v.indexOf("DB")?L=5:-1!=v.indexOf("S")?L=0:-1!=v.indexOf("L")?L=1:-1!=v.indexOf("B")&&(L=2);for(var M=J.SMALLOBJECT1+L,C=1;null!=(h=i[b=String.formatC("%sOb%d",v,C)]);C++){m+=(w=e.getObjectByType(M)).nMoney;var y=parseInt(h.type);y>0&&(_+=(w=e.getObjectByType(y+J.TBOTTLE-1)).nBuyMoney[0])}}this.hardPercent*=this.fromDropMoneyGetHard(m);var B=0;for(o=1;h=i[String.formatC("Obj%d",o)];){var F=l.rect(h.x,h.y,h.width,h.height);B+=(d=F.width/n)*(c=F.height/s),o++}this.hardPercent*=this.fromTowerPlaceGetHard(B);for(C=J.MONSTEREND+1;C<J.TOWEREND;C++)for(var E=(w=e.getObjectByType(C)).nBuyMoney,P=1;;P++){var b=String.formatC("%dT%d",C-J.TBOTTLE+1,P);if(null==(h=i[b]))break;d=h.type-1,_+=E[0]}this.hardPercent*=this.fromGiveTowerGetHard(_),this.hardPercent*=this.fromHPPerGetHard()},randomLevel:function(){var e=wr.getActivedModel();if(this.hardPercent=1,this.mapData.nMoney=0,0==this.curLevel)this.mapMode=this.getRandomMapMode(),this.curLevel=this.getRandomLevel(this.mapMode,0);else if(e.m_nGameMode==ge.CHALLENGEMODE)this.mapMode=e.m_oChallenge.getCurModeType(),this.curMap=this.curLevel;else if(this.mapMode=this.getRandomLevel(On,this.curLevel),this.curMap=this.curLevel,this.mapMode==Rn)return;this.curMapLevel=this.mapConfig.allLevels[this.curLevel-1],l.log("★★★ 随机刷怪表：%d",this.curLevel),this.randomMap(),this.hardPercent*=this.fromLevelModeGetHard(),this.mapData.nTheme=this.curMapLevel.nTheme,this.mapData.nWaves=this.curMapLevel.nWaves,this.mapData.nMonsterSpan=this.curMapLevel.nMonsterSpan,this.mapData.nEveryListSpan=this.curMapLevel.nEveryListSpan,this.mapData.nBossModeSecond=this.curMapLevel.nBossModeSecond,this.mapData.bPresentGate=this.curMapLevel.bPresentGate,e.m_nGameMode==ge.CHALLENGEMODE&&(this.mapData.nBossModeSecond=0,this.mapData.bPresentGate=!1),this.mapData.nStart01HP=this.curMapLevel.nStart01HP,this.mapData.ptLevelNum=this.curMapLevel.ptLevelNum,this.mapData.strLevelName=this.curMapLevel.strLevelName,this.mapData.fObjectHP=this.curMapLevel.fObjectHP,this.mapData.tasks=this.curMapLevel.tasks;var t=this.curMapLevel.wavesList,i=t.length;this.mapData.wavesList=[];for(var n=this.mapData.nMoney,s=0;s<i;s++){var r=new Wd(t[s]);r.nMonsterType<J.BMT?n+=r.nMonsterCount*(e.m_nGameMode==ge.CHALLENGEMODE?28:14):n+=168*r.nMonsterCount,r.nMonsterType==J.SBB?r.fHPIncreasePercent=t[s].fHPIncreasePercent:r.fHPIncreasePercent=n*this.hardPercent*this.fromCreepTypeGetHard(r.nMonsterType)*(r.nWave<6?.03:.1),r.nMonsterType==J.BMT&&(r.fHPIncreasePercent*=this.fromBMTCountGetHard(r.nMonsterCount)),this.mapData.wavesList.push(r)}},randomTowers:function(e){var t=wr.getModel();if(e){var i=this.curMapLevel.towerType.length;this.mapData.towerType=[];for(n=0;n<i;n++){s=this.curMapLevel.towerType[n];this.mapData.towerType.push(s)}}else{if(t.m_nGameMode==ge.CHALLENGEMODE)return void this.randomTowersByUnlocked();(i=F()%9)<3?i+=3:i>7&&(i-=2),this.mapData.towerType=[];for(var n=0;n<i;n++){for(var s=F()%(J.TBOOMERANG-J.TBOTTLE)+J.TBOTTLE,r=!1,a=this.mapData.towerType.length,o=0;o<a;o++)if((h=this.mapData.towerType[o])==s){r=!0;break}if(r)for(s=J.TBOOMERANG-s+J.TBOTTLE;r;){r=!1;for(o=0;o<a;o++){var h=this.mapData.towerType[o];if(h==s){r=!0;break}}r&&++s>J.TBOOMERANG&&(s=J.TBOTTLE+(s-J.TBOOMERANG-1))}this.mapData.towerType.push(s)}}},randomMoney:function(e){this.randomTowers(e);for(var t=this.mapData.towerType.length,i=0,n=0;n<t;n++){var s=this.mapData.towerType[n];e||(this.mapData.nMoney+=this.formTowerGetValue(s,1)),i+=this.formTowerGetValue(s,2)}e?this.mapData.nMoney=this.curMapLevel.nMoney:(this.mapData.nMoney=parseInt(this.mapData.nMoney/t),this.mapData.nMoney=parseInt(this.mapData.nMoney*this.getMoneyRandomPer())),this.hardPercent*=i/t},fromBMTCountGetHard:function(e){var t=1;switch(e){case 2:case 3:case 4:case 5:t=.9}return t},getMoneyRandomPer:function(){var e=F()%100;return e<60?(F()%26+50)/50:e>90?(F()%51+100)/50:(F()%26+75)/50},fromHPPerGetHard:function(){var e=this.curMapLevel.fObjectHP;return e=e<=1?1:e<1.3?.8:e<1.8?.6:e<2.5?.7:1},fromRoadLenGetHard:function(e){var t=1;return(t=e<20?.8:1-(1400-e)/70*.03)>1.3&&(t=1.3),t},fromDropMoneyGetHard:function(e){return e<1e3?.8:e<2e3?1.1:e<3e3?1.2:e<4e3?1.25:1.3},fromTowerPlaceGetHard:function(e){return e<5?.8:e<8?.9:e<12?1:1.1},fromGiveTowerGetHard:function(e){return e<1e3?.8:e<2e3?1:e<3e3?1.1:1.2},fromWaveCountGetHard:function(e){return e<10?.9:e<20?1:e<30?1.1:1.2},fromLevelModeGetHard:function(){var e=1;switch(this.mapMode){case On:e=1;break;case Rn:e=.8;break;case In:e=.6;break;case Dn:e=.7}return e},formTowerGetValue:function(e,t){var i=100;switch(void 0==t&&(t=1),e){case J.TBOTTLE:i=1==t?280:1.68;break;case J.TSHIT:i=1==t?340:.8;break;case J.TSTAR:i=1==t?380:1.09;break;case J.TSUN:i=1==t?440:2.25;break;case J.TBALL:i=1==t?480:1.86;break;case J.TICEFAN:i=1==t?380:1.42;break;case J.TMOON:i=1==t?440:2.04;break;case J.TFLASHLIGHT:i=1==t?580:2.03;break;case J.TARROW:i=1==t?480:1.5;break;case J.TROCKET:i=1==t?540:2.17;break;case J.TPLANE:i=1==t?540:2.03;break;case J.TFISH:i=1==t?440:1.68;break;case J.TANCHOR:i=1==t?440:1.63;break;case J.TCUTTLE:i=1==t?700:1.65;break;case J.TMAGNET:i=1==t?300:1.88;break;case J.TSNOW:i=1==t?480:1.88;break;case J.TFIREBOTTLE:i=1==t?420:1.74;break;case J.TBOOMERANG:i=1==t?100:1.55;break;case J.TRANDOM:i=1==t?398:2.9;break;default:i=1==t?100:1}return i},fromCreepTypeGetHard:function(e){var t=1;return e==J.FTM?t=1.2:e>J.LM3&&e<J.FTM?t=1.23:e>J.FTM&&e<J.BMT?t=.7:e==J.SBFL1||e==J.SBFL2?t=.015:e==J.SBB?t=.025:e>=J.SBL1&&e<=J.SBL3?t=.02:e>=J.BMT&&(t=.015),t},getRandomLevel:function(e,t){var i=1;switch(e){case On:s=(n=[1,2,3,4,5,6,7,8,9,10,11,12,13,16,17,19,20,23,24,25,27,29,31,34,35,37,39,41,43,44,45,47,49,51,54,55,58,60,62,64,66,68,69,71,72,74,75,76,78,79,82,83,85,86,87,89,91,92,93,94,96,98,99,101,102,103,106,107,109,111,112,116,117,119,120,122,123,124,126,127,129,130,131,132,133,136,138,141,142,144,145,146,149,150,151,152,154]).length;if(0==t){i=n[r=F()%s];break}for(a=0;a<s;a++)if(n[a]==t)return On;case Rn:s=(n=[14,18,21,28,33,36,37,40,48,52,56,59,73,77,88,95,105,110,114,121,128,140,143,148,153]).length;if(0==t){i=n[r=F()%s];break}for(a=0;a<s;a++)if(n[a]==t)return Rn;case In:s=(n=[22,26,32,38,42,46,53,57,63,67,70,81,84,90,97,104,113,118,125,134,137,139,147,155]).length;if(0==t){i=n[r=F()%s];break}for(a=0;a<s;a++)if(n[a]==t)return In;case Dn:var n=[45,49,55,60,72,75,79,85,93,99,103,108,122,133,142,150,154],s=n.length;if(0==t){var r=F()%s;i=n[r];break}for(var a=0;a<s;a++)if(n[a]==t)return Dn}return i},getRandomMapMode:function(){var e=On,t=F()%100+1;return t>59&&t<76?e=Rn:t>75&&t<91?e=In:t>90&&(e=Dn),e},randomTowersByUnlocked:function(){var e=wr.getModel().getUnlockedTowersCount();if(!(e<1)){var t=e+J.TBOTTLE-1,i=F()%7+1;i<3&&(i+=3),this.mapData.towerType=[];for(var n=0;n<i;n++){for(var s=F()%e+J.TBOTTLE,r=!1,a=this.mapData.towerType.length,o=0;o<a;o++)if((h=this.mapData.towerType[o])==s){r=!0;break}if(r)for(s=t-s+J.TBOTTLE;r;){r=!1;for(o=0;o<a;o++){var h=this.mapData.towerType[o];if(h==s){r=!0;break}}r&&++s>t&&(s=J.TBOTTLE+(s-t-1))}this.mapData.towerType.push(s)}}}}),Wn=function(e){return(new o).decode(e)},kn=.99,Un=2.99,Hn=4.99,Vn=9.99,zn=4.99,Yn=3.99,Xn=1.99,jn=2.99,Kn=4.99,qn=4.99,Qn=1.99,Zn=2.99,Jn=2.99,$n=.99,es=1.99,ts=.99,is=3.99,ns=7.99,ss=.99,rs=.99,as=.99,os=.99,hs=function(){var e=!1;e||(e=!0,ps[oe.DIAMOND_JIDI]="carrothua.handful_1",ps[oe.DIAMOND300]="carrothua.pot_3",ps[oe.DIAMOND480]="carrothua.bag_5",ps[oe.DIAMOND750]="carrothua.chest_10",ps[oe.LIFE_FOREVER]="carrothua.unlimited_star_5",ps[oe.LIFE_FOREVER_PCUT]="carrothua.unlimited_value_4",ps[oe.PCUT_DIAMOND300]="carrothua.gems_value_2",ps[oe.GIRLCARROT]="carrothua.girl_3",ps[oe.FATCARROT]="carrothua.fat_5",ps[oe.OLDCARROT]="carrothua.old_5",ps[oe.PCUT_GIRLCARROT]="carrothua.girl_value_2",ps[oe.PCUT_FATCARROT]="carrothua.fat_value_3",ps[oe.PCUT_OLDCARROT]="carrothua.old_value_3",ps[oe.GLODPACKAGE]="carrothua.golden_1",ps[oe.BIGPACKAGE]="carrothua.diamond_2",ps[oe.PCUT_BIGPACKAGE]="carrothua.diamond_value_1",ps[oe.PCUT_DIAMOND480]="carrothua.bag_value_4",ps[oe.PCUT_DIAMOND750]="carrothua.chest_value_8",ps[oe.UNLOCK_HIGHER]="carrothua.upup_1",ps[oe.HIGHER_STAYFLOOR]="carrothua.fall_1",ps[oe.LIFE_10]="carrothua.10star_1",ps[oe.UNLOCK_THIRD]="carrothua.sky_glacier1")},ls=function(){this.productId="",this.originalJson="",this.signature=""},ds,cs=[],us=[],ps=[],ms=0,_s=99,gs=function(e){for(var t in ps)if(ps[t]===e)return parseInt(t);return-1},Ts=function(e){},fs=function(e){return e},Ss=l.Node.extend({g_curShop:null,spMainFrame:null,mProductID:0,mLevel:0,ctor:function(e){this._super(),e&&(this.spMainFrame=e)},onExit:function(){this.spMainFrame=null,this._super()},recordTransaction:function(e,t,i){if(this.g_curShop){cs.push(e);var n=new ls;n.productId=e,n.originalJson=t,n.signature=i,us.push(n),this.g_curShop.start_schedule_onPay()}},getAllProductsId:function(e){hs();for(var t in ps)e.push(ps[t]);return e},payError:function(e){var t=wr.getModel(),i=t.usersData,n=gs(e);t.gameCenter&&t.gameCenter.sendAppsFlyerInfo(n+1);switch(n){case oe.DIAMOND_JIDI:t.usersData.addDiamond(-200,!1),t.usersData.DLDiamond+=200,t.usersData.GMDiamond-=200,t.usersData.allPay-=Vn;break;case oe.DIAMOND300:t.usersData.addDiamond(-800,!1),t.usersData.DLDiamond+=800,t.usersData.GMDiamond-=800,t.usersData.allPay-=Vn;break;case oe.DIAMOND480:t.usersData.addDiamond(-1800,!1),t.usersData.DLDiamond+=1800,t.usersData.GMDiamond-=1800,t.usersData.allPay-=Vn;break;case oe.DIAMOND750:t.usersData.addDiamond(-4599,!1),t.usersData.DLDiamond+=4599,t.usersData.GMDiamond-=4599,t.usersData.allPay-=Vn;break;case oe.LIFE_FOREVER:t.usersData.nomoreLostTime(!1,!1),t.usersData.allPay-=zn;break;case oe.LIFE_FOREVER_PCUT:t.usersData.nomoreLostTime(!1,!1),t.usersData.allPay-=Yn;break;case oe.PCUT_DIAMOND300:t.usersData.addDiamond(-400,!1),t.usersData.DLDiamond+=400,t.usersData.GMDiamond-=400,t.usersData.allPay-=Xn;break;case oe.GIRLCARROT:t.usersData.setCarrotFigure(ue.CARROT_GIRL,!1,!1),t.usersData.allPay-=jn;break;case oe.FATCARROT:t.usersData.setCarrotFigure(ue.CARROT_FAT,!1,!1),t.usersData.allPay-=Kn;break;case oe.OLDCARROT:t.usersData.setCarrotFigure(ue.CARROT_OLD,!1,!1),t.usersData.allPay-=qn;break;case oe.PCUT_GIRLCARROT:t.usersData.setCarrotFigure(ue.CARROT_GIRL,!1,!1),t.usersData.allPay-=12;break;case oe.PCUT_FATCARROT:t.usersData.setCarrotFigure(ue.CARROT_FAT,!1,!1),t.usersData.allPay-=Zn;break;case oe.PCUT_OLDCARROT:t.usersData.setCarrotFigure(ue.CARROT_OLD,!1,!1),t.usersData.allPay-=18;break;case oe.GLODPACKAGE:for(s=0;s<5;s++){switch(s){case 0:i.addClearBB(-1,!1),i.DLClearBB+=1,i.GMClearBB-=1;break;case 1:break;case 2:i.addShootSP(-3,!1),i.DLShootSP+=3,i.GMShootSP-=3;break;case 3:i.addStopBB(-2,!1),i.DLStopBB+=2,i.GMStopBB-=2;break;case 4:i.addSlowBB(-2,!0),i.DLSlowBB+=2,i.GMSlowBB-=2}}t.usersData.allPay-=$n;break;case oe.BIGPACKAGE:for(s=0;s<5;s++){switch(s){case 0:i.addClearBB(-1,!1),i.DLClearBB+=1,i.GMClearBB-=1;break;case 1:i.addCarrotHP(-2,!1),i.DLCarrotHP+=2,i.GMCarrotHP-=2;break;case 2:i.addShootSP(-5,!1),i.DLShootSP+=5,i.GMShootSP-=5;break;case 3:i.addStopBB(-3,!1),i.DLStopBB+=3,i.GMStopBB-=3;break;case 4:i.addSlowBB(-3,!0),i.DLSlowBB+=3,i.GMSlowBB-=3}}t.usersData.allPay-=es;break;case oe.PCUT_BIGPACKAGE:i=t.usersData;t.usersData.allPay-=ts;for(var s=0;s<5;s++){switch(s){case 0:i.addClearBB(-1,!1),i.DLClearBB+=1,i.GMClearBB-=1;break;case 1:i.addCarrotHP(-2,!1),i.DLCarrotHP+=2,i.GMCarrotHP-=2;break;case 2:i.addShootSP(-5,!1),i.DLShootSP+=5,i.GMShootSP-=5;break;case 3:i.addStopBB(-3,!1),i.DLStopBB+=3,i.GMStopBB-=3;break;case 4:i.addSlowBB(-3,!1),i.DLSlowBB+=3,i.GMSlowBB-=3}}break;case oe.PCUT_DIAMOND480:t.usersData.addDiamond(-1800,!1),t.usersData.DLDiamond+=1800,t.usersData.GMDiamond-=1800,t.usersData.allPay-=is;break;case oe.PCUT_DIAMOND750:t.usersData.addDiamond(-4599,!1),t.usersData.DLDiamond+=4599,t.usersData.GMDiamond-=4599,t.usersData.allPay-=ns;break;case oe.UNLOCK_HIGHER:t.usersData.OpenAllProps(!1,!1),t.usersData.setCarrotTheme(oe.UNLOCK_HIGHER,!1,!1),t.usersData.allPay-=ss;break;case oe.HIGHER_STAYFLOOR:t.m_oHigher.saveDownLimite(!1),t.usersData.allPay-=rs;break;case oe.LIFE_10:t.usersData.addPlayTimes(-10),t.usersData.allPay-=as}},setCurLevel:function(e){this.mLevel=e},setProductPrices:function(){},buyProduct:function(e){if(!wr.getModel().usersData.IsDisablePayment()){this.retain(),this.mProductID=e;var t=ps[e];t&&t.length&&Ts(t)}},saveData:function(){wr.getActivedModel()},requestRestorePurchases:function(){},isNetConnect:function(){return!0},getNetwork:function(){return""},start_schedule_onPay:function(){l.director.getScheduler().schedule(this.schedule_onPay,this,0,!1,.5,0)},schedule_onPay:function(e){var t;new ls;cs.length>0&&(t=cs.shift());for(var i=0;i<us.length;i++){var n=us[i];if(n.productId==t){n,us.splice(i,1);break}}t.length&&this.onPay(t),this.release()},onPay:function(e){var t=wr.getModel(),i=gs(e);t.gameCenter&&t.gameCenter.sendAppsFlyerInfo(i+1);var n=!1;switch(i){case oe.DIAMOND_JIDI:t.usersData.addDiamond(200,!1),t.usersData.DLDiamond-=200,t.usersData.GMDiamond+=200,Tt.onBuy(null,"200宝石",1,kn),t.usersData.allPay+=Vn;break;case oe.DIAMOND300:t.usersData.addDiamond(800,!1),t.usersData.DLDiamond-=800,t.usersData.GMDiamond+=800,Tt.onBuy(null,"一小瓶宝石",1,Un),t.usersData.allPay+=Vn;break;case oe.DIAMOND480:t.usersData.addDiamond(1800,!1),t.usersData.DLDiamond-=1800,t.usersData.GMDiamond+=1800,Tt.onBuy(null,"一袋宝石",1,Hn),t.usersData.allPay+=Vn;break;case oe.DIAMOND750:t.usersData.addDiamond(4599,!1),t.usersData.DLDiamond-=4599,t.usersData.GMDiamond+=4599,Tt.onBuy(null,"一箱宝石",1,Vn),t.usersData.allPay+=Vn;break;case oe.LIFE_FOREVER:if(t.usersData.nomoreLostTime(!1),this.spMainFrame&&this.spMainFrame.getParent()){if(t.mCurSceneTarget==we.LEVELSEL){(l=this.spMainFrame.getParent())&&l.lifeForeverUpdate(),this.spMainFrame.setVisible(!1),this.spMainFrame.getParent()&&(n=!0),t.bLockMenu=!1}else if(t.mCurSceneTarget==we.LEVELSELCIRCLE){if(this.spMainFrame.getParent()){var s=this.spMainFrame.getParent();s&&s.lifeForeverUpdate()}this.spMainFrame.setVisible(!1),n=!0,t.bLockMenu=!1}else if(t.mCurSceneTarget==we.STOREY){var r=this.spMainFrame.getParent();r&&r.lifeForeverUpdate(),this.spMainFrame.setVisible(!1),n=!0,t.bLockMenu=!1}Tt.onBuy(null,"无限生命",1,zn),t.usersData.allPay+=zn}break;case oe.LIFE_FOREVER_PCUT:t.usersData.nomoreLostTime(!1),this.spMainFrame&&this.spMainFrame.getParent()&&(t.mCurSceneTarget==we.LEVELSEL?((h=this.spMainFrame.getParent())&&(h.lifeForeverUpdate(),h.ChangeDiscountMenuItem()),this.spMainFrame.setVisible(!1),n=!0):t.mCurSceneTarget==we.LEVELSELCIRCLE?((h=this.spMainFrame.getParent())&&(h.lifeForeverUpdate(),h.ChangeDiscountMenuItem()),this.spMainFrame.setVisible(!1),n=!0):t.mCurSceneTarget==we.STOREY&&((d=this.spMainFrame.getParent())&&(d.lifeForeverUpdate(),d.ChangeDiscountMenuItem()),this.spMainFrame.setVisible(!1),n=!0)),Tt.onBuy(null,"无限生命折扣",1,Yn),t.usersData.allPay+=Yn,t.bLockMenu=!1;break;case oe.PCUT_DIAMOND300:t.usersData.addDiamond(400,!1),t.usersData.DLDiamond-=400,t.usersData.GMDiamond+=400,this.spMainFrame&&(m=this.spMainFrame)&&m.changeStoneCount(),Tt.onBuy(null,"超值宝石",1,Xn),t.usersData.allPay+=Xn;break;case oe.GIRLCARROT:this.spMainFrame?(c=this.spMainFrame)&&c.BuyGirlCarrot():t.usersData.setCarrotFigure(ue.CARROT_GIRL,!1),Tt.onBuy(null,"母萝卜英雄",1,jn),t.usersData.allPay+=jn;break;case oe.FATCARROT:this.spMainFrame?(c=this.spMainFrame)&&c.BuyFatCarrot():t.usersData.setCarrotFigure(ue.CARROT_FAT,!1),Tt.onBuy(null,"肥萝英雄",1,Kn),t.usersData.allPay+=Kn;break;case oe.OLDCARROT:this.spMainFrame?(c=this.spMainFrame)&&c.BuyOldCarrot():t.usersData.setCarrotFigure(ue.CARROT_OLD,!1),Tt.onBuy(null,"老萝卜英雄",1,qn),t.usersData.allPay+=qn;break;case oe.PCUT_GIRLCARROT:t.usersData.setCarrotFigure(ue.CARROT_GIRL,!1),this.spMainFrame&&t.selLayer&&(this.spMainFrame.setVisible(!1),t.mCurSceneTarget==we.LEVELSEL?((h=t.selLayer)&&h.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.LEVELSELCIRCLE?((l=t.selLayer)&&l.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.STOREY&&((d=t.selLayer)&&d.ChangeDiscountMenuItem(),n=!0)),t.bLockMenu=!1,Tt.onBuy(null,"母萝卜英雄礼包",1,Qn),t.usersData.allPay+=12;break;case oe.PCUT_FATCARROT:t.usersData.setCarrotFigure(ue.CARROT_FAT,!1),this.spMainFrame&&t.selLayer&&(this.spMainFrame.setVisible(!1),t.mCurSceneTarget==we.LEVELSEL?((h=t.selLayer)&&h.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.LEVELSELCIRCLE?((l=t.selLayer)&&l.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.STOREY&&((d=t.selLayer)&&d.ChangeDiscountMenuItem(),n=!0)),t.bLockMenu=!1,Tt.onBuy(null,"肥萝英雄礼包",1,Zn),t.usersData.allPay+=Zn;break;case oe.PCUT_OLDCARROT:t.usersData.setCarrotFigure(ue.CARROT_OLD,!1),this.spMainFrame&&t.selLayer&&(this.spMainFrame.setVisible(!1),t.mCurSceneTarget==we.LEVELSEL?((h=t.selLayer)&&h.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.LEVELSELCIRCLE?((l=t.selLayer)&&l.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.STOREY&&((d=t.selLayer)&&d.ChangeDiscountMenuItem(),n=!0)),t.bLockMenu=!1,Tt.onBuy(null,"老萝卜英雄礼包",1,Zn),t.usersData.allPay+=18;break;case oe.GLODPACKAGE:if(this.spMainFrame&&(c=this.spMainFrame).BuyGlodPackage(),ms==_s)for(var a=t.usersData,o=0;o<5;o++){switch(o){case 0:a.getClearBBCount(),a.addClearBB(1,!1),a.DLClearBB-=1,a.GMClearBB+=1;break;case 1:break;case 2:a.getShootSPCount(),a.addShootSP(3,!1),a.DLShootSP-=3,a.GMShootSP+=3;break;case 3:a.getStopBBCount(),a.addStopBB(2,!1),a.DLStopBB-=2,a.GMStopBB+=2;break;case 4:a.getSlowBBCount(),a.addSlowBB(2,!0),a.DLSlowBB-=2,a.GMSlowBB+=2}}Tt.onBuy(null,"黄金礼包",1,$n),t.usersData.allPay+=$n;break;case oe.BIGPACKAGE:if(this.spMainFrame&&(c=this.spMainFrame).BuyBigGlodPackage(),ms==_s)for(var a=t.usersData,o=0;o<5;o++){switch(o){case 0:a.getClearBBCount(),a.addClearBB(1,!1),a.DLClearBB-=1,a.GMClearBB+=1;break;case 1:a.getCarrotHPCount(),a.addCarrotHP(2,!1),a.DLCarrotHP-=2,a.GMCarrotHP+=2;break;case 2:a.getShootSPCount(),a.addShootSP(5,!1),a.DLShootSP-=5,a.GMShootSP+=5;break;case 3:a.getStopBBCount(),a.addStopBB(3,!1),a.DLStopBB-=3,a.GMStopBB+=3;break;case 4:a.getSlowBBCount(),a.addSlowBB(3,!0),a.DLSlowBB-=3,a.GMSlowBB+=3}}Tt.onBuy(null,"白金礼包",1,es),t.usersData.allPay+=es;break;case oe.PCUT_BIGPACKAGE:a=t.usersData;Tt.onBuy(null,"超值白金礼包",1,ts),t.usersData.allPay+=ts;for(o=0;o<5;o++){switch(o){case 0:a.getClearBBCount(),a.addClearBB(1,!1),a.DLClearBB-=1,a.GMClearBB+=1;break;case 1:a.getCarrotHPCount(),a.addCarrotHP(2,!1),a.DLCarrotHP-=2,a.GMCarrotHP+=2;break;case 2:a.getShootSPCount(),a.addShootSP(5,!1),a.DLShootSP-=5,a.GMShootSP+=5;break;case 3:a.getStopBBCount(),a.addStopBB(3,!1),a.DLStopBB-=3,a.GMStopBB+=3;break;case 4:a.getSlowBBCount(),a.addSlowBB(3,!1),a.DLSlowBB-=3,a.GMSlowBB+=3}}this.spMainFrame.setVisible(!1),t.mCurSceneTarget==we.LEVELSEL?((h=t.selLayer)&&h.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.LEVELSELCIRCLE?((l=t.selLayer)&&l.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.STOREY&&((d=t.selLayer)&&d.ChangeDiscountMenuItem(),n=!0),t.bLockMenu=!1;break;case oe.PCUT_DIAMOND480:t.usersData.addDiamond(1800,!1),t.usersData.DLDiamond-=1800,t.usersData.GMDiamond+=1800,this.spMainFrame&&t.selLayer&&(this.spMainFrame.setVisible(!1),t.mCurSceneTarget==we.LEVELSEL?((h=t.selLayer)&&h.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.LEVELSELCIRCLE?((l=t.selLayer)&&l.ChangeDiscountMenuItem(),n=!0):t.mCurSceneTarget==we.STOREY&&((d=t.selLayer)&&d.ChangeDiscountMenuItem(),n=!0)),t.bLockMenu=!1,Tt.onBuy(null,"一袋宝石特惠",1,is),t.usersData.allPay+=is;break;case oe.PCUT_DIAMOND750:if(t.usersData.addDiamond(4599,!1),t.usersData.DLDiamond-=4599,t.usersData.GMDiamond+=4599,this.spMainFrame&&t.selLayer)if(this.spMainFrame.setVisible(!1),t.mCurSceneTarget==we.LEVELSEL){var h=t.selLayer;h&&h.ChangeDiscountMenuItem(),n=!0}else if(t.mCurSceneTarget==we.LEVELSELCIRCLE){var l=t.selLayer;l&&l.ChangeDiscountMenuItem(),n=!0}else t.mCurSceneTarget==we.STOREY&&((d=t.selLayer)&&d.ChangeDiscountMenuItem(),n=!0);t.bLockMenu=!1,Tt.onBuy(null,"一箱宝石特惠",1,ns),t.usersData.allPay+=ns;break;case oe.UNLOCK_HIGHER:t.usersData.OpenAllProps(!1),t.usersData.setCarrotTheme(oe.UNLOCK_HIGHER,!1),qi.preloadWithStoreyScene(we.STOREY,!1),Tt.onBuy(null,"解锁天天向上主题",1,ss),t.usersData.allPay+=ss;break;case oe.HIGHER_STAYFLOOR:if(ms==_s)t.m_oHigher.HigherEnter(),t.m_oHigher.saveDownLimite(),(d=t.selLayer)&&d.addBalloon(1);else{t.m_oHigher.saveDownLimite();var d=t.selLayer;d&&d.buyStayFloor()}Tt.onBuy(null,"保护气球",1,ss),t.usersData.allPay+=rs;break;case oe.LIFE_10:t.usersData.addPlayTimes(10);var c=this.spMainFrame;c&&c.buyStarFinish(),Tt.onBuy(null,"10颗生命星",1,as),t.usersData.allPay+=as;break;case oe.UNLOCK_THIRD:if(t.usersData.setNextPlayedLevel(),t.usersData.setCarrotTheme(oe.UNLOCK_THIRD,!1),this.spMainFrame&&this.spMainFrame.getParent())if(t.mCurSceneTarget==we.LEVELSEL)(u=this.spMainFrame.getParent())&&(this.spMainFrame.removeFromParentAndCleanup(!0),u.showLevelInfo(this.mLevel));else if(t.mCurSceneTarget==we.LEVELSELCIRCLE)(u=this.spMainFrame.getParent())&&(this.spMainFrame.removeFromParentAndCleanup(!0),u.showLevelInfo(this.mLevel));else if(t.mCurSceneTarget==we.STOREY){var u=this.spMainFrame.getParent();u&&(this.spMainFrame.removeFromParentAndCleanup(!0),u.showLevelInfo(this.mLevel))}Tt.onBuy(null,"解锁冰川主题",1,os),t.usersData.allPay+=os}if(this.spMainFrame&&this.mProductID==i)if(this.mProductID<oe.LIFE_FOREVER||this.mProductID>=oe.DIAMOND300&&this.mProductID<=oe.DIAMOND750){var p=this.spMainFrame;p&&p.changeStoneCount(),(m=this.spMainFrame.getParent())&&m.spMainFrame&&m.changeStoneCount()}else this.mProductID,oe.DIAMOND_PCUT;if(this.spMainFrame&&n){var m=this.spMainFrame;m?m.toClose():this.spMainFrame.removeChild(this.spMainFrame,!0)}},checkMissPay:function(){}});Ss.create=function(e,t){void 0==t&&(t=0),hs(),ms=t;var i=new Ss(e);return i.g_curShop=i,i};var ws=[{themeID:1,group:6,gold:800,enemyInterval:1,groupInterval:1,levelName:"level 1",blood:10,monsterGroup:[{index:1,team:[{name:"L11",count:5,blood:5,speed:180}]},{index:2,team:[{name:"L21",count:5,blood:10,speed:180}]},{index:3,team:[{name:"L21",count:5,blood:20,speed:180},{name:"L31",count:10,blood:15,speed:180}]},{index:4,team:[{name:"L11",count:5,blood:20,speed:180}]},{index:5,team:[{name:"L31",count:5,blood:40,speed:180},{name:"L11",count:5,blood:40,speed:180},{name:"L21",count:5,blood:45,speed:180}]},{index:6,team:[{name:"L31",count:5,blood:50,speed:180},{name:"L11",count:5,blood:50,speed:180},{name:"L21",count:5,blood:50,speed:180}]}]},{themeID:1,group:10,gold:750,enemyInterval:1,groupInterval:3,levelName:"level 2",bloodScale:.3,blood:10,monsterGroup:[{index:1,team:[{name:"F11",count:2,blood:10,speed:180},{name:"L31",count:8,blood:10,speed:180}]},{index:2,team:[{name:"F11",count:4,blood:10,speed:180},{name:"L21",count:5,blood:10,speed:180}]},{index:3,team:[{name:"F11",count:5,blood:15,speed:180},{name:"F21",count:5,blood:15,speed:180}]},{index:4,team:[{name:"L11",count:8,blood:20,speed:180},{name:"L31",count:2,blood:20,speed:180}]},{index:5,team:[{name:"F11",count:6,blood:33.15,speed:180},{name:"L11",count:2,blood:47.36,speed:180},{name:"P11",count:2,blood:56.84,speed:180}]},{index:6,team:[{name:"F11",count:2,blood:44.73,speed:180},{name:"L31",count:8,blood:63.9,speed:180}]},{index:7,team:[{name:"L11",count:8,blood:60.44,speed:180},{name:"F21",count:2,blood:45.31,speed:180}]},{index:8,team:[{name:"L31",count:4,blood:96.98,speed:180},{name:"P11",count:6,blood:116.38,speed:180}]},{index:9,team:[{name:"F11",count:5,blood:79.47,speed:180},{name:"F21",count:5,blood:79.47,speed:180}]},{index:10,team:[{name:"L11",count:5,blood:130.06,speed:180},{name:"F11",count:5,blood:91.04,speed:180},{name:"L21",count:5,blood:130.06,speed:180}]}]},{themeID:1,group:15,gold:900,enemyInterval:1,groupInterval:3,levelName:"level 3",bloodScale:.3,blood:10,monsterGroup:[{index:1,team:[{name:"L11",count:5,blood:5,speed:180},{name:"L21",count:5,blood:5,speed:180}]},{index:2,team:[{name:"L21",count:5,blood:10,speed:180},{name:"L31",count:5,blood:10,speed:180}]},{index:3,team:[{name:"L11",count:5,blood:15,speed:180},{name:"L31",count:5,blood:15,speed:180}]},{index:4,team:[{name:"L21",count:5,blood:20,speed:180},{name:"L11",count:5,blood:20,speed:180}]},{index:5,team:[{name:"P11",count:10,blood:50,speed:180}]},{index:6,team:[{name:"P11",count:2,blood:80,speed:180},{name:"L11",count:8,blood:60,speed:180}]},{index:7,team:[{name:"L31",count:4,blood:80,speed:180},{name:"P11",count:6,blood:100,speed:180}]},{index:8,team:[{name:"L21",count:4,blood:100,speed:180},{name:"L31",count:6,blood:100,speed:180}]},{index:9,team:[{name:"L11",count:2,blood:120,speed:180},{name:"P11",count:2,blood:140,speed:180},{name:"L21",count:6,blood:120,speed:180}]},{index:10,team:[{name:"L21",count:5,blood:150,speed:180},{name:"L31",count:5,blood:150,speed:180},{name:"P11",count:2,blood:200,speed:180}]},{index:11,team:[{name:"P11",count:2,blood:220,speed:180},{name:"L31",count:8,blood:170,speed:180}]},{index:12,team:[{name:"L21",count:4,blood:200,speed:180},{name:"L11",count:6,blood:200,speed:180}]},{index:13,team:[{name:"P11",count:6,blood:280,speed:180},{name:"L21",count:4,blood:240,speed:180}]},{index:14,team:[{name:"L11",count:8,blood:280,speed:180},{name:"P11",count:2,blood:340,speed:180}]},{index:15,team:[{name:"L21",count:5,blood:300,speed:180},{name:"P11",count:8,blood:350,speed:180}]}]},{themeID:1,group:10,gold:550,enemyInterval:1,groupInterval:3,levelName:"level 4",bloodScale:.3,blood:10,monsterGroup:[{index:1,team:[{name:"L11",count:5,blood:10,speed:180},{name:"L21",count:5,blood:10,speed:180}]},{index:2,team:[{name:"L21",count:5,blood:10,speed:180},{name:"L31",count:5,blood:10,speed:180}]},{index:3,team:[{name:"L31",count:2,blood:15.45,speed:180},{name:"L11",count:8,blood:15.45,speed:180}]},{index:4,team:[{name:"F11",count:4,blood:17.7,speed:180},{name:"L11",count:5,blood:20,speed:180}]},{index:5,team:[{name:"P11",count:10,blood:50,speed:180}]},{index:6,team:[{name:"P11",count:2,blood:80,speed:180},{name:"L11",count:8,blood:60,speed:180}]},{index:7,team:[{name:"L31",count:4,blood:80,speed:180},{name:"P11",count:6,blood:100,speed:180}]},{index:8,team:[{name:"L21",count:4,blood:100,speed:180},{name:"L31",count:6,blood:100,speed:180}]},{index:9,team:[{name:"L11",count:2,blood:120,speed:180},{name:"P11",count:2,blood:140,speed:180},{name:"L21",count:6,blood:120,speed:180}]},{index:10,team:[{name:"L21",count:5,blood:150,speed:180},{name:"L31",count:5,blood:150,speed:180},{name:"P11",count:2,blood:200,speed:180}]},{index:11,team:[{name:"P11",count:2,blood:220,speed:180},{name:"L31",count:8,blood:170,speed:180}]},{index:12,team:[{name:"L21",count:4,blood:200,speed:180},{name:"L11",count:6,blood:200,speed:180}]},{index:13,team:[{name:"P11",count:6,blood:280,speed:180},{name:"L21",count:4,blood:240,speed:180}]},{index:14,team:[{name:"L11",count:8,blood:280,speed:180},{name:"P11",count:2,blood:340,speed:180}]},{index:15,team:[{name:"L21",count:5,blood:300,speed:180},{name:"P11",count:8,blood:350,speed:180}]}]},{themeID:1,group:10,gold:550,enemyInterval:1,groupInterval:3,levelName:"level 5",bloodScale:.3,blood:10,monsterGroup:[{index:1,team:[{name:"L11",count:5,blood:10,speed:180},{name:"L21",count:5,blood:10,speed:180}]},{index:2,team:[{name:"L21",count:5,blood:10,speed:180},{name:"L31",count:5,blood:10,speed:180}]},{index:3,team:[{name:"L31",count:2,blood:15.45,speed:180},{name:"L11",count:8,blood:15.45,speed:180}]},{index:4,team:[{name:"F11",count:4,blood:17.7,speed:180},{name:"L11",count:5,blood:20,speed:180}]},{index:5,team:[{name:"P11",count:10,blood:50,speed:180}]},{index:6,team:[{name:"P11",count:2,blood:80,speed:180},{name:"L11",count:8,blood:60,speed:180}]},{index:7,team:[{name:"L31",count:4,blood:80,speed:180},{name:"P11",count:6,blood:100,speed:180}]},{index:8,team:[{name:"L21",count:4,blood:100,speed:180},{name:"L31",count:6,blood:100,speed:180}]},{index:9,team:[{name:"L11",count:2,blood:120,speed:180},{name:"P11",count:2,blood:140,speed:180},{name:"L21",count:6,blood:120,speed:180}]},{index:10,team:[{name:"L21",count:5,blood:150,speed:180},{name:"L31",count:5,blood:150,speed:180},{name:"P11",count:2,blood:200,speed:180}]},{index:11,team:[{name:"P11",count:2,blood:220,speed:180},{name:"L31",count:8,blood:170,speed:180}]},{index:12,team:[{name:"L21",count:4,blood:200,speed:180},{name:"L11",count:6,blood:200,speed:180}]},{index:13,team:[{name:"P11",count:6,blood:280,speed:180},{name:"L21",count:4,blood:240,speed:180}]},{index:14,team:[{name:"L11",count:8,blood:280,speed:180},{name:"P11",count:2,blood:340,speed:180}]},{index:15,team:[{name:"L21",count:5,blood:300,speed:180},{name:"P11",count:8,blood:350,speed:180}]}]},{themeID:1,group:10,gold:550,enemyInterval:1,groupInterval:3,levelName:"level 6",bloodScale:.3,blood:10,monsterGroup:[{index:1,team:[{name:"L11",count:5,blood:10,speed:180},{name:"L21",count:5,blood:10,speed:180}]},{index:2,team:[{name:"L21",count:5,blood:10,speed:180},{name:"L31",count:5,blood:10,speed:180}]},{index:3,team:[{name:"L31",count:2,blood:15.45,speed:180},{name:"L11",count:8,blood:15.45,speed:180}]},{index:4,team:[{name:"F11",count:4,blood:17.7,speed:180},{name:"L11",count:5,blood:20,speed:180}]},{index:5,team:[{name:"P11",count:10,blood:50,speed:180}]},{index:6,team:[{name:"P11",count:2,blood:80,speed:180},{name:"L11",count:8,blood:60,speed:180}]},{index:7,team:[{name:"L31",count:4,blood:80,speed:180},{name:"P11",count:6,blood:100,speed:180}]},{index:8,team:[{name:"L21",count:4,blood:100,speed:180},{name:"L31",count:6,blood:100,speed:180}]},{index:9,team:[{name:"L11",count:2,blood:120,speed:180},{name:"P11",count:2,blood:140,speed:180},{name:"L21",count:6,blood:120,speed:180}]},{index:10,team:[{name:"L21",count:5,blood:150,speed:180},{name:"L31",count:5,blood:150,speed:180},{name:"P11",count:2,blood:200,speed:180}]},{index:11,team:[{name:"P11",count:2,blood:220,speed:180},{name:"L31",count:8,blood:170,speed:180}]},{index:12,team:[{name:"L21",count:4,blood:200,speed:180},{name:"L11",count:6,blood:200,speed:180}]},{index:13,team:[{name:"P11",count:6,blood:280,speed:180},{name:"L21",count:4,blood:240,speed:180}]},{index:14,team:[{name:"L11",count:8,blood:280,speed:180},{name:"P11",count:2,blood:340,speed:180}]},{index:15,team:[{name:"L21",count:5,blood:300,speed:180},{name:"P11",count:8,blood:350,speed:180}]}]},{themeID:1,group:10,gold:550,enemyInterval:1,groupInterval:3,levelName:"level 7",bloodScale:.3,blood:10,monsterGroup:[{index:1,team:[{name:"L11",count:5,blood:10,speed:180},{name:"L21",count:5,blood:10,speed:180}]},{index:2,team:[{name:"L21",count:5,blood:10,speed:180},{name:"L31",count:5,blood:10,speed:180}]},{index:3,team:[{name:"L31",count:2,blood:15.45,speed:180},{name:"L11",count:8,blood:15.45,speed:180}]},{index:4,team:[{name:"F11",count:4,blood:17.7,speed:180},{name:"L11",count:5,blood:20,speed:180}]},{index:5,team:[{name:"P11",count:10,blood:50,speed:180}]},{index:6,team:[{name:"P11",count:2,blood:80,speed:180},{name:"L11",count:8,blood:60,speed:180}]},{index:7,team:[{name:"L31",count:4,blood:80,speed:180},{name:"P11",count:6,blood:100,speed:180}]},{index:8,team:[{name:"L21",count:4,blood:100,speed:180},{name:"L31",count:6,blood:100,speed:180}]},{index:9,team:[{name:"L11",count:2,blood:120,speed:180},{name:"P11",count:2,blood:140,speed:180},{name:"L21",count:6,blood:120,speed:180}]},{index:10,team:[{name:"L21",count:5,blood:150,speed:180},{name:"L31",count:5,blood:150,speed:180},{name:"P11",count:2,blood:200,speed:180}]},{index:11,team:[{name:"P11",count:2,blood:220,speed:180},{name:"L31",count:8,blood:170,speed:180}]},{index:12,team:[{name:"L21",count:4,blood:200,speed:180},{name:"L11",count:6,blood:200,speed:180}]},{index:13,team:[{name:"P11",count:6,blood:280,speed:180},{name:"L21",count:4,blood:240,speed:180}]},{index:14,team:[{name:"L11",count:8,blood:280,speed:180},{name:"P11",count:2,blood:340,speed:180}]},{index:15,team:[{name:"L21",count:5,blood:300,speed:180},{name:"P11",count:8,blood:350,speed:180}]}]},{themeID:1,group:10,gold:550,enemyInterval:1,groupInterval:3,levelName:"level 8",bloodScale:.3,blood:10,monsterGroup:[{index:1,team:[{name:"L11",count:5,blood:10,speed:180},{name:"L21",count:5,blood:10,speed:180}]},{index:2,team:[{name:"L21",count:5,blood:10,speed:180},{name:"L31",count:5,blood:10,speed:180}]},{index:3,team:[{name:"L31",count:2,blood:15.45,speed:180},{name:"L11",count:8,blood:15.45,speed:180}]},{index:4,team:[{name:"F11",count:4,blood:17.7,speed:180},{name:"L11",count:5,blood:20,speed:180}]},{index:5,team:[{name:"P11",count:10,blood:50,speed:180}]},{index:6,team:[{name:"P11",count:2,blood:80,speed:180},{name:"L11",count:8,blood:60,speed:180}]},{index:7,team:[{name:"L31",count:4,blood:80,speed:180},{name:"P11",count:6,blood:100,speed:180}]},{index:8,team:[{name:"L21",count:4,blood:100,speed:180},{name:"L31",count:6,blood:100,speed:180}]},{index:9,team:[{name:"L11",count:2,blood:120,speed:180},{name:"P11",count:2,blood:140,speed:180},{name:"L21",count:6,blood:120,speed:180}]},{index:10,team:[{name:"L21",count:5,blood:150,speed:180},{name:"L31",count:5,blood:150,speed:180},{name:"P11",count:2,blood:200,speed:180}]},{index:11,team:[{name:"P11",count:2,blood:220,speed:180},{name:"L31",count:8,blood:170,speed:180}]},{index:12,team:[{name:"L21",count:4,blood:200,speed:180},{name:"L11",count:6,blood:200,speed:180}]},{index:13,team:[{name:"P11",count:6,blood:280,speed:180},{name:"L21",count:4,blood:240,speed:180}]},{index:14,team:[{name:"L11",count:8,blood:280,speed:180},{name:"P11",count:2,blood:340,speed:180}]},{index:15,team:[{name:"L21",count:5,blood:300,speed:180},{name:"P11",count:8,blood:350,speed:180}]}]},{themeID:1,group:10,gold:550,enemyInterval:1,groupInterval:3,levelName:"level 9",bloodScale:.3,blood:10,monsterGroup:[{index:1,team:[{name:"L11",count:5,blood:10,speed:180},{name:"L21",count:5,blood:10,speed:180}]},{index:2,team:[{name:"L21",count:5,blood:10,speed:180},{name:"L31",count:5,blood:10,speed:180}]},{index:3,team:[{name:"L31",count:2,blood:15.45,speed:180},{name:"L11",count:8,blood:15.45,speed:180}]},{index:4,team:[{name:"F11",count:4,blood:17.7,speed:180},{name:"L11",count:5,blood:20,speed:180}]},{index:5,team:[{name:"P11",count:10,blood:50,speed:180}]},{index:6,team:[{name:"P11",count:2,blood:80,speed:180},{name:"L11",count:8,blood:60,speed:180}]},{index:7,team:[{name:"L31",count:4,blood:80,speed:180},{name:"P11",count:6,blood:100,speed:180}]},{index:8,team:[{name:"L21",count:4,blood:100,speed:180},{name:"L31",count:6,blood:100,speed:180}]},{index:9,team:[{name:"L11",count:2,blood:120,speed:180},{name:"P11",count:2,blood:140,speed:180},{name:"L21",count:6,blood:120,speed:180}]},{index:10,team:[{name:"L21",count:5,blood:150,speed:180},{name:"L31",count:5,blood:150,speed:180},{name:"P11",count:2,blood:200,speed:180}]},{index:11,team:[{name:"P11",count:2,blood:220,speed:180},{name:"L31",count:8,blood:170,speed:180}]},{index:12,team:[{name:"L21",count:4,blood:200,speed:180},{name:"L11",count:6,blood:200,speed:180}]},{index:13,team:[{name:"P11",count:6,blood:280,speed:180},{name:"L21",count:4,blood:240,speed:180}]},{index:14,team:[{name:"L11",count:8,blood:280,speed:180},{name:"P11",count:2,blood:340,speed:180}]},{index:15,team:[{name:"L21",count:5,blood:300,speed:180},{name:"P11",count:8,blood:350,speed:180}]}]}],vs={level:0,levelData:[],themeID:0,monsterGroup:[],group:0,maxGroup:0,_groupIndex:0,carrotBlood:0,gold:0,enemyInterval:0,groupInterval:0,levelName:0,_teamIndex:0,_teamCount:0,_teamMonsterCount:0,_teamMonsterIndex:0,isMonsterGetFinish:!1,_monsterDataArray:[],currMonsterDataPool:[],currMonsterPool:[],currBulletPool:[],isWin:!1,loadLevelData:function(e){this.level=e,this.levelData=ws[e],this.themeID=this.levelData.themeID,this.monsterGroup=this.levelData.monsterGroup,this.group=0,this.maxGroup=this.monsterGroup.length-1,this._groupIndex=0,this.carrotBlood=this.levelData.blood,this.gold=this.levelData.gold,this.enemyInterval=this.levelData.enemyInterval,this.groupInterval=this.levelData.groupInterval,this.levelName=this.levelData.levelName,this._teamIndex=0,this._teamCount=this.monsterGroup[0].team.length-1,this._teamMonsterIndex=0,this._teamMonsterCount=this.monsterGroup[0].team[0].count-1,this.isMonsterGetFinish=!1,this._monsterDataArray=[],this.currMonsterDataPool=[],this.currMonsterPool=[],this.currBulletPool=[],this.isWin=!1,this._loadMonsterData()},_loadMonsterData:function(){var e,t,i,n={};for(this._monsterDataArray=[],e=0;e<this.monsterGroup.length;e++)for(this._monsterDataArray[e]=[],t=0;t<this.monsterGroup[e].team.length;t++)for(i=0;i<this.monsterGroup[e].team[t].count;i++)n=this._getNextMonsterData(),this._monsterDataArray[e].push(n)},_getNextMonsterData:function(){if(1!=this.isMonsterGetFinish){var e=this.monsterGroup[this._groupIndex].team[this._teamIndex],t={};return t.group=this._groupIndex,t.name=e.name,t.blood=e.blood,t.speed=e.speed,t.index=this._teamMonsterIndex,++this._teamMonsterIndex>this._teamMonsterCount&&this._enterNextTeam(),t}l.warn("GameManager._getNextMonsterData() : 所有怪物数据已经获取完毕！")},popNextMonsterGroupData:function(){var e=[];if(this.group<=this.maxGroup){this.group++,e=this._monsterDataArray[0],this._monsterDataArray.splice(0,1);var t=new l.EventCustom(E.EventName.GP_UPDATE_GROUP);t.setUserData({group:this.group}),l.eventManager.dispatchEvent(t)}else e=[];return e},_enterNextTeam:function(){this._teamMonsterIndex=0,++this._teamIndex>this._teamCount?this._enterNextGroup():this._teamMonsterCount=this.monsterGroup[this._groupIndex].team[this._teamIndex].count-1},_enterNextGroup:function(){++this._groupIndex>this.maxGroup?this.isMonsterGetFinish=!0:(this._teamIndex=0,this._teamCount=this.monsterGroup[this._groupIndex].team.length-1,this._teamMonsterIndex=0,this._teamMonsterCount=this.monsterGroup[this._groupIndex].team[this._teamIndex].count-1)},getCurrGroupMonsterSum:function(){for(var e=0,t=this.monsterGroup[this.group-1].team,i=0;i<t.length;i++)e+=t[i].count;return e},subtractCarrotBlood:function(){this.carrotBlood=this.carrotBlood<=0?0:this.carrotBlood-1;var e=new l.EventCustom(E.EventName.GP_UPDATE_CARROT_BLOOD);if(e.setUserData({blood:this.carrotBlood}),l.eventManager.dispatchEvent(e),this.carrotBlood<=0){var t=new l.EventCustom(E.EventName.GP_GAME_OVER);t.setUserData({isWin:!1}),l.eventManager.dispatchEvent(t)}},getLevel:function(){return this.level},setLevel:function(e){this.level=e},getLevelData:function(){return this.levelData},getThemeID:function(){return this.themeID},getMonsterGroup:function(){return this.monsterGroup},getGroup:function(){return this.group},getMaxGroup:function(){return this.maxGroup},getGold:function(){return this.gold},getEnemyInterval:function(){return this.enemyInterval},getGroupInterval:function(){return this.groupInterval},getLevelName:function(){return this.levelName},getCarrotBlood:function(){return this.carrotBlood},setCarrotBlood:function(e){this.carrotBlood=e},getCurrMonsterDataPool:function(){return this.currMonsterDataPool},getCurrMonsterPool:function(){return this.currMonsterPool},getCurrBulletPool:function(){return this.currBulletPool},getIsWin:function(){return this.isWin},setIsWin:function(e){this.isWin=e}},Ls={UISpace:400},Ms=l.Class.extend({ctor:function(){this._windows=[]},open:function(e,t,i,n){return i=i||!0,void 0!=e&&i?(n=n||!0,t?void qu.loadResAsync(t,function(){return this.openTargetClass(e,n)}.bind(this)):this.openTargetClass(e,n)):null},openTargetClass:function(e,t){var i=this.current(e);if(i)return i;var n=this.top(),s=l.director.getRunningScene(),r=new e;if(null==r)return null;var a=n?n.getLocalZOrder()+Ls.UISpace:Ls.UISpace;if(s.addChild(r,a),t){var o=l.color(0,0,0,180),h=new l.LayerColor(o);h&&(h.setPosition(0,0),h.setContentSize(nr.share().getWinSize()),r.addChild(h))}return this._windows.push(r),r},current:function(e){if(!e)return this.top();for(var t=this._windows.length-1;t>=0;--t){var i=this._windows[t];try{if(i===e||i instanceof e)return i}catch(e){}}return null},count:function(){return this._windows.length},exist:function(e){for(var t=this._windows.length-1;t>=0;--t)for(var i=this._windows[t],n=arguments.length-1;n>=0;--n)if(i instanceof arguments[n])return!0;return!1},top:function(){var e=this._windows.length;return e?this._windows[e-1]:null},bottom:function(){return this._windows.length?this._windows[0]:null},close:function(e){var t=this.current(e);if(t){var i=this._windows.indexOf(t);t.removeFromParent(!0),this._windows.splice(i,1)}},closeGroup:function(e){for(var t=this._windows.length-1;t>=0;--t)for(var i=this._windows[t],n=0,s=arguments.length;n<s;++n)if(i instanceof arguments[n]){t==this._windows.length-1&&t,i.removeFromParent(!0),this._windows.splice(t,1);break}},closeExcept:function(e){for(var t=this._windows.length-1;t>=0;--t){var i=this._windows[t];i instanceof e||(t==this._windows.length-1&&t,i.removeFromParent(!0),this._windows.splice(t,1))}},closeAll:function(){for(var e=this._windows.length-1;e>=0;--e)this._windows[e].removeFromParent(!0);this._windows.splice(0)},_windows:null});Ms.getInstance=function(){return this.instance||(this.instance=new Ms),this.instance};var Cs={NORMAL:1,SELECT:2,DISABLE:3},ys=l.Layer.extend({ctor:function(e,t){this._super(),this._btnState=Cs.NORMAL,this._menuBtn=this.menuItemWithFile(e,t);var i=new l.Menu(this._menuBtn,null);i.setPosition(0,0),this.addChild(i,2)},menuItemWithFile:function(e,t){t=t||e,this._normalItem=new l.Sprite(e),this._selectItem=new l.Sprite(t);var i=new l.MenuItemSprite(this._normalItem,this._selectItem,null,this,this.eventCallBack.bind(this));return i.setPosition(l.p(0,0)),i},bindCallBack:function(e){this._callBack=e},eventCallBack:function(e){this._btnState!=Cs.DISABLE&&this._callBack&&this._callBack(this)},addCovergeImage:function(e){if(this._normalItem&&((t=new l.Sprite(e)).setAnchorPoint(.5,.5),t.setPosition(.5*this._normalItem.getContentSize().width,.5*this._normalItem.getContentSize().height),this._normalItem.addChild(t)),this._selectItem){var t=new l.Sprite(e);t.setAnchorPoint(.5,.5),t.setPosition(.5*this._selectItem.getContentSize().width,.5*this._selectItem.getContentSize().height),this._selectItem.addChild(t)}},addBottomImage:function(e){var t=new l.Sprite(e);this.addChild(t)},setBtnState:function(e){this._btnState=e},_btnState:null,_callBack:null,_normalItem:null,_selectItem:null,_menuBtn:null}),Bs=l.Sprite.extend({scope:0,bulletSpeed:10,bulletMoveTime:0,fireTargetPos:null,row:-1,cel:-1,gridIndex:-1,bRotate:!0,bCross:!1,bOutSearch:!1,bFirstShoot:!1,bProjRotate:!1,bShowUpdateTip:!1,fMaxWastTime:0,fPowerBuff:0,nBuffFlag:0,fLastShootTimes:0,fLastShootSystemTime:0,tower:null,define:null,rcRange:null,nRange:0,target:null,nShootRange:100,projectCover:null,projectiles:null,nSpeedLastTime:0,spSpeed:null,nCurLevel:1,nEndIndex:0,nStartIndex:0,_className:"Tower",ctor:function(){this._super(),this.bRotate=0,this.bCross=0,this.bOutSearch=0,this.bFirstShoot=0,this.bProjRotate=0,this.bShowUpdateTip=0,this.fMaxWastTime=0,this.fPowerBuff=0,this.nBuffFlag=0,this.fLastShootSystemTime=0,this.fLastShootTimes=0,this.nCurLevel=0,this.define=null,this.nRange=0,this.nShootRange=0,this.rcRange=l.rect(0,0,0,0),this.nStartIndex=0,this.nEndIndex=0,this.target=null,this.tower=null,this.nSpeedLastTime=0,this.projectiles=null,this.projectCover=null,this.spSpeed=null},initWithType:function(e,t,i,n,s){var r=wr.getModel(),a=r.getObjectByType(e);this.define=a;for(var o=null,h=null,d=0;d<2&&(o=String.formatC(a.strPic,-1,s),null==(h=l.spriteFrameCache.getSpriteFrame(o)))&&(o=String.formatC(a.strPic,-1,1),null==(h=l.spriteFrameCache.getSpriteFrame(o))&&(o=String.formatC(a.strPic,s,1),h=l.spriteFrameCache.getSpriteFrame(o)),null==h);d++){var c=r.gameLayer;null==c.additionalTowers&&(c.additionalTowers=[]),l.spriteFrameCache.addSpriteFrames(a.strPicGroup),c.additionalTowers.push(e)}this.initWithSpriteFrame(h);var u=[];return this.projectiles=u,this.nCurLevel=parseInt(s),this.nStartIndex=-1,this.nEndIndex=-1,this.fLastShootTimes=1e3,this.fLastShootSystemTime=0,this.target=null,this.bRotate=t,this.bCross=n,this.bProjRotate=i,this.bShowUpdateTip=!1,this.addTowerGunWithLevel(s),this.schedule(this.checkShootMonster,As),this},loadProperty:function(e){l.assert(e.scope>0,"TowerBase.loadProperty() : scope必须大于0！"),l.assert(e.bulletSpeed>0,"TowerBase.loadProperty() : bulletSpeed必须大于0！"),this.scope=e.scope,this.bulletSpeed=e.bulletSpeed,this.bulletMoveTime=100/this.bulletSpeed,this.setPosition(e.x,e.y),this.setName(e.name)},rectWidthSprite:function(e,t){void 0===t&&(t=1);var i=e.getContentSize();return l.rect(e.x-.5*i.width*t,e.y-.5*i.height*t,i.width*t,i.height*t)},projFlyDuration:function(e){var t=l.pDistance(e,this._position);return this.define.nProjFlySpeed>0?t/=this.define.nProjFlySpeed:t=0,t},rotateAngle:function(e,t){var i=this.tower.getRotation(),n=e,s=n._position;if(n.define.type>J.OBJECTEND&&(s=n.getPointWithTime(t)),n){s=l.pSub(s,this._position);var r=l.pToAngle(s);(i=l.radiansToDegrees(-1*r)+90-i)>180?i-=360:i<-180&&(i+=360)}return i},isInRange:function(e,t){var i=this.nShootRange,n=!1,s=e;if(!s)return!1;var r=s.define.type,a=.42*s.width;if(r<J.OBJECTEND){var o=.42*s.height;if(a==o){c=i+a;n=(m=l.pDistance(s._position,this._position))<c}else{p=l.pLerp(this._position,s._position,i/l.pDistance(this._position,s._position));if(0==(n=l.rectContainsPoint(this.rectWidthSprite(s),p)))for(var h=1;h<5;h++){var d=l.p(s.x-(h%2==1?1:-1)*a,s.y-(h<3?-1:1)*o);if(n=(m=l.pDistance(this._position,d))<i)break}}}else{var c=i+.6*a,u=l.director.getScheduler().getTimeScale(),p=s.getPointWithTime((t?this.fMaxWastTime:this.projFlyDuration(s._position))/u),m=l.pDistance(p,this._position);n=m<c}return n},findFirstCreepInRange:function(){var e=wr.getModel();this.target=null;var t=e.curSelGoods;if(t&&t.curHPTOBe>0&&this.isInRange(t,!0)&&(this.target=e.curSelGoods),null!=this.target||e.curCreepCount<1)null==this.target&&e.superBoss&&this.isInRange(e.superBoss,!0)&&(this.target=e.superBoss);else{for(var i=0;i<e.curIndexEnd;i++){var n=e.getIndexOfCreepsByID(i);if(!(n<0)&&n<e.creeps.length){var s=e.creeps[n];if(s&&s.curHP>0&&s.curHPTOBe>0&&this.isInRange(s,!0)){this.target=s;break}}}null==this.target&&e.superBoss&&this.isInRange(e.superBoss,!0)&&(this.target=e.superBoss)}},addPowerBuff:function(e,t){if(!(this.nBuffFlag&t&&e>0||e<0&&!(this.nBuffFlag&t))){l.log("addPowerBuff:"+t);var i=wr.getModel().animeLayer;0==this.nBuffFlag&&i.showBuffFalshWithTowe(this._position),this.fPowerBuff+=e,e>0?this.nBuffFlag|=t:this.nBuffFlag&=~t,0==this.nBuffFlag&&i.moveBuffFalsh(this._position)}},checkShootMonster:function(e){this.findFirstCreepInRange(),this.target&&(this.unschedule(this.checkShootMonster),this.fLastShootTimes=1e3,this.towerRotate())},changeShoot:function(e){var t=e;if(null!=t){var i=this.isInRange(t,!0),n=!1;if(t.bSelect){if(t==this.target)return;if(i)n=!0;else{if(!this.target||!this.target.bSelect)return;n=!1}}else{if(t!=this.target)return;n=!1}if(this.unschedule(this.towerLockCreeps),this.unschedule(this.checkShootMonster),this.define.type==J.TBALL||this.define.type==J.TFLASHLIGHT||this.define.type==J.TFIREBOTTLE){for(var s in this.projectiles){var r=this.projectiles[s];r&&r.visible&&r.stopBeat()}}this.toFirstPic(),n?(this.target=e,this.towerRotate()):(this.target=null,this.schedule(this.checkShootMonster,As))}},towerRotate:function(){var e=this.target,t=this.define.type;if(null!=e)if(this.bRotate){var i=this.rotateAngle(e,0),n=Math.abs(i)/Os;t>J.OBJECTEND&&(i=this.rotateAngle(e,n),n=Math.abs(i)/Os*.8);var s=l.rotateBy(n,i),r=null;r=t==J.TFIREBOTTLE||t==J.TFLASHLIGHT?l.callFunc(this.towerShoot,this):l.callFunc(this.startShoot,this);var a=l.sequence(s,r);a.setTag(rr.TROTATE),this.tower.runAction(a)}else t==J.TBALL?this.towerShoot():this.startShoot();else this.schedule(this.checkShootMonster,As)},getAnimate:function(e){for(var t=[],i=2;i<=this.define.nPicCount;++i)t.push(l.spriteFrameCache.getSpriteFrame(String.formatC(this.define.strPic,this.nCurLevel,i)));var n=new l.Animation(t,this.define.fSpanSecond);this.define.type>=J.CSNOW?n.setRestoreOriginalFrame(!1):n.setRestoreOriginalFrame(!0);var s=null;return(s=e?l.repeatForever(l.animate(n)):l.animate(n)).setTag(rr.REPEATACTION),s},towerShoot:function(){var e=null,t=this.define.type;e=t==J.TSUN||t==J.TMOON||t==J.TSNOW?l.rotateBy(this.define.fSpanSecond,this.define.nRotateDegrs):this.getAnimate(t==J.TFLASHLIGHT);var i=l.callFunc(this.towerFire,this);if(t==J.TARROW||t==J.TCUTTLE||t==J.TFISH){var n=this.nCurLevel-1;if(n<this.define.exPower.length){var s=this.define.exPower[n];if(null!=s)for(var r=s.nPowerPort,a=0;a<r;a++)this.createProj(!1)}}else this.createProj(!1);if(t==J.TFLASHLIGHT)this.tower.runAction(e),this.towerFire();else{var o=null;switch(this.define.type){case J.CSNOW:for(var h=[],a=1;a<5;a++)h.push(l.spriteFrameCache.getSpriteFrame(String.formatC(this.define.strPic,this.nCurLevel,4)));for(d=0;d<2;d++)for(a=5;a<9;++a)h.push(l.spriteFrameCache.getSpriteFrame(String.formatC(this.define.strPic,this.nCurLevel,a)));h.push(l.spriteFrameCache.getSpriteFrame(String.formatC(this.define.strPic,this.nCurLevel,1))),(c=new l.Animation(h,this.define.fSpanSecond)).setRestoreOriginalFrame(!1),(o=l.animate(c)).setTag(rr.MONSTERCM);break;case J.CROCKET:for(var h=[],a=1;a<5;a++)h.push(l.spriteFrameCache.getSpriteFrame(String.formatC(this.define.strPic,this.nCurLevel,4)));for(var d=0;d<4;d++)for(a=5;a<7;++a)h.push(l.spriteFrameCache.getSpriteFrame(String.formatC(this.define.strPic,this.nCurLevel,a)));h.push(l.spriteFrameCache.getSpriteFrame(String.formatC(this.define.strPic,this.nCurLevel,1)));var c=new l.Animation(h,this.define.fSpanSecond);c.setRestoreOriginalFrame(!1),(o=l.animate(c)).setTag(rr.MONSTERCM)}var u=[];e&&u.push(e),i&&u.push(i),o&&u.push(o);var p=l.sequence(u);if(p.setTag(rr.TSTARTSHOOT),t==J.TBOOMERANG){var m=this.tower.getChildByTag(1);m&&m.runAction(p)}else this.tower.runAction(p)}},showTower:function(e){var t=this.tower.getChildByTag(1);t&&t.setVisible(e)},findFirstWithType:function(e,t){var i=this.projectiles.length,n=-1;if(i<1)return n;var s=0;if(s=0==e?this.nStartIndex:this.nEndIndex,n=s+1,(n%=i)>=0&&n<this.projectiles.length){var r=this.projectiles[n];do{if(null==r)break;if(r.nState==e&&r.bChild==t)return n;if(n++,!((n%=i)<this.projectiles.length))break;r=this.projectiles[n]}while(n!=this.nEndIndex)}return n>=0&&n<this.projectiles.length&&(r=this.projectiles[n])&&r.nState==e?n:-1},createProj:function(e){var t=this.define.type,i=e?-1:this.findFirstWithType(2,e),n=null;if(i>-1&&i<this.projectiles.length&&(n=this.projectiles[i]),null==n){switch(t){case J.TICEFAN:(n=Ds.create()).init(this,this.target,e);break;case J.TBOOMERANG:(n=Ws.create()).init(this,this.target,e);break;case J.TROCKET:case J.CROCKET:(n=xs.create()).init(this,this.target,e);break;case J.TPLANE:(n=Vs.create()).init(this,this.target,e),n.setPosition(this._position),n.setAnchorPoint(.5,0);break;case J.TFIREBOTTLE:(n=Ns.create()).init(this,this.target,e),n.setPosition(l.pAdd(this._position,l.p(0,.7*this.height))),n.setAnchorPoint(.5,0);break;case J.TFLASHLIGHT:(n=ks.create()).init(this,this.target,e),n.setPosition(l.pAdd(this._position,l.p(0,.7*this.height))),n.setAnchorPoint(.5,0);break;case J.TBALL:if(!(this.projectiles.length<this.nCurLevel))return;(n=Gs.create()).init(this,this.target,e),n.setPosition(this._position),n.setAnchorPoint(.5,0);break;case J.TSUN:case J.TMOON:case J.TSNOW:case J.CSNOW:(n=Us.create()).init(this,this.target,e),t==J.CSNOW?((s=l.p(0,.25*this.tower.getBoundingBox().height)).x+=this.x,s.y+=this.y,n.setPosition(s)):n.setPosition(this._position),n.setAnchorPoint(.5,.5);break;case J.TARROW:(n=Hs.create()).init(this,this.target,e),n.setPosition(this._position),n.setAnchorPoint(.5,0);break;case J.TCUTTLE:(n=Hs.create()).init(this,this.target,e),n.setAnchorPoint(.5,.5),n.setPosition(this._position);break;case J.TFISH:(n=Hs.create()).init(this,this.target,e),(s=l.p(0,.72*this.height)).x+=this.x,s.y+=this.y,n.setPosition(s),n.setAnchorPoint(.5,0);break;case J.TBOTTLE:case J.TPIN:(n=Rs.create()).init(this,this.target,e);var s=l.p(0,.72*this.height);s.x+=this.x,s.y+=this.y,n.setPosition(s),n.setAnchorPoint(.5,0);break;default:(n=Rs.create()).init(this,this.target,e)}this.getParent().addChild(n,sr.LPROJECT),this.projectiles.push(n),i=this.projectiles.length-1}n.setMonster(this.target),n.nState=0,t==J.TBALL&&n.setVisible(!1),this.nEndIndex=i},towerFire:function(){var e=this.findFirstWithType(0,!1);this.nStartIndex=e;var t=null;if(e>=0&&e<this.projectiles.length&&(t=this.projectiles[e]),null==t)return this.unschedule(this.towerLockCreeps),void this.schedule(this.checkShootMonster,As);var i=t.getMonster();if(null==i)return this.unschedule(this.towerLockCreeps),void this.schedule(this.checkShootMonster,As);var n=this.define.type;if(n!=J.CSNOW&&n!=J.TSUN&&n!=J.TMOON&&n!=J.TSNOW&&(i.curHPTOBe<1||0==this.isInRange(i,!1))){if(this.findFirstCreepInRange(),null==this.target){if(t.setMonster(null),t.nState=2,this.bOutSearch||n==J.TBALL||n==J.TFLASHLIGHT||n==J.TFIREBOTTLE){if(this.bOutSearch=!1,this.unschedule(this.towerLockCreeps),n==J.TFLASHLIGHT){this.tower.stopAllActions();var s=String.formatC(this.define.strPic,this.nCurLevel,1),r=l.spriteFrameCache.getSpriteFrame(s);this.tower.setSpriteFrame(r)}this.schedule(this.checkShootMonster,As)}return}t.setMonster(this.target)}t.fly();var a=wr.getModel();if(a)if(n==J.TFIREBOTTLE){var o=parseInt(1e4*Math.random())%10;o=o%2+1;var h=String.formatC(this.define.strShootMuic,o);a.playSoundWithFile(h)}else a.playSoundWithFile(this.define.strShootMuic)},startShoot:function(){this.bOutSearch=!0,this.bFirstShoot=!0,this.schedule(this.towerLockCreeps)},towerLockCreeps:function(e){var t=wr.getModel(),i=this.target;if(null==i||i.curHPTOBe<1||i.curHP<1||!this.bFirstShoot&&0==this.isInRange(this.target,!0)||i==t.superBoss&&i!=t.curSelGoods&&t.curCreepCount>0){if(!(i==t.superBoss&&i!=t.curSelGoods&&t.curCreepCount>0))return this.unschedule(this.towerLockCreeps),void(this.bOutSearch&&(this.bOutSearch=!1,this.define.type>=J.CSNOW?this.schedule(this.checkShootMonster,2):this.schedule(this.checkShootMonster,As)));for(var n=null,s=0;s<t.curIndexEnd;s++){var r=t.getIndexOfCreepsByID(s);if(!(r<0)&&r<t.creeps.length){var a=t.creeps[r];if(a&&a.curHP>0&&a.curHPTOBe>0&&this.isInRange(a,!0)){n=a;break}}}if(n)return this.unschedule(this.towerLockCreeps),void(this.bOutSearch&&(this.bOutSearch=!1,this.define.type>=J.CSNOW?this.schedule(this.checkShootMonster,2):this.schedule(this.checkShootMonster,As)))}if(i&&this.bRotate&&i.define.type>J.OBJECTEND){var o=l.pSub(i._position,this._position),h=l.pToAngle(o);this.tower.setRotation(l.radiansToDegrees(-1*h)+90)}this.bFirstShoot=!1,this.fLastShootTimes+=e;var d=this.nCurLevel-1;if(this.define.nShootSpeed&&d<this.define.nShootSpeed.length){var c=this.define.nShootSpeed[d];if(null!=c){var u=.001*c*(t=wr.getModel()).nSpeedMultiples,p=t.getCurSystemTime()-this.fLastShootSystemTime;(0==this.fLastShootSystemTime||p*l.director.getScheduler().getTimeScale()>u)&&this.fLastShootTimes>u&&(this.fLastShootTimes=1e-8,this.fLastShootSystemTime=t.getCurSystemTime(),this.define.type==J.TBOOMERANG&&this.unschedule(this.towerLockCreeps),this.towerShoot())}}},showSpeedFlashWithTower:function(){null==this.spSpeed?(this.spSpeed=new l.Sprite("PSpeed01.png"),this.spSpeed.setPosition(this.width/2,this.height/2),this.addChild(this.spSpeed,-2)):this.spSpeed.setVisible(!0),this.spSpeed.setOpacity(0),this.spSpeed.runAction(l.repeatForever(l.sequence(l.fadeTo(.3,255),l.delayTime(.1),l.fadeTo(.1,204),l.fadeTo(.3,0)))),this.schedule(this.speedCall,1)},speedCall:function(e){15==++this.nSpeedLastTime&&(this.nSpeedLastTime=0,this.unschedule(this.speedCall),this.spSpeed&&(this.spSpeed.stopAllActions(),this.spSpeed.setVisible(!1)))},toFirstPic:function(){this.unscheduleAllCallbacks(),this.tower.stopAllActions(),this.define.type==J.TBOOMERANG&&(t=this.tower.getChildByTag(1)).stopAllActions(),this.nSpeedLastTime>0&&this.showSpeedFlashWithTower();var e=null;if(this.define.type==J.TBOOMERANG){var t=this.tower.getChildByTag(1);t.stopAllActions(),e=String.formatC(this.define.strPic,-2,this.nCurLevel);var i=l.spriteFrameCache.getSpriteFrame(e);this.tower.setSpriteFrame(i),e=String.formatC(this.define.strPic,this.nCurLevel,1),i=l.spriteFrameCache.getSpriteFrame(e),t.setSpriteFrame(i);for(var n in this.projectiles)(s=this.projectiles[n])&&s.stopBeat();this.showTower(!0),this.unschedule(this.towerLockCreeps)}else e=String.formatC(this.define.strPic,this.nCurLevel,1),(i=l.spriteFrameCache.getSpriteFrame(e))&&(this.define.type==J.TBALL&&this.setSpriteFrame(i),this.tower&&this.tower.setSpriteFrame(i));for(var n in this.projectiles){var s=this.projectiles[n];s&&0==s.nState&&(s.nState=2,s.setMonster(null))}},setShootRange:function(){var e=this.getBoundingBox();this.nRange=this.define.nShootRange[this.nCurLevel-1];var t=.5*(this.nRange-e.width),i=.5*(this.nRange-e.height);this.rcRange=l.rect(e.x-t,e.y-i,this.nRange,this.nRange),this.nShootRange=.71*this.nRange,this.fMaxWastTime=(this.define.nPicCount-1)*this.define.fSpanSecond+(this.nShootRange+.35*e.width)/this.define.nProjFlySpeed},updateTower:function(){this.nCurLevel++,this.toFirstPic();var e=this.define.type;for(var t in this.projectiles){var i=this.projectiles[t];i&&(e==J.TFLASHLIGHT||e==J.TPLANE||e==J.TFIREBOTTLE?i.stopBeat():e==J.TBALL?i.stopBeat():e==J.TBOOMERANG&&(i.stopBeat(),this.unschedule(this.towerLockCreeps)))}var n=wr.getModel();n.usersData.towerUpdate++,n.animeLayer.showUpdateFalshWithTowe(this),this.setShootRange(),e==J.TBOTTLE&&3==this.nCurLevel&&n.addTowerBuff(this);var s=String.formatC(this.define.strPic,-1,this.nCurLevel),r=l.spriteFrameCache.getSpriteFrame(s);r&&this.setSpriteFrame(r),e==J.TBALL?(this.unschedule(this.checkShootMonster),this.schedule(this.checkShootMonster,As)):(this.findFirstCreepInRange(),this.target?this.towerRotate():this.schedule(this.checkShootMonster,As)),3==this.nCurLevel&&n.towerTask(e,3)},sellTower:function(){this.setVisible(!1);var e=wr.getModel();e.usersData.towerSell++,e.animeLayer.showDustWithPt(this._position,1),e.towerTask(this.define.type,-1),this.unscheduleAllCallbacks(),this.tower.stopAllActions();var t=this.define.type;for(var i in this.projectiles){var n=this.projectiles[i];if(n){if(1==n.nState&&n.getMonster()&&n.getMonster().isVisible()){var s=n.getMonster();if(s){var r=n.nLevel-1;if(r<this.define.nPower.length){var a=this.define.nPower[r];void 0!==a&&null!==a&&(s.curHPTOBe+=parseInt(a*(1+this.fPowerBuff)))}}}t!=J.TBALL&&t!=J.TFLASHLIGHT&&t!=J.TFIREBOTTLE||n.stopBeat(),n.getParent()&&n.getParent().removeChild(n,!0)}}t==J.TBOTTLE&&3==this.nCurLevel&&e.moveTowerBuff(this),e.animeLayer.moveBuffFalsh(this._position),this.projectiles=null,this.define=null,this.target=null,this.tower=null},projSplit:function(e){var t=wr.getModel();if(!(t.objects.length<1)){var i=this.nCurLevel-1;if(!(i>=this.define.exPower.length)){var n=this.define.exPower[i];if(null!=n)for(var s=n.nLastSecond,r=-1,a=s;a>0;a--){var o=this.findFirstWithType(2,!0);if(o<0&&(this.createProj(!0),o=this.nEndIndex),this.nStartIndex=o,o<this.projectiles.length){var h=this.projectiles[o],d=t.objects.length;if(h&&d>0){var c=F()%d;if(r==c&&(c=(c+1)%d),c<t.objects.length){for(var u=t.objects[c],p=-1;u&&(u.curHPTOBe<1||u.curHP<1)&&p<d;)u=(c=(c+1)%d)<t.objects.length?t.objects[c]:null,p++;if(u&&p<d)if(r=c,h.setMonster(u),1==s)h.splitFly(e);else{m=h.getContentSize();h.splitFly(l.pAdd(e,l.p(0,.5*m.height*(s-a-1))))}}}else if(1==d)if(h.setMonster(t.objects[0]),1==s)h.splitFly(e);else{var m=h.getContentSize();h.splitFly(l.pAdd(e,l.p(0,.5*m.height*(s-a-1))))}}}}}},curMoneyForUpdate:function(){return this.nCurLevel>=this.define.nLevelCount?0:this.define.nBuyMoney[this.nCurLevel]},curMoneyForSell:function(){for(var e=0,t=0;t<this.nCurLevel;t++)e+=this.define.nBuyMoney[t];return.8*e},addTowerGunWithLevel:function(e){var t=this.define;if(t.type==J.TBOOMERANG){var i=String.formatC(t.strPic,-2,e),n=l.spriteFrameCache.getSpriteFrame(i),s=new l.Sprite(n);s.setPosition(.5*this.width,.5*this.height),this.addChild(s,1,1),i=String.formatC(t.strPic,e,1),n=l.spriteFrameCache.getSpriteFrame(i),(r=new l.Sprite(n)).setPosition(.5*this.width,.5*this.height),s.addChild(r,1,1),this.tower=s}else{i=String.formatC(t.strPic,e,1);(n=l.spriteFrameCache.getSpriteFrame(i))||(l.log("!!! no find SpriteFrame: %s",i),i=String.formatC(t.strPic,1,e),n=l.spriteFrameCache.getSpriteFrame(i));var r=new l.Sprite(n);r.setAnchorPoint(.5,.5),r.setPosition(.5*this.width,.5*this.height),this.addChild(r,t.type==J.TSUN||t.type==J.TMOON?-1:1,1),this.tower=r}},loadWeapon:function(){l.warn("TowerBase.loadWeapon() : 请重写此方法！")},onFire:function(){l.warn("TowerBase.onFire() : 请重写此方法！")},getCel:function(){return this.cel},setCel:function(e){this.cel=e},getRow:function(){return this.row},setRow:function(e){this.row=e},getWeapon:function(){return this.tower}});Bs.newTowerWithType=function(e,t){var i=null;switch(e){case J.TFIREBOTTLE:case J.TBOTTLE:case J.TPIN:(i=new Bs).initWithType(e,!0,!0,!1,t);break;case J.TFLASHLIGHT:(i=new Ps).initWithType(e,!0,!0,!1,t),i.nTowerShootLast=0;break;case J.TSHIT:(i=new Bs).initWithType(e,!1,!0,!1,t);break;case J.TBALL:(i=new Es).initWithType(e,!1,!0,!1,t);break;case J.TBOOMERANG:(i=new Bs).initWithType(e,!0,!1,!0,t);break;case J.TSTAR:case J.TSUN:case J.TSNOW:case J.TMOON:case J.TMAGNET:case J.TBLUESTAR:(i=new Bs).initWithType(e,!1,!1,!1,t);break;case J.TICEFAN:(i=new Bs).initWithType(e,!1,!1,!0,t);break;case J.TROCKET:case J.TPLANE:(i=new Bs).initWithType(e,!0,!0,!0,t);break;case J.TARROW:(i=new Fs).initWithType(e,!0,!0,!0,t);break;case J.TCUTTLE:(i=new Fs).initWithType(e,!1,!0,!0,t);break;case J.TFISH:(i=new Fs).initWithType(e,!0,!0,!1,t);break;case J.TANCHOR:(i=new Bs).initWithType(e,!0,!1,!1,t);break;case J.CROCKET:(i=new bs).initWithType(e,!1,!1,!0,1);break;case J.CSNOW:(i=new bs).initWithType(e,!1,!1,!1,1)}return i},Bs.create=function(){return new Bs};var Fs=Bs.extend({towerFire:function(){var e=this.define,t=this.projectiles,i=this.nCurLevel-1;if(i<e.exPower.length){var n=e.exPower[i];if(n){for(var s=n.nPowerPort-1,r=e.type,a=s;a>=0;a--){var o=this.findFirstWithType(0,!1);if(o<0)return this.unschedule(this.towerLockCreeps),void this.schedule(this.checkShootMonster,As);if(this.nStartIndex=o,o<t.length){var h=t[o];if(h){var l=h.getMonster();if(l&&l.curHPTOBe<1){if(this.findFirstCreepInRange(),null==this.target)return this.unschedule(this.towerLockCreeps),void this.schedule(this.checkShootMonster,As);h.setMonster(this.target)}r==J.TARROW?1==s?h.flyWithIndex(0==a?1:-1):h.flyWithIndex(.5*s-a):h.flyWithIndex(a)}}}var d=wr.getModel();d&&d.playSoundWithFile(e.strShootMuic)}}}});Fs.create=function(){return new Fs};var Es=Bs.extend({nUsedTowerCount:0,towerFire:function(){var e=this.projectiles,t=this.define,i=wr.getModel();if(1!=this.nCurLevel&&this.target!=i.curSelGoods){for(var n=e.length,s=0;s<this.nCurLevel;s++){var r=null;if(s<n&&(r=e[s]),null==r)return;if(1!=r.nState){var a=r.getMonster();if((a&&a.curHPTOBe<1||null==a||null==this.target)&&(this.findFirstCreepInRange(),null==this.target))return this.toFirstPic(),void this.schedule(this.checkShootMonster,As);(i=wr.getModel())&&i.playSoundWithFile(t.strShootMuic),this.nUsedTowerCount++,r.setMonster(this.target),r.fly();break}}s<this.nCurLevel?this.schedule(this.checkShootMonster,As):this.unschedule(this.checkShootMonster)}else this._super()},findFirstCreepInRange:function(){var e=this.projectiles;if(1==this.nCurLevel)return this.nUsedTowerCount=0,void this._super();var t=wr.getModel();this.target=null;var i=t.curSelGoods;if(i&&i.curHPTOBe>0&&this.isInRange(i,!0)&&(this.nUsedTowerCount=0,this.target=t.curSelGoods),null!=this.target||t.curCreepCount<1){if(null==this.target&&t.superBoss&&this.isInRange(t.superBoss,!0)){for(var n=e.length,s=0;s<n;s++)if(1==(h=e[s]).nState&&h.getMonster()==t.superBoss)return;this.target=t.superBoss}}else{for(s=0;s<t.curIndexEnd;s++){var r=t.getIndexOfCreepsByID(s);if(!(r<0)&&r<t.creeps.length){var a=t.creeps[r];if(a&&a.curHP>0&&a.curHPTOBe>0&&this.isInRange(a,!0)){this.target=a;for(var n=e.length,o=0;o<n;o++)if(1==(h=e[o]).nState&&h.getMonster()==a){this.target=null;break}if(this.target)break}}}if(null==this.target&&t.superBoss&&this.isInRange(t.superBoss,!0)){for(var n=e.length,s=0;s<n;s++){var h=e[s];if(1==h.nState&&h.getMonster()==t.superBoss)return}this.target=t.superBoss}}}});Es.create=function(){return new Es};var Ps=Bs.extend({nTowerShootLast:.1});Ps.create=function(){return new Ps};var bs=Bs.extend({bInShootting:!1,bCanDoAction:!0,changeShoot:function(e){this._super(e),this.target&&(this.bInShootting=!0,this.bCanDoAction?(this.setOpacity(0),this.tower.setVisible(!0)):(this.setOpacity(255),this.tower.setVisible(!1)))},checkShootMonster:function(e){this.findFirstCreepInRange(),this.target?(this.unschedule(this.checkShootMonster),this.bInShootting=!0,this.bCanDoAction?(this.setOpacity(0),this.tower.setVisible(!0)):(this.setOpacity(255),this.tower.setVisible(!1)),this.fLastShootTimes=1e3,this.towerRotate()):(this.bInShootting=!1,this.tower.setVisible(!1),this.setOpacity(255))}});bs.create=function(){return new bs};var As=.11,Os=180,Is=100,Rs=l.Sprite.extend({monster:null,nLevel:0,nState:0,bChild:!1,_className:"Projectile",tower:null,ctor:function(){this._super()},init:function(e,t,i){var n=e,s=n.define;this.nLevel=n.nCurLevel;var r=String.formatC(s.strProjPic,this.nLevel,i?2:1),a=l.spriteFrameCache.getSpriteFrame(r);if(this.initWithSpriteFrame(a),this.nState=2,this.tower=e,this.setMonster(t),this.setVisible(!1),this.bChild=i,s.type==J.TSUN||s.type==J.CSNOW||s.type==J.TMOON||s.type==J.TSNOW)return this;if(s.nProjFlyPicCount>1){for(var o=[],h=1;h<=s.nProjFlyPicCount;++h)o.push(l.spriteFrameCache.getSpriteFrame(String.formatC(s.strProjPic,this.nLevel,h)));var d=new l.Animation(o,s.fProjFlySpanSecd);this.runAction(l.repeatForever(l.animate(d)))}else{var c=s.nFlyRotateDegrs[this.nLevel-1];this.runAction(l.repeatForever(l.rotateBy(.1,c)))}return this},fly:function(){var e=this.tower,t=e.define,i=this.monster,n=t.type;this.nLevel!=e.nCurLevel&&this.updatePic();var s=e._position;if(n==J.TICEFAN){var r=nr.share().getMapOffset(),a=wr.getModel().szTileRng.height/16,o=l.p(0,.4*e.height+a-r.height);o.x+=s.x,o.y+=s.y,s=o}else if(n==J.CROCKET)s=l.pAdd(e._position,l.p(0,.3*e.height));else if(n!=J.TROCKET&&n!=J.TICEFAN&&n!=J.TBOOMERANG){var h=t.nPower[this.nLevel-1];h*=1+e.fPowerBuff,i.curHPTOBe=parseInt(i.curHPTOBe-h)}var d=e.projFlyDuration(i._position),c=i.getPointWithTime(d);if(c.x-=s.x,c.y-=s.y,e.bProjRotate){var u=l.pToAngle(c);this.setRotation(l.radiansToDegrees(-1*u)+90)}if(this.setPosition(s),this.setVisible(!0),this.nState=1,n!=J.TROCKET&&n!=J.TICEFAN&&n!=J.CROCKET&&this.resume(),e.bCross){var p=nr.share().getWinSize(),m=l.pNormalize(c);m.x*=1.25*p.width,m.y*=1.25*p.width,m.x+=this.x,m.y+=this.y;var _=l.pDistance(this._position,m)/t.nProjFlySpeed,g=l.moveTo(_,m);g.setTag(rr.PCROOS),this.runAction(g)}else this.changeFlyAngel()},splitFly:function(e){var t=this.tower,i=t.define,n=this.monster;if(this.nLevel!=t.nCurLevel){this.nLevel=t.nCurLevel;var s=String.formatC(i.strProjPic,this.nLevel,2),r=l.spriteFrameCache.getSpriteFrame(s);this.setSpriteFrame(r)}var a=i.nPower[this.nLevel-1];a*=1+t.fPowerBuff,n.curHPTOBe=parseInt(n.curHPTOBe-a*i.exPower[this.nLevel-1].slowSpeed),this.setPosition(e),this.run(),this.changeFlyAngel()},run:function(){this.resume(),this.nState=1,this.visible=!0},standby:function(){this.pause(),this.nState=2,this.visible=!1,this.monster=null},changeFlyAngel:function(){var e=this.tower,t=this.monster,i=this._position,n=e.rectWidthSprite(t,.05);if(l.rectIntersectsRect(n,this.getBoundingBox()))this.explode();else{var s=.07,r=e.define.nProjFlySpeed*s,a=t.getPointWithTime(s),o=l.pSub(a,i),h=l.pToAngle(o),d=l.pNormalize(o),c=l.pMult(d,r);c.x+=i.x,c.y+=i.y;var u=l.radiansToDegrees(-1*h)+90;e.bProjRotate&&this.setRotation(u);var p=l.pDistance(i,a);1.5*r>=p&&(c=a,s*=p/r);var m=l.sequence(l.moveTo(s,c),l.callFunc(this.changeFlyAngel,this));m.setTag(rr.PFLY),this.runAction(m)}},explode:function(){var e=this.tower;if(this.monster){var t=this.monster,i=(t._position,e.define),n=i.type,s=t.define.type,r=1+e.fPowerBuff;this.bChild&&(r*=i.exPower[this.nLevel-1].slowSpeed),t.beShootWithTower(i,this.nLevel,r),s>J.OBJECTEND&&n==J.TANCHOR&&!this.bChild&&e.projSplit(t._position)}e.bCross&&this.stopActionByTag(rr.PCROOS),this.standby()},updatePic:function(){var e=this.tower,t=e.define,i=t.type;if(i!=J.TSUN&&i!=J.TMOON&&i!=J.TSNOW&&this.nLevel!=e.nCurLevel&&!this.bChild){this.stopAllActions(),this.nLevel=e.nCurLevel;var n=String.formatC(t.strProjPic,this.nLevel,1),s=l.spriteFrameCache.getSpriteFrame(n);if(this.setSpriteFrame(s),i!=J.TFISH)if(t.nProjFlyPicCount>1){for(var r=[s],a=2;a<=t.nProjFlyPicCount;++a)r.push(l.spriteFrameCache.getSpriteFrame(String.formatC(t.strProjPic,this.nLevel,a)));var o=new l.Animation(r,t.fProjFlySpanSecd);this.runAction(l.repeatForever(l.animate(o)))}else{var h=t.nFlyRotateDegrs[this.nLevel-1];this.runAction(l.repeatForever(l.rotateBy(.1,h)))}}},getMonster:function(){return this.monster},setMonster:function(e){this.monster=e}});Rs.create=function(){return new Rs};var Ds=Rs.extend({monsters:null,hitNextMonster:function(e){var t=this.monster,i=this.tower,n=i.define,s=wr.getModel(),r=i.rectWidthSprite(this),a=.2*r.width,o=l.rect(l.rectGetMinX(r)+a,l.rectGetMinY(r)+a,l.rectGetMaxX(r)-l.rectGetMinX(r)-2*a,l.rectGetMaxY(r)-l.rectGetMinY(r)-2*a),h=n.nPower[this.nLevel-1];void 0==h&&(h=1);var d=1+i.fPowerBuff;h*=d;var c=.8;for(var u in s.objects)if((_=s.objects[u]).curHP>0&&l.rectIntersectsRect(o,i.rectWidthSprite(_,c))){T=!0;null==this.monsters&&(this.monsters=[]);for(var p in this.monsters)if((f=this.monsters[p])==_){T=!1;break}if(T){_.curHPTOBe=parseInt(_.curHPTOBe-h),_.beShootWithTower(n,this.nLevel,d)||this.monsters.unshift(_);break}}c=.8;for(u=0;u<s.curIndexEnd;u++){var m=s.getIndexOfCreepsByID(u);if(!(m<0||m>=s.creeps.length)){var _=s.creeps[m],g=i.rectWidthSprite(_,c);if(_.curHP>0&&l.rectIntersectsRect(o,g)){T=!0;null==this.monsters&&(this.monsters=[]);for(var p in this.monsters)if((f=this.monsters[p])==_){T=!1;break}if(T){_.curHPTOBe=parseInt(_.curHPTOBe-h),_.beShootWithTower(n,this.nLevel,d)||this.monsters.unshift(_);break}}}}if(s.superBoss&&(_=s.superBoss).curHP>0&&l.rectIntersectsRect(o,i.rectWidthSprite(_,c))){var T=!0;null==this.monsters&&(this.monsters=[]);for(var u in this.monsters){var f=this.monsters[u];if(f==_){T=!1;break}}T&&(_.curHPTOBe=parseInt(_.curHPTOBe-h),_.beShootWithTower(n,this.nLevel,d)||this.monsters.unshift(_))}if(t&&t.define.type<J.OBJECTEND&&l.rectIntersectsRect(i.rectWidthSprite(this),i.rectWidthSprite(t)))return t.curHPTOBe=parseInt(t.curHPTOBe-h),this.explode(),void(this.monsters&&(this.monsters.length=0));var S=nr.share().getWinSize();l.rectContainsRect(l.rect(-10,-10,S.width+20,S.height+20),r)||(this.stopActionByTag(rr.PCROOS),this.monsters&&(this.monsters.length=0),this.standby())},fly:function(){this._super(),l.director.getScheduler().isTargetPaused(this)?this.resume():this.schedule(this.hitNextMonster,.1)}});Ds.create=function(){return new Ds};var xs=Ds.extend({});xs.create=function(){return new xs};var Ns=Rs.extend({nHitTimes:0,fly:function(){this.nHitTimes=0,this.run(),this.showLight(),this.schedule(this.hitMonster,.1)},hitMonster:function(e){var t=this.tower,i=t.define,n=this.monster,s=i.nPower[this.nLevel-1],r=1+t.fPowerBuff;s*=r;var a=!1;t.isInRange(n,!1)?(this.showLight(),n.curHPTOBe=parseInt(n.curHP-s),n.beShootWithTower(i,this.nLevel,r)?a=!0:this.nHitTimes++):a=!0,a&&(this.stopBeat(),t.schedule(t.checkShootMonster,As))},showLight:function(){var e=this.monster,t=this.tower;this.nLevel!=t.nCurLevel&&this.updatePic();var i=l.pSub(e._position,t._position),n=l.pToAngle(i),s=l.pDistance(t._position,e._position);this.setScaleY((s-t.width*(t.bRotate?.5:0))/this.height),this.setRotation(l.radiansToDegrees(-1*n)+90),t.bRotate&&(this.setPosition(l.pLerp(t._position,e._position,.3*t.height/s)),t.tower.setRotation(this.getRotation()))},stopBeat:function(){this.stopActionByTag(rr.PCROOS),this.unschedule(this.hitMonster),this.standby()}});Ns.create=function(){return new Ns};var Gs=Ns.extend({nRandom:0,nTimes:0,init:function(e,t,i){var n=e,s=n.define;this.nLevel=n.nCurLevel;var r=String.formatC(s.strProjPic,1,i?2:1),a=l.spriteFrameCache.getSpriteFrame(r);if(this.initWithSpriteFrame(a),this.nState=2,this.tower=e,this.setMonster(t),this.setVisible(!1),this.bChild=i,s.nProjFlyPicCount>1){for(var o=[],h=1;h<=s.nProjFlyPicCount;++h){var d=1;3==this.nLevel&&(d=3),o.push(l.spriteFrameCache.getSpriteFrame(String.formatC(s.strProjPic,d,h)))}u=new l.Animation(o,s.fProjFlySpanSecd);this.runAction(l.repeatForever(l.animate(u)))}else{var c=s.nFlyRotateDegrs[this.nLevel-1];this.runAction(l.repeatForever(l.rotateBy(.1,c)))}if(null==n.projectCover){n.projectCover=new l.Sprite(String.formatC(s.strPic,this.nLevel+3,1)),n.projectCover.setPosition(n._position),n.getParent().addChild(n.projectCover,sr.LPROJECTCOVER);for(var o=[],h=1;h<=4;++h)o.push(l.spriteFrameCache.getSpriteFrame(String.formatC(s.strPic,this.nLevel+3,h)));var u=new l.Animation(o,s.fSpanSecond);n.projectCover.runAction(l.repeatForever(l.animate(u)))}return this},fly:function(){this.nState=1,this.nRandom=this.nTimes=0,this._super()},hitMonster:function(e){var t=this.tower,i=t.define,n=this.monster,s=!1,r=i.nPower[this.nLevel-1],a=t.nUsedTowerCount-1;a<0?a=0:a>2&&(a=2);var o=i.exPower[a].slowSpeed,h=(1+t.fPowerBuff)*o;++this.nTimes>5&&(this.nTimes==this.nRandom?(h*=F()%3+3,this.nTimes=5,this.nRandom=0):this.nRandom<this.nTimes&&(this.nRandom=this.nTimes+F()%5+1)),r*=h;t.isInRange(n,!1)?(this.showLight(),n.curHPTOBe=parseInt(n.curHP-r),n.beShootWithTower(i,this.nLevel,h)&&(s=!0)):s=!0,s&&this.stopBeat()},showLight:function(){var e=this.monster,t=this.tower;if(0==t.projectCover.isVisible()&&t.projectCover.setVisible(!0),this.nLevel!=t.nCurLevel){var i=t.define;if(i.nProjFlyPicCount>1&&3==t.nCurLevel){this.stopAllActions();for(var n=[],s=1;s<=i.nProjFlyPicCount;++s)n.push(l.spriteFrameCache.getSpriteFrame(String.formatC(i.strProjPic,t.nCurLevel,s)));a=new l.Animation(n,i.fProjFlySpanSecd);this.runAction(l.repeatForever(l.animate(a)))}t.projectCover.stopAllActions();var r=l.spriteFrameCache.getSpriteFrame(String.formatC(t.define.strPic,t.nCurLevel+3,1));t.projectCover.setSpriteFrame(r),t.projectCover.stopAllActions();for(var n=[],s=1;s<=4;++s)n.push(l.spriteFrameCache.getSpriteFrame(String.formatC(t.define.strPic,t.nCurLevel+3,s)));var a=new l.Animation(n,t.define.fSpanSecond);t.projectCover.runAction(l.repeatForever(l.animate(a)))}this.nLevel=t.nCurLevel;var o=l.pSub(e._position,t._position),h=l.pToAngle(o),d=l.pDistance(t._position,e._position);this.setScaleY((d-t.width*(t.bRotate?.5:0))/this.height),this.setRotation(l.radiansToDegrees(-1*h)+90),t.bRotate&&(this.setPosition(l.pLerp(t._position,this.monster._position,.3*t.height/d)),t.tower.setRotation(this.getRotation()))},stopBeat:function(){this._super();var e=this.tower;e.projectCover.setVisible(!1);var t=e.nUsedTowerCount;--t<0&&(t=0),e.nUsedTowerCount=t,e.unschedule(e.checkShootMonster),e.schedule(e.checkShootMonster,As)}});Gs.create=function(){return new Gs};var Ws=Ds.extend({m_bSet:0,ptEnd:0,fly:function(){var e=this.tower,t=e.define,i=this.monster,n=t.type,s=l.p(0,0);this.nLevel!=e.nCurLevel&&this.updatePic();var r=e._position;if(n==J.TICEFAN){var a=nr.share().getMapOffset(),o=wr.getModel().szTileRng.height/16;s.x=0,s.y=.4*e.height+o-a.height,r=l.pAdd(e._position,s)}else if(n==J.CROCKET)s.x=0,s.y=.3*e.height;else if(n!=J.TROCKET&&n!=J.TICEFAN&&n!=J.TBOOMERANG){var h=t.nPower[this.nLevel-1];h*=1+e.fPowerBuff,i.curHPTOBe=parseInt(i.curHPTOBe-h)}var d=e.projFlyDuration(i._position),c=i.getPointWithTime(d),u=l.pSub(c,r);if(e.bProjRotate){var p=l.pToAngle(u);this.setRotation(l.radiansToDegrees(-1*p)+90)}if(this.setPosition(r),this.setVisible(!0),this.nState=1,n!=J.TROCKET&&n!=J.TICEFAN&&n!=J.CROCKET&&this.resume(),e.bCross){var m=l.pNormalize(u),_=t.exPower[this.nLevel-1],g=l.pMult(m,_.nPowerPort),T=l.pAdd(this._position,g),f=_.nPowerPort/_.nLastSecond,S=l.moveTo(f,T),w=0,v=(w=this.GetStartAngel(u))+30,L=l.degreesToRadians(v);s.x=1.732*_.nPowerPort*.5*Math.cos(L),s.y=1.732*_.nPowerPort*.5*Math.sin(L);var M=l.pAdd(e._position,s);v+=30,L=l.degreesToRadians(v),s.x=_.nPowerPort*Math.cos(L),s.y=_.nPowerPort*Math.sin(L),this.ptEnd=l.pAdd(e._position,s);var C={};C.centerPosition=M,C.aLength=_.nPowerPort/2,C.bLength=_.nPowerPort/2,C.rRoataion=0,C.kRoataion=w-60,f=Math.PI*_.nPowerPort/_.nLastSecond;var y=l.circleBy(f,C),B=l.callFunc(this.setMyTag,this),F=l.callFunc(this.recoveryProj,this),E=l.sequence(S,B,y,F);E.setTag(rr.PCROOS),this.runAction(E),e.showTower(!1)}l.director.getScheduler().isTargetPaused(this)?this.resume():this.schedule(this.hitNextMonster,.02)},hitNextMonster:function(e){var t=this.tower,i=t.define,n=wr.getModel(),s=t.rectWidthSprite(this),r=parseInt(.2*s.width),a=l.rect(l.rectGetMinX(s)+r,l.rectGetMinY(s)+r,l.rectGetMaxX(s)-l.rectGetMinX(s)-2*r,l.rectGetMaxY(s)-l.rectGetMinY(s)-2*r),o=i.nPower[this.nLevel-1],h=1+t.fPowerBuff;o*=h;var d=.8;for(var c in n.objects){var u=n.objects[c],p=t.rectWidthSprite(u,d),m=l.rectIntersectsRect(a,p);if(parseInt(u.curHP)>0&&m){f=!0;null==this.monsters&&(this.monsters=[]);for(var _ in this.monsters)if((S=this.monsters[_])==u){f=!1;break}if(f){u.curHPTOBe=parseInt(u.curHPTOBe-o),u.beShootWithTower(i,this.nLevel,h)||this.monsters.unshift(u);break}}}d=.8;for(c=0;c<n.curIndexEnd;c++){var g=n.getIndexOfCreepsByID(c);if(!(g<0||g>=n.creeps.length)){var u=n.creeps[g],T=t.rectWidthSprite(u,d);if(u.curHP>0&&l.rectIntersectsRect(a,T)){f=!0;null==this.monsters&&(this.monsters=[]);for(var _ in this.monsters)if((S=this.monsters[_])==u){f=!1;break}if(f){u.curHPTOBe=parseInt(u.curHPTOBe-o),u.beShootWithTower(i,this.nLevel,h)||this.monsters.unshift(u);break}}}}if(n.superBoss&&(u=n.superBoss).curHP>0&&l.rectIntersectsRect(a,t.rectWidthSprite(u,d))){var f=!0;null==this.monsters&&(this.monsters=[]);for(var c in this.monsters){var S=this.monsters[c];if(S==u){f=!1;break}}f&&(u.curHPTOBe=parseInt(u.curHPTOBe-o),u.beShootWithTower(i,this.nLevel,h)||this.monsters.unshift(u))}if(l.pDistance(this._position,this.ptEnd)<60){this.stopActionByTag(rr.PCROOS),this.ptEnd.x=-1e3,this.ptEnd.y=-1e3;var w=i.exPower[this.nLevel-1],v=w.nPowerPort/w.nLastSecond,L=l.moveTo(v,t._position),M=l.callFunc(this.recoveryProj,this),C=l.sequence(L,M);C.setTag(rr.PCROOS),this.runAction(C)}T=t.rectWidthSprite(t,.2);this.m_bSet&&l.rectIntersectsRect(a,T)&&this.recoveryProj()},GetStartAngel:function(e){var t=0;return e.x>0&&0==e.y?t=0:e.x>0&&e.y>0?t=l.radiansToDegrees(l.pToAngle(e)):0==e.x&&e.y>0?t=90:e.x<0&&e.y>0?(e.x=-1*e.x,t=180-l.radiansToDegrees(l.pToAngle(e))):e.x<0&&0==e.y?t=180:e.x<0&&e.y<0?(e.x=-1*e.x,e.y=-1*e.y,t=180+l.radiansToDegrees(l.pToAngle(e))):0==e.x&&e.y<0?t=270:e.x>0&&e.y<0&&(e.y=-1*e.y,t=360-l.radiansToDegrees(l.pToAngle(e))),t},setMyTag:function(){this.m_bSet=!0},stopBeat:function(){this.m_bSet=!1,this.stopActionByTag(rr.PCROOS),this.monsters&&(this.monsters.length=0),this.standby()},recoveryProj:function(){var e=this.tower;this.stopBeat(),e.showTower(!0),e.schedule(e.checkShootMonster,As)}});Ws.create=function(){return new Ws};var ks=Ns.extend({bNoRotate:0,mLastMonsterPt:null,ptEnd:null,nLast:0,nRandom:0,nTimes:0,spriteChild:null,spriteChild1:null,spriteChild2:null,spriteChild3:null,spriteChild4:null,spriteChild5:null,spriteChild6:null,spriteChild7:null,spriteChild8:null,spriteChild9:null,spriteChild10:null,ctor:function(){this._super(),this.ptEnd=l.p(0,0)},fly:function(){this.nRandom=0,this.nTimes=0,this.nHitTimes=0,this.showLight(),this.run(),this.schedule(this.hitMonster,.1)},hitMonster:function(e){var t=this.bNoRotate,i=this.tower,n=i.define,s=this.monster,r=wr.getModel(),a=n.nPower[this.nLevel-1],o=1+i.fPowerBuff;if(i.nTowerShootLast+=1,.1*i.nTowerShootLast*1e3>n.nShootSpeed[this.nLevel-1]&&(this.nLast+=1,this.bNoRotate=!0),this.bNoRotate){var h=n.exPower[this.nLevel-1];if(this.nLast>h.nLastSecond)return this.stopBeat1(),void i.schedule(i.checkShootMonster,As);if(t!=this.bNoRotate){var d=i.define;if(this.stopAllActions(),this.setSpriteFrame(l.spriteFrameCache.getSpriteFrame(String.formatC(d.strProjPic,this.nLevel+3,1))),d.nProjFlyPicCount>1){for(var c=[],u=1;u<=d.nProjFlyPicCount;++u)c.push(l.spriteFrameCache.getSpriteFrame(String.formatC(d.strProjPic,this.nLevel+3,u)));v=new l.Animation(c,d.fProjFlySpanSecd);this.runAction(l.repeatForever(l.animate(v)))}var p=i._position,m=this.mLastMonsterPt;s&&(m=s._position);var _=l.pSub(m,p),g=l.pToAngle(_);this.setRotation(l.radiansToDegrees(-1*g)+90),i.tower.setRotation(this.getRotation()),this.setScaleY(1),this.setPosition(l.pLerp(p,l.p(p.x+this.height*Math.cos(g),p.y+this.height*Math.sin(g)),.3*i.height/this.height)),this.nState=2;var T=nr.share().getWinSize(),f=l.pNormalize(_),S=l.pMult(f,1.25*T.width);this.ptEnd=l.pAdd(this._position,S);var w=String.formatC(n.strProjPic,-2,1);null==this.spriteChild?(this.spriteChild=new l.Sprite(l.spriteFrameCache.getSpriteFrame(w)),this.spriteChild.setAnchorPoint(0,0),this.spriteChild.setPosition(-15,0),this.addChild(this.spriteChild)):(this.spriteChild.setVisible(!0),this.spriteChild.setOpacity(255));for(var c=[],u=1;u<=4;++u)c.push(l.spriteFrameCache.getSpriteFrame(String.formatC(n.strProjPic,-4,u)));var v=new l.Animation(c,.1),L=l.callFunc(this.lastAnimation,this),M=l.sequence(l.animate(v),L);M.setTag(1),this.spriteChild.stopActionByTag(1),this.spriteChild.runAction(M)}var C=this._position,y=this.ptEnd;a*=o*=h.slowSpeed;for(var u in r.objects){var B=.5*(R=r.objects[u]).width,F=.5*R.height,E=l.p(R.x-B,R.y),P=l.p(R.x+B,R.y),b=l.p(R.x,R.y-F),A=l.p(R.x,R.y+F),O=!1;C.y==y.y&&(C.y==R.y||C.y==E.y&&C.y==P.y)?(C.x<E.x&&y.x<E.x&&C.x<P.x&&y.x<P.x||C.x>E.x&&y.x>E.x&&C.x>P.x&&y.x>P.x)&&(O=!0):C.x==y.x&&(C.x==R.x||C.x==E.x&&C.x==P.x)&&(C.y<E.y&&y.y<E.y&&C.y<P.y&&y.y<P.y||C.y>E.y&&y.y>E.y&&C.y>P.y&&y.y>P.y)&&(O=!0),R.curHP<1||O||!l.pSegmentIntersect(C,y,E,P)&&!l.pSegmentIntersect(C,y,b,A)||(R.curHPTOBe=parseInt(R.curHPTOBe-a),R.beShootWithTower(n,this.nLevel,o))}for(u=0;u<r.curIndexEnd;u++){var I=r.getIndexOfCreepsByID(u);if(!(I<0||I>=r.creeps.length)){var B=.5*(R=r.creeps[I]).width,F=.5*R.height,E=l.p(R.x-B,R.y),P=l.p(R.x+B,R.y),b=l.p(R.x,R.y-F),A=l.p(R.x,R.y+F),O=!1;C.y==y.y&&(C.y==R.y||C.y==E.y&&C.y==P.y)?(C.x<E.x&&y.x<E.x&&C.x<P.x&&y.x<P.x||C.x>E.x&&y.x>E.x&&C.x>P.x&&y.x>P.x)&&(O=!0):C.x==y.x&&(C.x==R.x||C.x==E.x&&C.x==P.x)&&(C.y<E.y&&y.y<E.y&&C.y<P.y&&y.y<P.y||C.y>E.y&&y.y>E.y&&C.y>P.y&&y.y>P.y)&&(O=!0),R.curHP<1||O||!l.pSegmentIntersect(C,y,E,P)&&!l.pSegmentIntersect(C,y,b,A)||(R.curHPTOBe=parseInt(R.curHPTOBe-a),R.beShootWithTower(n,this.nLevel,o))}}var R=r.superBoss;if(R&&R.curHP>0){var B=.5*R.width,F=.5*R.height,E=l.p(R.x-B,R.y),P=l.p(R.x+B,R.y),b=l.p(R.x,R.y-F),A=l.p(R.x,R.y+F),O=!1;C.y==y.y&&(C.y==R.y||C.y==E.y&&C.y==P.y)?(C.x<E.x&&y.x<E.x&&C.x<P.x&&y.x<P.x||C.x>E.x&&y.x>E.x&&C.x>P.x&&y.x>P.x)&&(O=!0):C.x==y.x&&(C.x==R.x||C.x==E.x&&C.x==P.x)&&(C.y<E.y&&y.y<E.y&&C.y<P.y&&y.y<P.y||C.y>E.y&&y.y>E.y&&C.y>P.y&&y.y>P.y)&&(O=!0),R.curHP<1||O||!l.pSegmentIntersect(C,y,E,P)&&!l.pSegmentIntersect(C,y,b,A)||(R.curHPTOBe=parseInt(R.curHPTOBe-a),R.beShootWithTower(n,this.nLevel,o))}}else{a*=o;var D=!1;i.isInRange(s,!1)?(this.showLight(),s.curHPTOBe=parseInt(s.curHP-a),s.beShootWithTower(n,this.nLevel,o)?D=!0:this.nHitTimes++):D=!0,D&&(this.stopBeat(),i.schedule(i.checkShootMonster,As))}},showLight:function(){var e=this.monster,t=this.tower;this.nLevel!=t.nCurLevel&&this.updatePic(),this.mLastMonsterPt=e._position;var i=l.pSub(e._position,t._position),n=l.pToAngle(i),s=l.pDistance(t._position,e._position);this.setScaleY((s-t.width*(t.bRotate?.5:0))/this.height),this.setRotation(l.radiansToDegrees(-1*n)+90),t.bRotate&&(this.setPosition(l.pLerp(t._position,e._position,.3*t.height/s)),t.tower.setRotation(this.getRotation()))},stopBeat:function(){this.TowerReturnToNomal(),this._super()},stopBeat1:function(){this.bNoRotate=!1,this.tower.nTowerShootLast=0,this.TowerReturnToNomal(),ks.prototype.stopBeat.call(this),this.nLast=0},TowerReturnToNomal:function(){var e=this.tower;e.tower.stopAllActions(),null!=this.spriteChild&&(this.spriteChild.stopAllActions(),this.spriteChild.setVisible(!1),this.spriteChild.setOpacity(0),this.spriteChild.unscheduleAllCallbacks()),this.unscheduleAllCallbacks();for(a=0;a<=9;a++){var t=this.getChildByTag(Is+a);null!=t&&(t.setVisible(!1),t.setOpacity(0))}var i=String.formatC(e.define.strPic,e.nCurLevel,1),n=l.spriteFrameCache.getSpriteFrame(i);e.tower.setSpriteFrame(n);var s=e.define;if(this.stopAllActions(),this.setSpriteFrame(l.spriteFrameCache.getSpriteFrame(String.formatC(s.strProjPic,this.nLevel,1))),s.nProjFlyPicCount>1){for(var r=[],a=1;a<=s.nProjFlyPicCount;++a)r.push(l.spriteFrameCache.getSpriteFrame(String.formatC(s.strProjPic,this.nLevel,a)));var o=new l.Animation(r,s.fProjFlySpanSecd);this.runAction(l.repeatForever(l.animate(o)))}},lastAnimation:function(){if(this.bNoRotate){this.spriteChild.setVisible(!1);for(var e=this.tower.define,t=String.formatC(e.strProjPic,-this.nLevel,1),i=0;i<=9;i++){var n=this.getChildByTag(Is+i);null==n?((n=new l.Sprite("#"+t)).setAnchorPoint(0,0),n.setPosition(-15,140*i),n.setTag(Is+i),this.addChild(n)):(n.setVisible(!0),n.setOpacity(255));for(var s=[],r=1;r<=3;++r)s.push(l.spriteFrameCache.getSpriteFrame(String.formatC(e.strProjPic,-this.nLevel,r)));var a=l.moveBy(.5,0,140),o=l.moveTo(0,-15,140*i),h=l.sequence(a,o),d=new l.Animation(s,.1),c=l.animate(d);n.stopAllActions(),n.runAction(l.repeatForever(c)),n.runAction(l.repeatForever(h))}}else this.spriteChild.setVisible(!1)}});ks.create=function(){return new ks};var Us=Rs.extend({frames:null,fly:function(){this.setVisible(!0),this.setOpacity(255),this.stopAllActions();var e=this.tower,t=e.define,i=this.nLevel!=e.nCurLevel;if(this.nLevel=e.nCurLevel,i||null===this.frames){for(var n=[],s=1;s<=t.nProjFlyPicCount;++s)n.push(l.spriteFrameCache.getSpriteFrame(String.formatC(t.strProjPic,this.nLevel,s)));this.frames=n}var r=new l.Animation(this.frames,t.fProjFlySpanSecd),a=l.sequence(l.animate(r),l.callFunc(this.hitMonster,this,0),l.fadeOut(t.fProjExpFadeSecd));a.setTag(-2),this.runAction(a)},hitMonster:function(e){var t=this.tower,i=t.define,n=wr.getModel(),s=i.nPower[this.nLevel-1],r=1+t.fPowerBuff;s*=r;for(var a in n.objects)(h=n.objects[a]).curHP>0&&t.isInRange(h,!1)&&(h.curHPTOBe=parseInt(h.curHPTOBe-s),h.beShootWithTower(i,this.nLevel,r));for(a=0;a<n.curIndexEnd;a++){var o=n.getIndexOfCreepsByID(a);if(!(o<0)){var h=n.creeps[o];h.curHP>0&&l.pDistance(h._position,this._position)<t.nShootRange+.42*h.getBoundingBox().width&&(h.curHPTOBe=parseInt(h.curHPTOBe-s),h.beShootWithTower(i,this.nLevel,r))}}var d=n.superBoss;d&&d.curHP>0&&l.pDistance(d._position,this._position)<t.nShootRange&&(d.curHPTOBe=parseInt(d.curHPTOBe-s),d.beShootWithTower(i,this.nLevel,r)),this.setMonster(null),this.nState=2}});Us.create=function(){return new Us};var Hs=Rs.extend({ptMoveFinish:null,mIndex:0,flyWithIndex:function(e){var t=this.tower,i=t.define,n=this.monster;if(n){this.mIndex=e;var s=i.type;1==t.nCurLevel&&0==e&&s==J.TARROW&&(e=1),t.nCurLevel!=this.nLevel&&this.updatePic();var r=n.getPointWithTime(t.projFlyDuration(n._position));r.x-=t.x,r.y-=t.y;var a,o=l.pToAngle(r);switch(s){case J.TARROW:a=i.exPower[this.nLevel-1].slowSpeed;break;case J.TFISH:a=i.exPower[e].nExplodeRange;break;default:a=i.exPower[this.nLevel-1].nShootHP}t.bProjRotate&&this.setRotation(l.radiansToDegrees(-1*o)+90-e*a),t.bRotate&&(0==e?t.tower.setRotation(this.getRotation()):1==this.nLevel&&1==e&&t.tower.setRotation(this.getRotation()+a)),this.setPosition(t._position),this.run();var h=nr.share().getWinSize(),d=l.pNormalize(r),c=1.25*h.width;d.x*=c,d.y*=c,d.x+=this.x,d.y+=this.y,this.ptMoveFinish=d,this.ptMoveFinish=l.pRotateByAngle(this.ptMoveFinish,this._position,l.degreesToRadians(e*a));var u=l.pDistance(this._position,this.ptMoveFinish)/i.nProjFlySpeed,p=l.moveTo(u,this.ptMoveFinish);p.setTag(rr.PCROOS),this.runAction(p),this.schedule(this.hitMonster)}},hitMonster:function(e){var t=this.tower,i=t.define,n=this._position,s=wr.getModel(),r=l.pLerp(n,this.ptMoveFinish,this.height/l.pDistance(n,this.ptMoveFinish)),a=i.nPower[this.nLevel-1],o=1+t.fPowerBuff;a*=o;for(var h=!1,d=0;d<s.curIndexEnd;d++){var c=s.getIndexOfCreepsByID(d);if(!(c<0||c>=s.creeps.length)){g=(_=s.creeps[c]).getBoundingBox();if(_.define.type>=J.BMT&&(g=t.rectWidthSprite(_,.3)),_.curHP>0&&l.rectContainsPoint(g,r)){h=!0,_.curHPTOBe=parseInt(_.curHPTOBe-a),_.beShootWithTower(i,this.nLevel,o);break}}}var u=i.type==J.TCUTTLE?i.exPower[this.nLevel-1].slowSpeed:1;if(a*=u,o*=u,!h){var p=this.monster,m=!1;if(p&&(m=p.define.type<J.OBJECTEND),m&&0==this.mIndex&&i.type==J.TFISH&&t.isInRange(p,!0)){g=p.getBoundingBox();p.curHP>0&&(l.rectContainsPoint(g,r)||l.rectContainsPoint(g,this._position))&&(h=!0,p.curHPTOBe=parseInt(p.curHPTOBe-a),p.beShootWithTower(i,this.nLevel,o))}else for(var d in s.objects){var _=s.objects[d],g=_.getBoundingBox();_.curHP>0&&(l.rectContainsPoint(g,r)||l.rectContainsPoint(g,this._position))&&(h=!0,_.curHPTOBe=parseInt(_.curHPTOBe-a),_.beShootWithTower(i,this.nLevel,o))}}var T=s.superBoss;if(T&&!h){g=T.getBoundingBox();T.curHP>0&&(l.rectContainsPoint(g,r)||l.rectContainsPoint(g,n))&&(s.changeMoney(1),h=!0,T.curHPTOBe=parseInt(T.curHPTOBe-a),T.beShootWithTower(i,this.nLevel,o))}var f=nr.share().getWinSize();(h||n.x<0||n.y<0||n.x>f.width||n.y>f.height)&&(this.stopActionByTag(rr.PCROOS),this.unschedule(this.hitMonster),this.standby(),this.ptMoveFinish.x=0,this.ptMoveFinish.y=0)}});Hs.create=function(){return new Hs};var Vs=Ns.extend({ptEnd:null,ctor:function(){this._super(),this.ptEnd=l.p(0,0)},fly:function(){var e=this.tower,t=this.monster;if(this.nLevel!=e.nCurLevel){this.nLevel=e.nCurLevel;var i=String.formatC(e.define.strProjPic,this.nLevel,1),n=l.spriteFrameCache.getSpriteFrame(i);this.setSpriteFrame(n)}var s=e._position,r=t._position,a=l.pSub(r,s),o=l.pToAngle(a);this.setRotation(l.radiansToDegrees(-1*o)+90),e.tower.setRotation(this.getRotation()),this.setPosition(s),this.setOpacity(255),this.nState=1;var h=nr.share().getWinSize(),d=l.pNormalize(a),c=l.pMult(d,1.25*h.width);this.ptEnd=l.pAdd(this._position,c),this.setVisible(!0),this.runAction(l.callFunc(this.hitMonster,this,0))},hitMonster:function(e){void 0===e&&(e=0);var t=this.tower,i=t.define,n=wr.getModel(),s=i.nPower[this.nLevel-1],r=1+t.fPowerBuff;s*=r;var a=this._position,o=this.ptEnd;for(var h in n.objects){var d=.5*(f=n.objects[h]).width,c=.5*f.height,u=l.p(f.x-d,f.y),p=l.p(f.x+d,f.y),m=l.p(f.x,f.y-c),_=l.p(f.x,f.y+c),g=!1;a.y==o.y&&(a.y==f.y||a.y==u.y&&a.y==p.y)?(a.x<u.x&&o.x<u.x&&a.x<p.x&&o.x<p.x||a.x>u.x&&o.x>u.x&&a.x>p.x&&o.x>p.x)&&(g=!0):a.x==o.x&&(a.x==f.x||a.x==u.x&&a.x==p.x)&&(a.y<u.y&&o.y<u.y&&a.y<p.y&&o.y<p.y||a.y>u.y&&o.y>u.y&&a.y>p.y&&o.y>p.y)&&(g=!0),f.curHP<1||g||!l.pSegmentIntersect(a,o,u,p)&&!l.pSegmentIntersect(a,o,m,_)||(f.curHPTOBe=parseInt(f.curHPTOBe-s),f.beShootWithTower(i,this.nLevel,r))}for(h=0;h<n.curIndexEnd;h++){var T=n.getIndexOfCreepsByID(h);if(!(T<0||T>=n.creeps.length)){var d=.5*(f=n.creeps[T]).width,c=.5*f.height,u=l.p(f.x-d,f.y),p=l.p(f.x+d,f.y),m=l.p(f.x,f.y-c),_=l.p(f.x,f.y+c),g=!1;a.y==o.y&&(a.y==f.y||a.y==u.y&&a.y==p.y)?(a.x<u.x&&o.x<u.x&&a.x<p.x&&o.x<p.x||a.x>u.x&&o.x>u.x&&a.x>p.x&&o.x>p.x)&&(g=!0):a.x==o.x&&(a.x==f.x||a.x==u.x&&a.x==p.x)&&(a.y<u.y&&o.y<u.y&&a.y<p.y&&o.y<p.y||a.y>u.y&&o.y>u.y&&a.y>p.y&&o.y>p.y)&&(g=!0),f.curHP<1||g||!l.pSegmentIntersect(a,o,u,p)&&!l.pSegmentIntersect(a,o,m,_)||(f.curHPTOBe=parseInt(f.curHPTOBe-s),f.beShootWithTower(i,this.nLevel,r))}}var f=n.superBoss;if(f&&f.curHP>0){var d=.5*f.width,c=.5*f.height,u=l.p(f.x-d,f.y),p=l.p(f.x+d,f.y),m=l.p(f.x,f.y-c),_=l.p(f.x,f.y+c),g=!1;a.y==o.y&&(a.y==f.y||a.y==u.y&&a.y==p.y)?(a.x<u.x&&o.x<u.x&&a.x<p.x&&o.x<p.x||a.x>u.x&&o.x>u.x&&a.x>p.x&&o.x>p.x)&&(g=!0):a.x==o.x&&(a.x==f.x||a.x==u.x&&a.x==p.x)&&(a.y<u.y&&o.y<u.y&&a.y<p.y&&o.y<p.y||a.y>u.y&&o.y>u.y&&a.y>p.y&&o.y>p.y)&&(g=!0),f.curHP<1||g||!l.pSegmentIntersect(a,o,u,p)&&!l.pSegmentIntersect(a,o,m,_)||(f.curHPTOBe=parseInt(f.curHPTOBe-s),f.beShootWithTower(i,this.nLevel,r))}this.runAction(l.fadeOut(i.fMaxFadeSecd)),this.nState=2},stopBeat:function(){this.stopAllActions(),this.setMonster(null),this.nState=2,this.setVisible(!1)}});Vs.create=function(){return new Vs},l.CircleBy=l.ActionInterval.extend({m_sConfig:null,m_time:0,ctor:function(e,t){this._super(e),this.m_sConfig=t,this.m_time=e},tuoyuanXat:function(e,t,i){return 1==t?-e*Math.cos(2*Math.PI*i+l.degreesToRadians(this.m_sConfig.kRoataion))+e:e*Math.cos(2*Math.PI*i+l.degreesToRadians(this.m_sConfig.kRoataion))+e},tuoyuanYat:function(e,t,i){return e*Math.sin(2*Math.PI*i+l.degreesToRadians(this.m_sConfig.kRoataion))},update:function(e){if(this.target){var t=this.m_sConfig.centerPosition,i=this.m_sConfig.aLength,n=this.m_sConfig.rRoataion,s=this.m_sConfig.bLength,r=this.tuoyuanXat(i,n,e),a=this.tuoyuanYat(s,n,e);this.target.setPosition(l.pAdd(t,l.p(r-i,a)))}}}),l.circleBy=function(e,t){return new l.CircleBy(e,t)};var zs=l.Node.extend({vec_dlg:null,ctor:function(){this._super(),l.director.getScheduler().schedule(this.schedule_clear,this,1,!1)},schedule_clear:function(){for(var e=0;e<this.vec_dlg.length;e++){var t=this.vec_dlg[e];t.getParent()&&t.getParent().removeChild(t,!0),t.release()}this.vec_dlg=[]},toClose:function(e){this.vec_dlg.push(e)}}),Ys=function(){var e;return{name:"_DlgMgr",shared:function(){return void 0===e&&(e=new zs),e}}}(),Xs=l.Layer.extend({_fxInvalid:0,_fyInvalid:0,_ctx:0,_Bg:null,_bCalced:!1,arrayLayer:null,m_bUseLogger:!1,m_layerName:"",_className:"ShieldLayer",m_ctx:0,pShieldSprite:null,listener:null,ctor:function(e){this._super(),this.arrayLayer=[],this.init(e)},init:function(e){this._super();var t=nr.share().getWinSize();return this.pShieldSprite&&(this.pShieldSprite.removeFromParent(),this.pShieldSprite=null),this.pShieldSprite=new l.Sprite,this.pShieldSprite.setAnchorPoint(0,0),this.pShieldSprite.setContentSize(t),this.pShieldSprite.setPosition(0,0),this.addChild(this.pShieldSprite),this.addColorLayer(this.pShieldSprite),!0},onEnterTransitionDidFinish:function(){this._super()},onEnter:function(){this._super(),!this.m_layerName.length&&this.m_bUseLogger&&(this.m_ctx=Tt.onSubStart(this.getLayerName()))},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),!this.m_layerName.length&&this.m_bUseLogger&&Tt.onSubEnd(this.getLayerName()),this._super()},addColorLayer:function(e){this._Bg=e;var t=6e3;if(e&&!nr.share().isIphone5()){var i=nr.share().GetScale(),n=e.getContentSize(),s=this.getContentSize(),r=s.height,a=-300,o=e.x+(1-e.anchorX)*e.width+10;if(o>0){var h=s.width-o,d=s.height;i<1&&(h=(s.width-n.width*i)/2/i,d=s.height/i,h<1&&(h=1)),r=d,a=h;var c=new l.LayerColor(l.color(0,0,0,255),h,d);c.setPosition(o,0),this.addChild(c,t),this.arrayLayer.push(c),t++}var u=e.x-e.anchorX*e.width;if(u>0)(p=new l.LayerColor(l.color(0,0,0,255),u,r)).setPosition(0,0),this.addChild(p,t),this.arrayLayer.push(p);else{var p=new l.LayerColor(l.color(0,0,0,255),a,r);p.setPosition(-a,0),this.addChild(p,t),this.arrayLayer.push(p)}t++;var m=e.y+(1-e.anchorY)*e.height,_=s.width,g=s.height-n.height;i<1&&(_/=i,g=(s.height-n.height*i)/2/(i-.1));var T=new l.LayerColor(l.color(0,0,0,255),_,g);T.setPosition(0,m),this.addChild(T,t),this.arrayLayer.push(T),this.arrayLayer.push(T),t++;var f=e.y-e.anchorY*e.height,S=_,w=g;if(f>0)(v=new l.LayerColor(l.color(0,0,0,255),S,f)).setPosition(0,0),this.addChild(v,t),this.arrayLayer.push(v);else{var v=new l.LayerColor(l.color(0,0,0,255),S,w);v.setPosition(0,-w),this.addChild(v,t),this.arrayLayer.push(v)}t++}},getInvalidSize:function(){var e=l.size(this._fxInvalid,this._fyInvalid);if(this._Bg&&!this._bCalced){var t=this.getContentSize(),i=this._Bg.getContentSize();this._fxInvalid=(t.width-i.width)/2,this._fyInvalid=(t.height-i.height)/2,e=l.size(this._fxInvalid,this._fyInvalid)}return e},getBGPostion:function(){return this._Bg?this._Bg.getPosition():l.p(0,0)},getBGContentSize:function(){return this._Bg?this._Bg.getContentSize():l.p(0,0)},getBGAnchorpoint:function(){return this._Bg?this._Bg.getAnchorPoint():l.p(0,0)},isInShieladLayer:function(e){var t,i=!1;for(var n in this.arrayLayer)if((t=this.arrayLayer[n])&&t.width>=0&&t.height>=0&&(i=l.rectContainsPoint(t.getBoundingBox(),e)))break;return i},addLayerName:function(e,t){this.m_bUseLogger=t;var i=wr.getModel();null!=i&&i.m_nGameMode!=ge.CHALLENGEMODE?e&&(this.m_layerName=e):this.m_layerName="ChallengeMode"},getLayerName:function(){return this.m_layerName}}),js=l.LayerColor.extend({ctor:function(e,t,i){return this._super(e,t,i),!0}});js.create=function(e,t,i){return new js(e,t,i)};var Ks={DT_BULLETIN:0,DT_NOTICE:1,DT_NOTICENOCLOSE:2,DT_TAB:3,DT_TITLE:4,DT_SHOP:5,DT_MAIL:6,DT_LOGIN:7},qs={MENU_CLOSE:100,MENU_TOPLEFT:101,MENU_TOPRIGHT:102,MENU_LEFTTOP:103,MENU_LEFTBOTTOM:104},Qs=function(e,t){return new e(t)},Zs=Xs.extend({curType:0,spMainFrame:null,lableStoneCount:null,isWait:!0,isBusy:!1,bExitUnLockMenu:!1,ctor:function(e){this._super(e)},init:function(e){this._super();var t=wr.getModel();this.bExitUnLockMenu=0==t.bLockMenu,t.bLockMenu=!0,this.loadResources();var i=nr.share().getWinSize(),n=new l.LayerColor(l.color(0,0,0,178),i.width+20,i.height);this.addChild(n,-2),this.curType=e;var s=null;switch(e){case Ks.DT_BULLETIN:this.spMainFrame=new l.Sprite("#woodbg_notice.png");break;case Ks.DT_NOTICE:this.spMainFrame=new l.Sprite("#woodbg_notice.png");var r=this.spMainFrame.getBoundingBox(),a=new l.Sprite("popup_close_frame.png");a.setPosition(.937*r.width,.85*r.height),this.spMainFrame.addChild(a),s=this.createMenuItemWithFile("popup_close.png",qs.MENU_CLOSE,a.getPosition());break;case Ks.DT_NOTICENOCLOSE:this.spMainFrame=new l.Sprite("#woodbg_notice.png");break;case Ks.DT_TAB:this.spMainFrame=new l.Sprite("woodbg_tab.png");r=this.spMainFrame.getBoundingBox();s=this.createMenuItemWithFile("popup_close.png",qs.MENU_CLOSE,l.p(.937*r.width,.855*r.height));break;case Ks.DT_TITLE:this.spMainFrame=new l.Sprite("woodbg_title.png");r=this.spMainFrame.getBoundingBox();s=this.createMenuItemWithFile("popup_close.png",qs.MENU_CLOSE,l.p(.937*r.width,.896*r.height));break;case Ks.DT_SHOP:this.spMainFrame=new l.Sprite("shop_mainbg.png"),(o=new l.Sprite("popup_close_frame.png")).setPosition(910,530),this.spMainFrame.addChild(o,99);r=this.spMainFrame.getBoundingBox();s=this.createMenuItemWithFile("popup_close.png",qs.MENU_CLOSE,l.p(910,530));break;case Ks.DT_MAIL:this.spMainFrame=new l.Sprite("mail_bg.png"),(o=new l.Sprite("popup_close_frame.png")).setPosition(910,530),this.spMainFrame.addChild(o,99);r=this.spMainFrame.getBoundingBox();s=this.createMenuItemWithFile("popup_close.png",qs.MENU_CLOSE,l.p(910,530));break;case Ks.DT_LOGIN:this.spMainFrame=new l.Sprite("everyday_1.png");var o=new l.Sprite("popup_close_frame.png");o.setPosition(760,470),this.spMainFrame.addChild(o,99);r=this.spMainFrame.getBoundingBox();s=this.createMenuItemWithFile("popup_close.png",qs.MENU_CLOSE,l.p(760,470))}if(this.spMainFrame&&!this.spMainFrame.getParent()&&(this.addChild(this.spMainFrame,1),this.spMainFrame.setPosition(.5*i.width,.5*i.height)),s){var h=new l.Menu(s);h.setPosition(0,0),this.spMainFrame.addChild(h,99,119)}return this.addChildItems(),!0},onEnterTransitionDidFinish:function(){this.getParent();this._super()},loadResources:function(){},onExit:function(){wr.getModel().bLockMenu=!1,qu.clearOwner(this),this._super()},setBusyTag:function(e){this.isBusy=e},clickMenuCallback:function(e){var t=wr.getModel();if(!t.showRewardLayer)switch(e.getTag()){case qs.MENU_CLOSE:if(t.bNoStoneDlgOpen)return;if(this.isBusy)return;this.setVisible(!1),this.isWait&&(l.director.getScheduler().isWaite=!1),t.playSoundWithType($.MTMENUSELECT),t.bLockMenu=!1,this.removeFromParent()}},createMenuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e),a=null;(a=void 0==n?new l.Sprite(e):new l.Sprite(n)).setScale(void 0==n?1.2:1);var o=null;null!=s&&(o=new l.Sprite(s));var h=new l.MenuItemSprite(r,a,o,this,this.clickMenuCallback.bind(this));return r.setAnchorPoint(.5,.5),r.setPosition(.5*h.width,.5*h.height),a.setAnchorPoint(.5,.5),a.setPosition(.5*h.width,.5*h.height),o&&(o.setAnchorPoint(.5,.5),o.setPosition(.5*h.width,.5*h.height)),h.setTag(t),h.setPosition(i),h},keyBackClicked:function(){this.setVisible(!1),this.getParent()&&this.removeFromParent(),this.isWait&&(l.director.getScheduler().isWaite=!1);var e=wr.getModel();e.playSoundWithType($.MTMENUSELECT),e.bLockMenu=!1},toClose:function(){this.setVisible(!1),this.isWait&&(l.director.getScheduler().isWaite=!1),wr.getModel().bLockMenu=!1,Ys.shared().toClose(this)},showInScene:function(){l.director.getRunningScene().addChild(this,1e4)}}),Js={SIZE_UNKNOWN:0,SIZE_220x176:1,SIZE_320x240:2,SIZE_480x320:3,SIZE_480x288:4,SIZE_400x240:5,SIZE_480x272:6,SIZE_960x480:7,SIZE_960x540:8,SIZE_960x640:9,SIZE_640x480:10,SIZE_640x360:11,SIZE_1024x600:12,SIZE_1024x552:13,SIZE_1024x768:14,SIZE_1024x480:15,SIZE_2048x1536:16,SIZE_800x480:17,SIZE_854x480:18,SIZE_1280x800:19,SIZE_1280x768:20,SIZE_1280x720:21,SIZE_800x600:22,SIZE_720x480:23,SIZE_1196x720:24,SIZE_1136x640:25,SIZE_1334x750:26,SIZE_2208x1242:27},$s=0,er=!1,tr=l.size(0,0),ir=l.Class.extend({name:"PlatfromSizeAdapter",mUnknownSize:null,mIphone5:!1,mIPad:!1,mMapOffset:null,android_mMapOffset:null,mScale:1,mOffsetPostion:null,mWinSize:null,mBuyTowerOffset:null,ctor:function(e){e=e||l.size(480,320),this.mUnknownSize=l.size(0,0),this.mOffsetPostion=l.p(0,0),this.mWinSize=l.size(0,0),this.create(e)},create:function(e){e=e||l.size(480,320),tr=e,this.mUnknownSize=e,$s=800===e.width&&480===e.height?Js.SIZE_800x480:854===e.width&&480===e.height?Js.SIZE_854x480:960===e.width&&640===e.height?Js.SIZE_960x640:480===e.width&&320===e.height?Js.SIZE_480x320:1024===e.width&&768===e.height?Js.SIZE_1024x768:1280===e.width&&720===e.height?Js.SIZE_1280x720:2048===e.width&&1536===e.height?Js.SIZE_2048x1536:960===e.width&&540===e.height?Js.SIZE_960x540:320===e.width&&240===e.height?Js.SIZE_320x240:800===e.width&&600===e.height?Js.SIZE_800x600:1024===e.width&&600===e.height?Js.SIZE_1024x600:1024===e.width&&552===e.height?Js.SIZE_1024x552:1280===e.width&&800===e.height?Js.SIZE_1280x800:400===e.width&&240===e.height?Js.SIZE_400x240:1280===e.width&&768===e.height?Js.SIZE_1280x768:1024===e.width&&480===e.height?Js.SIZE_1024x480:480===e.width&&272===e.height?Js.SIZE_480x272:960===e.width&&480===e.height?Js.SIZE_960x480:640===e.width&&480===e.height?Js.SIZE_640x480:480===e.width&&288===e.height?Js.SIZE_480x288:220===e.width&&176===e.height?Js.SIZE_220x176:720===e.width&&480===e.height?Js.SIZE_720x480:640===e.width&&360===e.height?Js.SIZE_640x360:1196===e.width&&720===e.height?Js.SIZE_1196x720:1136===e.width&&640===e.height?Js.SIZE_1136x640:1334===e.width&&750===e.height?Js.SIZE_1334x750:2208===e.width&&1242===e.height?Js.SIZE_2208x1242:Js.SIZE_UNKNOWN,this.init($s)},init:function(e){e=e||Js.SIZE_UNKNOWN,this.mIphone5=!1,this.mIPad=e===Js.SIZE_1024x768||e===Js.SIZE_2048x1536,this.mMapOffset=l.size(0,0),this.android_mMapOffset=l.size(0,0),e==Js.SIZE_480x320?this.init480x320():e===Js.SIZE_960x640?this.init960x640():e===Js.SIZE_960x540?this.init960x540():e===Js.SIZE_1280x720?this.init1280x720():e===Js.SIZE_1024x768||e===Js.SIZE_2048x1536?this.init1024x768():e===Js.SIZE_800x480?this.init800x480():e===Js.SIZE_854x480?this.init854x480():e===Js.SIZE_320x240?this.init320x240():e===Js.SIZE_800x600?this.init800x600():e===Js.SIZE_1024x600?this.init1024x600():e===Js.SIZE_1024x552?this.init1024x552():e===Js.SIZE_1280x800?this.init1280x800():e===Js.SIZE_400x240?this.init400x240():e===Js.SIZE_1280x768?this.init1280x768():e===Js.SIZE_1024x480?this.init1024x480():e===Js.SIZE_480x272?this.init480x272():e===Js.SIZE_960x480?this.init960x480():e===Js.SIZE_640x480?this.init640x480():e===Js.SIZE_480x288?this.init480x288():e===Js.SIZE_220x176?this.init220x176():e===Js.SIZE_720x480?this.init720x480():e===Js.SIZE_640x360?this.init640x360():e===Js.SIZE_1196x720?this.init1196x720():e===Js.SIZE_1136x640?this.init1136x640():e===Js.SIZE_1334x750?this.initUnknown():e===Js.SIZE_2208x1242?this.initUnknown():e===Js.SIZE_UNKNOWN&&this.initUnknown()},init480x320:function(){this.init960x640(),this.mScale=.5,this.mOffsetPostion=l.p(-120,-80)},init960x640:function(){this.mWinSize=l.size(960,640),this.mIPad=!0,this.mOffsetPostion=l.p(0,0)},init1024x768:function(){this.init960x640()},init800x480:function(){this.init1136x640(),this.mIphone5=!1,this.mOffsetPostion=l.p(-118,-55),this.mScale=800/1136},init854x480:function(){this.init1136x640(),this.mIphone5=!1,this.mOffsetPostion=l.p(-106,-60),this.mScale=.75},scaleScene:function(e){if(void 0!=e)if($s===Js.SIZE_1024x768||$s===Js.SIZE_2048x1536){var t=1;$s==Js.SIZE_2048x1536&&(t=2),e.setScale(1024*t/960),e.setPosition(0,42.67*t),e.setAnchorPoint(0,0)}else e.setScale(this.mScale),(this.mOffsetPostion.x||0!=this.mOffsetPostion.y)&&e.setPosition(l.pAdd(e.getPosition(),this.mOffsetPostion))},init960x540:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=960/1136,this.mOffsetPostion=l.p(-74,-42)},init960x480:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=.75,this.mOffsetPostion=l.p(-66,-60)},init1280x720:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=1280/1136,this.mOffsetPostion=l.p(81,45)},init320x240:function(){this.init960x640(),this.mScale=320/960,this.mOffsetPostion=l.p(-107,-67)},init800x600:function(){this.init960x640(),this.mScale=800/960,this.mOffsetPostion=l.p(-66,-20)},init1024x600:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=1024/1136,this.mOffsetPostion=l.p(-50.5,-18)},init1024x552:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=.8625,this.mOffsetPostion=l.p(-48,-38)},init1024x480:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=.75,this.mOffsetPostion=l.p(-42,-60)},init1280x800:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=1280/1136,this.mOffsetPostion=l.p(81,90)},init1280x768:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=1280/1136,this.mOffsetPostion=l.p(81,72)},init400x240:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=400/1136,this.mOffsetPostion=l.p(-130,-70)},init480x272:function(){this.init1136x640(),this.mScale=.425,this.mOffsetPostion=l.p(-139,-78)},init640x480:function(){this.init960x640(),this.mScale=640/960,this.mOffsetPostion=l.p(-107,-53)},init640x360:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=.5625,this.mOffsetPostion=l.p(-139.5,-79)},init480x288:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=480/1136,this.mOffsetPostion=l.p(-139,-74)},init220x176:function(){this.init960x640(),this.mScale=220/960,this.mOffsetPostion=l.p(-85,-53),this.mBuyTowerOffset=l.size(60,0)},init720x480:function(){this.init960x640(),this.mScale=.75,this.mOffsetPostion=l.p(-90,-60)},init1196x720:function(){this.init1136x640(),this.mIphone5=!1,this.mScale=1196/1136,this.mOffsetPostion=l.p(32,43)},init1136x640:function(){this.mIphone5=!0,this.mIPad=!0,this.mWinSize=l.size(1136,640),this.mMapOffset=l.size(88,0),this.mOffsetPostion=l.p(0,0)},initUnknown:function(){var e=this.mUnknownSize,t="not Support Display resolution ratio : "+e.width+" - "+e.height;l.log(t);var i=!1,n=e.width/e.height>=1.5,s=l.size(0,0);n?(this.init1136x640(),this.mIphone5=!1,s=l.size(1136,640),i=e.width/1136<e.height/640):(this.init960x640(),s=l.size(960,640),i=e.width/480<e.height/320),this.mScale=(i?e.width:e.height)/(i?n?1136:960:640),this.mOffsetPostion=l.p(.5*(e.width-s.width)*this.mScale,.5*(e.height-s.height)*this.mScale),t="mScale/mOffsetPostion : "+this.mScale+"  x"+this.mOffsetPostion.x+"  y"+this.mOffsetPostion.y,l.log(t)},getWinSize:function(){return this.mWinSize},getMapOffset:function(){return this.mMapOffset},getAndroid_MapOffset:function(){return this.android_mMapOffset},isIPad:function(){return this.mIPad},isIphone5:function(){return this.mIphone5},GetBuyTowerOffset:function(){return this.mBuyTowerOffset},GetScale:function(){return this.mScale},isUnknown:function(){return $s===Js.SIZE_UNKNOWN}}),nr=function(){var e;return{name:"CPlatfromSizeAdapter",share:function(){return void 0===e&&(e=new ir(l.size(480,320))),e},create:function(t,i){return e&&(e=null),e=new ir(l.size(t,i)),!0}}}(),sr={LBOSSTIME:-4,LUPDATEBG:-3,LUPDATECENTER:-2,LUPDATEBTN:-1,LMAINBG:0,LOBJECT:1,LGUIDBG:2,LGUIDCIRCLE:3,LTOWER:4,LPATHSTART:5,LPATHSTART2:6,LGUIDITEM:7,LCREEPS:8,LWATERPIPE:9,LPATHYZ:10,LPATHEND:11,LHOUSELIFE:12,LUPDATE:13,LWHALE:14,LPROJECT:15,LPROJECTCOVER:16,GIFTBALL_Z_START:3010,GIFTBALL_Z_END:3016,REBORN_Z:3017},rr={CREEPSTARTMOVE:-5,UPDATEACTION:-4,DUSTACTION:-3,MONEYACTION:-2,SCALEACTION:-1,MONSTERCM:0,REPEATACTION:1,ROTATEACTION:2,NORMALSPEED:3,SLOWSPEED:4,SPEEDACTIONS:5,LASTLOSTHP:6,STOPMOVE:7,WHALECOME:8,TROTATE:9,TINSHOOT:10,TSTARTSHOOT:11,TFIRE:12,PFLY:13,PCROOS:14,PEXPOLDE:15},ar={PTYPESTART:-129,PICBG:-128,PHPBG:-127,PHP:-126,ESHIT:-125,ESTAR:-124,EANCHOR:-123,EBLUESTAR:-122,ECOOLFAN:-121,EMOON:-120,EARROW:-119,EPIN:-118,EMUSHROOM:-117,EFISH:-116,EICE:-115,ESNOW:-114,ESUN:-113,EMAGNET:-112,EROCKET:-111,EAIR:-110,EDUST:-109,EMONEY:-108,PBOTTLE:-107,PSHIT:-106,PSTAR:-105,PSUN:-104,PBALL:-103,PFAN:-102,PMOON:-101,PFLASHLIGHT:-100,PARROW:-99,PROCKET:-98,PPLANE:-97,PFISH:-96,PANCHOR:-95,PCUTTLE:-94,PMAGNET:-93,PSNOW:-92,PFIREBOTTLE:-91,PBOOMERANG:-90,PPIN:-89,PBLUESTAR:-88,PTYPEEND:-87,SBLUESTAR:-86,SFISH:-85},or={FB_SHARE_FLOOR:0,FB_SHARE_MENU:1,FB_SHARE_TURNTABLE:2},hr=function(){function e(){}return{create:function(){return new e}}}(),lr=function(){function e(e,t,i,n,s){return{nCount:n||0,nIndex:i||-1,nPathID:t||0,startPos:e||l.p(0,0),nType:s||J.LM41}}return{create:function(t,i,n,s,r){return new e(t,i,n,s,r)}}}(),dr=function(){function e(e,t){var i=e||l.p(0,0),n=t||"";return"-3"===n&&(n="01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,"),{rcRange:i,strTowerType:n}}return{create:function(t,i){return new e(t,i)}}}(),cr=5,ur=25,pr=0,mr=171,_r=[1,2,3,5,7,10,16,19,23,27,31,34,37,41,66,71,101,102,136,139],gr=300,Tr=400,fr=400,Sr=l.Class.extend({curLevelResult:0,bGameStart:!1,bRestart:!1,bBackMainScene:!1,bInAddChildMonster:!1,creepspeed:null,creepspeed2:null,tasks:null,towers:null,creeps:null,creepIndexs:null,slideWay:null,slideWayBase:null,buildspace:null,objects:null,childCreeps:null,usersData:null,mapConfig:null,gameObjectConfig:null,curMonstersHPPer:null,curSelGoods:null,curMapConfig:null,animeLayer:null,gameLayer:null,randomTowers:null,dictWaterPipe:null,dictSlideWay:null,dictSlideWayBase:null,bLockMenu:!1,bLoopPath:!1,szTileRng:l.size(0,0),curAllMoney:0,curAllMoney2:-99,curTheme:0,curLevel:0,curWave:0,curListIndex:0,curListIndex2:0,curIndexEnd:0,curCreepCount:0,curKillMonsters:3,curWaveMonsterCount:0,curWaveMonsterCount2:0,bCurWaveNoMonster:!1,nCountDownTime:0,curLevelGetScore:0,curMainAdShowTimes:0,curMapAdShowTimes:0,curLeftAdShowTimes:0,curRightAdShowTimes:0,curGoMapAdShowTimes:0,nSpeedMultiples:1,nCarrotHP:10,nSecondCarrotHP:0,strDocRootPath:null,nTimeLoop:1,BgMusicVolumeSinkvaro:0,bCreepStopCome:!1,bShowGateNotHitAnimate:!0,bShowStarsInLevelSel:!1,m_bFeast:!1,life_show:!1,lose_show:!1,curShowPlayerGuid:re.UNKNOWGUIDE,m_nGameMode:ge.NORMALMODE,canShareMessTime:0,ys_ShareFloor:!1,ys_ShareGameMenu:!1,ys_ShareTurntable:!1,bTodayShowSina:!1,selLayer:null,mainLayer:null,vedioLayer:null,bNoStoneDlgOpen:!1,m_strMapPath:null,m_szScene:l.size(960,640),m_szSceneScale:l.size(0,0),bKillGate:!1,superBoss:null,gameCenter:null,m_ptSceneOffset:0,gameLastTime:null,m_oHigher:null,nEndlessBasicAddHP:0,m_oFeast:null,m_oChallenge:null,m_nRecoveryTime:0,mapCompose:null,curDropCreepID:0,curDropDiamond:0,curLevelGetDiamond:0,curNewTowerCard:0,willBeFinish:0,waypoints:null,waypoints2:null,waypointsstring:null,waypointsstring2:null,spMainFrame:null,mProductID:0,parentClass:0,m_pay_vec:null,b9100:!1,randomHighterNum:1,m_bIsShowDoubleModeTip:!1,ys_FbyerReady:!1,_themes:null,_costprops:null,bantimeContent:null,stageType:Le.NORMALMODE,_waveData:null,_messData:null,isQuick:!1,rewardDim:0,canbackreward:0,curShowNextPlayerGuid:0,_isShowGuid:!1,ctor:function(){null===this.mapCompose&&(this.mapCompose=new Gn),null===this.m_oHigher&&(this.m_oHigher=new Oa),null===this.m_oFeast&&(this.m_oFeast=new gn);var e=l.director.getVisibleSize();this.m_szSceneScale=l.size(e.width/this.m_szScene.width,e.height/this.m_szScene.height);var t=this.m_szSceneScale.width,i=this.m_szSceneScale.height;t<i?this.m_szSceneScale.height=t:this.m_szSceneScale.width=i;var n=l.size(this.m_szSceneScale.width*this.m_szScene.width,this.m_szSceneScale.height*this.m_szScene.height);this.m_ptSceneOffset=l.p(.5*(e.width-n.width),.5*(e.height-n.height)),this.m_bIsShowDoubleModeTip=!1,this._themes=[]},onEnter:function(){this._super()},onExit:function(){this._super()},loadData:function(){var e=!0;return this.usersData||(this.usersData=new Id),e=this.usersData.LoadUsersData(),this.m_oChallenge||(this.m_oChallenge=new lh),this.gameObjectConfig||(this.gameObjectConfig=new Oe),this.mapConfig||(this.mapConfig=new Rd),e},garbageMonster:function(e,t){var i=e;void 0===t&&(t=!0);var n=i.define.type;if(n<J.OBJECTEND){switch(i.bAddTime&&(this.animeLayer.showMoneyWithPt(l.p(i.x+6,i.y),5),this.playSoundWithType($.MTCLOCK),this.nCountDownTime+=5),i.nToBeTowerType){case-2:var s=this.getObjectByType(J.BOMB),r=String.formatC(s.strPic,0,1),a=l.spriteFrameCache.getSpriteFrame(r),o=String.formatC(this.gameObjectConfig.strItemsPic,8);l.spriteFrameCache.addSpriteFrames(o),a=l.spriteFrameCache.getSpriteFrame(r);var h=new l.Sprite(a);h.setPosition(i.getPosition()),this.gameLayer.addChild(h,sr.LPROJECT);for(var d=[],c=1;c<=s.nHP;++c){var u=String.formatC(s.strPic,0,c),p=l.spriteFrameCache.getSpriteFrame(u);d.push(p)}var m=new l.Animation(d,s.nMoney/1e3),_=[];for(c=1;c<=s.nPicCount;++c){var g=String.formatC(s.strPic,1,c),T=l.spriteFrameCache.getSpriteFrame(g);_.push(T)}var f=new l.Animation(_,s.fSpanSecond);i.nInitHP=s.nRunSpeed;var S=this;h.runAction(l.sequence(l.repeat(l.animate(m),2),l.callFunc(S.bombExplode,S,h),l.animate(f),l.callFunc(i.destoryNearObject,i,h),l.fadeOut(.1)));break;case 0:this.buildspace.push(this.rectWidthSprite(i));break;default:var w=i.width,v=i.height,L=this.szTileRng.width,M=this.szTileRng.height,C=parseInt((v+M-1)/M),y=parseInt((w+L-1)/L);w=parseInt(L*y),v=parseInt(M*C);var B=l.pSub(i.getPosition(),l.p(.5*w,.5*v)),E=F()%63,P=this.curTheme;1==C&&1==y&&(E=3);for(c=0;c<C;c++)for(var b=0;b<y;b++){var A=l.pAdd(B,l.p(L*b+.5*L,M*c+.5*L)),O=J.TBOTTLE;if(i.nToBeTowerType<0){if(0==(1&(E>>=1))){var I=l.rect(B.x+b*L,B.y+c*M,L,M);this.buildspace.push(I);continue}O+=P<4?(F()+E)%(6+4*(P-1)):(F()+E)%14}else O+=i.nToBeTowerType-1;var R=this.getObjectByType(O);this.addTower(A,O,1,2),this.creepsTask(O,O,0,R.strName)}}if(this.gameLayer.removeChild(i,!0),this.objects.remove(i),this.objects.length<1?this.showClearAllObj():1==this.objects.length&&this.objects[0].define.type==J.GATE&&this.showClearAllObj(),J.GATE==n){this.bKillGate=!0;var D=this.gameLayer;this.playMuiscWithType($.MTWARBGMSC,2),this.bLockMenu=!0,D.victorious(),this.bGameStart=!1}}else{if(J.SBB==n)return this.gameLayer.removeChild(this.superBoss,!0),this.superBoss=null,void(this.curWave+1>this.curMapConfig.nWaves&&this.curCreepCount<1&&(this.playMuiscWithType($.MTWARBGMSC,2),this.bLockMenu=!0,this.gameLayer.victorious(),this.bGameStart=!1));this.getIndexOfCreepsByID(i.nListID)<0?l.log("curCreepCount return"):(l.log("setIndexOfCreesps to -1 nListID = "+i.nListID),this.curCreepCount--,l.log("curCreepCount-- = "+this.curCreepCount),this.setIndexOfCreesps(-1,i.nListID),this.bCurWaveNoMonster&&n>J.OBJECTEND&&this.checkNextWave())}},bombExplode:function(){this.playSoundWithType($.MTBOMB)},showClearAllObj:function(){var e=l.spriteFrameCache.getSpriteFrame("targetscleard.png"),t=new l.Sprite(e);this.gameLayer.addChild(t,1e4);var i=nr.share().isIPad()?1:.5;t.setPosition(nr.share().getMapOffset().width+480*i,600*i);var n=l.moveTo(.2,nr.share().getMapOffset().width+480*i,532*i),s=l.moveTo(.2,nr.share().getMapOffset().width+480*i,600*i),r=l.delayTime(3),a=l.sequence(n,r,s);t.runAction(a),this.playSoundWithType($.MTCLEARALLOBJ)},towerTask:function(e,t){if(null!=this.tasks){void 0==t&&(t=0);for(var i=this.tasks.length,n=0;n<i;n++){var s=this.tasks[n];s.isFinished()||s.dataType!=se.BUILDTOWER||s.isWhatTower!==e&&s.isWhatTower!==J.TOWEREND||(s.isLessMore()?t<0?s.addFinishCount(-1):0===t&&s.addFinishCount(1):3===t&&s.addFinishCount(1),0!=s.isEqual()&&(s.isLessMore()?(s.actionDone(!1),this.gameLayer.gameHUD.UpdateTaskState(n+1,nn.TaskLose)):(s.actionDone(),this.gameLayer.gameHUD.UpdateTaskState(n+1,nn.TaskComplete))))}}},creepsTask:function(e,t,i,n){if(null!=this.tasks){void 0===n&&(n="");for(var s=null,r=0,a=!1,o=this.tasks.length,h=0;h<o;h++){var l=this.tasks[h];if(!l.isFinished())if(l.dataType>se.KILLMONSTER&&(s=l).getActionTime()<this.gameLastTime)l.actionDone(!1),this.gameLayer.gameHUD.UpdateTaskState(h+1,nn.TaskLose);else switch(l.dataType){case se.KILLMONSTER:t>J.OBJECTEND&&t<J.MONSTEREND&&((s=l).isWhatTower!==e&&s.isWhatTower!==J.TOWEREND||(s.addFinishCount(1),s.isEqual()&&(s.actionDone(),this.gameLayer.gameHUD.UpdateTaskState(h+1,nn.TaskComplete))));break;case se.KILLOBJECT:if(t<J.OBJECTEND&&n.length>0){var d=","+n+",";r=(s=l).beActionName.length,a=s.beActionName.indexOf(d),(0===r||a>=0)&&(s.addFinishCount(1),s.isEqual()&&s.getActionTime()>=this.gameLastTime&&(s.actionDone(),this.gameLayer.gameHUD.UpdateTaskState(h+1,nn.TaskComplete)))}break;case se.EARNMONEY:i>0&&(l.addFinishCount(i),s=l,l.isFullCount()&&s.getActionTime()>=this.gameLastTime&&(l.actionDone(),this.gameLayer.gameHUD.UpdateTaskState(h+1,nn.TaskComplete)));break;case se.FINDTOWER:t>J.MONSTEREND&&e>J.MONSTEREND&&(r=(s=l).beActionName.length,a=s.beActionName.indexOf(n),(0===r||a>=0)&&(l.addFinishCount(1),l.isEqual()&&s.getActionTime()>=this.gameLastTime&&(l.actionDone(),this.gameLayer.gameHUD.UpdateTaskState(h+1,nn.TaskComplete))))}}}},pauseAllMonsterAndTower:function(){for(var e in this.creeps)this.creeps[e].pause();for(var e in this.towers)this.towers[e].pause()},resumeAllMonsterAndTower:function(){for(var e in this.creeps)this.creeps[e].resume();for(var e in this.towers)this.towers[e].resume()},insertMessMonster:function(e){this.insertTarget(e.type,e.wayPoint,e.position,e.curHP,e.nInitHP)},insertTarget:function(e,t,i,n,s){var r=fc.create(e);this.creeps.push(r);var a=this.creeps.length-1,o=null,h=this.getObjectByType(e);for(var d in this.creepspeed)if((o=this.creepspeed[d]).moveSpeed===h.nRunSpeed)break;r.moveSpeed=o,e===J.SBB?this.superBoss=r:(r.nListID=this.curIndexEnd,this.setIndexOfCreesps(a,this.curIndexEnd),this.curIndexEnd++,this.curCreepCount++),r.setWhichPath(t>0?1:2);var c=Math.abs(t);if(r.curWayPoint=c?c-1:c,r.waypoints=t>0?this.waypoints:this.waypoints2,r.waypointssting=t>0?this.waypointsstring:this.waypointsstring2,r.setPosition(i),r.runRepeatActionWithDefine(h),this.gameLayer.addChild(r,sr.LCREEPS),r.nInitHP=s,r.curHP=n,r.curHPTOBe=n,r.nInitHP==r.curHP){var u=r.getChildByTag(ar.PHPBG);u&&u.setVisible(!1)}else r.showMonsterHP();var p=r.curDuration(),m=r.getNextWayPoint(this.bLoopPath);if(m){var _=m,g=this,T=l.sequence(l.moveTo(p,_),l.callFunc(g.gameLayer.FollowPath,g.gameLayer,r));T.setTag(rr.NORMALSPEED),r.curActionType=rr.NORMALSPEED,r.runAction(T)}},addTarget:function(){var e=this.nextMonsterType(),t=-1;if(!(e>J.UNKNOW))return!1;if(e===J.FLM3)return this.gameLayer.showMonster(),this.showFLM3(),!0;var i=!1,n=null;if((t=this.idleMonsterIndex(e))<0||t>=this.creeps.length)n=fc.create(e),this.creeps.push(n),t=this.creeps.length-1,i=!0;else{if(!(n=this.creeps[t]))return!1;n.curWayPoint=0,n.bPlaySound=!1,n.nInitHP=n.define.nHP}n.setWhichPath(1),n.waypoints=this.waypoints,n.waypointssting=this.waypointsstring;var s=null,r=this.getObjectByType(e);for(var a in this.creepspeed)if((s=this.creepspeed[a]).moveSpeed===r.nRunSpeed)break;if(n.moveSpeed=s,e===J.SBB?this.superBoss=n:(n.nListID=this.curIndexEnd,this.setIndexOfCreesps(t,this.curIndexEnd),this.curIndexEnd++,this.curCreepCount++),this.scaleTargetHP(n,e),n.setPosition(n.getCurWayPoint()),n.runRepeatActionWithDefine(r),i?this.gameLayer&&this.gameLayer.addChild(n,sr.LCREEPS):(n.setOpacity(255),n.setVisible(!0),n.fSpeedSlowPer=1,n.nAnimateCount=0),n.showMonsterCm(),n.nInitHP==n.curHP){var o=n.getChildByTag(ar.PHPBG);o&&o.setVisible(!1)}else n.showMonsterHP();var h=n.curDuration(),d=n.getNextWayPoint(this.bLoopPath);if(d){var c=d,u=this,p=l.sequence(l.moveTo(h,c),l.callFunc(u.gameLayer.FollowPath,u.gameLayer,n));p.setTag(rr.NORMALSPEED),n.curActionType=rr.NORMALSPEED,n.runAction(p)}return!0},addTarget2:function(){var e=this.nextMonsterType2(),t=-1;if(!(e>J.UNKNOW))return!1;if(e==J.FLM3)return this.gameLayer.showMonster(),this.showFLM3(),!0;var i=!1,n=null;if((t=this.idleMonsterIndex(e))<0||t>=this.creeps.length)n=fc.create(e),this.creeps.push(n),t=this.creeps.length-1,i=!0;else{if(!(n=this.creeps[t]))return!1;n.curWayPoint=0,n.bPlaySound=!1,n.nInitHP=n.define.nHP}n.setWhichPath(2),n.waypoints=this.waypoints2,n.waypointssting=this.waypointsstring2;var s=null,r=this.getObjectByType(e);for(var a in this.creepspeed2)if((s=this.creepspeed2[a]).moveSpeed===r.nRunSpeed)break;if(n.moveSpeed=s,e===J.SBB?this.superBoss=n:(n.nListID=this.curIndexEnd,this.setIndexOfCreesps(t,this.curIndexEnd),this.curIndexEnd++,this.curCreepCount++),this.scaleTargetHP(n,e),n.setPosition(n.getCurWayPoint()),n.runRepeatActionWithDefine(r),i?this.gameLayer&&this.gameLayer.addChild(n,sr.LCREEPS):(n.setOpacity(255),n.setVisible(!0),n.fSpeedSlowPer=1,n.nAnimateCount=0),n.showMonsterCm(),n.nInitHP==n.curHP){var o=n.getChildByTag(ar.PHPBG);o&&o.setVisible(!1)}else n.showMonsterHP();var h=n.curDuration(),d=n.getNextWayPoint(this.bLoopPath);if(d){var c=d,u=this,p=l.sequence(l.moveTo(h,c),l.callFunc(u.gameLayer.FollowPath,u.gameLayer,n));p.setTag(rr.NORMALSPEED),n.curActionType=rr.NORMALSPEED,n.runAction(p)}return!0},scaleTargetHP:function(e,t){var i=e,n=1,s=this.usersData;switch(s.finalLevelFailCount){case 0:n=1;break;case 1:n=.9;break;case 2:n=.8;break;case 3:n=1}i.curHPTOBe=i.curHP=i.nInitHP=parseInt(i.nInitHP),this.m_nGameMode===ge.HIGHERMODE?n*=1+this.m_oHigher.getHardPer():n*=1+s.getHardPer(this.curTheme),this.curMapConfig.bPresentGate&&this.m_nGameMode!==ge.HIGHERMODE?t<J.BMT?i.curHPTOBe=i.nInitHP=i.curHP=parseInt(this.nEndlessBasicAddHP+i.nInitHP*this.curMonstersHPPer[t-J.LM1]):t===J.BMT?i.curHPTOBe=i.nInitHP=i.curHP=parseInt(i.nInitHP*this.curMonstersHPPer[t-J.LM1]*Math.pow(1.5,this.nTimeLoop-1)):i.curHPTOBe=i.nInitHP=i.curHP=parseInt(i.nInitHP*this.curMonstersHPPer[t-J.LM1]*Math.pow(2,this.nTimeLoop-1)):i.curHPTOBe=i.nInitHP=i.curHP=parseInt(i.nInitHP*this.curMonstersHPPer[t-J.LM1]),(n=this.m_nGameMode==ge.HIGHERMODE?this.m_oHigher.getPackageCount(_e.CUTALLMONSTERHP):this.mapCompose.getPackageCount(_e.CUTALLMONSTERHP))>l.FLT_EPSILON?i.curHPTOBe=i.curHP=parseInt(i.nInitHP*n):t<J.BMT?(n=this.m_nGameMode==ge.HIGHERMODE?this.m_oHigher.getPackageCount(_e.CUTCREEPHP):this.mapCompose.getPackageCount(_e.CUTCREEPHP))>l.FLT_EPSILON&&(i.curHPTOBe=i.curHP=parseInt(i.nInitHP*n)):t<J.BOMB&&(n=this.m_nGameMode==ge.HIGHERMODE?this.m_oHigher.getPackageCount(_e.CUTBOSSHP):this.mapCompose.getPackageCount(_e.CUTBOSSHP))>l.FLT_EPSILON&&(i.curHPTOBe=i.curHP=parseInt(i.nInitHP*n)),this.m_bFeast&&this.m_oFeast.getCurFeastType()==un&&(i.curHPTOBe=i.curHP=parseInt(i.curHP*(1+this.m_oFeast.getCutOffCreepHP()))),i.curHPTOBe<1&&(i.curHPTOBe=i.nInitHP=i.curHP=1)},ismapFileExist:function(e,t){for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},getMapPath:function(e){if(this.m_strMapPath)return this.m_strMapPath;var t=new Array(28,40,43,56,58,62,91,94,112,126,128,131,146,153);if(this.m_nGameMode===ge.HIGHERMODE){if(this.m_oHigher.isHalfBattle()&&(this.m_strMapPath=this.m_oHigher.getHalfBattlePath(),l.log("DataMode...GAMEMODE.HIGHERMODE-isHalfBattle curLevel=%d.;curTheme=%d;...tileMap是 %s",this.curLevel,this.curTheme,this.m_strMapPath)),null==this.m_strMapPath||0==this.m_strMapPath.length){i=this.randomHighterNum;this.ismapFileExist(t,this.curLevel)&&(i=1),this.m_strMapPath=String.formatC("res/Themes/Maps/BG%02lu_%d.tmx",this.curLevel,i),l.log("DataMode...GAMEMODE.HIGHERMODE curLevel=%d.;curTheme=%d;...tileMap是 %s",this.curLevel,this.curTheme,this.m_strMapPath)}}else if(this.m_nGameMode===ge.HARDMODE){var i=F()%2+2;this.ismapFileExist(t,this.curLevel)&&(i=1),this.m_strMapPath=String.formatC("res/Themes/Maps/BG%02lu_%d.tmx",this.curLevel,i),l.log("DataMode...GAMEMODE.HARDMODE curLevel=%d.;curTheme=%d;...tileMap是 %s",this.curLevel,this.curTheme,this.m_strMapPath)}else this.m_nGameMode==ge.CHALLENGEMODE?(this.m_strMapPath=String.formatC("res/Themes/DayMaps/BG%s.tmx",this.m_oChallenge.getMapName()),l.log("DataMode...GAMEMODE.CHALLENGEMODE curLevel=%d.;curTheme=%d;...tileMap是 %s",this.curLevel,this.curTheme,this.m_strMapPath)):(this.m_strMapPath=String.formatC("res/Themes/Maps/BG%02lu.tmx",this.curLevel),l.log("DataMode...GAMEMODE.NORMALMODE curLevel=%d.;curTheme=%d;...tileMap是 %s",this.curLevel,this.curTheme,this.m_strMapPath));return this.m_strMapPath},changeMapPath:function(){this.m_strMapPath&&(this.m_strMapPath=null),this.getMapPath()},setRecoveryTime:function(e){e=e||0,this.m_nRecoveryTime=e},highterRecovery:function(){this.removeAllCreeps(),this.m_nRecoveryTime++,this.bLockMenu=!1;var e=this.gameLayer;e.gameHUD.registerWithTouchDispatcher(!0),this.m_nGameMode===ge.HIGHERMODE?(this.nCarrotHP=10,this.usersData.getCarrotFigure()===ue.CARROT_FAT&&(this.nCarrotHP+=2)):this.m_nGameMode==ge.DOUBLECARROT?(this.nCarrotHP=5,this.nSecondCarrotHP=5,this.usersData.getSecondCarrotFigure()==ue.CARROT_FAT&&(this.nSecondCarrotHP+=2)):this.nCarrotHP=3,e.nGameState=0,e.changeCarrotHP(),this.curWaveMonsterCount=0,this.curWaveMonsterCount2=0,this.curListIndex=0,this.curListIndex2=0,this.curCreepCount=0,this.curIndexEnd=0,this.childCreeps=[],this.bInAddChildMonster=!1,this.gameLayer.showChildMonsterEnd(),this.gameLayer.nextWave(),l.director.getScheduler().isWaite=!1,this.playMuiscWithType($.MTSTARTBGMSC,4)},removeAllCreeps:function(){for(var e=0;e<this.curIndexEnd;e++){var t=this.getIndexOfCreepsByID(e);if(!(t<0||t>=this.creeps.length)){var i=this.creeps[t];i.curHP=-1,i.garbageGoods(!1),i.nAnimateCount++,i.animationFinished()}}},addTowerBuff:function(e){if(null!==e){var t=e,i=0,n=0;if(t.define.type===J.TBOTTLE&&3===t.nCurLevel){t.addPowerBuff(.3,1),i=t.nShootRange+.71*t.width,n=this.towers.length;for(r=0;r<n;r++){var s=this.towers[r];l.pDistance(s.getPosition(),t.getPosition())<i&&s.addPowerBuff(.3,1)}}else{i=0,n=this.towers.length;for(r=0;r<n;r++)if((s=this.towers[r]).define.type===J.TBOTTLE&&3===s.nCurLevel&&(0===i&&(i=s.nShootRange+.71*s.width),l.pDistance(s.getPosition(),t.getPosition())<i)){t.addPowerBuff(.3,1);break}}}else for(var n=this.towers.length,r=0;r<n;r++)(s=this.towers[r]).addPowerBuff(.3,1)},moveTowerBuff:function(e){var t=e;if(t.define.type===J.TBOTTLE&&3===t.nCurLevel){for(var i=t.nShootRange+.71*t.width,n=[],s=this.towers.length,r=0;r<s;r++)(o=this.towers[r]).define.type===J.TBOTTLE&&3===o.nCurLevel&&t!==o&&n.push(o);for(var a=n.length,r=0;r<s;r++){var o=this.towers[r];if(l.pDistance(o.getPosition(),t.getPosition())<i){for(var h=!0,d=0;d<a;d++){var c=n[d];if(l.pDistance(o.getPosition(),c.getPosition())<i){h=!1;break}}h&&o.addPowerBuff(-.3,1)}}}},showFLM3:function(){for(var e,t=new l.TMXTiledMap(this.getMapPath()).getObjectGroup(O.kMPath),i=.5*this.szTileRng.width,n=this.szTileRng.height/16,s=nr.share().getMapOffset(),r=1;;r++){var a=String.formatC("F3PT%d",r);if(null===(e=t.getObject(a)))break;var o=this.idleMonsterIndex(J.FLM3),h=!1,d=null;if(o<0||o>=this.creeps.length){var c=null,u=this.getObjectByType(J.FLM3);for(var p in this.creepspeed)if((c=this.creepspeed[p]).moveSpeed===u.nRunSpeed)break;(d=new fc(J.FLM3)).moveSpeed=c,this.creeps.push(d),o=this.creeps.length-1,h=!0}else{if(!(d=this.creeps[o]))continue;d.nInitHP=d.define.nHP,d.bPlaySound=!1}var m=d.define;if(d.nListID=this.curIndexEnd,this.setIndexOfCreesps(o,this.curIndexEnd),this.curIndexEnd++,this.curCreepCount++,this.scaleTargetHP(d,J.FLM3),d.setPosition(l.p(parseFloat(e.valueForKey("x"))+i+s.width,parseFloat(e.valueForKey("y"))-n+s.height)),d.curWayPoint=parseFloat(e.valueForKey("index")),d.runRepeatActionWithDefine(m),h?this.gameLayer&&this.gameLayer.addChild(d,sr.LCREEPS):((_=d.getChildByTag(ar.PHPBG))&&_.setVisible(!1),d.setOpacity(255),d.setVisible(!0),d.fSpeedSlowPer=1,d.nAnimateCount=0),d.showMonsterCm(),d.nInitHP==d.curHP){var _=d.getChildByTag(ar.PHPBG);_&&_.setVisible(!1)}else d.showMonsterHP();var g=d.getCurWayPoint(),T=l.pSub(d.getPosition(),g),f=0;(f=Math.abs(T.x)>Math.abs(T.y)?T.x/d.moveSpeed.moveSpeed:T.y/d.moveSpeed.moveSpeed)<0&&(f=-f);var S=this,w=l.sequence(l.moveTo(f,d.getCurWayPoint()),l.callFunc(S.gameLayer.FollowPath,S.gameLayer,d));w.setTag(rr.NORMALSPEED),d.curActionType=rr.NORMALSPEED,d.runAction(w)}},addChildMonster:function(){for(var e=!1,t=this.childCreeps.length,i=0;i<t;i++){var n=this.childCreeps[i];if(n.nCount>0){n.nCount--,e=!0;var s=n.nType+1,r=this.idleMonsterIndex(s),a=!1,o=null;if(r<0||r>=this.creeps.length)o=fc.create(s),this.creeps.push(o),r=this.creeps.length-1,a=!0;else{if(!(o=this.creeps[r]))return!1;o.nInitHP=o.define.nHP,o.bPlaySound=!1}var h=null,d=this.getObjectByType(s),c=null;c=1===n.nPathID?this.creepspeed:this.creepspeed2;for(var i in c)if((h=c[i]).moveSpeed===d.nRunSpeed)break;o.moveSpeed=h;var u=o.define;if(o.nListID=this.curIndexEnd,this.setIndexOfCreesps(r,this.curIndexEnd),this.curIndexEnd++,this.scaleTargetHP(o,n.nType),o.curHPTOBe=parseInt(o.curHPTOBe*u.nLevelCount*.1),o.nInitHP=parseInt(o.nInitHP*u.nLevelCount*.1),o.curHP=parseInt(o.nInitHP*u.nLevelCount*.1),o.setPosition(n.startPos),o.curWayPoint=n.nIndex-1,o.runRepeatActionWithDefine(u),a?this.gameLayer&&this.gameLayer.addChild(o,sr.LCREEPS):((p=o.getChildByTag(ar.PHPBG))&&p.setVisible(!1),o.setOpacity(255),o.setVisible(!0),o.fSpeedSlowPer=1,o.nAnimateCount=0),1===n.nPathID?(o.waypointssting=this.waypointsstring,o.waypoints=this.waypoints):(o.waypointssting=this.waypointsstring2,o.waypoints=this.waypoints2),o.showMonsterCm(),o.nInitHP===o.curHP){var p=o.getChildByTag(ar.PHPBG);p&&p.setVisible(!1)}else o.showMonsterHP();var m=o.getNextWayPoint(this.bLoopPath),_=l.pSub(o.getPosition(),m),g=0;(g=Math.abs(_.x)>Math.abs(_.y)?_.x/o.moveSpeed.moveSpeed:_.y/o.moveSpeed.moveSpeed)<0&&(g=-g);var T=this,f=l.sequence(l.moveTo(g,o.getCurWayPoint()),l.callFunc(T.gameLayer.FollowPath,T.gameLayer,o));f.setTag(rr.NORMALSPEED),o.curActionType=rr.NORMALSPEED,o.runAction(f)}}return e},addChildCreep:function(e,t,i,n,s){var r=lr.create(e,t,i,n,s);null==this.childCreeps&&(this.childCreeps=[]),this.childCreeps.push(r),this.curCreepCount+=n},getIndexOfCreepsByID:function(e){return this.creepIndexs&&this.creepIndexs.length?this.creepIndexs[e].nIndex:-1},setIndexOfCreesps:function(e,t){if(t>=this.creepIndexs.length)for(var i=0;i<30;i++)this.creepIndexs.push(hr.create());this.creepIndexs[t].nIndex=e},idleMonsterIndex:function(e){var t=-1,i=0;for(var n in this.creeps){var s=this.creeps[n];if(s&&!s.isVisible()&&s.define.type==e){t=i;break}i++}return t},addTower:function(e,t,i,n,s){var r=Bs.newTowerWithType(t,i);switch(n=n||1,void 0===s&&(s=this._posToGridIndex(e)),r.gridIndex=s,r.setPosition(e),r.setShootRange(),this.addTowerBuff(r),t>=J.CSNOW?this.m_nGameMode==ge.DOUBLECARROT?(this.gameLayer.m_secondHouse=r,r.setAnchorPoint(.5,0),this.gameLayer.addChild(r,sr.LPATHEND,O.SECONDTOWERHOUSETAG),this.towers.push(r)):(this.gameLayer.house=r,r.setAnchorPoint(.5,0),this.gameLayer.addChild(r,sr.LPATHEND,O.TOWERHOUSETAG),this.towers.push(r)):(this.gameLayer.addChild(r,sr.LTOWER),this.towers.push(r)),n){case 3:this.changeMoney(-r.define.nBuyMoney[0]);case 2:this.animeLayer.showDustWithPt(e,1),this.playSoundWithType($.MTTOWERBUILD);case 1:this.gameLayer.showUpdateTip(null)}var a=this.m_nGameMode===ge.HIGHERMODE?this.m_oHigher.getPackageCount(_e.ADDPOWER):this.mapCompose.getPackageCount(_e.ADDPOWER);a>l.FLT_EPSILON&&r.addPowerBuff(a,2);for(var o in this.slideWayBase){var h=this.slideWayBase[o];for(var d in h){var c=h[d],u=c.getBoundingBox();if(l.rectContainsPoint(u,e)){c.SetTower(r);break}}}return this.m_bFeast&&this.m_oFeast.getCurFeastType()==_n.ADDTOWERPOWER&&(r.fPowerBuff+=this.m_oFeast.getAddTowerPower()),r},setCurLevel:function(e){this.curLevel=e,this._messData||(this.mCurSceneTarget===we.LEVELSELCIRCLE&&this.usersData.getTempleLastPlayedLevel()===e&&(this.bRestart=!0),this.usersData.getLastPlayedLevel()===e&&1!==e&&(this.bRestart=!0))},getCurTheme:function(){return this.mapConfig.allLevels[this.curLevel-1].nTheme},getCurConfig:function(){return this.mapConfig.allLevels[this.curLevel-1]},getObjectByType:function(e){var t=null;return e>J.SELPOINT&&e<J.OBJECTEND?t=this.gameObjectConfig.objectGroup[e]:e>J.OBJECTEND&&e<J.MONSTEREND||e<J.MENUBG?t=this.gameObjectConfig.monsterGroup[e]:e>=J.MONSTEREND&&e<J.TOWEREND&&(t=this.gameObjectConfig.towerGroup[e]),t},monsterDifSpeed:function(){var e=this.gameObjectConfig.monsterGroup,t=[];for(var i in e){for(var n=e[i],s=n.nRunSpeed,r=!1,a=0;a<t.length;a++)if(t[a]===s){r=!0;break}if(r||t.push(s),n==J.SBB)break}return t},curMonsterType:function(){return this.curMapConfig&&this.curMapConfig.wavesList.length&&this.curListIndex<this.curMapConfig.wavesList.length?this.curMapConfig.wavesList[this.curListIndex].nMonsterType:J.UNKNOW},playMuiscWithType:function(e,t,i){var n=e;switch(t){case 1:if(this.gameObjectConfig.allMusics.length&&n<this.gameObjectConfig.allMusics.length&&this.usersData.bgMusic&&0==l.audioEngine.isMusicPlaying()){var s=String.formatC(this.gameObjectConfig.allMusics[n],this.curTheme);l.log("musicStr :"+s+"mtype:"+n),l.audioEngine.playMusic(s,i)}break;case 2:l.audioEngine.stopMusic();break;case 3:this.usersData.bgMusic&&l.audioEngine.pauseMusic();break;case 4:this.usersData.bgMusic&&l.audioEngine.resumeMusic()}},playPetSoundWithType:function(e,t){if(this.usersData.soundFX&&e<this.gameObjectConfig.allMusics.length&&this.gameObjectConfig.allMusics.length){if(e>=$.MTCUTWHALE&&e<$.MTPBUYITEM||e==$.MTWARBGMSC||e==$.MTPFAN)return;var i=String.formatC(this.gameObjectConfig.allMusics[e],t);this.playSoundWithFile(i)}},playSoundWithFile:function(e){this.usersData.soundFX&&(this.b9100&&(pr>=ur&&(pr=0),pr++),l.audioEngine.playEffect(e))},playSoundWithType:function(e){if(this.usersData.soundFX&&e<this.gameObjectConfig.allMusics.length){if(e>=$.MTCUTWHALE&&e<$.MTPBUYITEM||e==$.MTWARBGMSC||e==$.MTPFAN)return;this.playSoundWithFile(this.gameObjectConfig.allMusics[e])}},playSoundWithMTType:function(e){if(this.usersData.soundFX&&this.gameObjectConfig.allMusics.length){var t=10==this.curTheme?1:this.curTheme;t>6&&(t=F()%6+1);var i=null;i=e>J.FTM?"res/Music/Monsters/Fly151.mp3":e===J.FTM?"res/Music/Monsters/Fat141.mp3":"res/Music/Monsters/Land111.mp3",this.playSoundWithFile(i)}},decodeWaveData:function(e){for(var t=this,i=function(e){var i={},n=255&e,s=255&(e>>=8);e>>=8,i.wayPoint=255&e,e>>=8,i.type=e;var r=t._gridIndexToPos(s);return r.x+=3*(n>>4),r.y+=3*(15&n),i.position=r,i},n=window.atob(e),s=(new ArrayBuffer(n.length),[]),r=[],a=[],o=[],h=[],d=null,c=0,u=0,p=0,m=0,_=window.atob(e),g=_.length,T=new Uint8Array(g),f=0;f<g;f++)T[f]=_.charCodeAt(f);var S=new Int32Array(T.buffer),w=(S[c++],65535&(R=S[c++])),v=R>>>16,L=S[c++],M=S[c++],C=S[c++];if(C){d={};I=i(C);d.type=I.type,d.wayPoint=I.wayPoint,d.position=I.position,d.nInitHP=S[c++],d.curHP=S[c++]}for(m=S[c++];m>0;){var y=null,B=null,F=[(u=S[c++])>>16,65535&u],p=0;for(var f in F){if(!(p=F[f]))break;m--,B=this._gridIndexToPos(p>>8),p&=255,(y=l.rect()).x=B.x,y.y=B.y,y.width=70*(p>>4),p&=15,y.height=70*p,s.push(y)}}m=S[c++];for(var E={};m--;){var P={};u=S[c++],P.position=this._gridIndexToPos(u>>16),P.position.x+=35,P.position.y+=35,u&=65535,P.type=u>>8,P.level=255&u,E[P.type]=1,h.push(P)}for(var b in E)o.push(b);for(m=S[c++];m--;){var A={};u=S[c++],A.gridIndex=u>>>24,u&=16777215,A.type=u>>16,u&=65535,A.hp=u,a.push(A)}for(m=S[c++];m--;){var O={},I=i(S[c++]);O.type=I.type,O.position=I.position,O.wayPoint=I.wayPoint;var R=S[c++];O.nInitHP=R>>16,R&=65535,O.curHP=R,r.push(O)}var D={};return D.creeps=r,D.boss=d,D.objects=a,D.towers=h,D.buildSpace=s,D.carrotHP=w,D.secondCarrotHP=v,D.money=L,D.nCountDownTime=M,D.towerTypes=o,D},_posToGridIndex:function(e){var t=nr.share().getMapOffset(),i=l.size(25,70),n=(l.size(70,70),l.p(e.x,e.y));return n.x-=t.width,n.y-=t.height,n.x-=i.width,n.y-=i.height,n.x=Math.round(n.x),n.y=Math.round(n.y),n.x=n.x-n.x%70,n.y=n.y-n.y%70,n.x/70<<4|n.y/70},_gridIndexToPos:function(e){var t=15&e,i=(240&e)>>4;t*=70,i*=70;var n=nr.share().getMapOffset(),s=l.size(25,70);return i+=n.width,t+=n.height,i+=s.width,t+=s.height,l.p(i,t)},getMessData:function(){return this._messData},setMessData:function(e){this._messData=e,e&&this.setCurLevel(e.level)},defaultObjectList:null,loadMessWaveData:function(e,t){var i=this.decodeWaveData(t);this.buildspace=i.buildSpace,this.nCountDownTime=i.nCountDownTime,this.curAllMoney2=this.curAllMoney=i.money,this.gameLayer.gameHUD.changeMoney(i.money),this.nCarrotHP=i.carrotHP,this.nSecondCarrotHP=i.secondCarrotHP;var n=this.gameLayer;n.unschedule(n.showMonster),n.unschedule(n.nextWave),this.animeLayer.clearSprites(),this.animeLayer.beSelGoods=null,this.curSelGoods=null;for(var s in this.towers){(a=this.towers[s]).removeFromParent();for(var r in a.projectiles)a.projectiles[r].removeFromParent()}this.towers.length=0,null===this.defaultObjectList&&(this.defaultObjectList=[].concat(this.objects));for(var s in this.objects)(c=this.objects[s]).removeFromParent();this.removeAllCreeps(),this.superBoss&&(this.superBoss.removeFromParent(),this.superBoss=null),this.curWaveMonsterCount=0,this.curWaveMonsterCount2=0,this.curCreepCount=0,this.curIndexEnd=0,this.curListIndex=0,this.curListIndex2=0,this.bInAddChildMonster=!1,this.gameLayer.showChildMonsterEnd(),this.objects.length=0,this.childCreeps&&(this.childCreeps.length=0),n.nGameState=0;for(var s in i.buildSpace)this.buildspace.push(i.buildSpace[s]);for(var s in i.towers){var a=i.towers[s];this.addTower(a.position,a.type,a.level,1)}for(s=0;s<i.creeps.length;s++){var o=i.creeps[s];this.insertMessMonster(o)}if(i.boss&&this.insertMessMonster(i.boss),!this.bLoopPath){var h=502;this.m_nGameMode==ge.DOUBLECARROT&&(h=506),this.m_nGameMode==ge.DOUBLECARROT?n.getCarrotImg(this.usersData.getSecondCarrotFigure(),h):n.getCarrotImg(this.usersData.getCarrotFigure(),h),n.changeCarrotHP()}var l=this.defaultObjectList,d=[].concat(i.objects);for(var s in l){var c=l[s];for(var r in d){var u=d[r];if(u.gridIndex===c.gridIndex){this.objects.push(c),c.curHP=u.hp,c.curHPTOBe=u.hp,c.nInitHP=Math.max(c.curHP,c.nInitHP),c.hideHP(),c.visible=!0,n.addChild(c,sr.LOBJECT),d.splice(r,1);break}}}this.curWave=e,n.gameHUD.showNextWave(e)},getWaveDataForShare:function(){var e={},t=this._waveData;e.level=t.level,e.waves=[],e.datas=[];var i=[0,4,8,12];this.curMapConfig.nWaves>=15&&(i=[0,6,12,18,24]);var n=this.m_nGameMode===ge.HIGHERMODE?this.m_oHigher.getCurMapLevel():this.getCurConfig();(e.bLoopPath||n.bPresentGate)&&(i=[0]);for(var s in i){var r=i[s];if(!(t.waves.length>r))break;e.waves.push(t.waves[r]),e.datas.push(t.datas[r])}return e},saveWaveData:function(){var e=this,t=this,i=this._waveData;null==i&&((i={}).level=this.curLevel,i.waves=[],i.datas=[],i.towers=[],this._waveData=i);var n=function(e){var i=0,n=e.getPosition(),s=e.define.type,r=e.curWayPoint,a=t._posToGridIndex(n),o=t._gridIndexToPos(a),h={x:Math.round(n.x-o.x),y:Math.round(n.y-o.y)},l=Math.round(h.x/3)<<4|Math.round(h.y/3);return 2==e.getWhichPath()&&(r=-r),i|=s<<24,i|=r<<16,i|=a<<8,i|=l},s=0,r=new ArrayBuffer(2048),a=new Int32Array(r),o=0,h=0;i.waves.push(this.curWave);var l=e.nCarrotHP;this.m_nGameMode===ge.DOUBLECARROT&&(l|=this.nSecondCarrotHP<<16),a[o++]=1,a[o++]=l,a[o++]=e.getAllMoney(),a[o++]=e.nCountDownTime;var d=e.superBoss;d&&d.curHP>0?(a[o++]=n(d),a[o++]=Math.ceil(d.nInitHP),a[o++]=Math.ceil(d.curHP)):o+=1,h=e.buildspace.length,a[o++]=h,s=0;for(m=0;m<h;m++){m%2==0&&m&&(a[o++]=s,s=0),s<<=16;var c=e.buildspace[m];s|=this._posToGridIndex(c)<<8,s|=c.width/70<<4,s|=c.height/70}0==(4294901760&s)&&(s<<=16),a[o++]=s,h=0,e.towers&&(h=e.towers.length);var u=e.usersData.getCarrotFigure();(!this.bLoopPath&&u==ue.CARROT_GIRL||u==ue.CARROT_OLD)&&h--,a[o++]=h;for(var p=e.towers,m=0;m<p.length;m++){var _=p[m];_.define.type!=J.CSNOW&&_.define.type!=J.CROCKET&&(!function(e){for(var t in i.towers)if(i.towers[t]===e)return;i.towers.push(e)}(_.define.type),s=_.gridIndex<<16|_.define.type<<8|_.nCurLevel,a[o++]=s)}var g=e.objects;h=g.length;for(var T=0,m=0;m<h;m++)g[m].curHP>0&&T++;a[o++]=T;for(m=0;m<h;m++){s=0;var f=g[m];f.curHP<=0||(s|=f.gridIndex<<24,s|=f.define.type<<16,s|=Math.ceil(f.curHP),a[o++]=s)}h=0;for(var S=e.creepIndexs,w=[],m=0;m<S.length;m++){var v=S[m];v.nIndex&&-1!==v.nIndex&&(L=e.creeps[v.nIndex]).curHP>0&&(h++,w.push(L))}a[o++]=h;for(m=0;m<h;m++){var L=w[m];a[o++]=n(L),s=Math.ceil(L.nInitHP<<16)|Math.ceil(L.curHP),a[o++]=s}r=a.buffer;for(var M="",C=new Uint8Array(r),y=4*o,m=0;m<y;m++)M+=String.fromCharCode(C[m]);var B=window.btoa(M);i.datas.push(B)},nextWave:function(){l.log("------------------------new wave ---------------------------"),this.m_nGameMode===ge.HIGHERMODE||this.canShareMessData()&&this.saveWaveData();this.curMapConfig.nWaves;if(++this.curWave,this.bLoopPath){if(this.curWave>this.curMapConfig.nWaves)return}else{this.curIndexEnd=0;for(var e=this.creepIndexs.length,t=0;t<e;t++)this.setIndexOfCreesps(-1,t)}},isPlayMess:function(){return null!=this._messData&&GamePlatform.isCN()&&GamePlatform.getCurrentPlatForm()==PlatformType.QQ},canShareMessData:function(){return!1},checkNextWave:function(){if(this.curCreepCount<1){this.bCurWaveNoMonster=!1;var e=this.gameLayer;if(this.curWave+1>this.curMapConfig.nWaves){if(this.curMapConfig.bPresentGate&&!this.bKillGate){if(this.nTimeLoop+=1,this.m_nGameMode!=ge.HIGHERMODE){for(var t=this.curWave;t>0;){var i=this.curMapConfig.wavesList[t];if(i.nMonsterType<J.BMT){i.nMonsterType<J.FTM?this.nEndlessBasicAddHP=this.nEndlessBasicAddHP+this.getObjectByType(i.nMonsterType).nHP*this.curMonstersHPPer[i.nMonsterType-J.LM1]:i.nMonsterType==J.FTM?this.nEndlessBasicAddHP=this.nEndlessBasicAddHP+this.getObjectByType(i.nMonsterType).nHP*this.curMonstersHPPer[i.nMonsterType-J.LM1]/1.2:this.nEndlessBasicAddHP=this.nEndlessBasicAddHP+this.getObjectByType(i.nMonsterType).nHP*this.curMonstersHPPer[i.nMonsterType-J.LM1]/.7;break}t--}for(var n=J.OBJECTEND+1;n<J.MONSTEREND;n++)this.curMonstersHPPer.splice(n-J.LM1,1,1)}else this.m_oHigher.updateLevelsPer();return this.curWave=0,this.curListIndex=0,void e.schedule_nextWave(this.curMapConfig.nEveryListSpan)}null==this.superBoss&&(this.playMuiscWithType($.MTWARBGMSC,2),this.bLockMenu=!0,e.victorious(),this.bGameStart=!1)}else{if(this.curMapConfig.bPresentGate&&this.bKillGate)return this.playMuiscWithType($.MTWARBGMSC,2),this.bLockMenu=!0,e.victorious(),void(this.bGameStart=!1);if(e.schedule_nextWave(this.curMapConfig.nEveryListSpan),this.curWave+2>this.curMapConfig.nWaves){var s=wr.getModel();if(s.bLoopPath||s.curMapConfig.bPresentGate)return;this.playSoundWithType($.MTFINALWAVE),this.animeLayer.showLastWaveTip()}}}},nextMonsterType:function(){this.curWaveMonsterCount++;var e=this.curMapConfig.wavesList.length,t=null;if(!e)return J.UNKNOW;for(;this.curListIndex<e&&!((t=this.curMapConfig.wavesList[this.curListIndex]).nWave>=this.curWave&&1==t.nPathNum&&this.curWaveMonsterCount<=t.nMonsterCount);)this.curWaveMonsterCount=1,this.curListIndex++;if(null==t||t.nWave>this.curWave||this.curListIndex>=e)return this.curWaveMonsterCount=0,J.UNKNOW;if(1==this.curWaveMonsterCount){var i=t.nMonsterType-J.LM1;if(this.curMonstersHPPer.length&&i<this.curMonstersHPPer.length){var n=this.curMonstersHPPer[t.nMonsterType-J.LM1];n=t.fHPIncreasePercent,this.curMonstersHPPer.splice(t.nMonsterType-J.LM1,1,n)}}return t.nMonsterType},nextMonsterType2:function(){this.curWaveMonsterCount2++;var e=this.curMapConfig.wavesList.length,t=null;if(!e)return J.UNKNOW;for(;this.curListIndex2<e&&!((t=this.curMapConfig.wavesList[this.curListIndex2]).nWave>=this.curWave&&2==t.nPathNum&&this.curWaveMonsterCount2<=t.nMonsterCount);)this.curWaveMonsterCount2=1,this.curListIndex2++;if(null==t||t.nWave>this.curWave||this.curListIndex2>=e)return this.curWaveMonsterCount2=0,J.UNKNOW;if(1===this.curWaveMonsterCount2){var i=t.nMonsterType-J.LM1;if(this.curMonstersHPPer.length&&i<this.curMonstersHPPer.length){var n=this.curMonstersHPPer[t.nMonsterType-J.LM1];n=t.fHPIncreasePercent,this.curMonstersHPPer.splice(t.nMonsterType-J.LM1,1,n)}}return t.nMonsterType},scaleScene:function(e){e.setScaleX(this.m_szSceneScale.width),e.setScaleY(this.m_szSceneScale.height),e.setAnchorPoint(0,0),e.setPosition(this.m_ptSceneOffset)},getSceneSize:function(){return this.m_szScene},initCurLevel:function(){this.m_oFeast.updateInfo(),this.m_bFeast&&this.m_oFeast.getCurFeastType()==hn&&this.m_oFeast.resetDropDiamond();var e=this.getMessData(),t=null!=e;if(this.releaseCurLevelData(),this._messData=e,this.m_nGameMode==ge.HIGHERMODE?this.curMapConfig=this.m_oHigher.getCurMapLevel():(this.changeMapPath(),this.mapCompose&&this.mapCompose.resetPackage(),this.curLevel>100||this.m_nGameMode==ge.CHALLENGEMODE?(this.curMapConfig=this.mapCompose.getCurMapLevel(this.mapConfig,this.curLevel),(0==this.curMapConfig.nMoney||this.curLevel>155)&&(this.curMapConfig=this.mapConfig.allLevels[this.curLevel-1])):this.curMapConfig=this.mapConfig.allLevels[this.curLevel-1],this.m_nGameMode==ge.CHALLENGEMODE?this.curTheme=this.m_oChallenge.getCurTheme():this.curTheme=this.curMapConfig.nTheme,this.mapCompose&&this.mapCompose.createMagicCount()),this.curAllMoney=Math.floor(this.curMapConfig.nMoney),this.curAllMoney2+=Math.floor(this.curMapConfig.nMoney),this.allocAllArray(),t||!this.curMapConfig.tasks||this.m_nGameMode!=ge.NORMALMODE&&this.m_nGameMode!=ge.DOUBLECARROT)this.tasks=null;else{this.tasks=[];var i=this.curMapConfig.tasks;for(var n in i){var s=i[n].copyWithZone();this.tasks.push(s)}for(var r=this.usersData.getFinishTask(this.curLevel),a=this.tasks.length,n=0;n<a;n++)1&r&&this.tasks[n].actionDone(),r>>=1}switch(this.curTheme){case 1:case 10:this.curDropDiamond=3+F()%5;break;case 2:this.curDropDiamond=2+F()%8;break;case 3:this.curDropDiamond=2+F()%6;break;case 4:case 5:case 6:this.curDropDiamond=2+F()%5;break;case 7:case 8:case 9:this.curDropDiamond=2+F()%4}this.curDropCreepID=10+Math.floor(F()%20),this.curDropDiamond=Math.floor(.7*this.curDropDiamond),this.usersData.setLastPlayedLevel(this.curLevel),this.m_nGameMode==ge.DOUBLECARROT?(this.nCarrotHP=5,this.nSecondCarrotHP=5):this.nCarrotHP=10,this.usersData.getCarrotFigure()==ue.CARROT_FAT&&(this.nCarrotHP+=2),l.log("★★★DataModel- initCurLevel-curLevel: "+this.curLevel+";curTheme: "+this.curTheme)},allocAllArray:function(){this.creepspeed=[],this.creepspeed2=[],this.towers=[],this.creeps=[],this.creepIndexs=[],this.waypoints=[],this.waypoints2=[],this.waypointsstring=[],this.waypointsstring2=[],this.buildspace=[],this.objects=[],this.slideWay=[],this.slideWayBase=[],this.dictSlideWay={},this.dictSlideWayBase={},this.curMonstersHPPer=[];for(var e=J.OBJECTEND+1;e<J.MONSTEREND;e++)this.curMonstersHPPer.push(1);for(var t=0;t<30;t++)this.creepIndexs.push(hr.create())},releaseCurLevel:function(){this.releaseCurLevelData()},releaseCurLevelData:function(){this.m_nRecoveryTime=0,this.curLevelResult=0,this.bGameStart=!1,this.bLockMenu=!1,this.bLoopPath=!1,this.bInAddChildMonster=!1,this.bCreepStopCome=!1,this.usersData.bUserLoseStar=!1,this.curWave=0,this.curSelGoods=null,this.superBoss=null,this.nTimeLoop=1,this.curAllMoney=0,this.curAllMoney2=-99,this.curListIndex=0,this.curListIndex2=0,this.willBeFinish=0,this.curIndexEnd=0,this.curCreepCount=0,this.curKillMonsters=3,this.curNewTowerCard=0,this.curLevelGetScore=0,this.curWaveMonsterCount=0,this.curWaveMonsterCount2=0,this.nCountDownTime=0,this.gameLastTime=0,this.nSpeedMultiples=1,this.curDropCreepID=0,this.curDropDiamond=0,this.curLevelGetDiamond=0,this.curShowPlayerGuid=re.UNKNOWGUIDE,this.curMapConfig=null,this.creepspeed=null,this.creepspeed2=null,this.towers=null,this.creeps=null,this.creepIndexs=null,this.waypoints=null,this.waypoints2=null,this.buildspace=null,this.objects=null,this.childCreeps=null,this.randomTowers=null,this.curMonstersHPPer=null,this.tasks=null,this.waypointsstring=null,this.waypointsstring2=null,this.dictWaterPipe=null,this.slideWay=null,this.slideWayBase=null,this.dictSlideWay=null,this.dictSlideWayBase=null,this._waveData=null,this.defaultObjectList=null},sendHttp:function(e,t){var i=l.loader.getXMLHttpRequest();i.setTag(t),i.open("GET",e,!0);var n=this;i.onreadystatechange=function(){if(4==i.readyState&&i.status>=200&&i.status<=207){var e=i.statusText,t=i.responseText;console.log("Status: Got GET response! "+e),n.onHttpCompleted(t)}},i.send()},onHttpCompleted:function(e){if(e){l.log("code:"+e)}},drawPinkRangeWithParentRect:function(e,t){var i=new l.LayerColor(l.color(255,0,255,128),e.width,e.height);i.setPosition(e.x,e.y),t.addChild(i,100)},rectWidthSprite:function(e){var t=e.getContentSize();return l.rect(e.x-.5*t.width,e.y-.5*t.height,t.width,t.height)},shotCurScreen:function(e){void 0===e&&(e=0);nr.share().getWinSize();var t=null;return 0==e?this.gameLayer&&(t=this.gameLayer.getParent()):this.gameLayer&&(t=(t=this.gameLayer.getParent()).getChildByTag(1e3))&&(t=t.getChildByTag(9999)),Rt.shotCurScree()},checkMoneySafe:function(){return!0},getGiveMoney:function(e){if(!e)return 0;var t=e.type,i=e.nMoney;return this.m_bFeast&&this.m_oFeast.getCurFeastType()==cn&&t>J.OBJECTEND&&t<J.BMT?i*=this.m_oFeast.getDoubleGold():(this.m_nGameMode==ge.CHALLENGEMODE&&t>J.OBJECTEND&&t<J.BMT&&(i*=2),i)},changeMoney:function(e){this.curAllMoney+=e,this.curAllMoney2+=e},getAllMoney:function(){return this.curAllMoney},goBuy:function(e,t){return},billingComplete:function(e,t){wr.getModel()},buyOver:function(){var e=wr.getModel();if(this.m_pay_vec){var t=this.m_pay_vec.shift();switch(t){case oe.DIAMOND_JIDI:e.usersData.addDiamond(60),e.usersData.DLDiamond-=60,e.usersData.GMDiamond+=60;break;case oe.DIAMOND_PCUT:e.usersData.addDiamond(210),e.usersData.DLDiamond-=210,e.usersData.GMDiamond+=210,this.spMainFrame&&this.spMainFrame.changeStoneCount();break;case oe.DIAMOND_PCUT_GAMEMENU:e.usersData.addDiamond(210),e.usersData.DLDiamond-=210,e.usersData.GMDiamond+=210;break;case oe.DIAMOND_BOTTLE:e.usersData.addDiamond(135),e.usersData.DLDiamond-=135,e.usersData.GMDiamond+=135;break;case oe.DIAMOND_BOX:e.usersData.addDiamond(300),e.usersData.DLDiamond-=300,e.usersData.GMDiamond+=300;break;case oe.JEWEL_JIDI:e.usersData.addDiamond(480),e.usersData.DLDiamond-=480,e.usersData.GMDiamond+=480;break;case oe.LIFE_FOREVER:case oe.LIFE_FOREVER_PCUT:e.usersData.nomoreLostTime(),e.mCurSceneTarget==we.LEVELSEL?(this.spMainFrame&&this.mProductID==t&&(this.spMainFrame.getParent().lifeForeverUpdate(),this.spMainFrame.setVisible(!1),(e=wr.getModel()).bLockMenu=!1),t==oe.LIFE_FOREVER?this.spMainFrame.getParent().removeChild(this.spMainFrame,!0):t==oe.LIFE_FOREVER_PCUT&&(this.spMainFrame.getParent().ChangeDiscountMenuItem(),this.spMainFrame.getParent().removeChild(this.spMainFrame,!0))):e.mCurSceneTarget==we.LEVELSELCIRCLE?(this.spMainFrame&&this.mProductID==t&&(this.spMainFrame.getParent().lifeForeverUpdate(),this.spMainFrame.setVisible(!1),(e=wr.getModel()).bLockMenu=!1),t==oe.LIFE_FOREVER?this.spMainFrame.getParent().removeChild(this.spMainFrame,!0):t==oe.LIFE_FOREVER_PCUT&&(this.spMainFrame.getParent().ChangeDiscountMenuItem(),this.spMainFrame.getParent().removeChild(this.spMainFrame,!0))):e.mCurSceneTarget==we.STOREY?(this.spMainFrame&&this.mProductID==t&&(this.spMainFrame.getParent().lifeForeverUpdate(),this.spMainFrame.setVisible(!1),(e=wr.getModel()).bLockMenu=!1),t==oe.LIFE_FOREVER?this.spMainFrame.getParent().removeChild(this.spMainFrame,!0):t==oe.LIFE_FOREVER_PCUT&&(this.spMainFrame.getParent().ChangeDiscountMenuItem(),this.spMainFrame.getParent().removeChild(this.spMainFrame,!0))):e.mCurSceneTarget==we.MEETFRIEND&&(this.spMainFrame&&this.mProductID==t&&(this.spMainFrame.getParent().lifeForeverUpdate(),this.spMainFrame.setVisible(!1),(e=wr.getModel()).bLockMenu=!1),t==oe.LIFE_FOREVER?this.spMainFrame.getParent().removeChild(this.spMainFrame,!0):t==oe.LIFE_FOREVER_PCUT&&(this.spMainFrame.getParent().ChangeDiscountMenuItem(),this.spMainFrame.getParent().removeChild(this.spMainFrame,!0)));break;case oe.UNLOCK_SKY:e.usersData.setNextPlayedLevel(),e.usersData.setCarrotTheme(oe.UNLOCK_SKY,!0),(s=e.selLayer).removeChild(this.spMainFrame),s.showLevelInfo(this.curLevel);break;case oe.PCUT_UNLOCK_SKY:e.usersData.setNextPlayedLevel(),e.usersData.setCarrotTheme(oe.UNLOCK_SKY),(s=e.selLayer).ChangeDiscountMenuItem(),s.removeChild(this.spMainFrame,!0),this.setCurLevel(51),s.showLevelInfo(this.curLevel);break;case oe.UNLOCK_DESERT:e.usersData.setNextPlayedLevel(),e.usersData.setCarrotTheme(oe.UNLOCK_DESERT,!0),(s=e.selLayer).removeChild(this.spMainFrame),s.showLevelInfo(this.curLevel);break;case oe.PCUT_UNLOCK_DESERT:e.usersData.setNextPlayedLevel(),e.usersData.setCarrotTheme(oe.UNLOCK_DESERT),(s=e.selLayer).ChangeDiscountMenuItem(),s.removeChild(this.spMainFrame,!0),this.setCurLevel(66),s.showLevelInfo(this.curLevel);break;case oe.UNLOCK_GLACIER:e.usersData.setNextPlayedLevel(),e.usersData.setCarrotTheme(oe.UNLOCK_GLACIER,!0),(s=e.selLayer).removeChild(this.spMainFrame),s.showLevelInfo(this.curLevel);break;case oe.PCUT_UNLOCK_GLACIER:e.usersData.setNextPlayedLevel(),e.usersData.setCarrotTheme(oe.UNLOCK_GLACIER),(s=e.selLayer).ChangeDiscountMenuItem(),s.removeChild(this.spMainFrame,!0),this.setCurLevel(81),s.showLevelInfo(this.curLevel);break;case oe.REMOVE_AD:e.usersData.setNoAD(!0);break;case oe.GLODPACKAGE:this.spMainFrame&&(o=this.spMainFrame).BuyGlodPackage();break;case oe.BIGPACKAGE:this.spMainFrame&&(o=this.spMainFrame).BuyBigGlodPackage();break;case oe.PCUT_BIGPACKAGE:for(var i=e.usersData,n=0;n<5;n++){switch(n){case 0:i.getClearBBCount(),i.addClearBB(1,!1),i.DLClearBB-=1,i.GMClearBB+=1;break;case 1:i.getCarrotHPCount(),i.addCarrotHP(2,!1),i.DLCarrotHP-=2,i.GMCarrotHP+=2;break;case 2:i.getShootSPCount(),i.addShootSP(5,!1),i.DLShootSP-=5,i.GMShootSP+=5;break;case 3:i.getStopBBCount(),i.addStopBB(3,!1),i.DLStopBB-=3,i.GMStopBB+=3;break;case 4:i.getSlowBBCount(),i.addSlowBB(3,!0),i.DLSlowBB-=3,i.GMSlowBB+=3}}this.spMainFrame.setVisible(!1),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1;break;case oe.GIRLCARROT:this.spMainFrame&&((o=this.spMainFrame).BuyGirlCarrot(),o.refreshLayer4());break;case oe.PCUT_GIRLCARROT:e.usersData.setCarrotFigure(ue.CARROT_GIRL),this.spMainFrame.setVisible(!1),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1;break;case oe.FATCARROT:this.spMainFrame&&((o=this.spMainFrame).BuyFatCarrot(),o.refreshLayer4());break;case oe.PCUT_FATCARROT:e.usersData.setCarrotFigure(ue.CARROT_FAT),this.spMainFrame.setVisible(!1),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1;break;case oe.OLDCARROT:this.spMainFrame&&(o=this.spMainFrame).BuyOldCarrot();break;case oe.PCUT_OLDCARROT:e.usersData.setCarrotFigure(ue.CARROT_OLD),this.spMainFrame.setVisible(!1),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1;break;case oe.LIFE_10:this.spMainFrame&&this.mProductID==t&&(this.m_nGameMode==ge.HIGHERMODE?this.m_oHigher.addStarCount(10):e.usersData.addStarCount(10,!0),e.selLayer.UpdateStar(2));break;case oe.PCUT_STAR25:this.spMainFrame&&this.mProductID==t&&(this.spMainFrame.setVisible(!1),this.m_nGameMode==ge.HIGHERMODE?this.m_oHigher.addStarCount(15):e.usersData.addStarCount(15,!0),e.selLayer.UpdateStar(2),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1);break;case oe.BUY_PROP_100:case oe.BUY_PROP_101:case oe.BUY_PROP_102:case oe.BUY_PROP_103:case oe.BUY_PROP_104:case oe.PCUT_DIAMOND100:case oe.PCUT_BOMB4:case oe.PCUT_BLOOD4:case oe.PCUT_SPEED10:case oe.PCUT_ICE6:case oe.PCUT_SLOW6:if(t==oe.PCUT_DIAMOND100)e.usersData.addDiamond(100),e.usersData.DLDiamond-=100,e.usersData.GMDiamond+=100,e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1;else if(t==oe.BUY_PROP_100||t==oe.BUY_PROP_101||t==oe.BUY_PROP_102||t==oe.BUY_PROP_103||t==oe.BUY_PROP_104)this.spMainFrame&&(1==this.parentClass?this.spMainFrame.UpdateMigic():2==this.parentClass&&this.spMainFrame.UpdateMigic(),this.parentClass=0);else if(t==oe.PCUT_BOMB4||t==oe.PCUT_BLOOD4||t==oe.PCUT_SPEED10||t==oe.PCUT_ICE6||t==oe.PCUT_SLOW6){i=e.usersData;t==oe.PCUT_BOMB4?(e.usersData.addClearBB(4),i.DLClearBB-=4,i.GMClearBB+=4):t==oe.PCUT_BLOOD4?(e.usersData.addCarrotHP(4),i.DLCarrotHP-=4,i.GMCarrotHP+=4):t==oe.PCUT_SPEED10?(e.usersData.addShootSP(10),i.DLShootSP-=10,i.GMShootSP+=10):t==oe.PCUT_ICE6?(e.usersData.addStopBB(6),i.DLStopBB-=6,i.GMStopBB+=6):t==oe.PCUT_SLOW6&&(e.usersData.addSlowBB(6),i.DLSlowBB-=6,i.GMSlowBB+=6),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1}break;case oe.UNLOCK_THIRD:e.usersData.setNextPlayedLevel(),e.usersData.setCarrotTheme(oe.UNLOCK_THIRD,!0),(s=e.selLayer).removeChild(this.spMainFrame),this.setCurLevel(31),s.showLevelInfo(this.curLevel);break;case oe.PCUT_DIAMOND480:e.usersData.addDiamond(480),e.usersData.DLDiamond-=480,e.usersData.GMDiamond+=480,this.spMainFrame.setVisible(!1),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1;break;case oe.PCUT_DIAMOND300:e.usersData.addDiamond(300),e.usersData.DLDiamond-=300,e.usersData.GMDiamond+=300,this.spMainFrame.setVisible(!1),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1;break;case oe.PCUT_DIAMOND150:e.usersData.addDiamond(150),e.usersData.DLDiamond-=150,e.usersData.GMDiamond+=150,this.spMainFrame.setVisible(!1),e.selLayer.ChangeDiscountMenuItem(),e.selLayer.removeChild(this.spMainFrame,!0),e.bLockMenu=!1;break;case oe.UNLOCK_ICELAND:e.usersData.setNextPlayedLevel(),e.usersData.setCarrotTheme(oe.UNLOCK_ICELAND,!0),(s=e.selLayer).removeChild(this.spMainFrame),this.setCurLevel(116),s.showLevelInfo(this.curLevel);break;case oe.UNLOCK_TEMPLE:e.usersData.setCarrotFigure(ue.CARROT_GIRL);var s=e.selLayer;s.removeChild(this.spMainFrame),s.entranceTemple(),e.bLockMenu=!1;break;case oe.UNLOCK_HIGHER:e.usersData.setCarrotTheme(oe.UNLOCK_HIGHER,!0),e.mainLayer.removeChild(this.spMainFrame),e.usersData.OpenAllProps(),qi.preloadWithStoreyScene(we.STOREY,!1),e.bLockMenu=!1;break;case oe.HIGHER_STAYFLOOR:e.m_oHigher.saveDownLimite(),e.selLayer.buyStayFloor();break;case oe.HIGHER_PACKAGE:e.gameLayer.gameHUD.giftBallNoStoneBuy();break;case oe.SUPER_PACKAGE_1:if(e.usersData.nomoreLostTime(),e.usersData.addDiamond(300),e.usersData.DLDiamond-=300,e.usersData.GMDiamond+=300,this.spMainFrame&&((o=this.spMainFrame).changeStoneCount(),o.refreshLayer4()),this.spMainFrame.getParent()){var r=l.director.getRunningScene().getChildByTag(1);r&&r.lifeForeverUpdate()}break;case oe.SUPER_PACKAGE_2:e.usersData.addDiamond(300),e.usersData.DLDiamond-=300,e.usersData.GMDiamond+=300,this.spMainFrame&&((o=this.spMainFrame).BuyGirlCarrot(),o.changeStoneCount(),o.refreshLayer4());break;case oe.SUPER_PACKAGE_3:e.usersData.addDiamond(300),e.usersData.DLDiamond-=300,e.usersData.GMDiamond+=300,this.spMainFrame&&((o=this.spMainFrame).BuyFatCarrot(),o.changeStoneCount(),o.refreshLayer4());break;case oe.SUPER_PACKAGE_4:e.usersData.addDiamond(300),e.usersData.DLDiamond-=300,e.usersData.GMDiamond+=300,this.spMainFrame&&((o=this.spMainFrame).BuyGlodPackage(),o.changeStoneCount(),o.refreshLayer4());break;case oe.SUPER_PACKAGE_5:e.usersData.addDiamond(480),e.usersData.DLDiamond-=480,e.usersData.GMDiamond+=480,this.spMainFrame&&((o=this.spMainFrame).BuyBigGlodPackage(),o.changeStoneCount(),o.refreshLayer4())}if(this.spMainFrame&&t<oe.LIFE_FOREVER&&this.mProductID==t){this.spMainFrame.changeStoneCount();var a=String.formatC("%d",e.usersData.getDiamond()),o=this.spMainFrame.getParent();if(o&&o.spMainFrame){var h=o.spMainFrame.getChildByTag(111);if(h)h.setString(a);else{var d=o.spMainFrame.getChildByTag(2);d&&(h=d.getChildByTag(111))&&h.setString(a)}}}}},isDiscount:function(){return!1},isOpenedTowerByIndex:function(e){if(e>20||e<0)return!1;var t=_r[e];return(t>135?this.usersData.getTempleOpenedLevel():this.usersData.getOpenedLevel())>=t},getUnlockedTowersCount:function(){for(var e=0,t=0;t<20;t++)this.isOpenedTowerByIndex(t)&&e++;return e},setIsShowDoubleModeTip:function(e){this.m_bIsShowDoubleModeTip=e},getIsShowDoubleModeTip:function(){return this.m_bIsShowDoubleModeTip},getCurLevelDiamond:function(){if(this.curLevelGetDiamond<0)return-this.curLevelGetDiamond;var e=0;if(this.m_nGameMode==ge.CHALLENGEMODE)switch(this.m_oChallenge.getPlayDay()){case 1:case 2:case 3:case 4:case 5:e=5;break;case 6:case 7:e=10}return this.curLevelGetDiamond>0&&(e+=this.curLevelGetDiamond,this.curLevelGetDiamond=-e),e},addCurLevelDiamond:function(e){this.curLevelGetDiamond+=e},clearCurLvGetDiamond:function(){this.curLevelGetDiamond=0},getVungleRewardsDay:function(){return(new Date).getDate()},getCurSystemTime:function(){return Ql.getSvrDate().getTime()/1e3},timeIsOkForFbad:function(){var e=Tt.getOnlineConfig("facebookAD_interval","0");parseInt(e),wr.getModel().getCurSystemTime();return!1},setThemes:function(e){this._themes=e},getCurConsume:function(e){for(var t in this._themes){var i=this._themes[t];if(i.id==e)return i.coststar}return 1},addCostprops:function(e){if(void 0!=e){void 0==this._costprops&&(this._costprops=[]);var t=!1;for(var i in this._costprops){var n=this._costprops[i];if(n.id==e){n.count+=1,t=!0;break}}t||this._costprops.push({id:e,count:1})}},getCostprops:function(){return this._costprops},clearCostprops:function(){this._costprops=[]},getCostPropById:function(e){e=e||0;for(var t in this._costprops){var i=this._costprops[t];if(i.id==e)return i.count}return 0},getCarrotPrice:function(e){void 0==e&&(e=ue.CARROT_NORMAL);var t=e-ue.CARROT_NORMAL+1;return this._carrotDim&&t<this._carrotDim.length?this._carrotDim[t]:0},setCarrotPriceByType:function(e,t){this._carrotDim[e]=t},setCarrotPrice:function(e){this._carrotDim=e},getBuyStarPrice:function(e){return e?100:800},getBuyThemePrice:function(e){switch(e){case Me.CarrotGla:return 1500;case Me.CarrotSky:case Me.CarrotDes:return 800;case Me.BuyPolarRegion:case Me.BuyIceland:return 1500}return 0},setBantimeContent:function(e){this.bantimeContent=e},getBantimeContent:function(){return this.bantimeContent},setCarrotIsBuy:function(e){if(e instanceof Array){var t=this.usersData;t.bIsBuyCarrotGirl=e[0],t.bIsBuyCarrotFat=e[1],t.bIsBuyCarrotOld=e[2]}},isHasGuide:function(){var e=!1;switch(this.curShowPlayerGuid){case re.PLAYEDGUIDE:case re.FBPLAYEDGUIDE:case re.FBPLAYEDGUIDE1:e=!0}return e},isShowGuid:function(){return this._isShowGuid},setGuidState:function(e){this._isShowGuid=e}}),wr=function(){var e;return{name:"DataModel",getModel:function(){return void 0===e&&(e=new Sr),e},getActivedModel:function(){return e}}}(),vr={ALL:0,LEVEL:1},Lr={MENUITEM_UP:0,MENUITEM_DOWN:1,MENU_LAYER:2,MENU_LOGIN:3,MENU_SHARE:4,MENU_WECHAT:5,MENU_INVITE:6,CONTENTBOX1:7,CONTENTBOX2:8,CONTENTBOX3:9,CONTENTBOX4:10,HEAD1:11,HEAD2:12,HEAD3:13,HEAD4:14,USERNAME1:15,USERNAME2:16,USERNAME3:17,USERNAME4:18,GOLDCOUNT1:19,GOLDCOUNT2:20,GOLDCOUNT3:21,GOLDCOUNT4:22,TASTFINISHCOUNT1:23,TASTFINISHCOUNT2:24,TASTFINISHCOUNT3:25,TASTFINISHCOUNT4:26,RANK_1:27,RANK_2:28,RANK_3:29,RANK_4:30,QUN_SHARE:31},Mr=Zs.extend({m_nStart:0,m_nStyle:vr.ALL,mFriends:null,mLayer1:null,mLayer2:null,listener:null,datas:null,_mscale:1,_rewardSpr:null,ctor:function(){this.mFriends=[],this._super(Ks.DT_TITLE),this.addLayerName("scene-friend-honor"),this._mscale=.5,nr.share().isIPad()&&(this._mscale=1)},showFriends:function(e){var t=wr.getModel(),i=t.usersData.getidiRank(1);if(i&&ju.alert(i),this.m_nStyle=e,0==e){var n=this.spMainFrame.getChildByTag(10);n&&n.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("smuser_chart.png"));var s=this.spMainFrame.getChildByTag(11);s&&s.setVisible(!1);a=this;if(lp)if(GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp){var r=new np("friendRank");r.scale=1/window.devicePixelRatio*2,r.x=.5*this.width,r.y=.5*this.height,this.addChild(r,1)}else i?a.addLayer1():this.showRankLayer();else a.addLayer1()}if(GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp){var a=this;qu.loadResAsync(Gi,function(){qu.addRes(this,"res/Themes_cn/tencent/tencent_qun_share.plist");var e="themeaward_share_qun.png",i=a.menuItemWithFile(e,Lr.QUN_SHARE,l.p(12,390),e,e);t.usersData.isShareWeChat()||GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook||(a._qunrewardSpr=new l.Sprite("themeaward_share_wechat_new.png"),a._qunrewardSpr.setAnchorPoint(1,.5),a._qunrewardSpr.setPosition(23,.5*i.height),i.addChild(a._qunrewardSpr));var n=new l.Menu(i);n.setPosition(0,0),n.setTag(Lr.QUN_SHARE),a.spMainFrame.addChild(n,3)})}this.registerWithTouchDispatcher()},showRankLayer:function(){var e=this,t=nr.share().getWinSize(),i=new l.LabelTTF("请稍候... ","Arial",36);i.setAnchorPoint(.5,.5),i.setPosition(.5*t.width,.5*t.height),this.addChild(i,1e3,"loadingLabel"),SDKInterface.getFriendList(50,function(t){var i=[];e.datas=t;for(var n in t)i.push(t[n].id);console.log("openids :"+JSON.stringify(i));var s=e.getChildByName("loadingLabel");s&&s.removeFromParent(),i.length>0?e.addFriends(i):e.addLayer1()})},addFriends:function(e){e=e||[];var t=this;Ql.friendrank(e,function(e){if(t.mFriends=e.reverse(),t.mFriends){for(var i=GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook?"":100,n=0;n<t.mFriends.length;n++){var s=t.mFriends[n];if(s.openid!==l.playerInfo.openid)for(var r in t.datas){var a=t.datas[r];if(s.openid===a.id){s.name=a.name,s.photo=a.photo+i;break}}else s.name=l.playerInfo.name,s.photo=l.playerInfo.photo}t.mFriends&&t.mFriends.length<=1?t.addLayer1():t.addLayer2()}else t.addLayer1()})},addChildItems:function(){this._mscale;var e=wr.getModel();this.registerWithTouchDispatcher();var t=new l.Sprite("smuser_title.png");t.setPosition(412,509),t.setTag(10),this.spMainFrame.addChild(t,2);var i=null;i=(e.curLevel,e.curLevel);var n=new l.LabelAtlas("00","num_yellow_18.png",18,30,"./0123456789");n.setString(i),n.setPosition(432,492),n.setTag(11),this.spMainFrame.addChild(n,2)},loadResources:function(){var e=wr.getModel().usersData.m_nLanguage,t=String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",e,e);qu.addRes(this,t),qu.addRes(this,"res/Themes/LevelSelect/LevelSel02-hd.plist"),qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",e))},changeStoneCount:function(){},onExit:function(){qu.clearOwner(this),this.removeAllChildren(),this.listener&&l.eventManager.removeListener(this.listener),this._super()},addLayer1:function(){this._mscale;var e=nr.share().getWinSize(),t=wr.getModel().usersData;this.mLayer1=new l.Layer,this.addChild(this.mLayer1,2);var i=new l.Sprite("muser_contentbox.png");i.setPosition(e.width/2,e.height/2+142),this.mLayer1.addChild(i);var n="",s="",r=0,a=0;0==this.mFriends.length?(n=l.playerInfo.photo,s=l.playerInfo.name,r=t.getGoldCount(),a=t.getTaskHonorCount()):(n=this.mFriends[0].photo,s=this.mFriends[0].name,r=this.mFriends[0].gluobo,a=this.mFriends[0].zsj);var o=null,h=new l.Sprite("muser_avatar_s.png");h.setAnchorPoint(.5,.5),h.setPosition(h.width+19,i.height/2),i.addChild(h,2);o=Rt.createPhotoSprite();this.setUserHeadImg(n,o),o&&(o.setPosition(h.x+0,i.height/2),i.addChild(o,1));var d=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,c=GamePlatform.isCN()?d?"option_setting_from_qq.png":"option_setting_from_wechat.png":"suser_fromweibo.png",u=new l.Sprite(c);if(u.setAnchorPoint(0,0),u.setPosition(i.width-176,i.height/2-28),i.addChild(u),s&&s.length){s=Rt.cutString(s,18);var p=new l.LabelTTF(s,"Arial",20);p&&(p.setAnchorPoint(0,.5),p.setPosition(h.x+h.width-30,h.y),i.addChild(p))}var m=l.spriteFrameCache.getSpriteFrame("suser_cupbg.png"),_=new l.Sprite(m);_.setPosition(e.width/2-172,e.height/2-66),this.mLayer1.addChild(_);var g=new l.Sprite("stageinfo_cup_gold.png");g.setPosition(_.width/2,_.height/2+40),_.addChild(g);var T=new l.Sprite("suser_cup_gold.png");T.setPosition(_.width/2-56,_.height/2-90),_.addChild(T);var f=new l.Sprite("counterbg_s.png");f.setPosition(_.width/2+46,_.height/2-90),_.addChild(f);var S=String.formatC("%d",r),w=new l.LabelAtlas("00","num_white_18.png",18,30,"./0123456789");w.setString(S),r>99?w.setPosition(_.width/2+18,_.height/2-104):r>9?w.setPosition(_.width/2+28,_.height/2-104):w.setPosition(_.width/2+38,_.height/2-104),_.addChild(w);var v=new l.Sprite(m);v.setPosition(e.width/2+172,e.height/2-66),this.mLayer1.addChild(v);var L=new l.Sprite("stageinfo_cup_mission.png");L.setPosition(v.width/2,v.height/2+40),v.addChild(L);var M=new l.Sprite("suser_cup_mission.png");M.setPosition(v.width/2-56,v.height/2-90),v.addChild(M);var C=new l.Sprite("counterbg_s.png");C.setPosition(v.width/2+48,v.height/2-90),v.addChild(C),S=String.formatC("%d",a),(w=new l.LabelAtlas("00","num_white_18.png",18,30,"./0123456789")).setString(S),a>99?w.setPosition(v.width/2+18,v.height/2-104):a>9?w.setPosition(v.width/2+28,v.height/2-104):w.setPosition(v.width/2+38,v.height/2-104),v.addChild(w),l.addTimePoint("friendHonorDlgopen_e"),l.printTimePoint("friendHonorDlgopen_s","friendHonorDlgopen_e")},addLayer2:function(){nr.share().isIPad(),this.mLayer2=new l.Layer,this.addChild(this.mLayer2,2);var e=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,t=GamePlatform.isCN()?e?"themeaward_share_qq.png":"themeaward_share_wechat.png":"themeaward_share.png",i=this.menuItemWithFile("muser_up_normal.png",Lr.MENUITEM_UP,l.p(nr.share().getMapOffset().width+811+70,372),"muser_up_pressed.png","muser_up_disable.png"),n=this.menuItemWithFile("muser_down_normal.png",Lr.MENUITEM_DOWN,l.p(nr.share().getMapOffset().width+811+70,222),"muser_down_pressed.png","muser_down_disable.png"),s=this.menuItemWithFile(t,Lr.MENU_WECHAT,l.p(nr.share().getMapOffset().width+83,230),t,t);wr.getModel().usersData.isShareWeChat()||GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook||(this._rewardSpr=new l.Sprite("themeaward_share_wechat_new.png"),this._rewardSpr.setAnchorPoint(1,.5),this._rewardSpr.setPosition(23,.5*s.height),s.addChild(this._rewardSpr));var r=new l.Menu(i,n,s);r.setPosition(0,0),r.setTag(Lr.MENU_LAYER),this.mLayer2.addChild(r,3),i.setEnabled(!1),this.m_nStart=0;var a=this.mFriends.length;a>4?a=4:n.setEnabled(!1);for(var o=0;o<a;o++){var h=new l.Sprite("muser_contentbox.png");h.setPosition(nr.share().getMapOffset().width+480,460-102*o),h.setTag(Lr.CONTENTBOX1+o),this.mLayer2.addChild(h);var d=this.mFriends[o];if(this.m_nStyle==vr.ALL){var c=new l.Sprite(0==o?"muser_rank1.png":"muser_rankbg.png");c.setPosition(-16,26),c.setAnchorPoint(0,0),h.addChild(c,1,Lr.RANK_1+o);var u=new l.LabelAtlas("00","muser_rank_num.png",12,20,"./0123456789");u.setString(String.formatC("%d",o+1)),u.setPosition(c.width/2.2,c.height/2-8),u.setTag(1),c.addChild(u)}var p=new l.Sprite("muser_avatar_s.png");p.setPosition(33,15),p.setAnchorPoint(0,0),h.addChild(p,2);var m=Rt.createPhotoSprite();this.setUserHeadImg(d.photo,m),m&&(m.setTag(Lr.HEAD1+o),h.addChild(m,1),m.setAnchorPoint(.5,.5),m.setPosition(p.x+.5*p.width,p.y+.5*p.height));var _=d.name?Rt.cutString(d.name,15):"",g=new l.LabelTTF(_,"Arial-BoldMT",20);g&&(g.setAnchorPoint(0,0),g.setPosition(p.x+p.width+10,p.y+18),g.setTag(Lr.USERNAME1+o),h.addChild(g));var T=parseInt(d.platid),f=new l.Sprite(0==T?"icon_ios.png":"icon_android.png");f.visible=2!=T,f.setAnchorPoint(.5,.5),f.setPosition(90,30),h.addChild(f,10,101);var S=l.spriteFrameCache.getSpriteFrame("contentbox_dotline.png"),w=new l.Sprite(S);w.setAnchorPoint(0,0),w.setPosition(380,0),h.addChild(w);var v=new l.Sprite("muser_cup_gold.png");v.setPosition(406,18),v.setAnchorPoint(0,0),h.addChild(v);var L=new l.LabelAtlas("00","num_white_18.png",18,30,"./0123456789");L.setString(String.formatC("%d",d.gluobo)),d.gluobo>99?L.setPosition(465,35):L.setPosition(475,35),L.setAnchorPoint(0,0),L.setTag(Lr.GOLDCOUNT1+o),h.addChild(L);var M=new l.Sprite(S);M.setPosition(526,0),M.setAnchorPoint(0,0),h.addChild(M);var C=new l.Sprite("muser_cup_mission.png");C.setPosition(556,18),C.setAnchorPoint(0,0),h.addChild(C);var y=new l.LabelAtlas("00","num_white_18.png",18,30,"./0123456789");y.setString(String.formatC("%d",d.zsj)),y.setAnchorPoint(0,0),d.zsj>99?y.setPosition(616,35):y.setPosition(626,35),y.setTag(Lr.TASTFINISHCOUNT1+o),h.addChild(y)}l.addTimePoint("friendHonorDlgopen_e"),l.printTimePoint("friendHonorDlgopen_s","friendHonorDlgopen_e")},menuCallback:function(e){var t=e,i=wr.getModel();if(!i.showRewardLayer)switch(t.getTag()){case Lr.MENUITEM_UP:if(this.m_nStart-=4,this.m_nStart<=0&&(t.setEnabled(!1),this.m_nStart=0),s=this.mLayer2.getChildByTag(Lr.MENU_LAYER)){var n=s.getChildByTag(Lr.MENUITEM_DOWN);n&&!n.isEnabled()&&n.setEnabled(!0)}this.UpDataUserListView();break;case Lr.MENUITEM_DOWN:this.m_nStart+=4,this.m_nStart+4>this.mFriends.length-1&&(t.setEnabled(!1),this.m_nStart=this.mFriends.length-4);var s=this.mLayer2.getChildByTag(Lr.MENU_LAYER);if(s){var r=s.getChildByTag(Lr.MENUITEM_UP);r&&!r.isEnabled()&&r.setEnabled(!0)}this.UpDataUserListView();break;case Lr.MENU_LOGIN:this.isWait&&(l.director.getScheduler().isWaite=!1),i.playSoundWithType(Lr.MTMENUSELECT),i.bLockMenu=!1,this.setVisible(!1),this.getParent().removeChild(this,!0);break;case Lr.MENU_INVITE:this.setVisible(!1),this.getParent().removeChild(this,!0),this.isWait&&(l.director.getScheduler().isWaite=!1),i.playSoundWithType(Lr.MTMENUSELECT),i.bLockMenu=!1;break;case Lr.MENU_SHARE:this.sendShare(!1);var a=t.getParent();a&&a.setEnabled(!0);break;case Lr.MENU_WECHAT:this.sendShare(!1);break;case Lr.QUN_SHARE:this.sendShare(!0)}},sendShare:function(e){var t=this;if(GamePlatform.getCurrentPlatForm()==PlatformType.QQ)kl.shareScreenshot(Wl.REWARD_SHARE,function(e){console.log("shareScreenshot: "+e+"self._rewardSpr : "+t._rewardSpr),e&&(t._rewardSpr&&(t._rewardSpr.removeFromParent(),t._rewardSpr=null),t._qunrewardSpr&&(t._qunrewardSpr.removeFromParent(),t._qunrewardSpr=null))});else{var i=e?"":b.Share_Title9,n=e?b.Share_Qun:b.ShareText9;kl.shareMessage(i,n,Wl.REWARD_SHARE,0,12,null,function(e){e&&(t._rewardSpr&&(t._rewardSpr.removeFromParent(),t._rewardSpr=null),t._qunrewardSpr&&(t._qunrewardSpr.removeFromParent(),t._qunrewardSpr=null))})}},UpDataUserListView:function(){for(var e=this.m_nStart,t=0;t<4;t++,e++){var i=this.mLayer2.getChildByTag(Lr.CONTENTBOX1+t);if(void 0!=i){var n;if(n=this.mFriends[e],this.m_nStyle==vr.ALL)if(0==t){var s=i.getChildByTag(Lr.RANK_1);0==e?s.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("muser_rank1.png")):s.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("muser_rankbg.png"));r=s.getChildByTag(1);e<99&&e>0?(r.setVisible(!0),r.setString(String.formatC("%d",e+1)),e<9?r.setPosition(s.width/2.2,s.height/2-8):r.setPosition(s.width/2-10,s.height/2-8)):r.setVisible(!1)}else{var r=(s=i.getChildByTag(Lr.RANK_1+t)).getChildByTag(1);e<99?(r.setVisible(!0),r.setString(String.formatC("%d",e+1)),e<9?r.setPosition(s.width/2.2,s.height/2-8):r.setPosition(s.width/2-10,s.height/2-8)):r.setVisible(!1)}var a=i.getChildByTag(Lr.HEAD1+t);if(a){this.setUserHeadImg(n.photo,a),a.setTag(Lr.HEAD1+t);var o=parseInt(n.platid),h=null,d=i.getChildByTag(Lr.USERNAME1+t);d&&d.setString(n.name?Rt.cutString(n.name,15):"")}var c=i.getChildByTag(101);c&&(2!=o&&(h=l.spriteFrameCache.getSpriteFrame(0==o?"icon_ios.png":"icon_android.png"))&&c.setSpriteFrame(h),c.visible=2!=o);var u=i.getChildByTag(Lr.GOLDCOUNT1+t);u&&u.setString(String.formatC("%d",n.gluobo)),n.gluobo>99?u.setPosition(465,35):u.setPosition(475,35);var p=i.getChildByTag(Lr.TASTFINISHCOUNT1+t);p&&p.setString(String.formatC("%d",n.zsj)),n.zsj>99?p.setPosition(616,35):p.setPosition(626,35)}}},shotCurScreen:function(){l.log("shot cur screen");var e=nr.share().getWinSize(),t=new l.RenderTexture(e.width,e.height),i=this.getParent();if(t&&i){t.begin();for(var n=0;n<i.getChildren().length;n++){var s=i.getChildren()[n];4!=s.getTag()&&15!=s.getTag()&&1e3!=s.getTag()&&1001!=s.getTag()&&61!=s.getTag()&&s.visit()}t.end(),t.cleanup(),t.setPosition(e.width/2,e.height/2);var r="game.jpg";t.saveToFile(r.toString())}},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e),a=null;a=null==n?new l.Sprite(e):new l.Sprite(n);var o=null;o=null==s?new l.Sprite(e):new l.Sprite(s);var h=new l.MenuItemSprite(r,a,o,this,this.menuCallback.bind(this));return h.setTag(t),h.setPosition(i),h},menuItemWithFile1:function(e,t,i,n,s){if(!(arguments.length<4)){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d}},onEnter:function(){this._super()},registerWithTouchDispatcher:function(){this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},setUserHeadImg:function(e,t){void 0!=t&&(Rt.loadUserPhoto(null,t),console.log("setUserHeadImg:"+e),e&&e.length&&Rt.loadUserPhoto(e,t))}});Mr.create=function(){return new Mr};var Cr={ITEM_BTNBUY:0,ITEM_BG:1,ITEM_CLOSE:2,ITEM_ICON:3,ITEM_DESP:4,ITEM_BEFORE:5,ITEM_AFTER:6,ITEM_DISCOUNT:7,ITEM_HOUR:8,ITEM_MINUTE:9,ITEM_SECOND:10,ITEM_TIMEBG:11},yr=Zs.extend({m_nTemp:0,m_nH:0,m_nM:0,m_nS:0,labelHour:null,labelMin:null,labelSec:null,ctor:function(){this._super(Ks.DT_NOTICE);var e=wr.getModel();this.m_nTemp=e.usersData.discountSelect},addChildItems:function(){this.spMainFrame.removeAllChildren();var e=wr.getModel(),t=nr.share().getMapOffset(),i=l.spriteFrameCache.getSpriteFrame("discount_bg.png");i&&(this.spMainFrame.setSpriteFrame(i),this.spMainFrame.setPosition(t.width+479,314));var n=e.usersData.GetDisCountTime();this.m_nH=n.h,this.m_nM=n.m,this.m_nS=n.s;var s=null;s=this.m_nH>0?l.spriteFrameCache.getSpriteFrame("discount_6fig.png"):l.spriteFrameCache.getSpriteFrame("discount_4fig.png");var r=new l.Sprite(s);r.setPosition(258,82),r.setTag(Cr.ITEM_TIMEBG),this.spMainFrame.addChild(r),this.m_nH>0?(this.labelHour=new l.LabelAtlas(String.formatC("%02lu",this.m_nH),"num_white_18.png",18,30,"./0123456789"),this.labelHour.setPosition(193,66),this.spMainFrame.addChild(this.labelHour),this.labelMin=new l.LabelAtlas(String.formatC("%02lu",this.m_nM),"num_white_18.png",18,30,"./0123456789"),this.labelMin.setPosition(240,66),this.spMainFrame.addChild(this.labelMin),this.labelSec=new l.LabelAtlas(String.formatC("%02lu",this.m_nS),"num_white_18.png",18,30,"./0123456789"),this.labelSec.setPosition(287,66),this.spMainFrame.addChild(this.labelSec)):(this.labelMin=new l.LabelAtlas(String.formatC("%02lu",this.m_nM),"num_white_18.png",18,30,"./0123456789"),this.labelMin.setPosition(215,66),this.spMainFrame.addChild(this.labelMin),this.labelSec=new l.LabelAtlas(String.formatC("%02lu",this.m_nS),"num_white_18.png",18,30,"./0123456789"),this.labelSec.setPosition(268,66),this.spMainFrame.addChild(this.labelSec)),this.ShowItem(e.usersData.discountSelect);var a=new l.Sprite("discount_maintitle.png");a.setPosition(257,160),this.spMainFrame.addChild(a),this.schedule(this.TimeUpdate,1);var o=this.spMainFrame.getBoundingBox(),h=null,d=new l.Sprite("popup_close_frame.png");d.setPosition(743,448),this.spMainFrame.addChild(d,99),h=this.menuItemWithFile("popup_close.png",Cr.ITEM_CLOSE,l.p(.929*o.width,.898*o.height),null);var c=this.menuItemWithFile("btn_green_m.png",Cr.ITEM_BTNBUY,l.p(.7*o.width,.32*o.height),"btn_green_m_pressed.png","discount_buy.png"),u=new l.Menu(c,h);u.setPosition(0,0),u.setTag(999),this.spMainFrame.addChild(u,99)},loadResources:function(){qu.addRes(this,"res/Themes/LevelSelect/discount-hd.plist");var e=wr.getModel().usersData.m_nLanguage,t=String.formatC("res/Themes%s/LevelSelect/discount-hd%s.plist",e.toString(),e.toString());qu.addRes(this,t)},onExit:function(){var e=wr.getModel();qu.clearOwner(this),this.removeAllChildren(),this.listener&&l.eventManager.removeListener(this.listener),e.selLayer&&e.selLayer.schedule(function(){e.selLayer.DisCountTimeUpdate()}),this._super()},changeStoneCount:function(){},ShowItem:function(e){var t=wr.getModel(),i=null,n=null,s=null,r=null,a=null;switch(e){case le.SALE_FIGUREGIRL_10:i=l.spriteFrameCache.getSpriteFrame("discount_girl.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_girl.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_18.png"),r=l.spriteFrameCache.getSpriteFrame((t.isDiscount(),"discount_after_12.png")),a=l.spriteFrameCache.getSpriteFrame((t.isDiscount(),"discount_tip_7zhe.png"));break;case le.SALE_FIGUREFAT_15:i=l.spriteFrameCache.getSpriteFrame("discount_fat.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_fat.png"),s=l.spriteFrameCache.getSpriteFrame("discount_after_18.png"),r=l.spriteFrameCache.getSpriteFrame((t.isDiscount(),"discount_before_30.png")),a=l.spriteFrameCache.getSpriteFrame((t.isDiscount(),"discount_tip_6zhe.png"));break;case le.SALE_FIGUREOLD_15:i=l.spriteFrameCache.getSpriteFrame("discount_old.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_old.png"),s=l.spriteFrameCache.getSpriteFrame("discount_after_18.png"),r=l.spriteFrameCache.getSpriteFrame((t.isDiscount(),"discount_before_30.png")),a=l.spriteFrameCache.getSpriteFrame((t.isDiscount(),"discount_tip_6zhe.png"));break;case le.SALE_STONE_750_15:i=l.spriteFrameCache.getSpriteFrame("discount_stone.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_stone750.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_60.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_48.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_8zhe.png");break;case le.SALE_STONE_480_10:i=l.spriteFrameCache.getSpriteFrame("discount_stone.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_stone480.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_30.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_24.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_8zhe.png");break;case le.SALE_STONE_300_6:i=l.spriteFrameCache.getSpriteFrame("discount_stone.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_stone300.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_8.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_6.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_7zhe.png");break;case le.SALE_STONE_150_4:i=l.spriteFrameCache.getSpriteFrame("discount_stone.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_stone150.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_5.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_4.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_9zhe.png");break;case le.SALE_STONE_100_2:i=l.spriteFrameCache.getSpriteFrame("discount_stone.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_stone100.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_3.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_2.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_6zhe.png");break;case le.SALE_BOMB_4_2:i=l.spriteFrameCache.getSpriteFrame("discount_bomb.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_bomb.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_4.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_2.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_5zhe.png");break;case le.SALE_BLOOD_4_2:i=l.spriteFrameCache.getSpriteFrame("discount_blood.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_blood.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_4.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_2.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_5zhe.png");break;case le.SALE_SPEED_10_2:i=l.spriteFrameCache.getSpriteFrame("discount_speed.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_speed.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_3.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_2.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_6zhe.png");break;case le.SALE_ICE_6_2:i=l.spriteFrameCache.getSpriteFrame("discount_ice.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_ice.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_4.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_2.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_5zhe.png");break;case le.SALE_SLOW_6_2:i=l.spriteFrameCache.getSpriteFrame("discount_slow.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_slow.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_4.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_2.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_5zhe.png");break;case le.SALE_STAR_25_4:i=l.spriteFrameCache.getSpriteFrame("discount_star.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_star.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_5.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_4.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_8zhe.png");break;case le.SALE_THEME_4_6:i=l.spriteFrameCache.getSpriteFrame("discount_theme4.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_theme4.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_3.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_1.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_7zhe.png");break;case le.SALE_THEME_5_4:i=l.spriteFrameCache.getSpriteFrame("discount_theme5.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_theme5.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_3.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_1.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_7zhe.png");break;case le.SALE_THEME_6_6:i=l.spriteFrameCache.getSpriteFrame("discount_theme6.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_theme6.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_3.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_1.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_7zhe.png");break;case le.SALE_PACKAGEPLATINUM_6:i=l.spriteFrameCache.getSpriteFrame("discount_pack.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_pack.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_8.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_6.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_7zhe.png");break;case le.SALE_LIFE_FOREVER_12:i=l.spriteFrameCache.getSpriteFrame("discount_starunlimited.png"),n=l.spriteFrameCache.getSpriteFrame("discount_desp_starunlimited.png"),s=l.spriteFrameCache.getSpriteFrame("discount_before_30.png"),r=l.spriteFrameCache.getSpriteFrame("discount_after_24.png"),a=l.spriteFrameCache.getSpriteFrame("discount_tip_8zhe.png")}if(i){var o=this.spMainFrame.getChildByTag(Cr.ITEM_ICON);o?o.setSpriteFrame(i):((o=new l.Sprite(i)).setPosition(258,286),o.setTag(Cr.ITEM_ICON),this.spMainFrame.addChild(o))}if(n){var h=this.spMainFrame.getChildByTag(Cr.ITEM_DESP);h?h.setSpriteFrame(n):((h=new l.Sprite(n)).setPosition(555,356),h.setTag(Cr.ITEM_DESP),this.spMainFrame.addChild(h))}if(s){var d=this.spMainFrame.getChildByTag(Cr.ITEM_BEFORE);d?d.setSpriteFrame(s):((d=new l.Sprite(s)).setPosition(555,217),d.setTag(Cr.ITEM_BEFORE),this.spMainFrame.addChild(d))}if(r){var c=this.spMainFrame.getChildByTag(Cr.ITEM_AFTER);c?c.setSpriteFrame(r):((c=new l.Sprite(r)).setPosition(555,278),c.setTag(Cr.ITEM_AFTER),this.spMainFrame.addChild(c))}if(a){var u=this.spMainFrame.getChildByTag(Cr.ITEM_DISCOUNT);if(u)u.setSpriteFrame(a);else{var p=new l.Sprite("discount_tipbg.png");p.setPosition(348,381),this.spMainFrame.addChild(p),(u=new l.Sprite(a)).setPosition(348,381),u.setTag(Cr.ITEM_DISCOUNT),this.spMainFrame.addChild(u)}}},TimeUpdate:function(e){var t=wr.getModel(),i=t.usersData,n=i.GetDisCountTime();if(this.m_nH=n.h,this.m_nM=n.m,this.m_nS=n.s,n.result){if(this.m_nTemp!=i.discountSelect)if(this.m_nTemp=i.discountSelect,this.m_nH>0)(s=this.spMainFrame.getChildByTag(Cr.ITEM_TIMEBG))&&s.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("discount_6fig.png")),this.labelHour?this.labelHour.setVisible(!0):(this.labelHour=new l.LabelAtlas(String.formatC("%02lu",this.m_nH),"num_white_18.png",18,30,"./0123456789"),this.labelHour.setPosition(193,66),this.spMainFrame.addChild(this.labelHour)),this.labelMin.setPosition(240,66),this.labelSec.setPosition(287,66);else{var s=this.spMainFrame.getChildByTag(Cr.ITEM_TIMEBG);s&&s.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("discount_4fig.png")),this.labelHour&&this.labelHour.setVisible(!1),this.labelMin.setPosition(215,66),this.labelSec.setPosition(268,66)}null!=this.labelHour&&this.labelHour.setString(String.formatC("%02lu",this.m_nH)),this.labelMin.setString(String.formatC("%02lu",this.m_nM)),this.labelSec.setString(String.formatC("%02lu",this.m_nS))}else t.usersData.GetDisCountSale(),this.ShowItem(i.discountSelect),t.selLayer.ShowDiscountMenu()},OnDiscountBuy:function(){var e=wr.getModel(),t=Ss.create(this);switch(this.addChild(t,2e3,2e3),e.usersData.discountSelect){case le.SALE_FIGUREGIRL_10:t.buyProduct(oe.PCUT_GIRLCARROT);break;case le.SALE_FIGUREFAT_15:t.buyProduct(oe.PCUT_FATCARROT);break;case le.SALE_FIGUREOLD_15:t.buyProduct(oe.PCUT_OLDCARROT);break;case le.SALE_STONE_750_15:t.buyProduct(oe.PCUT_DIAMOND750);break;case le.SALE_STONE_480_10:t.buyProduct(oe.PCUT_DIAMOND480);break;case le.SALE_STONE_300_6:case le.SALE_STONE_150_4:case le.SALE_STONE_100_2:case le.SALE_BOMB_4_2:case le.SALE_BLOOD_4_2:case le.SALE_SPEED_10_2:case le.SALE_ICE_6_2:case le.SALE_SLOW_6_2:break;case le.SALE_PACKAGEPLATINUM_6:t.buyProduct(oe.PCUT_BIGPACKAGE);break;case le.SALE_STAR_25_4:break;case le.SALE_THEME_4_6:t.buyProduct(oe.PCUT_UNLOCK_SKY);break;case le.SALE_THEME_5_4:break;case le.SALE_THEME_6_6:t.buyProduct(oe.PCUT_UNLOCK_GLACIER);break;case le.SALE_LIFE_FOREVER_12:t.buyProduct(oe.LIFE_FOREVER_PCUT)}},registerWithTouchDispatcher:function(){this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(r.width/2,r.height/2),r.addChild(a)}var o=null;if(o=null===n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(r.width/2,r.height/2),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){nr.share().isIPad();var t=wr.getModel();if(!t.bNoStoneDlgOpen)switch(e.getTag()){case Cr.ITEM_BTNBUY:t.playSoundWithType($.MTPBUYITEM),this.OnDiscountBuy();break;case Cr.ITEM_CLOSE:if((t=wr.getModel()).bNoStoneDlgOpen)return;if(this.isBusy)return;this.setVisible(!1),this.getParent().removeChild(this,!0),this.isWait&&(l.director.getScheduler().isWaite=!1),t.playSoundWithType($.MTMENUSELECT),t.bLockMenu=!1}}});yr.create=function(){return new yr};var Br={CLOSE:111,UNLOCK:112,UNLOCK_FORPAY:113},Fr=Zs.extend({mCurLevel:0,ThirdGH:0,ThirdGM:0,ThirdGS:0,lable_third_Hour:null,lable_third_Second:null,lable_third_Minute:null,Lable_Stone:null,spStoneShop:null,listener:null,showEnter:!1,_Customlistener:null,ctor:function(){this._super(Ks.DT_TITLE)},menuCallback:function(e){var t=e,i=wr.getModel();if(!i.showRewardLayer)if(i.playSoundWithType($.MTMENUSELECT),t.getTag()==Br.CLOSE)this.getParent().removeChild(this,!0),i.bLockMenu=!1;else if(t.getTag()==Br.UNLOCK){if((136==this.mCurLevel||156==this.mCurLevel)&&!i.usersData.isCarrotBuy(ue.CARROT_GIRL)){var n=this.getParent();return l.addTimePoint("shopopen_s"),qu.loadResAsync(ri,function(){var e=fo.create(3);n.addChild(e,100)}),void this.removeFromParent()}if(this.showEnter)return this.removeFromParent(),this.entranceTemple(),void(this.showEnter=!1);if(101==this.mCurLevel)return this.setVisible(!1),this.shareUnlockTheme(Me.buySeventh),(h=t.getParent())&&h.setEnabled(!0),i.bLockMenu=!1,void this.removeFromParent();var s=this.getThemeByLevel(this.mCurLevel);if(0==s)return;var r=i.getBuyThemePrice(s);if(i.usersData.getDiamond()<r){a=this;return void(i.usersData.enablepay?qu.loadResAsync(Wi,function(){var e=aa.create();a.addChild(e,100,998),e.setParent(a),e.setShowDescription1($r)}):ju.showLiteralsTip(b.Dialog_Hint))}if(dp){t.setEnabled(!1);var a=this;Ql.buytheme(s,function(e){i.usersData.setDiamond(e.dm),i.usersData.setOpenLevel(e.openedlevel),a.buyOver(e.themeid)},function(){t.setEnabled(!0)})}else{var o=Ss.create(this);this.addChild(o,2e3,2e3),o&&(s=this.buyTheme(),o.buyProduct(s),o.setCurLevel(this.mCurLevel))}}else if(t.getTag()==Br.UNLOCK_FORPAY){this.setVisible(!1),this.shareUnlockTheme(Me.CarrotGla);var h=t.getParent();h&&h.setEnabled(!0),i.bLockMenu=!1,this.removeFromParent()}},getThemeByLevel:function(e){var t=0;switch(e=e||0){case 31:t=Me.CarrotGla;break;case 51:t=Me.CarrotSky;break;case 66:t=Me.CarrotDes;break;case 81:t=Me.BuyPolarRegion;break;case 116:t=Me.BuyIceland}return t},shareUnlockTheme:function(e){var t=this,i=kl.getThemeStr(e),n=kl.getThemeTitle(e);kl.shareMessage(n,i,Wl.THEME_SHARE,e,8,null,function(e,i){console.log("isSucceed:"+e+" themeid:"+i),i&&t.buyOver(i)})},buyTheme:function(){var e=oe.UNLOCK_SKY;switch(this.mCurLevel){case 31:e=oe.UNLOCK_THIRD;break;case 51:e=oe.UNLOCK_SKY;break;case 66:e=oe.UNLOCK_DESERT;break;case 81:e=oe.UNLOCK_GLACIER;break;case 116:e=oe.UNLOCK_ICELAND;break;case 136:e=oe.UNLOCK_TEMPLE;break;default:e=oe.UNLOCK_SKY}return e},buyOver:function(e){var t=wr.getModel();switch(e){case Me.CarrotGla:t.usersData.setNextPlayedLevel(),t.usersData.setCarrotTheme(Me.CarrotGla,!0);i=t.selLayer;t.setCurLevel(31),i.showLevelInfo(this.mCurLevel),this.removeFromParent();break;case Me.CarrotSky:t.usersData.setNextPlayedLevel(),t.usersData.setCarrotTheme(Me.CarrotSky);i=t.selLayer;t.setCurLevel(51),i.showLevelInfo(this.mCurLevel),this.removeFromParent();break;case Me.CarrotDes:t.usersData.setNextPlayedLevel(),t.usersData.setCarrotTheme(Me.CarrotDes);i=t.selLayer;t.setCurLevel(66),i.showLevelInfo(this.mCurLevel),this.removeFromParent();break;case Me.BuyPolarRegion:t.usersData.setNextPlayedLevel(),t.usersData.setCarrotTheme(Me.BuyPolarRegion);i=t.selLayer;t.setCurLevel(81),i.showLevelInfo(this.mCurLevel),this.removeFromParent();break;case Me.buySeventh:t.usersData.setNextPlayedLevel(),t.usersData.setCarrotTheme(Me.buySeventh);i=t.selLayer;t.setCurLevel(101),i.showLevelInfo(this.mCurLevel),this.removeFromParent();break;case Me.BuyIceland:t.usersData.setNextPlayedLevel(),t.usersData.setCarrotTheme(Me.BuyIceland);var i=t.selLayer;t.setCurLevel(116),i.showLevelInfo(this.mCurLevel),this.removeFromParent()}kl.shareCarrot(1,e)},entranceTemple:function(){var e=wr.getModel();e.bLockMenu=!1,e.usersData.getTempleOpenedLevel()<136&&e.usersData.setTempleOpenLevel(136);var t=e.usersData.getTempleOpenedLevel();e.setCurLevel(t),qi.preloadWithLoadingTag(qt,we.LEVELSELCIRCLE)},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this.removeAllChildren(),qu.clearOwner(this),this._super()},addChildItems:function(){var e=wr.getModel(),t=e.usersData.m_nLanguage;e.bLockMenu=!0,this.mCurLevel=e.curLevel,this.registerWithTouchDispatcher(),qu.addRes(this,"res/Themes/Items/Items03-hd.plist"),qu.addRes(this,String.formatC("res/Themes%s/scene/themelocked%s.plist",t,t)),qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",t,t)),qu.addRes(this,String.formatC("res/Themes%s/tencent/buy_items.plist",t)),qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",t)),qu.addRes(this,String.formatC("res/Themes%s/scene/modeunlock%s.plist",t,t));var i=.5;nr.share().isIPad()&&(i=1);var n=null;if(31!=this.mCurLevel)(n=new l.Sprite("themelocked_title.png")).setPosition(412*i,508*i),this.spMainFrame.addChild(n),(n=new l.Sprite("themelocked_sep.png")).setPosition(411*i,259*i),this.spMainFrame.addChild(n);else{var s=new l.Sprite("popup_close_frame.png");s.setPosition(743*i,418*i),this.spMainFrame.addChild(s,2)}var r=null;if(31==this.mCurLevel){var a=l.spriteFrameCache.getSpriteFrame("woodbg_notice.png");this.spMainFrame.setSpriteFrame(a);var o=e.usersData.getThirdWaitHMS();this.ThirdGH=o.h,this.ThirdGM=o.m,this.ThirdGS=o.s,(n=new l.Sprite("themelocked_theme3_bg.png")).setPosition(402*i,350*i),this.spMainFrame.addChild(n),this.lable_third_Hour=new l.LabelAtlas(String.formatC("%02lu",this.ThirdGH),"num_white_18.png",18*i,30*i,"./0123456789"),this.lable_third_Hour.setAnchorPoint(0,0),this.lable_third_Hour.setPosition(376*i,295*i),GamePlatform.isCN()||this.lable_third_Hour.setPosition(479*i,280*i),this.lable_third_Hour.setScale(.8),this.spMainFrame.addChild(this.lable_third_Hour),this.lable_third_Minute=new l.LabelAtlas(String.formatC("%02lu",this.ThirdGM),"num_white_18.png",18*i,30*i,"./0123456789"),this.lable_third_Minute.setAnchorPoint(0,0),this.lable_third_Minute.setPosition(423*i,295*i),GamePlatform.isCN()||this.lable_third_Minute.setPosition(517*i,280*i),this.lable_third_Minute.setScale(.8),this.spMainFrame.addChild(this.lable_third_Minute),this.lable_third_Second=new l.LabelAtlas(String.formatC("%02lu",this.ThirdGS),"num_white_18.png",18*i,30*i,"./0123456789"),this.lable_third_Second.setAnchorPoint(0,0),this.lable_third_Second.setPosition(471*i,295*i),GamePlatform.isCN()||this.lable_third_Second.setPosition(558*i,280*i),this.lable_third_Second.setScale(.8),this.spMainFrame.addChild(this.lable_third_Second),this.schedule(this.UpdateThirdTime,1)}else if(51==this.mCurLevel)r=String.formatC("%lu",e.usersData.getGoldCount()),(n=new l.Sprite("themelocked_goldcup.png")).setPosition(229*i,269*i),this.spMainFrame.addChild(n),(h=new l.LabelAtlas("40","res/Themes/Items/num_white_24.png",24*i,40*i,"./0123456789")).setAnchorPoint(.5,.5),h.setPosition(175*i,208*i),this.spMainFrame.addChild(h),(h=new l.LabelAtlas("00","num_white_18.png",18*i,30*i,"./0123456789")).setString(r+" / 40"),h.setAnchorPoint(0,.5),h.setPosition(220*i,107*i),this.spMainFrame.addChild(h),(n=new l.Sprite("themelocked_buy.png")).setPosition(596*i,269*i),this.spMainFrame.addChild(n),(_=this.createPriceSpr(Me.CarrotSky)).setAnchorPoint(.5,.5),_.setPosition(.5*n.width,120),n.addChild(_);else if(66==this.mCurLevel)r=String.formatC("%lu",e.usersData.getTaskHonorCount()),(n=new l.Sprite("themelocked_desert_desp.png")).setPosition(229*i,269*i),this.spMainFrame.addChild(n),(h=new l.LabelAtlas("45","res/Themes/Items/num_white_24.png",24*i,40*i,"./0123456789")).setAnchorPoint(.5,.5),h.setPosition(190*i,208*i),this.spMainFrame.addChild(h),(h=new l.LabelAtlas("00","num_white_18.png",18*i,30*i,"./0123456789")).setString(r+" / 45"),h.setAnchorPoint(0,.5),h.setPosition(225*i,107*i),this.spMainFrame.addChild(h),(n=new l.Sprite("themelocked_desert_buy.png")).setPosition(596*i,269*i),this.spMainFrame.addChild(n),(_=this.createPriceSpr(Me.CarrotDes)).setAnchorPoint(.5,.5),_.setPosition(.5*n.width,120),n.addChild(_);else if(81==this.mCurLevel)r=String.formatC("%lu",e.usersData.getGoldCount()),(n=new l.Sprite("themelocked_iceworld_desp.png")).setPosition(229*i,269*i),this.spMainFrame.addChild(n),(h=new l.LabelAtlas("00","num_white_18.png",18*i,30*i,"./0123456789")).setString(r+" / 60"),h.setAnchorPoint(0,.5),h.setPosition(222*i,174*i),this.spMainFrame.addChild(h),r=String.formatC("%lu",e.usersData.getTaskHonorCount()),(h=new l.LabelAtlas("00","num_white_18.png",18*i,30*i,"./0123456789")).setString(r+" / 55"),h.setAnchorPoint(0,.5),h.setPosition(222*i,108*i),this.spMainFrame.addChild(h),(n=new l.Sprite("themelocked_iceworld_buy.png")).setPosition(596*i,269*i),this.spMainFrame.addChild(n),(_=this.createPriceSpr(Me.BuyPolarRegion)).setAnchorPoint(.5,.5),_.setPosition(.5*n.width,120),n.addChild(_);else if(101==this.mCurLevel){r=String.formatC("%lu",e.usersData.getGoldCount()),(n=new l.Sprite("themelocked_goldcup.png")).setPosition(229*i,269*i),this.spMainFrame.addChild(n),(h=new l.LabelAtlas("70","res/Themes/Items/num_white_24.png",24*i,40*i,"./0123456789")).setAnchorPoint(.5,.5),h.setPosition(175*i,208*i),this.spMainFrame.addChild(h),(h=new l.LabelAtlas("00","num_white_18.png",18*i,30*i,"./0123456789")).setString(r+" / 70 "),h.setAnchorPoint(0,.5),h.setPosition(220*i,107*i),this.spMainFrame.addChild(h);p=GamePlatform.getCurrentPlatForm()==PlatformType.QQ;m=GamePlatform.isCN()?p?"themelocked_floatingice_share_qq.png":"themelocked_floatingice_share_desp.png":"themelocked_tofacebook.png",(n=new l.Sprite(m)).setPosition(596*i,269*i),this.spMainFrame.addChild(n)}else if(116==this.mCurLevel){r=String.formatC("%lu",e.usersData.getGoldCount()),(n=new l.Sprite("themelocked_iceworld_desp.png")).setPosition(229*i,269*i),this.spMainFrame.addChild(n);var h=new l.LabelAtlas("00","num_white_18.png",18*i,30*i,"./0123456789");h.setString(r+" / 80"),h.setAnchorPoint(0,.5),h.setPosition(222*i,174*i),this.spMainFrame.addChild(h),r=String.formatC("%lu",e.usersData.getTaskHonorCount()),(h=new l.LabelAtlas("00","num_white_18.png",18*i,30*i,"./0123456789")).setString(r+" / 75"),h.setAnchorPoint(0,.5),h.setPosition(222*i,108*i),this.spMainFrame.addChild(h),(n=new l.Sprite("themelocked_iceland_buy.png")).setPosition(596*i,269*i),this.spMainFrame.addChild(n),(_=this.createPriceSpr(Me.BuyIceland)).setAnchorPoint(.5,.5),_.setPosition(.5*n.width,120),n.addChild(_)}var d=null,c=null;if(31==this.mCurLevel){this.spMainFrame.removeChildByTag(119,!0);var u=this.menuItemWithFile1("popup_close.png",Br.CLOSE,l.p(743*i,420*i),null,null,1.1),p=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,m=GamePlatform.isCN()?p?"themelocked_theme3_share_qq.png":"themelocked_theme3_share_wechat.png":"themelocked_theme3_share.png";d=this.menuItemWithFile1("btn_blue_m.png",Br.UNLOCK_FORPAY,l.p(267*i,164*i),"btn_blue_m_pressed.png",m,null),c=this.menuItemWithFile1("btn_green_m.png",Br.UNLOCK,l.p(539*i,164*i),"btn_green_m_pressed.png",null);var _=this.createPriceSpr(Me.CarrotGla);return _.setAnchorPoint(.5,.5),_.setPosition(.5*c.width,.5*c.height),c.addChild(_),(g=new l.Menu(u,d,c)).setPosition(0,0),void this.spMainFrame.addChild(g,2,2)}if(101==this.mCurLevel){m=GamePlatform.getCurrentPlatForm()==PlatformType.QQ?"themelocked_share_qq.png":"themelocked_share_wechat.png";d=this.menuItemWithFile1("btn_green_m.png",Br.UNLOCK,l.p(595*i,109*i),"btn_green_m_pressed.png",m)}else d=116==this.mCurLevel?this.menuItemWithFile1("btn_green_m.png",Br.UNLOCK,l.p(595*i,109*i),"btn_green_m_pressed.png","themelocked_unlock.png"):this.menuItemWithFile1("btn_green_m.png",Br.UNLOCK,l.p(595*i,109*i),"btn_green_m_pressed.png","themelocked_unlock.png",null);var g=new l.Menu(d);g.setPosition(0,0),this.spMainFrame.addChild(g,2,2),this.addCustomListener()},createPriceSpr:function(e,t){var i=wr.getModel(),n=new l.Sprite("shop_gem.png");n.setAnchorPoint(0,.5);var s=n.getContentSize(),r=i.getBuyThemePrice(e),a=null;(a=e==Me.CarrotGla?new l.LabelAtlas(r,"themelocked_buy1.png",20,28,"./0123456789"):new l.LabelAtlas(r,"num_white_18.png",18,30,"./0123456789")).setAnchorPoint(0,.5),s.width+=a.width;var o=new l.Node;return o.setContentSize(s),n.setPosition(0,.5*s.height),a.setPosition(n.width+2,.5*s.height),o.addChild(n),o.addChild(a),o},loadResources:function(){},addCustomListener:function(){var e=this;this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this._Customlistener=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"diamondChange",callback:function(t){e.changeStoneCount()}}),l.eventManager.addListener(this._Customlistener,1)},changeStoneCount:function(){var e=wr.getModel().usersData.getDiamond();this.Lable_Stone&&this.Lable_Stone.setString(e)},setDescrip:function(e){var t=.5;nr.share().isIPad()&&(t=1);var i=wr.getModel();this.unschedule(this.UpdateThirdTime),this.spMainFrame.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("woodbg_title.png")),this.spMainFrame.removeAllChildren();var n=this.spMainFrame.getBoundingBox(),s=this.menuItemWithFile1("popup_close.png",Br.CLOSE,l.p(.937*n.width,.896*n.height)),r=this.menuItemWithFile1("btn_green_m.png",Br.UNLOCK,l.p(548*t,134*t),"btn_green_m_pressed.png","themelocked_unlock.png");if(s&&r){var a=new l.Menu(s,r);a.setPosition(0,0),a.setTag(2),this.spMainFrame.addChild(a)}var o=new l.Sprite("specialtheme_title.png");if(o.setPosition(415*t,508*t),this.spMainFrame.addChild(o),136==e){this.mCurLevel=136;var h=new l.Sprite("specialtheme_manor_bg.png");h.setPosition(410*t,275*t),this.spMainFrame.addChild(h);var d=null;(d=i.usersData.isCarrotBuy(ue.CARROT_GIRL)?new l.Sprite("themelocked_manor_n_yes.png"):new l.Sprite("themelocked_manor_n_no.png")).setPosition(578*t,275*t),this.spMainFrame.addChild(d)}if(156==e){this.mCurLevel=156;var c=new l.Sprite("specialtheme_meetaqo_bg.png");c.setPosition(l.p(410*t,275*t)),this.spMainFrame.addChild(c)}var u=this.spMainFrame.getChildByTag(2);if(u&&(r=u.getChildByTag(Br.UNLOCK))){r.setPosition(548*t,134*t);var p=r.getNormalImage(),m=r.getSelectedImage();if(p&&m){var _=p.getChildByTag(1),g=m.getChildByTag(1),T=null;i.usersData.isCarrotBuy(ue.CARROT_GIRL)&&(this.showEnter=!0,(T=l.spriteFrameCache.getSpriteFrame("themelocked_manor_n_enter.png"))&&(_.setSpriteFrame(T),g.setSpriteFrame(T)))}}},registerWithTouchDispatcher:function(){this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile1:function(e,t,i,n,s,r){r=r||1;var a=new l.Sprite(e);if(null!=s){var o=new l.Sprite(s);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o,1,1)}var h=null;if((h=void 0==n?new l.Sprite(e):new l.Sprite(n)).setScale(1.2),null!==s){var d=new l.Sprite(s);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d,1,1)}var c=new l.MenuItemSprite(a,h,null,this,this.menuCallback.bind(this));return a.setAnchorPoint(.5,.5),a.setPosition(.5*c.width,.5*c.height),h.setAnchorPoint(.5,.5),h.setPosition(.5*c.width,.5*c.height),c.setTag(t),c.setPosition(i),c},UpdateThirdTime:function(e){if(0==this.ThirdGH&&0==this.ThirdGM&&0==this.ThirdGS){var t=wr.getModel();return t.usersData.setCarrotTheme(Me.CarrotGla),this.setVisible(!1),this.getParent().showLevelInfo(this.mCurLevel),this.getParent().removeChild(this,!0),void(t.bLockMenu=!1)}0==this.ThirdGS?(this.ThirdGS=59,0==this.ThirdGM?(this.ThirdGM=59,this.ThirdGH--):this.ThirdGM--):this.ThirdGS--,this.UpdateThirdWiatTime()},UpdateThirdWiatTime:function(){var e=String.formatC("%02lu",this.ThirdGH);this.lable_third_Hour.setString(e);var t=String.formatC("%02lu",this.ThirdGM);this.lable_third_Minute.setString(t);var i=String.formatC("%02lu",this.ThirdGS);this.lable_third_Second.setString(i)},shotCurScreen:function(){l.log("shot cur screen");var e=nr.share().getWinSize(),t=new l.RenderTexture(e.width,e.height),i=this.getParent();if(t&&i){t.begin();for(var n=0;n<i.getChildren().length;n++){var s=i.getChildren()[n];4!=s.getTag()&&15!=s.getTag()&&1e3!=s.getTag()&&1001!=s.getTag()&&61!=s.getTag()&&s.visit()}t.end(),t.cleanup(),t.setPosition(e.width/2,e.height/2);t.saveToFile("".toString())}},showStoneShop:function(){var e=this.spMainFrame.getPosition(),t=l.moveTo(.1,e.x,e.y+30),i=l.moveTo(.2,e.x,e.y+670);this.spMainFrame.runAction(l.sequence(t,i));var n=l.moveTo(.2,0,-30),s=l.moveTo(.1,0,0),r=l.callFunc(function(){this.spStoneShop.showPrice()}.bind(this,this.spStoneShop));this.spStoneShop.runAction(l.sequence(n,s,r))}});Fr.create=function(){return new Fr};var Er=132,Pr=Zs.extend({listener:null,isSelect:!1,selectBtn:null,shareCallBack:null,_type:0,ctor:function(e){this._type=e||Wl.REWARD_SHARE,this._super(Ks.DT_NOTICENOCLOSE)},onExit:function(){this.registerWithTouchDispatcher(!1),this._super()},addChildItems:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=162*e,i=this.spMainFrame,n=l.p(.5*i.width+5,.5*i.height+25),s=this.menuItemWithFile("btn_blue_m.png","btn_blue_m_pressed.png",sa,l.p(540*e,t),"fenxiang_2.png"),r=this.menuItemWithFile("btn_green_m.png","btn_green_m_pressed.png",ra,l.p(267*e,t),"btn_green_m_cancel.png");this.selectBtn=this.menuItemWithFile("fenxiang_3.png","",Er,n);var a=this.selectBtn.getNormalImage();a&&(this.isSelect=!1,a.setVisible(!1)),(a=new l.Sprite("fenxiang_1.png")).setAnchorPoint(.5,1),a.setPosition(.5*i.width,i.height-150),this.spMainFrame.addChild(a);var o=new l.Menu(s,r,this.selectBtn);o.setPosition(0,0),this.spMainFrame.addChild(o,99);var h=new l.Sprite("sepline.png");h.setPosition(.5*i.width*e,t+70*e),h.setScaleX(.95),this.spMainFrame.addChild(h),this.registerWithTouchDispatcher(!0)},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e),a=new l.Sprite(t);if(r.setTag(1),a.setTag(2),i==Er&&(r.width=150),s){var o=new l.Sprite(s);o.setAnchorPoint(.5,.5),o.setPosition(.5*r.width,.5*r.height),r.addChild(o),(o=new l.Sprite(s)).setAnchorPoint(.5,.5),o.setPosition(.5*a.width,.5*a.height),a.addChild(o)}var h=new l.MenuItemSprite(r,a,null,this,this.menuCallback.bind(this));return h.setTag(i),h.setPosition(n),h},menuCallback:function(e){var t=e.tag,i=wr.getModel();if(!i.showRewardLayer)if(t==Er){var n=this.selectBtn.getNormalImage();n&&(this.isSelect=!this.isSelect,n.setVisible(this.isSelect))}else{if(t==sa){i.usersData.isShareQun=this.isSelect;var s=this,r=5==this._type?i.usersData.getOpenedLevel():0;kl.shareMessage(null,"",this._type,r,1,null,function(){s.shareCallBack&&s.shareCallBack()})}this.removeFromParent()}},registerWithTouchDispatcher:function(e){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0}.bind(this)}),l.eventManager.addListener(this.listener,this))}});Pr.create=function(e){return new Pr(e)};var br=0,Ar=1,Or=2,Ir=3,Rr=4,Dr=5,xr=6,Nr=7,Gr=8,Wr={};Wr.PARENT_SHOP=br,Wr.PARENT_STONETOPROP=Ar,Wr.PARENT_LIFREQUEST=Or,Wr.PARENT_ROULETTE=Ir,Wr.PARENT_RADISH=Rr,Wr.PRAENT_GAMEHUD=Dr,Wr.PRAENT_MAIN=xr,Wr.PRAENT_GAMEMENU=Nr,Wr.NOSTONEDLG_TAG_PUSHSTAR=Gr;var kr=0,Ur=1,Hr=0,Vr=1,zr=2,Yr=3,Xr=4,jr=5,Kr=6,qr=7,Qr=8,Zr=9,Jr=10,$r=11,ea=12,ta=13,ia=14,na={};na.STONE_299=Hr,na.STONE_400=Vr,na.STONE_699=zr,na.STONE_800=Yr,na.STONE_1800=Xr,na.STONE_2800=jr,na.STONE_50=Kr,na.STONE_GIFTBALL=qr,na.STONE_NOSTONE=Qr,na.STONE_UNLOCK_HIGHER=Zr,na.STONE_99=Jr;var sa=1e3,ra=1001,aa=Zs.extend({spBtnOK:null,spBtnCancel:null,pParentLayer:null,nStyleParent:0,nStyleStone:0,propStyle:0,m_priceUpup:"",m_priceNor:"",m_priceDiscount:"",m_priceGoldenPack:"",m_pricePlatinumPack:"",m_priceGemsValue:"",listener:null,callback:null,_price:0,ctor:function(){this._super(Ks.DT_NOTICE)},addChildItems:function(){wr.getModel().bNoStoneDlgOpen=!0,this.spMainFrame.removeAllChildrenWithCleanup(!0);var e=this.spMainFrame.getBoundingBox(),t=this.menuItemWithFile("btn_blue_m.png",sa,l.p(.33*e.width,.31*e.height),"btn_blue_m_pressed.png","btn_blue_m_ok.png"),i=this.menuItemWithFile("btn_green_m.png",ra,l.p(.67*e.width,.31*e.height),"btn_green_m_pressed.png","btn_green_m_cancel.png"),n=new l.Menu(t,i);n.setPosition(0,0),this.spMainFrame.addChild(n,99,199),this.registerWithTouchDispatcher()},onEnterTransitionDidFinish:function(){if(this._super(),this.getParent()){var e=this.getParent().getChildByTag(888888);null==e&&(e=Ss.create(this.getParent()),this.getParent().addChild(e,888888,888888))}},loadResources:function(){var e=wr.getModel().usersData.m_nLanguage;qu.addRes(this,"res/Themes/Items/NewProp-hd.plist"),qu.addRes(this,String.formatC("res/Themes%s/tencent/buy_items.plist",e))},changeStoneCount:function(){},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener);var e=wr.getModel();e.bNoStoneDlgOpen=!1,e.bLockMenu=!1,this.nStyleParent==br&&(this.pParentLayer.bLockPopUp=!1),this.removeAllChildrenWithCleanup(!0),qu.clearOwner(this),this._super()},registerWithTouchDispatcher:function(){l.director;this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){var t=e,i=wr.getModel(),n=this;switch(t.getTag()){case sa:if(this.setVisible(!1),this.nStyleStone==Zr){if(i.usersData.getDiamond()<1e3)return void(i.usersData.enablepay?(n.pParentLayer.removeChild(n,!0),qu.loadResAsync(Wi,function(){var e=aa.create(),t=l.director.getRunningScene();t.addChild(e,100,998),e.setParent(t,br),e.setShowDescription1(ea)})):(ju.showLiteralsTip(b.Dialog_Hint),this.pParentLayer.removeChild(this,!0)));ju.showConfirm(b.Dialog_Hint9,function(e){dp&&e==sa&&Ql.unlockdaydayup(function(e){i.usersData.setDiamond(e.dm),i.usersData.mIsUnlockedDayDayUp=e.issuccess,i.usersData.setCarrotTheme(oe.UNLOCK_HIGHER,!0),i.mainLayer.removeChild(this.spMainFrame),i.bLockMenu=!1,qi.preloadWithStoreyScene(we.STOREY,!1)})})}else if(lp){var s={num:this._price};SDKInterface.pay(s,function(e,t){GamePlatform.getCurrentPlatForm()!=PlatformType.QQ&&(t=0==e?"支付成功":"支付失败"),ju.showLiteralsTip(t),0==e?dp&&Ql.getbalance(function(e){e.dm&&i.usersData.setDiamond(e.dm),n.callback&&n.callback(!0)}):n.callback&&n.callback(!1)})}this.pParentLayer.removeChild(this,!0);break;case ra:this.setVisible(!1),i.playSoundWithType($.MTMENUSELECT),this.nStyleStone==Zr&&(i.bLockMenu=!1),this.isWait&&(l.director.getScheduler().isWaite=!1),this.callback&&this.callback(!1),this.pParentLayer.removeChild(this,!0)}},sendCode:function(){},setParent:function(e,t){this.pParentLayer=e,this.nStyleParent=t},setShowDescription:function(e,t){this.nStyleStone=e,this.propStyle=t;var i=.5;nr.share().isIPad()&&(i=1);var n=wr.getModel();switch(e){case qr:this.spMainFrame.removeChildByTag(199,!0);var s=this.spMainFrame.getBoundingBox(),r=this.menuItemWithFile("btn_blue_m.png",sa,l.p(.33*s.width,.31*s.height),"btn_blue_m_pressed.png","floor_btn_get.png"),a=this.menuItemWithFile("btn_green_m.png",ra,l.p(.67*s.width,.31*s.height),"btn_green_m_pressed.png","btn_green_m_cancel.png");(o=new l.Menu(r,a,null)).setPosition(0,0),this.spMainFrame.addChild(o,99,199),(h=new l.Sprite("floor_gift_buy.png")).setPosition(401*i,348*i),this.spMainFrame.addChild(h,2),this._price=100;break;case Jr:this.spMainFrame.removeChildByTag(199,!0),(h=new l.Sprite("#nostone_top.png")).setPosition(401*i,418*i),this.spMainFrame.addChild(h,2),(m=new l.Sprite("#nostone_text.png")).setPosition(398*i,272*i),this.spMainFrame.addChild(m,2),(p=new l.Sprite("#sepline_s.png")).setPosition(401*i,210*i),this.spMainFrame.addChild(p,2);var s=this.spMainFrame.getBoundingBox(),a=this.menuItemWithFile("btn_green_m.png",ra,l.p(.5*s.width,.31*s.height),"btn_green_m_pressed.png","btn_green_m_cancel.png"),o=new l.Menu(a,null);o.setPosition(0,0),this.spMainFrame.addChild(o,99,199);break;case Kr:(h=new l.Sprite("#nolife_1yuan.png")).setPosition(401*i,348*i),this.spMainFrame.addChild(h,2);break;case Hr:(h=new l.Sprite("#nostone_pack_buybg.png")).setPosition(401*i,348*i),this.spMainFrame.addChild(h,2);c=null;(c=new l.Sprite("#nostone_buy_6.png")).setAnchorPoint(0,0),c.setPosition(0,0),h.addChild(c);break;case Vr:var h=null;(h=new l.Sprite("nostone_buy_new.png")).setPosition(401*i,348*i),this.spMainFrame.addChild(h,2);break;case zr:(h=new l.Sprite("nostone_pack_buybg.png")).setPosition(401*i,348*i),this.spMainFrame.addChild(h,2);c=null;(c=new l.Sprite("#nostone_buy_8.png")).setAnchorPoint(0,0),c.setPosition(0,0),h.addChild(c);break;case Yr:(h=new l.Sprite("#nostone_carrot_buybg.png")).setPosition(401*i,348*i),this.spMainFrame.addChild(h,2),(c=new l.Sprite(n.isDiscount()?"nostone_buy_6.png":"nostone_buy_12.png")).setAnchorPoint(0,0),c.setPosition(0,0),h.addChild(c);var d=new l.Sprite("#shop_carrot_girl.png");d.setPosition(401*i,438*i),this.spMainFrame.addChild(d,2);break;case Xr:(h=new l.Sprite("#nostone_carrot_buybg.png")).setPosition(401*i,348*i),this.spMainFrame.addChild(h,2);var c=null;(c=new l.Sprite("#nostone_buy_18.png")).setAnchorPoint(0,0),c.setPosition(0,0),h.addChild(c),(u=new l.Sprite("#shop_carrot_fat.png")).setPosition(401*i,438*i),this.spMainFrame.addChild(u,2);break;case jr:(h=new l.Sprite("#nostone_carrot_buybg.png")).setPosition(401*i,348*i),this.spMainFrame.addChild(h,2),(c=new l.Sprite(n.isDiscount()?"nostone_buy_8.png":"nostone_buy_25.png")).setAnchorPoint(0,0),c.setPosition(0,0),h.addChild(c);var u=new l.Sprite("#shop_carrot_old.png");u.setPosition(401*i,438*i),this.spMainFrame.addChild(u,2);break;case Qr:(h=new l.Sprite("#nostone_top.png")).setPosition(401*i,418*i),this.spMainFrame.addChild(h,2),(m=new l.Sprite("#nostone_text.png")).setPosition(398*i,272*i),this.spMainFrame.addChild(m,2);var p=new l.Sprite("#sepline_s.png");p.setPosition(401*i,210*i),this.spMainFrame.addChild(p,2);break;case Zr:var m=new l.Sprite("unlock_floor_new.png");m.setPosition(401*i,348*i),this.spMainFrame.addChild(m,2);var _=new l.Sprite("shop_gem.png");_.setAnchorPoint(0,.5),_.setPosition(m.x-52,77);var g=new l.LabelAtlas(1e3,"num_white_18.png",18*i,30*i,"./0123456789");g.setAnchorPoint(0,.5),g.setPosition(_.x+_.width,78),m.addChild(_),m.addChild(g)}},setShowDescription1:function(e){var t=.5;nr.share().isIPad()&&(t=1);var i=1200;switch(e){case Vr:i=100;break;case ia:i=200;break;case Yr:i=800;break;case ea:i=1200;break;case $r:i=1500;break;case ta:i=2500}this._price=i;var n=new l.Sprite("nostone_buy_new.png");n.setPosition(401*t,348*t),this.spMainFrame.addChild(n,2);var s=new l.LabelAtlas(i,"num_white_18.png",18*t,30*t,"./0123456789");s.setScale(1.4),s.setAnchorPoint(.5,.5),s.setPosition(.67*n.width-1,128),n.addChild(s),i=parseInt(i/100),(s=new l.LabelTTF("￥"+i.toFixed(2),"Arial",22*t)).setAnchorPoint(.5,0),s.setColor(l.color(255,247,153)),s.setPosition(.5*n.width,64),n.addChild(s)}}),oa=Zs.extend({spBtnOK:null,pParentLayer:null,ctor:function(){this._super(Ks.DT_NOTICE)},addChildItems:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=new l.Sprite("#nostone_top.png");t.setPosition(401*e,418*e),this.spMainFrame.addChild(t,2);var i=new l.Sprite("#shop_buycarrot_text.png");i.setPosition(398*e,272*e),this.spMainFrame.addChild(i,2);var n=new l.Sprite("#sepline_s.png");n.setPosition(401*e,210*e),this.spMainFrame.addChild(n,2);var s=this.spMainFrame.getBoundingBox(),r=this.menuItemWithFile("btn_blue_m.png",sa,l.p(.33*s.width,.31*s.height),"btn_blue_m_pressed.png","shop_buycarrot_buy.png"),a=this.menuItemWithFile("btn_green_m.png",ra,l.p(.67*s.width,.31*s.height),"btn_green_m_pressed.png","btn_green_m_cancel.png"),o=new l.Menu(r,a);o.setPosition(0,0),this.spMainFrame.addChild(o,99)},loadResources:function(){},changeStoneCount:function(){},onExit:function(){wr.getModel().bNoStoneDlgOpen=!1,this.removeAllChildrenWithCleanup(!0),this.pParentLayer.bLockPopUp=!1,this._super()},registerWithTouchDispatcher:function(){var e=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)});l.eventManager.addListener(e,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){var t=e,i=wr.getModel();switch(i.playSoundWithType($.MTPAGESELECT),t.getTag()){case sa:this.setVisible(!1);var n=this;if(dp){var s=this.m_nStyle-ue.CARROT_NORMAL+1;Ql.buyCarrotByCarrotID(s,function(e){i.usersData.setDiamond(e.dm),n.pParentLayer.BuyCarrotUpdate(n.m_nStyle),n.removeFromParent()})}else n.pParentLayer.BuyCarrotUpdate(n.m_nStyle),n.removeFromParent();break;case ra:this.setVisible(!1),this.removeFromParent()}},setParent:function(e,t){this.pParentLayer=e,this.m_nStyle=t}}),ha=Zs.extend({spText:null,ctor:function(){this._super(Ks.DT_NOTICE)},addChildItems:function(){var e=.5;nr.share().isIPad()&&(e=1),this.registerWithTouchDispatcher();var t=new l.Sprite("#nostone_top.png");t.setPosition(401*e,418*e),this.spMainFrame.addChild(t,2),this.spText=new l.Sprite("#toweibo_getstone_rate.png"),this.spText.setPosition(398*e,272*e),this.spMainFrame.addChild(this.spText,2);var i=new l.Sprite("#sepline_s.png");i.setPosition(401*e,210*e),this.spMainFrame.addChild(i,2);var n=this.spMainFrame.getBoundingBox(),s=this.menuItemWithFile("btn_blue_m.png",sa,l.p(.5*n.width,.31*n.height),"btn_blue_m_pressed.png","btn_blue_m_ok.png"),r=new l.Menu(s,null);r.setPosition(0,0),this.spMainFrame.addChild(r,99)},loadResources:function(){},changeStoneCount:function(){},onExit:function(){this.removeAllChildrenWithCleanup(!0),this._super()},registerWithTouchDispatcher:function(){var e=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)});l.eventManager.addListener(e,this)},setTextStyle:function(e){var t=null;e==kr?(t=l.spriteFrameCache.getSpriteFrame("toweibo_getstone_weibo.png"))&&this.spText.setSpriteFrame(t):e==Ur&&(t=l.spriteFrameCache.getSpriteFrame("toweibo_getstone_rate.png"))&&this.spText.setSpriteFrame(t)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){switch(e.getTag()){case sa:this.setVisible(!1);var t=wr.getModel();t.playSoundWithType($.MTMENUSELECT),this.getParent().removeChild(this,!0),t.bLockMenu=!1}}}),la=Zs.extend({spBtnOK:null,pParentLayer:null,ctor:function(){this._super(Ks.DT_NOTICE)},addChildItems:function(){},setShowDescription:function(e){var t=.5;nr.share().isIPad()&&(t=1),this.registerWithTouchDispatcher();var i=null;(i=e==ue.CARROT_GIRL?new l.Sprite("#shop_carrot_girl.png"):new l.Sprite("#shop_carrot_fat.png")).setPosition(394*t,453*t),this.spMainFrame.addChild(i,2);var n=new l.Sprite("#nostone_carrot_ask.png");n.setPosition(402*t,250*t),this.spMainFrame.addChild(n,2);var s=this.spMainFrame.getBoundingBox(),r=this.menuItemWithFile("btn_blue_m.png",sa,l.p(.33*s.width,.31*s.height),"btn_blue_m_pressed.png",e==ue.CARROT_GIRL?"shop_btn_girl_stone.png":"shop_btn_fat_stone.png"),a=(wr.getModel(),this.menuItemWithFile("btn_green_m.png",ra,l.p(.67*s.width,.31*s.height),"btn_green_m_pressed.png",e==ue.CARROT_GIRL?"shop_btn_girl_buy.png":"shop_btn_fat_buy.png")),o=new l.Menu(r,a,null);o.setPosition(0,0),this.spMainFrame.addChild(o,99)},loadResources:function(){},changeStoneCount:function(){},onExit:function(){wr.getModel();this.pParentLayer.bLockPopUp=!1,this._super()},registerWithTouchDispatcher:function(){var e=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)});l.eventManager.addListener(e,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){var t=e,i=wr.getModel();switch(t.getTag()){case sa:this.setVisible(!1);var n=i.getCarrotPrice(this.m_nStyle);if(i.usersData.getDiamond()<n)this.pParentLayer.addNoStoneDlg(this.m_nStyle==ue.CARROT_GIRL?Yr:Xr,de.PROP_99);else{var s=oa.create();this.pParentLayer.addChild(s,100),s.setParent(this.pParentLayer,this.m_nStyle)}this.getParent().removeChild(this,!0);break;case ra:this.setVisible(!1),i.playSoundWithType($.MTPAGESELECT),i.goBuy(this.pParentLayer,this.m_nStyle==ue.CARROT_GIRL?oe.GIRLCARROT:oe.FATCARROT),this.getParent().removeChild(this,!0)}},setParent:function(e,t){this.pParentLayer=e,this.m_nStyle=t}});aa.create=function(){return new aa},oa.create=function(){return new oa},la.create=function(){return new la},ha.create=function(){return new ha};var da=98,ca=24,ua="SFNTTA==",pa="SEdhbWVTdGFy",ma="SFN0YXJUaW1l",_a="SFBD",ga="SENMSQ==",Ta="SExEQw==",fa="SExTJWQ=",Sa="SE1JJWQ=",wa="SE1DSSVk",va="SERNSSVk",La="SFRD",Ma="SFRUJWQ=",Ca="SFdD",ya="SENIUA==",Ba="SEJPJWQ=",Fa="SEJSJWQ=",Ea="SEJUJWQ=",Pa="SEdN",ba="SEZD",Aa=l.Class.extend({m_nLevelStyle:On,m_nMapIndex:0,m_nMapConfigIndex:0,m_nDownMapIndex:-1,ctor:function(e,t,i){e instanceof Aa?(this.m_nLevelStyle=e.m_nLevelStyle,this.m_nMapIndex=e.m_nMapIndex,this.m_nMapConfigIndex=e.m_nMapConfigIndex):(this.m_nLevelStyle=t||On,this.m_nMapIndex=e||0,this.m_nMapConfigIndex=i||0)},EraseConfig:function(){this.m_nLevelStyle<Rn&&(this.m_nMapConfigIndex=0),this.m_nDownMapIndex=-1},playCurLevel:function(e,t){this.m_nMapConfigIndex=e,this.m_nDownMapIndex=t},isPlayed:function(){return this.m_nMapConfigIndex<0},isPlaying:function(){return this.m_nMapConfigIndex>0},isUnPlayed:function(){return-1==this.m_nDownMapIndex},getMapIndex:function(){return this.m_nMapIndex},getDownMapIndex:function(){return this.m_nDownMapIndex},getConfigIndex:function(){return this.m_nMapConfigIndex-1},getLevelStyle:function(){return this.m_nLevelStyle},writeData:function(e){var t=String.formatC(Fd(fa),e);$l(this.m_nLevelStyle,t),t=String.formatC(Fd(Sa),e),$l(this.m_nMapIndex,t),t=String.formatC(Fd(wa),e),$l(this.m_nMapConfigIndex,t),t=String.formatC(Fd(va),e),$l(this.m_nDownMapIndex,t)},readData:function(e){var t=String.formatC(Fd(fa),e);this.m_nLevelStyle=parseInt(Zl(t,0)),t=String.formatC(Fd(Sa),e),this.m_nMapIndex=parseInt(Zl(t,0)),t=String.formatC(Fd(wa),e),this.m_nMapConfigIndex=parseInt(Zl(t,0)),t=String.formatC(Fd(va),e),this.m_nDownMapIndex=parseInt(Zl(t,0))},description:function(e){l.log(String.formatC("Index:%d,  Style:%d,  MapIndex:%d,  MapConfig:%d,  Down:%d",e,this.m_nLevelStyle,this.m_nMapIndex,this.m_nMapConfigIndex,this.m_nDownMapIndex))}}),Oa=l.Class.extend({m_nGiveCount:0,m_nGiveType:0,m_nPackageType:0,m_nDropMoney:0,m_nPassCount:0,m_nCurLevelIndex:0,m_pLevelsData:null,m_nSMapConfigs:null,m_nDMapConfigs:null,m_nHard:null,m_bGetHard:0,curMapLevel:null,mapData:null,hardPercent:0,allLevels:0,M:0,m_nTowerCount:0,m_nFailedCount:0,m_nSaveStoreyLevel:0,m_bProtected:0,m_nStars:0,gameWaitTime:0,m_nDropDiamond:0,m_strMapPath:0,_lastPassCount:0,_maxtier:0,ctor:function(){this.m_nSMapConfigs=[],this.m_nDMapConfigs=[],this.m_nHard=[],this.mapData=Gd.create()},HigherEnter:function(){wr.getModel().m_nGameMode=ge.HIGHERMODE;null==this.m_pLevelsData?(l.log("★★★ Higher-HigherEnter--this.m_pLevelsData == null--Init"),this.Init()):(l.log("★★★ Higher-HigherEnter-getCurMapLevel"),this.getCurMapLevel())},HigherExit:function(){wr.getModel().m_nGameMode=ge.NORMALMODE},isProtected:function(){return this.m_bProtected},isHalfBattle:function(){return this.m_nTowerCount>0},isAchievement:function(){return this.m_nPassCount>O.DAYDAYUPLEVELCOUNT||this.m_nPassCount>this._maxtier},getHardPer:function(){var e=[-.7,-.6,-.5,-.4,-.4,-.3,-.3,-.3,-.2,-.2],t=e.length,i=parseInt(this.m_nPassCount/10);return i>=t&&(i=t-1),this.m_bGetHard&&this.m_nHard.length>0?this.m_nHard[i]:e[i]},getDownLimite:function(){return this.m_nSaveStoreyLevel},setUseStars:function(e){this.higherCos=e},getUsedStar:function(){var e=5;if(dp)for(var t in this.higherCos){var i=this.higherCos[t];if(this.m_nPassCount<=i.maxtier){e=i.coststar;break}}else for(var n=[1,2,3,4,5],s=[20,50,70,90,99],t=0;t<e;t++)if(this.m_nPassCount<=s[t]){e=n[t];break}return e},getGiveCount:function(){return this.m_nGiveCount<0?-this.m_nGiveCount:this.m_nGiveCount},subGiveCountLeft:function(){return this.m_nGiveCount<0?0:--this.m_nGiveCount},getPassCount:function(){return this.m_nPassCount<1?1:this.m_nPassCount>150?150:this.m_nPassCount},getCurLevelMode:function(){return null==this.m_pLevelsData||this.m_pLevelsData.length<1?On:this.m_pLevelsData[this.m_nCurLevelIndex].getLevelStyle()},getGiveMagicType:function(){var e=wr.getModel();return void 0==this.m_nGiveType&&(this.m_nGiveType=fe.UNKNOWBB),this.m_nGiveType==fe.UNKNOWBB&&(e.bLoopPath?this.m_nGiveType=F()%fe.SHOOTBB+1:this.m_nGiveType=F()%fe.CLEARBB+1),this.m_nGiveType},getPackageType:function(){if(this.m_nPackageType==_e.UNKNOWPT)switch(this.m_pLevelsData[this.m_nCurLevelIndex].getLevelStyle()){case Rn:this.m_nPackageType=-(F()%_e.CUTALLMONSTERHP+1);break;case On:case In:case xn:case Dn:this.m_nPackageType=-(F()%_e.ADDCARROTHP+1)}return this.m_nPackageType<0?-this.m_nPackageType:this.m_nPackageType},getPackageCount:function(e){if(this.m_nPackageType!=e)return 0;switch(this.m_nPackageType){case _e.CUTCREEPHP:case _e.CUTBOSSHP:return.7;case _e.ADDPOWER:return.3;case _e.ADDGOLD:return 2e3;case _e.ADDCARROTHP:return 5;case _e.NODOWNLEVEL:return 1;case _e.CUTALLMONSTERHP:return.8}return 0},createMagicCount:function(){for(var e=[2,2,2,3,3,4,3,5],t=[20,40,60,99],i=t.length,n=0;n<i;n++)if(this.m_nPassCount<=t[n]){i=0==(i=e[2*n+1]-e[2*n])?e[2*n]:F()%i+e[2*n];break}this.m_nGiveCount=-i},getHalfBattlePath:function(){return this.m_strMapPath},resetPackage:function(){this.m_nPackageType=_e.UNKNOWPT,this.m_nGiveType=fe.UNKNOWBB,this.m_nGiveCount=0},pickupMagic:function(){this.m_nGiveCount<0&&(this.m_nGiveCount=-this.m_nGiveCount);var e,t=wr.getModel().gameLayer.gameHUD;switch(this.m_nGiveType){case fe.SLOWBB:e=pe.BOTTOM_BAR_SLOW;break;case fe.STOPBB:e=pe.BOTTOM_BAR_ICE;break;case fe.SHOOTBB:e=pe.BOTTOM_BAR_SPEED;break;case fe.ADDHPBB:e=pe.BOTTOM_BAR_BLOOD;break;case fe.CLEARBB:e=pe.BOTTOM_BAR_BOMB}this.m_nGiveCount>0&&t.UpdateBarItemCounter(this.m_nGiveCount,e,!0)},pickupPackage:function(){var e=wr.getModel(),t=e.usersData.getConsumePropPrice(1001);if(0!=t&&void 0!=t||(t=200),e.usersData.getDiamond()<t)return!1;this.m_nPackageType<_e.UNKNOWPT&&(this.m_nPackageType=-this.m_nPackageType);var i=this.getPackageCount(_e.ADDGOLD);i>0&&(e.changeMoney(i),e.gameLayer.gameHUD.changeMoney(e.getAllMoney()));var n=this.getPackageCount(_e.ADDCARROTHP);if(n>0){e.usersData.getCarrotFigure()===ue.CARROT_FAT?e.nCarrotHP=12+n:e.nCarrotHP=10+n;var s=String.formatC("%ld",e.m_nGameMode===ge.CHALLENGEMODE?e.nCarrotHP-7:e.nCarrotHP);e.gameLayer.houselife.setString(s)}return this.getPackageCount(_e.ADDPOWER)>0&&e.addTowerBuff(null),!0},getCurMapLevel:function(){var e=this.m_pLevelsData[this.m_nCurLevelIndex],t=wr.getModel();t.curLevel=e.getMapIndex();var i=t.mapConfig.allLevels[t.curLevel-1];return t.curTheme=i.nTheme,this.curMapLevel?this.curMapLevel:this.mapData},updateLevelsPer:function(){for(var e=this.mapData.wavesList,t=e.length,i=0;i<t;i++){var n=e[i];n.nMonsterType<J.BMT?this.M+=14*n.nMonsterCount:this.M+=168*n.nMonsterCount,n.nMonsterType==J.SBB?n.fHPIncreasePercent=e[i].fHPIncreasePercent:n.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(n.nMonsterType)*.12,n.nMonsterType>J.BMT&&n.nMonsterType<J.SBFT?n.nMonsterCount<3?n.fHPIncreasePercent=1.1*n.fHPIncreasePercent:n.nMonsterCount<4?n.fHPIncreasePercent=1.05*n.fHPIncreasePercent:n.nMonsterCount<5?n.fHPIncreasePercent=1*n.fHPIncreasePercent:n.nMonsterCount<6?n.fHPIncreasePercent=.95*n.fHPIncreasePercent:n.nMonsterCount<7?n.fHPIncreasePercent=.9*n.fHPIncreasePercent:n.nMonsterCount<8?n.fHPIncreasePercent=.85*n.fHPIncreasePercent:n.fHPIncreasePercent=.8*n.fHPIncreasePercent:n.nMonsterType>=J.FTM&&n.nMonsterType<=J.FLM3?n.nMonsterCount<5?n.fHPIncreasePercent=1.1*n.fHPIncreasePercent:n.nMonsterCount<10?n.fHPIncreasePercent=1.05*n.fHPIncreasePercent:n.nMonsterCount<15?n.fHPIncreasePercent=1*n.fHPIncreasePercent:n.fHPIncreasePercent=.9*n.fHPIncreasePercent:n.nMonsterType==J.LM41&&n.nMonsterType==J.LM42&&n.nMonsterType==J.LM43&&n.nMonsterType==J.LM44&&n.nMonsterType==J.LM45&&(n.nMonsterCount<2?n.fHPIncreasePercent=1*n.fHPIncreasePercent:n.nMonsterCount<3?n.fHPIncreasePercent=.95*n.fHPIncreasePercent:n.nMonsterCount<4?n.fHPIncreasePercent=.9*n.fHPIncreasePercent:n.nMonsterCount<5?n.fHPIncreasePercent=.85*n.fHPIncreasePercent:n.fHPIncreasePercent=.8*n.fHPIncreasePercent);wr.getModel().getObjectByType(n.nMonsterType)}},loadObjects:function(){for(var e=wr.getModel(),t=Zl(String.formatC(Fd(Ba),50),0),i=0;i<t;i++){var n=l.rect(0,0,0,0);n.x=Zl(String.formatC(Fd(Ba),4*i+51),0),n.y=Zl(String.formatC(Fd(Ba),4*i+52),0),n.width=Zl(String.formatC(Fd(Ba),4*i+53),0),n.height=Zl(String.formatC(Fd(Ba),4*i+54),0),e.buildspace.push(n)}e.curWave=Zl(Fd(Ca),0),e.nCarrotHP=Zl(Fd(ya),0);var s=Zl(Fd(Pa),0);e.changeMoney(s-e.getAllMoney()),this.m_nFailedCount=Zl(Fd(ba),0),this.m_nGiveCount=Zl("HGC",0),this.m_nGiveType=Zl("HGT",0),this.m_nPackageType=Zl("HPT",0)},loadBuildPlace:function(){for(var e=wr.getModel(),t=Zl(String.formatC(Fd(Fa),30),0),i=0;i<t;i++){var n=l.rect(0,0,0,0);n.x=Zl(String.formatC(Fd(Fa),4*i+31),0),n.y=Zl(String.formatC(Fd(Fa),4*i+32),0),n.width=Zl(String.formatC(Fd(Fa),4*i+33),0),n.height=Zl(String.formatC(Fd(Fa),4*i+34),0),e.buildspace.push(n)}},loadTower:function(){for(var e=wr.getModel(),t=0;t<this.m_nTowerCount;t++){var i=Zl(String.formatC(Fd(Ea),4*t+63),0);if(!(i>J.TRANDOM||i<J.TBOTTLE)){var n=Zl(String.formatC(Fd(Ea),4*t+61),0),s=Zl(String.formatC(Fd(Ea),4*t+62),0),r=Zl(String.formatC(Fd(Ea),4*t+64),0);e.addTower(l.p(n,s),i,r,1)}}},SaveData:function(e){if($l(this.m_nPassCount,Fd(_a)),$l(this.m_nCurLevelIndex,Fd(ga)),$l(this.m_nStars,Fd(pa)),$l(this.gameWaitTime,Fd(ma)),$l(this.m_nSaveStoreyLevel,Fd(ua)),this.m_nDropDiamond>0){var t=nd("MDDDT"),i=this.getCurSystemTime();0==t?(sd(i,"MDDDT"),Ql.postToServer()):i-t>86400&&(this.m_nDropDiamond=0,sd(i,"MDDDT"),Ql.postToServer()),$l(this.m_nDropDiamond,"MDDCK")}var n=this.m_pLevelsData.length;$l(n,Fd(Ta));for(var s=0;s<n;s++)this.m_pLevelsData[s].writeData(s+10);e&&($l(0,String.formatC(Fd(Ea),60)),hd("","HPath"))},SaveCurLevel:function(){var e=wr.getModel();if(!(this.getCurLevelMode()>=Rn)){var t=0;e.towers&&(t=e.towers.length);var i=e.usersData.getCarrotFigure();if(i!=ue.CARROT_GIRL&&i!=ue.CARROT_OLD||t--,t>0){var n=this.m_pLevelsData[this.m_nCurLevelIndex];$l(n.getMapIndex(),"HGMID"),hd(e.getMapPath(),"HPath"),$l(this.m_nGiveCount,"HGC"),$l(this.m_nGiveType,"HGT"),$l(this.m_nPackageType,"HPT"),$l(e.curWave,Fd(Ca)),$l(e.nCarrotHP,Fd(ya)),$l(e.getAllMoney(),Fd(Pa)),$l(this.m_nFailedCount,Fd(ba)),i!=ue.CARROT_GIRL&&i!=ue.CARROT_OLD||t++,$l(t,String.formatC(Fd(Ea),60));for(var s=e.towers,r=0;r<t;r++){var a=s[r],o=a.getPosition();$l(o.x,String.formatC(Fd(Ea),4*r+61)),$l(o.y,String.formatC(Fd(Ea),4*r+62)),$l(a.define.type,String.formatC(Fd(Ea),4*r+63)),$l(a.nCurLevel,String.formatC(Fd(Ea),4*r+64))}t=e.objects.length,$l(t,String.formatC(Fd(Ba),50));for(var h=e.objects,r=0;r<t;r++){var l=h[r],o=l.getPosition();$l(o.x,String.formatC(Fd(Ba),4*r+51)),$l(o.y,String.formatC(Fd(Ba),4*r+52)),$l(l.curHP,String.formatC(Fd(Ba),4*r+53)),$l(l.define.type,String.formatC(Fd(Ba),4*r+54))}t=e.buildspace.length,$l(t,String.formatC(Fd(Fa),30));for(r=0;r<t;r++){var d=e.buildspace[r];$l(d.x,String.formatC(Fd(Fa),4*r+31)),$l(d.y,String.formatC(Fd(Fa),4*r+32)),$l(d.width,String.formatC(Fd(Fa),4*r+33)),$l(d.height,String.formatC(Fd(Fa),4*r+34))}if(null==this.curMapLevel){if(null==this.mapData.towerType)return;t=this.mapData.towerType.length,$l(t,Fd(La));for(r=0;r<t;r++)$l(this.mapData.towerType[r],String.formatC(Fd(Ma),r+20))}}else $l(0,String.formatC(Fd(Ea),60)),hd("","HPath");Ql.postToServer()}},setCurLevelWin:function(){this.m_nFailedCount=0,l.log("Higher.....setCurLevelWin:.."),this.setNextLevelItem(!0)},setCurLevelLose:function(){this.getPackageCount(_e.NODOWNLEVEL)?this.m_nPackageType=_e.UNKNOWPT:(++this.m_nFailedCount>3&&(this.m_nFailedCount=3),this.setDownLevelItem())},saveDownLimite:function(e){var t=parseInt((this.m_nPassCount-1)/10);this.m_nSaveStoreyLevel=10*t},getDownCount:function(){var e=this.m_nFailedCount+1;return this.m_nPassCount-e<=this.m_nSaveStoreyLevel&&(e=this.m_nPassCount-this.m_nSaveStoreyLevel-1),e<0?e=0:e>3&&(e=3),e},getDropType:function(e){return 0},getDropDiamondCount:function(e){if(this.m_nDropDiamond>=300)return 0;var t=this.m_nDropDiamond+e;return t>=300?(t=300-this.m_nDropDiamond,this.m_nDropDiamond=300):(t=e,this.m_nDropDiamond+=e),$l(this.m_nDropDiamond,"MDDCK"),Ql.postToServer(),t},setWaitTime:function(e){if(void 0!=e){var t=e,i=this.getCurSystemTime();0==t&&(t=i);var n=O.STARFULLCOUNT-this.getStarCount();(t+=n*O.STARGROWTIME2)-i>n*O.STARGROWTIME2?this.gameWaitTime=i+n*O.STARGROWTIME2-1:this.gameWaitTime=t}},getWaitMS:function(){var e=0,t=0,i=wr.getModel(),n=this.getCurSystemTime();if(this.gameWaitTime<n||i.usersData.isLifeForever())return{m:e,s:t};var s=this.gameWaitTime-n,r=parseInt(s%O.STARGROWTIME2);return(e=Math.floor(r/60))>99&&(e=99),t=r%60,{m:e,s:t}},wastePlayTime:function(){var e=wr.getModel();if(!(e.usersData.isLifeForever()||e.m_bFeast&&e.m_oFeast.getCurFeastType()==pn)){var t=this.getUsedStar();if(this.getStarCount()-t>O.STARFULLCOUNT)this.addStarCount(-t);else{var i=this.getGameStars();this.gameWaitTime=this.getCurSystemTime(),(i-=t)<1?(this.gameWaitTime=this.getCurSystemTime()+O.STARFULLCOUNT*O.STARGROWTIME2-1,this.setStarCount(i)):(this.gameWaitTime=this.getCurSystemTime()+(O.STARFULLCOUNT-i)*O.STARGROWTIME2-1,this.setStarCount(i))}}},addOnePlayTime:function(){if(!wr.getModel().usersData.isLifeForever()){var e=this.addStarCount(1);e>O.STARFULLCOUNT||(this.gameWaitTime=this.getCurSystemTime()+(O.STARFULLCOUNT-e)*O.STARGROWTIME2-1)}},getGameStars:function(){var e=this.getCurSystemTime();if(this.gameWaitTime<e)return this.getStarCount()<O.STARFULLCOUNT&&this.addStarCount(O.STARFULLCOUNT-this.getStarCount()),this.getStarCount();if(wr.getModel().usersData.isLifeForever()||this.getStarCount()>O.STARFULLCOUNT)return this.getStarCount();var t=this.gameWaitTime-e,i=O.STARFULLCOUNT-Math.ceil(t/O.STARGROWTIME2);return i<0&&(i=0),this.setStarCount(i),i},addStarCount:function(e){return this.m_nStars+=e,this.m_nStars>=O.STARFULLCOUNT&&(this.gameWaitTime=this.getCurSystemTime()-1),this.getStarCount()},getStarCount:function(){return this.m_nStars},setStarCount:function(e){this.m_nStars=e},checkData:function(){var e=parseInt(Zl(Fd(ua),0));if(this.m_nSaveStoreyLevel<e){this.m_nSaveStoreyLevel=e;var t=e+1;this.m_nPassCount<t&&(this.m_nPassCount=t,this.setNextLevelItem())}},Init:function(){this.m_nStars=O.STARFULLCOUNT,this.gameWaitTime=this.getCurSystemTime()-1,this.m_nFailedCount=0,this.m_nPassCount=1,this.m_nGiveCount=0,this.m_nGiveType=fe.UNKNOWBB,this.m_nPackageType=_e.UNKNOWPT,this.m_nCurLevelIndex=0,this.m_pLevelsData=[],this.m_strMapPath=null,this.InitConfig(),this.InitBossMapConfig(),this.m_pLevelsData.length<1&&(this.InitMap(),this.m_nCurLevelIndex=F()%20,this.setCurMapConfig(-1));var e=this.m_pLevelsData[this.m_nCurLevelIndex],t=wr.getModel();t.curLevel=e.getMapIndex(),t.curTheme=t.mapConfig.allLevels[t.curLevel-1].nTheme,l.log("Highther........Init.......data.curLevel = item.getMapIndex()是 %d,",t.curLevel+"data.curThem ="+t.curTheme+",随机第一关m_nCurLevelIndex:"+this.m_nCurLevelIndex)},InitMap:function(){for(var e=[3,5,6,8,9,10,12,16,17,20,24,25,35,37,39,41,44,49,51,54,60,65,66,68,69,71,74,76,78,80,83,86,87,89,92,96,98,100,101,106,108,111,115,119,122,130,132,135,136,138,142,144,145,149,152],t=[22,32,42,46,63,67,70,84,90,113,118,125,134,147,155],i=[28,40,56,128,153],n=[43,58,69,94,112],s=[62,91,126,131,146],r=e.length,a=0;a<r;a++){d=new Aa(e[a],On);this.m_pLevelsData.push(d)}r=t.length;for(a=0;a<r;a++){d=new Aa(t[a],In);this.m_pLevelsData.push(d)}var o=[1,2,3,4,5];r=o.length;for(a=0;a<r;a++){d=new Aa(i[a],Rn,o[a]);this.m_pLevelsData.push(d)}var h=[6,7,8,9,10];r=h.length;for(a=0;a<r;a++){d=new Aa(n[a],xn,h[a]);this.m_pLevelsData.push(d)}var l=[11,12,13,14,15];r=l.length;for(a=0;a<r;a++){var d=new Aa(s[a],Dn,l[a]);this.m_pLevelsData.push(d)}},InitConfig:function(){var e=[1,2,3,4,5,6,7,8,9,10,11,12,13,16,17,19,20,23,24,25,27,29,31,34,35,37,39,41,43,44,45,47,49,51,54,55,58,60,62,64,66,68,69,71,72,74,75,76,78,79,82,83,85,86,87,89,91,92,93,94,96,98,99,101,102,103,106,107,108,109,111,112,116,117,119,120,122,123,124,126,127,129,130,131,132,133,136,138,141,142,144,145,146,149,150,151,152,154];l.assert(da==e.length,"单出口刷怪表数量不足");var t=[22,26,32,38,42,46,53,57,63,67,70,81,84,90,97,104,113,118,125,134,137,139,147,155];l.assert(ca==t.length,"双出口刷怪表数量不足"),this.m_nSMapConfigs=e,this.m_nDMapConfigs=t},InitBossMapConfig:function(){var e=null,t=null,i=null,n=null,s=null,r=null,a=null,o=null,h=null,d=null,c=null,u=null,p=null,m=null,_=null,g=null,T=null,f=null;e=[new Wd(1,J.LM1,10,400),new Wd(1,J.LM2,10,400),new Wd(2,J.FTM,5,800),new Wd(3,J.BM3,1,600),new Wd(3,J.SBFL2,5,80),new Wd(4,J.FLM1,10,2500),new Wd(4,J.FLM1,10,2500),new Wd(5,J.SBL3,5,90),new Wd(5,J.SBL2,5,90)],t=[J.TANCHOR,J.TFIREBOTTLE,J.TPIN,J.TSNOW],i=[new Nd(4,24,5,60,se.KILLOBJECT,3,",S3Ob5,S3Ob12,S3Ob17,"),new Nd(4,10,10,140,se.KILLOBJECT,34,""),new xd(22,23,10,J.TBOOMERANG,se.KILLMONSTER,-10)],n=Gd.create(2,5,1999,1,30,"level 156",t,e,1.5,i,l.p(0,0),220),e=[new Wd(1,J.BM3,1,1e3),new Wd(2,J.SBL1,3,250),new Wd(2,J.SBL3,3,250),new Wd(3,J.SBFL1,2,260),new Wd(3,J.SBFL2,2,260)],t=[J.TICEFAN,J.TARROW,J.TPLANE,J.TFISH,J.TBLUESTAR],i=[new Nd(4,24,5,60,se.KILLOBJECT,3,",S3Ob5,S3Ob12,S3Ob17,"),new Nd(4,10,10,140,se.KILLOBJECT,34,""),new xd(22,23,10,J.TBOOMERANG,se.KILLMONSTER,-10)],s=Gd.create(3,3,999,1,60,"level 157",t,e,1,i,l.p(0,0),320),e=[new Wd(1,J.FLM1,5,900),new Wd(1,J.FLM2,5,900),new Wd(2,J.LM41,5,8e3),new Wd(3,J.BM2,1,520),new Wd(4,J.LM43,5,11e3)],t=[J.TSTAR,J.TROCKET,J.TANCHOR,J.TBOOMERANG],i=[new Nd(4,24,5,60,se.KILLOBJECT,3,",S3Ob5,S3Ob12,S3Ob17,"),new Nd(4,10,10,140,se.KILLOBJECT,34,""),new xd(22,23,10,J.TBOOMERANG,se.KILLMONSTER,-10)],r=Gd.create(4,4,2015,1,45,"level 158",t,e,2,i,l.p(0,0),310),e=[new Wd(1,J.LM1,10,8e3),new Wd(1,J.FTM,10,1e4),new Wd(2,J.FLM1,20,6500),new Wd(3,J.SBFT,2,250),new Wd(3,J.BM2,1,560),new Wd(4,J.SBL1,2,120),new Wd(4,J.SBL1,2,120)],t=[J.TSTAR,J.TBLUESTAR,J.TSNOW,J.TFIREBOTTLE],i=[new Nd(4,24,5,60,se.KILLOBJECT,3,",S3Ob5,S3Ob12,S3Ob17,"),new Nd(4,10,10,140,se.KILLOBJECT,34,""),new xd(22,23,10,J.TBOOMERANG,se.KILLMONSTER,-10)],a=Gd.create(8,4,900,1,95,"level 159",t,e,1,i,l.p(0,0),425),e=[new Wd(1,J.LM41,5,2e3),new Wd(2,J.LM42,5,2500),new Wd(3,J.LM43,10,5e3),new Wd(4,J.LM44,15,7e3),new Wd(5,J.BM4,1,420)],t=[J.TARROW,J.TPLANE,J.TMAGNET,J.TCUTTLE,J.TFISH],i=[new Nd(4,24,5,60,se.KILLOBJECT,3,",S3Ob5,S3Ob12,S3Ob17,"),new Nd(4,10,10,140,se.KILLOBJECT,34,""),new xd(22,23,10,J.TBOOMERANG,se.KILLMONSTER,-10)],o=Gd.create(9,5,1500,1,70,"level 160",t,e,1.5,i,l.p(0,0),450),e=[new Wd(1,J.LM2,8,3),new Wd(2,J.LM1,5,15),new Wd(2,J.LM3,5,20),new Wd(3,J.LM2,6,35),new Wd(3,J.LM3,6,45),new Wd(4,J.SBB,1,250),new Wd(4,J.LM1,5,53),new Wd(4,J.FTM,5,80),new Wd(5,J.LM3,7,90),new Wd(5,J.LM2,7,100),new Wd(6,J.FTM,12,150),new Wd(7,J.LM1,10,148),new Wd(7,J.FLM1,3,98),new Wd(8,J.FLM1,12,205),new Wd(9,J.FLM2,2,290),new Wd(9,J.FTM,8,800),new Wd(9,J.FLM2,3,300),new Wd(10,J.SBL1,1,8.2),new Wd(10,J.SBL2,2,8),new Wd(10,J.SBL3,3,8),new Wd(11,J.LM3,12,980),new Wd(11,J.LM41,3,800),new Wd(12,J.FLM2,12,800),new Wd(13,J.LM1,12,1080),new Wd(13,J.LM2,12,1111),new Wd(14,J.FLM1,8,1e3),new Wd(14,J.LM44,4,1400),new Wd(15,J.FTM,12,4e3),new Wd(15,J.SBFT,3,60),new Wd(16,J.LM41,5,5e3),new Wd(16,J.LM3,6,6e3),new Wd(16,J.FLM2,6,4e3),new Wd(17,J.LM42,5,6e3),new Wd(17,J.FLM1,10,4e3),new Wd(17,J.FLM2,10,4400),new Wd(18,J.SBFT,5,80),new Wd(18,J.SBL1,6,36),new Wd(18,J.SBL2,6,38),new Wd(18,J.SBFL1,5,41),new Wd(18,J.SBFL2,5,44)],t=[J.TBOTTLE,J.TCUTTLE,J.TANCHOR,J.TBOOMERANG,J.TFISH,J.TBLUESTAR,J.TSUN,J.TPLANE],i=[new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-50),new Nd(4,10,10,300,se.KILLOBJECT,11,""),new xd(9,12,10,J.TBALL,se.BUILDTOWER,3)],h=Gd.create(3,18,365,1,3,"level 161",t,e,1.3,i,l.p(0,0)),e=[new Wd(1,J.LM3,5,10),new Wd(2,J.LM1,8,49.12),new Wd(3,J.LM2,10,140),new Wd(3,J.SBB,1,220),new Wd(4,J.LM1,7,260.75),new Wd(4,J.FLM1,2,280.32),new Wd(5,J.FLM2,8,600),new Wd(6,J.FTM,8,1600.96),new Wd(6,J.FLM1,2,760.48),new Wd(7,J.LM3,7,1900),new Wd(7,J.FLM2,3,1200),new Wd(8,J.FLM2,5,1400.45),new Wd(8,J.FLM1,5,1520.45),new Wd(9,J.LM2,5,2300.18),new Wd(9,J.FTM,6,3000.02),new Wd(10,J.SBL1,1,52),new Wd(10,J.LM1,10,3700.37),new Wd(10,J.SBL3,3,60),new Wd(11,J.LM3,7,4300.12),new Wd(11,J.FLM1,8,3000.47),new Wd(11,J.SBFL2,2,60),new Wd(12,J.FLM2,7,2000.45),new Wd(12,J.SBFL1,3,64.8),new Wd(12,J.FTM,15,4000.89),new Wd(13,J.LM2,2,2880.21),new Wd(13,J.SBL2,1,95),new Wd(13,J.LM2,2,2880.21),new Wd(13,J.FTM,2,3879.6),new Wd(13,J.SBFT,1,120),new Wd(13,J.FTM,2,3879.6),new Wd(13,J.FLM1,3,2587.95),new Wd(13,J.FLM2,3,2587.95),new Wd(14,J.SBL1,1,100),new Wd(14,J.SBL3,1,110),new Wd(14,J.SBL1,1,118),new Wd(14,J.SBL3,1,123),new Wd(15,J.SBFL1,1,90),new Wd(15,J.LM43,1,4138),new Wd(15,J.SBFL2,1,95),new Wd(15,J.SBL2,1,130)],t=[J.TFIREBOTTLE,J.TBOTTLE,J.TSTAR,J.TARROW,J.TICEFAN,J.TBALL,J.TROCKET],i=[new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-50),new Nd(4,10,10,300,se.KILLOBJECT,11,""),new xd(9,12,10,J.TBALL,se.BUILDTOWER,3)],d=Gd.create(4,15,666,1,3,"level 162",t,e,1.5,i,l.p(0,0)),e=[new Wd(1,J.FTM,8,2),new Wd(1,J.SBB,1,78),new Wd(2,J.LM1,10,11),new Wd(3,J.LM2,4,23),new Wd(3,J.LM3,6,25),new Wd(4,J.LM1,5,40),new Wd(4,J.LM2,5,39),new Wd(5,J.LM3,7,50),new Wd(5,J.FLM1,3,18),new Wd(6,J.FLM2,5,25),new Wd(6,J.FTM,7,120),new Wd(7,J.LM2,8,120),new Wd(7,J.LM45,2,130),new Wd(8,J.LM1,5,150),new Wd(8,J.FLM1,7,50),new Wd(9,J.LM3,5,300),new Wd(9,J.FLM2,9,80),new Wd(10,J.SBFL1,4,4.3),new Wd(10,J.LM45,1,350),new Wd(10,J.SBL2,6,10),new Wd(11,J.FTM,12,1e3),new Wd(11,J.LM1,8,1e3),new Wd(11,J.SBFL2,3,5),new Wd(12,J.LM2,6,1400),new Wd(12,J.LM3,6,1450),new Wd(12,J.SBFT,2,21),new Wd(12,J.FTM,5,2e3),new Wd(13,J.SBFT,3,23.2),new Wd(13,J.SBFL2,6,17),new Wd(13,J.LM2,8,2e3),new Wd(13,J.LM1,8,2300),new Wd(14,J.SBFT,5,50),new Wd(14,J.LM3,10,3e3),new Wd(14,J.SBL1,5,36),new Wd(14,J.SBL3,5,37.3),new Wd(14,J.SBFL1,2,28),new Wd(14,J.SBFL2,2,30),new Wd(15,J.LM45,2,4e3),new Wd(15,J.SBFL1,2,35),new Wd(15,J.SBFL2,2,38),new Wd(15,J.FLM1,6,3800),new Wd(15,J.FLM2,6,3900.25),new Wd(16,J.SBL1,1,68.5),new Wd(16,J.SBL2,1,70.5),new Wd(16,J.SBFL1,1,40),new Wd(16,J.SBFL2,1,42.6),new Wd(16,J.SBFT,1,90),new Wd(16,J.LM44,1,5900)],t=[J.TFLASHLIGHT,J.TPIN,J.TPLANE,J.TFIREBOTTLE,J.TBOOMERANG,J.TROCKET,J.TARROW,J.TBALL,J.TBOTTLE],i=[new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-50),new Nd(4,10,10,300,se.KILLOBJECT,11,""),new xd(9,12,10,J.TBALL,se.BUILDTOWER,3)],c=Gd.create(5,16,478,1,3,"level 163",t,e,1.4,i,l.p(0,0)),e=[new Wd(1,J.LM2,8,8),new Wd(2,J.LM1,5,12),new Wd(2,J.LM3,5,16),new Wd(3,J.FTM,5,40),new Wd(3,J.LM2,5,23),new Wd(3,J.SBB,1,88),new Wd(4,J.FLM1,5,29),new Wd(4,J.FLM2,5,33),new Wd(5,J.SBL1,1,2.3),new Wd(5,J.SBL2,1,2.7),new Wd(6,J.LM45,1,200),new Wd(6,J.SBL3,1,3.5),new Wd(7,J.LM3,6,300),new Wd(7,J.LM3,6,300),new Wd(8,J.LM1,3,430.92),new Wd(8,J.FTM,5,700.91),new Wd(8,J.LM1,3,500.92),new Wd(9,J.FLM1,5,420),new Wd(9,J.FLM1,5,480),new Wd(10,J.FTM,7,1450.89),new Wd(10,J.SBFT,3,16),new Wd(11,J.FLM2,6,990.02),new Wd(11,J.FLM2,6,1100.02),new Wd(12,J.LM44,1,1500.04),new Wd(12,J.LM44,1,2000.04),new Wd(13,J.LM2,10,2000.75),new Wd(14,J.FTM,7,5000.35),new Wd(14,J.SBFT,1,70),new Wd(14,J.SBFT,2,80),new Wd(15,J.SBFL1,2,45),new Wd(15,J.SBFL2,2,48),new Wd(15,J.SBFL1,2,50),new Wd(15,J.SBFL2,2,51),new Wd(16,J.LM1,7,5000.86),new Wd(16,J.LM1,7,5300.86),new Wd(17,J.LM3,2,5300.69),new Wd(17,J.LM43,2,4700.69),new Wd(18,J.SBL3,1,80),new Wd(18,J.SBL1,1,90),new Wd(18,J.LM42,1,4900.35),new Wd(19,J.FLM1,5,3400),new Wd(19,J.SBL2,2,72),new Wd(19,J.FLM1,5,3600),new Wd(20,J.SBFT,3,132),new Wd(20,J.LM41,2,5380.4),new Wd(20,J.SBFL1,2,70),new Wd(20,J.SBFL2,2,76)],t=[J.TFIREBOTTLE,J.TBOOMERANG,J.TFLASHLIGHT,J.TSNOW,J.TARROW,J.TANCHOR,J.TICEFAN,J.TBOTTLE],i=[new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-50),new Nd(4,10,10,300,se.KILLOBJECT,11,""),new xd(9,12,10,J.TBALL,se.BUILDTOWER,3)],u=Gd.create(6,20,500,1,3,"level 164",t,e,1.2,i,l.p(0,0)),e=[new Wd(1,J.LM1,5,8),new Wd(1,J.LM2,5,9),new Wd(1,J.LM3,5,10),new Wd(2,J.LM2,5,20),new Wd(2,J.LM3,5,30),new Wd(2,J.LM1,5,40),new Wd(2,J.SBB,1,166),new Wd(3,J.FLM1,8,35),new Wd(3,J.LM3,4,50),new Wd(3,J.LM2,3,60),new Wd(4,J.LM1,2,100),new Wd(4,J.FLM2,7,70),new Wd(4,J.FLM1,6,80),new Wd(5,J.LM1,6,220),new Wd(5,J.FTM,2,350),new Wd(5,J.LM3,7,250),new Wd(6,J.LM3,5,310),new Wd(6,J.FTM,4,550),new Wd(6,J.LM2,6,380),new Wd(7,J.LM3,5,450),new Wd(7,J.LM2,5,460),new Wd(7,J.LM1,5,490),new Wd(7,J.FLM2,5,350),new Wd(7,J.LM1,8,510),new Wd(7,J.FLM1,2,375),new Wd(8,J.LM1,3,810),new Wd(8,J.FLM1,6,490),new Wd(8,J.FLM2,6,500),new Wd(8,J.LM2,8,950),new Wd(8,J.LM1,8,990),new Wd(8,J.LM3,8,1100),new Wd(9,J.LM1,5,1780),new Wd(9,J.FLM1,5,1300),new Wd(9,J.FLM2,5,1500),new Wd(9,J.LM1,5,2e3),new Wd(9,J.FLM1,4,1800),new Wd(9,J.LM1,6,2500),new Wd(9,J.LM3,5,2700),new Wd(10,J.LM2,5,2800),new Wd(10,J.FLM2,4,2e3),new Wd(10,J.LM1,6,3100),new Wd(10,J.SBFL1,1,55.3),new Wd(10,J.FLM1,10,1800),new Wd(10,J.FLM2,10,1880)],t=[J.TBOTTLE,J.TSHIT,J.TSUN,J.TMAGNET,J.TBOOMERANG,J.TFISH,J.TANCHOR,J.TBALL,J.TPLANE,J.TFIREBOTTLE,J.TROCKET,J.TCUTTLE],i=[new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-50),new Nd(4,10,10,300,se.KILLOBJECT,11,""),new xd(9,12,10,J.TBALL,se.BUILDTOWER,3)],p=Gd.create(7,10,520,1,3,"level 165",t,e,1.3,i,l.p(0,0)),e=[new Wd(1,J.LM1,8,10),new Wd(2,J.FLM1,3,10),new Wd(2,J.LM2,5,20),new Wd(3,J.LM2,6,30),new Wd(3,J.FLM1,6,28),new Wd(4,J.LM41,2,100),new Wd(4,J.FTM,5,56.6),new Wd(5,J.LM3,7,70),new Wd(5,J.FLM2,7,55),new Wd(6,J.LM2,12,105),new Wd(6,J.LM41,3,300),new Wd(7,J.FLM1,5,100),new Wd(7,J.LM1,8,130),new Wd(8,J.FLM2,12,120),new Wd(9,J.FTM,15,180),new Wd(10,J.SBL1,1,5.2),new Wd(10,J.LM2,5,200),new Wd(11,J.LM3,12,250),new Wd(11,J.LM41,2,500),new Wd(12,J.FLM2,12,250),new Wd(13,J.LM1,8,300),new Wd(13,J.LM2,8,300),new Wd(14,J.FLM1,8,300),new Wd(14,J.LM44,2,800),new Wd(15,J.FTM,15,500),new Wd(15,J.SBFT,4,8),new Wd(16,J.SBL1,5,8),new Wd(16,J.LM3,6,600),new Wd(16,J.FLM2,6,500),new Wd(17,J.LM42,2,1000.32),new Wd(17,J.FLM1,10,700),new Wd(18,J.FLM1,10,800.25),new Wd(18,J.FLM2,10,800.25),new Wd(19,J.SBL1,3,18),new Wd(19,J.SBL2,3,18),new Wd(20,J.FLM2,15,900),new Wd(21,J.LM2,5,18),new Wd(21,J.LM3,5,18.6),new Wd(22,J.SBFT,2,25),new Wd(22,J.LM2,8,1300),new Wd(23,J.FLM2,2,1200),new Wd(23,J.FTM,8,1600),new Wd(24,J.SBL1,1,30.2),new Wd(24,J.SBL2,2,30.4),new Wd(24,J.LM2,5,1500),new Wd(25,J.LM3,15,1600),new Wd(11,J.LM41,1,3e3)],t=[J.TSUN,J.TFLASHLIGHT,J.TCUTTLE,J.TANCHOR,J.TMOON],i=[new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1)],m=Gd.create(4,25,800,1,3,"level 166",t,e,1.5,i,l.p(0,0),0,1,8e5),e=[new Wd(1,J.LM2,8,10),new Wd(2,J.LM1,5,15),new Wd(2,J.LM3,5,15),new Wd(3,J.FLM1,6,20),new Wd(3,J.LM3,6,28),new Wd(4,J.SBL1,2,2),new Wd(4,J.FTM,7,56.6),new Wd(5,J.LM3,7,60),new Wd(5,J.FLM2,7,67),new Wd(6,J.FTM,12,105),new Wd(7,J.LM45,2,510),new Wd(7,J.FLM1,8,90),new Wd(8,J.FLM1,12,100),new Wd(9,J.FLM2,2,120),new Wd(9,J.FTM,8,150),new Wd(9,J.FLM2,3,120),new Wd(10,J.SBFL1,2,4.5),new Wd(10,J.FTM,8,200),new Wd(10,J.SBL3,2,5.5),new Wd(11,J.LM3,12,200),new Wd(11,J.LM41,3,450),new Wd(12,J.FLM2,12,250),new Wd(13,J.LM1,8,350),new Wd(13,J.LM2,8,350),new Wd(14,J.FLM1,8,350),new Wd(14,J.LM44,3,700),new Wd(15,J.FTM,12,500),new Wd(15,J.SBFT,3,15),new Wd(16,J.LM2,5,700),new Wd(16,J.LM3,6,700),new Wd(16,J.FLM2,6,550),new Wd(17,J.LM1,5,800.32),new Wd(17,J.FLM1,10,600),new Wd(18,J.FLM1,10,700.25),new Wd(18,J.LM44,10,1500.25),new Wd(19,J.SBL1,6,50),new Wd(19,J.FTM,7,2800.6),new Wd(20,J.SBFT,5,60),new Wd(20,J.LM1,8,3e3)],t=[J.TFISH,J.TMAGNET,J.TSHIT,J.TBOOMERANG],i=[new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1)],_=Gd.create(6,20,2e3,1,3,"level 167",t,e,2,i,l.p(0,0),0,1,14e5),e=[new Wd(1,J.LM2,10,5),new Wd(2,J.LM1,5,20),new Wd(2,J.LM3,5,20),new Wd(3,J.LM2,8,25),new Wd(3,J.FLM1,2,28),new Wd(4,J.SBL1,2,3),new Wd(4,J.FTM,10,56.6),new Wd(5,J.LM3,6,60),new Wd(5,J.FLM2,4,67),new Wd(6,J.FTM,10,105),new Wd(6,J.LM41,2,250),new Wd(7,J.FLM1,8,110),new Wd(7,J.LM1,2,70),new Wd(8,J.FLM1,10,100),new Wd(9,J.FLM2,2,155),new Wd(9,J.FTM,8,390),new Wd(9,J.FLM2,3,170),new Wd(10,J.SBL1,1,7.2),new Wd(10,J.SBL2,2,6.4),new Wd(10,J.SBL3,3,6.5),new Wd(11,J.LM3,15,500),new Wd(12,J.FLM2,10,420),new Wd(13,J.LM1,6,900),new Wd(13,J.LM2,6,900),new Wd(14,J.FLM1,8,700),new Wd(14,J.LM44,4,700),new Wd(15,J.FTM,12,1500),new Wd(15,J.SBFT,3,22),new Wd(16,J.LM41,5,1e3),new Wd(16,J.LM3,6,1e3),new Wd(16,J.FLM2,4,850),new Wd(17,J.FLM1,10,900),new Wd(18,J.FLM1,10,1216.25),new Wd(18,J.FLM2,10,1216.25),new Wd(19,J.SBL1,5,30),new Wd(19,J.SBL2,5,28),new Wd(20,J.FLM2,10,20),new Wd(20,J.LM3,10,18.6),new Wd(21,J.SBFT,5,50),new Wd(21,J.LM2,5,3e3)],t=[J.TFIREBOTTLE,J.TPIN,J.TPLANE,J.TSHIT,J.TICEFAN],i=[new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1)],g=Gd.create(8,21,1500,1,3,"level 168",t,e,1.4,i,l.p(0,0),0,1,7e5),e=[new Wd(1,J.LM1,4,10),new Wd(1,J.LM2,4,10),new Wd(2,J.LM3,4,15),new Wd(2,J.LM2,4,15),new Wd(3,J.FLM1,2,15),new Wd(3,J.LM2,6,23),new Wd(4,J.FLM2,2,20),new Wd(4,J.FTM,6,30),new Wd(5,J.FLM1,6,40),new Wd(5,J.FLM2,2,40),new Wd(6,J.LM2,3,70),new Wd(6,J.LM3,5,70),new Wd(7,J.FLM2,6,70),new Wd(7,J.FTM,2,100),new Wd(8,J.LM1,4,150),new Wd(8,J.FTM,4,200),new Wd(9,J.FTM,2,300),new Wd(9,J.FLM1,6,250.18),new Wd(10,J.FLM1,7,300),new Wd(10,J.SBL2,1,7),new Wd(11,J.FLM1,4,400.59),new Wd(11,J.FLM2,4,400.59),new Wd(12,J.LM2,4,600),new Wd(12,J.LM3,4,600),new Wd(13,J.LM3,6,800.62),new Wd(13,J.FTM,2,1e3),new Wd(14,J.LM1,2,1e3),new Wd(14,J.LM3,6,1e3),new Wd(15,J.LM1,5,1200.97),new Wd(15,J.LM2,5,1200.97),new Wd(16,J.FLM1,5,1000.43),new Wd(16,J.FLM2,5,1000.43),new Wd(17,J.LM2,5,1500.84),new Wd(17,J.FTM,5,1800.41),new Wd(18,J.FLM2,5,1500.54),new Wd(18,J.FTM,5,2000.92),new Wd(19,J.LM2,6,2000.7),new Wd(19,J.LM3,4,2000.7),new Wd(20,J.SBL1,5,3.5),new Wd(21,J.LM1,4,2200.46),new Wd(21,J.LM3,4,2200.46),new Wd(22,J.FLM1,4,2200.24),new Wd(22,J.FLM2,4,2200.24),new Wd(23,J.LM1,6,2500.81),new Wd(23,J.LM3,2,2500.81),new Wd(24,J.LM2,6,2500.99),new Wd(24,J.FTM,2,2500.38),new Wd(25,J.LM1,6,2800.16),new Wd(25,J.FTM,2,2800.8),new Wd(26,J.FLM1,4,2500.54),new Wd(26,J.FLM2,4,2500.54),new Wd(27,J.LM2,6,3000.36),new Wd(27,J.LM1,2,3000.36),new Wd(28,J.LM1,4,3300.38),new Wd(28,J.LM2,4,3300.38),new Wd(29,J.FLM1,4,3000.29),new Wd(29,J.FLM2,4,3000.29),new Wd(30,J.FLM1,5,3300.2),new Wd(30,J.FLM2,5,3300.2),new Wd(30,J.SBFL1,3,60)],t=[J.TBOTTLE,J.TSHIT,J.TBALL,J.TARROW,J.TCUTTLE],i=[new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1)],T=Gd.create(8,30,600,1,3,"level 169",t,e,1.8,i,l.p(0,0),0,1,65e4),e=[new Wd(1,J.LM3,8,10),new Wd(2,J.FLM1,8,10),new Wd(3,J.LM2,6,25),new Wd(3,J.LM3,6,28),new Wd(4,J.LM1,7,38),new Wd(4,J.SBFT,2,2),new Wd(5,J.LM3,5,60),new Wd(5,J.LM2,7,67),new Wd(6,J.FTM,10,90),new Wd(7,J.FLM1,10,90),new Wd(8,J.FLM1,12,100),new Wd(9,J.FLM2,2,130),new Wd(9,J.FTM,8,200),new Wd(9,J.FLM2,3,170),new Wd(10,J.SBL1,1,6.2),new Wd(10,J.SBL2,2,6.4),new Wd(10,J.LM2,8,250),new Wd(11,J.LM3,8,300),new Wd(11,J.FLM1,4,250),new Wd(12,J.FLM2,10,300),new Wd(13,J.SBL3,2,9),new Wd(13,J.LM2,8,400),new Wd(14,J.FLM1,8,350),new Wd(14,J.LM3,2,500),new Wd(15,J.FTM,10,700),new Wd(15,J.SBFT,2,18),new Wd(16,J.LM3,6,900),new Wd(16,J.FLM2,4,850),new Wd(17,J.LM42,5,2000.32),new Wd(17,J.FLM1,5,900),new Wd(18,J.FLM1,6,1216.25),new Wd(18,J.FLM2,6,1216.25),new Wd(19,J.FLM2,10,1500.25),new Wd(19,J.SBL2,4,28),new Wd(20,J.SBFL1,5,25),new Wd(20,J.LM2,8,1800.6)],t=[J.TFISH,J.TBALL,J.TBLUESTAR,J.TROCKET,J.TPLANE,J.TANCHOR],i=[new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1),new xd(11,11,10,J.TMOON,se.BUILDTOWER,1)],f=Gd.create(9,20,800,1,3,"level 170",t,e,1.5,i,l.p(0,0),0,1,12e5),this.allLevels=[n,s,r,a,o,h,d,c,u,p,m,_,g,T,f]},LoadData:function(){if(this.m_nPassCount=parseInt(Zl(Fd(_a),1)),this.m_nCurLevelIndex=parseInt(Zl(Fd(ga),0)),this.m_nStars=parseInt(Zl(Fd(pa),5)),this.gameWaitTime=parseInt(Zl(Fd(ma),this.getCurSystemTime()-1)),this.m_nSaveStoreyLevel=parseInt(Zl(Fd(ua),0)),this.m_nDropDiamond=Zl("MDDCK",0),this.m_nDropDiamond>0){var e=nd("MDDDT"),t=this.getCurSystemTime();0==e?(sd(t,"MDDDT"),Ql.postToServer()):t-e>86400&&(this.m_nDropDiamond=0,sd(t,"MDDDT"),Ql.postToServer())}for(var i=Zl(Fd(Ta),0),n=0;n<i;n++){var s=new Aa;s.readData(n+10),this.m_pLevelsData.push(s)}this.LoadCurLevel()},LoadCurLevel:function(){var e=Zl(String.formatC(Fd(Ea),60),0);if(this.m_nTowerCount=0,this.m_strMapPath=null,!(null!=this.mapData.towerType||0==e||this.getCurLevelMode()>=Rn)){var t=this.m_pLevelsData[this.m_nCurLevelIndex],i=Zl("HGMID",0);if(0!=i&&t.getMapIndex()==i){this.m_nTowerCount=e;var n=od("HPath");this.m_strMapPath=n,e=Zl(Fd(La),0),this.mapData.towerType=[];for(var s=0;s<e;s++){var r=Zl(String.formatC(Fd(Ma),s+20),0);this.mapData.towerType.push(r)}}}},randomNewLevel:function(){var e=this.getRandomMapMode(),t=this.m_pLevelsData.length,i=F()%t;i==this.m_nCurLevelIndex&&(i=(i+1)%t);var n=this.m_pLevelsData[i],s=n.getLevelStyle();if((s==e||e==Rn&&s>Rn)&&n.isUnPlayed())this.m_nCurLevelIndex=i;else{var r=F()%3+1;2==r&&r++;for(var a=i+t*r,o=i+r;o<a;o+=r)if(i=o%t,((s=(n=this.m_pLevelsData[i]).getLevelStyle())==e||e==Rn&&s>Rn)&&n.isUnPlayed())return void(this.m_nCurLevelIndex=i);for(o=0;o<t;o++)((s=(n=this.m_pLevelsData[i]).getLevelStyle())==e||e==Rn&&s>Rn)&&n.EraseConfig();this.randomNewLevel()}},randomCurMap:function(){var e=this.m_pLevelsData[this.m_nCurLevelIndex];this.hardPercent=1,this.m_nPackageType=_e.UNKNOWPT,this.m_bProtected=!1,this.createMagicCount();var t=!0,i=wr.getModel();i.m_nGameMode=ge.HIGHERMODE,i.curLevel=e.getMapIndex(),l.log("Highther........randomCurMap.......data.curLevel = item.getMapIndex()是 %d",i.curLevel);var n=i.mapConfig.allLevels[i.curLevel-1];if(e.getLevelStyle()>=Rn){if(e.getConfigIndex()<0&&this.setCurMapConfig(e.getDownMapIndex()),this.curMapLevel=this.allLevels[e.getConfigIndex()],i.curTheme=n.nTheme,i.changeMapPath(),!this.curMapLevel.bPresentGate)return}else t=!1,e.getConfigIndex()<0&&this.setCurMapConfig(e.getDownMapIndex()),this.curMapLevel=i.mapConfig.allLevels[e.getConfigIndex()],i.curTheme=n.nTheme,i.changeMapPath();this.mapData.nMoney=0,this.mapData.nTheme=this.curMapLevel.nTheme,this.mapData.nWaves=this.curMapLevel.nWaves,this.mapData.nMonsterSpan=this.curMapLevel.nMonsterSpan,this.mapData.nEveryListSpan=this.curMapLevel.nEveryListSpan,this.mapData.nBossModeSecond=this.curMapLevel.nBossModeSecond,this.mapData.bPresentGate=t,this.mapData.nStart01HP=this.curMapLevel.nStart01HP,this.mapData.ptLevelNum=this.curMapLevel.ptLevelNum,this.mapData.strLevelName=this.curMapLevel.strLevelName,this.mapData.fObjectHP=this.curMapLevel.fObjectHP,this.mapData.tasks=this.curMapLevel.tasks,this.randomMap(!1),this.hardPercent*=this.fromLevelModeGetHard(e.getLevelStyle());var s=this.curMapLevel.wavesList,r=s.length;this.mapData.wavesList=[],this.M=this.mapData.nMoney,this.mapData.nMoney=parseInt(this.mapData.nMoney*this.getMoneyRandomPer());var a,o,h=0,d=this.curMapLevel.nWaves,c=this.curMapLevel.fObjectHP;c<=1?(a=.2*d,o=1):c<2?(a=.3*d,o=.9):c<3?(a=.35*d,o=.8):(a=.4*d,o=.7),a<1&&(a=1);var u=d*(F()%1+8)/10,p=[a,a+(F()%2+4),u,1*d],m=[];this.m_nDropMoney<5e3?(m[0]=.1*this.m_nDropMoney,m[1]=.35*this.m_nDropMoney,m[2]=.4*this.m_nDropMoney,m[3]=.1*this.m_nDropMoney):this.m_nDropMoney<1e4?(m[0]=this.m_nDropMoney*o*.1,m[1]=.3*this.m_nDropMoney,m[2]=.3*this.m_nDropMoney,m[3]=.1*this.m_nDropMoney):this.m_nDropMoney>2e4?(m[0]=this.m_nDropMoney*o*.1,m[1]=.2*this.m_nDropMoney,m[2]=.2*this.m_nDropMoney,m[3]=0*this.m_nDropMoney):(m[0]=this.m_nDropMoney*o*.1,m[1]=.25*this.m_nDropMoney,m[2]=.2*this.m_nDropMoney,m[3]=.05*this.m_nDropMoney);for(var _=0;_<r;_++){var g=new Wd(s[_]);g.nMonsterType<J.BMT?this.M+=14*g.nMonsterCount:this.M+=168*g.nMonsterCount,g.nWave<=p[h]&&(this.M+=m[h]/a,g.nWave==p[h]&&(++h>3&&(h=3),(a=p[h]-p[h-1])<1&&(a=1))),g.nMonsterType==J.SBB?g.fHPIncreasePercent=s[_].fHPIncreasePercent:1==g.nWave?g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.02:2==g.nWave?g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.03:3==g.nWave?g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.04:4==g.nWave?g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.05:5==g.nWave?g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.06:6==g.nWave?g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.07:7==g.nWave?g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.08:8==g.nWave?g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.09:g.fHPIncreasePercent=this.M*this.hardPercent*this.fromCreepTypeGetHard(g.nMonsterType)*.1,g.nMonsterType>J.BMT&&g.nMonsterType<J.SBFT?g.nMonsterCount<3?g.fHPIncreasePercent=1.1*g.fHPIncreasePercent:g.nMonsterCount<5?g.fHPIncreasePercent=1.05*g.fHPIncreasePercent:g.nMonsterCount<6?g.fHPIncreasePercent=.95*g.fHPIncreasePercent:g.nMonsterCount<7?g.fHPIncreasePercent=.9*g.fHPIncreasePercent:g.nMonsterCount<8?g.fHPIncreasePercent=.85*g.fHPIncreasePercent:g.fHPIncreasePercent=.8*g.fHPIncreasePercent:g.nMonsterType>=J.FTM&&g.nMonsterType<=J.FLM3?g.nMonsterCount<5?g.fHPIncreasePercent=1.1*g.fHPIncreasePercent:g.nMonsterCount<10?g.fHPIncreasePercent=1.05*g.fHPIncreasePercent:g.nMonsterCount<15?g.fHPIncreasePercent=1*g.fHPIncreasePercent:g.fHPIncreasePercent=.9*g.fHPIncreasePercent:g.nMonsterType==J.LM41&&g.nMonsterType==J.LM42&&g.nMonsterType==J.LM43&&g.nMonsterType==J.LM44&&g.nMonsterType==J.LM45&&(g.nMonsterCount<2?g.fHPIncreasePercent=1*g.fHPIncreasePercent:g.nMonsterCount<3?g.fHPIncreasePercent=.95*g.fHPIncreasePercent:g.nMonsterCount<4?g.fHPIncreasePercent=.9*g.fHPIncreasePercent:g.nMonsterCount<5?g.fHPIncreasePercent=.85*g.fHPIncreasePercent:g.fHPIncreasePercent=.8*g.fHPIncreasePercent),this.mapData.wavesList.push(g);i.getObjectByType(g.nMonsterType)}this.curMapLevel=null},randomMap:function(e){var t=wr.getModel();this.randomMoney(e);for(var i=new l.TMXTiledMap(t.getMapPath()),n=i.getObjectGroup("PATH"),s=i.getTileSize().width,r=i.getTileSize().height,a=(t.getMapPath(),!1),o=0,h=1,d=n.getObject(String.formatC("PT%d",h)),c=-1,u=-1;d;){var p=d.x,m=d.y;-1==c&&-1==u?(c=p,u=m):c==p?(o+=Math.abs(m-u),u=m):(o+=Math.abs(p-c),c=p),a?(d=n.getObject(String.formatC("PT%d02",h)),a=!1,c=-1,u=-1):(h++,null==(d=n.getObject(String.formatC("PT%d",h)))&&(d=n.getObject(String.formatC("PT%d01",h)))&&(a=!0))}this.hardPercent*=this.fromRoadLenGetHard(o),this.hardPercent*=this.fromCurveCountGetHard(h-1),this.m_nDropMoney=0;for(var _=0,g=0,T=[],f=i.getProperty("prop"),S=0,w=1;S<f.length;)(w=f.indexOf(",",S))<0&&(w=f.length),T.push(f.substr(S,w-S)),S=w+1;var v=null;S=T.length;for(b=0;b<S;b++){var L=T[b],M=0;-1!=L.indexOf("SC")?M=3:-1!=L.indexOf("BC")?M=4:-1!=L.indexOf("DB")?M=5:-1!=L.indexOf("S")?M=0:-1!=L.indexOf("L")?M=1:-1!=L.indexOf("B")&&(M=2);for(var C=J.SMALLOBJECT1+M,y=1;;y++){A=String.formatC("%sOb%d",L,y);if(null==(d=n.getObject(A)))break;_+=(v=t.getObjectByType(C)).nMoney;var B=parseInt(d.type);B>0&&(g+=(v=t.getObjectByType(B+J.TBOTTLE-1)).nBuyMoney[0])}}this.m_nDropMoney+=_,this.hardPercent*=this.fromDropMoneyGetHard(_);var F=0;for(h=1;d=n.getObject(String.formatC("Obj%d",h));){var E=l.rect(d.x,d.y,d.width,d.height);F+=(c=E.width/s)*(u=E.height/r),h++}this.hardPercent*=this.fromTowerPlaceGetHard(F);for(y=J.MONSTEREND+1;y<J.TOWEREND;y++)for(var P=(v=t.getObjectByType(y)).nBuyMoney,b=1;;b++){var A=String.formatC("%dT%d",y-J.TBOTTLE+1,b);if(null==(d=n.getObject(A)))break;c=d.type-1,g+=P[0]}this.m_nDropMoney+=g,this.hardPercent*=this.fromGiveTowerGetHard(g),this.hardPercent*=this.fromHPPerGetHard()},randomTowers:function(e){if(e||this.mapData.bPresentGate){t=this.curMapLevel.towerType.length;this.mapData.towerType=[];for(o=0;o<t;o++){h=this.curMapLevel.towerType[o];this.mapData.towerType.push(h)}}else{var t=F()%3+3;this.mapData.towerType=[];var i=F()%t+1,n=t-i;if(i<n){var s=i;i=n,n=s}for(var r=[J.TBOTTLE,J.TSTAR,J.TSUN,J.TBALL,J.TFISH,J.TFLASHLIGHT,J.TARROW,J.TROCKET,J.TPLANE,J.TANCHOR,J.TCUTTLE,J.TBOOMERANG,J.TFIREBOTTLE,J.TPIN],a=[J.TSHIT,J.TBLUESTAR,J.TMAGNET,J.TICEFAN,J.TSNOW,J.TMOON],o=0;o<t;o++){var h=0;if(i>0){l=r.length;h=r[d=F()%l],i--,r.splice(d,1)}else if(n>0){var l=a.length,d=F()%l;h=a[d],n--,a.splice(d,1)}this.mapData.towerType.push(h)}}},randomMoney:function(e){null==this.mapData.towerType&&this.randomTowers(e);for(var t=this.mapData.towerType.length,i=0,n=0;n<t;n++){var s=this.mapData.towerType[n];e||(this.mapData.nMoney+=this.formTowerGetValue(s,1)),i+=this.formTowerGetValue(s,2)}e?this.mapData.nMoney=this.curMapLevel.nMoney:this.mapData.nMoney/=t,this.hardPercent*=i/t},setNextLevelItem:function(e){if(!this.isAchievement()){this.m_nTowerCount=0,this.m_nPassCount++,this.randomNewLevel(),this.mapData.towerType&&(this.mapData.towerType=null),this.setCurMapConfig(1);var t=this.m_pLevelsData[this.m_nCurLevelIndex],i=wr.getModel();i.curLevel=t.getMapIndex(),i.curTheme=i.mapConfig.allLevels[i.curLevel-1].nTheme}},setDownLevelItem:function(){var e=wr.getModel();e.m_bFeast&&e.m_oFeast.getCurFeastType()==ln?this.m_bProtected=!0:this.m_nPassCount!=this.m_nSaveStoreyLevel+1?(this.m_nPassCount-=this.m_nFailedCount,this.m_nPassCount<1&&(this.m_nPassCount=0),this.m_nPassCount<=this.m_nSaveStoreyLevel&&(this.m_nPassCount=this.m_nSaveStoreyLevel,this.m_bProtected=!0),this.setNextLevelItem(!0)):this.m_bProtected=!0},setCurMapConfig:function(e){this.m_nGiveCount=0,this.m_nGiveType=$.UNKNOWBB,this.m_nPackageType=_e.UNKNOWPT;var t=this.m_pLevelsData[this.m_nCurLevelIndex];switch(t.getLevelStyle()){case xn:case Dn:case Rn:t.playCurLevel(t.getConfigIndex()+1,e);break;case In:i=this.m_nDMapConfigs.length;t.playCurLevel(this.m_nDMapConfigs[F()%i],e);break;case On:var i=this.m_nSMapConfigs.length;t.playCurLevel(this.m_nSMapConfigs[F()%i],e)}},getRandomMapMode:function(){for(var e=[10,20,30,40,50,55,60,65,70,75,80,85,90,95,99],t=e.length,i=0;i<t;i++)if(this.m_nPassCount==e[i])return Rn;var n=F()%100+1,s=On;return n>75&&n<91&&(s=In),s},getMoneyRandomPer:function(){var e=F()%100;return e<60?(F()%100+50)/50:e>95?(F()%300+100)/50:(F()%100+100)/50},fromRoadLenGetHard:function(e){return e/70<10?.6:e/70<15?.7:e/70<20?.8:e/70<25?.9:e/70<30?1:1-(1400-e)/70*.01},fromCurveCountGetHard:function(e){return e<5?.6:e<6?.65:e<8?.7:e<10?.8:e<12?.9:1},fromDropMoneyGetHard:function(e){return e<2e3?.7:e<3e3?.8:e<4e3?.9:e<5e3?1:e<6e3?1.05:e<8e3?1:e<1e4?.95:e<15e3?.9:e<2e4?.85:.8},fromTowerPlaceGetHard:function(e){return e<3?.9:e<5?.95:1},fromGiveTowerGetHard:function(e){return e<500?.85:e<1e3?.9:e<1500?1:e<2e3?1.1:1.2},fromLevelModeGetHard:function(e){var t=1;switch(e){case On:case Rn:t=1;break;case In:t=.65;break;case Dn:t=1.1;break;case xn:t=1}return t},formTowerGetValue:function(e,t){void 0==t&&(t=1);var i=100;switch(e){case J.TBOTTLE:i=1==t?280:1;break;case J.TSHIT:i=1==t?340:.8;break;case J.TSTAR:i=1==t?380:.95;break;case J.TSUN:i=1==t?440:1.4;break;case J.TBALL:i=1==t?480:1.3;break;case J.TICEFAN:i=1==t?380:1.7;break;case J.TMOON:i=1==t?440:2.3;break;case J.TFLASHLIGHT:i=1==t?580:1.3;break;case J.TARROW:i=1==t?480:1.4;break;case J.TROCKET:i=1==t?540:1.5;break;case J.TPLANE:i=1==t?540:1.4;break;case J.TFISH:i=1==t?440:1.4;break;case J.TANCHOR:i=1==t?440:1.13;break;case J.TCUTTLE:i=1==t?700:1.45;break;case J.TMAGNET:i=1==t?300:1.88;break;case J.TSNOW:i=1==t?480:1.38;break;case J.TFIREBOTTLE:i=1==t?420:1.14;break;case J.TBOOMERANG:i=1==t?280:1.25;break;case J.TPIN:i=1==t?320:1.1;break;case J.TBLUESTAR:i=1==t?320:1.95;break;default:i=1==t?150:1}return i},formTowerGroupGetValue:function(){},fromCreepTypeGetHard:function(e){var t=1;return e==J.FTM?t=1.2:e>J.LM3&&e<J.FTM?t=.7:e>J.FTM&&e<J.BMT?t=.7:e==J.SBFL1||e==J.SBFL2?t=.01:e==J.SBFT?t=.015:e>=J.SBL1&&e<=J.SBL3?t=.012:e==J.SBB?t=.025:e>=J.BMT&&(t=.0075),t},fromWaveCountGetHard:function(e){return 1},fromHPPerGetHard:function(){var e=this.curMapLevel.fObjectHP;return e=e<=1?1:e<1.5?.95:e<2?.9:e<2.5?.85:e<3?.8:.7},setBossTestLevel:function(){var e=[10,20,30,40,50,55,60,65,70,75,80,85,90,95,99];this.m_nPassCount=e[14];for(var t=this.m_pLevelsData.length,i=[],n=0,s=0;s<t;s++)this.m_pLevelsData[s].getLevelStyle()>=Rn&&(i[n]=s,n++);this.m_nCurLevelIndex=i[14]},setRandomTestLevel:function(){},getCurSystemTime:function(){var e=Ql.getSvrDate();return Math.floor(e.getTime()/1e3)},setMaxtier:function(e){this._maxtier=e||150},getMaxtier:function(){return this._maxtier}}),Ia=Zs.extend({addChildItems:function(){var e=wr.getModel(),t=.5;nr.share().isIPad()&&(t=1);var i=e.m_oHigher.getDownLimite(),n=e.m_oHigher.getPassCount(),s=null;(s=new l.Sprite("floor_balloon_buybg.png")).setPosition(410*t,275*t),this.spMainFrame.addChild(s);var r=this.createPriceSpr(500);if(r.setAnchorPoint(.5,.5),r.setPosition(s.width-260,.5*s.height),s.addChild(r),0==i||i<=n-11){var a=this.spMainFrame.getBoundingBox(),o=this.menuItemWithFile1("btn_green_m.png","btn_green_m.png",null,"floor_btn_buy.png","floor_btn_buyed.png",1e3,l.p(.695*a.width,.35*a.height),1.1);(d=new l.Menu(o,null)).setPosition(0,0),d.setTag(999),this.spMainFrame.addChild(d,99),0!=i?((c=new l.Sprite("floor_balloon_protected.png")).setPosition(568*t,124*t),this.spMainFrame.addChild(c),this.showBuyProtetFloor(c)):o.setPosition(.695*a.width,.35*a.height)}else{var a=this.spMainFrame.getBoundingBox(),h=new l.Sprite("btn_green_m.png");h.setAnchorPoint(.5,.5),h.setPosition(.695*a.width,.35*a.height),this.spMainFrame.addChild(h,99),(h=new l.Sprite("btn_green_m.png")).setAnchorPoint(.5,.5),h.setPosition(.695*a.width,.35*a.height),this.spMainFrame.addChild(h,99);var o=this.menuItemWithFile1("btn_green_m.png","btn_green_m.png",null,"floor_btn_buyed.png",null,1001,l.p(.695*a.width,.35*a.height),1.1),d=new l.Menu(o,null);d.setPosition(0,0),d.setTag(999),d.setEnabled(!1),this.spMainFrame.addChild(d,99);var c=new l.Sprite("floor_balloon_protected.png");c.setPosition(568*t,124*t),this.spMainFrame.addChild(c),this.showBuyProtetFloor(c)}},createPriceSpr:function(e){var t=new l.Sprite("shop_gem.png");t.setAnchorPoint(0,.5),t.setScale(1.3);var i=t.getContentSize(),n=new l.LabelAtlas(e,"num_white_18.png",18,30,"./0123456789");n.setAnchorPoint(0,.5),n.setScale(1.3),i.width+=n.width;var s=new l.Node;return s.setContentSize(i),t.setPosition(0,.5*i.height),n.setPosition(t.width+20,.5*i.height),s.addChild(t),s.addChild(n),s},loadResources:function(){},changeStoneCount:function(){},showProtetFloorNum:function(e){var t=wr.getModel(),i=.5;nr.share().isIPad()&&(i=1);var n=0,s=null,r=new l.LabelAtlas("00","floor_btn_num.png",20*i,40*i,"0123456789");n=10*parseInt((t.m_oHigher.getPassCount()-1)/10),s=String.formatC("%d",n);var a=t.m_oHigher.getPassCount()>99?128*i:140*i;r.setPosition(a,30*i),r.setString(s),e.addChild(r)},showBuyProtetFloor:function(e){var t=wr.getModel(),i=.5;nr.share().isIPad()&&(i=1);var n=t.m_oHigher.getDownLimite(),s=String.formatC("%d",n),r=new l.LabelAtlas("00","floor_balloon_protected_num.png",16*i,30*i,"0123456789");r.setAnchorPoint(.5,0),r.setString(s);var a=GamePlatform.isCN()?160:194;r.setPosition(a,10),e.addChild(r)},menuItemWithFile1:function(e,t,i,n,s,r,a,o){var h=new l.Sprite("#"+e),d=new l.Sprite("#"+n);d.setPosition(0,0),d.setAnchorPoint(0,0),null!=s&&this.showProtetFloorNum(d);var c=new l.Sprite("#"+t),u=new l.MenuItemSprite(h,c,null,this,this.menuCallback.bind(this));return u.addChild(d),h.setAnchorPoint(.5,.5),h.setPosition(.5*u.width,.5*u.height),c.setAnchorPoint(.5,.5),c.setPosition(.5*u.width,.5*u.height),c.setScale(1.1),u.setTag(r),u.setPosition(a),u},menuCallback:function(e){switch(e.getTag()){case 1e3:var t=wr.getModel(),i=t.usersData.getDiamond(),n=t.usersData.getConsumePropPrice(1004);if(0!=n&&void 0!=n||(n=500),i<n){var s=this;return void(t.usersData.enablepay?qu.loadResAsync(Wi,function(){var e=aa.create();s.addChild(e,100,998),e.setParent(s,br),e.setShowDescription1(ea)}):ju.showLiteralsTip(b.Dialog_Hint))}Ql.buyPropById(1004,0,i,function(e){e&&e.dm&&t.usersData.setDiamond(e.dm),t.m_oHigher.saveDownLimite(),t.selLayer.buyStayFloor()})}}});Ia.create=function(){return Qs(Ia,Ks.DT_TITLE)};var Ra=Zs.extend({mLayer1:null,mLayer2:null,spTab:null,mMoveLength:0,listener:null,stageType:Le.NORMALMODE,isShow:!1,_className:"LevelInfoDlg",showLayer:1,_taskList:null,ctor:function(){var e=wr.getModel();this.stageType=Le.NORMALMODE,(e.m_nGameMode==ge.DOUBLECARROT||e.curLevel>135)&&(this.stageType=e.m_nGameMode==ge.DOUBLECARROT?Le.DOUBLECARROT:Le.MANORMODE),this._super(Ks.DT_TITLE)},addChildItems:function(){this.registerWithTouchDispatcher();var e=.5;nr.share().isIPad()&&(e=1),this.spTab=new l.Sprite("#stageinfo_rollover_bg.png"),this.spTab.setPosition(11*e,394*e),this.spMainFrame.addChild(this.spTab,0);var t=wr.getModel(),i=t.usersData.getUsedStar(),n=this.spMainFrame.getBoundingBox(),s=this.menuItemWithFile("#btn_green_b.png","#btn_green_b_pressed.png","#stageinfo_btn_start.png",D,l.p(.5*n.width,.18*n.height)),r=new l.Sprite(String.formatC("#stageinfo_btn_start_%d.png",i));r.setPosition(0,0),r.setAnchorPoint(0,0),s.addChild(r);var a=new l.Menu(s);a.setPosition(0,0),this.spMainFrame.addChild(a,5),this.isShow=!0,this.addLayer1(),this.addLayer2();var o=t.usersData,h=this;this.SetShowLayer(h.showLayer),this.showCurLevelTaskStatus();var d=t.usersData.getTaskHonor(t.curLevel,0);dp&&!d?Ql.getstagedata(t.curLevel,h.stageType,function(e){h.isShow=!0,h.SetShowLayer(h.showLayer);var i=e.sd;i&&(i.t1&&(o.setLevelFinishTask(t.curLevel,1,0),h.changeSprFrame(h._taskList[0])),i.t2&&(o.setLevelFinishTask(t.curLevel,2,0),h.changeSprFrame(h._taskList[1])),i.t3&&(o.setLevelFinishTask(t.curLevel,3,0),h.changeSprFrame(h._taskList[2])),i.ac&&o.setLevelClearHonor(t.curLevel)),h.showCurLevelStatus()}):this.showCurLevelStatus()},changeSprFrame:function(e){if(e){e.removeAllChildren();var t=l.spriteFrameCache.getSpriteFrame("stageinfo_mission_checked.png");t&&e.setSpriteFrame(t)}},loadResources:function(){var e=wr.getModel().usersData.m_nLanguage,t=String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",e,e);qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.plist",e,e)),qu.addRes(this,String.formatC("res/Themes/LevelSelect/LevelSel02-hd.plist")),qu.addRes(this,t)},addLayer1:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel(),i=t.usersData,n=nr.share().getWinSize();this.mLayer1=new l.Layer,this.addChild(this.mLayer1,2);var s=new l.Sprite("#stageinfo_rollover_mission.png");s.setPosition(n.width/2-398*e,n.height/2+120*e),this.mLayer1.addChild(s,0),t.curLevel<136?i.setLastPlayedLevel(t.curLevel):t.curLevel>135&&t.curLevel<156&&(i.setTempleLastPlayedLevel(t.curLevel),t.usersData.setCarrotFigure(ue.CARROT_GIRL));var r=t.mapConfig.allLevels[t.curLevel-1];if(r){t.curLevel<136?i.xOffsetLevelSel=r.ptLevelNum.x:t.curLevel>135&&t.curLevel<156?i.xOffsetLevelSelCircle=r.ptLevelNum.x:t.curLevel>155&&t.curLevel<mr&&(i.xOffsetLevelSelDouble=r.ptLevelNum.x),qu.addRes(this,String.formatC("res/Themes/Theme%lu/BG-hd.plist",10==r.nTheme?1:r.nTheme));var a=new l.Sprite(String.formatC("#BG%lu.png",10==r.nTheme?1:r.nTheme)),o=a.getTextureRect();a.setTextureRect(l.rect(o.x+88*e,o.y,960*e,590*e)),a.setScale(.471),a.setAnchorPoint(0,0),a.setPosition(n.width/2-218*e,n.height/2+5*e),this.mLayer1.addChild(a);var h=String.formatC("res/Themes/Maps/BG%02lu-hd.plist",t.curLevel);qu.addRes(this,h);var d=t.usersData.m_nLanguage;h=String.formatC("res/Themes%s/Maps/BG%02lu-hd%s.plist",d,t.curLevel,d),qu.addRes(this,h),h=String.formatC("Path%lu.png",t.curLevel);var c=l.spriteFrameCache.getSpriteFrame(h),u=new l.Sprite(c),p=u.getTextureRect();if(u.isTextureRectRotated()){var m=l.rect(p.x,p.y+88*e,590*e,960*e);u.setRotation(-90),u.setTextureRect(m),u.setAnchorPoint(.5,.5),u.setPosition(a.width/2-(640*e-p.height)/2,a.height/2)}else u.setTextureRect(l.rect(p.x+88*e,p.y,960*e,p.height-50*e)),u.setAnchorPoint(0,0),u.setPosition(l.p(0,(a.height-u.height)/2));a.addChild(u);var _=new l.Sprite("#stageinfo_mapbg_over.png");_.setPosition(n.width/2-263*e,n.height/2-16*e),_.setAnchorPoint(0,0),this.mLayer1.addChild(_),dp||this.showCurLevelStatus();var g=null;(g=0!=r.nBossModeSecond?new l.Sprite("#stageinfo_stagenum_boss.png"):r.bPresentGate?new l.Sprite("#stageinfo_stagenum_gate.png"):new l.Sprite("#stageinfo_stagenum_adv.png"))&&(g.setPosition(n.width/2-295*e,n.height/2+170*e),this.mLayer1.addChild(g));var T=new l.Sprite("#stageinfo_stagenum_bg.png");if(T.setPosition(n.width/2-295*e,n.height/2+170*e),this.mLayer1.addChild(T),t.curLevel>135&&t.curLevel<mr){var f=t.curLevel>=135&&t.curLevel<=155,S=f?135:155,w=new l.Sprite(f?"themenum_d.png":"themenum_q.png");w.setPosition(n.width/2-312*e,n.height/2+214*e),this.mLayer1.addChild(w),(v=new l.LabelAtlas("00","num_white_18.png",18*e,30*e,"./0123456789")).setString(String.formatC("%.2lu",t.curLevel-S)),v.setPosition(n.width/2-284*e,n.height/2+214*e),v.setAnchorPoint(.5,.5),this.mLayer1.addChild(v)}else if(t.curLevel<136&&t.curLevel>0){var v=new l.LabelAtlas("00","num_white_18.png",18*e,30*e,"./0123456789");v.setString(String.formatC("%.2lu",t.curLevel)),v.setPosition(n.width/2-296*e,n.height/2+214*e),v.setAnchorPoint(.5,.5),this.mLayer1.addChild(v)}if(0!=r.nBossModeSecond){(L=new l.Sprite("#stageinfo_ins_boss.png")).setPosition(n.width/2,n.height/2-45*e),this.mLayer1.addChild(L);M=String.formatC("%lu",r.nBossModeSecond);(C=new l.LabelAtlas("00","num_white_18.png",18*e,30*e,"./0123456789")).setString(M),C.setPosition(n.width/2-84*e,n.height/2-58*e),this.mLayer1.addChild(C)}else if(r.bPresentGate)(L=new l.Sprite("#stageinfo_ins_gate.png")).setPosition(n.width/2,n.height/2-45*e),this.mLayer1.addChild(L);else{var L=new l.Sprite("#stageinfo_ins_adv.png");L.setPosition(n.width/2,n.height/2-45*e),this.mLayer1.addChild(L);var M=String.formatC("%lu",r.nWaves),C=new l.LabelAtlas("00","num_white_18.png",18*e,30*e,"./0123456789");C.setString(M),C.setAnchorPoint(.5,.5),C.setPosition(n.width/2-105*e,n.height/2-44*e),this.mLayer1.addChild(C)}var y=r.towerType.length,B=56*y*e+6*(y-1)*e,F=n.width/2-B/2,E=n.height/2-102*e,P=[];P.push(t.getMapPath());for(var b in r.towerType){var A=r.towerType[b];if(A){var O=t.gameObjectConfig.towerGroup[A];if(O){var I=O.strPicGroup,R=l.path.changeExtname(I,".png");P.push(I),P.push(R);var D=String.formatC("stower_%s.png",O.strName),x=l.spriteFrameCache.getSpriteFrame(D);if(x){var N=new l.Sprite(x);N&&(N.setPosition(F+28*e,E),this.mLayer1.addChild(N))}}}F+=62*e}qu.perloadResAsync(P)}},showCurLevelStatus:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel(),i=t.usersData,n=nr.share().getWinSize(),s=n.width/2-40*e;if(i.getTaskHonor(t.curLevel)){var r=new l.Sprite("stageinfo_cup_mission.png");r.setPosition(s,n.height/2+60*e),this.mLayer1.addChild(r)}if(s+=138*e,i.getClearHonor(t.curLevel)){var a=new l.Sprite("stageinfo_cup_clear.png");a.setPosition(s,n.height/2+60*e),this.mLayer1.addChild(a)}s+=138*e;var o=null;switch(i.getFirstHonor(t.curLevel)){case 1:o=new l.Sprite("stageinfo_cup_wood.png");break;case 2:o=new l.Sprite("stageinfo_cup_silver.png");break;case 3:o=new l.Sprite("stageinfo_cup_gold.png")}o&&(o.setPosition(s,n.height/2+60*e),this.mLayer1.addChild(o))},addLayer2:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel(),i=nr.share().getWinSize();this.mLayer2=new l.Layer,this.addChild(this.mLayer2,2);var n=new l.Sprite("#stageinfo_rollover_info.png");n.setPosition(i.width/2-398*e,i.height/2+120*e),this.mLayer2.addChild(n,0);var s=new l.Sprite("#stageinfo_title_mission.png");s.setPosition(i.width/2,i.height/2+234*e),this.mLayer2.addChild(s),dp||this.showCurLevelTaskStatus();var r=new l.Sprite("#sepline.png");r.setPosition(i.width/2+2*e,i.height/2-124*e),this.mLayer2.addChild(r);var a=new l.Sprite("#stageinfo_stagenum_bg.png");if(a.setPosition(i.width/2-295*e,i.height/2+170*e),this.mLayer2.addChild(a,1),t.curLevel>135&&t.curLevel<mr){var o=t.curLevel>135&&t.curLevel<156,h=o?135:155,d=new l.Sprite(o?"themenum_d.png":"themenum_q.png");d.setPosition(i.width/2-312*e,i.height/2+214*e),this.mLayer2.addChild(d,1),(c=new l.LabelAtlas("00","num_white_18.png",18*e,30*e,"./0123456789")).setString(String.formatC("%.2lu",t.curLevel-h)),c.setPosition(i.width/2-284*e,i.height/2+214*e),c.setAnchorPoint(.5,.5),this.mLayer2.addChild(c,1)}else{var c=new l.LabelAtlas("00","num_white_18.png",18*e,30*e,"./0123456789");c.setString(String.formatC("%.2lu",t.curLevel)),c.setPosition(i.width/2-296*e,i.height/2+214*e),c.setAnchorPoint(.5,.5),this.mLayer2.addChild(c,1)}},showCurLevelTaskStatus:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel(),i=nr.share().getWinSize(),n=t.mapConfig.allLevels[t.curLevel-1];if(n){var s=t.usersData.getFinishTask(t.curLevel),r=i.width/2-228*e,a=l.spriteFrameCache.getSpriteFrame("stageinfo_mission_bg.png"),o=n.tasks,h=0;if(o&&(h=o.length)>0){this._taskList=[];for(var d=0;d<h;d++){var c=new l.Sprite(a);c.setPosition(r,i.height/2+40*e),this.mLayer2.addChild(c),0==c.width&&(c.width=230),0==c.height&&(c.height=300),r+=c.width;var u=o[d];if(u){var p=String.formatC("micon_b%lu.png",u.nImgIndex),m=l.spriteFrameCache.getSpriteFrame(p);if(m){var _=new l.Sprite(m);_.setPosition(c.width/2,c.height/2+84*e),c.addChild(_)}var g=String.formatC("micon_s%lu.png",u.nMissionNum),T=l.spriteFrameCache.getSpriteFrame(g);if(T){var f=new l.Sprite(T);f.setPosition(c.width/2,c.height/2+84*e),c.addChild(f)}var S=String.formatC("mission%lu_%d.png",t.curLevel,d+1),w=l.spriteFrameCache.getSpriteFrame(S);if(w){var v=new l.Sprite(w);v.setPosition(c.width/2,c.height/2+8*e),c.addChild(v)}}var L=1&s,M=new l.Sprite(L?"stageinfo_mission_checked.png":"ingame_stone.png");if(M.setPosition(c.width/2,c.height/2-90*e),c.addChild(M),this._taskList.push(M),!L){var C=String.formatC("#ingame_mission_add%ld.png",u.getGoldCoins()),y=new l.Sprite(C);if(y.setPosition(80*e,30*e),M.addChild(y),M){var B=M.getContentSize(),F=new l.Sprite("shop_gem.png");F.setAnchorPoint(l.p(.5,.5)),F.setScale(1.37),F.setPosition(l.p(41,.5*B.height)),M.addChild(F)}}s>>=1}}l.addTimePoint("LevelInfoDlg_e"),l.printTimePoint("LevelInfoDlg_s","LevelInfoDlg_e")}},SetShowLayer:function(e){this.showLayer=e,this.isShow&&(1==e?(this.mLayer1.setVisible(!0),this.mLayer2.setVisible(!1)):(this.mLayer1.setVisible(!1),this.mLayer2.setVisible(!0)))},changeStoneCount:function(){},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),this.removeAllChildren(),qu.clearOwner(this),this._super()},menuCallback:function(e){var t=e.getTag(),i=wr.getModel();switch(i.playSoundWithType($.MTPAGESELECT),t){case D:l.addTimePoint("start_battle_s");var n=i.usersData.getBanallpayTime();if(n.r)return void ju.alert(i.usersData.banallPayReason);if((n=i.usersData.getZeroearningsTime()).result){var s=this,r=i.usersData.zeroearningsReason;return void ju.showConfirm(r,function(e){e==sa&&s.enterBattle()}.bind(s))}this.enterBattle()}},enterBattle:function(){var e=wr.getModel();if(e.usersData.canPlay())e.usersData.userEnter(),qi.preloadWithGameScene(),e.playMuiscWithType($.MTSTARTBGMSC,2);else{var t=this;l.addTimePoint("LifeRequestDlg_s"),qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(2),t.addChild(e,99,199)})}},menuItemWithFile:function(e,t,i,n,s,r){r=r||1;var a=new l.Sprite(e),o=new l.Sprite(i);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o);var h=new l.Sprite(t),d=new l.Sprite(i);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d);var c=new l.MenuItemSprite(a,h,null,this,this.menuCallback.bind(this));return c.setTag(n),c.setPosition(s),c},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return this.mMoveLength=0,!0},ccTouchEnded:function(e,t){var i=this.spMainFrame.convertTouchToNodeSpace(e),n=wr.getModel(),s=this.spTab.getContentSize(),r=l.rect(this.spTab.x-s.width/2,this.spTab.y-s.height/2,s.width,s.height);l.rectContainsPoint(r,i)&&(n.playSoundWithType($.MTPAGESELECT),this.mLayer1.isVisible()?(this.mLayer1.setVisible(!1),this.mLayer2.setVisible(!0)):(this.mLayer1.setVisible(!0),this.mLayer2.setVisible(!1)))},ccTouchMoved:function(e,t){var i=this.spMainFrame.convertTouchToNodeSpace(e),n=e.getPreviousLocationInView();n=l.director.convertToGL(n),n=this.convertToNodeSpace(n);var s=l.pSub(i,n);this.mMoveLength+=-s.x}});Ra.create=function(){return new Ra};var Da=100,xa={BTN_CHANGE:0,LIFE_FOREVER_GO_BUY:1,LIFE_10_GO_BUY:2,IAP_RESTORE:3,MENU_VEDIO_LIFE:4,MENU_VEDIO_LIFE2:5},Na=Zs.extend({mLayer1:null,mLayer2:null,spJewelsChangeTab:null,spAskTab:null,spBuy:null,spStoneShop:null,labelMin:null,labelSec:null,life10:null,life_forever:null,life_forever2:null,spLuoboBg_dazhe:null,DisGM:0,DisGS:0,LifeForeverPCut:0,mMoveLength:0,listener:null,lifeBtn:null,userDimLabel:null,_Customlistener:null,ctor:function(){this._super(Ks.DT_TAB),this.addLayerName("dlg-LifeRequest")},addChildItems:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=new l.Sprite("life_stone_bg.png");t.setPosition(280*e,520*e),this.addChild(t,99),this.userDimLabel=new l.LabelAtlas("","num_white_18.png",18*e,30*e,"./0123456789"),this.userDimLabel.setPosition(56,42),t.addChild(this.userDimLabel),this.addLayer2(),this.registerWithTouchDispatcher(!0),wr.getModel().vedioLayer=this,this.addCustomListener(),l.addTimePoint("LifeRequestDlg_e"),l.printTimePoint("LifeRequestDlg_s","LifeRequestDlg_e")},loadResources:function(){qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/lifeReques.plist",GamePlatform.isCN()?"":"_en"))},addCustomListener:function(){var e=this;this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this._Customlistener=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"diamondChange",callback:function(t){e.changeStoneCount()}}),l.eventManager.addListener(this._Customlistener,1)},changeStoneCount:function(){var e=wr.getActivedModel(),t=String.formatC("%lu",e.usersData.getDiamond());this.spStoneShop&&this.spStoneShop.changeStoneCount(),this.userDimLabel&&this.userDimLabel.setString(t)},onExit:function(){wr.getModel().vedioLayer=null,this.listener&&l.eventManager.removeListener(this.listener),this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this.removeAllChildren(),qu.clearOwner(this),this._super()},addLayer1:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel();this.mLayer1=new l.Layer,this.mLayer1.setPosition(this.spMainFrame.width/2-this.mLayer1.width/2,this.spMainFrame.height/2-this.mLayer1.height/2),this.spMainFrame.addChild(this.mLayer1,2,2);var i=null;(i=new l.Sprite(t.m_nGameMode==ge.HIGHERMODE?"getlife_stone_floor_50.png":"getlife_stone.png")).setPosition(this.mLayer1.width/2,this.mLayer1.height/2+70*e),this.mLayer1.addChild(i);var n=new l.Sprite("stone_amountbg.png");n.setPosition(this.mLayer1.width/2-150*e,this.mLayer1.height/2-70*e),this.mLayer1.addChild(n);var s=this.menuItemWithFile("stone_add.png",R,l.p(this.mLayer1.width/2-74*e,this.mLayer1.height/2-70*e),null),r=new l.Menu(s);r.setPosition(0,0),this.mLayer1.addChild(r,99);var a=String.formatC("%lu",t.usersData.getDiamond());this.lableStoneCount=new l.LabelAtlas("0000","num_white_18.png",18*e,30*e,"./0123456789"),this.lableStoneCount.setString(a.toString()),this.lableStoneCount.setPosition(this.mLayer1.width/2-186*e,this.mLayer1.height/2-85*e),this.mLayer1.addChild(this.lableStoneCount,111,111);for(var o=t.usersData.getGameStars(),h=this.mLayer1.width/2+66*e,d=1,c=t.m_nGameMode===ge.HIGHERMODE,u=0;u<5;u++){var p=null;(p=o>u?new l.Sprite(c?"floor_lifestar_active.png":"lifestar_active.png"):new l.Sprite(c?"floor_lifestar_disable.png":"lifestar_disable.png")).setPosition(h,this.mLayer1.height/2-70*e),p.setTag(d),this.mLayer1.addChild(p),h+=45*e,d+=1}var m=new l.Sprite(c?"stagemap_toolbar_floor.png":"stagemap_toolbar_overten.png");m.setAnchorPoint(0,0),m.setPosition(412*e,128*e),m.setTag(766),this.spMainFrame.addChild(m);var _=this.mLayer1.getChildByTag(985);if(null==_&&(_=new l.LabelAtlas(String.formatC("%03lu",o).toString(),"num_white_18.png",18*e,30*e,"./0123456789"),(_=new l.LabelAtlas(String.formatC("%03lu",o).toString(),"num_white_18.png",18*e,30*e,"./0123456789")).setPosition(190*e,64*e),m.addChild(_,1,11)),o>5){for(var d=1,u=0;u<5;u++){var g=this.mLayer1.getChildByTag(d);g&&g.setVisible(!1),d+=1}m.setVisible(!0),_.setVisible(!0)}else m.setVisible(!1),_.setVisible(!1);var T=new l.Sprite("sepline.png");T.setPosition(this.mLayer1.width/2+2*e,this.mLayer1.height/2-122*e),this.mLayer1.addChild(T);var f=this.spMainFrame.getBoundingBox(),S=this.menuItemWithFile1("btn_blue_m.png","btn_blue_m_pressed.png","getlife_get_disable.png","getlife_get.png",xa.BTN_CHANGE,l.p(.5*f.width,.18*f.height),null),w=new l.Menu(S);w.setPosition(0,0),w.setTag(999),this.spMainFrame.addChild(w,99);var v=this;qu.loadResAsync(Ti,function(){v.spStoneShop=Wa.create(),v.spStoneShop.setPosition(0,-1800*e),v.spStoneShop.spTopFrame=v.spMainFrame,v.addChild(v.spStoneShop)})},addLayer2:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel();this.userDimLabel.setString(t.usersData.getDiamond());var i=nr.share().getWinSize();this.mLayer2=new l.Layer,this.addChild(this.mLayer2,2);var n=null,s=t.usersData.getLifeForeverPCutTime();this.DisGM=s.m,this.DisGS=s.s,this.LifeForeverPCut=s.result,(n=new l.Sprite("unlimited_newbg.png")).setPosition(i.width/2,i.height/2),n.setTag(11247),this.mLayer2.addChild(n);this.lifeBtn=this.menuItemWithFile1("btn_green_m.png","btn_green_m_pressed.png","getlife_get_disable.png",null,xa.LIFE_10_GO_BUY,l.p(597*e,113*e),null);var r=new l.Menu(this.lifeBtn);if(r.setPosition(0,0),r.setTag(777),n.addChild(r,77),t.usersData.isStarFull())this.lifeBtn.setEnabled(!1);else{var a=this.createStarPrice(0);a.setAnchorPoint(.5,.5),a.setPosition(.5*this.lifeBtn.width,.5*this.lifeBtn.height),this.lifeBtn.addChild(a,1,100)}this.life10=this.menuItemWithFile1("btn_green_m.png","btn_green_m_pressed.png","getlife_get_disable.png",null,xa.BTN_CHANGE,l.p(227*e,113*e),null);var o=new l.Menu(this.life10);o.setPosition(0,0),o.setTag(888),n.addChild(o,88),t.usersData.isStarFull()?this.life10.setEnabled(!1):((a=this.createStarPrice(1)).setAnchorPoint(.5,.5),a.setPosition(.5*this.life10.width,.5*this.life10.height),this.life10.addChild(a,1,100)),this.LifeForeverPCut;this.LifeForeverPCut&&(this.spBuy&&this.spBuy.setPosition(557*e,152*e),this.labelMin=new l.LabelAtlas(String.formatC("%02lu",this.DisGM).toString(),"num_white_18.png",18*e,30*e,"./0123456789"),this.labelMin.setAnchorPoint(0,0),this.labelMin.setScale(.8),this.labelMin.setPosition(nr.share().getMapOffset().width+726*e,203*e),this.mLayer2.addChild(this.labelMin),this.labelSec=new l.LabelAtlas(String.formatC("%02lu",this.DisGS).toString(),"num_white_18.png",18*e,30*e,"./0123456789"),this.labelSec.setAnchorPoint(0,0),this.labelSec.setScale(.8),this.labelSec.setPosition(nr.share().getMapOffset().width+764*e,203*e),this.mLayer2.addChild(this.labelSec),this.schedule(this.UpdateDiscountTime,60))},createStarPrice:function(e){void 0==e&&(e=0);var t=wr.getModel(),i=new l.Sprite("shop_gem.png");i.setAnchorPoint(0,.5);var n=i.getContentSize(),s=t.getBuyStarPrice(e),r=new l.LabelAtlas(s,"themelocked_buy1.png",20,28,"./0123456789");r.setAnchorPoint(0,.5),n.width+=r.width;var a=new l.Sprite("shop_exchange.png");a.setAnchorPoint(0,.5),n.width+=a.width;var o=new l.Node;o.setContentSize(n),i.setPosition(0,.5*n.height),r.setPosition(i.width+2,.5*n.height);var h=r.x+r.width+1;return a.setPosition(h,.5*n.height),o.addChild(i),o.addChild(r),o.addChild(a),o},addToweStarsByAD:function(){for(var e=0;e<cr;e++)this.changeStar();var t=wr.getActivedModel();if(t){var i=t.usersData.getLifeStarPlayTimes()-t.usersData.YSLifeTimes;if(void 0==this.mLayer1)return;var n=this.mLayer1.getChildByTag(9999);if(n){var s=n.getChildByTag(xa.MENU_VEDIO_LIFE);if(s)if(i<1||!t.ys_FbyerReady)s.setVisible(!1);else{var r=String.formatC("lifestar_video_%d.png",i),a=s.getChildByTag(3);a&&a.setSpriteFrame(l.spriteFrameCache.getSpriteFrame(r))}}}},UpdateStars:function(e){if(void 0!=this.mLayer1){var t=.5;if(nr.share().isIPad()&&(t=1),e<=5){var i=wr.getModel(),n=l.spriteFrameCache.getSpriteFrame(i.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png");if(n){for(o=1;o<e;o++){var s=this.mLayer1.getChildByTag(o);s&&s.setSpriteFrame(n)}for(var r=this.mLayer1.getChildByTag(e),a=[],o=1;o<4;o++){var h=String.formatC((i.m_nGameMode==ge.HIGHERMODE?"floor_":"")+"lifestar_flash%d.png",o),d=l.spriteFrameCache.getSpriteFrame(h);d&&a.push(d)}a.push(n);var c=new l.Animation(a,.1);r&&r.runAction(l.animate(c))}}else{for(var u=1,o=0;o<5;o++)(r=this.mLayer1.getChildByTag(u))&&r.setVisible(!1),u+=1;var p=this.spMainFrame.getChildByTag(766);p&&(p.setVisible(!0),p.removeAllChildren());var m=this.mLayer1.getChildByTag(984);null==m&&p&&(m=new l.LabelAtlas(String.formatC("%03lu",e),"num_white_18.png",18*t,30*t,"./0123456789"),(m=new l.LabelAtlas(String.formatC("%03lu",e),"num_white_18.png",18*t,30*t,"./0123456789")).setPosition(190*t,64*t),p.addChild(m,1,11)),m&&m.setVisible(!0)}}},SetShowLayer:function(e){this.spJewelsChangeTab&&this.spJewelsChangeTab.setVisible(!1),this.spAskTab&&this.spAskTab.setVisible(!1),this.mLayer2.setVisible(!0);var t=this.spMainFrame.getChildByTag(999);t&&t.setVisible(!1);var i=.5;nr.share().isIPad()&&(i=1);var n=nr.share().getWinSize(),s=new l.Sprite("unlimited_single_title_new.png");s.setPosition(n.width/2,n.height/2+210*i),this.mLayer2.addChild(s)},UpdateDiscountTime:function(e){if(0==this.DisGM&&0==this.DisGS)return this.LifeForeverPCut=0,this.unschedule(this.UpdateDiscountTime),this.labelMin.removeFromParent(),this.labelSec.removeFromParent(),this.spLuoboBg_dazhe&&this.spLuoboBg_dazhe.removeFromParent(),void(this.life_forever&&(this.life_forever.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("unlimited_buy.png")),this.life_forever2.setSpriteFrame(l.spriteFrameCache.getSpriteFrame("unlimited_buy.png"))));0==this.DisGS?(this.DisGS=59,this.DisGM--,this.labelMin.setString(String.formatC("%02lu",this.DisGM))):this.DisGS--,this.labelSec.setString(String.formatC("%02lu",this.DisGS))},menuItemWithFile1:function(e,t,i,n,s,r,a){a=a||1;var o=new l.Sprite(e),h=new l.Sprite(n);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h),xa.LIFE_FOREVER_GO_BUY===s&&(this.life_forever=h);var d=new l.Sprite(t),c=new l.Sprite(n);c.setPosition(0,0),c.setAnchorPoint(0,0),d.addChild(c),xa.LIFE_FOREVER_GO_BUY===s&&(this.life_forever2=c);var u=new l.Sprite(i),p=new l.MenuItemSprite(o,d,u,this,this.menuCallback.bind(this));return p.setTag(s),p.setPosition(r),p},menuItemWithFile:function(e,t,i,n){var s=new l.Sprite(e),r=null;r=null==n?new l.Sprite(e):new l.Sprite(n);var a=new l.MenuItemSprite(s,r,null,this,this.menuCallback.bind(this));return a.setTag(t),a.setPosition(i),a},menuCallback:function(e){var t=wr.getModel(),i=this;switch(e.getTag()){case R:t.playSoundWithType($.MTPAGESELECT);var n=this.spMainFrame.getPosition(),s=l.moveTo(.1,n.x,n.y+30),r=l.moveTo(.2,n.x,n.y+670);this.spMainFrame.runAction(l.sequence(s,r));var a=l.moveTo(.2,0,-30),o=l.moveTo(.1,0,0),h=l.callFunc(function(){this.spStoneShop.showPrice()}.bind(this,this.spStoneShop));this.spStoneShop.runAction(l.sequence(a,o,h)),this.spStoneShop.registerWithTouchDispatcher();break;case xa.BTN_CHANGE:(t=wr.getModel()).life_show=!1;d=t.m_nGameMode==ge.HIGHERMODE?1005:1002;if(0!=(c=t.usersData.getConsumePropPrice(d))&&void 0!=c||(c=100),t.usersData.getDiamond()<c)return void this.addNoStoneDlg(ea);dp?Ql.buyPropById(d,1,t.usersData.getDiamond(),function(e){void 0!=e&&(ju.showLiteralsTip(b.Dialog_Hint4),e.dm&&t.usersData.setDiamond(e.dm),t.m_nGameMode==ge.HIGHERMODE?(e.sc&&t.m_oHigher.setStarCount(e.sc),e.laststartime&&t.m_oHigher.setWaitTime(e.laststartime)):(e.sc&&t.usersData.setStarCount(e.sc),e.laststartime&&t.usersData.setWaitTime(e.laststartime)),i.changeStoneCount(),i.upDateStars())}):i.changeStar();break;case xa.LIFE_FOREVER_GO_BUY:break;case xa.LIFE_10_GO_BUY:var d=t.m_nGameMode==ge.HIGHERMODE?1006:1003,c=t.usersData.getConsumePropPrice(d);if(0!=c&&void 0!=c||(c=800),t.usersData.getDiamond()<c)return void this.addNoStoneDlg(ea);d=t.m_nGameMode==ge.HIGHERMODE?1006:1003;Ql.buyPropById(d,1,t.usersData.getDiamond(),function(e){void 0!=e&&(ju.showLiteralsTip(b.Dialog_Hint4),e.dm&&t.usersData.setDiamond(e.dm),t.m_nGameMode==ge.HIGHERMODE?(e.sc&&t.m_oHigher.setStarCount(e.sc),e.laststartime&&t.m_oHigher.setWaitTime(e.laststartime)):(e.sc&&t.usersData.setStarCount(e.sc),e.laststartime&&t.usersData.setWaitTime(e.laststartime)),i.changeStoneCount(),i.upDateStars())});break;case xa.IAP_RESTORE:var u=Lo.create();this.mLayer2.addChild(u);break;case xa.MENU_VEDIO_LIFE:t.life_show=!0;break;case xa.MENU_VEDIO_LIFE2:t.life_show=!0;var p=this.mLayer2.getChildByTag(11247);p&&p.removeChildByTag(9119)}},NoStoneUpdate:function(){var e=this.spMainFrame.getPosition(),t=l.moveTo(.1,e.x,e.y+30),i=l.moveTo(.2,e.x,e.y+670);this.spMainFrame.runAction(l.sequence(t,i));var n=l.moveTo(.2,0,-30),s=l.moveTo(.1,0,0);this.spStoneShop.runAction(l.sequence(n,s))},buyStarFinish:function(){var e=wr.getModel();1==this.getParent().getTag()?this.getParent().UpdateStar(2):(e.m_nGameMode,ge.DOUBLECARROT,this.getParent().UpdateStar(2)),e.usersData.isStarFull()&&this.life10.setEnabled(!1)},changeStar:function(){var e=wr.getModel();if(!e.usersData.isStarFull()){e.usersData.getGameStars();!e.life_show&&e.usersData.getDiamond()<50?e.usersData.enablepay?this.addNoStoneDlg(ea):ju.alert(b.Dialog_Hint):(e.playSoundWithType($.MTPBUYITEM),e.m_nGameMode==ge.HIGHERMODE?Tt.onExchange("Star20",1):Tt.onExchange("Star50",1),this.changeStoneCount(),e.usersData.addPlayTimes(),dp||this.upDateStars())}},addNoStoneDlg:function(e){void 0==e&&(e=ea);var t=this.getChildByTag(998);if(null==t){var i=this;wr.getModel().usersData.enablepay?qu.loadResAsync(Wi,function(){var t=aa.create();i.addChild(t,100,998),t.setParent(i,Or),t.setShowDescription1(e),t.callback=function(e){i.changeStoneCount()}}):ju.showLiteralsTip(b.Dialog_Hint)}else t.setVisible(!0)},upDateStars:function(){var e=wr.getModel();if(1==this.getParent().getTag()?this.getParent().UpdateStar(2):e.m_nGameMode==ge.DOUBLECARROT?this.getParent().UpdateStar(2):e.m_nGameMode!=ge.CHALLENGEMODE&&this.getParent().UpdateStar(2),e.usersData.isStarFull()){var t=this.spMainFrame.getChildByTag(999);if(t){var i=t.getChildByTag(xa.BTN_CHANGE);i&&i.setEnabled(!1)}if(this.life10&&((n=this.life10.getChildByTag(100))&&n.setVisible(!1),this.life10.setEnabled(!1)),this.lifeBtn){var n=this.lifeBtn.getChildByTag(100);n&&n.setVisible(!1),this.lifeBtn.setEnabled(!1)}}},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){if(this.mMoveLength=0,this.mLayer2.isVisible()&&this.spBuy){var i=this.mLayer2.convertTouchToNodeSpace(e),n=this.spBuy.getContentSize(),s=l.rect(this.spBuy.x-n.width/2,this.spBuy.y-n.height/2,n.width,n.height);if(l.rectContainsPoint(s,i))return this.spBuy.setScale(1.1),!0}return!0},ccTouchEnded:function(e,t){var i=wr.getModel(),n=this.spMainFrame.convertTouchToNodeSpace(e);if(this.spJewelsChangeTab&&this.spJewelsChangeTab.isVisible()){var s=this.spJewelsChangeTab.getContentSize(),r=l.rect(this.spJewelsChangeTab.x-s.width/2,this.spJewelsChangeTab.y-s.height/2,s.width,s.height);if(l.rectContainsPoint(r,n))return i.playSoundWithType($.MTMENUSELECT),void this.SetShowLayer(1)}if(this.spAskTab&&this.spAskTab.isVisible()){var a=this.spAskTab.getContentSize(),o=l.rect(this.spAskTab.x-a.width/2,this.spAskTab.y-a.height/2,a.width,a.height);if(l.rectContainsPoint(o,n))return i.playSoundWithType($.MTMENUSELECT),void this.SetShowLayer(0)}if(this.mLayer1&&this.mLayer1.isVisible()){var h=.5;nr.share().isIPad()&&(h=1);var i=wr.getModel(),d=this.mLayer1.convertTouchToNodeSpace(e),c=(this.lableStoneCount.getContentSize(),l.rect(this.lableStoneCount.x-12*h,this.lableStoneCount.y,100*h,38*h));if(l.rectContainsPoint(c,d)){i.playSoundWithType($.MTPAGESELECT);var d=this.spMainFrame.getPosition(),u=l.moveTo(.1,d.x,d.y+30),p=l.moveTo(.2,d.x,d.y+670);this.spMainFrame.runAction(l.sequence(u,p));var m=l.moveTo(.2,0,-30),_=l.moveTo(.1,0,0),g=l.callFunc(function(){this.spStoneShop.showPrice()}.bind(this,this.spStoneShop));return void this.spStoneShop.runAction(l.sequence(m,_,g))}}if(this.mLayer2.isVisible()&&this.spBuy&&l.rectContainsPoint(this.spBuy.getBoundingBox(),n)){i.playSoundWithType($.MTPBUYITEM),this.spBuy.setScale(1);this.LifeForeverPCut}else;},ccTouchMoved:function(e,t){var i=this.convertTouchToNodeSpace(e),n=e.getPreviousLocationInView();n=l.director.convertToGL(n),n=this.convertToNodeSpace(n);var s=l.pSub(i,n);this.mMoveLength+=-s.x,(this.mMoveLength>=5||this.mMoveLength<=-5)&&this.spBuy&&this.spBuy.setScale(1)}});Na.create=function(){return new Na};var Ga={TAB_STONESHOP:1001,TAB_ADWALL:1002,TAB_RESTOREBUY:1003},Wa=Xs.extend({m_layer1:null,m_layer2:null,BG:null,bActiveShop:!1,bActiveAdWall:!1,productShop:null,productAdWall:null,bLockMenu:!1,spTopFrame:null,spStoneShopBg:null,spAdWallBg:null,m_product1:null,m_product2:null,m_product3:null,m_product4:null,listener:null,_Customlistener:null,ctor:function(){this._super(),this.addLayerName("scene-stoneshop")},init:function(){this._super();var e=.5;nr.share().isIPad()&&(e=1);var t=nr.share().getWinSize(),i=wr.getModel(),n=i.usersData.m_nLanguage,s=String.formatC("res/Themes%s/LevelSelect/Shop02-hd%s.plist",n,n);qu.addRes(this,s),this.BG=new l.Sprite("buystone_bg_new.png"),this.BG&&(this.BG.setPosition(.5*t.width,.5*t.height),this.addChild(this.BG,1,1));var r=new l.LabelAtlas("0000","num_brown_18.png",18*e,30*e,"./0123456789"),a=i.usersData.getDiamond();r.setString(String.formatC("%lu",a)),r.setPosition(465*e,456*e),r.setAnchorPoint(.5,.5),this.BG.addChild(r,10,10);var o=this.BG.getBoundingBox(),h=new l.Sprite("popup_close_frame.png"),d=l.p(.88*o.width,.9*o.height);h.setPosition(d),this.BG.addChild(h);var c=this.menuItemWithFile("popup_close.png",1e3,d),u=new l.Menu(c,null);u.setPosition(0,0),this.BG.addChild(u,99),this.AddLayer1();var p=new l.Sprite("buystone_title.png");return p.setPosition(424*e,579*e),this.BG.addChild(p),this.addCustomListener(),!0},addCustomListener:function(){var e=this;this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this._Customlistener=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"diamondChange",callback:function(t){e.changeStoneCount()}}),l.eventManager.addListener(this._Customlistener,1)},changeStoneCount:function(){var e=wr.getModel(),t=String.formatC("%lu",e.usersData.getDiamond()),i=this.BG.getChildByTag(10);i&&i.setString(t)},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e),a=null;a=null==n?new l.Sprite(e):new l.Sprite(n);var o=null;o=null==s?new l.Sprite(e):new l.Sprite(s);var h=new l.MenuItemSprite(r,a,o,this,this.menuCallback.bind(this));return h.setTag(t),h.setPosition(i),h},menuItemWithFile1:function(e,t,i,n,s){if(!(arguments.length<4)){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d}},changeMenuItemWithType:function(e,t,i){var n=null,s=t.getChildByTag(1);n=l.spriteFrameCache.getSpriteFrame(i),s.getChildByTag(1).setSpriteFrame(n);var r=t.getChildByTag(2);n=l.spriteFrameCache.getSpriteFrame(i),r.getChildByTag(1).setSpriteFrame(n)},menuCallback:function(e){if(1!=this.bLockMenu){var t=this.getChildByTag(2e3),i=e,n=wr.getModel();switch(i.getTag()){case Ga.TAB_RESTOREBUY:t&&t.requestRestorePurchases();break;case oe.DIAMOND_JIDI:this.buyDimBySDK(300);break;case oe.DIAMOND300:this.buyDimBySDK(1200);break;case oe.DIAMOND480:this.buyDimBySDK(2500);break;case oe.DIAMOND750:this.buyDimBySDK(5e3);break;case 1e3:if(this.spTopFrame){n.playSoundWithType($.MTMENUSELECT);var s=this.spStoneShopBg.getPosition(),r=l.moveTo(.1,0,-30),a=l.moveTo(.2,0,-1800);this.runAction(l.sequence(r,a));var o=l.moveTo(.2,s.x,s.y+30),h=l.moveTo(.1,s.x,s.y);this.spTopFrame.runAction(l.sequence(o,h))}else n.bLockMenu=!1,this.removeAllChildren();this.removeListener();break;case ae.ADWALL_A:case ae.ADWALL_B:case ae.ADWALL_C:this.bLockMenu=!0;break;case Ga.TAB_STONESHOP:this.m_layer2.setVisible(!1),this.m_layer1.setVisible(!0),i.setNormalImage(new l.Sprite(l.spriteFrameCache.getSpriteFrame("buystone_tab_buy_active.png"))),this.productAdWall.setNormalImage(new l.Sprite(l.spriteFrameCache.getSpriteFrame("buystone_tab_free_disable.png")));break;case Ga.TAB_ADWALL:this.m_layer2.setVisible(!0),this.m_layer1.setVisible(!1),i.setNormalImage(new l.Sprite(l.spriteFrameCache.getSpriteFrame("buystone_tab_free_active.png"))),this.productShop.setNormalImage(new l.Sprite(l.spriteFrameCache.getSpriteFrame("buystone_tab_buy_disable.png")))}}},showPrice:function(){this.registerWithTouchDispatcher();var e=this.getChildByTag(2e3);null==e&&(e=Ss.create(this),this.addChild(e,2e3,2e3)),e.setProductPrices()},buyDimBySDK:function(e){if(void 0!=e){if(lp){var t={num:e};console.log("pay :"+JSON.stringify(t)),SDKInterface.pay(t,function(e,t){console.log("SDKInterface.pay-code:"+e),GamePlatform.getCurrentPlatForm()!=PlatformType.QQ&&(t=0==e?"支付成功":"支付失败"),ju.showLiteralsTip(t),0==e&&Ql.getbalance(function(e){e.dm&&wr.getModel().usersData.setDiamond(e.dm)})})}}else ju.alert("请关闭面板重试！")},removeListener:function(){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null)},onExit:function(){this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this.removeAllChildren();wr.getModel();qu.clearOwner(this),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},setShowAdWall:function(){var e=nr.share().getWinSize(),t=l.color(0,0,0,178),i=new l.LayerColor(t);i&&(i.setPosition(0,0),i.setContentSize(e),this.addChild(i,0)),this.showPrice(),this.m_layer1.setVisible(!1),this.m_layer2.setVisible(!0),this.productAdWall.setNormalImage(new l.Sprite(l.spriteFrameCache.getSpriteFrame("buystone_tab_free_active.png"))),this.productShop.setNormalImage(new l.Sprite(l.spriteFrameCache.getSpriteFrame("buystone_tab_buy_disable.png")))},AddLayer1:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=nr.share().getWinSize();this.m_layer1=new l.Layer,this.m_layer1.setVisible(!0),this.addChild(this.m_layer1,1111,1111),this.spStoneShopBg=new l.Sprite("buystone_buy_new.png"),this.spStoneShopBg.setPosition(.5*t.width,.5*t.height),this.m_layer1.addChild(this.spStoneShopBg,2,2);var i=l.color(255,247,153),n=new l.LabelTTF("￥3.00","Arial",22*e);n.setPosition(186*e,298*e),n.setColor(i),this.spStoneShopBg.addChild(n,1,1),(n=new l.LabelTTF("￥12.00","Arial",22*e)).setPosition(520*e,298*e),n.setColor(i),this.spStoneShopBg.addChild(n,2,27),(n=new l.LabelTTF("￥25.00","Arial",22*e)).setPosition(186*e,116*e),n.setColor(i),this.spStoneShopBg.addChild(n,3,28),(n=new l.LabelTTF("￥50.00","Arial",22*e)).setPosition(520*e,116*e),n.setColor(i),this.spStoneShopBg.addChild(n,4,29);var s=this.menuItemWithFile("buystone_buy_normal.png",oe.DIAMOND_JIDI,l.p(254*e,334*e),"buystone_buy_pressed.png",null),r=this.menuItemWithFile("buystone_buy_normal.png",oe.DIAMOND300,l.p(586*e,334*e),"buystone_buy_pressed.png",null),a=this.menuItemWithFile("buystone_buy_normal.png",oe.DIAMOND480,l.p(254*e,152*e),"buystone_buy_pressed.png",null),o=this.menuItemWithFile("buystone_buy_normal.png",oe.DIAMOND750,l.p(586*e,152*e),"buystone_buy_pressed.png",null),h=new l.Menu(s,r,a,o);h.setPosition(0,0),this.spStoneShopBg.addChild(h,-1)},AddLayer2:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=nr.share().getWinSize();this.m_layer2=new l.Layer,this.m_layer2.setVisible(!1),this.addChild(this.m_layer2,2222),this.spAdWallBg=new l.Sprite("#buystone_free.png"),this.spAdWallBg.setPosition(.5*t.width,.5*t.height),this.m_layer2.addChild(this.spAdWallBg,2,2);var i=this.menuItemWithFile1("buystone_free_normal.png",ae.ADWALL_A,l.p(211*e,296*e),"#buystone_free_normal.png","#buystone_free_a.png"),n=this.menuItemWithFile1("buystone_free_normal.png",ae.ADWALL_B,l.p(419*e,296*e),"#buystone_free_normal.png","#buystone_free_b.png"),s=this.menuItemWithFile1("buystone_free_normal.png",ae.ADWALL_C,l.p(627*e,296*e),"#buystone_free_normal.png","#buystone_free_c.png"),r=new l.Menu(i,n,s);r.setPosition(0,0),this.spAdWallBg.addChild(r,1)}});Wa.create=function(){return new Wa};var ka=0,Ua=1,Ha=2,Va=3,za=1e3,Ya=1001,Xa=1002,ja=1003,Ka=1004,qa=1005,Qa=1006,Za=1007,Ja=1008,$a=1009,eo=1010,to=1685,io=1686,no=1687,so=1688,ro=1015,ao=1016,oo=1017,ho=1018,lo=1019,co=1020,uo=1051,po=1052,mo=1053,_o=1054,go=1055,To=l.Sprite.extend({m_nStatus:ka,ctor:function(){this._super()},SetStatus:function(e){this.m_nStatus=e},GetStatus:function(){return this.m_nStatus}}),fo=Zs.extend({mLayer1:null,mLayer2:null,mLayer3:null,dictLayer:null,arrBarItemsRect:null,spShopItem:null,spShopItemText:null,spBuy:null,spBuyText:null,spStoneAdd:null,spTopBg:null,spStoneShop:null,mMoveLength:null,nSelItem:null,nSub:null,propType:de.PROP_99,bLockPopUp:!1,m_priceNor:null,m_priceDiscount:null,listener:null,mAllPackageVector:null,mShowingPackageVector:null,mScale:null,LightList:null,_layerNum:1,_propDim:null,_packageDim:null,_carrotDim:null,closeCB:null,_btnBg:null,_propData:null,_packageData:null,_carrotData:null,_Customlistener:null,_spBotLock:null,_spBotLockText:null,ctor:function(e){this.arrBarItemsRect=[],this.dictLayer=[],this.mAllPackageVector=[],this.mShowingPackageVector=[],this.LightList=[],this._layerNum=parseInt(e)?parseInt(e):1,this._super(Ks.DT_SHOP)},addChildItems:function(){this.mScale=.5,nr.share().getWinSize()&&(this.mScale=1);var e=wr.getModel();e.m_nGameMode==ge.HIGHERMODE?e.usersData.OpenAllProps():e.usersData.openPropsByOpenLv();var t=new l.Sprite("shop_stone_bg_new.png");t.setPosition(116*this.mScale,538*this.mScale),this.spMainFrame.addChild(t,99),this._btnBg=new l.Sprite("popup_close_frame.png"),this._btnBg.setPosition(175*this.mScale,547*this.mScale),this._btnBg.setScale(.8),this.spMainFrame.addChild(this._btnBg,99),this.spStoneAdd=new l.Sprite("#shop_stone_add.png"),this.spStoneAdd.setPosition(175*this.mScale,547*this.mScale),this.spStoneAdd.runAction(l.repeatForever(l.sequence(l.scaleTo(.2,1.2),l.scaleTo(.2,1),l.scaleTo(.2,1.2),l.scaleTo(.2,1),l.delayTime(1.5)))),this.spMainFrame.addChild(this.spStoneAdd,99),this._btnBg.visible=!1,this.spStoneAdd.visible=!1,this.lableStoneCount=new l.LabelAtlas("","num_white_18.png",18*this.mScale,30*this.mScale,"./0123456789"),this.lableStoneCount.setPosition(65*this.mScale,530*this.mScale),this.spMainFrame.addChild(this.lableStoneCount,111,111);var i=new l.Sprite("#shop_title_magic_active.png");i.setPosition(294,575),i.setTag(qa),this.spMainFrame.addChild(i);var n=GamePlatform.isCN()?445:480,s=new l.Sprite("#shop_title_pack_active.png");s.setPosition(n,575),s.setTag(Qa),this.spMainFrame.addChild(s),n=GamePlatform.isCN()?596:665;var r=new l.Sprite("#shop_title_carrot_active.png");r.setPosition(n,575),r.setTag(Za),this.spMainFrame.addChild(r);var a=this;if(dp){var o=nr.share().getWinSize(),h=new l.LabelTTF("Loading... ","Arial",26);h.setAnchorPoint(.5,.5),h.setPosition(.5*o.width,.5*o.height),this.addChild(h,1e3),Ql.loadShopFromServer(function(e){a.loadDatas(e,!!e),h.removeFromParent()})}else a.loadDatas(null,!1)},addCustomListener:function(){var e=this;this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this._Customlistener=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"diamondChange",callback:function(t){e.changeStoneCount()}}),l.eventManager.addListener(this._Customlistener,1)},loadDatas:function(e,t){if(void 0!=e||!t){var i=wr.getModel().usersData;i.enablepay=e&&e.enablepay,this._btnBg.visible=i.enablepay,this.spStoneAdd.visible=i.enablepay;var n=0;if(n=t?e.dm?e.dm:0:i.getDiamond(),i.setDiamond(n),this.lableStoneCount.setString(n),t)for(var s=e.hadProps,r=0;r<s.length;r++){var a=s[r];a&&i.setPropByPropid(r+1,a)}for(r=0;r<5;r++){var o=l.rect(nr.share().getMapOffset().width+229*this.mScale+109*r*this.mScale,nr.share().getMapOffset().height+453*this.mScale,70*this.mScale,70*this.mScale);this.arrBarItemsRect.push(o)}e&&(this._propData=e.cfg.props,this._packageData=e.cfg.packages,this._carrotData=e.cfg.luobos);var h=this;GamePlatform.getLanguage();1==this._layerNum?qu.loadResAsync(ni,function(){qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/shop-1.plist",GamePlatform.getLanguage())),h.loadProp(),h.addLayer1(h._propData),h.addLayer2(h._packageData),h.ShowLayer(h._layerNum),l.addTimePoint("shopopen_e"),l.printTimePoint("shopopen_s","shopopen_e")}):qu.loadResAsync(si,function(){qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/shop-3.plist",GamePlatform.getLanguage())),qu.addRes(this,"res/Themes/LevelSelect/shop_carrot.plist"),h.addLayer3(h._carrotData),h.ShowLayer(h._layerNum),l.addTimePoint("shopopen_e"),l.printTimePoint("shopopen_s","shopopen_e")}),this.registerWithTouchDispatcher(!0),this.addCustomListener()}},loadProp:function(){var e,t=wr.getModel(),i=t.usersData,n=l.spriteFrameCache.getSpriteFrame("shop_item_locked.png"),s=l.spriteFrameCache.getSpriteFrame("shop_magic_counter.png"),r=t.getObjectByType(J.BARITEMNUMOVER),a=t.getObjectByType(J.BARITEMNUMUNDER),o=0,h=null;if(this.spTopBg=new l.Sprite("#shop_magic_topbg.png"),this.spTopBg.setPosition(480*this.mScale,481*this.mScale),this.spMainFrame.addChild(this.spTopBg),i.showBottomBomb(4)){this.nSelItem=0;var d=new l.Sprite(s);if(d.setTag(121),d.setPosition(288*this.mScale,508*this.mScale),this.spMainFrame.addChild(d,2),o=i.getClearBBCount(),i.setPropByPropid(1,o),o>99)(S=new l.Sprite("#BarCounter03.png")).setPosition(288*this.mScale,508*this.mScale),this.spMainFrame.addChild(S,2),this.dictLayer.BottomBarItem_100=S;else{o<10?(h=a,e=a.szTile,w=l.p(280*this.mScale,500*this.mScale)):o>=10&&o<=99&&(h=r,e=r.szTile,w=l.p(276*this.mScale,500*this.mScale)),(v=new l.LabelAtlas("00",h.strPic,e.width*this.mScale,e.height*this.mScale,"./0123456789")).setString(String.formatC("%lu",o)),v.setPosition(w),this.spMainFrame.addChild(v,2),this.dictLayer.BottomBarItem_100=v}}else{var c=new l.Sprite(n);c.setPosition(221*this.mScale,64*this.mScale),this.spTopBg.addChild(c)}if(i.showBottomBomb(3)){this.nSelItem=1;var u=new l.Sprite(s);if(u.setTag(122),u.setPosition(397*this.mScale,508*this.mScale),this.spMainFrame.addChild(u,2),o=i.getCarrotHPCount(),i.setPropByPropid(2,o),o>99)(S=new l.Sprite("#BarCounter03.png")).setPosition(397*this.mScale,508*this.mScale),this.spMainFrame.addChild(S,2),this.dictLayer.BottomBarItem_101=S;else if(o<=99){o<10?(h=a,e=a.szTile,w=l.p(389*this.mScale,500*this.mScale)):o>=10&&o<=99&&(h=r,e=r.szTile,w=l.p(385*this.mScale,500*this.mScale)),(v=new l.LabelAtlas("00",h.strPic,e.width*this.mScale,e.height*this.mScale,"./0123456789")).setString(String.formatC("%lu",o)),v.setPosition(w),this.spMainFrame.addChild(v,2),this.dictLayer.BottomBarItem_101=v}}else{var p=new l.Sprite(n);p.setPosition(331*this.mScale,64*this.mScale),this.spTopBg.addChild(p)}if(i.showBottomBomb(2)){this.nSelItem=2;var m=new l.Sprite(s);if(m.setTag(123),m.setPosition(506*this.mScale,508*this.mScale),this.spMainFrame.addChild(m,2),o=i.getShootSPCount(),i.setPropByPropid(3,o),o>99)(S=new l.Sprite("#BarCounter03.png")).setPosition(506*this.mScale,508*this.mScale),this.spMainFrame.addChild(S,2),this.dictLayer.BottomBarItem_102=S;else if(o<=99){o<10?(h=a,e=a.szTile,w=l.p(498*this.mScale,500*this.mScale)):o>=10&&o<=99&&(h=r,e=r.szTile,w=l.p(494*this.mScale,500*this.mScale)),(v=new l.LabelAtlas("00",h.strPic,e.width*this.mScale,e.height*this.mScale,"./0123456789")).setString(String.formatC("%lu",o)),v.setPosition(w),this.spMainFrame.addChild(v,2),this.dictLayer.BottomBarItem_102=v}}else{var _=new l.Sprite(n);_.setPosition(441*this.mScale,64*this.mScale),this.spTopBg.addChild(_)}if(i.showBottomBomb(1)){this.nSelItem=3;var g=new l.Sprite(s);if(g.setTag(124),g.setPosition(615*this.mScale,508*this.mScale),this.spMainFrame.addChild(g,2),o=i.getStopBBCount(),i.setPropByPropid(4,o),o>99)(S=new l.Sprite("#BarCounter03.png")).setPosition(615*this.mScale,508*this.mScale),this.spMainFrame.addChild(S,2),this.dictLayer.BottomBarItem_103=S;else if(o<=99){o<10?(h=a,e=a.szTile,w=l.p(607*this.mScale,500*this.mScale)):(h=r,e=r.szTile,w=l.p(603*this.mScale,500*this.mScale)),(v=new l.LabelAtlas("00",h.strPic,e.width*this.mScale,e.height*this.mScale,"./0123456789")).setString(String.formatC("%lu",o)),v.setPosition(w),this.spMainFrame.addChild(v,2),this.dictLayer.BottomBarItem_103=v}}else{var T=new l.Sprite(n);T.setPosition(551*this.mScale,64*this.mScale),this.spTopBg.addChild(T)}if(i.showBottomBomb(0)){this.nSelItem=4;var f=new l.Sprite(s);if(f.setTag(125),f.setPosition(724*this.mScale,508*this.mScale),this.spMainFrame.addChild(f,2),o=i.getSlowBBCount(),i.setPropByPropid(5,o),o>99){var S=new l.Sprite("#BarCounter03.png");S.setPosition(724*this.mScale,508*this.mScale),this.spMainFrame.addChild(S,2),this.dictLayer.BottomBarItem_104=S}else if(o<=99){var w;o<10?(h=a,e=a.szTile,w=l.p(716*this.mScale,500*this.mScale)):(h=r,e=r.szTile,w=l.p(714*this.mScale,500*this.mScale));var v=new l.LabelAtlas("00",h.strPic,e.width*this.mScale,e.height*this.mScale,"./0123456789");v.setString(String.formatC("%lu",o)),v.setPosition(w),this.spMainFrame.addChild(v,2),this.dictLayer.BottomBarItem_104=v}}else{var L=new l.Sprite(n);L.setPosition(661*this.mScale,64*this.mScale),this.spTopBg.addChild(L)}},loadResources:function(){var e=GamePlatform.getLanguage();qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/shopcommon.plist",e))},UpdateItemsCount:function(){},addLayer1:function(e){this.mLayer1=new l.Layer,this.spMainFrame.addChild(this.mLayer1,1),this.mLayer1.setVisible(!1);var t=wr.getModel().usersData,i=l.spriteFrameCache.getSpriteFrame("shop_magic_highlight.png"),n=[l.p(701,488),l.p(591,488),l.p(481,488),l.p(371,488),l.p(261,488)],s=["shop_item_slow.png","shop_item_ice.png","shop_item_speed.png","shop_item_blood.png","shop_item_bomb.png"],r=["shop_text_slow.png","shop_item_ice.png","shop_text_speed.png","shop_text_blood.png","shop_text_bomb.png"],a=["shop_btn_buy_25.png","shop_btn_buy_25.png","shop_btn_buy_10.png","shop_btn_buy_50.png","shop_btn_buy_50.png"];if(this._propDim=[],dp)if(e)for(o=0;o<5&&o<e.length;o++)this._propDim.push(e[o].diamond);else this._propDim=[50,50,10,25,25];else this._propDim=[50,50,10,25,25];this.LightList=[];for(var o=0;o<5;o++)if(t.showBottomBomb(o)){var h=Ka-o,d=new l.Sprite(i);d.setPosition(l.pMult(n[o],this.mScale)),d.setTag(h),d.setVisible(!1),this.mLayer1.addChild(d,1),this.LightList[h]=d}if(this.LightList.length){var c=this.LightList.length-1;this.LightList[c].setVisible(!0),this.nSub=this._propDim[c-za],c-=Ka,this.spShopItem=new l.Sprite(s[c]),this.spShopItemText=new l.Sprite(r[c]),dp||(this.spBuyText=new l.Sprite(a[c]))}if(this.spShopItem){this.spShopItem.setPosition(266*this.mScale,273*this.mScale),this.mLayer1.addChild(this.spShopItem,1),this.spShopItemText.setPosition(603*this.mScale,288*this.mScale),this.mLayer1.addChild(this.spShopItemText,1);var u=new l.Sprite("#shop_magic_botbg.png");if(u.setPosition(480*this.mScale,242*this.mScale),this.mLayer1.addChild(u),this.spBuy=new l.Sprite("#shop_btn_buybg.png"),this.spBuy.setPosition(522*this.mScale,158*this.mScale),this.mLayer1.addChild(this.spBuy,1),dp){var p=this.createGiftBagPriceNode(this.nSub);p.setAnchorPoint(0,.5),p.setPosition(50,.5*this.spBuy.height),this.spBuy.addChild(p,1),this.spBuyText=p.getChildByTag(100)}else this.spBuyText.setPosition(0,0),this.spBuyText.setAnchorPoint(0,0),this.spBuy.addChild(this.spBuyText,1)}else{var m=new l.Sprite("#shop_locked_bg.png");m.setPosition(479*this.mScale,268*this.mScale),this.mLayer1.addChild(m);var _=new l.Sprite("#shop_locked_magic.png");_.setPosition(479*this.mScale,268*this.mScale),this.mLayer1.addChild(_)}},showUnlockText:function(e){if(e=e||0,void 0==this._spBotLock&&(this._spBotLock=new l.Sprite("#shop_locked_bg.png"),this._spBotLock.setPosition(479,268),this.mLayer1.addChild(this._spBotLock)),this._spBotLock.setVisible(e),void 0==this._spBotLockText){this._spBotLockText=new l.LabelAtlas("","num_white_18.png",18,30,"./0123456789"),this._spBotLockText.setAnchorPoint(.5,.5);var t=GamePlatform.isCN()?5:0;this._spBotLockText.setPosition(473-t,193),this.mLayer1.addChild(this._spBotLockText)}this._spBotLockText.setString(e||0),this._spBotLockText.setVisible(e),this.showItemVisible(!e)},showItemVisible:function(e){this.spShopItem&&this.spShopItem.setVisible(e),this.spShopItemText&&this.spShopItemText.setVisible(e),this.spBuy&&this.spBuy.setVisible(e)},addLayer2:function(e){l.log("packageData:"+JSON.stringify(e));var t=wr.getModel(),i=t.usersData;if(this.mLayer2=new l.Layer,this.spMainFrame.addChild(this.mLayer2,1),this.mLayer2.setVisible(!1),t.m_nGameMode!=ge.HIGHERMODE&&(i.getOpenedLevel()<24||24==i.getOpenedLevel()&&!i.showBottomBomb(4))){var n=new l.Sprite("#shop_locked_bg.png");n.setPosition(479*this.mScale,268*this.mScale),this.mLayer2.addChild(n);var s=GamePlatform.isCN()?4:0,r=new l.Sprite("#shop_locked_pack.png");return r.setPosition(483-s,268),void this.mLayer2.addChild(r)}var a=new l.Sprite("#shop_pack_botbg.png");a.setPosition(480*this.mScale,242*this.mScale),this.mLayer2.addChild(a);var o=new l.Sprite("#shop_bestbuy.png");o.setPosition(811*this.mScale,351*this.mScale),this.mLayer2.addChild(o);var h=new l.Sprite("#shop_btn_buybg.png");h.setPosition(270*this.mScale,156*this.mScale),h.setTag($a),this.mLayer2.addChild(h);var d=0,c=0;if(this._packageDim=[],dp||(this._packageDim=[149,329]),e&&Array.isArray(e)&&(d=e[0]?e[0].diamond:0,c=e[1]?e[1].diamond:0,this._packageDim=[d,c]),dp)(m=this.createGiftBagPriceNode(d)).setAnchorPoint(0,.5),m.setPosition(40,.5*h.height),h.addChild(m);else{var u=new l.Sprite("#shop_btn_buy_210.png");u.setPosition(0,0),u.setAnchorPoint(0,0),h.addChild(u)}var p=new l.Sprite("#shop_btn_buybg.png");if(p.setPosition(687*this.mScale,156*this.mScale),p.setTag(eo),this.mLayer2.addChild(p),dp){var m=this.createGiftBagPriceNode(c);m.setAnchorPoint(0,.5),m.setPosition(40,.5*p.height),p.addChild(m)}else{var _=new l.Sprite("#shop_btn_buy_350.png");_.setPosition(0,0),_.setAnchorPoint(0,0),p.addChild(_)}},createGiftBagPriceNode:function(e){e=e||0;var t=new l.LabelAtlas(e,"num_white_18.png",18*this.mScale,30*this.mScale,"./0123456789");t.setAnchorPoint(0,.5);var i=new l.Sprite("shop_gem.png");i.setAnchorPoint(0,.5);var n=i.getContentSize();n.width+=t.width;var s=new l.Node;return s.setContentSize(n),i.setPosition(0,.5*n.height),t.setPosition(36,.5*n.height),s.addChild(i),s.addChild(t,1,100),s},addLayer3:function(e){this.mLayer3=new l.Layer,this.spMainFrame.addChild(this.mLayer3,3),this.mLayer3.setVisible(!1);var t=wr.getModel(),i=t.usersData;this._carrotDim=[];for(te=0;te<e.length;te++){var n=e[te];this._carrotDim[n.id]=n.diamond}t.setCarrotPrice(this._carrotDim);var s=i.getCarrotFigure(),r=l.spriteFrameCache.getSpriteFrame("shop_btn_using.png"),a=l.spriteFrameCache.getSpriteFrame("shop_btn_select.png"),o=l.spriteFrameCache.getSpriteFrame("shop_btn_locked.png"),h=l.spriteFrameCache.getSpriteFrame("shop_btn_unlock.png"),d=(l.spriteFrameCache.getSpriteFrame(t.isDiscount()?"shop_btn_carrot_buy_old_discount.png":"shop_btn_carrot_buy_old.png"),new To),c=new To,u=new To,p=new To,m=l.spriteFrameCache.getSpriteFrame("shop_carrot_boy.png"),_=new l.Sprite("shop_hole_bg1.png");_.setPosition(151*this.mScale,391*this.mScale),this.mLayer3.addChild(_);var g=new l.Sprite("shop_hole_light.png");g.setPosition(151*this.mScale,391*this.mScale),g.setTag(to),this.mLayer3.addChild(g);var T=new l.Sprite(m);T.setPosition(151*this.mScale,373*this.mScale),this.mLayer3.addChild(T);var f=[],S=l.spriteFrameCache.getSpriteFrame("shop_carrot_boy_1.png"),w=l.spriteFrameCache.getSpriteFrame("shop_carrot_boy_2.png");f.push(S),f.push(w),f.push(S),f.push(m);var v=new l.Animation(f,.1),L=l.sequence(l.delayTime(3.5),l.animate(v));T.runAction(l.repeatForever(L));var M=new l.Sprite("shop_hole_boy.png");M.setPosition(151*this.mScale,209*this.mScale),this.mLayer3.addChild(M),s==ue.CARROT_NORMAL?(g.setVisible(!0),d.initWithSpriteFrame(r),d.SetStatus(Va)):(g.setVisible(!1),d.initWithSpriteFrame(a),d.SetStatus(Ha)),d.setPosition(152*this.mScale,118*this.mScale),d.setTag(ro),this.mLayer3.addChild(d);var C=new l.Sprite("shop_hole_border.png");C.setPosition(260*this.mScale,302*this.mScale),this.mLayer3.addChild(C,2);var y=new l.Sprite("shop_hole_bg2.png");if(y.setPosition(370*this.mScale,391*this.mScale),this.mLayer3.addChild(y),i.isUnlockCarrot(ue.CARROT_GIRL)){var B=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl.png"),F=new l.Sprite("#shop_hole_light.png");F.setPosition(370*this.mScale,391*this.mScale),F.setTag(io),this.mLayer3.addChild(F);var E=new l.Sprite(B);E.setPosition(370*this.mScale,384*this.mScale),this.mLayer3.addChild(E);var P=[],b=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_1.png"),A=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_2.png"),O=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_3.png"),I=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_4.png");P.push(b),P.push(A),P.push(O),P.push(I),P.push(b),P.push(A),P.push(O),P.push(I),P.push(B);var R=new l.Animation(P,.1),D=l.sequence(l.delayTime(5),l.animate(R));E.runAction(l.repeatForever(D));var x=new l.Sprite("shop_hole_girl.png");x.setPosition(370*this.mScale,209*this.mScale),this.mLayer3.addChild(x),i.isCarrotBuy(ue.CARROT_GIRL)?s==ue.CARROT_GIRL?(F.setVisible(!0),c.initWithSpriteFrame(r),c.SetStatus(Va)):(F.setVisible(!1),c.initWithSpriteFrame(a),c.SetStatus(Ha)):(F.setVisible(!1),c.initWithSpriteFrame(h),c.SetStatus(Ua))}else(le=new l.Sprite("#shop_hole_cover.png")).setPosition(370*this.mScale,392*this.mScale),this.mLayer3.addChild(le),c.initWithSpriteFrame(o),c.SetStatus(ka),(x=new l.Sprite("#shop_hole_girl_locked.png")).setPosition(370*this.mScale,209*this.mScale),this.mLayer3.addChild(x);c.setPosition(370*this.mScale,118*this.mScale),c.setTag(ao),this.mLayer3.addChild(c);var N=new l.Sprite("shop_hole_border.png");N.setPosition(479*this.mScale,301*this.mScale),this.mLayer3.addChild(N,2);var G=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat.png"),W=new l.Sprite("shop_hole_bg3.png");W.setPosition(589*this.mScale,391*this.mScale),this.mLayer3.addChild(W);var k=null;if(i.isUnlockCarrot(ue.CARROT_FAT)){(k=new l.Sprite("#shop_hole_light.png")).setPosition(589*this.mScale,391*this.mScale),k.setTag(no),this.mLayer3.addChild(k);var U=new l.Sprite(G);U.setPosition(589*this.mScale,384*this.mScale),this.mLayer3.addChild(U);var H=[],V=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_1.png"),z=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_2.png"),Y=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_3.png"),X=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_4.png");H.push(V),H.push(z),H.push(Y),H.push(z),H.push(V),H.push(z),H.push(Y),H.push(z),H.push(X),H.push(G);var j=new l.Animation(H,.1),K=l.sequence(l.delayTime(3),l.animate(j));U.runAction(l.repeatForever(K));var q=new l.Sprite("#shop_hole_fat.png");q.setPosition(589*this.mScale,209*this.mScale),this.mLayer3.addChild(q),i.isCarrotBuy(ue.CARROT_FAT)?s==ue.CARROT_FAT?(k.setVisible(!0),u.initWithSpriteFrame(r),u.SetStatus(Va)):(k.setVisible(!1),u.initWithSpriteFrame(a),u.SetStatus(Ha)):(k.setVisible(!1),u.initWithSpriteFrame(h),u.SetStatus(Ua))}else(le=new l.Sprite("#shop_hole_cover.png")).setPosition(589*this.mScale,391*this.mScale),this.mLayer3.addChild(le),u.initWithSpriteFrame(o),u.SetStatus(ka),(q=new l.Sprite("#shop_hole_fat_locked.png")).setPosition(589*this.mScale,209*this.mScale),this.mLayer3.addChild(q);u.setPosition(589*this.mScale,118*this.mScale),u.setTag(oo),this.mLayer3.addChild(u);var Q=new l.Sprite("shop_hole_border.png");Q.setPosition(698*this.mScale,302*this.mScale),this.mLayer3.addChild(Q,2);var Z=new l.Sprite("shop_hole_bg4.png");Z.setPosition(808*this.mScale,391*this.mScale),this.mLayer3.addChild(Z);var J=null;if(i.isUnlockCarrot(ue.CARROT_OLD)){(J=new l.Sprite("#shop_hole_light.png")).setPosition(808*this.mScale,375*this.mScale),J.setTag(so),this.mLayer3.addChild(J);var $=new l.Sprite("#shop_carrot_old.png");$.setPosition(808*this.mScale,377*this.mScale),this.mLayer3.addChild($);for(var ee=[],te=1;te<=2;++te){re=String.formatC("shop_carrot_old_%d.png",te);ee.push(l.spriteFrameCache.getSpriteFrame(re))}for(var ie=new l.Animation(ee,.1),ne=[],se=1;se<=3;++se){var re=null;re=3!=se?String.formatC("shop_carrot_old_%d.png",se):String.formatC("shop_carrot_old.png"),ne.push(l.spriteFrameCache.getSpriteFrame(re))}var ae=new l.Animation(ne,.1),oe=l.sequence(l.delayTime(4),l.animate(ie),l.animate(ie),l.animate(ie),l.animate(ae));$.runAction(l.repeatForever(oe));var he=new l.Sprite("#shop_hole_old.png");he.setPosition(808*this.mScale,209*this.mScale),this.mLayer3.addChild(he),i.isCarrotBuy(ue.CARROT_OLD)?s==ue.CARROT_OLD?(J.setVisible(!0),p.initWithSpriteFrame(r),p.SetStatus(Va)):(J.setVisible(!1),p.initWithSpriteFrame(a),p.SetStatus(Ha)):(J.setVisible(!1),p.initWithSpriteFrame(h),p.SetStatus(Ua))}else{var le=new l.Sprite("shop_hole_cover.png");le.setPosition(808*this.mScale,391*this.mScale),this.mLayer3.addChild(le),p.initWithSpriteFrame(o),p.SetStatus(ka),(he=new l.Sprite("#shop_hole_old_locked.png")).setPosition(808*this.mScale,209*this.mScale),this.mLayer3.addChild(he)}p.setPosition(808*this.mScale,118*this.mScale),p.setTag(ho),this.mLayer3.addChild(p)},ShowLayer:function(e){var t=this.spMainFrame.getChildByTag(qa),i=this.spMainFrame.getChildByTag(Qa),n=this.spMainFrame.getChildByTag(Za);switch(e){case 1:if(!this.mLayer1||this.mLayer1.isVisible())return;this.mLayer1.setVisible(!0),this.spTopBg&&this.spTopBg.setVisible(!0),this.mLayer2&&this.mLayer2.setVisible(!1),this.mLayer3&&this.mLayer3.setVisible(!1),this.showMagicRedPoint(!0);s=l.spriteFrameCache.getSpriteFrame("shop_title_magic_active.png");t.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("shop_title_pack_disable.png"),i.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("shop_title_carrot_disable.png"),n.setSpriteFrame(s);break;case 2:if(!this.mLayer2||this.mLayer2.isVisible())return;this.mLayer2.setVisible(!0),this.spTopBg&&this.spTopBg.setVisible(!0),this.mLayer1&&this.mLayer1.setVisible(!1),this.mLayer3&&this.mLayer3.setVisible(!1),this.showMagicRedPoint(!0);s=l.spriteFrameCache.getSpriteFrame("shop_title_magic_disable.png");t.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("shop_title_pack_active.png"),i.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("shop_title_carrot_disable.png"),n.setSpriteFrame(s);break;case 3:if(!this.mLayer3||this.mLayer3.isVisible())return;this.mLayer3.setVisible(!0),this.spTopBg&&this.spTopBg.setVisible(!1),this.mLayer2&&this.mLayer2.setVisible(!1),this.mLayer1&&this.mLayer1.setVisible(!1),this.showMagicRedPoint(!1);var s=l.spriteFrameCache.getSpriteFrame("shop_title_magic_disable.png");t.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("shop_title_pack_disable.png"),i.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("shop_title_carrot_active.png"),n.setSpriteFrame(s)}},NoStoneUpdate:function(){this.showStoneShop()},BuyCarrotUpdate:function(e,t){var i=wr.getModel(),n=i.usersData;t=void 0!=t&&t;var s=l.spriteFrameCache.getSpriteFrame("shop_btn_using.png"),r=l.spriteFrameCache.getSpriteFrame("shop_btn_select.png"),a=this.mLayer3.getChildByTag(ro),o=this.mLayer3.getChildByTag(ao),h=this.mLayer3.getChildByTag(oo),d=this.mLayer3.getChildByTag(ho),c=this.mLayer3.getChildByTag(to),u=this.mLayer3.getChildByTag(io),p=this.mLayer3.getChildByTag(no),m=this.mLayer3.getChildByTag(so);switch(e){case ue.CARROT_GIRL:o.removeChildByTag(1),n.setCarrotFigure(ue.CARROT_GIRL),a.setSpriteFrame(r),a.SetStatus(Ha),o.setSpriteFrame(s),o.SetStatus(Va),h.GetStatus()>Ua&&(h.setSpriteFrame(r),h.SetStatus(Ha)),d.GetStatus()>Ua&&(d.setSpriteFrame(r),d.SetStatus(Ha)),c.setVisible(!1),u.setVisible(!0),p&&p.setVisible(!1),m&&m.setVisible(!1);break;case ue.CARROT_FAT:h.removeChildByTag(1),n.setCarrotFigure(ue.CARROT_FAT),a.setSpriteFrame(r),a.SetStatus(Ha),o.GetStatus()>Ua&&(o.setSpriteFrame(r),o.SetStatus(Ha)),h.setSpriteFrame(s),h.SetStatus(Va),d.GetStatus()>Ua&&(d.setSpriteFrame(r),d.SetStatus(Ha)),c.setVisible(!1),u&&u.setVisible(!1),p.setVisible(!0),m&&m.setVisible(!1);break;case ue.CARROT_OLD:d.removeChildByTag(1),n.setCarrotFigure(ue.CARROT_OLD),a.setSpriteFrame(r),a.SetStatus(Ha),o.GetStatus()>Ua&&(o.setSpriteFrame(r),o.SetStatus(Ha)),h.GetStatus()>Ua&&(h.setSpriteFrame(r),h.SetStatus(Ha)),d.setSpriteFrame(s),d.SetStatus(Va),c.setVisible(!1),u&&u.setVisible(!1),p&&p.setVisible(!1),m.setVisible(!0)}var _=i.getCarrotPrice(e);dp||n.addDiamond(-_),this.changeStoneCount(),t||this.shareCarrot(e)},shareCarrot:function(e){var t=e==ue.CARROT_GIRL?Ce.BuyLuobo_CarrotGirl_Share:e==ue.CARROT_FAT?Ce.BuyLuobo_CarrotFat_Share:Ce.BuyLuobo_CarrotOld_Share;kl.shareCarrot(0,t)},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this.closeCB&&this.closeCB(),this.removeAllChildren(!0),qu.clearOwner(this),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},changeStoneCount:function(){var e=wr.getModel().usersData,t=String.formatC("%lu",e.getDiamond());this.lableStoneCount.setString(t),this.spStoneShop&&this.spStoneShop.changeStoneCount()},addNoStoneDlg:function(e,t){var i=this.getChildByTag(998);if(null==i){var n=this,s=ea;e>ue.CARROT_GIRL&&(s=ta),wr.getModel().usersData.enablepay?qu.loadResAsync(Wi,function(){var e=aa.create();n.addChild(e,100,998),e.setParent(n,br),e.setShowDescription1(s)}):ju.showLiteralsTip(b.Dialog_Hint)}else i.setVisible(!0)},showMagicRedPoint:function(e){var t=this.spMainFrame.getChildByTag(121);null!=t&&t.setVisible(e);var i=this.dictLayer.BottomBarItem_100;null!=i&&i.setVisible(e);var n=this.spMainFrame.getChildByTag(122);null!=n&&n.setVisible(e);var s=this.dictLayer.BottomBarItem_101;null!=s&&s.setVisible(e);var r=this.spMainFrame.getChildByTag(123);null!=r&&r.setVisible(e);var a=this.dictLayer.BottomBarItem_102;null!=a&&a.setVisible(e);var o=this.spMainFrame.getChildByTag(124);null!=o&&o.setVisible(e);var h=this.dictLayer.BottomBarItem_103;null!=h&&h.setVisible(e);var l=this.spMainFrame.getChildByTag(125);null!=l&&l.setVisible(e);var d=this.dictLayer.BottomBarItem_104;null!=d&&d.setVisible(e)},registerWithTouchDispatcher:function(e){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){if(this.getChildByTag(Gr))return!1;var i=wr.getModel().usersData;this.mMoveLength=0;var n=this.spMainFrame.convertTouchToNodeSpace(e),s=this.spStoneAdd.getContentSize(),r=l.rect(this.spStoneAdd.x-s.width/2,this.spStoneAdd.y-s.height/2,s.width,s.height);if(l.rectContainsPoint(r,n))return this.spStoneAdd.setScale(1.1),!0;if(this.mLayer1&&this.mLayer1.isVisible()&&this.spBuy){var a=this.mLayer1.convertTouchToNodeSpace(e),o=this.spBuy.getContentSize(),h=l.rect(this.spBuy.x-o.width/2,this.spBuy.y-o.height/2,o.width,o.height);if(l.rectContainsPoint(h,a))return this.spBuy.setScale(1.1),!0}else if(this.mLayer2&&this.mLayer2.isVisible()&&i.getOpenedLevel()>=20){var a=this.mLayer2.convertTouchToNodeSpace(e),d=this.mLayer2.getChildByTag($a);if(d){var c=d.getContentSize(),u=l.rect(d.x-c.width/2,d.y-c.height/2,c.width,c.height);if(l.rectContainsPoint(u,a))return d.setScale(1.1),!0}var p=this.mLayer2.getChildByTag(eo);if(d){var m=p.getContentSize(),_=l.rect(p.x-m.width/2,p.y-m.height/2,m.width,m.height);if(l.rectContainsPoint(_,a))return p.setScale(1.1),!0}}return!0},showStoneShop:function(){var e=this;if(void 0==e.spStoneShop)qu.loadResAsync(Ti,function(){e.spStoneShop=Wa.create(),e.spStoneShop.setPosition(0,-1800*e.mScale),e.spStoneShop.spTopFrame=e.spMainFrame,e.addChild(e.spStoneShop),e.spStoneAdd.setScale(1);var t=e.spMainFrame.getPosition(),i=l.moveTo(.1,t.x,t.y+30),n=l.moveTo(.2,t.x,t.y+670);e.spMainFrame.runAction(l.sequence(i,n));var s=l.moveTo(.2,0,-30),r=l.moveTo(.1,0,0),a=l.callFunc(function(){e.spStoneShop.showPrice()}.bind(e,e.spStoneShop));e.spStoneShop.runAction(l.sequence(s,r,a))});else{this.spStoneAdd.setScale(1);var t=this.spMainFrame.getPosition(),i=l.moveTo(.1,t.x,t.y+30),n=l.moveTo(.2,t.x,t.y+670);this.spMainFrame.runAction(l.sequence(i,n));var s=l.moveTo(.2,0,-30),r=l.moveTo(.1,0,0),a=l.callFunc(function(){this.spStoneShop.showPrice()}.bind(this,this.spStoneShop));this.spStoneShop.runAction(l.sequence(s,r,a))}},ccTouchEnded:function(e,t){var i=wr.getModel(),n=i.usersData,s=n.getCarrotFigure(),r=this.spMainFrame.convertTouchToNodeSpace(e),a=this.spMainFrame.getChildByTag(qa),o=a.getContentSize(),h=l.rect(a.x-o.width/2,a.y-o.height/2,o.width,o.height);if(l.rectContainsPoint(h,r)){if(i.playSoundWithType($.MTMENUSELECT),null==this.mLayer1){A=this;qu.loadResAsync(ni,function(){qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/shop-1.plist",GamePlatform.getLanguage())),A.loadProp(),A.addLayer1(A._propData),A.ShowLayer(1)})}else this.ShowLayer(1);Tt.onEvent("shop_scene/magic-tab")}else{var d=this.spMainFrame.getChildByTag(Qa),c=d.getContentSize(),u=l.rect(d.x-c.width/2,d.y-c.height/2,c.width,c.height);if(l.rectContainsPoint(u,r)){if(i.playSoundWithType($.MTMENUSELECT),null==this.mLayer2){A=this;qu.loadResAsync(ni,function(){qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/shop-1.plist",GamePlatform.getLanguage())),A.loadProp(),A.addLayer2(A._packageData),A.ShowLayer(2)})}else this.ShowLayer(2);Tt.onEvent("shop_scene/package-tab")}else{var p=this.spMainFrame.getChildByTag(Za),m=p.getContentSize(),_=l.rect(p.x-m.width/2,p.y-m.height/2,m.width,m.height);if(l.rectContainsPoint(_,r)){if(i.playSoundWithType($.MTMENUSELECT),null==this.mLayer3){A=this;qu.loadResAsync(si,function(){qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/shop-3.plist",GamePlatform.getLanguage())),qu.addRes(this,"res/Themes/LevelSelect/shop_carrot.plist"),A.addLayer3(A._carrotData),A.ShowLayer(3)})}else this.ShowLayer(3);Tt.onEvent("shop_scene/carrot-tab")}else{var g=this.spMainFrame.convertTouchToNodeSpace(e);if(i.usersData.enablepay){var T=this.spStoneAdd.getContentSize(),f=l.rect(this.spStoneAdd.x-T.width/2,this.spStoneAdd.y-T.height/2,T.width,T.height);if(l.rectContainsPoint(f,g))return this.showStoneShop(),void i.playSoundWithType($.MTPAGESELECT);var S=l.rect(this.lableStoneCount.x-4*this.mScale,this.lableStoneCount.y-6*this.mScale,82*this.mScale,38*this.mScale);if(l.rectContainsPoint(S,g))return this.showStoneShop(),void i.playSoundWithType($.MTPAGESELECT)}if(this.mLayer1&&this.mLayer1.isVisible()&&this.spBuy){r=this.mLayer1.convertTouchToNodeSpace(e);var w=this.spBuy.getContentSize(),v=l.rect(this.spBuy.x-w.width/2,this.spBuy.y-w.height/2,w.width,w.height);if(l.rectContainsPoint(v,r)){if(this.spBuy.setScale(1),n.getDiamond()<this.nSub)return void this.addNoStoneDlg(ea,this.propType);if(dp){var L=n.getPropCountByid(this.nSelItem+1);Ql.buyPropById(this.nSelItem+1,1,L,this.buyProp.bind(this))}else this.buyProp();return}this.clickInItem(e)}else if(this.mLayer2&&this.mLayer2.isVisible()){r=this.mLayer2.convertTouchToNodeSpace(e);var M=this.mLayer2.getChildByTag($a);if(M){var C=M.getContentSize(),y=l.rect(M.x-C.width/2,M.y-C.height/2,C.width,C.height);if(l.rectContainsPoint(y,r)){M.setScale(1);P=this._packageDim[0]?this._packageDim[0]:0;if(n.getDiamond()<P)return void this.addNoStoneDlg(Hr,de.PROP_99);if(dp){A=this;Ql.buyPackagesById(1,function(e){ju.showLiteralsTip(b.Dialog_Hint4),n.setDiamond(e.dm),A.changeStoneCount(),A.BuyPackageCB(e.propdata,!0)})}else n.addDiamond(-149),this.changeStoneCount(),this.BuyGlodPackage();return}}var B=this.mLayer2.getChildByTag(eo);if(B){var F=B.getContentSize(),E=l.rect(B.x-F.width/2,B.y-F.height/2,F.width,F.height);if(l.rectContainsPoint(E,r)){B.setScale(1);var P=this._packageDim[1]?this._packageDim[1]:0;if(n.getDiamond()<P)return void this.addNoStoneDlg(zr,de.PROP_99);if(dp){var A=this;Ql.buyPackagesById(2,function(e){ju.showLiteralsTip(b.Dialog_Hint4),n.setDiamond(e.dm),A.changeStoneCount(),A.BuyPackageCB(e.propdata,!1)})}else n.addDiamond(-329),this.changeStoneCount(),this.BuyBigGlodPackage();return}}this.clickInItem(e)}else if(this.mLayer3&&this.mLayer3.isVisible()){r=this.mLayer3.convertTouchToNodeSpace(e);var O=this.mLayer3.getChildByTag(ro),I=this.mLayer3.getChildByTag(ao),R=this.mLayer3.getChildByTag(oo),D=this.mLayer3.getChildByTag(ho),x=O.getContentSize(),N=l.rect(O.x-x.width/2,O.y-x.height/2,x.width,x.height);if(l.rectContainsPoint(N,r)){if(s==ue.CARROT_NORMAL)return;return void this.setUseCarrotFigure(ue.CARROT_NORMAL)}var G=I.getContentSize(),W=l.rect(I.x-G.width/2,I.y-G.height/2,G.width,G.height);if(l.rectContainsPoint(W,r)){if(I.GetStatus()==ka)return;if(I.GetStatus()==Ua){if(this.bLockPopUp)return;if(this.bLockPopUp=!0,!Gh.create(this)){z=xh.create();this.addChild(z,100),z.setCarrotStyle(ue.CARROT_GIRL)}return}if(s==ue.CARROT_GIRL)return;return void this.setUseCarrotFigure(ue.CARROT_GIRL)}var k=R.getContentSize(),U=l.rect(R.x-k.width/2,R.y-k.height/2,k.width,k.height);if(l.rectContainsPoint(U,r)){if(R.GetStatus()==ka)return;if(R.GetStatus()==Ua){if(this.bLockPopUp)return;this.bLockPopUp=!0;z=xh.create();return this.addChild(z,100),void z.setCarrotStyle(ue.CARROT_FAT)}if(s==ue.CARROT_FAT)return;return void this.setUseCarrotFigure(ue.CARROT_FAT)}var H=D.getContentSize(),V=l.rect(D.x-H.width/2,D.y-H.height/2,H.width,H.height);if(l.rectContainsPoint(V,r)){if(D.GetStatus()==ka)return;if(D.GetStatus()==Ua){var z=xh.create();return this.addChild(z,100),void z.setCarrotStyle(ue.CARROT_OLD)}if(s==ue.CARROT_OLD)return;return void this.setUseCarrotFigure(ue.CARROT_OLD)}}}}}},clickInItem:function(e){for(var t=this.convertTouchToNodeSpace(e),i=wr.getModel(),n=i.usersData,s=!1,r=0;r<5;r++){var a=this.arrBarItemsRect[r];if(l.rectContainsPoint(a,t)){s=!0,i.playSoundWithType($.MTPAGESELECT);for(var o in this.LightList)this.LightList[o].setVisible(!1);switch(Tt.onEvent("shop_scene/magic-tab"),r){case 0:if(!n.showBottomBomb(4)){this.showUnlockText(24);break}var h=this.LightList[za];if(!h||h.isVisible())break;h.setVisible(!0),this.nSub=this._propDim[0],this.propType=de.PROP_100;m=l.spriteFrameCache.getSpriteFrame("shop_item_bomb.png");this.spShopItem.setSpriteFrame(m);_=l.spriteFrameCache.getSpriteFrame("shop_text_bomb.png");if(this.spShopItemText.setSpriteFrame(_),this.nSelItem=0,dp)this.spBuyText&&this.spBuyText.setString(this.nSub);else{g=l.spriteFrameCache.getSpriteFrame("shop_btn_buy_50.png");this.spBuyText.setSpriteFrame(g)}this.showUnlockText(!1);break;case 1:if(!n.showBottomBomb(3)){this.showUnlockText(20);break}var d=this.LightList[Ya];if(!d||d.isVisible())break;d.setVisible(!0),this.nSub=this._propDim[1],this.propType=de.PROP_101;m=l.spriteFrameCache.getSpriteFrame("shop_item_blood.png");this.spShopItem.setSpriteFrame(m);_=l.spriteFrameCache.getSpriteFrame("shop_text_blood.png");if(this.spShopItemText.setSpriteFrame(_),this.nSelItem=1,dp)this.spBuyText&&this.spBuyText.setString(this.nSub);else{g=l.spriteFrameCache.getSpriteFrame("shop_btn_buy_50.png");this.spBuyText.setSpriteFrame(g)}this.showUnlockText(!1);break;case 2:if(!n.showBottomBomb(2)){this.showUnlockText(13);break}var c=this.LightList[Xa];if(!c||c.isVisible())break;c.setVisible(!0),this.nSub=this._propDim[2],this.propType=de.PROP_102;m=l.spriteFrameCache.getSpriteFrame("shop_item_speed.png");this.spShopItem.setSpriteFrame(m);_=l.spriteFrameCache.getSpriteFrame("shop_text_speed.png");if(this.spShopItemText.setSpriteFrame(_),this.nSelItem=2,dp)this.spBuyText&&this.spBuyText.setString(this.nSub);else{g=l.spriteFrameCache.getSpriteFrame("shop_btn_buy_10.png");this.spBuyText.setSpriteFrame(g)}this.showUnlockText(!1);break;case 3:if(!n.showBottomBomb(1)){this.showUnlockText(9);break}var u=this.LightList[ja];if(!u||u.isVisible())break;u.setVisible(!0),this.nSub=this._propDim[3],this.propType=de.PROP_103;m=l.spriteFrameCache.getSpriteFrame("shop_item_ice.png");this.spShopItem.setSpriteFrame(m);_=l.spriteFrameCache.getSpriteFrame("shop_text_ice.png");if(this.spShopItemText.setSpriteFrame(_),this.nSelItem=3,dp)this.spBuyText&&this.spBuyText.setString(this.nSub);else{g=l.spriteFrameCache.getSpriteFrame("shop_btn_buy_25.png");this.spBuyText.setSpriteFrame(g)}this.showUnlockText(!1);break;case 4:if(!n.showBottomBomb(0)){this.showUnlockText(6);break}var p=this.LightList[Ka];if(!p||p.isVisible())break;p.setVisible(!0),this.nSub=this._propDim[4],this.propType=de.PROP_104;var m=l.spriteFrameCache.getSpriteFrame("shop_item_slow.png");this.spShopItem.setSpriteFrame(m);var _=l.spriteFrameCache.getSpriteFrame("shop_text_slow.png");if(this.spShopItemText.setSpriteFrame(_),this.nSelItem=4,dp)this.spBuyText&&this.spBuyText.setString(this.nSub);else{var g=l.spriteFrameCache.getSpriteFrame("shop_btn_buy_25.png");this.spBuyText.setSpriteFrame(g)}this.showUnlockText(!1)}break}}s&&this.mLayer1&&!this.mLayer1.isVisible()&&this.ShowLayer(1)},buyProp:function(e){ju.showLiteralsTip(b.Dialog_Hint4);var t=0,i=this.nSelItem,n=1;e&&(t=e.dm,e.propdata&&(i=e.propdata.propid-1,n=e.propdata.count));var s=wr.getModel(),r=s.usersData;s.playSoundWithType($.MTPBUYITEM),e?r.setDiamond(t):r.addDiamond(-this.nSub),this.changeStoneCount();var a=0,o=0;switch(i){case 0:o=n-r.getClearBBCount(),a=r.addClearBB(o,!0),r.DLClearBB-=o,r.GMClearBB+=o;break;case 1:o=n-r.getCarrotHPCount(),a=r.addCarrotHP(o,!0),r.DLCarrotHP-=o,r.GMCarrotHP+=o;break;case 2:o=n-r.getShootSPCount(),a=r.addShootSP(o,!0),r.DLShootSP-=o,r.GMShootSP+=o;break;case 3:o=n-r.getStopBBCount(),a=r.addStopBB(o,!0),r.DLStopBB-=o,r.GMStopBB+=o;break;case 4:o=n-r.getSlowBBCount(),a=r.addSlowBB(o,!0),r.DLSlowBB-=o,r.GMSlowBB+=o}var h=String.formatC("BottomBarItem_%d",100+this.nSelItem);if(a>0&&a<=9||a>10&&a<100)(p=this.dictLayer[h]).setString(String.formatC("%lu",a));else if(10==a){m=(p=this.dictLayer[h]).getPosition();p.getParent().removeChild(p,!0);var d=s.getObjectByType(J.BARITEMNUMOVER),c=d.szTile,u=new l.LabelAtlas("00",d.strPic,c.width*this.mScale,c.height*this.mScale,"./0123456789");u.setString(String.formatC("%lu",a)),u.setPosition(m.x-4*this.mScale,m.y),this.spMainFrame.addChild(u,2),this.dictLayer[h]=u}else if(100==a){var p=this.dictLayer[h],m=p.getPosition();p.getParent().removeChild(p,!0);var _=new l.Sprite("#BarCounter03.png");_.setPosition(288*this.mScale+109*this.nSelItem*this.mScale,508*this.mScale),this.spMainFrame.addChild(_,2),this.dictLayer[h]=_}},ccTouchMoved:function(e,t){var i=this.convertTouchToNodeSpace(e),n=e.getPreviousLocationInView();n=l.director.convertToGL(n),n=this.convertToNodeSpace(n);var s=l.pSub(i,n);this.mMoveLength+=-s.x;var r=wr.getModel().usersData;if(this.mMoveLength>=5||this.mMoveLength<=-5)if(this.spStoneAdd.setScale(1),this.mLayer1&&this.mLayer1.isVisible()&&this.spBuy)this.spBuy.setScale(1);else if(this.mLayer2&&this.mLayer2.isVisible()&&r.getOpenedLevel()>=20){var a=this.mLayer2.getChildByTag($a),o=this.mLayer2.getChildByTag(eo);a&&a.setScale(1),o&&o.setScale(1)}},BuyPackageCB:function(e,t){if(void 0!=e){var i=wr.getModel(),n=i.usersData;i.playSoundWithType($.MTPBUYITEM);for(var s=0;s<5;s++){var r=0,a=0,o=s<e.length?e[s]:null,h=o?o.propid-1:999;switch(h){case 0:a=n.getClearBBCount(),r=o.count,n.setPropByPropid(o.propid,r),n.DLClearBB-=1,n.GMClearBB+=1;break;case 1:a=n.getCarrotHPCount(),r=o.count,n.setPropByPropid(o.propid,r),n.DLCarrotHP-=2,n.GMCarrotHP+=2;break;case 2:a=n.getShootSPCount(),r=o.count,n.setPropByPropid(o.propid,r),t?(n.DLShootSP-=3,n.GMShootSP+=3):(n.DLShootSP-=5,n.GMShootSP+=5);break;case 3:a=n.getStopBBCount(),r=o.count,n.setPropByPropid(o.propid,r),t?(n.DLStopBB-=2,n.GMStopBB+=2):(n.DLStopBB-=3,n.GMStopBB+=3);break;case 4:a=n.getSlowBBCount(),r=o.count,n.setPropByPropid(o.propid,r),t?(n.DLSlowBB-=2,n.GMSlowBB+=2):(n.DLSlowBB-=3,n.GMSlowBB+=3)}var d=String.formatC("BottomBarItem_%d",100+h);if(a<10&&r>=10){m=(g=this.dictLayer[d]).getPosition();g.getParent().removeChild(g,!0);var c=i.getObjectByType(J.BARITEMNUMOVER),u=c.szTile,p=new l.LabelAtlas("00",c.strPic,u.width*this.mScale,u.height*this.mScale,"./0123456789");p.setString(String.formatC("%lu",r)),p.setPosition(m.x-4*this.mScale,m.y),this.spMainFrame.addChild(p,2),this.dictLayer[d]=p}else if(a<100&&r>=100){var m=(g=this.dictLayer[d]).getPosition();g.getParent().removeChild(g,!0);var _=new l.Sprite("#BarCounter03.png");_.setPosition(288*this.mScale+109*s*this.mScale,508*this.mScale),this.spMainFrame.addChild(_,2),this.dictLayer[d]=_}else if(a>=100);else{var g=this.dictLayer[d];g&&g.setString(String.formatC("%lu",r))}}}},BuyGlodPackage:function(){var e=wr.getModel(),t=e.usersData;e.playSoundWithType($.MTPBUYITEM);for(var i=0;i<5;i++){var n=0,s=0;switch(i){case 0:s=t.getClearBBCount(),n=t.addClearBB(1,!1),t.DLClearBB-=1,t.GMClearBB+=1;break;case 1:break;case 2:s=t.getShootSPCount(),n=t.addShootSP(3,!1),t.DLShootSP-=3,t.GMShootSP+=3;break;case 3:s=t.getStopBBCount(),n=t.addStopBB(2,!1),t.DLStopBB-=2,t.GMStopBB+=2;break;case 4:s=t.getSlowBBCount(),n=t.addSlowBB(2,!0),t.DLSlowBB-=2,t.GMSlowBB+=2}if(1!=i){var r=String.formatC("BottomBarItem_%d",100+i);if(s<10&&n>=10){d=(u=this.dictLayer[r]).getPosition();u.getParent().removeChild(u,!0);var a=e.getObjectByType(J.BARITEMNUMOVER),o=a.szTile,h=new l.LabelAtlas("00",a.strPic,o.width*this.mScale,o.height*this.mScale,"./0123456789");h.setString(String.formatC("%lu",n)),h.setPosition(d.x-4*this.mScale,d.y),this.spMainFrame.addChild(h,2),this.dictLayer[r]=h}else if(s<100&&n>=100){var d=(u=this.dictLayer[r]).getPosition();u.getParent().removeChild(u,!0);var c=new l.Sprite("#BarCounter03.png");c.setPosition(288*this.mScale+109*i*this.mScale,508*this.mScale),this.spMainFrame.addChild(c,2),this.dictLayer[r]=c}else if(s>=100);else{var u=this.dictLayer[r];u.setString(String.formatC("%lu",n))}}}},BuyBigGlodPackage:function(){var e=wr.getModel(),t=e.usersData;e.playSoundWithType($.MTPBUYITEM);for(var i=0;i<5;i++){var n=0,s=0;switch(i){case 0:s=t.getClearBBCount(),n=t.addClearBB(1,!1),t.DLClearBB-=1,t.GMClearBB+=1;break;case 1:s=t.getCarrotHPCount(),n=t.addCarrotHP(2,!1),t.DLCarrotHP-=2,t.GMCarrotHP+=2;break;case 2:s=t.getShootSPCount(),n=t.addShootSP(5,!1),t.DLShootSP-=5,t.GMShootSP+=5;break;case 3:s=t.getStopBBCount(),n=t.addStopBB(3,!1),t.DLStopBB-=3,t.GMStopBB+=3;break;case 4:s=t.getSlowBBCount(),n=t.addSlowBB(3,!0),t.DLSlowBB-=3,t.GMSlowBB+=3}var r=String.formatC("BottomBarItem_%d",100+i);if(s<10&&n>=10){d=(u=this.dictLayer[r]).getPosition();u.getParent().removeChild(u,!0);var a=e.getObjectByType(J.BARITEMNUMOVER),o=a.szTile,h=new l.LabelAtlas("00",a.strPic,o.width*this.mScale,o.height*this.mScale,"./0123456789");h.setString(String.formatC("%lu",n)),h.setPosition(d.x-4*this.mScale,d.y),this.spMainFrame.addChild(h,2),this.dictLayer[r]=h}else if(s<100&&n>=100){var d=(u=this.dictLayer[r]).getPosition();u.getParent().removeChild(u,!0);var c=new l.Sprite("#BarCounter03.png");c.setPosition(288*this.mScale+109*i*this.mScale,508*this.mScale),this.spMainFrame.addChild(c,2),this.dictLayer[r]=c}else if(s>=100);else{var u=this.dictLayer[r];u&&u.setString(String.formatC("%lu",n))}}},setUseCarrotFigure:function(e){void 0==e&&(e=ue.CARROT_NORMAL);wr.getModel();var t=this,i=e-ue.CARROT_NORMAL+1;Ql.chooseluobo(i,function(e){var i=e.luoboid+ue.CARROT_NORMAL-1;t.useCarrotFigure(i)})},useCarrotFigure:function(e){void 0==e&&(e=ue.CARROT_NORMAL);var t=wr.getModel();t.playSoundWithType($.MTPAGESELECT),t.usersData.setCarrotFigure(e);var i=l.spriteFrameCache.getSpriteFrame("shop_btn_using.png"),n=l.spriteFrameCache.getSpriteFrame("shop_btn_select.png"),s=this.mLayer3.getChildByTag(ro),r=this.mLayer3.getChildByTag(ao),a=this.mLayer3.getChildByTag(oo),o=this.mLayer3.getChildByTag(ho),h=[s,r,a,o],d=[this.mLayer3.getChildByTag(to),this.mLayer3.getChildByTag(io),this.mLayer3.getChildByTag(no),this.mLayer3.getChildByTag(so)];for(var c in h){var u=h[c];u.GetStatus()>Ua&&(u.setSpriteFrame(n),u.SetStatus(Ha))}for(var c in d){var p=d[c];p&&p.setVisible(p.getTag()==e)}switch(e){case ue.CARROT_NORMAL:s.setSpriteFrame(i),s.SetStatus(Va);break;case ue.CARROT_GIRL:r.setSpriteFrame(i),r.SetStatus(Va),r.removeChildByTag(1);break;case ue.CARROT_FAT:a.setSpriteFrame(i),a.SetStatus(Va),a.removeChildByTag(1);break;case ue.CARROT_OLD:o.setSpriteFrame(i),o.SetStatus(Va),o.removeChildByTag(1)}},BuyGirlCarrot:function(){var e=wr.getModel();e.playSoundWithType($.MTPAGESELECT),e.usersData.setCarrotFigure(ue.CARROT_GIRL);var t=l.spriteFrameCache.getSpriteFrame("shop_btn_using.png"),i=l.spriteFrameCache.getSpriteFrame("shop_btn_select.png"),n=this.mLayer3.getChildByTag(ro),s=this.mLayer3.getChildByTag(ao),r=this.mLayer3.getChildByTag(oo),a=this.mLayer3.getChildByTag(ho),o=this.mLayer3.getChildByTag(to),h=this.mLayer3.getChildByTag(io),d=this.mLayer3.getChildByTag(no),c=this.mLayer3.getChildByTag(so);n.setSpriteFrame(i),n.SetStatus(Ha),s.setSpriteFrame(t),s.SetStatus(Va),s.removeChildByTag(1),r.GetStatus()>Ua&&(r.setSpriteFrame(i),r.SetStatus(Ha)),a.GetStatus()>Ua&&(a.setSpriteFrame(i),a.SetStatus(Ha)),o.setVisible(!1),h.setVisible(!0),d&&d.setVisible(!1),c&&c.setVisible(!1)},BuyFatCarrot:function(){var e=wr.getModel();e.playSoundWithType($.MTPAGESELECT),e.usersData.setCarrotFigure(ue.CARROT_FAT);var t=l.spriteFrameCache.getSpriteFrame("shop_btn_using.png"),i=l.spriteFrameCache.getSpriteFrame("shop_btn_select.png"),n=this.mLayer3.getChildByTag(ro),s=this.mLayer3.getChildByTag(ao),r=this.mLayer3.getChildByTag(oo),a=this.mLayer3.getChildByTag(ho),o=this.mLayer3.getChildByTag(to),h=this.mLayer3.getChildByTag(io),d=this.mLayer3.getChildByTag(no),c=this.mLayer3.getChildByTag(so);n.setSpriteFrame(i),n.SetStatus(Ha),s.GetStatus()>Ua&&(s.setSpriteFrame(i),s.SetStatus(Ha)),r.setSpriteFrame(t),r.SetStatus(Va),r.removeChildByTag(1),a.GetStatus()>Ua&&(a.setSpriteFrame(i),a.SetStatus(Ha)),o.setVisible(!1),h&&h.setVisible(!1),d.setVisible(!0),c&&c.setVisible(!1)},BuyOldCarrot:function(){var e=wr.getModel();e.playSoundWithType($.MTPAGESELECT),e.usersData.setCarrotFigure(ue.CARROT_OLD);var t=l.spriteFrameCache.getSpriteFrame("shop_btn_using.png"),i=l.spriteFrameCache.getSpriteFrame("shop_btn_select.png"),n=this.mLayer3.getChildByTag(ro),s=this.mLayer3.getChildByTag(ao),r=this.mLayer3.getChildByTag(oo),a=this.mLayer3.getChildByTag(ho),o=this.mLayer3.getChildByTag(to),h=this.mLayer3.getChildByTag(io),d=this.mLayer3.getChildByTag(no),c=this.mLayer3.getChildByTag(so);n.setSpriteFrame(i),n.SetStatus(Ha),s.GetStatus()>Ua&&(s.setSpriteFrame(i),s.SetStatus(Ha)),r.GetStatus()>Ua&&(r.setSpriteFrame(i),r.SetStatus(Ha)),a.setSpriteFrame(t),a.SetStatus(Va),a.removeChildByTag(1),o.setVisible(!1),h&&h.setVisible(!1),d&&d.setVisible(!1),c.setVisible(!0)},UpdateMigic:function(){wr.getModel().playSoundWithType($.MTPBUYITEM)},stoneChangeCarrot:function(e){var t=wr.getModel(),i=t.getCarrotPrice(e);switch(e){case ue.CARROT_GIRL:if(t.usersData.getDiamond()<i)return void this.addNoStoneDlg(ue.CARROT_GIRL,de.PROP_99);n=oa.create();return this.addChild(n,100),void n.setParent(this,ue.CARROT_GIRL);case ue.CARROT_FAT:if(t.usersData.getDiamond()<i)return void this.addNoStoneDlg(ue.CARROT_FAT,de.PROP_99);n=oa.create();return this.addChild(n,100),void n.setParent(this,ue.CARROT_FAT);case ue.CARROT_OLD:if(t.usersData.getDiamond()<i)return void this.addNoStoneDlg(ue.CARROT_OLD,de.PROP_99);var n=oa.create();return this.addChild(n,100),void n.setParent(this,ue.CARROT_OLD)}},BuyCarrot:function(e){switch(e){case ue.CARROT_GIRL:t=Ss.create(this);this.addChild(t,2e3,2e3),t.buyProduct(oe.GIRLCARROT);break;case ue.CARROT_FAT:t=Ss.create(this);this.addChild(t,2e3,2e3),t.buyProduct(oe.FATCARROT);break;case ue.CARROT_OLD:var t=Ss.create(this);this.addChild(t,2e3,2e3),t.buyProduct(oe.OLDCARROT)}},addLayer4:function(){this.mLayer4=new l.Layer,this.spMainFrame.addChild(this.mLayer4,1),this.mLayer4.setVisible(!1),this.mLayer4Page1=new l.Layer,this.mLayer4Page2=new l.Layer,this.mLayer4.addChild(this.mLayer4Page1),this.mLayer4.addChild(this.mLayer4Page2);var e=new l.Sprite("shop_comingsoon.png");e.setPosition(l.pMult(l.p(498.5,283),this.mScale)),e.setTag(2016),e.setVisible(!1),this.mLayer4.addChild(e);var t=new l.Sprite("shop_btn_left_normal.png"),i=new l.Sprite("shop_btn_left_pressed.png"),n=new l.Sprite("shop_btn_left_disable.png"),s=new l.MenuItemSprite(t,i,n,this,this.menuCallBack.bind(this));s.setPosition(40*this.mScale,299*this.mScale),s.setTag(lo);var r=new l.Sprite("shop_btn_right_normal.png"),a=new l.Sprite("shop_btn_right_pressed.png"),o=new l.Sprite("shop_btn_right_disable.png"),h=new l.MenuItemSprite(r,a,o,this,this.menuCallBack.bind(this));h.setTag(co),h.setPosition(922*this.mScale,299*this.mScale),this.mPageMenu=new l.Menu(s,h,null),this.mPageMenu.setPosition(0,0),this.mLayer4.addChild(this.mPageMenu);for(var d=0;d<5;d++){var c=this.createItemInLayer4(d,l.p((207+d%3*274)*this.mScale,293*this.mScale),uo+d);null!=c&&(c.setVisible(!1),this.mAllPackageVector.push(c))}this.refreshLayer4()},refreshLayer4:function(){this.showMagicRedPoint(!1);var e=wr.getModel().usersData,t=this.mPageMenu.getChildByTag(lo),i=this.mPageMenu.getChildByTag(co);this.mLayer4Page1.setVisible(!0),this.mLayer4Page2.setVisible(!1);var n=this.spMainFrame.getChildByTag(Ja).getChildByTag(Ja+22);e.bIsUnlockedSuperPackage||null==n||n.setVisible(!1),this.mShowingPackageVector=[];for(var s=0;s<this.mAllPackageVector.length;s++){if(null==(o=this.mAllPackageVector[s]))return;o.setVisible(!1),0!=s||e.isLifeForever()?1==s&&e.getOpenedLevel()>O.SHOWMEETAQIU?e.isCarrotBuy(ue.CARROT_GIRL)||this.mShowingPackageVector.push(o):2==s&&e.getOpenedLevel()>O.SHOWMEETADAI?e.isCarrotBuy(ue.CARROT_FAT)||this.mShowingPackageVector.push(o):s>2&&e.getOpenedLevel()>24&&this.mShowingPackageVector.push(o):this.mShowingPackageVector.push(o)}var r=this.mShowingPackageVector.length>3;if(t.setVisible(r),i.setVisible(r),0==this.mShowingPackageVector.length)return this.mLayer4.getChildByTag(2016).setVisible(!0),void this.mLayer4Page1.setVisible(!1);for(var a=0;a<this.mShowingPackageVector.length;a++){var o=this.mShowingPackageVector[a];if(null==o)return;o.getChildByTag(2017).setPosition((207+a%3*274)*this.mScale,293*this.mScale),null!=o.getParent()&&o.removeFromParent(),a<3?this.mLayer4Page1.addChild(o,a):(this.mLayer4Page2.addChild(o,a),this.mLayer4Page2.setVisible(!1)),o.setVisible(!0)}},createItemInLayer4:function(e,t,i,n){var s=new l.Node,r=new l.Sprite(String.formatC("shop_set_%d.png",1+e));r.setPosition(t),r.setTag(2017),s.addChild(r);var a=new l.Sprite("shop_sbtn_normal.png"),o=new l.Sprite("shop_sbtn_pressed.png"),h=new l.Sprite(String.formatC("shop_sbtn_text_set%d.png",1+e));h.setAnchorPoint(.5,.5),h.setPosition(100*this.mScale,50*this.mScale),a.addChild(h);var d=new l.Sprite(String.formatC("shop_sbtn_text_set%d.png",1+e));d.setAnchorPoint(.5,.5),d.setPosition(100*this.mScale,50*this.mScale),o.addChild(d);var c=new l.MenuItemSprite(a,o,null,this,this.menuCallBack.bind(this));c.setPosition(l.pMult(l.p(135,68),this.mScale)),c.setTag(i),c.setEnabled(n);var u=new l.Menu(c,null);return u.setPosition(0,0),r.addChild(u),s},menuCallBack:function(e){wr.getModel();switch(e.getTag()){case uo:t=Ss.create(this);this.addChild(t,2e3,2e3),t.buyProduct(oe.SUPER_PACKAGE_1);break;case po:t=Ss.create(this);this.addChild(t,2e3,2e3),t.buyProduct(oe.SUPER_PACKAGE_2);break;case mo:t=Ss.create(this);this.addChild(t,2e3,2e3),t.buyProduct(oe.SUPER_PACKAGE_3);break;case _o:t=Ss.create(this);this.addChild(t,2e3,2e3),t.buyProduct(oe.SUPER_PACKAGE_4);break;case go:var t=Ss.create(this);this.addChild(t,2e3,2e3),t.buyProduct(oe.SUPER_PACKAGE_5);break;case lo:this.mLayer4Page2.setVisible(!1),this.mLayer4Page1.setVisible(!0);break;case co:this.mLayer4Page2.setVisible(!0),this.mLayer4Page1.setVisible(!1)}}});fo.create=function(e){return new fo(e)};var So=112,wo=l.Layer.extend({listener:null,listener1:null,ctor:function(){},menuCallback:function(e){var t=e,i=wr.getModel();i.playSoundWithType($.MTMENUSELECT),t.getTag()==I?(l.director.getScheduler().isWaite=!1,this.getParent().removeChild(this,!0),i.bLockMenu=!1):t.getTag()==So&&(l.director.getScheduler().isWaite=!0)},init:function(){this._super();var e=wr.getModel();e.bLockMenu=!0,this.registerWithTouchDispatcher(),qu.addRes(this,"res/Themes/Items/Items03-hd.plist"),qu.addRes(this,"res/Themes/scene/themelocked.plist");var t=nr.share().getWinSize(),i=nr.share().getMapOffset(),n=.5;nr.share().isIPad()&&(n=1),l.director.getScheduler().isWaite=!0;var s=l.spriteFrameCache.getSpriteFrame("woodbg_title.png"),r=l.color(0,0,0,180),a=new l.LayerColor(r);a&&(a.setPosition(0,0),a.setContentSize(t),this.addChild(a,100));var o=new l.Sprite(s);o.setPosition(478*n+i.width,312*n),a.addChild(o,101);var h=new l.Sprite("themelocked_title.png");h.setPosition(412*n,508*n),o.addChild(h),(h=new l.Sprite("themelocked_sep.png")).setPosition(411*n,259*n),o.addChild(h),(h=new l.Sprite("themelocked_crystalcup.png")).setPosition(229*n,269*n),o.addChild(h),(h=new l.Sprite("themelocked_tofacebook.png")).setPosition(596*n,269*n),o.addChild(h);var d=String.formatC("%d",e.usersData.getTaskHonorCount()),c=new l.LabelAtlas("00","num_white_18.png",18*n,30*n,"./0123456789");c.setString(d.toString()),c.setAnchorPoint(1,.5),c.setPosition(260*n,108*n),o.addChild(c);var u=this.menuItemWithFile1("popup_close.png",I,l.p(769*n,493*n),null,null,1.1),p=this.menuItemWithFile1("btn_green_m.png",So,l.p(595*n,109*n),"btn_green_m_pressed.png","themelocked_share.png"),m=new l.Menu(u,p);m.setPosition(0,0),o.addChild(m,2,2);var _=this;return this.listener1=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"msgHide",callback:function(e){_.getMessage(e.getUserData())}}),l.eventManager.addListener(this.listener1,1),!0},onExit:function(){this.removeAllChildren(),this.listener&&l.eventManager.removeListener(this.listener),this.listener1&&l.eventManager.removeListener(this.listener1),qu.clearOwner(this),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile1:function(e,t,i,n,s,r){r=r||1;var a=new l.Sprite(e);if(null!=s){var o=new l.Sprite(s);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o)}var h=null;if(h=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var d=new l.Sprite(s);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d)}var c=new l.MenuItemSprite(a,h,null,this.menuCallback.bind(this),this);return c.setTag(t),c.setPosition(i),c},getMessage:function(e){l.log("\r\n========Hide Theme Lock Dialog==========");var t=wr.getModel();l.director.getScheduler().isWaite=!1;var i=this.getParent();i.removeChild(this,!0),i.showLevelInfo(31),t.bLockMenu=!1}});wo.create=function(){return new wo};var vo={BTN_OK:0,BTN_CANCEL:1},Lo=Zs.extend({listener:null,ctor:function(){this._super(Ks.DT_NOTICENOCLOSE)},setShopInterface:function(e){},addChildItems:function(){this.registerWithTouchDispatcher();var e=.5;nr.share().isIPad()&&(e=1);var t=new l.Sprite("unlimited_restore_info.png");this.spMainFrame.addChild(t),t.setPosition(400*e,250*e);var i=this.menuItemWithFile("#btn_blue_m.png","#btn_blue_m_pressed.png","#unlimited_restore_btn.png",sa,l.p(267*e,162*e),null),n=this.menuItemWithFile("#btn_green_m.png","#btn_green_m_pressed.png","#btn_green_m_cancel.png",ra,l.p(540*e,162*e),null),s=new l.Menu(i,n);s.setPosition(0,0),this.spMainFrame.addChild(s,99)},loadResources:function(){qu.addRes(this,"res/Themes/LevelSelect/LevelSel02-hd.plist");var e=wr.getModel().usersData.m_nLanguage,t=String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",e.toString(),e.toString());qu.addRes(this,t)},changeStoneCount:function(){},onExit:function(){qu.clearOwner(this),this.listener&&l.eventManager.removeListener(this.listener),this.removeAllChildren(),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},menuItemWithFile:function(e,t,i,n,s,r){if(!(arguments.length<5)){r=r||1;var a=new l.Sprite(e),o=new l.Sprite(i);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o);var h=new l.Sprite(t),d=new l.Sprite(i);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d);var c=new l.MenuItemSprite(a,h,null,this,this.menuCallback.bind(this));return c.setTag(n),c.setPosition(s),c}},menuCallback:function(e){e.getTag();wr.getModel().playSoundWithType($.MTPAGESELECT),this.setVisible(!1),this.removeFromParent()}});Lo.create=function(){return new Lo};var Mo=0,Co=1,yo=1,Bo=3,Fo=4,Eo=l.Menu.extend({ctor:function(e){this._super(e)},_onTouchBegan:function(e,t){var i=t.getCurrentTarget(),n=wr.getModel();if(i._state!=l.MENU_STATE_WAITING||!i.isVisible()||n.bLockMenu)return!1;for(var s=i.getParent();null!=s;s=s.getParent())if(!1===s.isVisible())return!1;return i._selectedItem=i._itemForTouch(e),!!i._selectedItem&&(i._state=l.MENU_STATE_TRACKING_TOUCH,i._selectedItem.selected(),!0)}});Eo.createWithArray=function(e){return new Eo(e)};var Po=Xs.extend({spriteItems:null,spriteItemsRouteMap:null,lableSecond:null,lableMinute:null,labelRouletteMinute:null,labelRouletteSecond:null,spRightMenu:null,spRightStarMore:null,spTime:null,spHeadBG:null,m_spTips:null,mBgLayer:null,mCloudLayer:null,mDis:0,mMoveLength:0,mFrom:0,mTo:0,mTimes:0,mMoveDirection:0,nStarCount:0,bLeft:!1,bRight:!1,bCanShowAD:!0,GM:0,GS:0,RM:0,RS:0,DisGM:0,DisGS:0,RouletteState:0,LifeForeverPCut:0,xOffSet:0,spriteRoute:null,spriteSelectItem:null,m_loadingBg:null,spStarcounter:null,m_dlg:null,luoboHonor:null,friends:null,ctor:function(){this._super(),this.addLayerName("scene-map")},init:function(){this._super();var e=wr.getModel();e.selLayer=this;var t=e.usersData.language;if(this.mBgLayer=new l.Layer,this.addChild(this.mBgLayer),this.spriteItems=new l.SpriteBatchNode(String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.png",t,t),10),this.mBgLayer.addChild(this.spriteItems,101),this.spriteItemsRouteMap=new l.SpriteBatchNode("res/Themes/LevelSelect/LevelSel03-hd.png",10),this.mBgLayer.addChild(this.spriteItemsRouteMap,100),!dp){this.nStarCount=e.usersData.getGameStars();var i=e.usersData.getWaitMS();this.GM=i.m,this.GS=i.s}e.bShowStarsInLevelSel?(this.bCanShowAD=!1,this.showLoadingStars(),e.bShowStarsInLevelSel=!1):(this.loadResources(),l.director.getScheduler().isWaite=!1,this.addBGLayer(),this.addMenuLayer(),this.registerWithTouchDispatcher(),e.playMuiscWithType($.MTSTARTBGMSC,1,!0));var n=this;return this.listener1=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"msgShowFreeStone",callback:function(e){n.getMessage(e.getUserData())}}),l.eventManager.addListener(this.listener1,1),!0},loadData:function(e){if(dp){var t=this;Ql.entertheme({type:Le.MANORMODE,mainenter:0},function(i,n){n?ju.Retry(n,function(){t.loadData(e)}):(t.loadServerData(i),e&&e())})}else e&&e()},loadServerData:function(e){if(void 0!==e){var t=wr.getModel(),i=t.usersData;t.stageType=Le.MANORMODE,this.nStarCount=e.star,t.setThemes(e.cfg),i.setTempleOpenLevel(e.openedlevel),i.setStarCount(this.nStarCount),i.setWaitTime(e.laststartime),this.luoboHonor=e.luobos,i.manormodeStars=e.dixiacoststar,i.resurgencediamondddu=e.resurgencediamond,e.buystar&&e.buystar instanceof Array&&(i.setConsumePropPriceById(1002,e.buystar[0]),i.setConsumePropPriceById(1003,e.buystar[1])),this.isUnlockNextlevel(),this.showCheckPoint(this.luoboHonor),i.setGoldCount(0);var n=i.getGoldCount();if(e.glb&&i.setGoldCount(e.glb-n),i.setHonorCount(0),n=i.getTaskHonorCount(),e.zsj&&i.setHonorCount(e.zsj-n),this.addBGLayer(),this.addMenuLayer(),this.showMap(),this.nStarCount<(t.m_nGameMode===ge.HIGHERMODE?i.getHigherLifeStarByUM():i.getLifeStarWithTime())){var s=i.getWaitMS();this.GM=s.m,this.GS=s.s,this.loadCountDown()}(this.nStarCount<=5||t.usersData.isLifeForever())&&this.spRightStarMore.setVisible(!1),this.UpdateStar(0);var r=this;lp&&SDKInterface.getFriendList(50,function(e){i.setFriendList(e),r.sendFriendsList(e)}),l.addTimePoint("levelSel_end"),l.addTimePoint("levelSel_start","levelSel_end")}},isUnlockNextlevel:function(){var e=wr.getModel(),t=e.usersData.getTempleOpenedLevel();for(var i in this.luoboHonor){var n=this.luoboHonor[i],s=n[0],r=n[1];if(s==t&&r>0){e.usersData.setTempleOpenLevel(t+1);break}}},sendFriendsList:function(e){var t=this;if(dp){t.friends=e;var i=[];for(var n in e)i.push(e[n].id);Ql.cgetfriendsinfo(Le.MANORMODE,i,function(e){t.loadFriendsData(e.friends)})}},loadFriendsData:function(e){if(void 0!=e){var t=[],i=GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook?"":100;for(var n in e){var s=e[n];for(var r in this.friends){var a=this.friends[r];if(a.id!==l.playerInfo.openid){if(a.id===s.openid){s.photo=a.photo+i,s.name=a.name;break}}else s.photo=l.playerInfo.photo,s.name=l.playerInfo.name}var o=s.stage;o>=136&&o<156&&t.push(s)}this.friends=t,this.addFriendsLayer()}},addFriendsLayer:function(){var e=wr.getModel(),t=e.usersData;t.setFriendList(this.friends);for(var i in this.friends){var n=this.friends[i];if(n.openid!==l.playerInfo.openid){var s=n.stage;if(!(s===t.getTempleOpenedLevel()||s<136&&s>155)){s>155&&(s=155);var r=e.mapConfig.allLevels[s-1].ptLevelNum;this.createUserHead(n.photo,n.name,r,n.openid)}}}},createUserHead:function(e,t,i,n){if(void 0!=i){var s=new l.Sprite("stage_avatar_single.png");s.setAnchorPoint(.5,0),s.setPosition(i.x,i.y-s.height/2+85),this.mBgLayer.addChild(s,n);var r=e,a=null;if(r)a=Rt.createPhotoSprite(),Rt.loadUserPhoto(r,a);else{var o=l.spriteFrameCache.getSpriteFrame("UserHead.png");(a=new l.Sprite(o)).setScale(1.2)}return a&&(a.setPosition(s.width/2,s.height/2),s.addChild(a,-1),s.setScale(.8)),s}},onExit:function(){this.listener1&&l.eventManager.removeListener(this.listener1),this.listener&&l.eventManager.removeListener(this.listener),wr.getModel().selLayer=null,this.unschedule(this.UpdateFailTime),this.unschedule(this.AnimateShowRouteMapSchedule),this.unschedule(this.DisCountTimeUpdate),qu.clearOwner(this),this.removeAllChildren(),this._super()},onEnterTransitionDidFinish:function(){this._super()},loadResources:function(){qu.addRes(this,"res/Themes/LevelSelect/LevelSel03-hd.plist"),qu.addRes(this,"res/Themes/LevelSelect/LevelSel01-hd.plist"),qu.addRes(this,"res/Themes/LevelSelect/LevelSel02-hd.plist");var e=wr.getModel().usersData.m_nLanguage,t=String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.plist",e.toString(),e.toString());qu.addRes(this,t);var i=String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",e.toString(),e.toString());qu.addRes(this,i)},addBGLayer:function(){for(var e=wr.getModel(),t=e.usersData,i=nr.share().getWinSize(),n=1;n<=2;n++){var s;switch(s=1===n?"#stagemap_d1.png":"#stagemap_d2.png",(u=new l.Sprite(s)).setAnchorPoint(0,0),u.setPosition((n-1)*he,0),this.spriteItemsRouteMap.addChild(u,1),n){case 2:var r=t.getThemeHonor(9);if(r){var a=new l.Sprite(1==r?"themeaward_cup.png":3==r?"themeaward_cup_clear.png":5==r?"themeaward_cup_mission.png":"themeaward_cup_clearandmission.png");a.setPosition((n-1)*he+518,409),this.mBgLayer.addChild(a,101),(o=new l.Sprite("themeaward_cover_d.png")).setPosition((n-1)*he+518,409),this.mBgLayer.addChild(o,101,1809)}else{var o=new l.Sprite("stageani_d.png");o.setPosition((n-1)*he+520,411),this.spriteItemsRouteMap.addChild(o,100)}}}e.mapConfig.allLevels.length;for(var h=136;h<156;h++){var d=e.mapConfig.allLevels[h-1],c=d.ptLevelNum,u=null,p=dp?this.getCurLevelHonor(h):t.getFirstHonor(h);if(p>0)switch(p){case 1:u=new l.Sprite(t.getTaskHonor(h)?"stagepoint_mission_wood.png":"stagepoint_wood.png");break;case 2:u=new l.Sprite(t.getTaskHonor(h)?"stagepoint_mission_silver.png":"stagepoint_silver.png");break;case 3:u=new l.Sprite(t.getTaskHonor(h)?"stagepoint_mission_gold.png":"stagepoint_gold.png")}else u=0!=d.nBossModeSecond?new l.Sprite("stagepoint_boss.png"):d.bPresentGate?new l.Sprite("stagepoint_gate.png"):new l.Sprite("stagepoint_adv.png");u&&(u.setPosition(c),this.spriteItems.addChild(u,3,k+h))}dp||this.showMap();var m=new l.Sprite("stagemap_smoke_1.png");m.setPosition(-m.width/2,i.height-m.height/2-200),this.mBgLayer.addChild(m,102),m.runAction(l.repeatForever(l.sequence(l.moveTo(30,2*he+m.width/2,i.height-m.height/2-200),l.moveTo(0,-m.width/2,i.height-m.height/2-200))));var _=new l.Sprite("stagemap_smoke_2.png");_.setPosition(-_.width/2,i.height-_.height/2+100),this.mBgLayer.addChild(_,102),_.runAction(l.repeatForever(l.sequence(l.moveTo(20,2*he+_.width/2,i.height-_.height/2+100),l.moveTo(0,-_.width/2,i.height-_.height/2+100))))},getCurLevelHonor:function(e){for(var t in this.luoboHonor){var i=this.luoboHonor[t],n=i[0],s=i[1];if(e===n)return s}return 0},showCheckPoint:function(e){if(void 0!=e&&e.length)for(var t=wr.getModel().usersData,i=0;i<e.length;i++){var n=e[i],s=n[0],r=n[1],a=n[2],o=n[3];t.setLevelFirstHonor(s,r,0),a&&(t.setLevelFinishTask(s,1,0),t.setLevelFinishTask(s,2,0),t.setLevelFinishTask(s,3,0)),o&&t.setLevelClearHonor(s)}},showMap:function(){var e=wr.getModel(),t=e.usersData,i=nr.share().getWinSize(),n=t.getTempleOpenedLevel();e.mapConfig.allLevels[n-1].ptLevelNum;this.xOffSet=i.width/2-e.usersData.xOffsetLevelSelCircle,this.xOffSet>0&&(this.xOffSet=0),this.xOffSet<-2*he+i.width&&(this.xOffSet=-2*he+i.width),this.mBgLayer.setPosition(this.xOffSet,0);t.bWinNewLevel&&t.getTempleOpenedLevel()>135?(this.ShowRouteMap(1,t.getTempleOpenedLevel()-135-1),this.AnimateShowRouteMap(t.getTempleOpenedLevel()-135-1,t.getTempleOpenedLevel()-135)):(this.ShowRouteMap(1,t.getTempleOpenedLevel()-135),this.ShowCircleAnimate()),this.showUserHead()},addMenuLayer:function(){var e=nr.share().getWinSize(),t=new l.Sprite("stagemap_toolbar_leftbg.png");t.setAnchorPoint(0,1),t.setPosition(0,e.height),this.addChild(t,98,98);var i=this.menuItemWithFile("stagemap_toolbar_back.png",V,l.p(61,54)),n=this.menuItemWithFile("stagemap_toolbar_shop.png",z,l.p(162,54)),s=this.menuItemWithFile("stagemap_toolbar_leaderboard.png",X,l.p(262.4,54)),r=Eo.createWithArray([i,n,s]);r.setPosition(0,0),r.setAnchorPoint(0,0),t.addChild(r),this.spRightMenu=new l.Sprite("stagemap_toolbar_rightbg.png"),this.spRightMenu.setAnchorPoint(1,1),this.spRightMenu.setPosition(e.width,e.height),this.addChild(this.spRightMenu,99,599);var a=wr.getModel();this.spRightStarMore=this.spRightMenu.getChildByTag(767),this.spRightStarMore||(this.spRightStarMore=new l.Sprite(a.m_nGameMode==ge.HIGHERMODE?"stagemap_toolbar_floor.png":"stagemap_toolbar_overten.png"),this.spRightStarMore.setAnchorPoint(0,0),this.spRightStarMore.setPosition(0,0),this.spRightMenu.addChild(this.spRightStarMore,767)),this.nStarCount=a.usersData.getGameStars(),(this.nStarCount<=5||a.usersData.isLifeForever())&&this.spRightStarMore.setVisible(!1);var o=a.usersData.getRouletteTime(this.RM,this.RS);if(this.RouletteState=o.result&&!1,this.RM=o.m,this.RS=o.s,this.RouletteState){var h=new l.Sprite("wheel_btn_bg.png");h.setAnchorPoint(.5,.5),h.setPosition(.5*e.width,e.height+20),this.addChild(h,99,x),h.runAction(l.repeatForever(l.rotateBy(8,360)));var d=null,c=!0;a.m_bFeast&&a.m_oFeast.getCurFeastType()==mn?(d=this.menuItemWithFile("wheel_btn_allday.png",Q,l.p(100,100),"wheel_btn_allday.png"),c=!1):d=this.menuItemWithFile("wheel_btn.png",Q,l.p(100,100),"wheel_btn.png");var u=Eo.createWithArray([d]);u.setPosition(.5*e.width-100,e.height-105),this.addChild(u,99,N),c&&(this.labelRouletteMinute=new l.LabelAtlas(String.formatC("%02lu",this.RM).toString(),"num_white_18.png",18,30,"./0123456789"),this.labelRouletteMinute.setAnchorPoint(.5,.5),this.labelRouletteMinute.setPosition(76,46),d.addChild(this.labelRouletteMinute),this.labelRouletteSecond=new l.LabelAtlas(String.formatC("%02lu",this.RS).toString(),"num_white_18.png",18,30,"./0123456789"),this.labelRouletteSecond.setAnchorPoint(.5,.5),this.labelRouletteSecond.setPosition(124,46),d.addChild(this.labelRouletteSecond),this.schedule(this.UpdateRouletteTime,1))}if(a.usersData.isLifeForever()){var p=new l.Sprite("stagemap_toolbar_unlimited.png");return p.setAnchorPoint(0,0),p.setPosition(0,0),void this.spRightMenu.addChild(p)}if(!dp){this.loadCountDown(),this.nStarCount=a.usersData.getGameStars();var m=a.usersData.getWaitMS();this.GM=m.m,this.GS=m.s,this.UpdateStar(0)}},loadCountDown:function(){this.spTime=this.menuItemWithFile("#stagemap_toolbar_timer_normal.png",kd.MENU_TIME,l.p(146,26),"#stagemap_toolbar_timer_pressed.png");var e=Vd.createWithArray([this.spTime]);e.setPosition(0,0),e.setAnchorPoint(0,0),this.spRightMenu.addChild(e,-2,6);var t=String.formatC("%02lu",this.GM);this.lableMinute=new l.LabelAtlas(t,"num_white_18.png",18,30,"./0123456789"),this.lableMinute&&(this.lableMinute.setAnchorPoint(0,0),this.lableMinute.setPosition(30,42),this.spTime.addChild(this.lableMinute),this.lableSecond=new l.LabelAtlas(String.formatC("%02lu",this.GS),"num_white_18.png",18,30,"./0123456789"),this.lableSecond&&(this.lableSecond.setAnchorPoint(0,0),this.lableSecond.setPosition(76,42),this.spTime.addChild(this.lableSecond)))},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){var i=wr.getModel();if(i.bLockMenu)return!0;var n=this.getChildByTag(U);if(n&&n.isVisible())return!0;this.mMoveLength=0;var s=this.convertTouchToNodeSpace(e);s.x=s.x-this.xOffSet;for(var r=Math.floor(this.xOffSet/he),a=-1,o=10*(r*=-1);o<10*(r+2);o++)if(o<i.mapConfig.allLevels.length){var h=i.mapConfig.allLevels[o].ptLevelNum;if(l.pDistance(h,s)<30){a=o+1;break}}return a>0&&a<=i.usersData.getTempleOpenedLevel()&&(this.spriteSelectItem=this.mBgLayer.getChildByTag(k+a),this.spriteSelectItem&&this.spriteSelectItem.setScale(1.2)),!0},ccTouchMoved:function(e,t){if(!wr.getModel().bLockMenu){var i=this.getChildByTag(U);if(!i||!i.isVisible()){var n=nr.share().getWinSize(),s=this.convertTouchToNodeSpace(e),r=e.getPreviousLocationInView();r=l.director.convertToGL(r),r=this.convertToNodeSpace(r),s=l.director.convertToGL(s),s=this.convertToNodeSpace(s);var a=l.pSub(s,r);this.mMoveLength+=-a.x,this.mMoveLength>0?this.bLeft&&(this.bLeft=!this.bLeft):this.bRight&&(this.bRight=!this.bRight),(this.mMoveLength>=30||this.mMoveLength<=-30)&&this.spriteSelectItem&&(this.spriteSelectItem.setScale(1),this.spriteSelectItem=null),this.mDis=8*a.x,a.y=0;var o=l.pAdd(this.mBgLayer.getPosition(),a);o.x>0?(o.x=0,this.bLeft||(this.bLeft=!0)):o.x<1*-he+n.width-he&&(o.x=1*-he+n.width-he,this.bRight||(this.bRight=!0)),this.xOffSet=o.x,this.mBgLayer.setPosition(o)}}},ccTouchEnded:function(e,t){var i=wr.getModel();if(!i.showRewardLayer){var n=this.convertTouchToNodeSpace(e),s=this.getChildByTag(5678);if(s&&s.isVisible()){var r=s.getChildByTag(7);r&&l.rectContainsPoint(r.getBoundingBox(),n)&&(this.shareMessage(),Tt.onShare("sina-weibo","goldcup"));var a=s.getChildByTag(8);a&&l.rectContainsPoint(a.getBoundingBox(),n)&&this.shareMessage()}else if(!i.bLockMenu){var o=this.getChildByTag(U);if(o&&o.isVisible()){o.setVisible(!1);var h=this.getChildByTag(U+1);h&&h.isVisible()&&h.setVisible(!1);var d=this.getChildByTag(U+2);d&&d.isVisible()&&d.setVisible(!1);var c=this.getChildByTag(H);c&&c.isVisible()&&c.setVisible(!1);g=this;return l.addTimePoint("shopopen_s"),void qu.loadResAsync(ri,function(){var e=fo.create(3);g.addChild(e,100)})}var u=i.usersData.getGameStars();if(!i.usersData.isLifeForever()&&u>=5&&this.spRightMenu){var p,m=this.spRightMenu.getContentSize();if(p=0!=this.DisGM||0!=this.DisGS?l.rect(this.spRightMenu.x-m.width,this.spRightMenu.y-m.height,m.width,m.height):l.rect(this.spRightMenu.x-m.width,this.spRightMenu.y-m.height+40,m.width,m.height),l.rectContainsPoint(p,n)){g=this;return l.addTimePoint("LifeRequestDlg_s"),void qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(2),g.addChild(e,99,199)})}}if((this.mDis<-4||this.mDis>4)&&this.SlowDownShow(),this.spriteSelectItem&&(this.spriteSelectItem.setScale(1),this.spriteSelectItem=null),this.mMoveLength<30&&this.mMoveLength>-30&&!this.ClickOnLevelItem(n)){var _=this.mBgLayer.convertTouchToNodeSpace(e);if((s=this.mBgLayer.getChildByTag(1809))&&l.rectContainsPoint(s.getBoundingBox(),_)){var g=this;Ql.opengoldencup(function(e){qu.loadResAsync(gi,function(){g.showCheckPoint(e.luobos),g.showThemeHonor()})})}}}}},shareMessage:function(){var e=this;GamePlatform.getCurrentPlatForm()==PlatformType.QQ?kl.shareScreenshot(Wl.REWARD_SHARE,function(t){t&&e._rewardSpr&&(e._rewardSpr.removeFromParent(),e._rewardSpr=null)}):kl.shareMessage(null,"",Wl.REWARD_SHARE,0,12,null,function(t){t&&e._rewardSpr&&(e._rewardSpr.removeFromParent(),e._rewardSpr=null)})},keyBackClicked:function(){var e=wr.getModel();e.bLockMenu||(e.playSoundWithType($.MTMENUSELECT),qi.preloadWithLoadingTag(Yd.getUsedRes(),we.LEVELSEL),e.bBackMainScene=!0)},showFriendsDlg:function(){},showLevelDlg:function(){},showLevelInfo:function(e){var t=wr.getModel(),i=this,n=[],s=t.getCurTheme(),r=t.usersData.m_nLanguage,a=String.formatC("res/Themes/Maps/BG%02lu-hd",e),o=String.formatC("res/Themes%s/Maps/BG%02lu-hd%s",r,e,r);n.push(Ki(a+".png")),n.push(Ki(a+".plist")),n.push(Ki(o+".png")),n.push(Ki(o+".plist")),n.push(Ki(String.formatC("res/Themes/Theme%d/BG-hd.plist",s))),n.push(Ki(String.formatC("res/Themes/Theme%d/BG-hd.png",s))),l.addTimePoint("LevelInfoDlg_s"),qu.loadResAsync(n,function(){var n=Ra.create();(dp?i.getCurLevelHonor(e):t.usersData.getFirstHonor(e))>0?t.usersData.getTaskHonor(e)?n.SetShowLayer(1):n.SetShowLayer(2):n.SetShowLayer(1),i.addChild(n,99)})},menuCallback:function(e){if(!this.getChildByTag(Fo)){var t=wr.getModel(),i=this;switch(t.playSoundWithType($.MTMENUSELECT),e.getTag()){case V:qi.preloadWithLoadingTag(Yd.getUsedRes(),we.LEVELSEL),t.bBackMainScene=!0;break;case z:l.addTimePoint("shopopen_s"),qu.loadResAsync(ri,function(){var e=fo.create(1);i.addChild(e,100)});break;case Y:if(t.usersData.isLifeForever())break;l.addTimePoint("LifeRequestDlg_s"),qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(vr.LEVEL),i.addChild(e,99,199)});break;case X:l.addTimePoint("friendHonorDlgopen_s"),qu.loadResAsync(Ni,function(){var e=Mr.create();e.showFriends(vr.ALL),i.addChild(e,99)});break;case Q:var n=this.getChildByTag(x);n&&n.runAction(l.moveBy(.2,0,300));var s=this.getChildByTag(N);s&&s.runAction(l.moveBy(.2,0,300)),qu.loadResAsync(ai,function(){var e=_c.create();i.addChild(e,99)});break;case Z:this.unschedule(this.DisCountTimeUpdate),qu.loadResAsync(Ii,function(){var e=yr.create();i.addChild(e,100)});break;case j:l.director.getScheduler().isWaite=!1,(r=this.getChildByTag(5678))&&r.isVisible()&&(r.setVisible(!1),t.bLockMenu=!1),(r=this.getChildByTag(256))&&r.isVisible()&&(r.setVisible(!1),t.bLockMenu=!1,this.msgRateCallFun(this,1));break;case K:var r=this.getChildByTag(256);r&&r.isVisible()&&(r.setVisible(!1),t.bLockMenu=!1),this.msgRateCallFun(this,0)}}},menuItemWithFile:function(e,t,i,n){var s=new l.Sprite(e),r=null;r=null==n?new l.Sprite(e):new l.Sprite(n);var a=new l.MenuItemSprite(s,r,null,this.menuCallback.bind(this),this);return a.setTag(t),a.setPosition(i),a},SlowDownShow:function(){var e=nr.share().getWinSize(),t=l.p(this.mDis,0),i=l.pAdd(this.mBgLayer.getPosition(),t);this.mDis=0,i.x<1*-he+e.width-he&&(i.x=1*-he+e.width-he),i.x>0&&(i.x=0);var n=l.moveTo(1,i);this.mBgLayer.stopActionByTag(1e3),n.setTag(1e3),this.mBgLayer.runAction(n.easing(l.easeExponentialOut())),this.xOffSet=i.x},ShowRouteMap:function(e,t){for(var i=e;i<t;i++){var n=nr.share().getWinSize(),s=0;3<i&&i<15&&(s=1);var r=!1;3!=i&&14!=i||(s=1,r=!0);var a=new l.Sprite(String.formatC("route_d%d-%d.png",i,i+1).toString());r?a.setPosition(he*s,n.height/2):a.setPosition(he*s+he/2,n.height/2),this.spriteItemsRouteMap.addChild(a,2)}},AnimateShowRouteMap:function(e,t){e>0&&(this.mFrom=e,this.mTo=t,this.schedule(this.AnimateShowRouteMapSchedule,.02))},AnimateShowRouteMapSchedule:function(e){var t=nr.share().getWinSize();if(null==this.spriteRoute){i=String.formatC("route_d%d-%d.png",this.mFrom,this.mTo);this.spriteRoute=new l.Sprite(i.toString()),this.spriteItemsRouteMap.addChild(this.spriteRoute,2)}else{var i=String.formatC("route_d%d-%d.png",this.mFrom,this.mTo),n=l.spriteFrameCache.getSpriteFrame(i.toString());this.spriteRoute.setSpriteFrame(n)}if(this.spriteRoute){var s=this.spriteRoute.getTextureRect(),r=wr.getModel(),a=r.mapConfig.allLevels[this.mFrom+135-1].ptLevelNum,o=r.mapConfig.allLevels[this.mTo+135-1].ptLevelNum;a.x>=o.x?a.y>=o.y?s.width>=s.height?this.mMoveDirection=Mo:this.mMoveDirection=Bo:s.width>=s.height?this.mMoveDirection=Mo:this.mMoveDirection=yo:a.y>=o.y?s.width>=s.height?this.mMoveDirection=Co:this.mMoveDirection=Bo:s.width>=s.height?this.mMoveDirection=Co:this.mMoveDirection=yo,this.mTimes+=1;var h=6*this.mTimes,d=0;3<this.mFrom&&this.mFrom<14&&(d=1);var c=!1;3!=this.mFrom&&14!=this.mFrom||(d=1,c=!0),this.mMoveDirection==Co?(h>s.width&&(h=s.width),this.spriteRoute.setTextureRect(l.rect(s.x,s.y,s.width-s.width+h,s.height)),c?this.spriteRoute.setPosition(he*d-(s.width-h)/2,t.height/2):this.spriteRoute.setPosition(he*d+he/2-(s.width-h)/2,t.height/2),h>=s.width&&(this.mTimes=0,this.EndAnimateShowRouteMapSchedule())):this.mMoveDirection==Mo?(h>s.width&&(h=s.width),this.spriteRoute.setTextureRect(l.rect(s.x+s.width-h,s.y,h,s.height)),c?this.spriteRoute.setPosition(he*d+(s.width-h)/2,t.height/2):this.spriteRoute.setPosition(he*d+he/2+(s.width-h)/2,t.height/2),h>=s.width&&(this.mTimes=0,this.EndAnimateShowRouteMapSchedule())):this.mMoveDirection==Bo?(h>s.height&&(h=s.height),this.spriteRoute.setTextureRect(l.rect(s.x,s.y,s.width,h)),c?this.spriteRoute.setPosition(l.p(he*d,t.height/2+(s.height-h)/2)):this.spriteRoute.setPosition(l.p(he*d+he/2,t.height/2+(s.height-h)/2)),h>=s.height&&(this.mTimes=0,this.EndAnimateShowRouteMapSchedule())):(h>s.height&&(h=s.height),this.spriteRoute.setTextureRect(l.rect(s.x,s.y+s.height-h,s.width,h)),c?this.spriteRoute.setPosition(l.p(he*d,t.height/2-(s.height-h)/2)):this.spriteRoute.setPosition(l.p(he*d+he/2,t.height/2-(s.height-h)/2)),h>=s.height&&(this.mTimes=0,this.EndAnimateShowRouteMapSchedule()))}},EndAnimateShowRouteMapSchedule:function(){this.unschedule(this.AnimateShowRouteMapSchedule),wr.getModel().usersData.setWinNewLevel(!1),this.ShowCircleAnimate()},ShowCircleAnimate:function(){var e=wr.getModel(),t=e.usersData.getTempleOpenedLevel();t<136&&(t=136);var i=e.mapConfig.allLevels[t-1].ptLevelNum,n=new l.Sprite("stagemap_local.png");n.setPosition(i),this.spriteItems.addChild(n,2),n.setScale(.1),n.runAction(l.repeatForever(l.sequence(l.scaleTo(.6,1.4),l.spawn(l.fadeTo(.4,0),l.scaleTo(.4,2)),l.delayTime(.6),l.spawn(l.fadeTo(0,255),l.scaleTo(0,.1)))));var s=new l.Sprite("stagemap_local.png");s.setPosition(i),this.spriteItems.addChild(s,2),s.setScale(.1);var r=l.callFunc(this.Circle2Animate.bind(this,s));s.runAction(l.sequence(l.hide(),l.delayTime(.3),l.show(),r));var a=new l.Sprite("stagemap_local.png");a.setPosition(i),this.spriteItems.addChild(a,2),a.setScale(.1);var o=l.callFunc(this.Circle2Animate.bind(this,a));a.runAction(l.sequence(l.hide(),l.delayTime(.6),l.show(),o))},ClickOnLevelItem:function(e){var t=wr.getModel(),i=t.usersData;e.x=e.x-this.xOffSet;this.xOffSet;for(var n=-1,s=0;s<20;s++)if(s<t.mapConfig.allLevels.length){var r=t.mapConfig.allLevels[s+135].ptLevelNum;if(l.pDistance(r,e)<50){n=s+1;break}}if(n>0){if(n+135>i.getTempleOpenedLevel())return!0;if(t.setCurLevel(n+135),!t.usersData.canPlay()){var a=this;return qu.loadResAsync(xi,function(){a.m_dlg=Qc.create(),a.m_dlg.setOnCloseCallback(a,a.onCloseCallback.bind(a)),a.addChild(a.m_dlg,99)}),!0}return t.playSoundWithType($.MTPAGESELECT),this.showLevelInfo(n+135),!0}return!1},ClickOnFriendHead:function(e){e.x=e.x-this.xOffSet;var t=this.xOffSet/he;t*=-1;for(var i=wr.getModel(),n=10*t;n<=10*(t+2);n++)if(n<=i.mapConfig.allLevels.length);return!1},ClickOnUserMeHead:function(e){if(null==this.spHeadBG)return!1;var t=this.spHeadBG.getPosition();if(t.y+=25,l.pDistance(t,e)<this.spHeadBG.width/2){var i=wr.getModel();i.setCurLevel(i.usersData.getOpenedLevel());var n=this;return l.addTimePoint("friendHonorDlgopen_s"),qu.loadResAsync(Ni,function(){var e=Mr.create();e.showFriends(vr.LEVEL),n.addChild(e,99)}),!0}return!1},showThemeHonor:function(){var e=wr.getModel();e.bLockMenu=!0;var t=e.usersData.m_nLanguage,i=String.formatC("res/Themes%s/LevelSelect/AwardBG%s.plist",t,t);qu.addRes(this,i),qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",t));var n=nr.share().getMapOffset(),s=this.getChildByTag(5678);if(null==s){var r=nr.share().getWinSize(),a=new l.LayerColor(l.color(0,0,0,178),r.width,r.height);this.addChild(a,5678,5678);var o=new l.Sprite("themeaward_bg.png");o.setPosition(.5*r.width,.5*r.height),a.addChild(o,2,2);for(var h=[l.p(182+n.width,440),l.p(329+n.width,440),l.p(477+n.width,440),l.p(625+n.width,440),l.p(773+n.width,440),l.p(182+n.width,199),l.p(329+n.width,199),l.p(477+n.width,199),l.p(625+n.width,199),l.p(773+n.width,199)],d=1;d<11;d++){var c=e.usersData.getThemeHonor(d),u=new l.Sprite(0==c?"themeaward_disable.png":1==c?"themeaward_cup.png":3==c?"themeaward_cup_clear.png":5==c?"themeaward_cup_mission.png":"themeaward_cup_clearandmission.png");u.setPosition(h[d-1]),a.addChild(u,5)}var p=new l.Sprite("popup_close_frame.png");p.setPosition(867+n.width,575),a.addChild(p,6,6);var m=this.menuItemWithFile("popup_close.png",j,l.p(867+n.width,575)),_=new l.Menu(m);_.setPosition(0,0),a.addChild(_,15,15);var g=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,T=GamePlatform.isCN()?g?"themeaward_share_qq.png":"themeaward_share_wechat.png":"themeaward_share.png",f=new l.Sprite(T);f.setPosition(60+n.width,207),a.addChild(f,7,7),e.usersData.isShareWeChat()||GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook||(this._rewardSpr=new l.Sprite("themeaward_share_wechat_new.png"),this._rewardSpr.setAnchorPoint(1,.5),this._rewardSpr.setPosition(23,.5*f.height),f.addChild(this._rewardSpr))}else s.setVisible(!0)},ShineBgAnimate:function(){var e=this.getChildByTag(U),t=l.fadeTo(.3,128),i=l.fadeTo(.3,255),n=l.repeatForever(l.sequence(t,i));e.runAction(n)},UpdateFailTime:function(e){0!=this.GM||0!=this.GS?(0==this.GS?(this.GS=59,this.GM--):this.GS--,this.UpdateStar(3),this.m_dlg&&this.m_dlg.UpDateTimes()):this.UpdateStar(1)},UpdateRouletteTime:function(e){if(0!=this.RM||0!=this.RS)0==this.RS?(this.RS=59,this.RM--,this.labelRouletteMinute.setString(String.formatC("%02lu",this.RM).toString())):this.RS--,this.labelRouletteSecond.setString(String.formatC("%02lu",this.RS).toString());else{var t=this.getChildByTag(x);t&&t.runAction(l.moveBy(.2,0,300));var i=this.getChildByTag(N);i&&i.runAction(l.moveBy(.2,0,300)),this.unschedule(this.UpdateRouletteTime);var n=wr.getActivedModel();if(n){var s=n.usersData.getRouletteTime(this.RM,this.RS);this.RM=s.m,this.RS=s.s}}},UpdateDiscountTime:function(e){if(0!=this.DisGM||0!=this.DisGS)0==this.DisGS?(this.DisGS=59,this.DisGM--):this.DisGS--;else{this.unschedule(this.UpdateDiscountTime);var t=this.spRightMenu.getChildByTag(W);t&&t.setVisible(!1)}},ShowNewFigureAnimate:function(){var e=wr.getModel(),t=e.usersData;e.usersData.showFigureAnimateInLevelSel(!1);var i=nr.share().getWinSize(),n=new l.LayerColor(l.color(0,0,0,178),i.width,i.height);this.addChild(n,9999,U+2),qu.addRes(this,"res/Themes/Items/Common_shine_bg-hd.plist");var s=this.getChildByTag(U);null==s?((s=new l.Sprite("shine_bg.png")).setPosition(i.width/2,i.height/2),this.addChild(s,9999,U)):s.setVisible(!0),s.setScale(.1);var r=l.scaleTo(.2,1),a=l.callFunc(this.ShineBgAnimate.bind(this,s));s.runAction(l.sequence(r,a));var o=this.getChildByTag(H);null==o?((o=new l.Sprite("newcarrot_bg.png")).setPosition(nr.share().getMapOffset().width+482,333),this.addChild(o,9999,H)):o.setVisible(!0),o.setScale(.1);var h=o.getChildByTag(1);if(t.isUnlockCarrot(ue.CARROT_OLD)){null==h?((h=new l.Sprite("shop_carrot_old.png")).setPosition(l.p(o.width/2,o.height/2+100)),o.addChild(h,1,1)):h.stopAllActions();for(var d=[],c=1;c<=2;++c){_=String.formatC("shop_carrot_old_%d.png",c);d.push(l.spriteFrameCache.getSpriteFrame(_.toString()))}for(var u=new l.Animation(d,.1),p=[],m=1;m<=3;++m){var _=null;_=3!=m?String.formatC("shop_carrot_old_%d.png",m):String.formatC("shop_carrot_old.png"),p.push(l.spriteFrameCache.getSpriteFrame(_.toString()))}var g=new l.Animation(p,.1),T=l.sequence(l.delayTime(2),l.animate(u),l.animate(u),l.animate(u),l.animate(g));h.runAction(l.repeatForever(T))}else if(t.isUnlockCarrot(ue.CARROT_FAT)){var f=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat.png");null==h?((h=new l.Sprite(f)).setPosition(o.width/2,o.height/2+100),o.addChild(h,1,1)):h.stopAllActions();var S=[],w=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_1.png"),v=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_2.png"),L=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_3.png"),M=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_4.png");S.push(w),S.push(v),S.push(L),S.push(v),S.push(w),S.push(v),S.push(L),S.push(v),S.push(M),S.push(f);var C=new l.Animation(S,.1),y=l.sequence(l.delayTime(2),l.animate(C));h.runAction(l.repeatForever(y))}else if(t.isUnlockCarrot(ue.CARROT_GIRL)){var B=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl.png");null==h?((h=new l.Sprite(B)).setPosition(o.width/2,o.height/2+100),o.addChild(h,1,1)):h.stopAllActions();var F=[],E=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_1.png"),P=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_2.png"),b=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_3.png"),A=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_4.png");F.push(E),F.push(P),F.push(b),F.push(A),F.push(E),F.push(P),F.push(b),F.push(A),F.push(B);var O=new l.Animation(F,.1),I=l.sequence(l.delayTime(2),l.animate(O));h.runAction(l.repeatForever(I))}var R=new l.Sprite("newcarrot_cover.png");R.setPosition(o.width/2,o.height/2),o.addChild(R),o.runAction(l.scaleTo(.3,1))},Circle2Animate:function(e){e.runAction(l.repeatForever(l.sequence(l.scaleTo(.6,1.4),l.spawn(l.fadeTo(.4,0),l.scaleTo(.4,2)),l.delayTime(.6),l.spawn(l.fadeTo(0,255),l.scaleTo(0,.1)))))},showLoadingStars:function(){var e=nr.share().getWinSize(),t=wr.getModel();t.usersData.m_nLanguage;this.m_loadingBg=new l.Sprite("loading_bg.png"),this.addChild(this.m_loadingBg),this.m_loadingBg.setPosition(.5*e.width,.5*e.height),this.m_loadingBg.setOpacity(0),this.m_loadingBg.setScale(2);for(var i=t.usersData.getGameStars(),n=l.spriteFrameCache.getSpriteFrame("loading_star.png"),s=l.spriteFrameCache.getSpriteFrame("loading_star_back.png"),r=387,a=r,o=0;o<5;o++){var h=new l.Sprite(s);if(h.setPosition(r,380),this.m_loadingBg.addChild(h),i>o){var d=new l.Sprite(n);d.setPosition(r,380),d.setScale(.5),this.m_loadingBg.addChild(d),a=r+81}r+=81}var c=new l.Sprite(n);c.setPosition(a,380),c.setScale(.5),this.m_loadingBg.addChild(c),this.m_loadingBg.runAction(l.spawn(l.scaleTo(.2,1),l.fadeTo(.2,255),null));var u=l.callFunc(this.lostLoadingUpdate.bind(this,c));c.runAction(l.sequence(l.delayTime(1),l.spawn(l.moveTo(.6,e.width/2,e.height/2),l.sequence(l.spawn(l.flipX(!0),l.scaleTo(.1,.15,1.5)),l.spawn(l.flipX(!1),l.scaleTo(.5,11.5)))),u,l.hide())),this.loadResources()},showAD:function(){if(this.bCanShowAD){var e=wr.getModel();e.bBackMainScene&&!e.usersData.noAD()&&(e.bBackMainScene=!1)}},lostLoadingUpdate:function(){var e=wr.getModel();this.removeChild(this.m_loadingBg,!0),l.director.getScheduler().isWaite=!1,e.playMuiscWithType($.MTSTARTBGMSC,1,!0),this.registerWithTouchDispatcher(),this.bCanShowAD=!0,this.showAD()},lostLoadingStarcount:function(){var e=wr.getModel().usersData.getStarCount();this.spStarcounter||(this.spStarcounter=new l.Sprite("loading_star_counter.png"),this.m_loadingBg.addChild(this.spStarcounter),this.spStarcounter.setPosition(559,250),this.spStarcounter.setTag(798));var t=this.spStarcounter.getChildByTag(11);t&&this.spStarcounter.removeChild(t,!0);var i=this.spStarcounter.getChildByTag(5879);if(null==i){i=new l.LabelAtlas(String.formatC("%02d",e).toString(),"num_white_18.png",18,30,"./0123456789");var n=l.p(115,36);e>99&&(i.setScale(.8),n=l.p(115,38)),i.setPosition(n),this.spStarcounter.addChild(i,0,11)}i.setVisible(!0),e>=5?this.spStarcounter.setVisible(!0):this.spStarcounter.setVisible(!1)},shotCurScreen:function(){l.log("%s","shot cur screen");var e=nr.share().getWinSize(),t=new l.RenderTexture(e.width,e.height),i=this;if(t&&i){t.begin();for(var n=0;n<i.getChildren().length;n++){var s=i.getChildren()[n];4!=s.getTag()&&15!=s.getTag()&&1e3!=s.getTag()&&1001!=s.getTag()&&61!=s.getTag()&&s.visit()}t.end(),t.cleanup(),t.setPosition(e.width/2,e.height/2);var r="game.jpg";t.saveToFile(r.toString())}},lifeForeverUpdate:function(){this.unschedule(this.UpdateFailTime),this.spRightMenu.removeAllChildren();var e=new l.Sprite("stagemap_toolbar_unlimited.png");e&&(e.setAnchorPoint(0,0),e.setPosition(0,0),this.spRightMenu.addChild(e))},lifeStarMoreUpdate:function(){var e=wr.getModel();if(this.nStarCount=e.usersData.getGameStars(),!(this.nStarCount<5)){for(var t=1;t<6;t++){var i=this.spRightMenu.getChildByTag(t);i&&i.setVisible(!1)}var n=this.spRightStarMore.getChildByTag(11),s=String.formatC(GamePlatform.isCN()?"%03d":"%02d",this.nStarCount);if(null==n){if(!(n=new l.LabelAtlas(s,"num_white_18.png",18,30,"./0123456789")))return;n.setPosition(GamePlatform.isCN()?190:203,64),this.spRightStarMore.addChild(n,0,11)}else n.setString(s);n.setVisible(!0),this.spRightStarMore.setVisible(!0),this.spTime&&this.nStarCount>=e.usersData.getLifeStarWithTime()&&(this.spTime.setVisible(!1),this.m_spTips&&(this.m_spTips.setPosition(32,12),e.usersData.YSLoseTimes>2&&this.m_spTips.setVisible(!1)))}},getFriendPoint:function(e){var t=l.p(0,0);if(this.spriteItems){var i=this.spriteItems.getChildByTag(k+e);i&&((t=i.getPosition()).y+=i.height*(1-i.anchorY))}return t},UpdateStar:function(e){if(!(n=wr.getModel()).usersData.isLifeForever())switch(e){case 0:a=[78,66,110,154,198,242];if(this.nStarCount>5)this.lifeStarMoreUpdate();else for(h=1;h<6;h++){var t=l.p(a[h],a[0]),i=null;if(!(i=this.nStarCount>=h?new l.Sprite(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png"):new l.Sprite(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png")))return;i.setPosition(t),this.spRightMenu.addChild(i,1,h)}this.nStarCount<n.usersData.getLifeStarWithTime()?this.schedule(this.UpdateFailTime,1):(this.spTime&&this.spTime.setVisible(!1),this.m_spTips&&(this.m_spTips.setPosition(32,12),n.usersData.YSLoseTimes>2&&this.m_spTips.setVisible(!1)));break;case 1:case 2:case 4:var n=wr.getModel();this.nStarCount=n.usersData.getGameStars();p=n.usersData.getWaitMS(this.GM,this.GS);if(this.GM=p.m,this.GS=p.s,1==e){var s=this.getChildByTag(199);s&&s.UpdateStars(this.nStarCount)}if(!this.spRightMenu)break;var r=this.spRightMenu.getChildByTag(this.nStarCount);if(null==r)if(this.nStarCount<=5&&this.nStarCount>0){if(!(m=l.spriteFrameCache.getSpriteFrame(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png")))return;var i=this.spRightMenu.getChildByTag(this.nStarCount),a=[78,66,110,154,198,242];i=new l.Sprite(m);t=l.p(a[this.nStarCount],a[0]);i.setPosition(t),this.spRightMenu.addChild(i,1,this.nStarCount)}else 4!=e&&this.lifeStarMoreUpdate();if(r&&e<4){if(this.nStarCount<=5){if(!(m=l.spriteFrameCache.getSpriteFrame(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png")))return;if(1==e){for(var o=[],h=1;h<4;h++){var d=String.formatC((n.m_nGameMode==ge.HIGHERMODE?"floor_":"")+"lifestar_flash%d.png",h),c=l.spriteFrameCache.getSpriteFrame(d);if(!c)return;o.push(c)}o.push(m);var u=new l.Animation(o,.1);r.runAction(l.animate(u))}else r.setSpriteFrame(m)}else this.lifeStarMoreUpdate();if(this.nStarCount>=n.usersData.getLifeStarWithTime()){var p=n.usersData.getLifeForeverPCutTime();this.LifeForeverPCut=p.result,this.LifeForeverPCut}}else if(4==e)if(this.nStarCount<=5)for(h=1;h<6;h++){var m=null;if(!(m=this.nStarCount>=h?l.spriteFrameCache.getSpriteFrame(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png"):l.spriteFrameCache.getSpriteFrame(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png")))return;a=[78,66,110,154,198,242];if(null==(i=this.spRightMenu.getChildByTag(h))){if(!(i=new l.Sprite(m)))return;t=l.p(a[h],a[0]);i.setPosition(t),this.spRightMenu.addChild(i,1,h)}else i.setSpriteFrame(m)}else this.lifeStarMoreUpdate();case 3:if(this.nStarCount>=n.usersData.getLifeStarWithTime()){if(this.unschedule(this.UpdateFailTime),this.spTime){var t=this.spTime.getPosition(),_=l.moveTo(1,t.x,t.y+300);this.spTime.runAction(_)}}else{var g=String.formatC("%02lu",this.GM);this.lableMinute.setString(g.toString());var T=String.formatC("%02lu",this.GS);this.lableSecond.setString(T.toString())}}},actionUpdateStar:function(){var e=wr.getActivedModel();if(e){var t=e.usersData.getRouletteTime(this.RM,this.RS);this.RM=t.m,this.RS=t.s}this.UpdateStar(4)},showUserHead:function(){var e=wr.getModel(),t=e.usersData;t.setWinNewLevel(!1);var i=e.mapConfig.allLevels[t.getTempleOpenedLevel()-1].ptLevelNum;this.spHeadBG=this.createUserHead(l.playerInfo.photo,l.playerInfo.name,i,101)},msgRateCallFun:function(e,t){var i=wr.getModel(),n=i.usersData;0==t?i.usersData.goCommented=i.getCurSystemTime():n.getOpenedLevel()>=20?n.goCommented=2:n.getOpenedLevel()>=10&&(n.goCommented=1)},showRateDlg:function(){var e=wr.getModel();e.bLockMenu=!0,qu.addRes(this,"res/Themes/Items/pingfen-hd.plist");var t=e.usersData.m_nLanguage,i=String.formatC("res/Themes%s/Items/pingfen-hd%s.plist",t.toString(),t.toString());qu.addRes(this,i);var n=nr.share().getWinSize(),s=new l.LayerColor(l.color(0,0,0,178),n.width,n.height);this.addChild(s,256,256);var r=new l.Sprite("news_bg.png");r.setPosition(nr.share().getMapOffset().width+460,312),s.addChild(r);var a=null,o=new l.Sprite("rate.jpg");(a=new l.MenuItemSprite(o,null,null,this,this.menuCallback.bind(this))).setTag(K);var h=l.p(.536*r.width,.534*r.height);a.setPosition(h);var d=new l.Menu(a);d.setPosition(0,0),r.addChild(d);var c=this.menuItemWithFile("news_close.png",j,l.p(nr.share().getMapOffset().width+840,488)),u=new l.Menu(c);u.setPosition(0,0),s.addChild(u,10)},weiboCallBack:function(){wr.getModel().usersData.bhadLogin||Tt.onReward("weibo-levelsel-login",1)},pingFenCallBack:function(){},RouletteUpdate:function(){var e=this.getChildByTag(x);if(e){i=l.sequence(l.moveBy(.2,0,-330),l.moveBy(.1,0,30));e.runAction(i)}var t=this.getChildByTag(N);if(t){var i=l.sequence(l.moveBy(.2,0,-330),l.moveBy(.1,0,30));t.runAction(i)}},getMessage:function(e){l.log("\r\n========Show free stone dialog=========="),this.showFreeStone()},showFreeStone:function(){var e=this;qu.loadResAsync(Ti,function(){var t=Wa.create();t.setPosition(0,0),t.spTopFrame=null,e.addChild(t,2e3,2e3),t.setShowAdWall()});var t=wr.getModel();t&&(t.bLockMenu=!0)},ShowDiscountMenu:function(){var e=null,t=null;switch(wr.getModel().usersData.discountSelect){case le.SALE_FIGUREGIRL_10:e="discount_tag_girl.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_FIGUREFAT_15:e="discount_tag_fat.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_FIGUREOLD_15:e="discount_tag_old.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_STONE_750_15:case le.SALE_STONE_480_10:e="discount_tag_stone.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_6zhe.png");break;case le.SALE_STONE_300_6:e="discount_tag_stone.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_STONE_150_4:e="discount_tag_stone.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_9zhe.png");break;case le.SALE_STONE_100_2:e="discount_tag_stone.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_6zhe.png");break;case le.SALE_BOMB_4_2:e="discount_tag_bomb.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_BLOOD_4_2:e="discount_tag_blood.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_SPEED_10_2:e="discount_tag_speed.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_6zhe.png");break;case le.SALE_ICE_6_2:e="discount_tag_ice.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_SLOW_6_2:e="discount_tag_slow.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_PACKAGEPLATINUM_6:e="discount_tag_pack.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_THEME_4_6:e="discount_tag_theme4.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_THEME_5_4:e="discount_tag_theme5.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_THEME_6_6:e="discount_tag_theme6.png",t=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png")}var i=nr.share().getWinSize();this.removeChildByTag(G);var n=this.menuItemWithFile(e,Z,l.p(100,50),e);if(t){var s=new l.Sprite(t);s.setPosition(n.width/2,n.height/2),n.addChild(s)}var r=Eo.createWithArray([n]);r.setPosition(.5*i.width-100,i.height-99),this.addChild(r,99,G)},ChangeDiscountMenuItem:function(){wr.getModel().usersData.GetDisCountSale()},DisCountTimeUpdate:function(e){var t=wr.getModel(),i=t.usersData.GetDisCountTime();i.h,i.m,i.s;i.result||(t.usersData.GetDisCountSale(),this.ShowDiscountMenu())},onCloseCallback:function(){this.m_dlg=null}});Po.create=function(){return new Po},Po.scene=function(){var e=new l.Scene,t=Po.create();return nr.share().scaleScene(t),e.addChild(t,0,2),e.loadData=t.loadData.bind(t),e};var bo=Zs.extend({closeBack:null,ctor:function(){this._super(Ks.DT_TITLE)},addChildItems:function(){var e=.5,t=nr.share().isIPad();nr.share().isIPad()&&(e=1);var i=wr.getModel();i.creepsTask(J.UNKNOW,J.UNKNOW,0,void 0),this.addChildSprite(this.spMainFrame,l.p(412*e,509*e),"ingame_title_mission.png",l.p(.5,.5),2);var n=new l.Sprite("ingame_stagenum_bg.png");n.setPosition(115*e,445*e),this.spMainFrame.addChild(n,3);var s=i.getObjectByType(J.WAVES),r=s.szTile;if(t&&(r=l.size(2*r.width,2*r.height)),i.curLevel<136&&i.curLevel>0)(d=new l.LabelAtlas("000",s.strPic,r.width,r.height,"./0123456789")).setString(String.formatC("%.2lu",i.curLevel)),d.setAnchorPoint(.5,.5),d.setPosition(50*e,118*e),n.addChild(d);else if(i.curLevel>135&&i.curLevel<mr){var a=i.curLevel>155&&i.curLevel<156,o=a?135:155,h=new l.Sprite(a?"themenum_d.png":"themenum_q.png");h.setPosition(33*e,118*e),n.addChild(h);var d=new l.LabelAtlas("000",s.strPic,r.width,r.height,"./0123456789");d.setString(String.formatC("%.2lu",i.curLevel-o)),d.setAnchorPoint(0,.5),d.setPosition(42*e,118*e),n.addChild(d)}var c=183*e,u=l.spriteFrameCache.getSpriteFrame("ingame_mission_infobg.png");if(i.mapConfig.allLevels[i.curLevel-1]){var p=i.tasks,m=0;if(p){m=p.length;for(var _=0;_<m;_++){var g=new l.Sprite(u);g.setPosition(c,326*e),this.spMainFrame.addChild(g,2),0==g.width&&(g.width=230),0==g.height&&(g.height=300),c+=g.width;var T=p[_];if(void 0!==T){if(T){var f=String.formatC("micon_b%lu.png",T.nImgIndex);l.log(f,""),this.addChildSprite(g,l.p(g.width/2,g.height/2+70*e),String.formatC("micon_b%lu.png",T.nImgIndex)),this.addChildSprite(g,l.p(g.width/2,g.height/2+70*e),String.formatC("micon_s%lu.png",T.nMissionNum)),this.addChildSprite(g,l.p(g.width/2,g.height/2-6*e),String.formatC("mission%lu_%d.png",i.curLevel,_+1))}var S=this.addChildSprite(g,l.p(g.width/2,g.height/2-104*e),"ingame_stone.png");if(S){var w=S.getContentSize(),v=new l.Sprite("shop_gem.png");v.setAnchorPoint(.5,.5),v.setScale(1.45),v.setPosition(40,.5*w.height+2),S.addChild(v)}if(this.addChildSprite(g,l.p(g.width/2,g.height/2-104*e),String.formatC("ingame_mission_add%ld.png",T.getGoldCoins())),T.isFinished())this.addChildSprite(g,l.p(0,-120*e),T.isSuccessful()?"ingame_mission_checked.png":"ingame_mission_lose.png",l.p(0,0));else{var L=new l.Sprite("ingame_mission_resultbg.png");if(L.setPosition(g.width/2,-L.height/2),g.addChild(L),T.dataType>se.KILLMONSTER){var M=T,C=M.getActionTime()-i.gameLastTime;C<0&&(C=0);var y=!0;M.getActionTime()<6e3?(this.addChildSprite(L,l.p(66*e,88*e),"ingame_mission_time.png"),this.addChildSprite(L,l.p(146*e,88*e),"ingame_mission_time_sep.png"),this.addChildLabel(L,l.p(120*e,88*e),r,String.formatC("%02ld",Math.floor(C/60))),this.addChildLabel(L,l.p(172*e,88*e),r,String.formatC("%02ld",C%60))):y=!1,this.addChildSprite(L,l.p(66*e,y?46*e:68*e),se.FINDTOWER==T.dataType?"ingame_mission_tower.png":se.KILLOBJECT==T.dataType?"ingame_mission_target.png":"ingame_mission_money.png"),se.EARNMONEY==T.dataType?this.addChildLabel(L,l.p(146*e,y?46*e:68*e),r,String.formatC("%ld",Math.abs(T.getFinishCount()))):(this.addChildSprite(L,l.p(146*e,y?46*e:68*e),"ingame_mission_time_sprit.png"),this.addChildLabel(L,l.p(120*e,y?46*e:68*e),r,String.formatC("%02ld",Math.abs(T.getFinishCount()))),this.addChildLabel(L,l.p(172*e,y?46*e:68*e),r,String.formatC("%02ld",Math.abs(T.getTaskCount()))))}else{this.addChildSprite(L,l.p(66*e,68*e),se.KILLMONSTER==T.dataType?"ingame_mission_monster.png":"ingame_mission_tower.png");var B=Math.abs(T.getFinishCount()),F=T.isLessMore()?T.getTaskCount()-1:T.getTaskCount();this.addChildLabel(L,l.p(F>99?150*e:120*e,68*e),r,String.formatC(F>99?"%03lu":"%02lu",B)),se.KILLMONSTER==T.dataType&&F>99||(this.addChildSprite(L,l.p(146*e,68*e),"ingame_mission_time_sprit.png"),this.addChildLabel(L,l.p(172*e,68*e),r,String.formatC("%02lu",F)))}}}}}}},loadResources:function(){wr.getModel().usersData.m_nLanguage},changeStoneCount:function(){},onExit:function(){wr.getModel();qu.clearOwner(this),this.closeBack&&this.closeBack(),this.removeAllChildren(!0),this._super()},ccTouchBegan:function(e,t){},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},addChildSprite:function(e,t,i,n,s){n=n||l.p(.5,.5),s=s||0;var r=new l.Sprite(i);return r.setAnchorPoint(n),r.setPosition(t),0!=s?e.addChild(r,s):e.addChild(r),r},addChildLabel:function(e,t,i,n,s,r){r=r||"num_white_18.png",s=s||0;var a=new l.LabelAtlas("00",r,i.width,i.height,"./0123456789");a.setString(n),a.setAnchorPoint(.5,.5),a.setPosition(t),e.addChild(a,s)}});bo.create=function(){return new bo};var Ao=1e3,Oo=1001,Io=1002,Ro=1004,Do=1005,xo=1006,No=1007,Go=1008,Wo=1009,ko=1010,Uo=1011,Ho=1012,Vo=1013,zo=1014,Yo=1015,Xo=Xs.extend({m_spLoin:null,m_spLogout:null,m_spChart:null,m_spArch:null,m_layer1:null,m_layer2:null,m_layer3:null,bSet:!1,listener:null,ctor:function(){this._super(),this.addLayerName("scene-setting")},init:function(){this._super();var e=.5;nr.share().isIPad()&&(e=1);wr.getActivedModel();GamePlatform.isCN()?qu.addRes(this,"res/Themes/scene/setting-hd.plist"):(qu.addRes(this,"res/Themes_en/scene/settingbg-hd_en.plist"),qu.addRes(this,"res/Themes_en/scene/setting-hd_en.plist")),this.registerWithTouchDispatcher();var t=nr.share().getWinSize(),i=new l.Sprite("option_bg.png");i.setPosition(t.width/2,t.height/2),this.addChild(i);var n=nr.share().getMapOffset(),s=new l.Sprite("option_title_setting_active.png");s.setPosition(n.width+257*e,569*e),s.setTag(Ao),this.addChild(s);var r=this.menuItemWithFile("popup_close.png",I,l.p(n.width+865*e,526*e)),a=new l.Menu(r);if(a.setPosition(0,0),this.addChild(a),this.AddLayer1(),!GamePlatform.isCN()){var o=new l.Sprite("option_title_data_active.png");o.setPosition(n.width+478*e,569*e),o.setTag(Oo),this.addChild(o);var h=new l.Sprite("option_title_about_active.png");h.setPosition(n.width+699*e,569*e),h.setTag(Io),this.addChild(h),this.AddLayer2(),this.AddLayer3()}return this.ShowLayer(1),l.addTimePoint("setting_e"),l.printTimePoint("setting_s","setting_e"),!0},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),cd(),qu.clearOwner(this),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},menuCallback:function(e){var t=wr.getModel();t.ktOrSetingWeiBo=!1;var i=this.getChildByTag(5678);if(!(i&&i.isVisible()||t.bLockMenu)){var n=e;switch(n.getTag()){case Ho:break;case I:l.addTimePoint("GO_MAIN_S"),t.playSoundWithType($.MTMENUSELECT),qu.loadResAsync(Ht,function(){var e=Hu.scene(),t=new l.TransitionSlideInB(.2,e);l.director.runScene(t),ju.changeScene(e)});break;case Ro:t.playSoundWithType($.MTPAGESELECT),t.usersData.soundFX=!t.usersData.soundFX;a=null;a=t.usersData.soundFX?String.formatC("option_soundfx_on.png"):String.formatC("option_soundfx_off.png"),this.changeMenuItemWithType(t.usersData.soundFX,n,a.toString()),this.saveChangeBGM();break;case Do:t.playSoundWithType($.MTPAGESELECT),t.usersData.bgMusic=!t.usersData.bgMusic;a=null;a=t.usersData.bgMusic?String.formatC("option_bgmusic_on.png"):String.formatC("option_bgmusic_off.png"),this.changeMenuItemWithType(t.usersData.bgMusic,n,a.toString()),t.playMuiscWithType($.MTSTARTBGMSC,t.usersData.bgMusic?1:2,!0),this.saveChangeBGM();break;case Yo:case xo:break;case No:this.showRestTip(),t.playSoundWithType($.MTPAGESELECT);break;case Go:t.playSoundWithType($.MTPAGESELECT),(s=t.usersData).iCloudOpen=!s.iCloudOpen,t.gameCenter&&t.gameCenter.setICloudOpend(s.iCloudOpen),s.iCloudOpen&&t.gameCenter&&t.gameCenter.runICloudForData(!0);a=null;a=s.iCloudOpen?String.formatC("option_gamecenter_on.png"):String.formatC("option_gamecenter_off.png"),this.changeMenuItemWithType(s.iCloudOpen,n,a.toString()),t.gameCenter&&t.gameCenter.statistics(3,1);break;case Wo:case ko:t.playSoundWithType($.MTPAGESELECT);break;case Uo:t.playSoundWithType($.MTPAGESELECT);var s=t.usersData;s.gameCenterOn=!s.gameCenterOn,this.m_spChart.setOpacity(s.gameCenterOn?255:122),this.m_spArch.setOpacity(s.gameCenterOn?255:122),this.m_spChart.setEnabled(!!s.gameCenterOn),this.m_spArch.setEnabled(!!s.gameCenterOn);var r=this.m_spArch.getNormalImage().getChildByTag(2);r&&r.setOpacity(s.gameCenterOn?255:122),(r=this.m_spChart.getNormalImage().getChildByTag(2))&&r.setOpacity(s.gameCenterOn?255:122);var a=null;a=s.gameCenterOn?String.formatC("option_gamecenter_on.png"):String.formatC("option_gamecenter_off.png"),this.changeMenuItemWithType(s.gameCenterOn,n,a.toString());break;case Vo:Tt.onEvent("login-weibo");break;case zo:this.showLogOutTip()}}},saveChangeBGM:function(){var e=wr.getModel();fd(e.usersData.soundFX,Fd(ql.t_soundFX)),fd(e.usersData.bgMusic,Fd(ql.t_bgMusic))},menuItemWithFile:function(e,t,i,n){var s=new l.Sprite(e),r=null;r=null==n?new l.Sprite(e):new l.Sprite(n);var a=new l.MenuItemSprite(s,r,null,this,this.menuCallback.bind(this));return s.setAnchorPoint(l.p(.5,.5)),s.setPosition(.5*a.width,.5*a.height),r.setAnchorPoint(.5,.5),r.setPosition(.5*a.width,.5*a.height),r.setScale(null==n?1.2:1),a.setTag(t),a.setPosition(i),a},menuItemWithFile1:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a,1,2)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},getMenuItemWithType:function(e,t,i,n){var s=null;s=e?l.spriteFrameCache.getSpriteFrame("option_switch_on.png"):l.spriteFrameCache.getSpriteFrame("option_switch_off.png");var r=new l.Sprite(s);r.setTag(1);var a=new l.Sprite(n);a.setPosition(0,0),a.setAnchorPoint(0,0),a.setTag(1),r.addChild(a);var o=new l.Sprite(s);o.setTag(2);var h=new l.Sprite(n);h.setPosition(0,0),h.setAnchorPoint(0,0),h.setTag(1),o.addChild(h);var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setPosition(i),d.setTag(t),d},changeMenuItemWithType:function(e,t,i){var n=null,s=null;n=e?l.spriteFrameCache.getSpriteFrame("option_switch_on.png"):l.spriteFrameCache.getSpriteFrame("option_switch_off.png");var r=t.getChildByTag(l.NORMAL_TAG);r.setSpriteFrame(n),s=l.spriteFrameCache.getSpriteFrame(i),r.getChildByTag(1).setSpriteFrame(s);var a=t.getChildByTag(l.SELECTED_TAG);a.setSpriteFrame(n),s=l.spriteFrameCache.getSpriteFrame(i),a.getChildByTag(1).setSpriteFrame(s)},ccTouchBegan:function(e,t){return!0},ccTouchEnded:function(e,t){var i=this.convertTouchToNodeSpace(e);nr.share().isIPad();var n=wr.getModel(),s=this.getChildByTag(5678);if(s&&s.isVisible())if((a=s.getChildByTag(3))&&l.rectContainsPoint(a.getBoundingBox(),i)){n.bLockMenu=!1,s.setVisible(!1),n.usersData.iCloudOpen=!1;String.formatC("option_gamecenter_off.png");n.usersData.resetUsersData(),Tt.onEvent("reset")}else(a=s.getChildByTag(5))&&l.rectContainsPoint(a.getBoundingBox(),i)&&(n.bLockMenu=!1,s.setVisible(!1));else{var r=this.getChildByTag(5679);if(r&&r.isVisible()){var a=r.getChildByTag(3);a&&l.rectContainsPoint(a.getBoundingBox(),i)?(n.bLockMenu=!1,r.setVisible(!1),this.refreshHead(),this.refreshHead()):(a=r.getChildByTag(5))&&l.rectContainsPoint(a.getBoundingBox(),i)&&(n.bLockMenu=!1,r.setVisible(!1))}else if(!n.bLockMenu){var o=this.getChildByTag(Ao),h=o.getContentSize(),d=l.rect(o.x-h.width/2,o.y-h.height/2,h.width,h.height);if(l.rectContainsPoint(d,i))return n.playSoundWithType($.MTMENUSELECT),void this.ShowLayer(1);var c=this.getChildByTag(Oo);if(c){var u=c.getContentSize(),p=l.rect(c.x-u.width/2,c.y-u.height/2,u.width,u.height);if(l.rectContainsPoint(p,i))return n.playSoundWithType($.MTMENUSELECT),void this.ShowLayer(2)}var m=this.getChildByTag(Io);if(m){var _=m.getContentSize(),g=l.rect(m.x-_.width/2,m.y-_.height/2,_.width,_.height);if(l.rectContainsPoint(g,i))return n.playSoundWithType($.MTMENUSELECT),void this.ShowLayer(3)}}}},ccTouchMoved:function(e,t){},refreshHead:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=this.m_layer1.getChildByTag(9006);t&&t.removeFromParent(),(t=this.m_layer1.getChildByTag(9007))&&t.removeFromParent();var i=nr.share().getMapOffset();this.m_layer1.removeChildByTag(9005,!0),l.log("load text_login");var n=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,s=GamePlatform.isCN()?n?"option_setting_from_qq.png":"option_setting_from_wechat.png":"suser_fromweibo.png",r=l.spriteFrameCache.getSpriteFrame(s);if(r){l.log("frmeStr :"+s);var a=new l.Sprite(r);a.setPosition(i.width+754*e,382*e),this.m_layer1.addChild(a,999,9001)}var o=null,h=l.p(i.width+562*e,430*e);if(l.playerInfo.photo?(o=Rt.createPhotoSprite(),Rt.loadUserPhoto(l.playerInfo.photo,o)):(r=l.spriteFrameCache.getSpriteFrame("UserHead.png"),o=new l.Sprite(r)),o){o.setPosition(h),this.m_layer1.addChild(o,999,9002);var d=new l.Sprite("option_setting_avatar.png");d.setPosition(h),this.m_layer1.addChild(d,999,9e3),h.x=d.x+d.width-30}var c="";l.playerInfo.name&&l.playerInfo.name.length&&(c=l.playerInfo.name);var u=new l.LabelTTF(Rt.cutString(c),"Arial",22);u.setAnchorPoint(0,.5),u.setPosition(h.x,h.y+15),this.m_layer1.addChild(u,999,9003),(u=new l.LabelTTF("ID:"+l.playerInfo.id,"Arial",18)).setAnchorPoint(0,.5),u.setPosition(h.x,h.y-18),this.m_layer1.addChild(u,999,9003)},showConnecting:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=nr.share().getMapOffset();this.m_spLoin.setVisible(!1);var i=this.m_layer1.getChildByTag(9005);i&&i.setVisible(!1),(i=new l.Sprite("option_wait_title.png")).setPosition(664*e+t.width,429*e),this.m_layer1.addChild(i,999,9006);var n=new l.Sprite("option_wait_1.png");n.setPosition(668*e+t.width,282*e),this.m_layer1.addChild(n,999,9007);var s=[],r=l.spriteFrameCache.getSpriteFrame("option_wait_1.png"),a=l.spriteFrameCache.getSpriteFrame("option_wait_2.png"),o=l.spriteFrameCache.getSpriteFrame("option_wait_3.png");s.push(r),s.push(a),s.push(o);var h=new l.Animation(s,.5),d=new l.sequence(l.animate(h));n.runAction(l.repeatForever(d))},keyBackClicked:function(){var e=wr.getModel();e.playSoundWithType($.MTMENUSELECT),e.bLockMenu||qu.loadResAsync(Ht,function(){var e=Hu.scene(),t=new l.TransitionSlideInB(.2,e);l.director.runScene(t)})},showRestTip:function(){wr.getModel().bLockMenu=!0;var e=.5;nr.share().isIPad()&&(e=1);var t=this.getChildByTag(5678);if(null==t){var i=nr.share().getWinSize(),n=new l.LayerColor(l.color(0,0,0,178),i.width,i.height);this.addChild(n,5678,5678);var s=new l.Sprite("woodbg_notice.png");s.setPosition(.5*i.width,.5*i.height),n.addChild(s);for(var r=[l.p(480*e,474*e),l.p(478*e,346*e),l.p(480*e,280*e),l.p(346*e,216*e),l.p(346*e,216*e),l.p(618*e,216*e),l.p(618*e,216*e)],a=["option_reset_title.png","option_reset_text.png","sepline_s.png","btn_blue_m.png","option_reset_btn.png","btn_green_m.png","btn_green_m_cancel.png"],o=0;o<7;o++){var h=new l.Sprite(a[o]);h.setPosition(nr.share().getMapOffset().width+r[o].x,r[o].y),n.addChild(h,o,o)}}else t.setVisible(!0)},showLogOutTip:function(){wr.getModel().bLockMenu=!0;var e=.5;nr.share().isIPad()&&(e=1);var t=this.getChildByTag(5679);if(null==t){var i=nr.share().getWinSize(),n=new l.LayerColor(l.color(0,0,0,178),i.width,i.height);this.addChild(n,5679,5679);var s=new l.Sprite("woodbg_notice.png");s.setPosition(.5*i.width,.5*i.height),n.addChild(s);for(var r=[l.p(480*e,474*e),l.p(478*e,346*e),l.p(480*e,280*e),l.p(346*e,216*e),l.p(346*e,216*e),l.p(618*e,216*e),l.p(618*e,216*e)],a=["option_reset_title.png","option_logout_text.png","sepline_s.png","btn_blue_m.png","option_logout_btn.png","btn_green_m.png","btn_green_m_cancel.png"],o=0;o<7;o++){var h=new l.Sprite(a[o]);h.setPosition(nr.share().getMapOffset().width+r[o].x,r[o].y),n.addChild(h,o,o)}}else t.setVisible(!0)},AddLayer1:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel();this.m_layer1=new l.Layer,this.m_layer1.setVisible(!1),this.addChild(this.m_layer1);var i=nr.share().getMapOffset(),n=new l.Sprite("option_setting_bg.png");n.setPosition(i.width+477*e,305*e),this.m_layer1.addChild(n);var s=null;s=t.usersData.soundFX?String.formatC("option_soundfx_on.png"):String.formatC("option_soundfx_off.png");var r=this.getMenuItemWithType(t.usersData.soundFX,Ro,l.p(i.width+356*e,434*e),s.toString());s=t.usersData.bgMusic?String.formatC("option_bgmusic_on.png"):String.formatC("option_bgmusic_off.png");var a=this.getMenuItemWithType(t.usersData.bgMusic,Do,l.p(i.width+356*e,282*e),s.toString()),o=new l.Menu(r,a);o.setPosition(0,0),this.m_layer1.addChild(o),this.refreshHead(),t.usersData.bhadLogin},AddLayer2:function(){var e=wr.getModel(),t=.5;nr.share().isIPad()&&(t=1),this.m_layer2=new l.Layer,this.m_layer2.setVisible(!1),this.addChild(this.m_layer2);var i=nr.share().getMapOffset(),n=new l.Sprite("option_data_bg.png");n.setPosition(i.width+478*t,300*t),this.m_layer2.addChild(n);var s=null;s=e.usersData.gameCenterOn?String.formatC("option_gamecenter_on.png"):String.formatC("option_gamecenter_off.png");var r=this.getMenuItemWithType(e.usersData.gameCenterOn,Uo,l.p(i.width+288*t,328*t),s.toString());s=e.usersData.iCloudOpen?String.formatC("option_gamecenter_on.png"):String.formatC("option_gamecenter_off.png");var a=this.getMenuItemWithType(e.usersData.iCloudOpen,Go,l.p(i.width+288*t,470*t),s.toString());this.m_spChart=this.menuItemWithFile1("btn_blue_m.png",Wo,l.p(i.width+244*t,233*t),"btn_blue_m_pressed.png","option_data_chart.png"),this.m_spArch=this.menuItemWithFile1("btn_blue_m.png",ko,l.p(i.width+244*t,141*t),"btn_blue_m_pressed.png","option_data_arch.png");var o=new l.Menu(r,a,this.m_spChart,this.m_spArch);o.setPosition(0,0),this.m_layer2.addChild(o,0,68),o.visible=!1;var h=e.getObjectByType(J.WAVES),d=h.szTile;nr.share().isIPad()&&(d=l.size(2*d.width,2*d.height));var c=new l.LabelAtlas("000",h.strPic,d.width,d.height,"./0123456789");c.setString(String.formatC("%lu/155",e.usersData.getGoldCount())),c.setAnchorPoint(1,.5),c.setPosition(i.width+808*t,463*t),this.m_layer2.addChild(c,31,69),(c=new l.LabelAtlas("000",h.strPic,d.width,d.height,"./0123456789")).setString(String.formatC("%lu/155",e.usersData.getTaskHonorCount())),c.setAnchorPoint(1,.5),c.setPosition(i.width+808*t,383*t),this.m_layer2.addChild(c,31,70),(c=new l.LabelAtlas("000",h.strPic,d.width,d.height,"./0123456789")).setString(String.formatC("%lu",e.usersData.getAllMoney())),c.setAnchorPoint(1,.5),c.setPosition(i.width+808*t,302*t),this.m_layer2.addChild(c,31),(c=new l.LabelAtlas("000",h.strPic,d.width,d.height,"./0123456789")).setString(String.formatC("%lu",e.usersData.getKillMonsters())),c.setAnchorPoint(1,.5),c.setPosition(i.width+808*t,220*t),this.m_layer2.addChild(c,31),(c=new l.LabelAtlas("000",h.strPic,d.width,d.height,"./0123456789")).setString(String.formatC("%lu",e.usersData.getClearObjects())),c.setAnchorPoint(1,.5),c.setPosition(i.width+808*t,138*t),this.m_layer2.addChild(c,31),this.m_spChart.setOpacity(e.usersData.gameCenterOn?255:122),this.m_spArch.setOpacity(e.usersData.gameCenterOn?255:122)},AddLayer3:function(){var e=.5;nr.share().isIPad()&&(e=1),this.m_layer3=new l.Layer,this.m_layer3.setVisible(!1),this.addChild(this.m_layer3);var t=wr.getModel(),i=nr.share().getMapOffset(),n=null;(n=t.usersData.IsShowEnToCn()?new l.Sprite("option_about_bg_whb.png"):new l.Sprite("option_about_bg.png")).setPosition(i.width+508*e,298*e),this.m_layer3.addChild(n);var s=new l.LabelTTF("1.8.2","Helvetica",20*e);this.m_layer3.addChild(s),s.setPosition(i.width+290*e,385*e);var r=nr.share().getWinSize(),a=new l.LabelTTF("","Arial",20*e);a&&(a.setAnchorPoint(0,.5),a.setPosition((r.width-a.width)/2,20*e),this.m_layer3.addChild(a))},ShowLayer:function(e){var t=this.getChildByTag(Ao),i=this.getChildByTag(Oo),n=this.getChildByTag(Io);switch(e){case 1:if(this.m_layer1.isVisible())return;this.m_layer1.setVisible(!0),this.m_layer2&&this.m_layer2.setVisible(!1),this.m_layer3&&this.m_layer3.setVisible(!1),(s=l.spriteFrameCache.getSpriteFrame("option_title_setting_active.png"))&&t&&t.setSpriteFrame(s),(s=l.spriteFrameCache.getSpriteFrame("option_title_data_disable.png"))&&i&&i.setSpriteFrame(s),(s=l.spriteFrameCache.getSpriteFrame("option_title_about_disable.png"))&&n&&n.setSpriteFrame(s);break;case 2:if(this.m_layer2&&this.m_layer2.isVisible()||!this.m_layer2)return;this.m_layer1.setVisible(!1),this.m_layer2.setVisible(!0),this.m_layer3.setVisible(!1),(s=l.spriteFrameCache.getSpriteFrame("option_title_setting_disable.png"))&&t&&t.setSpriteFrame(s),(s=l.spriteFrameCache.getSpriteFrame("option_title_data_active.png"))&&i&&i.setSpriteFrame(s),(s=l.spriteFrameCache.getSpriteFrame("option_title_about_disable.png"))&&n&&n.setSpriteFrame(s);break;case 3:if(this.m_layer3&&this.m_layer3.isVisible()||!this.m_layer3)return;this.m_layer1.setVisible(!1),this.m_layer2.setVisible(!1),this.m_layer3.setVisible(!0);var s=l.spriteFrameCache.getSpriteFrame("option_title_setting_disable.png");s&&t&&t.setSpriteFrame(s),(s=l.spriteFrameCache.getSpriteFrame("option_title_data_disable.png"))&&i&&i.setSpriteFrame(s),(s=l.spriteFrameCache.getSpriteFrame("option_title_about_active.png"))&&n&&n.setSpriteFrame(s)}}});Xo.create=function(){return new Xo},Xo.scene=function(){var e=new l.Scene,t=Xo.create();return e.addChild(t,0),nr.share().scaleScene(t),e};var jo=6,Ko=7,qo=8,Qo=Xs.extend({m_spBg:null,m_spShine:null,m_dlg:null,_dailywartime:0,_curday:0,_dailywarcoststar:0,_startBtn:null,ctor:function(){this._super()},init:function(){if(this._super()){this.m_spBg=null,this.m_spShine=null,this.m_dlg=null;var e=nr.share().getWinSize();qu.addRes(this,"res/Themes/scene/everyDayChallenge-hd.plist");var t=wr.getActivedModel(),i=t.usersData.m_nLanguage,n=String.formatC("res/Themes%s/scene/everyDayChallenge-hd%s.plist",i.toString(),i.toString());qu.addRes(this,n);var s=new l.LayerColor(l.color(0,0,0,178),e.width,e.height);this.addChild(s,0),this.m_spBg=new l.Sprite("daily_bg.png"),this.m_spBg.setPosition(e.width/2,e.height/2),this.addChild(this.m_spBg,2);var r=new l.Sprite("everyDay_close_frame.png");r.setPosition(820,534),this.m_spBg.addChild(r);var a=new l.Sprite("daily_cover.png");a.setPosition(462,345),this.m_spBg.addChild(a,1),this.m_spShine=new l.Sprite("daily_shine.png"),this.m_spShine.setVisible(!1),this.m_spShine.setPosition(0,0),this.m_spBg.addChild(this.m_spShine);var o=new l.Sprite("everyDay_green_b.png"),h=new l.Sprite("everyDay_green_b_pressed.png"),d=new l.Sprite("daily_btn_finished.png"),c=new l.MenuItemSprite(o,h,d,this,this.menuCallback.bind(this));c.setTag(Ko),c.setPosition(464,168),c.setEnabled(!1),this._startBtn=c,o=new l.Sprite("everyDay_close.png"),(h=new l.Sprite("everyDay_close.png")).setScale(1.2);var u=new l.MenuItemSprite(o,h,null,this,this.menuCallback.bind(this));u.setTag(jo),u.setPosition(820,534),o.setAnchorPoint(.5,.5),o.setPosition(.5*u.width,.5*u.height),h.setAnchorPoint(.5,.5),h.setPosition(.5*u.width,.5*u.height);var p=new l.Menu(c,u);if(p.setAnchorPoint(0,0),p.setPosition(0,0),this.m_spBg.addChild(p),dp)Ql.opendailywar(this.loadServerData.bind(this));else{for(var m=t.m_oChallenge.canPlay(),_=t.m_oChallenge.getPlayDay()-1,g=[],T=0,f=0;f<3;f++){S=l.p(301+161*f,473);T=f<_?-(f+1):f+1,this.addDayNum(S,T),g.push(T)}for(f=0;f<4;f++){var S=l.p(221+161*f,329);T=f+3<_?-(f+4):f+4,this.addDayNum(S,T),g.push(T)}if(m){this._startBtn.setEnabled(!0);var w=new l.Sprite("daily_btn_go.png");w.setPosition(464,168),this.m_spBg.addChild(w,3),this.seclectSpriteWithDay(_)}else this._startBtn.setEnabled(!1)}return!0}return!1},loadServerData:function(e){if(void 0!=e){var t=wr.getModel(),i=e.days;i>7&&(i=7),t.m_oChallenge.m_nPlayDays=this._curday=i,t.m_oChallenge.m_nPlayedTime=e.dailywartime,this._dailywarcoststar=e.cfg.dailywarcoststar,t.usersData.setStarCount(e.starcount),t.usersData.setWaitTime(e.laststartime),t.usersData.setOpenLevel(e.openedlevel);var n=t.m_oChallenge.canPlay();n&&i>=7&&(t.m_oChallenge.m_nPlayDays=this._curday=i=0);for(var s=[],r=0,a=0;a<3;a++){o=l.p(301+161*a,473);r=a<i?-(a+1):a+1,this.addDayNum(o,r),s.push(r)}for(a=0;a<4;a++){var o=l.p(221+161*a,329);r=a+3<i?-(a+4):a+4,this.addDayNum(o,r),s.push(r)}if(n=n&&s[i]&&s[i]>=1){this._startBtn.setEnabled(!0);var h=new l.Sprite("daily_btn_go.png");h.setPosition(464,168),this.m_spBg.addChild(h,3),this.seclectSpriteWithDay(this._curday)}else this._startBtn.setEnabled(!1),this.showShareBtn()}},showShareBtn:function(){if(7==this._curday){this._startBtn.setVisible(!1);var e=this,t=new l.Sprite("everyDay_green_b.png"),i=new l.Sprite("everyDay_green_b_pressed.png"),n=new l.MenuItemSprite(t,i,null,e,e.menuCallback.bind(e));n.setTag(qo),n.setPosition(464,168);var s=new l.Menu(n);s.setAnchorPoint(0,0),s.setPosition(0,0),e.m_spBg.addChild(s);var r=new l.Sprite(GamePlatform.isCN()?"themelocked_share_day.png":"themelocked_share.png");r.setPosition(.5*n.width,.5*r.height),n.addChild(r)}},onExit:function(){this.removeAllChildren();wr.getModel();qu.clearOwner(this),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},addDayNum:function(e,t){if(t<1)(i=new l.Sprite("daily_counter_check.png")).setPosition(e),this.m_spBg.addChild(i,1,-t);else{var i=new l.Sprite("daily_counter_bg.png");i.setPosition(e),this.m_spBg.addChild(i,1,t);var n=String.formatC("daily_counter_%d.png",t),s=new l.Sprite(n);s.setPosition(e),this.m_spBg.addChild(s,2)}},menuCallback:function(e){var t=e;if(!this.getChildByTag(2399)){var i=wr.getModel(),n=this;switch(t.getTag()){case jo:this.removeFromParent(!0),i.m_nGameMode=ge.NORMALMODE;break;case Ko:i.m_nGameMode=ge.CHALLENGEMODE;var s=i.usersData.getStarCount();!i.m_oChallenge.canPlay()||s<this._dailywarcoststar?qu.loadResAsync(xi,function(){n.m_dlg=Qc.create(!0),n.m_dlg.setOnCloseCallback(n,n.onCloseCallback.bind(n)),n.addChild(n.m_dlg,99,2399)}):i.m_oChallenge.playCurLevel();break;case qo:kl.shareMessageByDailyawardrecordIndex(b.Share_Title5,b.ShareText5,ye.DailywarAllOk_Share,0,7)}}},seclectSpriteWithDay:function(e){e<0?e=0:e>6&&(e=6);var t=this.m_spBg.getChildByTag(e+1);if(t){var i=t.getPosition();i.y-=43,this.m_spShine.setVisible(!0),this.m_spShine.setPosition(i)}},updateTimes:function(){this.m_dlg&&this.m_dlg.UpDateTimes()},onCloseCallback:function(){this.m_dlg=null}});Qo.create=function(){return new Qo};var Zo=45,Jo=30,$o=75,eh="Q0hQbGF5ZWRTdGF0ZSVk",th="Q0hQbGF5RGF5JWQ=",ih="Q0hQbGF5RGF5cw==",nh="Q0hDdXJMZXZlbERhdGE=",sh="Q0hQbGF5VGltZQ==",rh="Q0hQbGF5RGF0ZQ==",ah="Q0hDdXJNYXBDb25maWc=",oh="Q0hMZXZlbHNEYXRhQ291bnQ=",hh=l.Class.extend({m_nPlayDay:0,m_nPlayedState:0,ctor:function(e,t){arguments.length>0&&(e instanceof hh?(this.m_nPlayedState=e.m_nPlayedState,this.m_nPlayDay=e.m_nPlayedState):(this.m_nPlayedState=0,this.m_nPlayDay=t))},EraseConfig:function(){this.m_nPlayedState=0,this.m_nPlayDay=0},playedCurLevel:function(){this.m_nPlayedState=1},playCurLevel:function(e){this.m_nPlayedState=-1,this.m_nPlayDay=e},isPlayed:function(){return this.m_nPlayedState>0},isPlaying:function(){return this.m_nPlayedState<0},writeData:function(e){var t=String.formatC(Fd(eh),e);$l(this.m_nPlayedState,t.toString()),t=String.formatC(Fd(th),e),$l(this.m_nPlayDay,t.toString())},readData:function(e){var t=String.formatC(Fd(eh),e);this.m_nPlayedState=Zl(t.toString(),0),t=String.formatC(Fd(th),e),this.m_nPlayDay=Zl(t.toString(),0)}}),lh=l.Class.extend({m_pLevelsData:0,m_nPlayDate:0,m_nPlayDays:0,m_nPlayedTime:0,m_strMapName:"",m_nLevelStyle:0,m_nTheme:0,m_nCurMapConfig:0,m_nCurLevelIndex:0,m_bIntoGame:!1,ctor:function(){this.Init()},getPlayDay:function(){return this.m_nPlayDays},setPlayDay:function(e){if(e){var t=wr.getModel();this.m_nPlayedTime=t.getCurSystemTime();var i=this.m_nPlayedTime,n=new Date(i),s=3600*(24-n.getHours())-60*n.getMinutes()-59;this.m_nPlayedTime+=s,this.m_nPlayDays++,this.m_pLevelsData&&this.m_nCurLevelIndex>-1&&this.m_nCurLevelIndex<this.m_pLevelsData.length&&this.m_pLevelsData[this.m_nCurLevelIndex].playedCurLevel(),this.m_nCurLevelIndex=-1}},canPlay:function(){var e=wr.getModel(),t=new Date(1e3*e.getCurSystemTime()),i=new Date(1e3*this.m_nPlayedTime);return!(t.getDate()<=i.getDate()&&0!=this.m_nPlayedTime)},canShow:function(){if(this.m_bIntoGame)return this.m_bIntoGame=!1,!0;var e=wr.getModel().getCurSystemTime();if(this.m_nPlayedTime>e)return!1;var t=e,i=new Date(t).getDate();return i!=this.m_nPlayDate&&(this.m_nPlayDate=i,this.m_pLevelsData&&this.m_nCurLevelIndex>-1&&this.m_nCurLevelIndex<this.m_pLevelsData.length&&this.m_pLevelsData[this.m_nCurLevelIndex].playedCurLevel(),this.m_nCurLevelIndex=-1,!0)},playCurLevel:function(e){if(this.canPlay()){var t=this,i=wr.getModel();t.setMapData(),i.m_nGameMode=ge.CHALLENGEMODE,t.m_bIntoGame=!0,t.m_nPlayDays>7&&(t.m_nPlayDays=1),i.playMuiscWithType($.MTSTARTBGMSC,2),i.setCurLevel(t.m_nCurMapConfig),qi.preloadWithGameScene(!1)}},getCurTheme:function(){return this.m_nTheme},getMapName:function(){return this.m_strMapName},getCurModeType:function(){return this.m_nLevelStyle},Init:function(){this.m_bIntoGame=!1,this.m_nTheme=0,this.m_nPlayDate=0,this.m_nPlayDays=1,this.m_nLevelStyle=On,this.m_nCurMapConfig=0,this.m_nCurLevelIndex=-1,this.m_nPlayedTime=0,this.m_pLevelsData=[],dp||this.LoadData(),this.m_pLevelsData.length<1?this.AddMap():this.m_pLevelsData.length<46&&this.AddNewMap(),this.setMapData()},AddMap:function(){for(var e=0;e<Zo+Jo;e++){var t=new hh;this.m_pLevelsData.push(t)}},LoadData:function(){this.m_nPlayDays=Zl(Fd(ih),1),this.m_nCurMapConfig=Zl(Fd(ah),0),this.m_nPlayDate=Jl(Fd(rh));for(var e=Zl(Fd(oh),0),t=0;t<e;t++){var i=new hh;i.readData(t+10),i.isPlaying()&&(this.m_nCurLevelIndex=t),this.m_pLevelsData.push(i)}this.checkTimeOut()},SaveData:function(){if($l(this.m_nPlayDays,Fd(ih)),sd(this.m_nPlayedTime,Fd(sh)),$l(this.m_nCurMapConfig,Fd(ah)),$l(this.m_nPlayDate,Fd(rh)),null!=this.m_pLevelsData){var e=this.m_pLevelsData.length;$l(e,Fd(oh));for(var t=0;t<e;t++)this.m_pLevelsData[t].writeData(t+10);Ql.postToServer()}},resetDay:function(){for(var e=this.m_pLevelsData.length,t=0;t<e;t++){var i=this.m_pLevelsData[t];(i.isPlayed()||i.isPlaying())&&i.EraseConfig()}},setMapData:function(){var e=["1_1_1","1_1_2","1_2_3","1_1_4","1_2_5","2_1_6","2_1_7","2_1_8","2_1_9","2_1_10","3_1_11","3_1_12","3_1_13","3_1_14","3_1_15","4_1_16","4_1_17","4_1_18","4_1_19","4_1_20","5_1_21","5_1_22","5_1_23","5_1_24","5_1_25","6_1_26","6_1_27","6_1_28","6_1_29","6_1_30","7_1_31","7_1_32","7_1_33","7_1_34","7_1_35","8_1_36","8_1_37","8_1_38","8_1_39","8_1_40","9_1_41","9_1_42","9_1_43","9_2_44","9_1_45","1_1_46","1_1_47","1_2_48","1_2_49","2_1_50","2_1_51","2_2_52","3_1_53","3_2_54","3_2_55","4_2_56","4_1_57","5_2_58","5_1_59","5_1_60","5_1_61","6_2_62","6_2_63","6_1_64","6_1_65","7_1_66","7_1_67","7_1_68","8_1_69","8_1_70","8_1_71","8_2_72","9_1_73","9_1_74","9_2_75"];if(!(this.m_pLevelsData.length<$o)){if(this.m_nCurLevelIndex<0){var t=F()%$o;if((r=this.m_pLevelsData[t]).isPlayed()){for(var i=this.m_pLevelsData.length,n=t+i,s=t+1;s<n;s++)if(t=s%i,!(r=this.m_pLevelsData[t]).isPlayed()){this.m_nCurLevelIndex=t;break}if(this.m_nCurLevelIndex<0){for(s=0;s<i;s++)(r=this.m_pLevelsData[s]).EraseConfig();this.m_nCurLevelIndex=F()%$o}}else this.m_nCurLevelIndex=t}var r=this.m_pLevelsData[this.m_nCurLevelIndex];this.setCurLevelData(e[this.m_nCurLevelIndex]),r.playCurLevel(this.m_nPlayDays),this.randomMap(this.m_nLevelStyle)}},randomMap:function(e){if(e===On){i=(t=[3,5,6,8,9,10,12,16,17,20,24,25,35,37,39,41,44,49,51,54,60,66,68,69,71,74,76,78,83,86,87,89,92,96,98,101,106,108,111,119,122,130,132,136,138,142,144,145,149,152]).length;this.m_nCurMapConfig=t[F()%i]}else if(e===In){var t=[22,32,42,46,63,67,70,84,90,113,118,125,134,147],i=t.length;this.m_nCurMapConfig=t[F()%i]}},setCurLevelData:function(e){var t=e,i=t.indexOf("_"),n=t.substr(0,i);i++;var s=t.indexOf("_",i),r=t.substr(i,s-i);this.m_strMapName=t,this.m_nTheme=parseInt(n.toString()),this.m_nLevelStyle=parseInt(r.toString())},checkTimeOut:function(){var e=wr.getModel().getCurSystemTime(),t=1e3*this.m_nPlayedTime,i=new Date(t),n=3600*(24-i.getHours())-60*i.getMinutes()+86400;this.m_nPlayedTime+n<e&&(this.m_nPlayDays=1,this.m_nPlayedTime=e,this.m_pLevelsData&&this.m_nCurLevelIndex>-1&&this.m_nCurLevelIndex<this.m_pLevelsData.length&&this.m_pLevelsData[this.m_nCurLevelIndex].playedCurLevel(),this.m_nCurLevelIndex=-1)},AddNewMap:function(){for(var e=0;e<Jo;e++){var t=new hh;this.m_pLevelsData.push(t)}}}),dh=1e3,ch=1001,uh=1002,ph=1004,mh=1005,_h=1006,gh=1007,Th=1008,fh=1009,Sh=1010,wh=1011,vh=1012,Lh=1013,Mh=1014,Ch=1015,yh=1015,Bh=20,Fh=l.Sprite.extend({m_bLock:!1,m_bHighLight:!1,ctor:function(e,t,i){this._super(e,t,i)},Lock:function(){this.m_bLock=!0},IsLock:function(){return this.m_bLock},SetHighLight:function(e){this.m_bHighLight=e},IsHighLight:function(){return this.m_bHighLight}}),Eh=Xs.extend({mMoveLength:0,m_layer1:null,m_layer2:null,m_layer3:null,arrowLeft:null,arrowRight:null,nIndex:0,ctor:function(){this._super(),this.addLayerName("scene-help")},init:function(){this._super();var e=.5;nr.share().isIPad()&&(e=1);var t=nr.share().getWinSize();qu.addRes(this,String.formatC("res/Themes%s/scene/help1-hd.plist",GamePlatform.isCN()?"":"_en"));var i=new l.Sprite("help_bg.png");i.setPosition(t.width/2,t.height/2),this.addChild(i);var n=nr.share().getMapOffset(),s=new l.Sprite("help_title_tip_active.png");s.setPosition(n.width+257*e,570*e),s.setTag(dh),this.addChild(s);var r=new l.Sprite("help_title_monster_active.png");r.setPosition(n.width+478*e,570*e),r.setTag(ch),this.addChild(r);var a=new l.Sprite("help_title_tower_active.png");a.setPosition(n.width+699*e,570*e),a.setTag(uh),this.addChild(a);var o=new l.Sprite("popup_close_frame.png");o.setPosition(n.width+865*e,526*e),this.addChild(o),this.registerWithTouchDispatcher(),this.AddLayer1(),this.ShowLayer(1);var h=this.menuItemWithFile("popup_close.png",I,l.p(n.width+865*e,526*e)),d=new l.Menu(h);return d.setPosition(0,0),this.addChild(d),l.addTimePoint("help_e"),l.printTimePoint("help_s","help_e"),!0},onExit:function(){qu.clearOwner(this),this.removeAllChildren(),this.listener&&l.eventManager.removeListener(this.listener),this._super()},menuCallback:function(e){var t=wr.getModel();t.playSoundWithType($.MTPAGESELECT);var i=e;switch(i.getTag()){case I:l.addTimePoint("GO_MAIN_S"),this.listener&&l.eventManager.removeListener(this.listener);var n=i.getParent();n&&n.setEnabled(!1),qu.loadResAsync(Ht,function(){var e=Hu.scene(),t=new l.TransitionSlideInT(.2,e);l.director.runScene(t),ju.changeScene(e)});break;case ph:if(1==this.nIndex)return;this.nIndex-=1;var s=String.formatC("help_tip_%d.png",this.nIndex),r=l.spriteFrameCache.getSpriteFrame(s);(d=this.m_layer1.getChildByTag(Sh)).setSpriteFrame(r);for(var a=l.spriteFrameCache.getSpriteFrame("help_point_active.png"),o=l.spriteFrameCache.getSpriteFrame("help_point_disable.png"),h=1;h<=4;h++){c=this.m_layer1.getChildByTag(_h+h-1);h==this.nIndex?c.setSpriteFrame(a):c.setSpriteFrame(o)}1==this.nIndex?this.arrowLeft.setEnabled(!1):3==this.nIndex&&this.arrowRight.setEnabled(!0);break;case mh:if(4==this.nIndex)return;this.nIndex+=1;var s=String.formatC("help_tip_%d.png",this.nIndex),r=l.spriteFrameCache.getSpriteFrame(s),d=this.m_layer1.getChildByTag(Sh);d.setSpriteFrame(r);for(var a=l.spriteFrameCache.getSpriteFrame("help_point_active.png"),o=l.spriteFrameCache.getSpriteFrame("help_point_disable.png"),h=1;h<=4;h++){var c=this.m_layer1.getChildByTag(_h+h-1);h==this.nIndex?c.setSpriteFrame(a):c.setSpriteFrame(o)}4==this.nIndex?this.arrowRight.setEnabled(!1):2==this.nIndex&&this.arrowLeft.setEnabled(!0);break;case yh:var u=this;GamePlatform.getCurrentPlatForm()==PlatformType.QQ?kl.shareScreenshotByIndex(ye.Turret_Share,function(e){e&&(t.usersData.bIsShareWeChat=!0,u._rewardSpr&&(u._rewardSpr.removeFromParent(),u._rewardSpr=null))}):kl.shareMessageByDailyawardrecordIndex(b.Share_Title2,b.ShareText2,ye.Turret_Share,0,6,function(e){e&&(t.usersData.bIsShareWeChat=!0,u._rewardSpr&&(u._rewardSpr.removeFromParent(),u._rewardSpr=null))})}},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return this.mMoveLength=0,!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){nr.share().isIPad();var i=wr.getModel(),n=i.usersData.m_nLanguage,s=this.convertTouchToNodeSpace(e),r=this.getChildByTag(dh),a=r.getContentSize(),o=this,h=l.rect(r.x-a.width/2,r.y-a.height/2,a.width,a.height);if(l.rectContainsPoint(h,s)){if(i.playSoundWithType($.MTMENUSELECT),this.m_layer1&&this.m_layer1.isVisible())return;this.ShowLayer(1)}else{var d=this.getChildByTag(ch),c=d.getContentSize(),u=l.rect(d.x-c.width/2,d.y-c.height/2,c.width,c.height);if(l.rectContainsPoint(u,s)){if(i.playSoundWithType($.MTMENUSELECT),this.m_layer2&&this.m_layer2.isVisible())return;return l.addTimePoint("help2_s"),void(void 0==this.m_layer2?qu.loadResAsync(ii,function(){qu.addRes(this,String.formatC("res/Themes%s/scene/help-hd%s.plist",n,n)),o.AddLayer2(),o.ShowLayer(2),l.addTimePoint("help2_e"),l.printTimePoint("help2_s","help2_e")}):o.ShowLayer(2))}var p=this.getChildByTag(uh),m=p.getContentSize(),_=l.rect(p.x-m.width/2,p.y-m.height/2,m.width,m.height);if(l.rectContainsPoint(_,s)){if(i.playSoundWithType($.MTMENUSELECT),l.addTimePoint("help3_s"),this.m_layer3&&this.m_layer3.isVisible())return;void 0==this.m_layer3?qu.loadResAsync(ei,function(){qu.addRes(this,String.formatC("res/Themes%s/scene/help-hd.plist",GamePlatform.isCN()?"":"_en")),qu.addRes(this,"res/Themes/Items/Items04-hd.plist"),o.AddLayer3(),o.ShowLayer(3),l.addTimePoint("help3_e"),l.printTimePoint("help3_s","help3_e")}):o.ShowLayer(3)}else if(this.m_layer3&&this.m_layer3.isVisible())for(var g=0;g<Bh;g++){var T=g;7!=T&&10!=T&&9!=T&&11!=T||(T=7==T?9:9==T?10:10==T?11:7);var f=this.m_layer3.getChildByTag(J.TBOTTLE+T);if(!f.IsLock()){var S=f.getContentSize(),w=l.rect(f.x-S.width/2,f.y-S.height/2,S.width,S.height);if(l.rectContainsPoint(w,s)){if(f.IsHighLight())return;f.SetHighLight(!0),this.m_layer3.getChildByTag(Ch).setPosition(f.getPosition());var v=i.gameObjectConfig.towerGroup[T+J.TBOTTLE],L=String.formatC("btower_%s.png",v.strName),M=l.spriteFrameCache.getSpriteFrame(L);this.m_layer3.getChildByTag(Lh).setSpriteFrame(M);var C=String.formatC("help_tower_%s_title.png",v.strName),y=l.spriteFrameCache.getSpriteFrame(C);this.m_layer3.getChildByTag(Mh).setSpriteFrame(y);var B=String.formatC("help_tower_money_%d.png",v.nBuyMoney[0]),F=l.spriteFrameCache.getSpriteFrame(B);this.m_layer3.getChildByTag(wh).setSpriteFrame(F);var E=String.formatC("help_tower_%s_desp.png",v.strName),P=l.spriteFrameCache.getSpriteFrame(E);P&&this.m_layer3.getChildByTag(vh).setSpriteFrame(P)}else f.SetHighLight(!1)}}}},keyBackClicked:function(){this.listener&&l.eventManager.removeListener(this.listener),qu.loadResAsync(Ht,function(){var e=Hu.scene(),t=new l.TransitionSlideInT(.2,e);l.director.runScene(t),ju.changeScene(e)})},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e),a=null;a=null==n?new l.Sprite(e):new l.Sprite(n);var o=null;o=null==s?new l.Sprite(e):new l.Sprite(s);var h=new l.MenuItemSprite(r,a,o,this,this.menuCallback.bind(this));return h.setTag(t),h.setPosition(i),h},AddLayer1:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=nr.share().getWinSize(),i=nr.share().getMapOffset();this.m_layer1=new l.Layer,this.m_layer1.setVisible(!1),this.addChild(this.m_layer1);var n=new l.Sprite("help_tip_bg.png");n.setPosition(t.width/2,t.height/2),this.m_layer1.addChild(n);var s=new l.Sprite("help_tip_1.png");s.setPosition(i.width+487*e,314*e),s.setTag(Sh),this.m_layer1.addChild(s);var r=new l.Sprite("help_point_active.png");r.setPosition(i.width+437*e,108*e),r.setTag(_h),this.m_layer1.addChild(r);var a=new l.Sprite("help_point_disable.png");a.setPosition(i.width+467*e,108*e),a.setTag(gh),this.m_layer1.addChild(a);var o=new l.Sprite("help_point_disable.png");o.setPosition(i.width+497*e,108*e),o.setTag(Th),this.m_layer1.addChild(o);var h=new l.Sprite("help_point_disable.png");h.setPosition(i.width+527*e,108*e),h.setTag(fh),this.m_layer1.addChild(h),this.arrowLeft=this.menuItemWithFile("help_left_active.png",ph,l.p(i.width+54*e,311*e),null,"help_left_disable.png"),this.arrowLeft.setEnabled(!1),this.arrowRight=this.menuItemWithFile("help_right_active.png",mh,l.p(i.width+907*e,311*e),null,"help_right_disable.png");var d=new l.Menu(this.arrowLeft,this.arrowRight);d.setPosition(0,0),this.m_layer1.addChild(d),this.nIndex=1},AddLayer2:function(){var e=.5;nr.share().isIPad()&&(e=1),this.m_layer2=new l.Layer,this.m_layer2.setVisible(!1),this.addChild(this.m_layer2);var t=nr.share().getMapOffset(),i=new l.Sprite("help_monster.png");i.setPosition(t.width+481*e,296*e),this.m_layer2.addChild(i)},AddLayer3:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel();this.m_layer3=new l.Layer,this.m_layer3.setVisible(!1),this.addChild(this.m_layer3);var i=nr.share().getMapOffset(),n=new l.Sprite("help_tower_bg.png");n.setPosition(i.width+469*e,298*e),this.m_layer3.addChild(n);var s=this.menuItemWithFile("themeaward_share_paota.png",yh,l.p(n.width+75,.5*n.height),null,null),r=new l.Menu(s);r.setPosition(0,0),n.addChild(r),t.usersData.isShareWeChat()||GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook||(this._rewardSpr=new l.Sprite("sharereward_spr.png"),this._rewardSpr.setAnchorPoint(0,.5),this._rewardSpr.setPosition(s.width-10,.5*s.height),s.addChild(this._rewardSpr));for(var a=l.spriteFrameCache.getSpriteFrame("help_tower_locked.png"),o=0;o<20;o++){var h,d,c=o%5;switch(Math.floor(o/5)){case 0:d=445*e;break;case 1:d=347*e;break;case 2:d=249*e;break;case 3:d=151*e}switch(c){case 0:h=i.width+162*e;break;case 1:h=i.width+260*e;break;case 2:h=i.width+358*e;break;case 3:h=i.width+456*e;break;case 4:h=i.width+554*e}var u=o;7!=u&&9!=u&&10!=u&&11!=u||(u=7==u?9:9==u?10:10==u?11:7);var p=t.gameObjectConfig.towerGroup[u+J.TBOTTLE],m=new Fh;if(!t.isOpenedTowerByIndex(o)||o>=Bh)m.initWithSpriteFrame(a),m.Lock();else{var _=String.formatC("help_tower_%s.png",p.strName);m.initWithSpriteFrameName(_)}if(m.setPosition(h,d),m.setTag(J.TBOTTLE+u),this.m_layer3.addChild(m),0==u){m.SetHighLight(!0);var g=String.formatC("btower_%s.png",p.strName),T=new l.Sprite(g);T.setPosition(i.width+727*e,409*e),T.setTag(Lh),this.m_layer3.addChild(T);var f=String.formatC("help_tower_%s_title.png",p.strName),S=new l.Sprite(f);S.setPosition(i.width+727*e,286*e),S.setTag(Mh),this.m_layer3.addChild(S);var w=String.formatC("help_tower_money_%d.png",p.nBuyMoney[0]),v=l.spriteFrameCache.getSpriteFrame(w),L=new l.Sprite(v);L.setPosition(i.width+786*e,224*e),L.setTag(wh),this.m_layer3.addChild(L);var M=String.formatC("help_tower_%s_desp.png",p.strName),C=new l.Sprite(M);C.setPosition(i.width+727*e,145*e),C.setTag(vh),this.m_layer3.addChild(C);var y=new l.Sprite("help_tower_selected.png");y.setPosition(m.getPosition()),y.setTag(Ch),this.m_layer3.addChild(y,2)}}},ShowLayer:function(e){var t=this.getChildByTag(dh),i=this.getChildByTag(ch),n=this.getChildByTag(uh);switch(e){case 1:if(this.m_layer1.isVisible())return;this.m_layer1.setVisible(!0),this.m_layer2&&this.m_layer2.setVisible(!1),this.m_layer3&&this.m_layer3.setVisible(!1);s=l.spriteFrameCache.getSpriteFrame("help_title_tip_active.png");t.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("help_title_monster_disable.png"),i.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("help_title_tower_disable.png"),n.setSpriteFrame(s);break;case 2:if(!this.m_layer2||this.m_layer2.isVisible())return;this.m_layer1&&this.m_layer1.setVisible(!1),this.m_layer3&&this.m_layer3.setVisible(!1),this.m_layer2.setVisible(!0);s=l.spriteFrameCache.getSpriteFrame("help_title_tip_disable.png");t.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("help_title_monster_active.png"),i.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("help_title_tower_disable.png"),n.setSpriteFrame(s);break;case 3:if(!this.m_layer3||this.m_layer3.isVisible())return;this.m_layer1&&this.m_layer1.setVisible(!1),this.m_layer2&&this.m_layer2.setVisible(!1),this.m_layer3.setVisible(!0);var s=l.spriteFrameCache.getSpriteFrame("help_title_tip_disable.png");t.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("help_title_monster_disable.png"),i.setSpriteFrame(s),s=l.spriteFrameCache.getSpriteFrame("help_title_tower_active.png"),n.setSpriteFrame(s)}}});Eh.create=function(){return new Eh},Eh.scene=function(){var e=new l.Scene,t=Eh.create();return e.addChild(t,0),nr.share().scaleScene(t),e};var Ph=l.Sprite.extend({m_tParentScissorRect:null,m_bScissorRestored:!1,ctor:function(){this.m_tParentScissorRect=l.rect(0,0,0,0),this._super()},getViewRect:function(){for(var e=this.convertToWorldSpace(l.p(0,0)),t=this.getScaleX(),i=this.getScaleY(),n=this.getParent();null!=n;n=n.getParent())t*=n.getScaleX(),i*=n.getScaleY();return t<0&&(e.x+=this.width*t,t=-t),i<0&&(e.y+=this.height*i,i=-i),l.rect(e.x,e.y,this.width*t,this.height*i)},visit:function(){if(this._super(),this.isVisible()){l.kmGLPushMatrix(),this.grid&&this.grid.isActive()&&this.grid.beforeDraw(),this.transform(),this.beforeDraw();var e=null,t=0;if(this.getChildren()&&this.getChildrenCount()>0){this.sortAllChildren();for(var i=this.getChildren();t<i.length&&((e=i[t])&&e.getLocalZOrder()<0);t++)e.visit();for(this.draw();t<i.length;t++)(e=i[t])&&e.visit()}else this.draw();this.setOrderOfArrival(0),this.afterDraw(),this.grid&&this.grid.isActive()&&this.grid.afterDraw(this),l.kmGLPopMatrix()}},beforeDraw:function(){var e=this.getViewRect();if(l.view.isScissorEnabled()){if(this.m_bScissorRestored=!0,this.m_tParentScissorRect=l.view.getScissorRect(),l.rectIntersectsRect(e,this.m_tParentScissorRect)){var t=Math.max(e.x,this.m_tParentScissorRect.x),i=Math.max(e.y,this.m_tParentScissorRect.y),n=Math.min(e.x+e.width,this.m_tParentScissorRect.x+this.m_tParentScissorRect.width),s=Math.min(e.y+e.height,this.m_tParentScissorRect.y+this.m_tParentScissorRect.height);l.view.setScissorInPoints(t,i,n-t,s-i)}}else{var r=l._renderContext;r.enable(r.SCISSOR_TEST),l.view.setScissorInPoints(e.x,e.y,e.width,e.height)}},afterDraw:function(){if(this.m_bScissorRestored)l.view.setScissorInPoints(this.m_tParentScissorRect.x,this.m_tParentScissorRect.y,this.m_tParentScissorRect.width,this.m_tParentScissorRect.height);else{var e=l._renderContext;e.disable(e.SCISSOR_TEST)}}});Ph.create=function(e,t){var i=new Ph;return i&&i.init()?(i.setContentSize(l.size(e,t)),i):i=null};var bh=0,Ah=1,Oh=2,Ih=3,Rh=4,Dh=5,xh=l.Layer.extend({m_nCarrotType:ue.CARROT_GIRL,spbg:null,listener:null,ctor:function(){this._super(),this.init()},init:function(){this._super(),wr.getModel().bLockMenu=!0,this.registerWithTouchDispatcher(),qu.addRes(this,"res/Themes/Items/Items03-hd.plist"),qu.addRes(this,"res/Themes/scene/themelocked.plist"),qu.addRes(this,String.formatC("res/Themes%s/tencent/buy_items.plist",GamePlatform.getLanguage()));var e=nr.share().getWinSize(),t=nr.share().getMapOffset(),i=.5;nr.share().isIPad()&&(i=1);var n=l.spriteFrameCache.getSpriteFrame("woodbg_notice.png"),s=l.color(0,0,0,180),r=new l.LayerColor(s);r&&(r.setPosition(0,0),r.setContentSize(e),this.addChild(r,100)),this.spbg=new l.Sprite(n),this.spbg.setPosition(478*i+t.width,312*i),r.addChild(this.spbg,101);var a=new l.Sprite("nostone_carrot_ask.png");a.setPosition(402*i,250*i),a.setTag(Ih),this.spbg.addChild(a);var o=new l.Sprite("popup_close_frame.png");o.setPosition(743*i,418*i),this.spbg.addChild(o,2);var h=this.menuItemWithFile("popup_close.png",bh,l.p(743*i,418*i),null,null,1.1),d=new l.Menu(h,null);return d.setPosition(0,0),d.setTag(Dh),this.spbg.addChild(d,2),!0},onExit:function(){this.getParent().bLockPopUp=!1,this.removeAllChildren(),qu.clearOwner(this),this.listener&&l.eventManager.removeListener(this.listener),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s,r){r=r||1;var a=new l.Sprite(e);if(null!=s){var o=new l.Sprite(s);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o)}var h=null;if(h=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var d=new l.Sprite(s);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d)}var c=new l.MenuItemSprite(a,h,null,this,this.menuCallback.bind(this));return c.setTag(t),c.setPosition(i),c},menuCallback:function(e){switch(e.getTag()){case bh:this.setVisible(!1),this.getParent().removeChild(this,!0),wr.getModel().playSoundWithType($.MTPAGESELECT);break;case Oh:this.setVisible(!1),this.getParent().stoneChangeCarrot(this.m_nCarrotType),this.getParent().removeChild(this);break;case Ah:this.setVisible(!1),this.getParent().BuyCarrot(this.m_nCarrotType),this.getParent().removeChild(this)}},setCarrotStyle:function(e){var t=.5;nr.share().isIPad()&&(t=1);wr.getModel();this.m_nCarrotType=e;var i=null;switch(this.m_nCarrotType){case ue.CARROT_GIRL:i=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl.png"),"shop_btn_girl_stone.png","shop_btn_girl_buy.png";break;case ue.CARROT_FAT:i=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat.png"),"shop_btn_fat_stone.png","shop_btn_fat_buy.png";break;case ue.CARROT_OLD:i=l.spriteFrameCache.getSpriteFrame("shop_carrot_old.png"),"shop_btn_fat_stone.png","shop_btn_fat_buy.png"}if(i){var n=new l.Sprite(i);n.setTag(Rh),n.setPosition(401*t,438*t),this.spbg.addChild(n)}var s=this.spbg.getChildByTag(Dh);if(s){var r=this.spbg.getContentSize(),a=this.menuItemWithFile("btn_green_m.png",Oh,l.p(.5*r.width,165*t),"btn_green_m_pressed.png"),o=this.createCarrotPriceNode();o.setAnchorPoint(.5,.5),o.setPosition(.5*a.width,.5*a.height),a.addChild(o),s.addChild(a)}},createCarrotPriceNode:function(){var e=wr.getModel(),t=new l.Sprite("shop_gem.png");t.setAnchorPoint(0,.5);var i=e.getCarrotPrice(this.m_nCarrotType),n=new l.LabelAtlas(i,"themelocked_buy1.png",20,28,"./0123456789");n.setAnchorPoint(0,.5);var s=new l.Sprite("shop_exchange.png");s.setAnchorPoint(0,.5);var r=t.getContentSize();r.width+=n.width+s.width;var a=new l.Node;return a.setContentSize(r),t.setPosition(0,.5*r.height),n.setPosition(t.width+2,.5*r.height),s.setPosition(n.width+n.x,.5*r.height),a.addChild(t),a.addChild(n),a.addChild(s),a}});xh.create=function(){return new xh};var bh=0,Ah=1,Oh=2,Ih=3,Rh=4,Dh=5,Nh=8,Gh=l.Layer.extend({m_nCarrotType:ue.CARROT_GIRL,spbg:null,scheduleNode:null,listener:null,pMenuBargain:null,numberTable:null,headBgTable:null,scheduleMiddle:null,joinText:1,currentPrice:null,ctor:function(){this._super(),wr.getModel().bLockMenu=!0,this.numberTable=[],this.headBgTable=[],this.currentPrice=null,this.registerWithTouchDispatcher(),qu.addRes(this,String.formatC("res/Themes%s/tencent/bangkanjia.plist",GamePlatform.getLanguage())),qu.addRes(this,"res/Themes/Items/Items03-hd.plist"),qu.addRes(this,"res/Themes/scene/themelocked.plist"),qu.addRes(this,String.formatC("res/Themes%s/tencent/buy_items.plist",GamePlatform.getLanguage()));var e=nr.share().getWinSize(),t=nr.share().getMapOffset(),i=1==nr.share().isIPad()?1:.5,n=l.spriteFrameCache.getSpriteFrame("shop_mainbg.png"),s=l.color(0,0,0,180),r=new l.LayerColor(s);r&&(r.setPosition(0,0),r.setContentSize(e),this.addChild(r,100)),this.spbg=new l.Sprite(n),this.spbg.setPosition(478*i+t.width,312*i),r.addChild(this.spbg,101);var a=new l.Sprite("wenzi1.png");a.setPosition(535*i,475*i),a.setTag(Ih),this.spbg.addChild(a);var o=new l.Sprite("bg_fengexian.png");o.setPosition(488*i,190*i),this.spbg.addChild(o);for(u=0;u<8;u++){var h=new l.Sprite("touxiangbg.png");h.setPosition((110+100*u)*i,150*i),this.spbg.addChild(h),this.headBgTable.push(h)}var d=new l.Sprite("wenzi2.png");d.setPosition(410*i,210*i),this.spbg.addChild(d),this.joinText=new l.LabelTTF("10","Helvetica",25),this.joinText.setAnchorPoint(.5,.5),this.joinText.setColor(l.color(255,255,255)),this.joinText.setPosition(l.p(.2*d.getContentSize().width,.5*d.getContentSize().height)),d.addChild(this.joinText,20);var c=new l.Sprite("kanjia_jindubg.png");c.setPosition(535*i,420*i),this.spbg.addChild(c),this.combinationSchedule(c,i);for(var u=0;u<9;u++){var p=new l.LabelAtlas((0+100*u).toString(),"bangkanjia_num2.png",18.9,21,"0123456789");p.setAnchorPoint(0,.5),p.setScale(.8),u>0?p.setPosition(285*i+60*u-30,380*i):p.setPosition(285*i+60*u,380*i),this.spbg.addChild(p);var m=new l.LabelAtlas((0+100*u).toString(),"bangkanjia_num1.png",19.3,23,"0123456789");m.setAnchorPoint(0,.5),m.setScale(.8),u>0?m.setPosition(285*i+60*u-30,380*i):m.setPosition(285*i+60*u,380*i),this.spbg.addChild(m),this.numberTable.push(m)}var _=new l.Sprite("popup_close_frame.png");_.setPosition(923*i,545*i),this.spbg.addChild(_,2);var g=this.menuItemWithFile("popup_close.png",bh,l.p(923*i,545*i),null,null,1.1),T=this.menuItemWithFile("btn_blue_m.png",8,l.p(668*i,325*i),null,null,1.1);T.setTag(Nh);var f=new l.Sprite("button_bangkanjia.png");f.setAnchorPoint(.5,.5),f.setPosition(.5*T.width,.5*T.height),T.addChild(f),this.pMenuBargain=T;var S=new l.Menu(g,T,null);S.setPosition(0,0),S.setTag(Dh),this.spbg.addChild(S,2),Ql.getbargain(function(e){this.loadUI(e)}.bind(this))},combinationSchedule:function(e,t){this.scheduleNode=new l.Node,this.scheduleNode.setContentSize(e.getContentSize()),this.scheduleNode.setAnchorPoint(0,.5),this.scheduleNode.setPosition(535*t-this.scheduleNode.getContentSize().width/2,420*t),this.spbg.addChild(this.scheduleNode);var i=new l.Sprite("kanjia_jinduzuo.png");i.setAnchorPoint(0,.5),i.setPosition(4,.5*this.scheduleNode.getContentSize().height),this.scheduleNode.addChild(i,1),this.scheduleMiddle=new l.Sprite("kanjia_jinduzhong.png"),this.scheduleMiddle.setAnchorPoint(0,.5),this.scheduleMiddle.setScaleX(39.5),this.scheduleMiddle.setPosition(i.getContentSize().width+2,.5*this.scheduleNode.getContentSize().height),this.scheduleNode.addChild(this.scheduleMiddle);var n=new l.Sprite("kanjia_jinduyou.png");n.setAnchorPoint(0,.5),n.setPosition(this.scheduleMiddle.getPositionX()-3+this.scheduleMiddle.getBoundingBox().width,.5*this.scheduleNode.getContentSize().height),this.scheduleNode.addChild(n,1),this.scheduleNode.scheduleRight=n},setScheduleProgres:function(e){this.scheduleMiddle&&(this.scheduleMiddle.setScaleX(39.5*e),this.scheduleNode.scheduleRight.setPosition(this.scheduleMiddle.getPositionX()-3+this.scheduleMiddle.getBoundingBox().width,.5*this.scheduleNode.getContentSize().height))},loadUI:function(e){var t=e.bargains,i=t.length;this.joinText&&this.joinText.setString(i.toString());var n=8-i;if(t.length>0){n<=0?this.scheduleNode.setVisible(!1):this.setScheduleProgres(n/8);for(var s=0,r=t.length;s<r;s++){var a=this.headBgTable[s];if(a){i=t[s];this.createFriendHead(a,i)}}}for(var s=0,r=this.numberTable.length;s<r;s++){var o=this.numberTable[s];o&&s>n&&o.setVisible(!1)}this.setCarrotStyle(t.length)},createFriendHead:function(e,t){var i=t.photo,n=null;if(i)n=Rt.createPhotoSprite(),Rt.loadUserPhoto(i,n);else{var s=l.spriteFrameCache.getSpriteFrame("UserHead.png");n=new l.Sprite(s)}var r=e.getContentSize();n&&(n.setPosition(r.width/2,r.height/2),e.addChild(n,10));var a=decodeURIComponent(t.name),o=new l.LabelTTF(a,"Helvetica",18);o.setAnchorPoint(.5,1),o.setColor(l.color(255,255,255)),o.setPosition(l.p(r.width/2,0)),e.addChild(o,20)},onExit:function(){this.getParent().bLockPopUp=!1,this.removeAllChildren(),qu.clearOwner(this),this.listener&&l.eventManager.removeListener(this.listener),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s,r){r=r||1;var a=new l.Sprite(e);if(null!=s){var o=new l.Sprite(s);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o)}var h=null;if(h=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var d=new l.Sprite(s);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d)}var c=null;return(c=8!=t?new l.MenuItemSprite(a,h,null,this,this.menuCallback.bind(this)):new l.MenuItemSprite(a,h,null,this,this.menuBargain.bind(this))).setTag(t),c.setPosition(i),c},menuBargain:function(){var e=new Wh;l.director.getRunningScene().addChild(e,100)},menuCallback:function(e){switch(e.getTag()){case bh:this.setVisible(!1),this.getParent().removeChild(this,!0),wr.getModel().playSoundWithType($.MTPAGESELECT);break;case Oh:if(0==this.currentPrice){var t=ue.CARROT_GIRL-ue.CARROT_NORMAL+1;Ql.buyCarrotByCarrotID(t,function(e){wr.getModel().usersData.setDiamond(e.dm),this.getParent().BuyCarrotUpdate(ue.CARROT_GIRL,!0),hp.create()}.bind(this))}else this.setVisible(!1),this.getParent().stoneChangeCarrot(ue.CARROT_GIRL),this.getParent().removeChild(this);break;case Ah:wr.getModel()}},setCarrotStyle:function(e){var t=1==nr.share().isIPad()?1:.5,i=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl.png");if(i){var n=new l.Sprite(i);n.setTag(Rh),n.setPosition(170*t,462*t),this.spbg.addChild(n)}var s=this.spbg.getChildByTag(Dh);if(s){var r=this.menuItemWithFile("btn_green_m.png",Oh,l.p(413*t,325*t),"btn_green_m_pressed.png"),a=wr.getModel().getCarrotPrice(ue.CARROT_GIRL);a=parseInt(a)-100*e,this.currentPrice=a,wr.getModel().setCarrotPriceByType(ue.CARROT_GIRL,a);var o=this.createCarrotPriceNode(a);if(o.setAnchorPoint(.5,.5),o.setPosition(.5*r.width,.5*r.height),r.addChild(o),a<=0){o.removeFromParent(!0);var h=new l.Sprite("button_mianfei.png");h.setAnchorPoint(.5,.5),h.setPosition(.5*r.width,.5*r.height),r.addChild(h),r.setPosition(l.p(513*t,325*t)),this.pMenuBargain.setVisible(!1)}s.addChild(r)}},createCarrotPriceNode:function(e){if(e>0){var t=new l.Sprite("shop_gem.png");t.setAnchorPoint(0,.5);var i=new l.LabelAtlas(e.toString(),"themelocked_buy1.png",20,28,"./0123456789");i.setAnchorPoint(0,.5);var n=new l.Sprite("shop_exchange.png");n.setAnchorPoint(0,.5);var s=t.getContentSize();s.width+=i.width+n.width;var r=new l.Node;return r.setContentSize(s),t.setPosition(0,.5*s.height),i.setPosition(t.width+2,.5*s.height),n.setPosition(i.width+i.x,.5*s.height),r.addChild(t),r.addChild(i),r.addChild(n),r}return new l.Sprite("button_mianfei.png")}});Gh.create=function(e){return(GamePlatform.getCurrentPlatForm()==PlatformType.QQ||GamePlatform.getCurrentPlatForm()==PlatformType.WeiXin||GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp)&&(!!Dt.bargainDlgSwitch&&(qu.loadResAsync(ui,function(){var t=new Gh;e.addChild(t,100)}),!0))};var Wh=l.Layer.extend({spbg:null,listener:null,pMenuShare:null,pMenuThank:null,pMenuClose:null,spCloseBg:null,ctor:function(){this._super(),this.registerWithTouchDispatcher();nr.share().getWinSize(),nr.share().getMapOffset();var e=1==nr.share().isIPad()?1:.5;this.spbg=new l.Sprite("background.png"),this.spbg.setPosition(.5*l.winSize.width,.5*l.winSize.height),this.addChild(this.spbg,101),this.spCloseBg=new l.Sprite("popup_close_frame.png"),this.spCloseBg.setPosition(1043*e,585*e),this.spbg.addChild(this.spCloseBg,2),this.pMenuClose=this.menuItemWithFile("popup_close.png",bh,l.p(1043*e,585*e),null,null,1.1),this.pMenuShare=this.menuItemWithFile("btn_blue_m.png",ap,l.p(568*e,105*e),null,null,1.1);var t=new l.Sprite("button_fenxianghaoyou.png");t.setAnchorPoint(.5,.5),t.setPosition(.5*this.pMenuShare.width,.5*this.pMenuShare.height),this.pMenuShare.addChild(t);var i=new l.Menu(this.pMenuClose,this.pMenuShare,null);i.setPosition(0,0),i.setTag(Dh),this.spbg.addChild(i,2),this.generateQrCode()},menuItemWithFile:function(e,t,i,n,s,r){r=r||1;var a=new l.Sprite(e);if(null!=s){var o=new l.Sprite(s);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o)}var h=null;if(h=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var d=new l.Sprite(s);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d)}var c=new l.MenuItemSprite(a,h,null,this,this.menuCallback.bind(this));return c.setTag(t),c.setPosition(i),c},menuCallback:function(e){e.getTag()==bh?(this.setVisible(!1),this.getParent().removeChild(this,!0)):GamePlatform.getCurrentPlatForm()==PlatformType.QQ?(this.spCloseBg.setVisible(!1),this.pMenuClose.setVisible(!1),this.pMenuShare.setVisible(!1),kl.shareScreenshot(0,function(){this.spCloseBg.setVisible(!0),this.pMenuClose.setVisible(!0),this.pMenuShare.setVisible(!0)}.bind(this),!1)):kl.shareMessage(null,b.Share_Text30,Wl.None,0,16,null,function(){})},onExit:function(){this.getParent().bLockPopUp=!1,this.removeAllChildren(),this.listener&&l.eventManager.removeListener(this.listener),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},generateQrCode:function(){var e=Date.parse(new Date),t="&shareuid="+l.playerInfo.id+"&name="+l.playerInfo.name+"&photo="+l.playerInfo.photo,i=GamePlatform.getLoginUrl()+"?_wv=2147674919&_wwv=2048&channel=10029899&time="+e+t;l.log("generateQrCode url:"+i);var n=jrQrcode.getQrBase64(i,{padding:1,width:130,height:130,correctLevel:QRErrorCorrectLevel.L});l.playerInfo&&l.loader.loadImg(n,{isCrossOrigin:!1},function(e,t){var i=1==nr.share().isIPad()?1:.5,n=new l.Texture2D;n.initWithElement(t),n.handleLoadedTexture();var s=new l.Sprite(n);s.setScale(l.contentScaleFactor()),s.setPosition(l.p(840*i,95*i)),this.spbg.addChild(s,100);var r=l.playerInfo.photo,a=null;if(r)a=Rt.createPhotoSprite(),Rt.loadUserPhoto(r,a);else{var o=l.spriteFrameCache.getSpriteFrame("UserHead.png");a=new l.Sprite(o)}var h=s.getContentSize();if(a){a.setScale(1);var d=25/a.getContentSize().width,c=25/a.getContentSize().height;a.setScaleX(d),a.setScaleY(c),a.setPosition(h.width/2,h.height/2),s.addChild(a,10)}var u=new l.LabelTTF(l.playerInfo.name,"Arial",18);u.setAnchorPoint(.5,1),u.setColor(l.color(255,255,255)),u.setPosition(l.p(h.width/2,-3)),s.addChild(u,20)}.bind(this))}}),kh=0,Uh=1,Hh=2,Vh=3,zh=4,Yh=5,Xh=6,jh=7,Kh=8,qh=9,Qh=10,Zh=11,Jh=12,$h=13,el=14,tl=15,il=16,nl=17,sl=18,rl=19,al=20,ol=21,hl=22,ll=23,dl=24,cl=25,ul=26,pl=27,ml=28,_l=29,Tl=30,fl={FLOOR_PERSONAL:0,FLOOR_FRIENDS:1},Sl=fl.FLOOR_PERSONAL,wl=fl.FLOOR_FRIENDS,vl=Zs.extend({mLayer1:null,mLayer2:null,mFriends:null,mSelfFloor:null,m_nStart:0,m_nType:Sl,m_nSelected:0,listener:null,_rewardSpr:null,datas:null,ctor:function(){this.mFriends=[],this._super(Ks.DT_TITLE),this.addLayerName("scene-friend-honor")},showFriends:function(e){if(e=Sl,this.m_nType=e,e==wl){var t=.5;nr.share().isIPad()&&(t=1);var i=nr.share().getMapOffset(),n=new l.Sprite("floor_chart_loading_bg.png");n.setPosition(478*t+i.width,224*t),this.addChild(n,9999,9999);var s=new l.Sprite("floor_chart_loading_ani.png");t="_en"===wr.getModel().usersData.m_nLanguage?.25*n.width:.5*n.width,s.setPosition(t,.5*n.height),n.addChild(s);var r=l.repeatForever(l.rotateBy(1,360));s.runAction(r)}this.registerWithTouchDispatcher()},addChildItems:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=wr.getModel();this.registerWithTouchDispatcher(),t.bLockMenu=!0;var i=null,n=new l.Sprite("floor_chart_title.png");n.setPosition(412*e,509*e),this.spMainFrame.addChild(n,2);var s=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,r=GamePlatform.isCN()?s?"themeaward_share_qq.png":"themeaward_share_wechat.png":"themeaward_share.png";i=this.menuItemWithFile(r,Xh,l.p(nr.share().getMapOffset().width+83*e,230*e),r,r),t.usersData.isShareWeChat()||GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook||(this._rewardSpr=new l.Sprite("themeaward_share_wechat_new.png"),this._rewardSpr.setAnchorPoint(1,.5),this._rewardSpr.setPosition(23,.5*i.height),i.addChild(this._rewardSpr));var a=this.menuItemWithFile("floor_muser_up_normal.png",kh,l.p(nr.share().getMapOffset().width+811+70*e,332+40*e),"floor_muser_up_pressed.png","floor_muser_up_disable.png");a.setEnabled(!1);var o=this.menuItemWithFile("floor_muser_down_normal.png",Uh,l.p(nr.share().getMapOffset().width+811+70*e,182+40*e),"floor_muser_down_pressed.png","floor_muser_down_disable.png"),h=new l.Menu(a,o,i,null);h.setPosition(0,0),h.setTag(Hh),this.addChild(h,3),this.sendCode()},sendCode:function(){var e=this;lp?SDKInterface.getFriendList(50,function(t){var i=[];e.datas=t;for(var n in t)i.push(t[n].id);console.log("openids :"+JSON.stringify(i));var s=e.getChildByName("loadingLabel");s&&s.removeFromParent(),i.length>0?e.addFriends(i):e.sendOnceCode(!1)}):e.sendOnceCode(!1)},sendOnceCode:function(e){var t=this;this.mSelfFloor={name:l.playerInfo.name,photo:l.playerInfo.photo,uid:l.playerInfo.id,openid:l.playerInfo.openid},Ql.growthdaydayup(function(i){t.parseServerData(i.growth),t.showLayer1(e),t.UpDateUpDownMenuState(),t.mLayer2&&t.mLayer2.setVisible(!1)})},addFriends:function(e){e=e||[];var t=this;Ql.friendrankddu(e,function(e){if(t.mFriends=e,t.mFriends)if(1!=t.mFriends.length||(s=t.mFriends[0]).openid!==l.playerInfo.openid){for(var i=GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook?"":100,n=0;n<t.mFriends.length;n++){var s=t.mFriends[n];if(s.openid!==l.playerInfo.openid)for(var r in t.datas){var a=t.datas[r];if(s.openid===a.id){s.name=a.name,s.photo=a.photo+i;break}}else s.name=l.playerInfo.name,s.photo=l.playerInfo.photo}t.addLayer2()}else t.sendOnceCode(!1);else t.sendOnceCode(!1)})},parseServerData:function(e){if(void 0!=e){var t=[],i=wr.getModel();if(e&&e.length){var n=e.split("|");for(var s in n){var r=n[s].split(",");if((d=r[0]).length){var a=parseInt(d.slice(0,4)),o=parseInt(d.slice(4,6)),h=parseInt(d.slice(6,8));d=o+"/"+h,t.push({dates:d,tier:parseInt(r[1]),month:o,day:h,year:a})}}if(t.sort(function(e,t){if(e.year>t.year)return!0;if(e.year==t.year){if(e.month>t.month)return!0;if(e.month==t.month)return e.day>t.day}}),t.length>1){t.length>9&&(t=t.splice(t.length-9,t.length));var l=t[t.length-1],d=new Date(1e3*i.getCurSystemTime());(l.day<d.getDate()-9||d.getFullYear()>l.year)&&(t=t.splice(t.length-1,t.length))}}else t=[{dates:(o=(d=new Date(1e3*i.getCurSystemTime())).getMonth()+1)+"/"+d.getDate(),tier:0,month:o,day:d.getDate(),year:d.getFullYear()}];this.mSelfFloor.floors=t}},loadResources:function(){var e=GamePlatform.getLanguage();qu.addRes(this,"res/Themes/LevelSelect/StoreyChart-hd.plist"),qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",e)),qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/StoreyChart-hd%s.plist",e,e))},changeStoneCount:function(){},onExit:function(){qu.clearOwner(this),this.removeAllChildren(!0),this.listener&&l.eventManager.removeListener(this.listener),this._super()},showLayer1:function(e){if(void 0!=this.mSelfFloor){void 0==e&&(e=!0);var t=.5;nr.share().isIPad()&&(t=1);var i=nr.share().getMapOffset();wr.getModel().usersData;this.mLayer1?(this.mLayer1.removeAllChildren(),this.mLayer1.setVisible(!0)):(this.mLayer1=new l.Layer,this.addChild(this.mLayer1,2));var n=new l.Sprite("floor_chart_curve_bg.png");n.setPosition(478*t+i.width,318*t),this.mLayer1.addChild(n);var s=this.mSelfFloor.photo,r=(wr.getModel(),null),a=!1;if(r=Rt.createPhotoSprite(),e){var o=null;o=this.menuItemWithFile1("floor_muser_back.png",Kh,l.p(nr.share().getMapOffset().width+680*t,448*t),null,null);var h=new l.Menu(o);h.setPosition(0,0),this.mLayer1.addChild(h,2,2)}else{if(h=this.getChildByTag(Hh)){var d=h.getChildByTag(kh);d&&d.setVisible(!1);var c=h.getChildByTag(Uh);c&&c.setVisible(!1)}a=!0}Rt.loadUserPhoto(s,r),r.setPosition(221*t+i.width,449*t),r.setTag(Tl),this.mLayer1.addChild(r,1);var u=new l.Sprite("floor_curve_avatar.png");u.setPosition(219*t+i.width,449*t),this.mLayer1.addChild(u,2);var p=this.mSelfFloor.name?this.mSelfFloor.name:"",m=a?p:Rt.cutString(p,11);if(m.length&&l.isString(m)){var _=new l.LabelTTF(m,"Arial-BoldMT",22*t);if(_){G=l.color(172,113,44);_.setColor(G),_.setAnchorPoint(0,.5),_.setPosition(350,r.y+15),this.mLayer1.addChild(_)}}var g=this.mSelfFloor.floors;if(void 0!=g&&0!=g.length){for(var T=0,f=0,S=[],w=204+i.width,v=l.color(172,113,44),L=0;L<g.length&&9!=L;L++){var M=g[L],C=M.tier;0==L?(T=C,f=C):C<T?T=C:C>f&&(f=C),S.push(C);var y=M.dates,B=new l.LabelTTF(y,"Arial-BoldMT",14);B&&(B.setColor(v),B.setAnchorPoint(0,.5),B.setPosition(w+65*L,120),this.mLayer1.addChild(B))}var F=S.length?S[S.length-1]:0;F=F||0;var E=new l.LabelAtlas("00","floor_curve_num.png",20,24,"0123456789");E.setString(String.formatC("%2lu",F)),E.setPosition(385*t+i.width,433*t),E.setAnchorPoint(.5,.5),this.mLayer1.addChild(E);for(var P=0,b=0,A=[10,20,30,40,50,60,70,80,90,100],L=0;L<10;L++)A[L]<T&&(P=A[L]),f>A[L]&&(b=A[L+1]);var O=0,I=b-P;if(I<=30)b=P+30,I=30,O=5;else for(var R=I/6,D=[10,15,20],L=0;L<3;L++)if(D[L]>R){O=D[L];break}b=P+6*O;var x=165*t+i.width,N=215*t,G=l.color(243,122,37),W=new l.LabelTTF(String.formatC("%.2d",P+2*O).toString(),"Arial-BoldMT",22*t);W&&(W.setColor(G),W.setAnchorPoint(0,.5),W.setPosition(x,N),this.mLayer1.addChild(W));var k=new l.LabelTTF(String.formatC("%.2d",P+4*O).toString(),"Arial-BoldMT",22*t);k&&(k.setColor(G),k.setAnchorPoint(0,.5),k.setPosition(x,N+70*t),this.mLayer1.addChild(k));var U=new l.LabelTTF(String.formatC("%.2d",P+6*O).toString(),"Arial-BoldMT",22*t);U&&(U.setColor(G),U.setAnchorPoint(0,.5),U.setPosition(x,N+140*t),this.mLayer1.addChild(U));var H=768*t+i.width,V=181*t,z=new l.LabelTTF(String.formatC("%.2d",P+O).toString(),"Arial-BoldMT",22*t);z&&(z.setColor(G),z.setAnchorPoint(0,.5),z.setPosition(H,V),this.mLayer1.addChild(z));var Y=new l.LabelTTF(String.formatC("%.2d",P+3*O).toString(),"Arial-BoldMT",22*t);Y&&(Y.setColor(G),Y.setAnchorPoint(0,.5),Y.setPosition(H,V+70*t),this.mLayer1.addChild(Y));var X=new l.LabelTTF(String.formatC("%.2d",P+5*O).toString(),"Arial-BoldMT",22*t);X&&(X.setColor(G),X.setAnchorPoint(0,.5),X.setPosition(H,V+140*t),this.mLayer1.addChild(X));for(var j=0,L=0;L<S.length;L++){var K=null;if((C=S[L])==f?(0==j&&(j=1),K=1==j?new l.Sprite("floor_curve_dot_end.png"):new l.Sprite("floor_curve_dot_normal.png")):K=new l.Sprite("floor_curve_dot_normal.png"),K){var q=l.p(220*t+i.width+65*L*t,142*t+214*t*(C-P)/(b-P));if(L<S.length-1){var Q=S[L+1],Z=l.p(220*t+i.width+65*(L+1)*t,142*t+214*t*(Q-P)/(b-P)),J=l.pDistance(q,Z);l.spriteFrameCache.getSpriteFrame("floor_curve_line.png").getTexture().setAntiAliasTexParameters();var $=new l.Sprite("floor_curve_line.png");$.setAnchorPoint(0,.5),$.setScaleX(J/$.width),$.setPosition(q),this.mLayer1.addChild($);var ee=l.pSub(Z,q),te=this.getAngel(ee);$.setRotation(-te)}if(K.setPosition(q),this.mLayer1.addChild(K),1==j){j=2;var ie=new l.Sprite("floor_curve_tip_bg.png");ie.setPosition(K.x,K.y+36),this.mLayer1.addChild(ie);var ne=new l.LabelAtlas("00","floor_curve_tip_num.png",17,22,"0123456789");ne.setString(String.formatC("%02lu",C)),ne.setPosition(34*t,25*t),ne.setAnchorPoint(.5,.5),ie.addChild(ne)}}}}}},addLayer2:function(){var e=.5;nr.share().isIPad()&&(e=1),this.mLayer2||(this.mLayer2=new l.Layer,this.addChild(this.mLayer2,2));var t=this.getChildByTag(Hh),i=t.getChildByTag(kh);i&&i.setEnabled(!1);var n=new l.Sprite("floor_chart_bg_line.png");n.setPosition(nr.share().getMapOffset().width+171*e,306*e),this.mLayer2.addChild(n),this.m_nStart=0;var s=this.mFriends.length;if(s>4)s=4;else{var r=t.getChildByTag(Uh);r&&r.setEnabled(!1)}for(var a=[],o=0;o<s;o++){var h=new l.Sprite("floor_chart_info_bg.png");h.setPosition(nr.share().getMapOffset().width+510*e,460*e-102*o*e),h.setTag(el+o),this.mLayer2.addChild(h);var d=this.mFriends[o],c=new l.Sprite(0==o?"floor_chart_bg_gold.png":"floor_chart_bg_wood.png");c.setPosition(-68*e,10*e),c.setAnchorPoint(0,0),h.addChild(c,1,ul+o);var u=0==o?"floor_chart_gold_num.png":"floor_chart_wood_num.png",p=new l.LabelAtlas("00",u,16,24,"0123456789");p.setString(String.formatC("%d",d.ddutier)),p.setPosition(.5*c.width,.5*c.height),p.setAnchorPoint(.5,.5),p.setTag(1),c.addChild(p);var m=Rt.createPhotoSprite();if(this.setUserHeadImg(d.photo,m),m){m.setTag(sl+o),h.addChild(m,1);var _=new l.Sprite("floor_chart_avatar.png");_.setPosition(33*e,13*e),_.setAnchorPoint(0,0),h.addChild(_,2),m.setAnchorPoint(.5,.5),m.setPosition(_.x+.5*_.width,_.y+.5*_.height);var g=parseInt(d.platid),T=new l.Sprite(0==g?"icon_ios.png":"icon_android.png");T.visible=2!=g,T.setAnchorPoint(.5,.5),T.setPosition(90,30),h.addChild(T,10,101)}var f=d.name?d.name:"";f=Rt.cutString(f,11);var S=new l.LabelTTF(f,"Arial-BoldMT",24);S&&(S.setAnchorPoint(0,.5),S.setPosition(_.x+_.width,_.y+.5*_.height),S.setTag(hl+o),h.addChild(S));var w=this.menuItemWithFile("floor_chart_btn_curve.png",Qh+o,l.p(nr.share().getMapOffset().width+712*e,458*e-102*o*e),"floor_chart_btn_curve.png","floor_chart_btn_curve.png");a.push(w)}if(a.length>0){var v=new l.Menu(a);v.setPosition(0,0),v.setTag(Vh),this.mLayer2.addChild(v,3)}},setUserHeadImg:function(e,t){if(void 0!=t)if(console.log("setUserHeadImg:"+e),e&&e.length)Rt.loadUserPhoto(e,t);else{var i=l.spriteFrameCache.getSpriteFrame("UserHead.png");i&&t.setSpriteFrame(i)}},menuCallback:function(e){var t=e,i=wr.getModel();if(!i.showRewardLayer)switch(t.getTag()){case kh:if(this.mLayer2&&this.mLayer2.isVisible())this.m_nStart-=4,this.m_nStart<=0&&(t.setEnabled(!1),this.m_nStart=0),(n=this.getChildByTag(Hh))&&(a=n.getChildByTag(Uh))&&!a.isEnabled()&&a.setEnabled(!0),this.UpDateUserListView();else{n=this.getChildByTag(Hh);if(--this.m_nSelected<0)return;0==this.m_nSelected&&(o=n.getChildByTag(kh))&&o.isEnabled()&&o.setEnabled(!1),(a=n.getChildByTag(Uh))&&!a.isEnabled()&&a.setEnabled(!0),this.getFriendFLoorHistory()}break;case Uh:if(this.mLayer2&&this.mLayer2.isVisible())this.m_nStart+=4,this.m_nStart+4>this.mFriends.length-1&&(t.setEnabled(!1),this.m_nStart=this.mFriends.length-4),(n=this.getChildByTag(Hh))&&(o=n.getChildByTag(kh))&&!o.isEnabled()&&o.setEnabled(!0),this.UpDateUserListView();else{var n=this.getChildByTag(Hh);this.m_nSelected++;var s=this.mFriends.length;if(this.m_nSelected>s-1)return;this.m_nSelected==s-1&&(a=n.getChildByTag(Uh))&&a.isEnabled()&&a.setEnabled(!1),(o=n.getChildByTag(kh))&&!o.isEnabled()&&o.setEnabled(!0),this.getFriendFLoorHistory()}break;case zh:this.isWait&&(l.director.getScheduler().isWaite=!1),(i=wr.getModel()).playSoundWithType($.MTMENUSELECT),i.bLockMenu=!1,this.setVisible(!1),this.getParent().removeChild(this,!0);break;case jh:this.setVisible(!1),this.getParent().removeChild(this,!0),this.isWait&&(l.director.getScheduler().isWaite=!1),(i=wr.getModel()).playSoundWithType($.MTMENUSELECT),i.bLockMenu=!1;break;case Yh:this.shareMessage();var r=t.getParent();r&&r.setEnabled(!0);break;case Xh:this.shareMessage();break;case Kh:var a=(n=this.getChildByTag(Hh)).getChildByTag(Uh);a.setVisible(!0),a&&this.m_nStart+4>this.mFriends.length-1?a.setEnabled(!1):a.setEnabled(!0);var o=n.getChildByTag(kh);o.setVisible(!0),o&&0==this.m_nStart?o.setEnabled(!1):o.setEnabled(!0),this.mLayer1.setVisible(!1),this.mLayer2&&this.mLayer2.setVisible(!0);break;case Qh:this.m_nSelected=this.m_nStart,this.UpDateUpDownMenuState(),this.getFriendFLoorHistory();break;case Zh:this.m_nSelected=this.m_nStart+1,this.UpDateUpDownMenuState(),this.getFriendFLoorHistory();break;case Jh:this.m_nSelected=this.m_nStart+2,this.UpDateUpDownMenuState(),this.getFriendFLoorHistory();break;case $h:this.m_nSelected=this.m_nStart+3,this.UpDateUpDownMenuState(),this.getFriendFLoorHistory();break;case qh:this.getFriendFLoorHistory()}},shareMessage:function(){var e=this;GamePlatform.getCurrentPlatForm()==PlatformType.QQ?kl.shareScreenshot(Wl.REWARD_SHARE,function(t){e._rewardSpr&&t&&(e._rewardSpr.removeFromParent(),e._rewardSpr=null)}):kl.shareMessage(b.Share_Title8,b.ShareText8,Wl.REWARD_SHARE,0,14,null,function(t){e._rewardSpr&&t&&(e._rewardSpr.removeFromParent(),e._rewardSpr=null)})},UpDateUserListView:function(){nr.share().isIPad();for(var e=this.m_nStart,t=0;t<4;t++,e++){var i=this.mLayer2.getChildByTag(el+t);if(e>=this.mFriends.length)i.setVisible(!1),(n=this.mLayer2.getChildByTag(Vh))&&(s=n.getChildByTag(Qh+t))&&s.setVisible(!1);else{i.setVisible(!0);var n=this.mLayer2.getChildByTag(Vh);if(n){var s=n.getChildByTag(Qh+t);s&&s.setVisible(!0)}var r;r=this.mFriends[e];var a=i.getChildByTag(ul+t);if(a){var o=a.getChildByTag(1),h=String.formatC("%d",r.ddutier);if(0==t){var d=l.spriteFrameCache.getSpriteFrame(0==e?"floor_chart_bg_gold.png":"floor_chart_bg_wood.png");if(d&&a.setSpriteFrame(d),o){var c=0==e?"floor_chart_gold_num.png":"floor_chart_wood_num.png";o.initWithString(h,c,16,24,"0123456789")}}else o&&o.setString(h)}var u=r.photo?r.photo:"",p=i.getChildByTag(sl+t);if(p){Rt.loadUserPhoto(u,p),p.setTag(sl+t);var m=i.getChildByTag(hl+t);if(console.log("USERNAME1 + i"+(hl+t)),m){var _=r.name?r.name:"";_=Rt.cutString(_,11),console.log("nameStr:"+_),m.setString(_)}}}}},UpDateUpDownMenuState:function(){var e=this.getChildByTag(Hh),t=e.getChildByTag(Uh);t&&t.setEnabled(!(this.m_nSelected==this.mFriends.length-1));var i=e.getChildByTag(kh);i&&i.setEnabled(!(0==this.m_nSelected))},getFriendFLoorHistory:function(){if(void 0!=this.mFriends){var e=this,t=this.m_nSelected<this.mFriends.length?this.mFriends[this.m_nSelected]:null;t?t.uid==l.playerInfo.id?this.sendOnceCode():(this.mSelfFloor={name:t.name,photo:t.photo,uid:t.uid,openid:t.openid},Ql.friendgrowthdaydayup(t.uid,function(t){void 0!=t&&(e.parseServerData(t.growth),e.showLayer1(),e.UpDateUpDownMenuState(),e.mLayer2&&e.mLayer2.setVisible(!1))})):ju.alert(b.Dialog_Hint8)}else ju.alert(b.Dialog_Hint8)},shotCurScreen:function(){l.log("shot cur screen");var e=nr.share().getWinSize(),t=new l.RenderTexture(e.width,e.height),i=this.getParent();if(t&&i){t.begin();for(var n=0;n<i.getChildren().length;n++){var s=i.getChildren()[n];4!=s.getTag()&&15!=s.getTag()&&1e3!=s.getTag()&&1001!=s.getTag()&&61!=s.getTag()&&s.visit()}t.end(),t.cleanup(),t.setPosition(e.width/2,e.height/2)}},getAngel:function(e){var t=0;return e.x>0&&0==e.y?t=0:e.x>0&&e.y>0?t=l.radiansToDegrees(l.pToAngle(e)):0==e.x&&e.y>0?t=90:e.x<0&&e.y>0?(e.x=-1*e.x,t=180-l.radiansToDegrees(l.pToAngle(e))):e.x<0&&0==e.y?t=180:e.x<0&&e.y<0?(e.x=-1*e.x,e.y=-1*e.y,t=180+l.radiansToDegrees(l.pToAngle(e))):0==e.x&&e.y<0?t=270:e.x>0&&e.y<0&&(e.y=-1*e.y,t=360-l.radiansToDegrees(l.pToAngle(e))),t},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e),a=null;a=null==n?new l.Sprite(e):new l.Sprite(n);var o=null;o=null==s?new l.Sprite(e):new l.Sprite(s);var h=new l.MenuItemSprite(r,a,o,this,this.menuCallback.bind(this));return r.setAnchorPoint(.5,.5),a.setAnchorPoint(.5,.5),r.setPosition(.5*h.width,.5*h.height),a.setPosition(.5*h.width,.5*h.height),a.setScale(1.1),h.setTag(t),h.setPosition(i),h},menuItemWithFile1:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return r.setAnchorPoint(.5,.5),r.setPosition(.5*d.width,.5*d.height),o.setAnchorPoint(.5,.5),o.setPosition(.5*d.width,.5*d.height),o.setScale(1.1),d.setTag(t),d.setPosition(i),d},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},onEnterTransitionDidFinish:function(){this._super()},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){}});vl.create=function(){return new vl};var Ll=l.Menu.extend({ctor:function(e){this._super(e)},_onTouchBegan:function(e,t){wr.getModel();var i=t.getCurrentTarget();if(i._state!==l.MENU_STATE_WAITING||!i._visible||!i.enabled)return!1;for(var n=i.parent;null!=n;n=n.parent)if(!n.isVisible())return!1;return i._selectedItem=i._itemForTouch(e),!!i._selectedItem&&(i._state=l.MENU_STATE_TRACKING_TOUCH,i._selectedItem.selected(),!0)}});Ll.createWithArray=function(e){return new Ll(e)};var Ml=100,Cl=Xs.extend({m_pBgLayer:null,m_pSpriteItems:null,m_pSpriteItemsRouteMap:null,m_fXoffset:0,m_fMoveLength:0,m_fDis:0,m_bLeft:!1,m_bRight:!1,m_dlg:null,m_pRightMenu:null,m_pRightStarMore:null,m_nStarCount:0,m_nGM:0,m_nGS:0,m_nRM:0,m_nRS:0,m_nDisGM:0,m_nDisGS:0,m_nRouletteState:0,m_nLifeForeverPCut:0,m_pRoute:null,m_pSelectItem:null,m_pLoadingBg:null,m_pStarcounter:null,m_pLableSecond:null,m_pLableMinute:null,m_pLabelRouletteMinute:null,m_pLabelRouletteSecond:null,m_pTime:null,m_spTips:null,listener:null,showCircleAnimate:!1,luoboHonor:null,friends:null,ctor:function(){this._super(),this.addLayerName("scene-meet")},init:function(){this._super(),this.mScale=nr.share().isIPad()?1:.5,this.registerWithTouchDispatcher(!0);var e=wr.getModel();return e.selLayer=this,e.m_nGameMode=ge.DOUBLECARROT,e.usersData.mIsShowedAQiuTipsAnimation||(e.usersData.mIsShowedAQiuTipsAnimation=!0),this.loadResources(),this.m_pBgLayer=new l.Layer,this.addChild(this.m_pBgLayer),this.m_pSpriteItems=new l.SpriteBatchNode("res/Themes/LevelSelect/LevelSel01-hd.png",10),this.m_pBgLayer.addChild(this.m_pSpriteItems,101),this.m_pSpriteItemsRouteMap=new l.SpriteBatchNode("res/Themes/LevelSelect/routemap1-hd.png",10),this.m_pBgLayer.addChild(this.m_pSpriteItemsRouteMap,100),!0},loadData:function(e){if(dp){var t=this;Ql.entertheme({type:Le.DOUBLECARROT,mainenter:0},function(i,n){n?ju.Retry(n,function(){t.loadData(e)}):(t.loadServerData(i),e&&e())})}else e&&e()},loadServerData:function(e){if(void 0!==e){var t=wr.getModel(),i=t.usersData;if(t.stageType=Le.DOUBLECARROT,i.doubleCarrotStars=e.aqiucoststar,this.m_nStarCount=e.star,t.setThemes(e.cfg),i.setDoubelOpenLevel(e.openedlevel),i.setStarCount(this.m_nStarCount),i.setWaitTime(e.laststartime),this.luoboHonor=e.luobos,i.resurgencediamondddu=e.resurgencediamond,e.buystar&&e.buystar instanceof Array&&(i.setConsumePropPriceById(1002,e.buystar[0]),i.setConsumePropPriceById(1003,e.buystar[1])),t.getIsShowDoubleModeTip()){r=this;qu.loadResAsync(Si,function(){var e=yl.create();r.addChild(e,199,2005),e.setLockLevel(t.usersData.getDoubelLastPlayedLevel())})}this.showCheckPoint(this.luoboHonor),i.setGoldCount(0);var n=i.getGoldCount();if(e.glb&&i.setGoldCount(e.glb-n),i.setHonorCount(0),n=i.getTaskHonorCount(),e.zsj&&i.setHonorCount(e.zsj-n),this.addBgLayer(),this.addMenuLayer(),this.showMap(),this.showUserHead(),this.m_nStarCount<(t.m_nGameMode===ge.HIGHERMODE?i.getHigherLifeStarByUM():i.getLifeStarWithTime())){var s=i.getWaitMS();this.m_nGM=s.m,this.m_nGS=s.s,this.loadCountDown()}(this.m_nStarCount<=5||t.usersData.isLifeForever())&&this.m_pRightStarMore.setVisible(!1),this.UpdateStar(0);var r=this;lp&&SDKInterface.getFriendList(50,function(e){i.setFriendList(e),r.sendFriendsList(e)}),l.addTimePoint("meetfiend_end"),l.printTimePoint("meetfiend_start","meetfiend_end")}},sendFriendsList:function(e){var t=this;if(dp){t.friends=e;var i=[];for(var n in e)i.push(e[n].id);Ql.cgetfriendsinfo(Le.DOUBLECARROT,i,function(e){t.loadFriendsData(e.friends)})}},loadFriendsData:function(e){if(void 0!=e){var t=[],i=GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook?"":100;for(var n in e){var s=e[n];for(var r in this.friends){var a=this.friends[r];if(a.id!==l.playerInfo.openid){if(a.id===s.openid){s.photo=a.photo+i,s.name=a.name;break}}else s.photo=l.playerInfo.photo,s.name=l.playerInfo.name}s.stage>=156&&(console.log("friendData.stage:"+s.stage),t.push(s))}this.friends=t,this.addFriendsLayer()}},showUserHead:function(){var e=wr.getModel(),t=e.usersData;t.setWinNewLevel(!1);var i=t.getDoubelOpenedLevel();i>e.mapConfig.allLevels.length&&(i=e.mapConfig.allLevels.length);var n=e.mapConfig.allLevels[i-1].ptLevelNum;this.createUserHead(l.playerInfo.photo,l.playerInfo.name,n)},addFriendsLayer:function(){var e=wr.getModel(),t=e.usersData;t.setFriendList(this.friends);for(var i in this.friends){var n=this.friends[i];if(n.openid!==l.playerInfo.openid){var s=n.stage;if(!(s===t.getDoubelOpenedLevel()||s<156)){console.log("addFriendsLayer stage:"+s+"users.getDoubelOpenedLevel :"+t.getDoubelOpenedLevel()),s>170&&(s=170);var r=e.mapConfig.allLevels[s-1].ptLevelNum;this.createUserHead(n.photo,n.name,r)}}}},createUserHead:function(e,t,i){if(void 0!=i){var n=new l.Sprite("stage_avatar_single.png");n.setAnchorPoint(.5,0),n.setPosition(i.x,i.y-50+85*this.mScale),this.m_pBgLayer.addChild(n,101);var s=e,r=null;if(s)r=Rt.createPhotoSprite(),Rt.loadUserPhoto(s,r);else{var a=l.spriteFrameCache.getSpriteFrame("UserHead.png");(r=new l.Sprite(a)).setScale(1.2)}r&&(r.setPosition(45,50),n.addChild(r,-1),n.setScale(.8))}},loadCountDown:function(){this.m_pTime=this.menuItemWithFile("stagemap_toolbar_timer_normal.png",Y,l.p(146*this.mScale,26*this.mScale),"stagemap_toolbar_timer_pressed.png");var e=Ll.createWithArray(this.m_pTime);e.setPosition(0,0),e.setAnchorPoint(0,0),this.m_pRightMenu.addChild(e,-2,6),this.m_pLableMinute=new l.LabelAtlas(String.formatC("%02lu",this.m_nGM),"num_white_18.png",18*this.mScale,30*this.mScale,"./0123456789"),this.m_pLableMinute.setAnchorPoint(0,0),this.m_pLableMinute.setPosition(30*this.mScale,42*this.mScale),this.m_pTime.addChild(this.m_pLableMinute,1),this.m_pLableSecond=new l.LabelAtlas(String.formatC("%02lu",this.m_nGS),"num_white_18.png",18*this.mScale,30*this.mScale,"./0123456789"),this.m_pLableSecond.setAnchorPoint(0,0),this.m_pLableSecond.setPosition(76*this.mScale,42*this.mScale),this.m_pTime.addChild(this.m_pLableSecond,1)},RouletteUpdate:function(){var e=this.getChildByTag(x);if(e){i=l.sequence(l.moveBy(.2,0,-330*this.mScale),l.moveBy(.1,0,30*this.mScale));e.runAction(i)}var t=this.getChildByTag(N);if(t){var i=l.sequence(l.moveBy(.2,0,-330*this.mScale),l.moveBy(.1,0,30*this.mScale));t.runAction(i)}},menuCallback:function(e){var t=wr.getModel();t.playSoundWithType($.MTMENUSELECT);var i=this;switch(e.getTag()){case V:l.addTimePoint("level start"),qi.preloadWithLoadingTag(Yd.getUsedRes(),we.LEVELSEL),t.bBackMainScene=!0;break;case z:l.addTimePoint("shopopen_s"),qu.loadResAsync(ri,function(){var e=fo.create(1);i.addChild(e,100)});break;case Y:if(t.usersData.isLifeForever())break;l.addTimePoint("LifeRequestDlg_s"),qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(vr.LEVEL),i.addChild(e,99,199)});break;case X:l.addTimePoint("friendHonorDlgopen_s"),qu.loadResAsync(Ni,function(){var e=Mr.create();e.showFriends(vr.ALL),i.addChild(e,99)});break;case Q:var n=this.getChildByTag(x);n&&n.runAction(l.moveBy(.2,0,300*this.mScale));var s=this.getChildByTag(N);s&&s.runAction(l.moveBy(.2,0,300*this.mScale)),qu.loadResAsync(ai,function(){var e=_c.create();i.addChild(e,99)});break;case Z:this.unschedule(this.DisCountTimeUpdate);var r=yr.create();this.addChild(r,100);break;case 4444:Ql.opengoldencup(function(e){qu.loadResAsync(gi,function(){i.showCheckPoint(e.luobos),i.showThemeHonor()})});break;case j:l.director.getScheduler().isWaite=!1,(a=this.getChildByTag(5678))&&a.isVisible()&&(a.setVisible(!1),t.bLockMenu=!1),(a=this.getChildByTag(256))&&a.isVisible()&&(a.setVisible(!1),t.bLockMenu=!1,this.msgRateCallFun(this,1));break;case K:var a=this.getChildByTag(256);a&&a.isVisible()&&(a.setVisible(!1),t.bLockMenu=!1),this.msgRateCallFun(this,0);break;case Yh:GamePlatform.getCurrentPlatForm()==PlatformType.QQ?kl.shareScreenshot(0,function(e){e&&i._rewardSpr&&(i._rewardSpr.removeFromParent(),i._rewardSpr=null)}):kl.shareMessage(null,"",Wl.REWARD_SHARE,0,1,null,function(e){e&&i._rewardSpr&&(i._rewardSpr.removeFromParent(),i._rewardSpr=null)})}},ccTouchBegan:function(e,t){var i=wr.getModel();if(i.bLockMenu)return!0;var n=this.getChildByTag(U);if(n&&n.isVisible())return!0;this.m_fMoveLength=0;var s=this.convertTouchToNodeSpace(e);s.x=s.x-this.m_fXoffset;for(var r=parseInt(this.m_fXoffset/(he*this.mScale)),a=-1,o=10*(r*=-1);o<10*(r+2);o++)if(o<i.mapConfig.allLevels.length){var h=i.mapConfig.allLevels[o].ptLevelNum;if(l.pDistance(h,s)<30){a=o+1;break}}return a>0&&a<=i.usersData.getDoubelOpenedLevel()&&(this.m_pSelectItem=this.m_pBgLayer.getChildByTag(k+a),this.m_pSelectItem&&this.m_pSelectItem.setScale(1.2)),!0},ccTouchMoved:function(e,t){if(!wr.getModel().bLockMenu){var i=this.getChildByTag(U);if(!i||!i.isVisible()){var n=nr.share().getWinSize(),s=this.convertTouchToNodeSpace(e),r=e.getPreviousLocationInView();r=l.director.convertToGL(r),r=this.convertToNodeSpace(r),s=l.director.convertToGL(s),s=this.convertToNodeSpace(s);var a=l.pSub(s,r);this.m_fMoveLength+=-a.x,this.m_fMoveLength>0?this.m_bLeft&&(this.m_bLeft=!this.m_bLeft):this.m_bRight&&(this.m_bRight=!this.m_bRight),(this.m_fMoveLength>=30||this.m_fMoveLength<=-30)&&this.m_pSelectItem&&(this.m_pSelectItem.setScale(1),this.m_pSelectItem=null),this.m_fDis=8*a.x,a.y=0;var o=l.pAdd(this.m_pBgLayer.getPosition(),a);o.x>0?(o.x=0,this.m_bLeft||(this.m_bLeft=!0)):o.x<-he*this.mScale*1+n.width-he*this.mScale-430*this.mScale&&(o.x=-he*this.mScale*1+n.width-he*this.mScale-430*this.mScale,this.m_bRight||(this.m_bRight=!0)),this.m_fXoffset=o.x,this.m_pBgLayer.setPosition(o)}}},ccTouchEnded:function(e,t){var i=wr.getModel(),n=this.convertTouchToNodeSpace(e);if(!i.bLockMenu&&((this.m_fDis<-4||this.m_fDis>4)&&this.SlowDownShow(),this.m_pSelectItem&&(this.m_pSelectItem.setScale(1),this.m_pSelectItem=null),this.m_fMoveLength<30&&this.m_fMoveLength>-30&&this.clickOnLevelItem(n),!i.usersData.isLifeForever()&&i.usersData.getGameStars()>=5&&this.m_pRightMenu)){var s,r=this.m_pRightMenu.getContentSize();if(s=0!=this.m_nDisGM||0!=this.m_nDisGS?l.rect(this.m_pRightMenu.x-r.width,this.m_pRightMenu.y-r.height,r.width,r.height):l.rect(this.m_pRightMenu.x-r.width,this.m_pRightMenu.y-r.height+40*this.mScale,r.width,r.height),l.rectContainsPoint(s,n)){var a=this;return l.addTimePoint("LifeRequestDlg_s"),void qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(2),a.addChild(e,99,199)})}}},onEnterTransitionDidFinish:function(){if(this._super(),!dp){var e=wr.getModel();if(e.getIsShowDoubleModeTip()){var t=this;qu.loadResAsync(Si,function(){var i=yl.create();t.addChild(i,199,2005),i.setLockLevel(e.usersData.getDoubelLastPlayedLevel())})}}this.ShowCircleAnimate()},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},keyBackClicked:function(){var e=wr.getModel();e.m_nGameMode=ge.NORMALMODE,e.usersData.setCarrotFigure(ue.CARROT_NORMAL),e.usersData.setSecondCarrotFigure(ue.CARROT_NORMAL),qi.preloadWithLoadingTag(Ai,we.MEETFRIEND)},onExit:function(){wr.getModel().selLayer=null,this.unschedule(this.UpdateFailTime),this.unschedule(this.DisCountTimeUpdate),this.listener&&l.eventManager.removeListener(this.listener),qu.clearOwner(this),this._super()},loadResources:function(){var e=wr.getModel().usersData.m_nLanguage;qu.addRes(this,"res/Themes/LevelSelect/LevelSel04-hd.plist"),qu.addRes(this,"res/Themes/LevelSelect/LevelSel01-hd.plist"),qu.addRes(this,"res/Themes/LevelSelect/LevelSel02-hd.plist");var t=String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.plist",e,e);qu.addRes(this,t);var i=String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",e,e);qu.addRes(this,i)},addBgLayer:function(){for(var e=wr.getModel(),t=e.usersData,i=(nr.share().getWinSize(),e.mapConfig.allLevels.length+1),n=1;n<=3;n++){var s=String.formatC("stagemap_q%d.png",n);(L=new l.Sprite(s)).setAnchorPoint(0,0),L.setPosition((n-1)*he*this.mScale,0),this.m_pBgLayer.addChild(L,1);var r=this.showGlowwornAnimation();if(L.addChild(r,102),1==n){var a=new l.Sprite("stagemap_q1_cover.png");a.setPosition(l.pMult(l.p(863,320),this.mScale)),L.addChild(a,101);var o=new l.Sprite("meetaqo_themeani_island_1.png");o.setPosition(l.pMult(l.p(859,329),this.mScale)),L.addChild(o,100),o.runAction(l.repeatForever(l.sequence(l.moveBy(2.5,0,-15),l.moveBy(2,0,15)))),r.setPosition(462,496);var h=this.showGlowwornAnimation();h.setPosition(448,147),L.addChild(h,102),this.ShowWaterFallAnimation(L,this.mScale,0),this.ShowWaterFallAnimation(L,this.mScale,1)}if(2==n&&r.setPosition(85,552),3==n){var d=t.getThemeHonor(10);if(d){var c=1==d?"meetaqo_themeaward_cup.png":3==d?"meetaqo_themeaward_cup_clear.png":5==d?"meetaqo_themeaward_cup_mission.png":"meetaqo_themeaward_cup_clearandmission.png",u=new l.Sprite(c),p=new l.Sprite(c),m=new l.MenuItemSprite(u,p,null,this,this.menuCallback.bind(this));m.setTag(4444),m.setPosition(l.pMult(l.p(183,496),this.mScale));var _=new l.Menu(m,null);_.setPosition(0,0),L.addChild(_,101);var g=new l.Sprite("meetaqo_cover.png");g.setPosition(l.pMult(l.p(188,453),this.mScale)),L.addChild(g,102)}else{var T=new l.Sprite("meetaqo_normal.png");T.setPosition(l.pMult(l.p(201,474),this.mScale)),L.addChild(T,101)}r.setPosition(278,171);var f=new l.Sprite("meetaqo_themeani_island_2.png");f.setPosition(l.pMult(l.p(255,130),this.mScale)),L.addChild(f,101),f.runAction(l.repeatForever(l.sequence(l.moveBy(2.5,0,-15),l.moveBy(2,0,15))))}}for(var S=156;S<i;S++){var w=e.mapConfig.allLevels[S-1],v=w.ptLevelNum,L=null,M=dp?this.getCurLevelHonor(S):t.getFirstHonor(S);if(M>0)switch(M){case 1:L=new l.Sprite(t.getTaskHonor(S)?"meetaqo_stagepoint_mission_wood.png":"meetaqo_stagepoint_wood.png");break;case 2:L=new l.Sprite(t.getTaskHonor(S)?"meetaqo_stagepoint_mission_silver.png":"meetaqo_stagepoint_silver.png");break;case 3:L=new l.Sprite(t.getTaskHonor(S)?"meetaqo_stagepoint_mission_gold.png":"meetaqo_stagepoint_gold.png")}else L=0!=w.nBossModeSecond?new l.Sprite("meetaqo_stagepoint_boss.png"):w.bPresentGate?new l.Sprite("meetaqo_stagepoint_gate.png"):new l.Sprite("meetaqo_stagepoint_adv.png");L&&(L.setPosition(v),this.m_pBgLayer.addChild(L,3,k+S))}dp||this.showMap()},showMap:function(){var e=nr.share().getWinSize(),t=wr.getModel(),i=t.usersData,n=i.getDoubelOpenedLevel();t.mapConfig.allLevels[n-1].ptLevelNum;this.m_fXoffset=e.width/2-t.usersData.xOffsetLevelSelDouble,this.m_fXoffset>0&&(this.m_fXoffset=0),this.m_fXoffset<-2*he*this.mScale+e.width&&(this.m_fXoffset=-2*he*this.mScale+e.width),this.m_pBgLayer.setPosition(this.m_fXoffset,0);i.bWinNewLevel&&i.getDoubelOpenedLevel()>155||this.ShowCircleAnimate()},addMenuLayer:function(){var e=nr.share().getWinSize(),t=new l.Sprite("stagemap_toolbar_leftbg.png");t.setAnchorPoint(0,1),t.setPosition(0,e.height),this.addChild(t,98,98);var i=this.menuItemWithFile("stagemap_toolbar_back.png",V,l.p(61*this.mScale,54*this.mScale)),n=this.menuItemWithFile("stagemap_toolbar_shop.png",z,l.p(162*this.mScale,54*this.mScale)),s=this.menuItemWithFile("stagemap_toolbar_leaderboard.png",X,l.p(262.4*this.mScale,54*this.mScale)),r=Ll.createWithArray([i,n,s]);r.setPosition(0,0),r.setAnchorPoint(0,0),t.addChild(r),this.m_pRightMenu=new l.Sprite("stagemap_toolbar_rightbg.png"),this.m_pRightMenu.setAnchorPoint(1,1);var a=.5==this.mScale?2:0;this.m_pRightMenu.setPosition(e.width+a,e.height),this.addChild(this.m_pRightMenu,99,599);var o=wr.getModel();this.m_pRightStarMore=this.m_pRightMenu.getChildByTag(767),void 0==this.m_pRightStarMore&&(this.m_pRightStarMore=new l.Sprite(o.m_nGameMode==ge.HIGHERMODE?"stagemap_toolbar_floor.png":"stagemap_toolbar_overten.png"),this.m_pRightStarMore.setAnchorPoint(0,0),this.m_pRightStarMore.setPosition(0,0),this.m_pRightMenu.addChild(this.m_pRightStarMore,767)),this.m_nStarCount=o.usersData.getGameStars(),(this.m_nStarCount<=5||o.usersData.isLifeForever())&&this.m_pRightStarMore.setVisible(!1);var h=this.m_nRouletteState=o.usersData.getRouletteTime(this.m_nRM,this.m_nRS);if(this.m_nRM=h.m,this.m_nRS=h.s,this.m_nRouletteState=h.result&&!1,this.m_nRouletteState){var d=new l.Sprite("wheel_btn_bg.png");d.setAnchorPoint(.5,.5),d.setPosition(.5*e.width,e.height+20),this.addChild(d,99,x),d.runAction(l.repeatForever(l.rotateBy(8,360)));var c=null,u=!0;o.m_bFeast&&o.m_oFeast.getCurFeastType()==mn?(c=this.menuItemWithFile("wheel_btn_allday.png",Q,l.p(100*this.mScale,100*this.mScale),"wheel_btn_allday.png"),u=!1):c=this.menuItemWithFile("wheel_btn.png",Q,l.p(100*this.mScale,100*this.mScale),"wheel_btn.png");var p=Ll.createWithArray([c]);p.setPosition(.5*e.width-100*this.mScale,e.height-105*this.mScale),this.addChild(p,99,N),u&&(this.m_pLabelRouletteMinute=new l.LabelAtlas(String.formatC("%02lu",this.m_nRM),"num_white_18.png",18*this.mScale,30*this.mScale,"./0123456789"),this.m_pLabelRouletteMinute.setAnchorPoint(.5,.5),this.m_pLabelRouletteMinute.setPosition(76*this.mScale,46*this.mScale),c.addChild(this.m_pLabelRouletteMinute),this.m_pLabelRouletteSecond=new l.LabelAtlas(String.formatC("%02lu",this.m_nRS),"num_white_18.png",18*this.mScale,30*this.mScale,"./0123456789"),this.m_pLabelRouletteSecond.setAnchorPoint(.5,.5),this.m_pLabelRouletteSecond.setPosition(124*this.mScale,46*this.mScale),c.addChild(this.m_pLabelRouletteSecond),this.schedule(this.UpdateRouletteTime,1))}else if(o.usersData.showDiscountMenu()){o.usersData.GetDisCountTime(void 0,void 0,void 0).result?this.schedule(this.DisCountTimeUpdate,1):o.usersData.GetDisCountSale(),this.ShowDiscountMenu()}if(o.usersData.isLifeForever()){var m=new l.Sprite("stagemap_toolbar_unlimited.png");return m.setAnchorPoint(0,0),m.setPosition(0,0),void this.m_pRightMenu.addChild(m)}if(!dp){this.m_nStarCount=o.usersData.getGameStars();var _=o.usersData.getWaitMS();this.m_nGM=_.m,this.m_nGS=_.s,this.loadCountDown(),this.UpdateStar(0)}},showRouteMap:function(){},menuItemWithFile:function(e,t,i,n,s,r,a,o,h){if(arguments.length>4){void 0==h&&(h=1);var d=new l.Sprite(t);n&&(n.setPosition(r),d.addChild(n));u=null;return i&&i.length&&(u=new l.Sprite(i),s&&(s.setPosition(r.x,r.y),u.addChild(s))),(p=new l.MenuItemSprite(d,u,null,this,e)).setTag(a),p.setPosition(o),p}var c=new l.Sprite(e),u=null;u=null==n?new l.Sprite(e):new l.Sprite(n);var p=new l.MenuItemSprite(c,u,null,this,this.menuCallback.bind(this));return p.setTag(t),p.setPosition(i),p},clickOnLevelItem:function(e){var t=wr.getModel(),i=t.usersData;e.x=e.x-this.m_fXoffset;this.m_fXoffset,this.mScale;for(var n=-1,s=0;s<15;s++)if(s<t.mapConfig.allLevels.length){var r=t.mapConfig.allLevels[s+155].ptLevelNum;if(l.pDistance(r,e)<50*this.mScale){n=s+1;break}}if(t.usersData.getDoubelOpenedLevel()<156&&t.usersData.setDoubelOpenLevel(156),n>0){if(n+155>i.getDoubelOpenedLevel())return!0;if(155+n>160&&t.usersData.getOpenedLevel()<=27){a=this;return qu.loadResAsync(Si,function(){var e=yl.create();a.addChild(e,199,2005),e.setLockLevel(t.usersData.getDoubelLastPlayedLevel())}),!0}if(t.setCurLevel(n+155),t.m_nGameMode=ge.DOUBLECARROT,t.usersData.setCarrotFigure(ue.CARROT_NORMAL),t.usersData.setSecondCarrotFigure(ue.CARROT_GIRL),!t.usersData.canPlay()){var a=this;return qu.loadResAsync(xi,function(){a.m_dlg=Qc.create(),a.m_dlg.setOnCloseCallback(a,a.onCloseCallback.bind(a)),a.addChild(a.m_dlg,99)}),!0}return t.playSoundWithType($.MTPAGESELECT),this.showLevelInfo(n+155),!0}return!1},clickOnFriendHead:function(e){return!1},clickOnUserMeHead:function(e){return!1},showLevelInfo:function(e){var t=wr.getModel(),i=t.usersData.m_nLanguage,n=this,s=[],r=t.getCurTheme(),i=t.usersData.m_nLanguage,a=String.formatC("res/Themes/Maps/BG%02lu-hd",e),o=String.formatC("res/Themes%s/Maps/BG%02lu-hd%s",i,e,i);s.push(Ki(a+".png")),s.push(Ki(a+".plist")),s.push(Ki(o+".png")),s.push(Ki(o+".plist")),s.push(Ki(String.formatC("res/Themes/Theme%d/BG-hd.plist",r))),s.push(Ki(String.formatC("res/Themes/Theme%d/BG-hd.png",r))),l.addTimePoint("LevelInfoDlg_s"),qu.loadResAsync(s,function(){var i=Ra.create();(dp?n.getCurLevelHonor(e):t.usersData.getFirstHonor(e))>0?t.usersData.getTaskHonor(e)?i.SetShowLayer(1):i.SetShowLayer(2):i.SetShowLayer(1),n.addChild(i,99)})},getCurLevelHonor:function(e){for(var t in this.luoboHonor){var i=this.luoboHonor[t],n=i[0],s=i[1];if(e===n)return s}return 0},showCheckPoint:function(e){if(void 0!=e&&e.length)for(var t=wr.getModel().usersData,i=0;i<e.length;i++){var n=e[i],s=n[0],r=n[1],a=n[2],o=n[3];t.setLevelFirstHonor(s,r,0),a&&(t.setLevelFinishTask(s,1,0),t.setLevelFinishTask(s,2,0),t.setLevelFinishTask(s,3,0)),o&&t.setLevelClearHonor(s)}},showThemeHonor:function(){var e=wr.getModel();e.bLockMenu=!0;var t=e.usersData.m_nLanguage;qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/AwardBG%s.plist",t,t)),qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",t));var i=nr.share().getMapOffset(),n=this.getChildByTag(5678);if(null==n){var s=nr.share().getWinSize(),r=new l.LayerColor(l.color(0,0,0,178),s.width,s.height);this.addChild(r,5678,5678);var a=new l.Sprite("themeaward_bg.png");a.setPosition(.5*s.width,.5*s.height),r.addChild(a,2,2);for(var o=[l.p(182*this.mScale+i.width,440*this.mScale),l.p(329*this.mScale+i.width,440*this.mScale),l.p(477*this.mScale+i.width,440*this.mScale),l.p(625*this.mScale+i.width,440*this.mScale),l.p(773*this.mScale+i.width,440*this.mScale),l.p(182*this.mScale+i.width,199*this.mScale),l.p(329*this.mScale+i.width,199*this.mScale),l.p(477*this.mScale+i.width,199*this.mScale),l.p(625*this.mScale+i.width,199*this.mScale),l.p(773*this.mScale+i.width,199*this.mScale)],h=1;h<11;h++){var d=e.usersData.getThemeHonor(h),c=new l.Sprite(0==d?"themeaward_disable.png":1==d?"themeaward_cup.png":3==d?"themeaward_cup_clear.png":5==d?"themeaward_cup_mission.png":"themeaward_cup_clearandmission.png");c.setPosition(o[h-1]),r.addChild(c,5)}var u=new l.Sprite("popup_close_frame.png");u.setPosition(867*this.mScale+i.width,575*this.mScale),r.addChild(u,6,6);var p=this.menuItemWithFile("popup_close.png",j,l.p(867*this.mScale+i.width,575*this.mScale)),m=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,_=GamePlatform.isCN()?m?"themeaward_share_qq.png":"themeaward_share_wechat.png":"themeaward_share.png",g=this.menuItemWithFile(_,Yh,l.p(60+i.width,207));e.usersData.isShareWeChat()||GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook||(this._rewardSpr=new l.Sprite("themeaward_share_wechat_new.png"),this._rewardSpr.setAnchorPoint(1,.5),this._rewardSpr.setPosition(23,.5*g.height),g.addChild(this._rewardSpr));var T=new l.Menu(p,g);T.setPosition(0,0),r.addChild(T,15,15)}else n.setVisible(!0)},UpdateFailTime:function(){0!=this.m_nGM||0!=this.m_nGS?(0==this.m_nGS?(this.m_nGS=59,this.m_nGM--):this.m_nGS--,this.UpdateStar(3),this.m_dlg&&this.m_dlg.UpDateTimes()):this.UpdateStar(1)},UpdateRouletteTime:function(){if(0!=this.m_nRM||0!=this.m_nRS)0==this.m_nRS?(this.m_nRS=59,this.m_nRM--,this.m_pLabelRouletteMinute.setString(String.formatC("%02lu",this.m_nRM))):this.m_nRS--,this.m_pLabelRouletteSecond.setString(String.formatC("%02lu",this.m_nRS));else{var e=this.getChildByTag(x);e&&e.runAction(l.moveBy(.2,0,300));var t=this.getChildByTag(N);t&&t.runAction(l.moveBy(.2,0,300)),this.unschedule(this.UpdateRouletteTime);var i=wr.getActivedModel();if(i){var n=i.usersData.getRouletteTime(this.m_nRM,this.m_nRS);this.m_nRM=n.m,this.m_nRS=n.s}}},UpdateDiscountTime:function(){if(0!=this.m_nDisGM||0!=this.m_nDisGS)0==this.m_nDisGS?(this.m_nDisGS=59,this.m_nDisGM--):this.m_nDisGS--;else{this.unschedule(this.UpdateDiscountTime);var e=this.m_pRightMenu.getChildByTag(W);e&&e.setVisible(!1)}},UpdateStar:function(e){if(!(n=wr.getModel()).usersData.isLifeForever())switch(e){case 0:a=[78,66,110,154,198,242];if(this.m_nStarCount>5)this.lifeStarMoreUpdate();else for(h=1;h<6;h++){var t=l.p(a[h],a[0]),i=null;if(!(i=this.m_nStarCount>=h?new l.Sprite(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png"):new l.Sprite(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png")))return;i.setPosition(t),this.m_pRightMenu.addChild(i,1,h)}dp||this.loadCountDown(),this.m_nStarCount<n.usersData.getLifeStarWithTime()?this.schedule(this.UpdateFailTime,1):(this.m_pTime&&this.m_pTime.setVisible(!1),this.m_spTips&&(this.m_spTips.setPosition(32*this.mScale,12*this.mScale),n.usersData.YSLoseTimes>2&&this.m_spTips.setVisible(!1)));break;case 1:case 2:case 4:var n=wr.getModel();this.m_nStarCount=n.usersData.getGameStars();_=n.usersData.getWaitMS(this.m_nGM,this.m_nGS);if(this.m_nGM=_.m,this.m_nGS=_.s,1==e){var s=this.getChildByTag(199);s&&s.UpdateStars(this.m_nStarCount)}if(!this.m_pRightMenu)break;var r=this.m_pRightMenu.getChildByTag(this.m_nStarCount);if(null==r)if(this.m_nStarCount<=5&&this.m_nStarCount>0){if(!(T=l.spriteFrameCache.getSpriteFrame(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png")))return;var i=this.m_pRightMenu.getChildByTag(this.m_nStarCount),a=[78,66,110,154,198,242];i=new l.Sprite(T);t=l.p(a[this.m_nStarCount]*this.mScale,a[0]*this.mScale);i.setPosition(t),this.m_pRightMenu.addChild(i,1,this.m_nStarCount)}else 4!=e&&this.lifeStarMoreUpdate();if(r&&e<4){if(this.m_nStarCount<=5){if(!(T=l.spriteFrameCache.getSpriteFrame(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png")))return;if(1==e){for(var o=[],h=1;h<4;h++){var d=n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_flash%d.png":"lifestar_flash%d.png",c=l.spriteFrameCache.getSpriteFrame(String.formatC(d,h));c&&o.push(c)}o.push(T);var u=new l.Animation(o,.1);r.runAction(l.animate(u))}else r.setSpriteFrame(T)}else this.lifeStarMoreUpdate();if(this.m_nStarCount>=n.usersData.getLifeStarWithTime()){var p=0,m=0,_=n.usersData.getLifeForeverPCutTime(p,m);if(this.m_nLifeForeverPCut=_.result,p=_.m,m=_.s,this.m_nLifeForeverPCut){var g=new l.Sprite(2==this.m_nLifeForeverPCut?"stagemap_toolbar_limited.png":"stagemap_toolbar_limited_6.png");if(!g)return;g.setPosition(this.m_pRightMenu.width/2,27*this.mScale),this.m_pRightMenu.addChild(g,-2,W)}}}else if(4==e)if(this.m_nStarCount<=5)for(h=1;h<6;h++){var T=null;if(!(T=this.m_nStarCount>=h?l.spriteFrameCache.getSpriteFrame(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png"):l.spriteFrameCache.getSpriteFrame(n.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png")))return;a=[78,66,110,154,198,242];if(null==(i=this.m_pRightMenu.getChildByTag(h))){if(!(i=new l.Sprite(T)))return;t=l.p(a[h]*this.mScale,a[0]*this.mScale);i.setPosition(t),this.m_pRightMenu.addChild(i,1,h)}else i.setSpriteFrame(T)}else this.lifeStarMoreUpdate();case 3:if(this.m_nStarCount>=n.usersData.getLifeStarWithTime()){if(this.unschedule(this.UpdateFailTime),this.m_pTime){var t=this.m_pTime.getPosition(),f=l.moveTo(1,t.x,t.y+300*this.mScale);this.m_pTime.runAction(f)}}else{var S=String.formatC("%02lu",this.m_nGM);this.m_pLableMinute.setString(S);var w=String.formatC("%02lu",this.m_nGS);this.m_pLableSecond.setString(w)}}},actionUpdateStar:function(){var e=wr.getActivedModel();if(e){var t=e.usersData.getRouletteTime(this.m_nRM,this.m_nRS);this.m_nRM=t.m,this.m_nRS=t.s}this.UpdateStar(4)},lifeForeverUpdate:function(){this.unschedule(this.UpdateFailTime),this.m_pRightMenu.removeAllChildren();var e=new l.Sprite("stagemap_toolbar_unlimited.png");e&&(e.setAnchorPoint(0,0),e.setPosition(0,0),this.m_pRightMenu.addChild(e))},lifeStarMoreUpdate:function(){var e=wr.getModel();if(this.m_nStarCount=e.usersData.getGameStars(),!(this.m_nStarCount<5)){for(var t=1;t<6;t++){var i=this.m_pRightMenu.getChildByTag(t);i&&i.setVisible(!1)}var n=this.m_pRightStarMore.getChildByTag(11),s=String.formatC(GamePlatform.isCN()?"%03d":"%02d",this.m_nStarCount);if(null==n){if(!(n=new l.LabelAtlas(s,"num_white_18.png",18*this.mScale,30*this.mScale,"./0123456789")))return;n.setPosition(GamePlatform.isCN()?190:203,64),this.m_pRightStarMore.addChild(n,0,11)}else n.setString(s);n.setVisible(!0),this.m_pRightStarMore.setVisible(!0),this.m_pTime&&this.m_nStarCount>=e.usersData.getLifeStarWithTime()&&(this.m_pTime.setVisible(!1),this.m_spTips&&(this.m_spTips.setPosition(32*this.mScale,12*this.mScale),e.usersData.YSLoseTimes>2&&this.m_spTips.setVisible(!1)))}},ShowDiscountMenu:function(){switch(wr.getModel().usersData.discountSelect){case le.SALE_FIGUREGIRL_10:"discount_tag_girl.png",l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_FIGUREFAT_15:"discount_tag_fat.png",l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_FIGUREOLD_15:"discount_tag_old.png",l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_STONE_750_15:case le.SALE_STONE_480_10:"discount_tag_stone.png",l.spriteFrameCache.getSpriteFrame("discount_tag_6zhe.png");break;case le.SALE_STONE_300_6:"discount_tag_stone.png",l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_STONE_150_4:"discount_tag_stone.png",l.spriteFrameCache.getSpriteFrame("discount_tag_9zhe.png");break;case le.SALE_STONE_100_2:"discount_tag_stone.png",l.spriteFrameCache.getSpriteFrame("discount_tag_6zhe.png");break;case le.SALE_BOMB_4_2:"discount_tag_bomb.png",l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_BLOOD_4_2:"discount_tag_blood.png",l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_SPEED_10_2:"discount_tag_speed.png",l.spriteFrameCache.getSpriteFrame("discount_tag_6zhe.png");break;case le.SALE_ICE_6_2:"discount_tag_ice.png",l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_SLOW_6_2:"discount_tag_slow.png",l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_PACKAGEPLATINUM_6:"discount_tag_pack.png",l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_STAR_25_4:"discount_tag_star.png",l.spriteFrameCache.getSpriteFrame("discount_tag_8zhe.png");break;case le.SALE_THEME_4_6:"discount_tag_theme4.png",l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_THEME_5_4:"discount_tag_theme5.png",l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_THEME_6_6:"discount_tag_theme6.png",l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png")}},ChangeDiscountMenuItem:function(){wr.getModel().usersData.GetDisCountSale(),this.ShowDiscountMenu()},DisCountTimeUpdate:function(){var e=wr.getModel();e.usersData.GetDisCountTime(void 0,void 0,void 0).result||(e.usersData.GetDisCountSale(),this.ShowDiscountMenu())},msgRateCallFun:function(e,t){var i=wr.getModel(),n=i.usersData;0==t?i.usersData.goCommented=i.getCurSystemTime():n.getOpenedLevel()>=20?n.goCommented=2:n.getOpenedLevel()>=10&&(n.goCommented=1)},onCloseCallback:function(){this.m_dlg=null},ShowCircleAnimate:function(){if(!this.showCircleAnimate){this.showCircleAnimate=!0;var e=wr.getModel(),t=e.usersData.getDoubelOpenedLevel();t>170&&(t=170);var i=e.mapConfig.allLevels[t-1].ptLevelNum,n=new l.Sprite("stagemap_local.png");n.setPosition(i),this.m_pBgLayer.addChild(n,2),n.setScale(.1),n.runAction(l.repeatForever(l.sequence(l.scaleTo(.6,1.4),l.spawn(l.fadeTo(.4,0),l.scaleTo(.4,2)),l.delayTime(.6),l.spawn(l.fadeTo(0,255),l.scaleTo(0,.1)))));var s=new l.Sprite("stagemap_local.png");s.setPosition(i),this.m_pBgLayer.addChild(s,2),s.setScale(.1);var r=l.callFunc(this.Circle2Animate.bind(this,s));s.runAction(l.sequence(l.hide(),l.delayTime(.3),l.show(),r));var a=new l.Sprite("stagemap_local.png");a.setPosition(i),this.m_pBgLayer.addChild(a,2),a.setScale(.1);var o=l.callFunc(this.Circle2Animate.bind(this,a));a.runAction(l.sequence(l.hide(),l.delayTime(.6),l.show(),o))}},Circle2Animate:function(e){e.runAction(l.repeatForever(l.sequence(l.scaleTo(.6,1.4),l.spawn(l.fadeTo(.4,0),l.scaleTo(.4,2)),l.delayTime(.6),l.spawn(l.fadeTo(0,255),l.scaleTo(0,.1)))))},ShowWaterFallAnimation:function(e,t,i){void 0==i&&(i=0);var n=null;0==i?(n=new l.Sprite("meetaqo_themeani_waterfall_down_01.png")).setPosition(l.pMult(l.p(420,376),this.mScale)):1==i&&(n=new l.Sprite("meetaqo_themeani_waterfall_down_01.png")).setPosition(l.pMult(l.p(603,95),this.mScale)),e.addChild(n,101);for(var s=new l.Animation,r=1;r<=4;r++){var a=null;0==i?a=String.formatC("meetaqo_themeani_waterfall_up_0%d.png",r):1==i&&(a=String.formatC("meetaqo_themeani_waterfall_down_0%d.png",r));var o=l.spriteFrameCache.getSpriteFrame(a);s.addSpriteFrame(o)}s.setDelayPerUnit(.1);var h=l.animate(s);n.runAction(l.repeatForever(h))},showGlowwornAnimation:function(){var e=new l.Sprite("meetaqo_themeani_glowworm_01.png");e.setPosition(462,496);for(var t=new l.Animation,i=1;i<5;i++){var n=String.formatC("meetaqo_themeani_glowworm_0%d.png",i),s=l.spriteFrameCache.getSpriteFrame(n);t.addSpriteFrame(s)}t.setDelayPerUnit(.5);var r=l.animate(t);return e.runAction(r),e},SlowDownShow:function(){var e=nr.share().getWinSize(),t=l.p(this.m_fDis,0),i=l.pAdd(this.m_pBgLayer.getPosition(),t);this.m_fDis=0,i.x<-he*this.mScale*1+e.width-he*this.mScale-430*this.mScale&&(i.x=-he*this.mScale*1+e.width-he*this.mScale-430*this.mScale),i.x>0&&(i.x=0);var n=l.moveTo(1,i);this.m_pBgLayer.stopActionByTag(1e3),n.setTag(1e3),this.m_pBgLayer.runAction(n.easing(l.easeExponentialOut())),this.m_fXoffset=i.x}});Cl.create=function(){return new Cl},Cl.scene=function(){var e=new l.Scene,t=Cl.create();return nr.share().scaleScene(t),e.addChild(t,0),e.loadData=t.loadData.bind(t),e};var yl=Zs.extend({listener:null,ctor:function(){this._super(Ks.DT_NOTICENOCLOSE)},addChildItems:function(){},loadResources:function(){},setLockLevel:function(e){var t=wr.getModel(),i=t.usersData.m_nLanguage;t.bLockMenu=!0,this.registerWithTouchDispatcher(!0);var n=String.formatC("res/Themes%s/scene/themelocked%s.plist",i,i);qu.addRes(this,n);var s=new l.Sprite("meetaqo_lv6_text.png");s.setPosition(401,340),this.spMainFrame.addChild(s,100);var r=this.menuItemWithFile("btn_blue_s.png",100,l.p(403,154),"btn_blue_s_pressed.png","btn_blue_ok.png"),a=new l.Menu(r,null);a.setPosition(0,0),this.spMainFrame.addChild(a,100)},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),qu.clearOwner(this),this._super()},changeStoneCount:function(){},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(.5*r.width,.5*r.height),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(.5*o.width,.5*o.height),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){var t=e;if(t&&100==t.getTag()){var i=wr.getModel();if(i.bNoStoneDlgOpen)return;if(this.isBusy)return;this.setVisible(!1),this.getParent().removeChild(this,!0),this.isWait&&(l.director.getScheduler().isWaite=!1),i.playSoundWithType($.MTMENUSELECT),i.bLockMenu=!1}}});yl.create=function(){return new yl};var Bl=111111,Fl=111112,El=111113,Pl=111114,bl=111115,Al=l.Layer.extend({listener:null,ctor:function(){this._super()},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),qu.clearOwner(this),this._super()},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},init:function(){this._super();var e=wr.getModel();e.bLockMenu=!0,this.registerWithTouchDispatcher(!0),qu.addRes(this,"res/Themes/Items/Items03-hd.plist");var t=e.usersData.m_nLanguage,i=String.formatC("res/Themes%s/Items/Items03-hd%s.plist",t.getCString(),t.getCString());qu.addRes(this,i),qu.addRes(this,"res/Themes/scene/WeiboComic-hd.plist");var n=String.formatC("res/Themes%s/scene/WeiboComic-hd%s.plist",t.getCString(),t.getCString());qu.addRes(this,n);var s=nr.share().getWinSize(),r=nr.share().getMapOffset(),a=l.spriteFrameCache.getSpriteFrame("doconnect_bg.png"),o=l.color(0,0,0,180),h=new l.LayerColor(o);h&&(h.setPosition(0,0),h.setContentSize(s),this.addChild(h,1));var d=new l.Sprite(a);d.setPosition(481+r.width,315),h.addChild(d,2);var c=new l.Sprite("popup_close_frame.png");c.setPosition(815+r.width,512),h.addChild(c,2);var u=this.menuItemWithFile1("popup_close.png",Bl,l.p(815+r.width,512),null,null),p=this.menuItemWithFile1("btn_green_b.png",Fl,l.p(480+r.width,211),null,"doconnect_login.png"),m=new l.Menu(u,p,null);return m.setPosition(0,0),this.addChild(m,3,100),!0},menuCallback:function(e){var t=e,i=wr.getModel();i.playSoundWithType($.MTMENUSELECT),t.getTag()==Bl?(this.getParent().removeChild(this,!0),i.bLockMenu=!1,qi.preloadWithLoadingTag(Yd.getUsedRes(),we.LEVELSEL)):t.getTag()==Fl&&(this.removeFromParent(!0),i.bLockMenu=!1)},menuItemWithFile1:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d}}),Ol=Zs.extend({spText:null,listener:null,ctor:function(){this._super(Ks.DT_NOTICE)},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),this._super()},addChildItems:function(){nr.share().isIPad();var e=new l.Sprite("cs_text.png");e.setPosition(396,300),this.spMainFrame.addChild(e,2,1e3)},loadResources:function(){},changeStoneCount:function(){},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},setTextStyle:function(e){},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){}}),Il=Zs.extend({spText:null,listener:null,ctor:function(){this._super(Ks.DT_NOTICENOCLOSE)},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),this._super()},addChildItems:function(){nr.share().isIPad();var e=new l.Sprite("9100_notice.png");e.setPosition(396,250),this.spMainFrame.addChild(e,2,1e3);var t=this.menuItemWithFile("btn_blue_m.png",El,l.p(250,160),"btn_blue_m_pressed.png","9100_mute.png"),i=this.menuItemWithFile("btn_green_m.png",Pl,l.p(560,160),"btn_green_m_pressed.png","9100_cancel.png"),n=new l.Menu(t,i,null);n.setPosition(0,0),this.spMainFrame.addChild(n,null)},loadResources:function(){},changeStoneCount:function(){},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},setTextStyle:function(e){},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){var t=e,i=wr.getModel();i.playSoundWithType($.MTMENUSELECT),t.getTag()==El&&(i.usersData.soundFX=!1,i.usersData.bgMusic=!1,i.playMuiscWithType($.MTSTARTBGMSC,i.usersData.bgMusic?1:2,!0)),this.getParent().removeChild(this,!0),i.bLockMenu=!1}}),Rl=Zs.extend({spText:null,listener:null,ctor:function(){this._super(Ks.DT_NOTICENOCLOSE)},addChildItems:function(){nr.share().isIPad();var e=new l.Sprite("popup_lifestar_2mode.png");e.setPosition(396,250),this.spMainFrame.addChild(e,2,1e3);var t=nr.share().getMapOffset(),i=this.menuItemWithFile1("popup_close.png",bl,l.p(655+t.width,420),null,null),n=new l.Menu(i,null);n.setPosition(0,0),this.spMainFrame.addChild(n,null)},loadResources:function(){},changeStoneCount:function(){},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),this._super()},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},setTextStyle:function(e){},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile1:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){var t=e,i=wr.getModel();i.playSoundWithType($.MTMENUSELECT),t.getTag()==bl&&(this.getParent().removeChild(this,!0),i.bLockMenu=!1)}});Al.create=function(){return new Al},Ol.create=function(){return new Ol},Il.create=function(){return new Il},Rl.create=function(){return new Rl};var Dl=l.Layer.extend({listener:null,downItem:null,upItem:null,callBack:null,_infoData:null,beforeGold:0,_friendData:null,_userData:null,_shareBtn:null,_isFinish:!1,ctor:function(e,t){this._super(),this._infoData=e,this.beforeGold=t,this.init()},init:function(){this._super();var e=wr.getModel();if(console.log("infoData:"+JSON.stringify(this._infoData)),this._infoData&&this._infoData instanceof Array&&(console.log("_infoData 111"),this._userData=this._infoData[0],this._friendData=this._infoData[1],GamePlatform.getCurrentPlatForm()==PlatformType.QQ)){var t=this._friendData?this._friendData.openid:0;if(t){console.log("SDKInterface began");var i=l.path.join(GamePlatform.getCDN(),"res/shareImg/share1.jpg");SDKInterface.sendMessageToFriend(t,i,"嘿哈~","太没挑战性了,分分钟就超过了你！",1,function(){console.log("SDKInterface over")})}}qu.addRes(this,"res/Themes/Items/rank_change.plist");var n=nr.share().getWinSize(),s=new l.LayerColor(l.color(0,0,0,168,180),n.width,n.height);this.addChild(s,0);var r=new l.Sprite(String.formatC("rankingup_title%s.png",GamePlatform.getLanguage()));r.setAnchorPoint(.5,.5),r.setPosition(.5*n.width,n.height-1.5*r.height),this.addChild(r);var a=r.y;this.downItem=new xl(!0),this.downItem.setItemData(this._friendData),this.downItem.setAnchorPoint(.5,.5),this.downItem.setPosition(l.p(.5*n.width,a-r.height-.5*this.downItem.height)),this.addChild(this.downItem),a=this.downItem.y,this.upItem=new xl(!0),this.upItem.setItemData(this._userData),this.upItem.setAnchorPoint(.5,.5),this.upItem.setPosition(l.p(.5*n.width,a-this.downItem.height-.5*this.upItem.height)),this.addChild(this.upItem,1),this.upItem.beganChange(this.beforeGold),this.upItem.changeHeroHeadImg(l.playerInfo.photo),this.upItem.callBack=this.runRankAction.bind(this);var o=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,h=GamePlatform.isCN()?o?"themelocked_theme3_share_qq.png":"themelocked_theme3_share_wechat.png":"themelocked_theme3_share.png";this._shareBtn=this.menuItemWithFile("btn_blue_m.png","btn_blue_m_pressed.png",sa,l.p(.5*n.width,70),h);var d=new l.Menu(this._shareBtn);if(d.setPosition(0,0),this._shareBtn.setVisible(!1),this.addChild(d,99),!e.usersData.bIsShareWeChat&&GamePlatform.getCurrentPlatForm()!=PlatformType.FaceBook){var c=new l.Sprite("gem_3.png");c.setAnchorPoint(.5,0),c.setPosition(this._shareBtn.width-25,.5*this._shareBtn.height+15),this._shareBtn.addChild(c,1,3)}this.registerWithTouchDispatcher(!0)},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e),a=new l.Sprite(t);if(r.setTag(1),a.setTag(2),s){var o=new l.Sprite(s);o.setAnchorPoint(.5,.5),o.setPosition(.5*r.width,.5*r.height),r.addChild(o),(o=new l.Sprite(s)).setAnchorPoint(.5,.5),o.setPosition(.5*a.width,.5*a.height),a.addChild(o)}var h=new l.MenuItemSprite(r,a,null,this,this.menuCallback.bind(this));return h.setTag(i),h.setPosition(n),h},menuCallback:function(e){var t=e.getTag();if(!wr.getModel().showRewardLayer)switch(t){case sa:if(lp){var i=this,n=function(e){console.log("RankChange Call"),i.callBack&&i.callBack(e),i.removeFromParent()};if(GamePlatform.getCurrentPlatForm()==PlatformType.QQ)kl.shareScreenshot(Wl.REWARD_SHARE,n);else if(GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook){var s=this.fbShareMessage();kl.FBShareMessage(s.str,!0,!0,{index:1006},s.imageBase64,"Join The Fight",n)}}else this.callBack&&this.callBack(!0),this.removeFromParent()}},fbShareMessage:function(){var e=qu.getLoadImage("res/Themes_en/FaceBook/rankingup_bg.jpg"),t=qu.getLoadImage("res/Themes_en/FaceBook/rankingup_number1.png"),i=qu.getLoadImage("res/Themes_en/FaceBook/rankingup_fbNumber.png"),n=document.createElement("canvas");n.width=e.width,n.height=e.height;var s=n.getContext("2d");e&&s.drawImage(e,0,0);var r=this.upItem.getPhotoImg();r&&(r=(r=qu.getLoadImage(r))||qu.getLoadImage("res/Themes_en/FaceBook/fbUsersHead.png"))&&s.drawImage(r,0,0,r.width,r.height,289,220,145,145),(r=qu.getLoadImage("res/Themes_en/FaceBook/rankingup_up.png"))&&s.drawImage(r,0,0,r.width,r.height,248,188,70,76),(r=this.downItem.getPhotoImg())&&(r=(r=qu.getLoadImage(r))||qu.getLoadImage("res/Themes_en/FaceBook/fbUsersHead.png"))&&s.drawImage(r,0,0,r.width,r.height,540,220,145,145),(r=qu.getLoadImage("res/Themes_en/FaceBook/rankingup_down.png"))&&s.drawImage(r,0,0,r.width,r.height,505,188,70,76),t&&(Rt.drawTextImage(s,t,this.upItem.getGoldCount()+"","0123456789","center",360,390),Rt.drawTextImage(s,t,this.downItem.getGoldCount()+"","0123456789","center",615,390)),i&&(Rt.drawTextImage(s,i,this.upItem.getRank()+"","0123456789","right",450,340),Rt.drawTextImage(s,i,this.downItem.getRank()+"","0123456789","right",700,340));var a=n.toDataURL("image/png");return{str:this.upItem.getUserName()+" passed  "+this.downItem.getUserName()+"  in Carrot Defense! ",imageBase64:a}},updateMessage:function(){if(GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook){var e=this.fbShareMessage(),t={context:!1,immediately:!0};SDKInterface.shareMessage("",e.str,e.imageBase64,{index:1004},t)}},runRankAction:function(){var e=this.upItem.getPosition(),t=this.downItem.getPosition(),i=(l.p(t.x,e.y-this.downItem.height),l.callFunc(function(){this.downItem.showItemState(!1),this.upItem.showItemState(!0),this._shareBtn.setVisible(!0),this._isFinish=!0,this.updateMessage()}.bind(this)));this.upItem.runAction(l.sequence(l.spawn(l.moveTo(.2,t),l.scaleTo(.2,2)),l.scaleTo(.2,1),i)),this.downItem.runAction(l.sequence(l.delayTime(.2),l.moveTo(.2,e).easing(l.easeElasticOut(3))))},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),qu.clearOwner(this),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){return this._isFinish&&(this.callBack&&this.callBack(!1),this.removeFromParent()),!0},showInScene:function(){l.director.getRunningScene().addChild(this,1e3)},showInTagret:function(e){void 0!=e&&e.addChild(this,1e3)}}),xl=l.Node.extend({isDown:!1,countLbl:null,befor:0,end:0,callBack:null,stateSpr:null,bg:null,node:null,head:null,carrot:null,rankLbl:null,rank:0,_data:null,_photoImg:null,_userName:null,_glodCount:null,ctor:function(e){this._super(),this.isDown=e,this.init()},init:function(){this._super();var e=this.isDown?.8:1,t=this.isDown?"rankingup_frame_3.png":"rankingup_frame_1.png",i=new l.Sprite(t),n=i.getContentSize();this.setContentSize(n),i.setAnchorPoint(.5,.5),i.setPosition(.5*n.width,.5*n.height),this.addChild(i),this.bg=i,this.node=new l.Node,this.node.setContentSize(n),this.node.setAnchorPoint(.5,.5),this.node.setPosition(.5*n.width,.5*n.height),this.addChild(this.node);var s=.5*n.height-10;this.rankLbl=new l.LabelAtlas(0,"rankingup_number1.png",53,64,"0123456789"),this.rankLbl.setAnchorPoint(.5,.5),this.rankLbl.setPosition(55,s),this.node.addChild(this.rankLbl),this.head=Rt.createPhotoSprite(),this.head.setAnchorPoint(.5,.5),this.head.setPosition(160,s),this.node.addChild(this.head),this.carrot=new l.Sprite("rankingup_goldencarrot.png"),this.carrot.setAnchorPoint(0,.5),this.carrot.setPosition(.5*n.width+25,s),this.node.addChild(this.carrot);var r=this.carrot.width+this.carrot.x+10;this.countLbl=new l.LabelAtlas(0,"rankingup_number2.png",28,38,"0123456789x+"),this.countLbl.setAnchorPoint(0,.5),this.countLbl.setPosition(r,s),this.node.addChild(this.countLbl),this.node.setScale(e)},showItemState:function(e){var t=this.getContentSize();if(e){var i=l.spriteFrameCache.getSpriteFrame("rankingup_frame_1.png");i&&this.bg.setSpriteFrame(i);var n=new l.Sprite("rankingup_frame_2.png");n.setAnchorPoint(.5,.5),n.setPosition(.5*t.width,.5*t.height),this.addChild(n,-1),this.rankLbl.x-=10,this.head.x=this.head.x-15,this.carrot.x=this.carrot.x-20,this.countLbl.x=this.countLbl.x-20,this.node.setScale(1)}var s=new l.Sprite(e?"rankingup_up.png":"rankingup_down.png");s.setAnchorPoint(0,.5),s.setPosition(t.width+(e?30:0),.5*t.height-10),this.addChild(s),s.runAction(l.sequence(l.scaleTo(.2,1.1),l.scaleTo(.2,1))),this.endChange()},beganChange:function(e){this.befor=e||0,this.end=this._data?this._data.gluobo:this.befor,this.scheduleUpdate()},endChange:function(){this.changeRank(this._data?this._data.rank:0)},update:function(e){if(this.befor>this.end)return this.unscheduleUpdate(),void(this.callBack&&this.callBack());this.befor=Math.ceil(this.befor+.2*(this.end-this.befor)),this.befor==this.end&&(this.unscheduleUpdate(),this.callBack&&this.callBack()),this.setItemCount(this.befor)},setItemData:function(e){if(void 0!=e){this._data=e;var t=wr.getModel(),i=e.openid==l.playerInfo.openid?l.playerInfo.photo:null;if(null==i){var n=t.usersData.getFriendByOpenID(e.openid);n&&(this._userName=n.name,i=n.photo,GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&qu.loadImages([i]))}else this._userName=l.playerInfo.name;this.changeHeroHeadImg(i),this.setItemCount(e.gluobo),this.rankLbl.setString(e.oldrank)}},setItemCount:function(e){e=e||0,this._glodCount=e,this.countLbl.setString("x"+e)},changeHeroHeadImg:function(e){console.log("changeHeroHeadImg:"+e),this._photoImg=e,Rt.loadUserPhoto(e,this.head)},changeRank:function(e){e=e||0,this.rank=e,this.rankLbl.setString(e),this.rankLbl.runAction(l.sequence(l.scaleTo(.2,1.2),l.scaleTo(.2,1),l.scaleTo(.2,1.1),l.scaleTo(.2,1)))},getGoldCount:function(){return this._glodCount},getPhotoImg:function(){return this._photoImg},getUserName:function(){return this._userName},getRank:function(){return this.rank}});Dl.create=function(e,t){return new Dl(e,t)};var Nl=Zs.extend({listener:null,dotSpr:null,ctor:function(){qu.addRes(this,String.formatC("res/Themes%s/tencent/shortcut_cn.plist",GamePlatform.getLanguage()));var e=GamePlatform.getCurrentPlatForm()==PlatformType.QQ?Ks.DT_NOTICE:Ks.DT_TAB;this._super(e)},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),qu.clearOwner(this),this._super()},addChildItems:function(){this.registerWithTouchDispatcher(!0);wr.getModel();GamePlatform.getCurrentPlatForm()==PlatformType.QQ?this.addQQLayer():this.addWXLayer()},addQQLayer:function(){var e=this.spMainFrame.getBoundingBox(),t=this.menuItemWithFile("btn_blue_m.png",sa,l.p(.5*e.width,.31*e.height),"btn_blue_m_pressed.png","btn_blue_m_ok.png"),i=new l.Menu(t);i.setPosition(0,0),this.spMainFrame.addChild(i,99,199);var n=new l.Sprite("quickstart_p_1.png");n.setAnchorPoint(.5,.5),n.setPosition(.5*e.width,e.height-28),this.spMainFrame.addChild(n);var s=new l.Sprite("quickstart_text1.png");s.setAnchorPoint(.5,.5),s.setPosition(.5*e.width,.58*e.height),this.spMainFrame.addChild(s);var r=s.y-s.height,a=new l.Sprite("sepline.png");a.setPosition(.5*e.width,r),a.setScaleX(.95),this.spMainFrame.addChild(a)},addWXLayer:function(){var e=this.spMainFrame.getBoundingBox(),t=new l.Sprite("quickstart_p1.png");t.setAnchorPoint(.5,.5),t.setPosition(.5*e.width,e.height-28),this.spMainFrame.addChild(t);var i=new l.Sprite("quickstart_text3.png");i.setAnchorPoint(.5,.5),i.setPosition(.5*e.width,t.y-.5*t.height-18),this.spMainFrame.addChild(i);for(var n=e.width/3+25,s=.5*e.height-60,r=3;r<6;r++){var a=String.formatC("quickstart_p_%d.png",r),o=String.formatC("quickstart_text%d.png",r+1);(t=this.sprItemWithFile(a,o)).setAnchorPoint(1,.5),t.setPosition(n,s),this.spMainFrame.addChild(t),n+=t.width}for(var n=280,r=0;r<2;r++){var h=new l.Sprite("quickstart_arrow.png");h.setAnchorPoint(0,.5),h.setPosition(n,s),this.spMainFrame.addChild(h),n+=230}},sprItemWithFile:function(e,t){var i=new l.Sprite("ingame_mission_infobg.png"),n=i.getContentSize(),s=new l.Sprite(e);return s.setAnchorPoint(.5,1),s.setPosition(.5*n.width,n.height-45),i.addChild(s),(s=new l.Sprite(t)).setAnchorPoint(.5,.5),s.setPosition(.5*n.width,47),i.addChild(s),i},registerWithTouchDispatcher:function(e){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0}}),l.eventManager.addListener(this.listener,this))},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){switch(e.getTag()){case sa:this.shortCutToDesktop();break;case ra:this.setVisible(!1),this.removeFromParent(),wr.getModel().playSoundWithType($.MTPAGESELECT)}},shortCutToDesktop:function(){this.setVisible(!1);var e=wr.getModel();e.playSoundWithType($.MTPAGESELECT);var t=e.usersData;if(lp){var i=this;if(GamePlatform.getCurrentPlatForm()==PlatformType.QQ){var n=GamePlatform.getCDN();SDKInterface.addQQGameShortcut(b.Share_Title,n+"res/icon_120.png","",function(e){l.log("成功失败:"),l.log(e),l.log("data.result:"+e.result),t.rewardShortcut!=Ad.Type_Receive&&0==e.result&&(i.sendShortCut(Ad.Type_Receive),i.dotSpr&&(i.dotSpr.visible=!1)),i.visible=!1})}}l.log("shortCutToDesktop window.isOnIOS:"+window.isOnIOS),window.isOnIOS&&t.rewardShortcut!=Ad.Type_Receive&&(l.log("this.dotSpr:"+this.dotSpr),this.sendShortCut(Ad.Type_Receive),this.dotSpr&&(this.dotSpr.visible=!1)),this.setVisible(!1),e.bLockMenu=!1,this.listener&&l.eventManager.removeListener(this.listener)},setDotSpr:function(e){this.dotSpr=e},androidMenuCall:function(){},sendShortCut:function(e){l.log("sendShortCut");var t=wr.getModel().usersData;t.rewardShortcut=Ad.Type_Receive;var i=this;Ql.shortCutRewards(e,function(e){l.log("UserDataInterFace succeed"),t.rewardShortcut=Ad.Type_Receive,t.setDiamond(e.dm),i.visible=!1,qu.loadResAsync(Hi,function(){var e=Gl.create(30);e.closeCb=function(){i.removeFromParent()},e.showInScene()})})},showInScene:function(){l.director.getRunningScene().addChild(this,10001)}}),Gl=Zs.extend({listener:null,_rewardValue:0,closeCb:null,clickCB:null,ctor:function(e,t){this._rewardValue=e,t=t||Ks.DT_NOTICE,this._super(t)},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),wr.getModel().showRewardLayer=!1,l.director.getScheduler().isWaite&&(l.director.getScheduler().isWaite=!1),qu.clearOwner(this),this.closeCb&&this.closeCb(),this._super()},init:function(e){return qu.addRes(this,String.formatC("res/Themes%s/tencent/shot_reward.plist",GamePlatform.getLanguage())),this._super(e)},addChildItems:function(){wr.getModel().showRewardLayer=!0;var e=this.spMainFrame.getBoundingBox();this.spMainFrame.removeAllChildrenWithCleanup(!0);var t=new l.Sprite("quickstart_p_2.png");t.setAnchorPoint(.5,.5),t.setPosition(.5*e.width,e.height-58),this.spMainFrame.addChild(t);var i=new l.Sprite("quickstart_text2.png");i.setAnchorPoint(.5,.5),i.setPosition(.5*e.width-10,.58*e.height),this.spMainFrame.addChild(i);var n=new l.LabelAtlas(this._rewardValue,"res/Themes/Items/num_white_24.png",24,40,"./0123456789");n.setAnchorPoint(0,.5),n.setPosition(i.x+85,.58*e.height),this.spMainFrame.addChild(n);var s=i.y-i.height,r=new l.Sprite("sepline.png");r.setPosition(.5*e.width,s),r.setScaleX(.95),this.spMainFrame.addChild(r);var a=this.menuItemWithFile("btn_blue_m.png",sa,l.p(.5*e.width,.35*e.height),"btn_blue_m_pressed.png","btn_blue_m_ok.png"),o=new l.Menu(a);o.setPosition(0,0),this.spMainFrame.addChild(o,99,199),this.registerWithTouchDispatcher(!0)},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},menuCallback:function(e){switch(e.getTag()){case sa:this.clickCB?this.clickCB():this.removeFromParent()}},registerWithTouchDispatcher:function(e){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0}}),l.eventManager.addListener(this.listener,this))},showInScene:function(){l.director.getRunningScene().addChild(this,10003)}});Gl.create=function(e){return new Gl(e)},Nl.create=function(){return new Nl};var Wl={None:0,DAYDAY_SHARE:1,THEME_SHARE:2,REWARD_SHARE:3,PASSALL_SHARE:4,SPACING_SHARE:5},kl={dotSpr:null,themeState:null,qrCode:null,coercionShowShortCut:function(e,t){if(GamePlatform.isCN()){var i=wr.getModel().usersData,n=GamePlatform.getCurrentPlatForm(),s=n===PlatformType.QQ,r=!1;r=window.isOnIOS?s&&lp:(n===PlatformType.WeiXinApp||s)&&lp,l.log("ExecutionLink isVisible:"+r+" users.rewardShortcut:"+i.rewardShortcut),i.rewardShortcut<=Ad.Type_NoNeed&&r&&(this.showShortCutLayer(this.dotSpr),this.sendShortCur(e,t),i.rewardShortcut=e)}},showShortCutLayer:function(e){var t=this;e&&(this.dotSpr=e),l.log("showShortCutLayer"),qu.loadWithCCLoader(kt,function(){qu.loadResAsync(Ui,function(){l.log("ShortCutDlg.create"),t.shortCutDlg&&t.shortCutDlg.removeFromParent(),t.shortCutDlg=Nl.create(),t.shortCutDlg.setDotSpr(t.dotSpr),l.director.getRunningScene().addChild(t.shortCutDlg,10001)})})},sendShortCur:function(e,t){var i=wr.getModel();Ql.shortCutRewards(e,function(e){i.usersData.setDiamond(e.dm),t&&t(e)})},enterStage:function(e,t,i,n){void 0==e&&(e=1),void 0==t&&(t=0);var s=wr.getModel();Ql.enterStage(e,s.curLevel,t,function(e){t||s.usersData.userEnter(),s.usersData.setStarCount(e.star),s.usersData.setWaitTime(e.laststartime),s.setRecoveryTime(e.resurgencetimes);var n=e.hadProps;if(n)for(var r=0;r<n.length;r++)s.usersData.setPropByPropid(r+1,n[r]);i&&i()},function(){n&&n()})},shareMessage:function(e,t,i,n,s,r,a){var o=this,h=wr.getModel();if(console.log("shareType:"+i+" shareid:"+n),lp)if(GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook){var d=qu.getLoadImage("res/Themes_en/scene/share_2_en.jpg"),c=qu.getLoadImage("res/Themes_en/scene/imagetxt_lb.png"),u=document.createElement("canvas");u.width=d.width,u.height=d.height;var p=u.getContext("2d");d&&p.drawImage(d,0,0),c&&Rt.drawTextImage(p,c,h.usersData.getGoldCount()+"","0123456789x+","center",795,338);var m=qu.getLoadImage(l.playerInfo.photo);(m=m||qu.getLoadImage("res/Themes_en/FaceBook/fbUsersHead.png"))&&p.drawImage(m,0,0,m.width,m.height,496,190,177,177);var _=u.toDataURL("image/png"),g={context:!0,immediately:!0};SDKInterface.shareMessage("",l.playerInfo.name+" get "+h.usersData.getGoldCount()+" Gloden Carrot Trophies in Carrot Defense!",_,{index:1005},g,function(e){dp&&e?o.sendShareCode(i,n,a):a&&a(e,0)})}else{(void 0==s||s<1||s>20)&&(s=1);d=16==s?String.formatC("res/shareImg/share%d.png",s):String.formatC("res/shareImg/share%d.jpg",s);d=l.path.join(GamePlatform.getCDN(),d),this.shareMessageTo(e,t,i,n,d,r,function(e){dp&&e?o.sendShareCode(i,n,a):a&&a(e,0)})}else l.game.isDebug?this.sendShareCode(i,n,a):a&&a()},shareScreenshot:function(e,t,i){if(lp)if(e=e||1,i=void 0==i,GamePlatform.getCurrentPlatForm()==PlatformType.QQ)if(i&&l.sys.isMobile)this.generateQrCode(function(){wr.getModel();var i=this;SDKInterface.shareScreenshot(function(n){this.qrCode&&(this.qrCode.removeFromParent(!0),this.qrCode=null),dp&&n?i.sendShareCode(e,0,t):t&&t(n)}.bind(this))}.bind(this));else{wr.getModel();var n=this;SDKInterface.shareScreenshot(function(i){dp&&i?n.sendShareCode(e,0,t):t&&t(i)}.bind(this))}else this.shareMessage(null,null,e,0,null,t)},generateQrCode:function(e){var t=Date.parse(new Date),i="&fuid="+l.playerInfo.id+"&name="+l.playerInfo.name+"&photo="+l.playerInfo.photo,n=GamePlatform.getLoginUrl()+"?_wv=2147674919&_wwv=2048&channel=10027560&time="+t+i,s=jrQrcode.getQrBase64(n,{padding:1,width:130,height:130,correctLevel:QRErrorCorrectLevel.L});l.playerInfo&&l.loader.loadImg(s,{isCrossOrigin:!1},function(t,i){this.qrCode=new l.Sprite("qrcodeBg.png"),this.qrCode.setAnchorPoint(0,1),this.qrCode.x=0,this.qrCode.y=l.winSize.height,l.director.getRunningScene().addChild(this.qrCode,10001);var n=new l.Texture2D;n.initWithElement(i),n.handleLoadedTexture();var s=new l.Sprite(n);s.setScale(l.contentScaleFactor()),s.x=this.qrCode.getContentSize().width/2-7,s.y=this.qrCode.getContentSize().height/2+4,this.qrCode.addChild(s,11);var r=l.playerInfo.photo,a=null;if(r)a=Rt.createPhotoSprite(),Rt.loadUserPhoto(r,a);else{var o=l.spriteFrameCache.getSpriteFrame("UserHead.png");a=new l.Sprite(o)}var h=s.getContentSize();if(a){a.setScale(1);var d=28/a.getContentSize().width,c=28/a.getContentSize().height;a.setScaleX(d),a.setScaleY(c),a.setPosition(h.width/2,h.height/2),s.addChild(a,10)}var u=new l.LabelTTF(l.playerInfo.name,"Arial",18);u.setAnchorPoint(.5,1),u.setColor(Rt.intToColor(12467968)),u.setPosition(l.p(h.width/2,-3)),s.addChild(u,20),e&&e()}.bind(this))},sendShareCode:function(e,t,i){Ql.shareReward(e,t,function(n){if(n.issuccess){var s=wr.getModel();5!=e&&0==t&&(s.usersData.bIsShareWeChat=n.issuccess);var r=n.themeid;if(n.openedlevel&&s.usersData.setOpenLevel(n.openedlevel),n.dm){var a=s.usersData.getDiamond();s.usersData.setDiamond(n.dm),a<n.dm&&(console.log("分享获得宝石弹窗"),qu.loadResAsync(Hi,function(){Gl.create(n.dm-a).showInScene()}))}i&&i(!0,r)}else i&&i(!1,0)},function(){i&&i(!1,0)})},getRandomText:function(){var e=parseInt(F()%4)+22;e>25&&(e=25);var t=b[String.formatC("ShareText"+e)];return t=t&&t.length?t:b.ShareText22},unLockTheme:function(){var e=wr.getModel().usersData,t=-1,i=-1;if(!e.getShareIsShow(Me.CarrotGla)&&(e.getThirdWaitHMS().r||e.bIsBuyCarrotThird)&&e.getOpenedLevel()>=31?(t=Me.CarrotGla,i=Be.OpenTheme_CarrotThird_First):!e.getShareIsShow(Me.CarrotSky)&&e.getGoldCount()>=40&&e.getOpenedLevel()>=51?(t=Me.CarrotSky,i=Be.OpenTheme_CarrotSky_First):!e.getShareIsShow(Me.CarrotDes)&&e.getTaskHonorCount()>=45&&e.getOpenedLevel()>=66?(t=Me.CarrotDes,i=Be.OpenTheme_CarrotDes_First):!e.getShareIsShow(Me.BuyPolarRegion)&&e.getOpenedLevel()>=81&&e.getGoldCount()>=60&&e.getTaskHonorCount()>=55?(t=Me.BuyPolarRegion,i=Be.OpenTheme_CarrotGla_First):!e.getShareIsShow(Me.buySeventh)&&e.getOpenedLevel()>=101&&e.getGoldCount()>=70?(t=Me.buySeventh,i=Be.OpenTheme_BuySeventh_First):!e.getShareIsShow(Me.BuyIceland)&&e.getOpenedLevel()>=116&&e.getGoldCount()>=80&&e.getTaskHonorCount()>=75?(t=Me.BuyIceland,i=Be.OpenTheme_BuyIceland_First):!e.getShareIsShow(Ce.BuyLuobo_CarrotGirl_Share)&&e.isCarrotBuy(ue.CARROT_GIRL)?(t=Ce.BuyLuobo_CarrotGirl_Share,i=Be.BuyLuobo_CarrotGirl_First):!e.getShareIsShow(Ce.BuyLuobo_CarrotFat_Share)&&e.isCarrotBuy(ue.CARROT_FAT)?(t=Ce.BuyLuobo_CarrotFat_Share,i=Be.BuyLuobo_CarrotFat_First):!e.getShareIsShow(Ce.BuyLuobo_CarrotOld_Share)&&e.isCarrotBuy(ue.CARROT_OLD)&&(t=Ce.BuyLuobo_CarrotOld_Share,i=Be.BuyLuobo_CarrotOld_First),t>=Ce.OpenTheme_CarrotThird_Share)if(e.getAwardrecordByIndex(t)||e.getfirstrecordByIndex(i))e.setShareIsshow(t,!0),this.unLockTheme();else{var n=1;t>=Ce.BuyLuobo_CarrotGirl_Share&&(n=0),e.setShareIsshow(t,!0),this.shareCarrot(n,t)}},shareCarrot:function(e,t){var i=this;GamePlatform.isCN()&&qu.loadResAsync(zi,function(){var n=tp.create(e,t);n.closeBack=function(){i.unLockTheme()},n.showInScene()})},shareAwarddmMessage:function(e,t,i,n){if(lp){wr.getModel();var s=this;(void 0==i||i<3||i>11)&&(i=3);var r=null;r=i>8?String.formatC("res/shareImg/shareCarrot%d.jpg",i):String.formatC("res/shareImg/shareTheme%d.jpg",i),r=l.path.join(GamePlatform.getCDN(),r),this.shareMessageTo(e,t,i,0,r,null,function(e){dp&&e?s.sendAwarddmCode(i,n):n&&n(e)})}else l.game.isDebug?this.sendAwarddmCode(i,n):n&&n()},sendAwarddmCode:function(e,t){if(void 0!=e){var i=wr.getModel();Ql.awarddm(e,function(n){if(n){var s=n.dm-i.usersData.getDiamond();i.usersData.setDiamond(n.dm);var r=i.usersData.getAwardrecordByIndex(e);i.usersData.setAwardrecordByIndex(e,1),console.log("分享获得宝石:"+s),!r&&s>0&&(console.log("分享获得宝石弹窗"),qu.loadResAsync(Hi,function(){Gl.create(s).showInScene()}))}t&&t(!0)})}},shareMessageByDailyawardrecordIndex:function(e,t,i,n,s,r){if(lp){wr.getModel();var a=this;(void 0==s||s<1||s>20)&&(s=1);var o=16==s?String.formatC("res/shareImg/share%d.png",s):String.formatC("res/shareImg/share%d.jpg",s);o=l.path.join(GamePlatform.getCDN(),o),this.shareMessageTo(e,t,i,n,o,null,function(e){dp&&e?a.sendAwarddailydmCode(i,r):r&&r(e)})}else r&&r()},sendAwarddailydmCode:function(e,t){var i=wr.getModel();Ql.awarddailydm(e,function(n){if(n){var s=i.usersData.getDiamond();i.usersData.setDiamond(n.dm);var r=i.usersData.getdailyawardrecordByIndex(e);i.usersData.setdailyawardrecordByIndex(e,1),console.log("分享获得宝石:"+s),!r&&s>0&&(console.log("分享获得宝石弹窗"),qu.loadResAsync(Hi,function(){Gl.create(n.dm-s).showInScene()}))}t&&t(!0)})},shareScreenshotByIndex:function(e,t){if(lp)if(GamePlatform.getCurrentPlatForm()==PlatformType.QQ){var i=this;SDKInterface.shareScreenshot(function(n){dp&&n?i.sendAwarddailydmCode(e,t):t&&t(n)})}else this.shareMessage(null,null,Wl.REWARD_SHARE,0,null,t)},FBShareMessage:function(e,t,i,n,s,r,a){var o=this,h={context:t,immediately:i,button:r};SDKInterface.shareMessage("",e,s,n,h,function(){dp?o.sendShareCode(Wl.REWARD_SHARE,0,a):a&&a(!0,0)})},shareMessageTo:function(e,t,i,n,s,r,a){void 0==s&&(s=l.path.join(GamePlatform.getCDN(),"res/shareImg/share1.jpg")),t=t||this.getRandomText(),e=e||b.Share_Title,GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&(e=t,t=null),lp&&(console.log("shareMessageTo :"+e+" "+t+" "+i+"  "+n+" "+s),SDKInterface.shareMessage(e,t,s,r,null,function(e){a&&a(e)}))},getThemeTitle:function(e){var t="";switch(e){case Me.CarrotGla:t=b.Share_Title12;break;case Me.CarrotSky:t=b.Share_Title13;break;case Me.CarrotDes:t=b.Share_Title14;break;case Me.BuyPolarRegion:t=b.Share_Title15;break;case Me.buySeventh:t=b.Share_Title16;break;case Me.BuyIceland:t=b.Share_Title17;break;default:t=b.Share_Title1}return t},getThemeStr:function(e){var t="";switch(e){case Me.CarrotGla:t=b.ShareText12;break;case Me.CarrotSky:t=b.ShareText13;break;case Me.CarrotDes:t=b.ShareText14;break;case Me.BuyPolarRegion:t=b.ShareText15;break;case Me.buySeventh:t=b.ShareText16;break;case Me.BuyIceland:t=b.ShareText17;break;default:t=b.ShareText1}return t}},Ul=1,Hl=2,Vl=3,zl=4,Yl=Zs.extend({_friendsBtn:null,_systemsBtn:null,_selectTag:0,listener:null,_itemList:null,_selectSpr:null,_emptyNode:null,_bottomSpr:null,_collectAll:null,_bottomSpr1:null,_friendLbl:null,_systemsLbl:null,_friendCountSpr:null,_systemsCountSpr:null,_isReadMail:!1,_mailType:Ul,sysMailCount:0,friendMailCount:0,_showCount:0,mailUp:null,mailDown:null,_firstLoad:!0,_menuBtn:null,callback:null,_starText:null,_gemsText:null,ctor:function(){this._starText=b.Life,this._gemsText=b.Diamond;var e=GamePlatform.getLanguage();qu.addRes(this,String.formatC("res/Themes%s/tencent/mailpanel.plist",e)),this._itemList=[],this._super(Ks.DT_MAIL)},onExit:function(){qu.clearOwner(this),this.registerWithTouchDispatcher(!1),this._super()},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){return!0},ccTouchEnded:function(e,t){var i=this.spMainFrame.convertTouchToNodeSpace(e);for(var n in this._itemList){var s=this._itemList[n];if(s.isVisible()&&l.rectContainsPoint(s.getBoundingBox(),i)){this.tableCellTouched(s);break}}},addChildItems:function(){a=this.spMainFrame.getContentSize();this._systemsBtn=this.menuItemWithFile("mail_batton_4.png","mail_batton_3.png",null,null,Ul,l.p(630,a.height-66)),this._friendsBtn=this.menuItemWithFile("mail_batton_2.png","mail_batton_1.png",null,null,Hl,l.p(340,a.height-66)),console.log("this._systemsBtn .x "+this._systemsBtn.x),console.log("this._friendsBtn .x "+this._friendsBtn.x),this._collectAll=this.menuItemWithFile("btn_blue_m.png","btn_blue_m_pressed.png",null,"mail_text_1.png",sa,l.p(.5*a.width,105));var e=this.menuItemWithFile("muser_up_normal.png","muser_up_pressed.png","muser_up_disable.png",null,Vl,l.p(a.width-10,382)),t=this.menuItemWithFile("muser_down_normal.png","muser_down_pressed.png","muser_down_disable.png",null,zl,l.p(a.width-10,212));this.mailUp=e,this.mailDown=t;var i=this.addMailCountNode(this._friendsBtn);this._friendLbl=i.label,this._friendCountSpr=i.spr,i=this.addMailCountNode(this._systemsBtn),this._systemsLbl=i.label,this._systemsCountSpr=i.spr,this._systemsBtn.selected(),this._selectTag=Ul,this._mailType=Ul,this._menuBtn=new l.Menu(this._friendsBtn,this._systemsBtn,this._collectAll,e,t),this._menuBtn.setPosition(0,0),this.spMainFrame.addChild(this._menuBtn,15,15);var n=new l.Sprite("mail_frame_4.png");n.setAnchorPoint(.5,0),n.setPosition(.5*a.width,160),this.spMainFrame.addChild(n),this._bottomSpr=n,(n=new l.Sprite("mail_frame_3.png")).setAnchorPoint(.5,0),n.setPosition(.5*a.width,60),this.spMainFrame.addChild(n,6),this._bottomSpr1=n;var s=new l.Sprite("mail_frame_5.png");s.setAnchorPoint(1,.5),s.setPosition(n.width-40,.5*n.height-15),n.addChild(s);var r=new l.LabelTTF(b.Mail_Text,"Arial",20);r.enableStroke(l.color(255,224,163),1),r.setColor(l.color(255,224,163)),r.setAnchorPoint(.5,.5),r.setPosition(.5*s.width,.5*s.height),s.addChild(r);var a=this.spMainFrame.getBoundingBox();this._selectSpr=new l.Sprite("mail_frame_2.png"),this._selectSpr.visible=!1,this._selectSpr.setAnchorPoint(.5,1),this._selectSpr.x=.5*a.width,this.spMainFrame.addChild(this._selectSpr,2),this.registerWithTouchDispatcher(!0),this.emptyMailbox(!0),this.sendOpenCode(this._mailType,this._firstLoad)},sendOpenCode:function(e,t){e=e||1;var i=this;this._datalist=[],this._menuBtn.setEnabled(!1);for(var n in this._itemList)this._itemList[n].visible=!1;Ql.openmails(e,t,function(e){i._menuBtn.setEnabled(!0),i.initData(e)})},initData:function(e){if(void 0!=e){var t=e.mails;for(var i in t){var n=t[i];n.Had||this._datalist.push(n)}this.mailUp&&this.mailUp.setEnabled(!1),this.mailDown&&this.mailDown.setEnabled(this._datalist.length>3),this._mailType==Ul&&(this.sysMailCount=e.sysMailCount),this._mailType==Hl&&(this.friendMailCount=e.friendMailCount),this.reloadTable(),this.changeMaiulCount(this.sysMailCount,this.friendMailCount),this._firstLoad=!1}},addMail:function(){var e=this._showCount;if(e>=this._datalist.length||e<0)this._showCount=e<0?0:this._datalist.length;else for(var t=this.spMainFrame.getBoundingBox(),i=t.height-110,n=0;n<3;n++){var s=e<this._datalist.length?this._datalist[e]:null,r=this._itemList[n];s&&(r?r.setAttachmentInfo(s):(r=Kl.create(s),this.spMainFrame.addChild(r),this._itemList.push(r)),r.setAnchorPoint(.5,1),r.setPosition(.5*t.width,i),i-=r.height),r&&r.setVisible(s),e++}},addMailCountNode:function(e){if(void 0!=e){var t=new l.Sprite("mail_batton_5.png");t.setAnchorPoint(.5,.5),t.setPosition(.96*e.width,.9*e.height),e.addChild(t,1,10),t.visible=!1;var i=new l.LabelTTF("","Arial",20);return i.setAnchorPoint(.5,.5),i.setPosition(.5*t.width,.5*t.height+2),t.addChild(i,1,1),{spr:t,label:i}}},changeMaiulCount:function(e,t){this._friendLbl&&(t=t||0,this._friendLbl.setString(t>99?"99+":t)),this._friendCountSpr&&(this._friendCountSpr.visible=t>0),this._systemsLbl&&(e=e||0,this._systemsLbl.setString(e>99?"99+":e)),this._systemsCountSpr&&(this._systemsCountSpr.visible=e>0),this.callback&&this.callback(e>0||t>0)},tableCellTouched:function(e){if(!this._isReadMail&&void 0!=e){var t=this,i=e;this._isReadMail=!0;var n=i.getData(),s=i.getPosition();this.setSelectItemPosy(s.y),this._menuBtn.setEnabled(!1),Ql.readmail(n.ID,function(e){t._menuBtn.setEnabled(!0),t.loadMail(e),t.createActionSpr(i),t.callback&&t.callback(e.urm)})}},loadMail:function(e){if(void 0!=e){e.dm&&wr.getModel().usersData.setDiamond(e.dm),this._datalist=[];var t=this,i=e.mails;for(var n in i){var s=i[n];s.Had||t._datalist.push(s)}t._mailType==Ul&&(t.sysMailCount=e.noreads),t._mailType==Hl&&(t.friendMailCount=e.noreads),t.changeMaiulCount(t.sysMailCount,t.friendMailCount)}},setSelectItemPosy:function(e){this._selectSpr.y=e,this._selectSpr.setOpacity(255),this._selectSpr.visible=!0},createActionSpr:function(e){if(void 0!=e||void 0!=e.getParent()){this.showLiteralsTip(e.getData());var t=e.getPosition(),i=e.getItemSprFrame();if(i){var n=new l.Sprite(i);n.setAnchorPoint(.5,.5),n.setPosition(t.x,t.y-.5*n.height),this.spMainFrame.addChild(n,5),this._selectSpr.runAction(l.sequence(l.fadeOut(.2),l.hide())),e.setVisible(!1);var s=this,r=l.callFunc(function(e,t){if(e){var i=s.createRewardSpr(t,!0);i.setAnchorPoint(.5,.5),i.setPosition(.5*e.width,.5*e.height),e.addChild(i)}}.bind(this,n,e.getData())),a=l.callFunc(function(){s._showCount+3>s._datalist.length-1&&(s._showCount=s._datalist.length%3?s._showCount:s._datalist.length-3,s._datalist.length<=3&&(s._showCount=0)),s.reloadTable()});n.runAction(l.sequence(l.scaleTo(.2,.3,.7),r,l.delayTime(.3),l.spawn(l.moveTo(.2,0,n.y),l.scaleTo(.2,0)),a,l.removeSelf()))}}},showLiteralsTip:function(e){if(void 0!=e&&e.Cot){var t="";if(3!=e.ProT)t=1==e.ProT?this._starText:this._gemsText;else{var i=wr.getModel().usersData.getPropInfoById(e.ProI);i&&(t=i.name)}var n=t+" +"+(e.Cot?e.Cot:0);ju.showLiteralsTip(n)}},createRewardSpr:function(e,t){if(void 0!=e){var i=l.size(0,0);if(e.Cot){var n=wr.getModel(),s=null,r=3,a=1.7;if(3!=e.ProT)s=l.spriteFrameCache.getSpriteFrame(1==e.ProT?"mail_icon_star.png":"mail_icon_gem.png");else{var o=n.usersData.getPropInfoById(e.ProI);o&&(s=l.spriteFrameCache.getSpriteFrame(o.img)),r=2.2,a=1}var h=null;s&&((h=new l.Sprite(s)).setAnchorPoint(1,.5),i=h.getContentSize(),t?(i.width*=r,h.setScale(r,a)):i.width-=3!=e.ProT?0:20);var d=new l.LabelTTF("+"+e.Cot,"Arial",36);d.setAnchorPoint(0,.5),d.setColor(l.color(255,106,2)),i.width+=d.width,t&&(d.setScale(2.6,1.7),i.width+=1.6*d.width),i.height<d.height&&(i.height=d.height)}var c=new l.Node;if(c.setContentSize(i),h){var u=t||3!=e.ProT?3:20;h.setPosition(.5*i.width+u,.5*i.height),c.addChild(h)}return d&&(d.setPosition(.5*i.width+3,.5*i.height),c.addChild(d)),c}},menuItemWithFile:function(e,t,i,n,s,r){var a=new l.Sprite(e),o=null,h=null;o=null==t?new l.Sprite(e):new l.Sprite(t),i&&(h=new l.Sprite(i));var d=new l.MenuItemSprite(a,o,h,this,this.menuCallback.bind(this));d.setTag(s),d.setPosition(r);var c=new l.Sprite(n);return c.setAnchorPoint(.5,.5),c.setPosition(.5*d.width,.5*d.height),d.addChild(c),d},test:function(e){this._datalist=[];for(var t=0;t<30;t++){var i={};i.ProI=parseInt(1e3*Math.random()%5)+1,i.Cot=parseInt(1e3*Math.random()%5)+1,i.ProT=parseInt(1e3*Math.random()%3)+1,this._datalist.push(i)}e&&this.reloadTable()},menuCallback:function(e){if(void 0!=e){var t=e.getTag();switch(wr.getModel().playSoundWithType($.MTPAGESELECT),t){case Hl:this._friendsBtn.selected(),this._systemsBtn.unselected();break;case Ul:this._systemsBtn.selected(),this._friendsBtn.unselected();break;case Vl:this._showCount-=3,this._showCount<=0&&(this._showCount=0,e.setEnabled(!1)),this.mailDown&&this.mailDown.setEnabled(!0),this.addMail();break;case zl:this._showCount+=3,this._showCount+3>this._datalist.length-1&&(this._showCount=this._datalist.length%3?this._showCount:this._datalist.length-3,e.setEnabled(!1)),this.mailUp&&this.mailUp.setEnabled(!0),this.addMail();break;case sa:l.game.isDebug,this.CollectAll()}if(t==Hl||t==Ul){if(t==this._selectTag)return;this._mailType=t,this._selectTag=t,this.sendOpenCode(t,!1)}}},reloadTable:function(){if(this._menuBtn.setEnabled(!0),this._datalist.length<=0)for(var e in this._itemList)this._itemList[e].visible=!1;this.addMail(),this.emptyMailbox(this._datalist.length<=0),this.mailDown&&this.mailDown.setEnabled(this._showCount+3<this._datalist.length),this.mailUp&&this.mailUp.setEnabled(this._showCount>0),this._isReadMail=!1},CollectAll:function(){if(!this._isReadMail){var e=this;this._isReadMail=!0,this._menuBtn.setEnabled(!1),Ql.readmailonekey(this._mailType,function(t){for(var i in e._itemList)e._itemList[i].visible=!1;var n=e._datalist;e._datalist=[],e.loadMail(t),e.showOneKeyReward(n),e.callback&&e.callback(t.urm)})}},showOneKeyReward:function(e){var t=[],i=!1;for(var n in e){var s=e[n];if(!s.Had){i=!1;for(var r in t){var a=t[r];if(s.ProT==a.ProT){if(3!=s.ProT){a.Cot+=s.Cot,i=!0;break}if(a.ProI==s.ProI){a.Cot+=s.Cot,i=!0;break}}}!i&&s.Cot&&t.push(s)}}t.sort(function(e,t){return e.ProT<t.ProT});var o=this.spMainFrame.getContentSize();if(t.length){var h=l.spriteFrameCache.getSpriteFrame("mail_frame_1.png"),d=null;void 0==h?(d=new l.LayerColor(l.color(255,242,217),818,100)).ignoreAnchorPointForPosition(!1):d=new l.Sprite(h),d.setAnchorPoint(.5,.5),d.setPosition(.5*o.width,.5*o.height),this.spMainFrame.addChild(d);var c=l.callFunc(function(){d.removeAllChildren()},this,d),u=l.callFunc(function(){this.reloadTable()},this,d);d.runAction(l.sequence(l.delayTime(2),l.scaleTo(.2,.3,.7),c,l.spawn(l.moveTo(.2,0,d.y),l.scaleTo(.2,0)),l.removeSelf(),u));var p=new l.LabelTTF(b.Mail_Text1,"Impact",24);p.setColor(l.color.BLACK),p.setAnchorPoint(0,.5),p.setPosition(40,.5*d.height),d.addChild(p);var m=l.p(p.x+p.width-5,p.y);for(var n in t){var _=this.createRewardSpr(t[n],!1);_.setAnchorPoint(0,.5),_.setScale(.7),_.setPosition(m.x,m.y),d.addChild(_),m.x+=.65*_.width+10}}else this.reloadTable()},emptyMailbox:function(e){if(void 0==this._emptyNode){this._emptyNode=new l.Node;var t=new l.Sprite("mail_ill.png");t.setAnchorPoint(.5,1),this._emptyNode.addChild(t);var i=t.getContentSize(),n=new l.Sprite("mail_frame_6.png");n.setAnchorPoint(.5,0),this._emptyNode.addChild(n),i.height+=n.height,this._emptyNode.setContentSize(i),t.setPosition(.5*i.width,i.height),n.setPosition(.5*i.width-10,0);var s=new l.LabelTTF(b.Mail_Text2,"Arial",20);s.enableStroke(l.color(255,224,163),1),s.setColor(l.color(255,224,163)),s.setAnchorPoint(.5,.5),s.setPosition(.5*n.width,.5*n.height),n.addChild(s),i=this.getContentSize(),this._emptyNode.setAnchorPoint(.5,.5),this._emptyNode.setPosition(.5*i.width-90,.5*i.height),this.spMainFrame.addChild(this._emptyNode,15)}this._emptyNode.visible=e,this._bottomSpr.visible=!e,this._bottomSpr1.visible=!e,this._collectAll.visible=!e},showInScene:function(){l.director.getRunningScene().addChild(this,1e3)}}),Xl=["今天收到","昨天收到","二天前收到","三天前收到","四天前收到","五天前收到","六天前收到","七天前收到","很久之前收到"],jl=["Received Today","Received Yesterday","Received Two Days Ago","Received Three Days Ago","Received Four Days Ago","Received Five Days Ago","Received Six Days Ago","Received Seven Days Ago","Long Long Ago"],Kl=l.Node.extend({callback:null,_bg:null,_data:null,_hintLbl:null,_resSpr:null,_resLbl:null,_namelbl:null,_headSpr:null,_timeLbl:null,_sprPosx:0,_days:null,ctor:function(e){this._super(),this._days=GamePlatform.isCN()?Xl:jl,this.init(e)},init:function(e){this._super();var t=new l.Sprite("mail_frame_1.png"),i=t.getContentSize();this.setContentSize(i),t.setAnchorPoint(.5,.5),t.setPosition(.5*i.width,.5*i.height),this.addChild(t),this._bg=t;var n=Rt.createPhotoSprite();n.setAnchorPoint(0,.5),n.setPosition(30,.5*i.height),this.addChild(n),this._headSpr=n;var s=n.x+n.width,r=l.color(188,133,86);this._timeLbl=new l.LabelTTF("","Arial",18),this._timeLbl.setAnchorPoint(.5,0),this._timeLbl.setPosition(s+116,.5*i.height+3),this._timeLbl.setColor(r),this.addChild(this._timeLbl),this._namelbl=new l.LabelTTF("","Arial",15),this._namelbl.setAnchorPoint(.5,1),this._namelbl.setPosition(s+116,.5*i.height-3),this._namelbl.setColor(r),this.addChild(this._namelbl),this._hintLbl=new l.LabelTTF("","Arial",20,l.size(300,200),l.TEXT_ALIGNMENT_LEFT,l.TEXT_ALIGNMENT_CENTER),this._hintLbl.setAnchorPoint(0,.5),this._hintLbl.setPosition(310,.5*i.height),this._hintLbl.setColor(l.color(188,133,86)),this.addChild(this._hintLbl),this._resSpr=new l.Sprite,this._resSpr.setAnchorPoint(0,.5),this._resSpr.setPosition(i.width-200,.5*i.height),this.addChild(this._resSpr),this._sprPosx=this._resSpr.x,this._resLbl=new l.LabelTTF("","Arial",36),this._resLbl.setAnchorPoint(0,.5),this._resLbl.setPosition(i.width-150,.5*i.height),this._resLbl.setColor(l.color(255,106,2)),this.addChild(this._resLbl),this.setAttachmentInfo(e)},setAttachmentInfo:function(e){if(void 0!=e){this._data=e,this._timeLbl.setString(this.getDayBytime(e.Crt)),this._namelbl.setString(e.Sdn),this._resSpr.setVisible(e.Cot),this._resLbl.setVisible(e.Cot);i=Rt.cutString(decodeURIComponent(e.Con),52);if(this._hintLbl.setString(i),e.Cot){var t=wr.getModel(),i=String.formatC(b.Mail_Text3,e.Cot),n=null,s=0;if(3!=e.ProT)i+=1==e.ProT?this._starText:this._gemsText,n=1==e.ProT?"mail_icon_star.png":"mail_icon_gem.png";else{var r=t.usersData.getPropInfoById(e.ProI);r&&(i+=r.name,n=r.img),s=20}var a=l.spriteFrameCache.getSpriteFrame(n);a&&this._resSpr.setSpriteFrame(a),this._resSpr.x=this._sprPosx-s,this._resLbl.x=this._resSpr.x+this._resSpr.width-s,this._resLbl.setString("+"+e.Cot)}}},getDayBytime:function(e){if(void 0!=e){var t=wr.getModel(),i=new Date(1e3*parseInt(e)),n=1e3*t.getCurSystemTime(),s=new Date(n);if(i.getFullYear()<s.getFullYear())return b.Mail_Text4;if(i.getFullYear()>s.getFullYear())return b.Mail_Text5;var r=i.getDate(),a=s.getDate();if(r<=a){var o=a-r;return o>this._days.length-1&&(o=this._days.length-1),this._days[o]}return r>a?b.Mail_Text5:void 0}},menuItemWithFile:function(e,t){var i=new l.Sprite(e),n=new l.MenuItemSprite(i,null,null,this,this.menuCallback.bind(this));return n.setPosition(.5*i.width,.5*i.height),n},getItemSprFrame:function(){return this._bg?this._bg.getSpriteFrame():null},getData:function(){return this._data},menuCallback:function(e){this.callback&&this.callback()}});Kl.create=function(e){return new Kl(e)},Yl.create=function(){return new Yl};var ql={};ql.t_userID="dXNlcklE",ql.t_honorTowerBuild="aG9ub3JUb3dlckJ1aWxk",ql.t_honorTowerUpdate="aG9ub3JUb3dlclVwZGF0ZQ==",ql.t_honorTowerSell="aG9ub3JUb3dlclNlbGw=",ql.t_honorClearObjects="aG9ub3JDbGVhck9iamVjdHM=",ql.t_honorKillMonsters="aG9ub3JLaWxsTW9uc3RlcnM=",ql.t_honorKillBoss="aG9ub3JLaWxsQm9zcw==",ql.t_honorMoney="aG9ub3JNb25leQ==",ql.t_honorDiamond="aG9ub3JEaWFtb25k",ql.t_honorThemeGold="aG9ub3JUaGVtZUdvbGQ=",ql.t_honorThemeClear="aG9ub3JUaGVtZUNsZWFy",ql.t_honorThemeTask="aG9ub3JUaGVtZVRhc2s=",ql.t_honorCarrot="aG9ub3JDYXJyb3Q=",ql.t_honorWeibo="aG9ub3JXZWlibw==",ql.t_finalLevelFailCount="ZmluYWxMZXZlbEZhaWxDb3VudA==",ql.t_runsTick="cnVuc1RpY2s=",ql.t_towerBuild="dG93ZXJCdWlsZA==",ql.t_towerUpdate="dG93ZXJVcGRhdGU=",ql.t_towerSell="dG93ZXJTZWxs",ql.t_allMoney="YWxsTW9uZXk=",ql.t_allPay="YWxscGF5",ql.t_clearObjects="Y2xlYXJPYmplY3Rz",ql.t_killMonsters="a2lsbE1vbnN0ZXJz",ql.t_killBoss="a2lsbEJvc3M=",ql.t_curMainSceneNewsTimes="Y3VyTWFpblNjZW5lTmV3c1RpbWVz",ql.t_DLDiamond="RExEaWFtb25k",ql.t_GMDiamond="R01EaWFtb25k",ql.t_XFDiamond="WEZEaWFtb25k",ql.t_dropLine="ZHJvcExpbmU=",ql.t_dropRange="ZHJvcFJhbmdl",ql.t_DLClearBB="RExDbGVhckJC",ql.t_GMClearBB="R01DbGVhckJC",ql.t_XFClearBB="WEZDbGVhckJC",ql.t_DLCarrotHP="RExDYXJyb3RIUA==",ql.t_GMCarrotHP="R01DYXJyb3RIUA==",ql.t_XFCarrotHP="WEZDYXJyb3RIUA==",ql.t_DLShootSP="RExTaG9vdFNQ",ql.t_GMShootSP="R01TaG9vdFNQ",ql.t_XFShootSP="WEZTaG9vdFNQ",ql.t_DLStopBB="RExTdG9wQkI=",ql.t_GMStopBB="R01TdG9wQkI=",ql.t_XFStopBB="WEZTdG9wQkI=",ql.t_DLSlowBB="RExTbG93QkI=",ql.t_GMSlowBB="R01TbG93QkI=",ql.t_XFSlowBB="WEZTbG93QkI=",ql.t_iCloudOpen="aUNsb3VkT3Blbg==",ql.t_soundFX="c291bmRGWA==",ql.t_bgMusic="YmdNdXNpYw==",ql.t_gameCenterOn="Z2FtZUNlbnRlck9u",ql.t_allAutoExit="YWxsQXV0b0V4aXQ=",ql.t_noFirstQuit="bm9GaXJzdFF1aXQ=",ql.t_openFirstTime="b3BlbkZpcnN0VGltZQ==",ql.t_firstTimeRoulette="Zmlyc3RUaW1lUm91bGV0dGU=",ql.t_firstThirdTheme="Zmlyc3RUaGlyZFRoZW1l",ql.t_myDiamond="ZG0=",ql.t_lastPlayedLevel="bGFzdFBsYXllZExldmVs",ql.t_openedLevel="b3BlbmVkTGV2ZWw=",ql.t_nextLevel="bmV4dExldmVs",ql.t_templeLastPlayedLevel="dGVtcGxlTGFzdFBsYXllZExldmVs",ql.t_templeOpenedLevel="dGVtcGxlT3BlbmVkTGV2ZWw=",ql.t_templeNextLevel="dGVtcGxlTmV4dExldmVs",ql.t_clearBBCount="Y2xlYXJCQkNvdW50",ql.t_carrotHPCount="Y2Fycm90SFBDb3VudA==",ql.t_shootSPCount="c2hvb3RTUENvdW50",ql.t_stopBBCount="c3RvcEJCQ291bnQ=",ql.t_slowBBCount="c2xvd0JCQ291bnQ=",ql.t_starCount="c3RhckNvdW50",ql.t_curCarrotFigure="Y3VyQ2Fycm90RmlndXJl",ql.t_noAD="bm9BRA==",ql.t_lifeForever="bGlmZUZvcmV2ZXI=",ql.t_buyCarrotGirl="YnV5Q2Fycm90R2lybA==",ql.t_buyCarrotFat="YnV5Q2Fycm90RmF0",ql.t_buyCarrotOld="YnV5Q2Fycm90T2xk",ql.t_winNewLevel="d2luTmV3TGV2ZWw=",ql.t_showFigureAnimate="c2hvd0ZpZ3VyZUFuaW1hdGU=",ql.t_UsedCdkey="VXNlZENka2V5",ql.t_hideFreeStone2="aGlkZUZyZWVTdG9uZTI=",ql.t_gameWaitTime="Z2FtZVdhaXRUaW1l",ql.t_thirdThemeWaitTime="dGhpcmR0aGVtZXdhaXR0aW1l",ql.t_rated="cmF0ZWQ=",ql.t_rouletteTime="cm91bGV0dGVUaW1l",ql.t_lifeForeverPCutTime="bGlmZUZvcmV2ZXJQQ3V0VGltZQ==",ql.t_showLogin="c2hvd0xvZ2lu",ql.t_hadLogin="aGFkTG9naW4=",ql.t_userLoseStar="dXNlckxvc2VTdGFy",ql.t_DropRange2="RHJvcFJhbmdl",ql.t_EN="X0VO",ql.t_CN="X0NO",ql.t_GameData_dat="R2FtZURhdGEuZGF0",ql.t_GUI_dll="R1VJLmRsbA==",ql.t_RouletteSpan="Um91bGV0dGVTcGFu",ql.t_RouletteMinSpan="Um91bGV0dGVNaW5TcGFu",ql.t_roulette_span="cm91bGV0dGVfc3Bhbg==",ql.t_roulette_min_span="cm91bGV0dGVfbWluX3NwYW4=",ql.t_LifeForever="TGlmZUZvcmV2ZXIy",ql.t_LifeForeverMinSpan="TGlmZUZvcmV2ZXJNaW5TcGFuMg==",ql.t_LifeForeverCurPer="bkxpZmVGb3JldmVyQ3VyUGVy",ql.t_infinite_life_span="aW5maW5pdGVfbGlmZV9zcGFu",ql.t_infinite_life_min_span="aW5maW5pdGVfbGlmZV9taW5fc3Bhbg==",ql.t_LD_H="TEQlZEg=",ql.t_LD_T="TEQlZFQ=",ql.t_RouletteOpen="Um91bGV0dGVPcGVu",ql.t_roulette_switch="cm91bGV0dGVfc3dpdGNo",ql.t_initstone="aW5pdHN0b25l",ql.t_inslevel="aW5zbGV2ZWw=",ql.t_timetag="dGltZXRhZw==",ql.t_buyCarrotThird="Y2Fycm90dGhpcmQ=",ql.t_buyCarrotSky="Y2Fycm90c2t5",ql.t_buyCarrotDes="Y2Fycm90ZGVz",ql.t_buyCarrotGla="Y2Fycm90Z2xh",ql.t_buyIceland="YnV5aWNlbGFuZA==",ql.t_buyDayDayUp="YnV5RGF5RGF5VXA=",ql.t_dayDayUpShared="ZGF5RGF5VXBTaGFyZWQ=",ql.t_isNotice="aXNOb3RpY2U=",ql.t_buyCarrotTemple="YnV5Q2Fycm90VGVtcGxl",ql.t_allPass="YWxsUGFzcw==",ql.t_discountSelect="ZGlzY291bnRTZWxlY3Q=",ql.t_discountTime="ZGlzY291bnRUaW1l",ql.t_isShareWeChat="aXNTaGFyZVdlQ2hhdA==",ql.t_roulette_permillage="cm91bGV0dGVfcGVybWlsbGFnZQ==",ql.t_showLoveBox="c2hvd0xvdmVCb3g=",ql.t_monstersForGiftBox="bW9uc3RlcnNGb3JHaWZ0Qm94",ql.t_RandomMonstersForGiftBox="UmFuZG9tTW9uc3RlcnNGb3JHaWZ0Qm94",ql.t_KillMonstersForGiftBox="S2lsbE1vbnN0ZXJzRm9yR2lmdEJveA==",ql.t_showGameAdvice="c2hvd0dhbWVBZHZpY2U=",ql.t_showEnToCn="c2hvd0VuVG9Dbg==",ql.t_showDisablePayment="c2hvd0Rpc2FibGVQYXltZW50",ql.t_showDisableWeiboEdit="c2hvd0Rpc2FibGVXZWlib0VkaXQ=",ql.t_xOffsetLevelSel="eE9mZnNldExldmVsU2Vs",ql.t_xOffsetLevelSelCircle="eE9mZnNldExldmVsU2VsQ2lyY2xl",ql.t_showTempleEntranceAnimate="c2hvd1RlbXBsZUVudHJhbmNlQW5pbWF0ZQ==",ql.t_showTempleEntranceTip="c2hvd1RlbXBsZUVudHJhbmNlVGlw",ql.t_showTempleEntranceAD="c2hvd1RlbXBsZUVudHJhbmNlQUQ=",ql.t_showIphone6Gift="c2hvd0lwaG9uZTZHaWZ0",ql.t_showDiscountMenu="c2hvd0Rpc2NvdW50TWVudQ==",ql.t_doubelLastPlayedLevel="ZG91YmVsTGFzdFBsYXllZExldmVs",ql.t_doubelOpenedLevel="ZG91YmVsT3BlbmVkTGV2ZWw=",ql.t_doubelNextLevel="ZG91YmVsTmV4dExldmVs",ql.t_secondCarrotFigure="c2Vjb25kQ2Fycm90RmlndXJl",ql.t_xOffsetLevelDouble="eE9mZnNldExldmVsRG91Ymxl",ql.t_showSuperPackageRedPoint="c2hvd1N1cGVyUGFja2FnZVJlZFBvaW50",ql.t_showAQiuEntranceAnimate="dF9zaG93QVFpdUVudHJhbmNlQW5pbWF0ZQ==",ql.t_checkOldVersionRecord="dF9jaGVja09sZFZlcnNpb25SZWNvcmQ=",ql.t_unlockedCarrotOld="dF91bmxvY2tlZENhcnJvdE9sZA==",ql.t_unlockedDayDayUp="aXNvcGVuZGF5ZGF5dXA=",ql.t_unlockedEverydayChallenge="aXNvcGVuZGFpbHl3YXI=",ql.t_showAQiuAnimation="dF9zaG93QVFpdUFuaW1hdGlvbg==",ql.t_bIs9100Type="bV9iSXM5MTAwVHlwZQ==",ql.t_rewardShortcut="UmV3YXJkU2hvcnRjdXQ=",ql.t_buySeventh="YnV5c2V2ZW50aA==",ql.t_banallpay="YmFuYWxscGF5",ql.t_banallpayreason="YmFuYWxscGF5cmVhc29u",ql.t_zeroearnings="emVyb2Vhcm5pbmdz",ql.t_zeroearningsreason="emVyb2Vhcm5pbmdzcmVhc29u",ql.t_usecarrot="dXNlY2Fycm90",ql.t_enablepay="ZW5hYmxlcGF5",ql.t_idipranks="aWRpcHJhbmtz",ql.t_urm="dXJt",ql.t_openmaxstage="b3Blbm1heHN0YWdl";var Ql={autoFlush:!0,_myDatas:{},loaded:!1,saveKey:"playerdata",noticeVer:0,saving:!1,noticeList:[],faultRetryTimes:0,noticeHandler:null,api:{save:"updateuser",load:"login",ranked:"top",heartbeat:"heartbeat",openshop:"openshop",buyprop:"buyprop",buypackages:"buypackages",buyluobos:"buyluobos",sharereward:"sharereward",rewardshortcut:"rewardshortcut",openluckyturntable:"openluckyturntable",startluckyturntable:"startluckyturntable",enterStage:"enterstage",finishStage:"finishstage",resurgence:"resurgence",entertheme:"entertheme",getstagedata:"getstagedata",buytheme:"buytheme",friendrank:"friendrank",cgetfriendsinfo:"cgetfriendsinfo",setfriendsnum:"setfriendsnum",chooseluobo:"chooseluobo",getbalance:"getbalance",syncdiamond:"syncdiamond",openmails:"openmails",readmail:"readmail",readmailonekey:"readmailonekey",sendfriendmail:"sendfriendmail",opendailywar:"opendailywar",startdailywar:"startdailywar",finishdailywar:"finishdailywar",unlockdaydayup:"unlockdaydayup",opendaydayup:"opendaydayup",startdaydayup:"startdaydayup",finishdaydayup:"finishdaydayup",getcllogininfo:"getcllogininfo",finishcllogin:"finishcllogin",growthdaydayup:"growthdaydayup",friendgrowthdaydayup:"friendgrowthdaydayup",friendrankddu:"friendrankddu",opengoldencup:"opengoldencup",gethomerecord:"gethomerecord",awarddm:"awarddm",getdailyawardrecord:"getdailyawardrecord",awarddailydm:"awarddailydm",firstrecord:"firstrecord",shareMess:"sharefinal",enterMess:"enterfinal",endMess:"endfinal",comebackreward:"comebackreward",costfinal:"costfinal",getbargain:"getbargain",dobargain:"dobargain"},apiInit:!1,changedDatas:null,enableConvert:!0,delaySaveTimer:-1,retrySaveTimer:-1,SvrTimeDiff:0,regList:{},_lastPost:0,_apiRoot:"",_syncDmTime:0,reset:function(){this.loaded=!1,this._myDatas={},this._lastPost=0,this.changedDatas=null,this.noticeList=[],this.SvrTimeDiff=0;var e=GamePlatform.getServer();if(e!=this._apiRoot){this.apiInit=!1;for(var t in this.api){var i=this.api[t];i=i.replace(this._apiRoot,""),this.api[t]=l.path.join(e,i)}this._apiRoot=e,this.faultRetryTimes=0,this.apiInit=!0}},update:function(e){if(this.loaded){var t=wr.getModel(),i=t.getCurSystemTime();do{var n=!1;for(var s in this.noticeList){var r=this.noticeList[s];if(i>r.expiredtime){this.noticeHandler&&this.noticeHandler.onRemove&&this.noticeHandler.onRemove(r.id),this.noticeList.splice(s,1),n=!0;break}}}while(n);(i=t.getCurSystemTime())-this._lastPost>60&&(this._postData(this.api.heartbeat,null,function(e){l.log("net receive heartbeat");var t=l.director.getRunningScene();"object"==typeof t&&t.constructor==Hu&&t.readMailOver(e.urm)}),this._lastPost=i)}},_postData:function(e,t,i){-1==e.indexOf("?")?e+="?uid="+encodeURIComponent(l.playerInfo.id):e+="&uid="+encodeURIComponent(l.playerInfo.id),e+="&openid="+encodeURIComponent(l.playerInfo.openid);var n="",s=l.loader.getXMLHttpRequest();s.timeout=5e3;var r={};if(r.token=l.playerInfo.token,r.ntfv=this.noticeVer,console.log("apptype:"+r.apptype+"  dataForPost.platid:"+r.platid+"   cc.playerInfo.id:"+l.playerInfo.id+" cc.playerInfo.openid:"+l.playerInfo.openid),console.log(" url:"+e+" datas:"+JSON.stringify(t)),t)for(var a in t)r[a]=t[a];var o=this;s.onreadystatechange=function(){if(4==s.readyState){var e=null;if(200==s.status){var t=s.responseText;try{var r=(e=JSON.parse(t)).msg.ntf;if(r){var a=o.noticeVer;o.noticeVer=r.ntfv,o.noticeVer!=a&&(o.noticeList=r.notice,o.noticeHandler&&o.noticeHandler.onChange&&o.noticeHandler.onChange()),delete e.msg.ntf}}catch(e){n=e.message}}else n=String.format(b.NetWork_Hint,s.status),console.log(n);if(e&&e.code>1)switch(e.code){case 2:return l.director.getScheduler().isWaite=!1,o.loaded=!1,void ju.alert(b.NetWork_Hint1,function(){l.game.refresh()});case 3:return o.loaded=!1,void ju.alert(decodeURIComponent(e.msg)||b.NetWork_Hint2,null);case 4:o.faultRetryTimes+=1;var h=decodeURIComponent(e.msg)||b.NetWork_Hint3,d=o.faultRetryTimes>=10?6:0;return void ju.Retry(h,function(){l.game.refresh()},d)}if(o.faultRetryTimes=0,i&&i(e,n),!n){var c=wr.getModel();o._lastPost=c.getCurSystemTime()}}else 0===s.readyState&&(console.log(b.NetWork_Hint4),i&&i(null,b.NetWork_Hint4))},s.onerror=function(){console.log("request canceled"),i&&i(null,b.NetWork_Hint5)},s.open("POST",e,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),s.send(String.format("data={0}",encodeURIComponent(JSON.stringify(r))))},setContextID:function(e){l.playerInfo.context=e},loadFromServer:function(e){if(this.loaded)e&&e(null);else{if(!this.apiInit){var t=GamePlatform.getServer();for(var i in this.api)this.api[i]=l.path.join(t,this.api[i]);this._apiRoot=t,this.apiInit=!0}var n=this,s=this.saveKey;l.log("do load "+s+" from server ");var r=this.api.load,a=parseInt((new Date).getTime()/1e3),o={};o.name=l.playerInfo.name,o.photo=l.playerInfo.photo,o.time=a,o.id=l.playerInfo.id,o.apptype=GamePlatform.getCurrentPlatForm(),o.platid=window.isOnIOS?0:1,o.cliver=l.game.versionInt||1,o.cliverstr=l.game.version||"1.0.0.0",o.hardware=l.playerInfo.hardware||"unknown",o.telecomoper=l.playerInfo.telecomoper||"unknown",o.network=l.playerInfo.network||"unknown",o.channel=l.playerInfo.channel||0,o.shareuid=l.playerInfo.shareuid||"",lp&&SDKInterface.logEvent&&SDKInterface.logEvent("logining"),this._postData(r,o,function(t,i){var s=i;if(t){var r=null;if(0===t.code){lp&&SDKInterface.logEvent&&SDKInterface.logEvent("loginsucc"),r=t.msg,l.playerInfo.id=r.uid;var a=parseInt((new Date).getTime()/1e3);n.SvrTimeDiff=a-r.ext.gstime;o.config;delete r.config,delete r.ext,n.dataConvertForLoad(r)}else s=t.msg,l.log("not have current player data or server error.");var h=t.msg.issuccessbargain;if(h){var d="";switch(h){case 1:d=b.Share_Text26;break;case 2:d=b.Share_Text27;break;case 3:d=b.Share_Text28;break;default:d=b.Share_Text29}ju.alert(d,function(){})}}if(!s){var c=[ql.t_openFirstTime,ql.t_showSuperPackageRedPoint];for(var u in c){var p=Fd(c[u]);void 0===r[p]&&(r[p]=!1)}l.log("login myDatas:"+JSON.stringify(r));for(var m in r)n._myDatas[m]=r[m];(t=wr.getModel()).loadData(),r.sendwindows&&t.setBantimeContent(r.sendwindows),t.setCarrotIsBuy(r.hadProps),t.canShareMessTime=0,t.canbackreward=r.canbackreward,n.changedDatas={},n.loaded=!0}e&&e(s)}),l.log("load server data send request...")}},sendFriendsToServer:function(){if(lp){var e=this,t=wr.getModel().usersData;SDKInterface.getFriendList(50,function(i){t.setFriendList(i),dp&&e.setfriendsnum(i.length)})}},loadShopFromServer:function(e){if(this.api.openshop){var t=this;Qu.show(),this._postData(this.api.openshop,null,function(i,n){Qu.hide();var s=n,r=null;if(i){if(0!==i.code)return s=i.msg,l.log("loadShopFromServer error:"+s),void ju.alert(s||b.NetWork_Hint6);r=i.msg}l.log("loadShopFromServer:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint7,function(i){i==sa&&t.loadShopFromServer(e)},zu.RetryCancel):e&&e(r)})}},buyPropById:function(e,t,i,n,s){if(void 0!=e){var r={propid:e,propnum:t=t||0,oldallnum:i=i||0};Qu.show();this._postData(this.api.buyprop,r,function(e,t){Qu.hide();var i=t,r=null;e&&(0===e.code?r=e.msg:i=e.msg),l.log("buyPropById:"+JSON.stringify(r)),i?ju.alert(i||b.NetWork_Hint8,function(){s&&s()}):n&&n(r)})}else l.log("propid is undefined")},buyPackagesById:function(e,t){if(void 0!=e){var i={packageid:e};Qu.show();var n=this;this._postData(this.api.buypackages,i,function(i,s){Qu.hide();var r=s,a=null;i&&(0===i.code?a=i.msg:r=i.msg),l.log("buyPackagesById:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(i){i==sa&&n.buyPackagesById(e,t)},zu.RetryCancel):t&&t(a)})}else l.log("packageid is undefined")},buyCarrotByCarrotID:function(e,t){if(void 0!=e){var i={luoboid:e};Qu.show();var n=this;this._postData(this.api.buyluobos,i,function(i,s){Qu.hide();var r=s,a=null;i&&(0===i.code?a=i.msg:r=i.msg),l.log("buyCarrotByCarrotID:"+JSON.stringify(a)),r?(l.log("buyCarrotByCarrotID error:"+r),ju.showConfirm(r||b.NetWork_Hint8,function(i){i==sa&&n.buyCarrotByCarrotID(e,t)},zu.RetryCancel)):t&&t(a)})}else l.log("carrotID is undefined")},dobargain:function(e,t,i){if(void 0!=e){var n={fuid:e,name:t,photo:i};Qu.show(),this._postData(this.api.dobargain,n,function(e,t){Qu.hide();var i=t,n=null;if(e&&(0===e.code?n=e.msg:i=e.msg),i)ju.alert(i||b.NetWork_Hint8,function(){});else{var s=1==n.issuccess?b.Share_Text24:b.Share_Text25;ju.alert(s,function(){})}}.bind(this))}else l.log("fuid is undefined")},getbargain:function(e){Qu.show(),this._postData(this.api.getbargain,null,function(t,i){Qu.hide();var n=i,s=null;t&&(0===t.code?s=t.msg:n=t.msg),l.log("getbargain:"+JSON.stringify(s)),n?ju.alert(n||b.NetWork_Hint8,function(){}):e&&e(s)}.bind(this))},shortCutRewards:function(e,t){Qu.show();var i=this;this._postData(this.api.rewardshortcut,{state:e},function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),l.log("shortCutRewards:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.shortCutRewards(e,t)},zu.RetryCancel):t&&t(a)})},openRotaryTable:function(e){Qu.show();this._postData(this.api.openluckyturntable,null,function(t,i){Qu.hide();var n=i,s=null;t&&(0===t.code?s=t.msg:n=t.msg),l.log("openRotaryTable:"+JSON.stringify(s)),n?l.log(n||"openRotaryTable error:"+n):e&&e(s)})},RotaryTableBeganToTurn:function(e){Qu.show();var t=this;this._postData(this.api.startluckyturntable,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),l.log("RotaryTableBeganToTurn:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa&&t.RotaryTableBeganToTurn(e)},zu.RetryCancel):e&&e(r)})},shareReward:function(e,t,i,n){Qu.show();var s=this,r={sharetype:e=e||0,shareid:t=t||0};this._postData(this.api.sharereward,r,function(e,t){Qu.hide();var r=t,a=null;e&&(0===e.code?a=e.msg:r=e.msg),l.log("shareReward:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(e){e==sa?s.shareReward(themeid,i):n&&n()},zu.RetryCancel):i&&i(a)})},enterStage:function(e,t,i,n,s){Qu.show();var r=this,a={stageid:t,stagetype:e=e||0,restart:i=i||0};this._postData(this.api.enterStage,a,function(a,o){Qu.hide();var h=o,d=null;a&&(0===a.code?d=a.msg:h=a.msg),l.log("enterStage:"+JSON.stringify(d)),h?ju.showConfirm(h||b.NetWork_Hint8,function(a){a==sa?r.enterStage(e,t,i,n,s):s&&s()},zu.RetryCancel):n&&n(d)})},finishStage:function(e,t,i){Qu.show();var n=this;this._postData(this.api.finishStage,e,function(s,r){Qu.hide();var a=r,o=null;s&&(0===s.code?o=s.msg:a=s.msg),l.log("finishStage:"+JSON.stringify(o)),a?ju.showConfirm(a||b.NetWork_Hint8,function(s){s==sa?n.finishStage(e,t,i):i&&i()},zu.RetryCancel):t&&t(o)})},resurgence:function(e,t,i,n){Qu.show();var s=this,r={isddu:e=e||0,resurgencetimes:t=t||1};this._postData(this.api.resurgence,r,function(r,a){Qu.hide();var o=a,h=null;r&&(0===r.code?h=r.msg:o=r.msg),l.log("resurgence:"+JSON.stringify(h)),o?ju.showConfirm(o||b.NetWork_Hint8,function(r){r==sa?s.resurgence(e,t,i,n):n&&n()},zu.RetryCancel):i&&i(h)})},entertheme:function(e,t){Qu.show();var i={stagetype:e?e.type:1,mainenter:!!e&&e.mainenter};this._postData(this.api.entertheme,i,function(e,i){Qu.hide();var n=i,s=null;e&&(0===e.code?s=e.msg:n=e.msg),console.log("entertheme:"+JSON.stringify(s)),t&&t(s,n)})},getstagedata:function(e,t,i){if(void 0!=e){Qu.show();var n=this,s={stageid:e=e||1,stagetype:t=t||1};this._postData(this.api.getstagedata,s,function(s,r){Qu.hide();var a=r,o=null;s&&(0===s.code?o=s.msg:a=s.msg),l.log("getstagedata:"+JSON.stringify(o)),a?ju.showConfirm(a||b.NetWork_Hint8,function(s){s==sa&&n.getstagedata(e,t,i)},zu.RetryCancel):i&&i(o)})}},buytheme:function(e,t,i){Qu.show();var n=this,s={themeid:e=e||1};l.log("url:"+this.api.buytheme+" datas:"+JSON.stringify(s)),this._postData(this.api.buytheme,s,function(s,r){Qu.hide();var a=r,o=null;s&&(0===s.code?o=s.msg:a=s.msg),l.log("buytheme:"+JSON.stringify(o)),a?ju.showConfirm(a||b.NetWork_Hint8,function(s){s==sa?n.buytheme(e,t,i):i&&i()},zu.RetryCancel):t&&t(o)})},friendrank:function(e,t){Qu.show();var i=this,n={openids:e=e||null};l.log("url:"+this.api.friendrank+" datas:"+JSON.stringify(n)),this._postData(this.api.friendrank,n,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("friendrank:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.friendrank(e,t)},zu.RetryCancel):t&&t(a)})},cgetfriendsinfo:function(e,t,i){e=e||1,t=t||[],Qu.show();var n={stagetype:e,openids:t};l.log("url:"+this.api.cgetfriendsinfo+" datas:"+JSON.stringify(n)),this._postData(this.api.cgetfriendsinfo,n,function(e,t){Qu.hide();var n=t,s=null;e&&(0===e.code?s=e.msg:n=e.msg),console.log("cgetfriendsinfo:"+JSON.stringify(s)),n||i&&i(s)})},setfriendsnum:function(e){var t={friendsnum:e=e||0};this._postData(this.api.setfriendsnum,t,function(e,t){e&&(0===e.code?e.msg:e.msg)})},chooseluobo:function(e,t){Qu.show();var i=this,n={luoboid:e=e||0};l.log("url:"+this.api.chooseluobo+" datas:"+JSON.stringify(n)),this._postData(this.api.chooseluobo,n,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("chooseluobo:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.chooseluobo(e,t)},zu.RetryCancel):t&&t(a)})},getbalance:function(e){var t=this;l.log("url:"+this.api.getbalance),this._postData(this.api.getbalance,null,function(i,n){var s=n,r=null;if(i&&(0===i.code?r=i.msg:s=i.msg),console.log("getbalance:"+JSON.stringify(r)),s)ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa&&t.getbalance(e)},zu.RetryCancel);else{e&&e(r);var a=l.director.getScheduler();a.unschedule("syncdiamond update",t),a.schedule(t.updateDiamond,t,1,l.REPEAT_FOREVER,1,!1,"syncdiamond update")}})},openmails:function(e,t,i){Qu.show();var n=this,s={types:e=e||1,firstload:t};this._postData(this.api.openmails,s,function(s,r){Qu.hide();var a=r,o=null;s&&(0===s.code?o=s.msg:a=s.msg),console.log("openmails:"+JSON.stringify(o)),a?ju.showConfirm(a||b.NetWork_Hint8,function(s){s==sa&&n.openmails(e,t,i)},zu.RetryCancel):i&&i(o)})},readmail:function(e,t){Qu.show();var i=this,n={id:e=e||1};l.log("url:"+this.api.readmail),this._postData(this.api.readmail,n,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("readmail:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.readmail(e,t)},zu.RetryCancel):t&&t(a)})},readmailonekey:function(e,t){Qu.show();var i=this,n={types:e=e||1};l.log("url:"+this.api.readmailonekey),this._postData(this.api.readmailonekey,n,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("readmailonekey:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.readmailonekey(e,t)},zu.RetryCancel):t&&t(a)})},sendfriendmail:function(e,t){var i=this;Qu.show(),l.log("url:"+this.api.sendfriendmail),this._postData(this.api.sendfriendmail,e,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("sendfriendmail:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.sendfriendmail(e,t)},zu.RetryCancel):t&&t(a)})},opendailywar:function(e){var t=this;Qu.show(),this._postData(this.api.opendailywar,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),console.log("opendailywar:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa&&t.opendailywar(e)},zu.RetryCancel):e&&e(r)})},startdailywar:function(e,t){var i=this;Qu.show(),this._postData(this.api.startdailywar,null,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("startdailywar:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa?i.startdailywar(e,t):t&&t()},zu.RetryCancel):e&&e(a)})},finishdailywar:function(e,t,i){var n=this;Qu.show(),this._postData(this.api.finishdailywar,e,function(s,r){Qu.hide();var a=r,o=null;s&&(0===s.code?o=s.msg:a=s.msg),console.log("finishdailywar:"+JSON.stringify(o)),a?ju.showConfirm(a||b.NetWork_Hint8,function(s){s==sa?n.finishdailywar(e,t,i):i&&i()},zu.RetryCancel):t&&t(o)})},unlockdaydayup:function(e){var t=this;Qu.show(),this._postData(this.api.unlockdaydayup,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),console.log("unlockdaydayup:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa&&t.unlockdaydayup(e)},zu.RetryCancel):e&&e(r)})},opendaydayup:function(e){var t=this;Qu.show(),this._postData(this.api.opendaydayup,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),console.log("opendaydayup:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa?t.unlockdaydayup(e):(l.addTimePoint("GO_MAIN_S"),qi.preloadWithLoadingTag(Ht,we.MAIN))},zu.RetryCancel):e&&e(r)})},startdaydayup:function(e){var t=this;Qu.show(),this._postData(this.api.startdaydayup,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),console.log("startdaydayup:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa&&t.startdaydayup(e)},zu.RetryCancel):e&&e(r)})},finishdaydayup:function(e,t,i){var n=this;Qu.show(),this._postData(this.api.finishdaydayup,e,function(s,r){Qu.hide();var a=r,o=null;s&&(0===s.code?o=s.msg:a=s.msg),console.log("finishdaydayup:"+JSON.stringify(o)),a?ju.showConfirm(a||b.NetWork_Hint8,function(s){s==sa?n.finishdaydayup(e,t,i):i&&i()},zu.RetryCancel):t&&t(o)})},getcllogininfo:function(e){var t=this;Qu.show(),this._postData(this.api.getcllogininfo,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),console.log("getcllogininfo:"+JSON.stringify(r)),s?ju.Retry(s||b.NetWork_Hint8,function(){t.getcllogininfo(e)}):e&&e(r)})},finishcllogin:function(e,t){var i=this;Qu.show();var n={day:e};this._postData(this.api.finishcllogin,n,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("finishcllogin:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.finishcllogin(e,t)},zu.RetryCancel):t&&t(a)})},syncdiamond:function(){var e=this;this._postData(this.api.syncdiamond,null,function(t,i){var n=null;if(t)if(0===t.code){if(n=t.msg){var s=(t=wr.getModel()).usersData.getDiamond();n.dm!=s&&(t.usersData.setDiamond(n.dm),l.director.getScheduler().unschedule("syncdiamond update",e))}}else t.msg})},gethomerecord:function(e){this._postData(this.api.gethomerecord,null,function(t,i){var n=i,s=null;t&&(0===t.code?s=t.msg:n=t.msg),console.log("gethomerecord:"+JSON.stringify(s)),n||e&&e(s)})},awarddm:function(e,t){Qu.show();var i={index:e=e||0};this._postData(this.api.awarddm,i,function(e,i){Qu.hide();var n=i,s=null;e&&(0===e.code?s=e.msg:n=e.msg),console.log("awarddm:"+JSON.stringify(s)),n?t&&t(null):t&&t(s)})},getdailyawardrecord:function(e){this._postData(this.api.getdailyawardrecord,null,function(t,i){var n=i,s=null;t&&(0===t.code?s=t.msg:n=t.msg),console.log("getdailyawardrecord:"+JSON.stringify(s)),n||e&&e(s)})},awarddailydm:function(e,t){Qu.show();var i={index:e=e||0};this._postData(this.api.awarddailydm,i,function(e,i){Qu.hide();var n=i,s=null;e&&(0===e.code?s=e.msg:n=e.msg),console.log("awarddailydm:"+JSON.stringify(s)),n?t&&t(null):t&&t(s)})},firstrecord:function(e,t){var i=this;Qu.show();var n={index:e=e||0};this._postData(this.api.firstrecord,n,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("firstrecord:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.firstrecord(e,t)},zu.RetryCancel):t&&t(a)})},growthdaydayup:function(e){var t=this;Qu.show(),this._postData(this.api.growthdaydayup,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),console.log("growthdaydayup:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa&&t.growthdaydayup(e)},zu.RetryCancel):e&&e(r)})},friendgrowthdaydayup:function(e,t){e=e||0;var i=this;Qu.show();var n={fuid:e};this._postData(this.api.friendgrowthdaydayup,n,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("friendgrowthdaydayup:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.friendgrowthdaydayup(e,t)},zu.RetryCancel):t&&t(a)})},friendrankddu:function(e,t){e=e||[];var i=this;Qu.show();var n={openids:e};this._postData(this.api.friendrankddu,n,function(n,s){Qu.hide();var r=s,a=null;n&&(0===n.code?a=n.msg:r=n.msg),console.log("friendrankddu:"+JSON.stringify(a)),r?ju.showConfirm(r||b.NetWork_Hint8,function(n){n==sa&&i.friendrankddu(e,t)},zu.RetryCancel):t&&t(a)})},opengoldencup:function(e){var t=this;Qu.show(),this._postData(this.api.opengoldencup,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),console.log("opengoldencup:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa&&t.opengoldencup(e)},zu.RetryCancel):e&&e(r)})},updateDiamond:function(e){3!=++this._syncDmTime&&5!=this._syncDmTime&&8!=this._syncDmTime&&12!=this._syncDmTime&&22!=this._syncDmTime&&37!=this._syncDmTime&&62!=this._syncDmTime||(console.log("this._syncDmTime : "+this._syncDmTime),this.syncdiamond()),this._syncDmTime>=62&&(console.log("this._syncDmTime :"+this._syncDmTime+" stop stop stop"),l.director.getScheduler().unschedule("syncdiamond update",this),this._syncDmTime=0)},shareMess:function(e,t,i,n){var s={},r=JSON.stringify(i);r=r.replace(/"/gi,"'"),s.stageid=e,s.stagetype=t,s.data=r,this._postData(this.api.shareMess,s,n)},loadMess:function(e,t,i,n){var s=this.api.enterMess,r={};r.fuid=e,r.stageid=parseInt(t),r.stagetype=parseInt(i),this._postData(s,r,n)},finishMess:function(e,t,i,n,s,r,a,o){var h=this.api.endMess,l={fuid:e,stageid:t,stagetype:i,dm:n,luobohealth:s,allclear:r,costprops:a};this._postData(h,l,o)},requestBeginMess:function(e,t,i){var n=this.api.costfinal,s={};s.stageid=e,s.stagetype=t,this._postData(n,s,i)},comebackreward:function(e){var t=this;Qu.show(),this._postData(this.api.comebackreward,null,function(i,n){Qu.hide();var s=n,r=null;i&&(0===i.code?r=i.msg:s=i.msg),console.log("comebackreward:"+JSON.stringify(r)),s?ju.showConfirm(s||b.NetWork_Hint8,function(i){i==sa&&t.comebackreward(e)},zu.RetryCancel):e&&e(r)})},_convertToKV:function(e,t){var i=this._getNewName(t),n=e[i];if(n){var s;for(var r in n)s=n[r],e[String.formatC(t,s[0])]=s[1];delete e[i]}},_convertToArray:function(e,t){var i=this.regList[t];i||(i=new RegExp(t.replace("%d","(\\d+)"),"ig"),this.regList[t]=i);var n,s=[],r=[];for(var a in e)(n=i.exec(a))&&(s.push([parseInt(n[1]),e[a]]),r.push(a));for(var a in r)delete e[r[a]];s.length&&(e[this._getNewName(t)]=s)},_getNewName:function(e){return e.replace("%d","")},dataConvertForPost:function(e){this.enableConvert&&(this._convertToArray(e,Fd(ql.t_LD_H)),this._convertToArray(e,Fd(ql.t_LD_T)),this._convertToArray(e,Fd(eh)),this._convertToArray(e,Fd(th)))},dataConvertForLoad:function(e){this.enableConvert&&(this._convertToKV(e,Fd(ql.t_LD_H)),this._convertToKV(e,Fd(ql.t_LD_T)),this._convertToKV(e,Fd(eh)),this._convertToKV(e,Fd(th)))},_readLocalDataItem:function(e){return lp&&"function"==typeof SDKInterface.getLocalStorage?SDKInterface.getLocalStorage(e):l.sys.localStorage.getItem(e)},_writeLocalDataItem:function(e,t){lp&&"function"==typeof SDKInterface.setLocalStorage?SDKInterface.setLocalStorage(e,t):l.sys.localStorage.setItem(e,t)},postToServer:function(e){if(!this.saving&&this.loaded){var t=!1;for(var i in this.changedDatas){t=!0;break}if(t){var n=this;-1!=n.delaySaveTimer&&clearTimeout(n.delaySaveTimer),clearInterval(n.retrySaveTimer)}}},getSvrDate:function(){var e=new Date,t=e.getTime()-1e3*this.SvrTimeDiff;return e.setTime(t),e},getRankedList:function(e,t,i){void 0===e&&(e=1),e=parseInt(e),isNaN(e)&&(e=1),e=Math.max(e,1),e=Math.min(e,2),void 0===t&&(t=10),t=parseInt(t),isNaN(t)&&(t=10),t=Math.max(t,1);var n={count:t=Math.min(t,50),type:e};this._postData(this.api.ranked,n,function(e,t){var n=t;if(e){var s=null;0===e.code?s=e.msg:(n=e.msg,l.log("shareReward error:"+n))}n||i&&i(s)})},INTFORKEY:function(e,t){void 0===t&&(t=0);var i=this._myDatas[e];return void 0===i||isNaN(i)?t:parseInt(i)},INTFORDKEY:function(e){return this.INTFORKEY(e,0)},setValue:function(e,t){this._myDatas[e]!==t&&(this._myDatas[e]=t,this.loaded&&(this.changedDatas[e]=t))},INTTOKEY:function(e,t){if(isNaN(e))throw new Error;this.setValue(t,parseInt(e))},BOOLFORKEY:function(e,t){if(isNaN(t))throw new Error("");var i=this._myDatas[e];return void 0!=i?i:t},BOOLFORDKEY:function(e){return this.BOOLFORKEY(e,!1)},BOOLTOKEY:function(e,t){e=!!e,this.setValue(t,e)},DOUBLEFORDKEY:function(e){var t=this._myDatas[e],i=t?parseFloat(t):0;return isNaN(i)&&(i=0),i},DOUBLETOKEY:function(e,t){if(isNaN(e))throw new Error("");e=parseFloat(e),this.setValue(t,e)},FLOATFORKEY:function(e){var t=this._myDatas[e];return t?parseFloat(t):0},FLOATTOKEY:function(e,t){this.DOUBLETOKEY(e,t)},STRINGFORDKEY:function(e){var t=this._myDatas[e];return t||""},STRINGTOKEY:function(e,t){void 0!==e?this.setValue(t,""+e):l.log(t+" is undefined")},ISVALIDKEY:function(e){return void 0!==this._myDatas[e]}},Zl=function(e,t){return Ql.INTFORKEY(e,t)},Jl=function(e){return Ql.INTFORDKEY(e)},$l=function(e,t){return Ql.INTTOKEY(e,t)},ed=function(e,t){return Ql.BOOLFORKEY(e,t)},td=function(e){return Ql.BOOLFORDKEY(e)},id=function(e,t){return Ql.BOOLTOKEY(e,t)},nd=function(e){return Ql.DOUBLEFORDKEY(e)},sd=function(e,t){return Ql.DOUBLETOKEY(e,t)},rd=function(e){return Ql.FLOATFORKEY(e)},ad=function(e,t){return Ql.FLOATTOKEY(e,t)},od=function(e){return Ql.STRINGFORDKEY(e)},hd=function(e,t){return Ql.STRINGTOKEY(e,t)},ld=null,dd=function(e,t){if(void 0===t&&(t=""),null===ld){var i=Ql._readLocalDataItem("LocalData");if(i)try{ld=JSON.parse(i)}catch(e){ld={}}else ld={}}var n=ld[e];return void 0===n?t:n},cd=function(){if(ld)try{Ql._writeLocalDataItem("LocalData",JSON.stringify(ld))}catch(e){}},ud=function(e,t){null===ld&&dd("",""),ld[e]=t},pd=function(e,t){void 0===t&&(t=0);var i=dd(e,t);return void 0===i||isNaN(i)?t:parseInt(i)},md=function(e){return pd(e,0)},_d=function(e,t){if(isNaN(e))throw new Error;ud(t,e)},gd=function(e,t){if(isNaN(t))throw new Error("");var i=dd(e,t);return void 0!=i?i:t},Td=function(e){return gd(e,!1)},fd=function(e,t){ud(t,e=!!e)},Sd=function(e){var t=dd(e,0),i=t?parseFloat(t):0;return isNaN(i)&&(i=0),i},wd=function(e,t){if(isNaN(e))throw new Error("");ud(t,e)},vd=function(e){var t=dd(e,0);return t?parseFloat(t):0},Ld=function(e,t){wd(e,t)},Md=function(e){return dd(e,"")},Cd=function(e,t){void 0!==e?ud(t,e):l.log(t+" is undefined")},yd=function(e){return Ql.ISVALIDKEY(e)},Bd={},Fd=function(e){var t=Bd[e];return void 0===t&&(t=(t=Wn(e)).toLowerCase(),Bd[e]=t),t},Ed=l.Class.extend({levelHonor:0,taskMask:0,ctor:function(){},setFirstHonor:function(e){e<1||e>3||this.getFirstHonor()<e&&(this.levelHonor=12&this.levelHonor,this.levelHonor|=e)},setClearHonor:function(){this.levelHonor|=4},setTaskHonor:function(){this.levelHonor|=8},setFinishedTask:function(e){switch(e){case 1:this.taskMask|=1;break;case 2:this.taskMask|=2;break;case 3:this.taskMask|=4}},getFirstHonor:function(){return 3&this.levelHonor},getFinishTask:function(){return this.taskMask},getAllHonor:function(){return this.levelHonor},getClearHonor:function(){return 4&this.levelHonor},getTaskHonor:function(){return 8&this.levelHonor},getFirstTask:function(){return 1&this.taskMask},getSecondTask:function(){return 2&this.taskMask},getThirdTask:function(){return 4&this.taskMask},readLevelData:function(e){var t=!1,i=String.formatC(Fd(ql.t_LD_H),e);return this.levelHonor=Jl(i),this.levelHonor>0&&(t=!0),i=String.formatC(Fd(ql.t_LD_T),e),this.taskMask=Jl(i),t},writeLevelData:function(e){var t=String.formatC(Fd(ql.t_LD_H),e);$l(this.levelHonor,t),t=String.formatC(Fd(ql.t_LD_T),e),$l(this.taskMask,t)},resetData:function(){this.levelHonor=0,this.taskMask=0}}),Pd={MAIN_VIDEO:0,LOSE_VIDEO:1,LIFE_VIDEO:2},bd={AD_HEYZAP:0,AD_DOMOB:1},Ad={Type_Mandatory:0,Type_Carriedout:1,Type_NoNeed:2,Type_Receive:3},Od=1e3,Id=l.Class.extend({language:null,runsTick:0,towerBuild:122,towerUpdate:121,towerSell:120,allMoney:1688,allPay:0,clearObjects:567,killMonsters:123,killBoss:678,curMainSceneNewsTimes:0,soundFX:!0,bgMusic:!0,gameCenterOn:!0,allAutoExit:!1,allLevelsHonor:null,myDiamond:0,lastPlayedLevel:0,openedLevel:1,nextLevel:1,clearBBCount:0,carrotHPCount:0,shootSPCount:0,stopBBCount:0,slowBBCount:0,curCarrotFigure:ue.CARROT_NORMAL,m_secondCarrotFigure:ue.CARROT_NORMAL,m_noAD:!1,bIsBuyCarrotGirl:!1,bIsBuyCarrotFat:!1,bIsBuyCarrotOld:!1,bIsShowFigureAnimateInLevelSel:!1,bWinNewLevel:!1,bUsedCdkey:!1,bOpenFirstTime:!0,finalLevelFailCount:0,gameWaitTime:0,lifeForever:!1,goCommented:0,bhadLogin:!1,DLDiamond:0,GMDiamond:0,XFDiamond:0,dropLine:0,dropRange:0,bFisrtTimeRoulette:!0,rouletteTime:0,lifeForeverPCutTime:0,DLClearBB:0,GMClearBB:0,XFClearBB:0,DLCarrotHP:0,GMCarrotHP:0,XFCarrotHP:0,DLShootSP:0,GMShootSP:0,XFShootSP:0,DLStopBB:0,GMStopBB:0,XFStopBB:0,DLSlowBB:0,GMSlowBB:0,XFSlowBB:0,YSVedioDays:0,YSDayTimes:0,YSWeekTimes:0,YSMonthTimes:0,YSTotalTimes:0,YSVedioWeek:0,YSVedioMonth:0,bhideFreeStone2:!1,iCloudOpen:!0,bfbPosted:!1,buyTheme5:!1,buyTheme6:!1,starCount:0,bIsBuyCarrotThird:!1,bIsBuyCarrotSky:!1,bIsBuyCarrotDes:!1,bIsBuyCarrotGla:!1,bIsBuyIceland:!1,bIsBuyDayDayUp:!1,bIsAllPass:!1,discountSelect:-1,discountTime:0,tirThemeWaitTime:0,bFisrtThird_Theme:!0,bIsShareWeChat:!1,bIsShowGiftBox:!1,bIsShowGameAdvice:!1,bIsShowEnToCn:!1,bIsDisablePayment:!1,templeLastPlayedLevel:0,templeOpenedLevel:0,templeNextLevel:0,m_nDoubelOpenedLevel:0,m_nDoubelLastPlayedLevel:0,m_nDoubelNextLevel:0,xOffsetLevelSel:0,xOffsetLevelSelCircle:0,xOffsetLevelSelDouble:0,bIsBuyTemple:!1,bShowedTempleEntranceAnimate:!1,bShowTempleEntranceAD:!0,bIsDisableWeiboEdit:!1,bIsDayDayUpShared:!1,bIsNotice:!1,bAdvHard:!1,m_nNewThemLevelUnlock:0,bIsUnlockedSuperPackage:!0,bShowedAQiuEntranceAnimate:!1,mIsCheckedOldVersion:!1,mIsUnlockedDayDayUp:!1,mIsUnlckedEverydayChanllenge:!1,mIsShowedAQiuTipsAnimation:!1,m_bIs9100Type:!1,honorTowerBuild:0,honorTowerUpdate:0,honorTowerSell:0,honorClearObjects:0,honorKillMonsters:0,honorKillBoss:0,honorMoney:0,honorDiamond:0,honorThemeGold:0,honorThemeClear:0,honorThemeTask:0,honorCarrot:0,honorWeibo:0,YSLoseTimes:1,YSPlayTimes:1,YSLifeTimes:1,heyzapTimes:0,domobTimes:0,heyzapOnlineTimes:6,domobOnlineTimes:4,mainPagePlayTimes:4,lifeStarPlayTimes:3,losePlayTimes:7,heyzapOnlinePriority:0,domobOnlinePriority:0,notificationVector:null,shareVector:null,nRandomMonstersForGiftBox:0,nKillMonstersForGiftBox:0,rewardShortcut:0,mIsUnlockedCarrotGirl:!1,mIsUnlockedCarrotFat:!1,mIsUnlockedCarrotOld:!1,bisUnlockSeventh:!1,friends:null,banallpay:0,banallPayReason:0,zeroearnings:0,zeroearningsReason:0,enablepay:!1,idipranks:!1,isShareQun:!1,propList:null,doubleCarrotStars:0,manormodeStars:0,resurgencediamondddu:0,urm:!1,openmaxstage:0,loginFromMain:!0,showRewardLayer:!1,shareList:null,isShowPromptingShare:!1,_goldCount:0,_honorCount:0,_firstLogin:!0,ctor:function(){this.m_nHard=[],this.m_arrSale=[],this.allLevelsHonor=[],this.notificationVector=[],this.shareVector=[],this.shareList=[],this.RANDCONST=(F()+F()+F())%123456789+123,this.myDiamond=this.RANDCONST,this.m_arrSale=[],this.starCount=5,this._datas={}},onExit:function(){this.allLevelsHonor&&(this.allLevelsHonor=null),this.m_arrSale&&(this.m_arrSale=null),this._super()},LoadUsersData:function(e){this.bIsShowEnToCn=GamePlatform.isCN(),this.bIsShowGameAdvice=GamePlatform.isCN(),this.honorTowerBuild=Zl(Fd(ql.t_honorTowerBuild),0),this.honorTowerUpdate=Zl(Fd(ql.t_honorTowerUpdate),0),this.honorTowerSell=Zl(Fd(ql.t_honorTowerSell),0),this.honorClearObjects=Zl(Fd(ql.t_honorClearObjects),0),this.honorKillMonsters=Zl(Fd(ql.t_honorKillMonsters),0),this.honorKillBoss=Zl(Fd(ql.t_honorKillBoss),0),this.honorMoney=Zl(Fd(ql.t_honorMoney),0),this.honorDiamond=Zl(Fd(ql.t_honorDiamond),0),this.honorThemeGold=Zl(Fd(ql.t_honorThemeGold),0),this.honorThemeClear=Zl(Fd(ql.t_honorThemeClear),0),this.honorThemeTask=Zl(Fd(ql.t_honorThemeTask),0),this.honorCarrot=Zl(Fd(ql.t_honorCarrot),0),this.honorWeibo=Zl(Fd(ql.t_honorWeibo),0),this.rewardShortcut=Zl(Fd(ql.t_rewardShortcut),0),this.heyzapTimes=Jl("heyzapTimes"),this.domobTimes=Jl("domobTimes"),this.finalLevelFailCount=Zl(Fd(ql.t_finalLevelFailCount),0),this.runsTick=Jl(Fd(ql.t_runsTick)),this.towerBuild=Zl(Fd(ql.t_towerBuild),122),this.towerUpdate=Zl(Fd(ql.t_towerUpdate),121),this.towerSell=Zl(Fd(ql.t_towerSell),120),this.allPay=Zl(Fd(ql.t_allPay),0),this.clearObjects=Zl(Fd(ql.t_clearObjects),567),this.killMonsters=Zl(Fd(ql.t_killMonsters),123),this.killBoss=Zl(Fd(ql.t_killBoss),678),this.curMainSceneNewsTimes=Jl(Fd(ql.t_curMainSceneNewsTimes)),this.discountSelect=Jl(Fd(ql.t_discountSelect)),this.DLDiamond=Jl(Fd(ql.t_DLDiamond)),this.GMDiamond=Jl(Fd(ql.t_GMDiamond)),this.XFDiamond=Jl(Fd(ql.t_XFDiamond)),this.dropLine=Jl(Fd(ql.t_dropLine)),this.dropRange=Jl(Fd(ql.t_dropRange)),this.DLClearBB=Jl(Fd(ql.t_DLClearBB)),this.GMClearBB=Jl(Fd(ql.t_GMClearBB)),this.XFClearBB=Jl(Fd(ql.t_XFClearBB)),this.DLCarrotHP=Jl(Fd(ql.t_DLCarrotHP)),this.GMCarrotHP=Jl(Fd(ql.t_GMCarrotHP)),this.XFCarrotHP=Jl(Fd(ql.t_XFCarrotHP)),this.DLShootSP=Jl(Fd(ql.t_DLShootSP)),this.GMShootSP=Jl(Fd(ql.t_GMShootSP)),this.XFShootSP=Jl(Fd(ql.t_XFShootSP)),this.DLStopBB=Jl(Fd(ql.t_DLStopBB)),this.GMStopBB=Jl(Fd(ql.t_GMStopBB)),this.XFStopBB=Jl(Fd(ql.t_XFStopBB)),this.DLSlowBB=Jl(Fd(ql.t_DLSlowBB)),this.GMSlowBB=Jl(Fd(ql.t_GMSlowBB)),this.XFSlowBB=Jl(Fd(ql.t_XFSlowBB)),this.language=this.m_nLanguage=GamePlatform.getLanguage(),this.soundFX=gd(Fd(ql.t_soundFX),!0),this.bgMusic=gd(Fd(ql.t_bgMusic),!0),this.bNofirstQuit=td(Fd(ql.t_noFirstQuit)),this.bOpenFirstTime=gd(Fd(ql.t_openFirstTime),!1),this.bFisrtTimeRoulette=ed(Fd(ql.t_firstTimeRoulette),!0),this.urm=ed(Fd(ql.t_urm),!1),this.openmaxstage=ed(Fd(ql.t_openmaxstage),135),this.allLevelsHonor=[];for(var t=1;t<mr;t++){var i=new Ed;i.readLevelData(t),this.allLevelsHonor.push(i)}this.openedLevel=Zl(Fd(ql.t_openedLevel),1),this.curCarrotFigure=Zl(Fd(ql.t_curCarrotFigure),ue.CARROT_NORMAL),this.lifeForever=td(Fd(ql.t_lifeForever)),this.bNofirstQuit=td(Fd(ql.t_noFirstQuit)),this.bIsBuyCarrotGirl=td(Fd(ql.t_buyCarrotGirl)),this.bIsBuyCarrotFat=td(Fd(ql.t_buyCarrotFat)),this.bIsBuyCarrotOld=td(Fd(ql.t_buyCarrotOld)),this.bIsShowFigureAnimateInLevelSel=Td(Fd(ql.t_showFigureAnimate)),this.bIsShareWeChat=td(Fd(ql.t_isShareWeChat)),this.bhideFreeStone2=td(Fd(ql.t_hideFreeStone2)),this.gameWaitTime=nd(Fd(ql.t_gameWaitTime)),this.goCommented=nd(Fd(ql.t_rated)),this.bhadLogin=td(Fd(ql.t_hadLogin)),this.bUserLoseStar=td(Fd(ql.t_userLoseStar)),this.myDiamond=Zl(Fd(ql.t_myDiamond),0),this.myDiamond+=this.RANDCONST,this.tirThemeWaitTime=nd(Fd(ql.t_thirdThemeWaitTime)),this.bFisrtThird_Theme=!this.tirThemeWaitTime,this.bIsBuyCarrotThird=td(Fd(ql.t_buyCarrotThird)),this.bIsBuyCarrotSky=td(Fd(ql.t_buyCarrotSky)),this.bIsBuyCarrotDes=td(Fd(ql.t_buyCarrotDes)),this.bIsBuyCarrotGla=td(Fd(ql.t_buyCarrotGla)),this.bIsBuyIceland=td(Fd(ql.t_buyIceland)),this.bisUnlockSeventh=td(Fd(ql.t_buySeventh)),this.banallpay=Zl(Fd(ql.t_banallpay),0),this.banallPayReason=decodeURIComponent(od(Fd(ql.t_banallpayreason))),this.zeroearnings=Zl(Fd(ql.t_zeroearnings),0),this.zeroearningsReason=decodeURIComponent(od(Fd(ql.t_zeroearningsreason))),this.enablepay=td(Fd(ql.t_enablepay)),this.idipranks=td(Fd(ql.t_idipranks));var n=Zl(Fd(ql.t_usecarrot),0);return((n=n+ue.CARROT_NORMAL-1)<ue.CARROT_NORMAL||void 0==n)&&(n=ue.CARROT_NORMAL),this.setCarrotFigure(n),this.bIsNotice=td(Fd(ql.t_isNotice)),this.bIsAllPass=td(Fd(ql.t_allPass)),this.bShowedAQiuEntranceAnimate=ed(Fd(ql.t_showAQiuEntranceAnimate),!1),this.bIsUnlockedSuperPackage=ed(Fd(ql.t_showSuperPackageRedPoint),!0),this.mIsCheckedOldVersion=ed(Fd(ql.t_checkOldVersionRecord),!1),this.mIsUnlockedCarrotOld=ed(Fd(ql.t_unlockedCarrotOld),!1),this.mIsUnlockedDayDayUp=ed(Fd(ql.t_unlockedDayDayUp),!1),this.mIsUnlckedEverydayChanllenge=ed(Fd(ql.t_unlockedEverydayChallenge),!1),this.mIsShowedAQiuTipsAnimation=ed(Fd(ql.t_showAQiuAnimation),!1),this.bShowTempleEntranceAD=gd(Fd(ql.t_showTempleEntranceAD),!0),this.bShowedTempleEntranceAnimate=gd(Fd(ql.t_showTempleEntranceAnimate),!1),this.xOffsetLevelSel=md(Fd(ql.t_xOffsetLevelSel)),this.xOffsetLevelSelCircle=md(Fd(ql.t_xOffsetLevelSelCircle)),this.xOffsetLevelSelDouble=md(Fd(ql.t_xOffsetLevelDouble)),this.bWinNewLevel=Td(Fd(ql.t_winNewLevel)),this.getGameStars(),!0},openPropsByOpenLv:function(){var e=this.getOpenedLevel();this.clearBBCount=e>24&&0==this.clearBBCount?this.RANDCONST:this.clearBBCount,this.carrotHPCount=e>20&&0==this.carrotHPCount?this.RANDCONST:this.carrotHPCount,this.shootSPCount=e>13&&0==this.shootSPCount?this.RANDCONST:this.shootSPCount,this.stopBBCount=e>9&&0==this.stopBBCount?this.RANDCONST:this.stopBBCount,this.slowBBCount=e>6&&0==this.slowBBCount?this.RANDCONST:this.slowBBCount},canShowRateIt:function(){return this.goCommented<2},isCarrotBuy:function(e){switch(e){case ue.CARROT_GIRL:return this.bIsBuyCarrotGirl;case ue.CARROT_FAT:return this.bIsBuyCarrotFat;case ue.CARROT_OLD:return this.bIsBuyCarrotOld}return!1},isCarrotBuy2:function(e){switch(e){case Me.CarrotGla:return this.bIsBuyCarrotThird;case Me.CarrotSky:return this.bIsBuyCarrotSky;case Me.CarrotDes:return this.bIsBuyCarrotDes;case Me.BuyPolarRegion:return this.bIsBuyCarrotGla;case Me.BuyIceland:return this.bIsBuyIceland;case Me.buySeventh:return this.bisUnlockSeventh;case oe.UNLOCK_TEMPLE:return this.bIsBuyTemple;case oe.UNLOCK_HIGHER:return this.bIsBuyDayDayUp}return!1},isUnlockCarrot:function(e){switch(e){case ue.CARROT_GIRL:return this.openedLevel>15;case ue.CARROT_FAT:return this.openedLevel>25;case ue.CARROT_OLD:return this.openedLevel>40}return!1},isCurLevelPlayed:function(){var e=!0;return this.nextLevel===this.openedLevel&&this.openedLevel===this.lastPlayedLevel&&(e=!1,this.nextLevel++),e},isThemeAllGold:function(e){for(var t=!0,i=!1,n=wr.getModel().mapConfig.allLevels,s=n.length,r=0;r<s;r++){var a=n[r];if(i&&a.nTheme!=e)break;if(a.nTheme==e){if(3!=this.getFirstHonor(r+1)){t=!1;break}0==i&&(i=!0)}}return t},getClearHonor:function(e){return this.allLevelsHonor[e-1].getClearHonor()},getTaskHonor:function(e,t){var i=this.allLevelsHonor[e-1],n=!1;switch(t=t||0){case 0:(n=i.getTaskHonor())||i.getFirstTask()&&i.getSecondTask()&&i.getThirdTask()&&(n=!0);break;case 1:n=i.getFirstTask();break;case 2:n=i.getSecondTask();break;case 3:n=i.getThirdTask()}return n},isShareWeChat:function(){return this.bIsShareWeChat},showCastleLevel:function(){return this.getOpenedLevel()>O.SHOWCASTLELEVEL},showCastleAnimation:function(){return!(!this.showCastleLevel()||0!=this.bShowedTempleEntranceAnimate)&&(!(this.getOpenedLevel()>O.MAINLEVELCOUNT)||(this.bShowedTempleEntranceAnimate=!0,!1))},getFinishTask:function(e){return this.allLevelsHonor[e-1].getFinishTask()},getFirstHonor:function(e){return this.allLevelsHonor[e-1].getFirstHonor()},getThemeHonor:function(e){for(var t=7,i=!1,n=wr.getModel().mapConfig.allLevels,s=n.length,r=0;r<s;r++){var a=n[r];if(i&&a.nTheme!=e)break;if(r>155&&10==e&&(e=1),a.nTheme==e){var o=this.allLevelsHonor[r].getAllHonor();if(3!=(3&o)){t=0;break}t&=o>>=1,0==i&&(i=!0)}}return i||(t=0),t},getNextLevel:function(){return this.nextLevel},getDiamond:function(){var e=0,t=this.myDiamond;return t>this.RANDCONST?e=t-this.RANDCONST:(t=this.RANDCONST,this.myDiamond=t),Math.floor(e)},setDiamond:function(e){void 0==e&&(e=0);var t=e+this.RANDCONST;this.myDiamond=t,l.eventManager.dispatchCustomEvent("diamondChange")},getClearBBCount:function(){var e=0;return this.clearBBCount>this.RANDCONST&&(e=this.clearBBCount-this.RANDCONST),e<0&&(e=0),e},getCarrotHPCount:function(){var e=0;return this.carrotHPCount>this.RANDCONST&&(e=this.carrotHPCount-this.RANDCONST),e<0&&(e=0),e},getShootSPCount:function(){var e=0;return this.shootSPCount>this.RANDCONST&&(e=this.shootSPCount-this.RANDCONST),e<0&&(e=0),e},getStopBBCount:function(){var e=0;return this.stopBBCount>this.RANDCONST&&(e=this.stopBBCount-this.RANDCONST),e<0&&(e=0),e},getSlowBBCount:function(){var e=0;return this.slowBBCount>this.RANDCONST&&(e=this.slowBBCount-this.RANDCONST),e<0&&(e=0),e},getStarCount:function(){return this.starCount-this.RANDCONST},getGoldCount:function(){for(var e=0,t=this.allLevelsHonor.length,i=0;i<t;i++)3==this.getFirstHonor(i+1)&&e++;return this._goldCount+e},getWeiboGoldCount:function(){for(var e=0,t=0;t<135;t++)3==this.getFirstHonor(t+1)&&e++;return e},getThemeGoldCount:function(e){for(var t=0,i=!1,n=wr.getModel().mapConfig.allLevels,s=n.length,r=0;r<s;r++){var a=n[r];if(i&&a.nTheme!=e)break;a.nTheme==e&&(3==this.getFirstHonor(r+1)&&t++,i=!0)}return t},getTaskHonorCount:function(){for(var e=0,t=this.allLevelsHonor.length,i=0;i<t;i++)this.allLevelsHonor[i].getTaskHonor()&&e++;return this._honorCount+e},getWeiboTaskHonorCount:function(){for(var e=0,t=0;t<135;t++){var i=this.allLevelsHonor[t];i&&i.getTaskHonor()&&e++}return e},getThemeTaskHonor:function(e){for(var t=0,i=!1,n=wr.getModel().mapConfig.allLevels,s=n.length,r=0;r<s;r++){var a=n[r];if(i&&a.nTheme!=e)break;a.nTheme==e&&(this.getTaskHonor(r+1)&&t++,i=!0)}return t},getThemeClearHonor:function(e){for(var t=0,i=!1,n=wr.getModel().mapConfig.allLevels,s=n.length,r=0;r<s;r++){var a=n[r];if(i&&a.nTheme!=e)break;a.nTheme==e&&(this.getClearHonor(r+1)&&t++,i=!0)}return t},getAllMoney:function(){return this.allMoney-1688},getKillMonsters:function(){return this.killMonsters-123},getKillBoss:function(){return this.killBoss-678},getClearObjects:function(){return this.clearObjects-567},getTowerBuild:function(){return this.towerBuild-122},getTowerUpdate:function(){return this.towerUpdate-121},getTowerSell:function(){return this.towerSell-120},getDropType:function(e){var t=0,i=this.getKillMonsters()+e;if(i>=this.dropLine||0==this.dropLine){var n=0;if(n<1&&(n=Od),this.dropLine=this.dropRange+(F()%(n/2)+n/2),this.dropRange+=n,(this.dropRange<i||this.dropLine<i)&&(this.dropRange=i,this.dropLine=this.dropRange+(F()%(n/2)+n/2),this.dropRange+=n),this.dropRange==n)return t;t=-6-F()%5;for(var s=!1,r=0;r<5;r++){switch(t){case-6:this.clearBBCount>0&&(this.addClearBB(1),this.savePropCount(1,1),s=!0);break;case-7:this.carrotHPCount>0&&(this.addCarrotHP(1),this.savePropCount(2,1),s=!0);break;case-8:this.shootSPCount>0&&(this.addShootSP(1),this.savePropCount(3,1),s=!0);break;case-9:this.stopBBCount>0&&(this.addStopBB(1),this.savePropCount(4,1),s=!0);break;case-10:this.slowBBCount>0&&(this.addSlowBB(1),this.savePropCount(5,1),s=!0)}if(s)break;--t<-10&&(t=-6)}s||(t=0)}return t},restObtainProp:function(){for(var e in this.propList)switch(this.propList[e].id){case 1:this.clearBBCount=0;break;case 2:this.carrotHPCount=0;break;case 3:this.shootSPCount=0;break;case 4:this.stopBBCount=0;break;case 5:this.slowBBCount=0}this.propList=[]},savePropCount:function(e,t){if(void 0!=e){t=t||0,void 0==this.propList&&(this.propList=[]);var i=!1;for(var n in this.propList){var s=this.propList[n];if(s.id==e){s.count+=t,i=!0;break}}i||this.propList.push({id:e,count:t})}},getObtainPropList:function(){return this.propList},getObtainPropByid:function(e){e=e||0;for(var t in this.propList){var i=this.propList[t];if(e==i.id)return i.count}return 0},clearObtainPropList:function(){this.propList=[]},getCarrotFigure:function(){return this.curCarrotFigure},noAD:function(){return this.m_noAD},isLifeForever:function(){var e=wr.getModel();return!(!e.m_bFeast||e.m_oFeast.getCurFeastType()!=pn)||this.lifeForever},showBottomBomb:function(e){var t=!1;switch(e){case 0:t=this.slowBBCount>0||this.getOpenedLevel()>6;break;case 1:t=this.stopBBCount>0||this.getOpenedLevel()>9;break;case 2:t=this.shootSPCount>0||this.getOpenedLevel()>13;break;case 3:t=this.carrotHPCount>0||this.getOpenedLevel()>20;break;case 4:t=this.clearBBCount>0||this.getOpenedLevel()>24}return t},showDiscountMenu:function(){return!1},canPlay:function(){return!!this.isLifeForever()||!(this.getStarCount()<this.getUsedStar())},SaveUsersData:function(){if($l(this.finalLevelFailCount,Fd(ql.t_finalLevelFailCount)),$l(this.towerBuild,Fd(ql.t_towerBuild)),$l(this.towerUpdate,Fd(ql.t_towerUpdate)),$l(this.towerSell,Fd(ql.t_towerSell)),$l(this.clearObjects,Fd(ql.t_clearObjects)),$l(this.killMonsters,Fd(ql.t_killMonsters)),$l(this.killBoss,Fd(ql.t_killBoss)),$l(this.curMainSceneNewsTimes,Fd(ql.t_curMainSceneNewsTimes)),hd(this.m_nLanguage,"m_nLanguage"),fd(this.soundFX,Fd(ql.t_soundFX)),fd(this.bgMusic,Fd(ql.t_bgMusic)),this.allLevelsHonor)for(var e=this.allLevelsHonor.length,t=0;t<e;t++)this.allLevelsHonor[t].writeLevelData(t+1);return $l(this.curCarrotFigure,Fd(ql.t_curCarrotFigure)),$l(this.m_secondCarrotFigure,Fd(ql.t_secondCarrotFigure)),fd(this.bOpenFirstTime,Fd(ql.t_openFirstTime)),id(this.bIsShareWeChat,Fd(ql.t_isShareWeChat)),id(this.bUserLoseStar,Fd(ql.t_userLoseStar)),id(this.bFisrtTimeRoulette,Fd(ql.t_firstTimeRoulette)),id(this.bFisrtThird_Theme,Fd(ql.t_firstThirdTheme)),id(this.bhadLogin,Fd(ql.t_hadLogin)),id(this.bhideFreeStone2,Fd(ql.t_hideFreeStone2)),id(this.bShowedAQiuEntranceAnimate,Fd(ql.t_showAQiuEntranceAnimate)),sd(this.gameWaitTime,Fd(ql.t_gameWaitTime)),sd(this.goCommented,Fd(ql.t_rated)),sd(this.rouletteTime,Fd(ql.t_rouletteTime)),sd(this.discountTime,Fd(ql.t_discountTime)),sd(this.lifeForeverPCutTime,Fd(ql.t_lifeForeverPCutTime)),sd(this.tirThemeWaitTime,Fd(ql.t_thirdThemeWaitTime)),id(this.bIsAllPass,Fd(ql.t_allPass)),id(this.bIsUnlockedSuperPackage,Fd(ql.t_showSuperPackageRedPoint)),id(this.mIsCheckedOldVersion,Fd(ql.t_checkOldVersionRecord)),id(this.mIsUnlockedCarrotOld,Fd(ql.t_unlockedCarrotOld)),id(this.mIsUnlockedDayDayUp,Fd(ql.t_unlockedDayDayUp)),id(this.mIsUnlckedEverydayChanllenge,Fd(ql.t_unlockedEverydayChallenge)),id(this.mIsShowedAQiuTipsAnimation,Fd(ql.t_showAQiuAnimation)),fd(this.bIsShowFigureAnimateInLevelSel,Fd(ql.t_showFigureAnimate)),fd(this.bShowTempleEntranceAD,Fd(ql.t_showTempleEntranceAD)),fd(this.bShowedTempleEntranceAnimate,Fd(ql.t_showTempleEntranceAnimate)),_d(this.xOffsetLevelSel,Fd(ql.t_xOffsetLevelSel)),_d(this.xOffsetLevelSelCircle,Fd(ql.t_xOffsetLevelSelCircle)),_d(this.xOffsetLevelSelDouble,Fd(ql.t_xOffsetLevelDouble)),fd(this.bWinNewLevel,Fd(ql.t_winNewLevel)),$l(this.honorTowerBuild,Fd(ql.t_honorTowerBuild)),$l(this.honorTowerUpdate,Fd(ql.t_honorTowerUpdate)),$l(this.honorTowerSell,Fd(ql.t_honorTowerSell)),$l(this.honorClearObjects,Fd(ql.t_honorClearObjects)),$l(this.honorKillMonsters,Fd(ql.t_honorKillMonsters)),$l(this.honorKillBoss,Fd(ql.t_honorKillBoss)),$l(this.honorMoney,Fd(ql.t_honorMoney)),$l(this.honorDiamond,Fd(ql.t_honorDiamond)),$l(this.honorThemeGold,Fd(ql.t_honorThemeGold)),$l(this.honorThemeClear,Fd(ql.t_honorThemeClear)),$l(this.honorThemeTask,Fd(ql.t_honorThemeTask)),$l(this.honorCarrot,Fd(ql.t_honorCarrot)),$l(this.honorWeibo,Fd(ql.t_honorWeibo)),fd(this.bisUnlockSeventh,Fd(ql.t_buySeventh)),!0},checkUsersData:function(){var e=new Id;e.LoadUsersData(!1),this.runsTick<e.runsTick&&(this.runsTick=e.runsTick),this.towerBuild<e.towerBuild&&(this.towerBuild=e.towerBuild),this.towerUpdate<e.towerUpdate&&(this.towerUpdate=e.towerUpdate),this.towerSell<e.towerSell&&(this.towerSell=e.towerSell),this.allMoney<e.allMoney&&(this.allMoney=e.allMoney),this.allPay<e.allPay&&(this.allPay=e.allPay),this.clearObjects<e.clearObjects&&(this.clearObjects=e.clearObjects),this.killMonsters<e.killMonsters&&(this.killMonsters=e.killMonsters),this.killBoss<e.killBoss&&(this.killBoss=e.killBoss);for(var t=1;t<156&&t<this.allLevelsHonor.length;t++){var i=this.allLevelsHonor[t-1],n=e.getFirstHonor(t);n>i.getFirstHonor()&&i.setFirstHonor(n),e.getClearHonor(t)&&i.setClearHonor(),e.getTaskHonor(t,1)&&i.setFinishedTask(1),e.getTaskHonor(t,2)&&i.setFinishedTask(2),e.getTaskHonor(t,3)&&i.setFinishedTask(3),e.getTaskHonor(t)&&i.setTaskHonor()}this.getOpenedLevel()<e.getOpenedLevel()&&(this.openedLevel=e.getOpenedLevel(),e.mIsCheckedOldVersion?(this.bShowedAQiuEntranceAnimate=e.bShowedAQiuEntranceAnimate,this.bIsUnlockedSuperPackage=e.bIsUnlockedSuperPackage,this.mIsUnlockedCarrotOld=e.mIsUnlockedCarrotOld,this.mIsUnlockedDayDayUp=e.mIsUnlockedDayDayUp,this.mIsUnlckedEverydayChanllenge=e.mIsUnlckedEverydayChanllenge,this.mIsShowedAQiuTipsAnimation=e.mIsShowedAQiuTipsAnimation,this.mIsCheckedOldVersion=e.mIsCheckedOldVersion):this.checkOldVersionRecord()),this.getTempleOpenedLevel()<e.getTempleOpenedLevel()&&(this.templeOpenedLevel=e.getTempleOpenedLevel()),this.openPropsByOpenLv(),this.m_noAD||(this.m_noAD=e.noAD()),this.bIsBuyCarrotGirl||(this.bIsBuyCarrotGirl=e.bIsBuyCarrotGirl),this.bIsBuyCarrotFat||(this.bIsBuyCarrotFat=e.bIsBuyCarrotFat),this.bIsBuyCarrotOld||(this.bIsBuyCarrotOld=e.bIsBuyCarrotOld),wr.getModel().m_oHigher.checkData()},resetUsersData:function(){for(var e=0;e<this.allLevelsHonor.length;e++){var t=this.allLevelsHonor[e];t&&t.resetData()}this.lastPlayedLevel=0,this.openedLevel=1,this.templeOpenedLevel=1,this.bWinNewLevel=!1},setLevelFirstHonor:function(e,t,i){i=void 0==i||i;var n=!1;return this.allLevelsHonor[e-1].setFirstHonor(t),e>155?(this.m_nDoubelLastPlayedLevel=e,this.m_nDoubelOpenedLevel==this.m_nDoubelLastPlayedLevel&&this.m_nDoubelOpenedLevel<mr-1&&(this.m_nDoubelLastPlayedLevel<=160&&this.openedLevel>15||this.m_nDoubelLastPlayedLevel>160&&this.openedLevel>27)&&(this.m_nDoubelOpenedLevel++,this.m_nDoubelNextLevel=this.m_nDoubelOpenedLevel,n=!0)):e>135?(this.templeLastPlayedLevel=e,this.templeOpenedLevel==this.templeLastPlayedLevel&&this.templeOpenedLevel<322&&(this.templeOpenedLevel++,this.templeNextLevel=this.templeOpenedLevel,n=!0)):(this.lastPlayedLevel=e,this.openedLevel==this.lastPlayedLevel&&this.openedLevel<this.openmaxstage&&(this.setOpenLevel(this.openedLevel+1),this.nextLevel=this.openedLevel,n=!0)),n},setLevelClearHonor:function(e){this.allLevelsHonor[e-1].setClearHonor()},setLevelFinishTask:function(e,t,i){if(!this.getTaskHonor(e,t)){var n=this.allLevelsHonor[e-1];n.setFinishedTask(t),n.getFirstTask()&&n.getSecondTask()&&n.getThirdTask()&&n.setTaskHonor(),this.addDiamond(i)}},setNextPlayedLevel:function(){this.nextLevel++},showFigureAnimateInLevelSel:function(e,t){this.bIsShowFigureAnimateInLevelSel=e},setWinNewLevel:function(e,t){this.bWinNewLevel=e},setOpenFirstTime:function(e,t){t=void 0==t||t,this.bOpenFirstTime=e,fd(this.bOpenFirstTime,Fd(ql.t_openFirstTime))},setRoulettePlayed:function(){this.bFisrtTimeRoulette&&(this.bFisrtTimeRoulette=!1,this.rouletteTime=this.rouletteTime-1800)},addDiamond:function(e,t){void 0==t&&(t=!0),this.myDiamond+=e,e>0?this.DLDiamond+=e:this.XFDiamond+=-e;var i=this.getDiamond(),n=this.myDiamond-this.RANDCONST;return i>0&&i!=n?(this.autoexitgame(),this.myDiamond=0,0):this.getDiamond()},addClearBB:function(e,t){void 0==t&&(t=!0),this.clearBBCount+=e,e>0?this.DLClearBB+=e:this.XFClearBB+=-e;var i=this.getClearBBCount(),n=this.clearBBCount-this.RANDCONST;return i>0&&i!=n?(this.autoexitgame(),this.clearBBCount=0,0):this.getClearBBCount()},addCarrotHP:function(e,t){void 0==t&&(t=!0),this.carrotHPCount+=e,e>0?this.DLCarrotHP+=e:this.XFCarrotHP+=-e;var i=this.getCarrotHPCount(),n=this.carrotHPCount-this.RANDCONST;return i>0&&i!=n?(this.autoexitgame(),this.carrotHPCount=0,0):this.getCarrotHPCount()},addShootSP:function(e,t){void 0==t&&(t=!0),this.shootSPCount+=e,e>0?this.DLShootSP+=e:this.XFShootSP+=-e;var i=this.getShootSPCount(),n=this.shootSPCount-this.RANDCONST;return i>0&&i!=n?(this.autoexitgame(),this.shootSPCount=0,0):this.getShootSPCount()},addStopBB:function(e,t){void 0==t&&(t=!0),this.stopBBCount+=e,e>0?this.DLStopBB+=e:this.XFStopBB+=-e;var i=this.getStopBBCount(),n=this.stopBBCount-this.RANDCONST;return i>0&&i!=n?(this.autoexitgame(),this.stopBBCount=0,0):this.getStopBBCount()},addSlowBB:function(e,t){void 0==t&&(t=!0),this.slowBBCount+=e,e>0?this.DLSlowBB+=e:this.XFSlowBB+=-e;var i=this.getSlowBBCount(),n=this.slowBBCount-this.RANDCONST;return i>0&&i!=n?(this.autoexitgame(),this.slowBBCount=0,0):this.getSlowBBCount()},setPropByPropid:function(e,t){if(void 0!=e){t=t||0;wr.getModel();switch(e){case 1:this.clearBBCount=t?t+this.RANDCONST:this.clearBBCount;break;case 2:this.carrotHPCount=t?t+this.RANDCONST:this.carrotHPCount;break;case 3:this.shootSPCount=t?t+this.RANDCONST:this.shootSPCount;break;case 4:this.stopBBCount=t?t+this.RANDCONST:this.stopBBCount;break;case 5:this.slowBBCount=t?t+this.RANDCONST:this.slowBBCount}}},getPropCountByid:function(e){var t=0;switch(e){case 1:t=this.getClearBBCount();break;case 2:t=this.getCarrotHPCount();break;case 3:t=this.getShootSPCount();break;case 4:t=this.getStopBBCount();break;case 5:t=this.getSlowBBCount()}return t},getPropInfoById:function(e){var t=null;switch(e){case 1:t={name:b.Prop_1,img:"BarBomb01.png"};break;case 2:t={name:b.Prop_2,img:"BarBlood01.png"};break;case 3:t={name:b.Prop_3,img:"BarSpeed01.png"};break;case 4:t={name:b.Prop_4,img:"BarICE01.png"};break;case 5:t={name:b.Prop_5,img:"BarSlow01.png"}}return t},setStarCount:function(e,t){void 0==t&&(t=!0),this.starCount=e+this.RANDCONST;var i=this.getStarCount(),n=this.starCount-this.RANDCONST;if(i>0&&i!=n)return this.autoexitgame(),void(this.starCount=0);i>=this.getLifeStarWithTime()&&(this.gameWaitTime=this.getCurSystemTime()-1)},setCarrotFigure:function(e,t){void 0==t&&(t=!0),this.curCarrotFigure=e,this.setCarrotisBuy(e)},setCarrotisBuy:function(e){switch(e){case ue.CARROT_GIRL:this.bIsBuyCarrotGirl=!0;break;case ue.CARROT_FAT:this.bIsBuyCarrotFat=!0;break;case ue.CARROT_OLD:this.bIsBuyCarrotOld=!0}},setSecondCarrotFigure:function(e,t){this.m_secondCarrotFigure=e,this.setCarrotisBuy(e)},setCarrotTheme:function(e,t){switch(void 0==t&&(t=!0),e){case Me.CarrotGla:this.bIsBuyCarrotThird=!0;break;case Me.CarrotSky:this.bIsBuyCarrotSky=!0;break;case Me.CarrotDes:this.bIsBuyCarrotDes=!0;break;case Me.BuyPolarRegion:this.bIsBuyCarrotGla=!0;break;case Me.BuyIceland:this.bIsBuyIceland=!0;break;case Me.buySeventh:this.bisUnlockSeventh=!0}},setNoAD:function(e){this.m_noAD=!0},setBottomBomb:function(e){var t=1,i=0;switch(e){case 0:this.slowBBCount<=0&&(this.slowBBCount=this.RANDCONST+1,t=5,i=1);break;case 1:this.stopBBCount<=0&&(this.stopBBCount=this.RANDCONST+1,t=4,i=1);break;case 2:this.shootSPCount<=0&&(this.shootSPCount=this.RANDCONST+1,t=3,i=1);break;case 3:this.carrotHPCount<=0&&(this.carrotHPCount=this.RANDCONST+1,t=2,i=1);break;case 4:this.clearBBCount<=0&&(this.clearBBCount=this.RANDCONST+1,t=1,i=1)}this.savePropCount(t,i)},SetDisCountTime:function(e,t,i){void 0==i&&(i=!0);var n=this.getCurSystemTime();this.discountSelect=t,this.discountTime=n+e},GetDisCountSale:function(){this.m_arrSale=[];var e=null;this.isUnlockCarrot(ue.CARROT_GIRL)&&(this.isCarrotBuy(ue.CARROT_GIRL)||(e=le.SALE_FIGUREGIRL_10,this.m_arrSale.push(e)),this.isUnlockCarrot(le.CARROT_FAT)&&(this.isCarrotBuy(le.CARROT_FAT)||(e=le.SALE_FIGUREFAT_15,this.m_arrSale.push(e)),this.isUnlockCarrot(le.CARROT_OLD)&&(this.isCarrotBuy(le.CARROT_OLD)||(e=le.SALE_FIGUREOLD_15,this.m_arrSale.push(e))))),e=le.SALE_STONE_480_10,this.m_arrSale.push(e),this.getOpenedLevel()>24&&(e=le.SALE_PACKAGEPLATINUM_6,this.m_arrSale.push(e)),this.getGoldCount()<40&&51==this.getOpenedLevel()&&0==this.isCarrotBuy2(oe.UNLOCK_SKY)&&(e=le.SALE_THEME_4_6,this.m_arrSale.push(e)),81==this.getOpenedLevel()&&0==this.isCarrotBuy2(oe.UNLOCK_GLACIER)&&(this.getGoldCount()<70||this.getTaskHonorCount()<65)&&(e=le.SALE_THEME_6_6,this.m_arrSale.push(e)),e=le.SALE_STONE_750_15,this.m_arrSale.push(e);var t=this.m_arrSale.length,i=F()%t;e=this.m_arrSale[i],this.OnSale(e)},OnSale:function(e){var t=0;switch(e){case le.SALE_FIGUREGIRL_10:case le.SALE_FIGUREFAT_15:case le.SALE_FIGUREOLD_15:t=3600;break;case le.SALE_STONE_750_15:t=43200;break;case le.SALE_STONE_480_10:t=3600;break;case le.SALE_STONE_300_6:t=43200;break;case le.SALE_STONE_150_4:t=172800;break;case le.SALE_STONE_100_2:t=3600;break;case le.SALE_BOMB_4_2:case le.SALE_BLOOD_4_2:case le.SALE_SPEED_10_2:case le.SALE_ICE_6_2:case le.SALE_SLOW_6_2:t=1800;break;case le.SALE_PACKAGEPLATINUM_6:case le.SALE_STAR_25_4:t=3600;break;case le.SALE_THEME_4_6:case le.SALE_THEME_5_4:case le.SALE_THEME_6_6:t=43200}t>0&&this.SetDisCountTime(t,e)},addStarCount:function(e,t){void 0==t&&(t=!0),this.starCount+=e,e>0?this.DLStar+=e:this.GMStar+=-e;var i=this.getStarCount(),n=this.starCount-this.RANDCONST;return i>0&&i!=n?(this.autoexitgame(),this.starCount=0,0):(i>=this.getLifeStarWithTime()&&(this.gameWaitTime=this.getCurSystemTime()-1),this.getStarCount())},getStarsWaiteTime:function(){return this.gameWaitTime-this.getCurSystemTime()},IsUnlockSeventh:function(){return this.bisUnlockSeventh},setSeventhIsUnlock:function(){this.bisUnlockSeventh=!0},getThirdWaiteTime:function(){if(this.bFisrtThird_Theme){var e=this.getCurSystemTime();this.tirThemeWaitTime=e+172800}return this.tirThemeWaitTime-this.getCurSystemTime()},getThirdWaitHMS:function(){var e,t=0,i=0,n=0,s=!1,r=this.getCurSystemTime();if(this.bFisrtThird_Theme)e=r+172800,this.tirThemeWaitTime=e,this.bFisrtThird_Theme=!1,n=(a=e-r)-3600*(t=parseInt(a/3600))-60*(i=parseInt((a-3600*t)/60));else if(this.tirThemeWaitTime>=0)if(this.tirThemeWaitTime<r)t=0,i=0,n=0,s=!0;else{var a=this.tirThemeWaitTime-r;n=a-3600*(t=parseInt(a/3600))-60*(i=parseInt((a-3600*t)/60))}else t=0,i=0,n=0,s=!0;return{h:t,m:i,s:n,r:s}},getGameStars:function(){var e=this.getCurSystemTime();if(this.gameWaitTime<e)return this.getStarCount()<this.getLifeStarWithTime()&&this.addStarCount(this.getLifeStarWithTime()-this.getStarCount()),this.getStarCount();if(this.lifeForever||this.getStarCount()>this.getLifeStarWithTime())return this.getStarCount();var t=this.gameWaitTime-e,i=this.getLifeStarWithTime()-Math.ceil(t/O.STARGROWTIME);return this.setStarCount(i),i<0?0:i},getRouletteTime:function(e,t){e=0,t=0;var i=0,n=this.getCurSystemTime();if(this.rouletteTime>=0)this.rouletteTime<n&&(e=29,t=59,this.rouletteTime=-(n+1800),this.bFisrtTimeRoulette=!0,i=1);else{var s=-this.rouletteTime-n;if(this.bFisrtTimeRoulette||(s-=1800),s<0){var r=0,a=14;r=(r=(new Date).getHours())<a?a-r:24-(r-a),this.rouletteTime=n+3600*r}else t=s-60*(e=parseInt(s/60)),i=this.bFisrtTimeRoulette?1:2}var o=wr.getModel();return o.m_bFeast&&o.m_oFeast.getCurFeastType()==mn&&(e=29,t=59,this.rouletteTime=-(n+1800),0==i&&(i=2)),l.log(String.format("》》》轮盘赌时间：{0} ：{1}，result：{2}",e,t,i)),{m:e,s:t,result:i}},getLifeForeverPCutTime:function(){var e=0,t=0,i=0,n=this.getCurSystemTime();if(this.lifeForeverPCutTime>=0){if((r=this.lifeForeverPCutTime-n)>0)return t=(r-3600*(e=r/3600))/60,e>23&&(e=23),(s=0)?2:1;if(-r<3600*(a=0))return 0;if(r<0)r=-r;else if(0==r)return 0;e=r,t=0,this.lifeForeverPCutTime=n+3600*r;var s=0;return s?2:1}var r=-this.lifeForeverPCutTime-n;if(r<0){var a=0;r<0?(r=-r,this.lifeForeverPCutTime=n+86400*r):(r<1&&(r=3),a<1&&(a=4),r=F()%r+a,this.lifeForeverPCutTime=n+86400*r)}else t=r-60*(e=r/60),i=1;return{m:e,s:t,result:i}},GetDisCountTime:function(){var e=0,t=0,i=0,n=0,s=this.getCurSystemTime();if(this.discountTime>s){var r=this.discountTime-s;n=r-3600*(t=Math.floor(r/3600))-60*(i=Math.floor((r-3600*t)/60)),e=1}return{h:t,m:i,s:n,result:e}},getUsedStar:function(){var e=wr.getModel();if(e.m_nGameMode==ge.CHALLENGEMODE)return 1;if(dp){return e.stageType==Le.NORMALMODE?e.getCurConsume(e.getCurTheme()):e.stageType==Le.DOUBLECARROT?this.doubleCarrotStars:this.manormodeStars}return e.curLevel<31?1:e.curLevel<66?2:e.curLevel<101?3:e.curLevel<136?4:2},getWaitMS:function(){var e=0,t=0,i=this.getCurSystemTime();if(this.gameWaitTime<i||this.lifeForever)return{m:e,s:t};var n=(this.gameWaitTime-i)%O.STARGROWTIME;return(e=parseInt(n/60))>99&&(e=99),t=n%60,{m:e,s:t}},setWaitTime:function(e){if(void 0!=e){var t=e,i=this.getCurSystemTime();0==t&&(t=i);var n=this.getLifeStarWithTime()-this.getStarCount();(t+=n*O.STARGROWTIME)-i>n*O.STARGROWTIME?this.gameWaitTime=i+n*O.STARGROWTIME-1:this.gameWaitTime=t}},wastePlayTime:function(e){if(!this.isLifeForever()){var t=this.getStarCount()-e;if(t>=this.getLifeStarWithTime())this.addStarCount(-e);else{if(t<0)return this.gameWaitTime=this.getCurSystemTime()+this.getLifeStarWithTime()*O.STARGROWTIME-1,void this.setStarCount(0);var i=this.getGameStars(),n=this.gameWaitTime;0==n&&(n=this.getCurSystemTime()),i-=e,(n+=e*O.STARGROWTIME)-this.getCurSystemTime()>(this.getLifeStarWithTime()-i)*O.STARGROWTIME?this.gameWaitTime=this.getCurSystemTime()+(this.getLifeStarWithTime()-i)*O.STARGROWTIME-1:this.gameWaitTime=n,this.setStarCount(i)}}},addPlayTimes:function(e){if(!this.lifeForever){void 0===e&&(e=1);var t=this.getStarCount()+e;if(t>=this.getLifeStarWithTime())this.addStarCount(e);else{var i=this.gameWaitTime;0==i&&(i=this.getCurSystemTime()),(i-=e*O.STARGROWTIME)-this.getCurSystemTime()>(this.getLifeStarWithTime()-t)*O.STARGROWTIME?this.gameWaitTime=this.getCurSystemTime()+(this.getLifeStarWithTime()-t)*O.STARGROWTIME-1:this.gameWaitTime=i,this.getGameStars()}}},nomoreLostTime:function(e){void 0==e&&(e=!0),this.lifeForever=!0},openThemeV:function(){this.buyTheme5=!0},openThemeVI:function(){this.buyTheme6=!0},SetShareWeChat:function(){this.bIsShareWeChat=!0},isStarFull:function(){var e=wr.getModel();return e.m_nGameMode===ge.HIGHERMODE?e.m_oHigher.getStarCount()>99:this.getStarCount()>99},IsShowGiftBox:function(){return this.bIsShowGiftBox},ShowGiftBox:function(){var e=!1;if(!this.bIsShowGiftBox)return e;var t=wr.getModel(),i=this.getKillMonsters();if(i+=.2*(t.curKillMonsters-3),0===this.nRandomMonstersForGiftBox||i>this.nRandomMonstersForGiftBox+this.nKillMonstersForGiftBox){e=!0,0===this.nRandomMonstersForGiftBox&&(e=!1);var n=F()%0;n<0&&(n+=0),this.nRandomMonstersForGiftBox=n,this.nKillMonstersForGiftBox=i,l.log("ShowGiftBox里的RandomMonsters为",n),l.log("ShowGiftBox里的KillMonsters为",i)}return e},IsShowGameAdvice:function(){return this.bIsShowGameAdvice},IsShowEnToCn:function(){return this.bIsShowEnToCn},IsDisablePayment:function(){return this.bIsDisablePayment},IsDisableWeiboEdit:function(){return this.bIsDisableWeiboEdit},GetWorldCupData:function(){if(!this.bIsShowGiftBox){this.bIsShowGiftBox=0,this.bIsShowGiftBox&&(this.nKillMonstersForGiftBox=Jl(Fd(ql.t_KillMonstersForGiftBox)),this.nRandomMonstersForGiftBox=Jl(Fd(ql.t_RandomMonstersForGiftBox)))}},GetIphone6GiftData:function(){},GetYMData:function(){},OpenAllProps:function(e){void 0==e&&(e=!0),0==this.clearBBCount&&(this.clearBBCount=this.RANDCONST),0==this.carrotHPCount&&(this.carrotHPCount=this.RANDCONST),0==this.shootSPCount&&(this.shootSPCount=this.RANDCONST),0==this.stopBBCount&&(this.stopBBCount=this.RANDCONST),0==this.slowBBCount&&(this.slowBBCount=this.RANDCONST)},GetKillMonstersForGiftBox:function(){return this.nKillMonstersForGiftBox},GetRandomMonstersForGiftBox:function(){return this.nRandomMonstersForGiftBox},getCurSystemTime:function(){var e=Ql.getSvrDate();return Math.floor(e.getTime()/1e3)},copyStoneOnce:function(){},autoexitgame:function(){var e=l.spriteFrameCache.getSpriteFrame("*?sds*][");if(e){var t=new l.Sprite(e);l.director.getRunningScene().addChild(t)}},GetRoulettePermillage:function(){var e=0;return(e<1e3||e>1e4)&&(e=2e3),e},canPlayAD:function(e){var t=(new Date).getDate();if(this.YSVedioDays!=t)return this.YSVedioDays=t,this.YSPlayTimes=1,this.YSLifeTimes=1,this.YSLoseTimes=1,this.YSDayTimes=0,this.heyzapTimes=0,this.domobTimes=0,!0;switch(e){case Pd.MAIN_VIDEO:if(this.YSPlayTimes<this.mainPagePlayTimes)return!0;break;case Pd.LIFE_VIDEO:if(this.YSLifeTimes<this.lifeStarPlayTimes)return!0;break;case Pd.LOSE_VIDEO:if(this.YSLoseTimes<this.losePlayTimes)return!0}return!1},addPlayADOneTime:function(e){switch(e){case Pd.MAIN_VIDEO:this.YSPlayTimes++;break;case Pd.LOSE_VIDEO:return void this.YSLoseTimes++;case Pd.LIFE_VIDEO:return void this.YSLifeTimes++}this.addDiamond(20)},countPlayVungeTimes:function(){var e=new Date,t=e.getDay(),i=e.getMonth();this.YSDayTimes++,this.YSWeekTimes++,this.YSMonthTimes++,this.YSTotalTimes++,this.YSVedioWeek!=t&&(this.YSVedioWeek=t,this.YSWeekTimes=0),this.YSVedioMonth!=i&&(this.YSVedioMonth=i,this.YSMonthTimes=0)},getDayVungleTimes:function(){return this.YSDayTimes},getWeekVungleTimes:function(){return this.YSWeekTimes},getMonthVungleTimes:function(){return this.YSMonthTimes},getTotalVungleTimes:function(){return this.YSTotalTimes},getLifeStarWithTime:function(){return O.STARFULLCOUNT2},getHigherLifeStarByUM:function(){return O.STARFULLCOUNT},userEnter:function(){l.sys.os===l.sys.OS_IOS||(l.sys.os,l.sys.OS_ANDROID)},getHardPer:function(e){var t=0;switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:t=-.3;break;default:t=-.4}return this.bAdvHard&&(t=this.m_nHard[e-1]),t},setOpenLevel:function(e,t){((e=e||1)>this.openmaxstage||e>O.MAINLEVELCOUNT)&&(e=e>this.openmaxstage?this.openmaxstage:O.MAINLEVELCOUNT),this.openedLevel=e<0?1:e},getOpenedLevel:function(){var e=this.openedLevel;return(e>O.MAINLEVELCOUNT||e>this.openmaxstage)&&(e=e>this.openmaxstage?this.openmaxstage:O.MAINLEVELCOUNT),this.openedLevel=e<0?1:e,this.openedLevel},getLastPlayedLevel:function(){var e=this.lastPlayedLevel;return(e>O.MAINLEVELCOUNT||e>this.openmaxstage)&&(e=e>this.openmaxstage?this.openmaxstage:O.MAINLEVELCOUNT),this.lastPlayedLevel=e<0?1:e,this.lastPlayedLevel},setLastPlayedLevel:function(e,t){((e=e||1)>O.MAINLEVELCOUNT||e>this.openmaxstage)&&(e=e>this.openmaxstage?this.openmaxstage:O.MAINLEVELCOUNT),this.lastPlayedLevel=e<0?1:e},getDoubelNextLevel:function(){return this.m_nDoubelNextLevel},setDoubelOpenLevel:function(e,t){(e=e?e<156?156:e:156)>170&&(e=170),this.m_nDoubelOpenedLevel=e},getDoubelOpenedLevel:function(){var e=this.m_nDoubelOpenedLevel;return(e=e?e>170?170:e:156)<156&&(e=156),this.m_nDoubelOpenedLevel=e,e},setDoubelLastPlayedLevel:function(e,t){(e=e?e<156?156:e:156)>170&&(e=170),this.m_nDoubelLastPlayedLevel=e},getDoubelLastPlayedLevel:function(){var e=this.m_nDoubelLastPlayedLevel;return(e=e?e>170?170:e:156)<156&&(e=156),this.m_nDoubelLastPlayedLevel=e,e},getTempleNextLevel:function(){return this.templeNextLevel},setTempleNextPlayedLevel:function(){this.templeNextLevel++},setTempleOpenLevel:function(e,t){(e=e?e<136?136:e:136)>155&&(e=155),this.templeOpenedLevel=e},getTempleOpenedLevel:function(){var e=this.templeOpenedLevel;return wr.getModel().usersData.isCarrotBuy(ue.CARROT_GIRL)?(e=e?e>155?155:e:136)<136&&(e=136):e=1,this.templeOpenedLevel=e,e},setTempleLastPlayedLevel:function(e,t){(e=e?e>155?155:e:136)<136&&(e=136),this.templeLastPlayedLevel=e},getTempleLastPlayedLevel:function(){var e=this.templeLastPlayedLevel;return(e=e?e>155?155:e:136)<136&&(e=136),this.templeLastPlayedLevel=e,e},getSecondCarrotFigure:function(){return this.m_secondCarrotFigure},setDoubelNextPlayedLevel:function(){this.m_nDoubelNextLevel++},showNewThemeUnlock:function(e,t){this.m_nNewThemLevelUnlock=e},getNewThemeUnlockLevel:function(){return this.m_nNewThemLevelUnlock},initAdVideoOnlineTimes:function(){var e=Tt.getOnlineConfig("adVideoTimes"),t=JSON.parse(e);if(null!=t){var i=t.heyzap,n=t.domob,s=t.mainpage,r=t.life,a=t.lose,o=i.times,h=i.priority,l=n.times,d=n.priority;this.heyzapOnlineTimes=parseInt(o),this.heyzapOnlinePriority=parseInt(h),this.domobOnlineTimes=parseInt(l),this.domobOnlinePriority=parseInt(d),this.mainPagePlayTimes=parseInt(s),this.lifeStarPlayTimes=parseInt(r),this.losePlayTimes=parseInt(a)}},addAdVideoOnetTIme:function(e){switch(e){case bd.AD_HEYZAP:++this.heyzapTimes;break;case bd.AD_DOMOB:++this.domobTimes}},getAdVideoPlayPriority:function(){return this.heyzapOnlinePriority>this.domobOnlinePriority?bd.AD_HEYZAP:bd.AD_DOMOB},isNotificationOnlineConfigOpen:function(e){if(this.notificationVector.length)return!1;for(var t in this.notificationVector){var i=this.notificationVector[t];if(i++==e)return!0}return!1},getChannelOnlineConfig:function(){var e=Tt.getOnlineConfig("channelConfig");if(e.length){if((e=l.sys.localStorage.getItem(O.kChannelConfig)).length)return}else l.sys.localStorage.setItem(O.kChannelConfig,e);var t=JSON.parse(e);if(null!=t){for(var i=t.notification,n=0;n<i.size();n++){a=r=i[n];this.notificationVector.push(a)}for(var s=t.share,n=0;n<s.size();n++){var r=s[n],a=r;this.shareVector.push(a)}}},isShareOnlineConfigOpen:function(e){if(this.shareVector.length)return!1;for(var t in this.shareVector){var i=this.shareVector[t];if(i++==e)return!0}return!1},showAQiuLevel:function(){return this.getOpenedLevel()>O.SHOWMEETAQIU},showAQiuAnimation:function(){return!(!this.showAQiuLevel()||this.bShowedAQiuEntranceAnimate)&&(!(this.getOpenedLevel()>O.MAINLEVELCOUNT)||(this.bShowedAQiuEntranceAnimate=!0,!1))},checkOldVersionRecord:function(){var e=this.getOpenedLevel();l.log("openlevel---------------%d",e),e>24&&!this.mIsUnlockedDayDayUp&&(this.mIsUnlockedDayDayUp=!0),e>1&&!this.mIsUnlckedEverydayChanllenge&&(this.mIsUnlckedEverydayChanllenge=!0),e>O.SHOWMEETAQIU&&!this.bShowedAQiuEntranceAnimate&&(this.bShowedAQiuEntranceAnimate=!0),e>O.SHOWCASTLELEVEL&&!this.bShowedTempleEntranceAnimate&&(this.bShowedTempleEntranceAnimate=!0),this.getFirstHonor(40)>0&&!this.mIsUnlockedCarrotOld&&(this.mIsUnlockedCarrotOld=!0),(this.isUnlockCarrot(ue.CARROT_GIRL)||e>24||this.isUnlockCarrot(ue.CARROT_FAT)||this.isUnlockCarrot(ue.CARROT_OLD))&&!this.bIsUnlockedSuperPackage&&(this.bIsUnlockedSuperPackage=!0),this.mIsCheckedOldVersion=!0},getMainPagePlayTimes:function(){return this.mainPagePlayTimes},getHeyzapTimes:function(){return this.heyzapTimes},getDomobTimes:function(){return this.domobTimes},getLifeStarPlayTimes:function(){return this.lifeStarPlayTimes},getLosePlayTimes:function(){return this.losePlayTimes},isLeftedHeyzapTimes:function(){return this.heyzapTimes<this.heyzapOnlineTimes},isLeftedDomobTimes:function(){return this.domobTimes<this.domobOnlineTimes},getBanallpayTime:function(){var e=0,t=0,i=!1,n=this.getCurSystemTime();if(this.banallpay<n)return{m:e,s:t,r:i};var s=(this.banallpay-n)%O.STARGROWTIME;return(e=parseInt(s/60))>99&&(e=99),t=s%60,(e||t)&&(i=!0),{m:e,s:t,r:i}},getZeroearningsTime:function(){var e=0,t=0,i=!1;this.zeroearnings=this.zeroearnings?this.zeroearnings:0;var n=this.getCurSystemTime();if(this.zeroearnings<n)return{m:e,s:t,result:i};var s=(this.zeroearnings-n)%O.STARGROWTIME;return(e=parseInt(s/60))>99&&(e=99),t=s%60,(e||t)&&(i=!0),{m:e,s:t,result:i}},setFriendList:function(e){this.friends=e},getFriendList:function(){return this.friends},getFriendByMapLv:function(e){for(var t in this.friends){var i=this.friends[t];if(i.stage==e)return i}return null},getFriendByOpenID:function(e){for(var t in this.friends){var i=this.friends[t];if(i.openid==e)return i}return null},getAllFriendsOpenIds:function(){var e=[];for(var t in this.friends){var i=this.friends[t];e.push(i.openid)}return e},getidiRank:function(e){if(void 0==e)return null;for(var t in this.idipranks){var i=this.idipranks[t];if(i.type==e)return decodeURIComponent(i.content)}return null},setConsumePropPrice:function(e){this._shopcfg=e},setConsumePropPriceById:function(e,t){var i=!1;t=t||0;for(var n in this._shopcfg){var s=this._shopcfg[n];if(s.id==e){s.diamond=t,i=!0;break}}i||(void 0==this._shopcfg&&(this._shopcfg=[]),this._shopcfg.push({id:e,diamond:t}))},getConsumePropPrice:function(e){if(void 0==e)return 0;for(var t in this._shopcfg){var i=this._shopcfg[t];if(i.id==e)return i.diamond}return 0},setawardrecord:function(e){void 0!=e&&(this._awardrecord=e.reverse())},getAwardrecordByIndex:function(e){return void 0!=this._awardrecord&&void 0!=e&&((e=e?e-1:e)<this._awardrecord.length&&this._awardrecord[e])},setAwardrecordByIndex:function(e,t){void 0!=e&&(void 0==this._awardrecord&&(this._awardrecord=[]),e=e?e-1:e,this._awardrecord[e]=t)},setdailyawardrecord:function(e){void 0!=e&&(this._dailyawardrecord=e.reverse())},getdailyawardrecordByIndex:function(e){return void 0!=this._dailyawardrecord&&void 0!=e&&((e=e?e-1:e)<this._dailyawardrecord.length&&this._dailyawardrecord[e])},setdailyawardrecordByIndex:function(e,t){void 0!=e&&(void 0==this._dailyawardrecord&&(this._dailyawardrecord=[]),e=e?e-1:e,this._dailyawardrecord[e]=t)},getShareIsShow:function(e){return void 0!=e&&void 0!=this.shareList&&(e<this.shareList.length&&this.shareList[e])},setShareIsshow:function(e,t){void 0!=e&&(void 0==this.shareList&&(this.shareList=[]),this.shareList[e]=t)},setfirstrecord:function(e){void 0!=e&&(this._firstRecord=e.reverse())},getfirstrecordByIndex:function(e){return void 0!=this._firstRecord&&void 0!=e&&(e<this._firstRecord.length&&this._firstRecord[e])},setfirstrecordByIndex:function(e,t){void 0!=e&&(void 0==this._firstRecord&&(this._firstRecord=[]),this._firstRecord[e]=t)},setGoldCount:function(e){this._goldCount=e||0},setHonorCount:function(e){this._honorCount=e||0}}),Rd=l.Class.extend({allLevels:null,ctor:function(){this.initUseData()},onExit:function(){this._super()},initUseData:function(){var e=l.director,t=l.EGLView._getInstance();e.setOpenGLView(t);var i=t.getFrameSize(),n=0,s=1;if(800===i.width&&480===i.height)n=960,s=1;else if(854===i.width&&480===i.height)n=960,s=1;else if(960===i.width&&640===i.height)n=960,s=1;else if(480===i.width&&320===i.height)n=960,s=1;else if(1024===i.width&&768===i.height)n=960,s=1;else if(1280===i.width&&720===i.height)n=960,s=1;else if(2048===i.width&&1536===i.height)n=960,s=1;else if(960===i.width&&540===i.height)n=960,s=1;else if(320===i.width&&240===i.height)n=960,s=1;else if(800===i.width&&600===i.height)n=960,s=1;else if(1024===i.width&&600===i.height)n=960,s=1;else if(1024===i.width&&552===i.height)n=960,s=1;else if(1280===i.width&&800===i.height)n=960,s=1;else if(400===i.width&&240===i.height)n=960,s=1;else if(1280===i.width&&768===i.height)n=960,s=1;else if(1024===i.width&&480===i.height)n=960,s=1;else if(480===i.width&&272===i.height)n=960,s=1;else if(960===i.width&&480===i.height)n=960,s=1;else if(640===i.width&&480===i.height)n=960,s=1;else if(480===i.width&&288===i.height)n=960,s=1;else if(220===i.width&&176===i.height)n=960,s=1;else if(720===i.width&&480===i.height)n=960,s=1;else if(640===i.width&&360===i.height)n=960,s=1;else if(1196===i.width&&720===i.height)n=960,s=1;else if(1136===i.width&&640===i.height)n=960,s=1;else{i.width>=900||i.height;n=960,s=1}var r=null,a=null,o=null,h=null,d=null,c=null,u=null,p=null,m=null,_=null,g=null,T=null,f=null,S=null,w=null,v=null,L=null,M=null,C=null,y=null,B=null,F=null,E=null,P=null,b=null,A=null,O=null,I=null,R=null,D=null,x=null,N=null,G=null,W=null,k=null,U=null,H=null,V=null,z=null,Y=null,X=null,j=null,K=null,q=null,Q=null,Z=null,$=null,ee=null,te=null,ie=null,ne=null,re=null,ae=null,oe=null,he=null,le=null,de=null,ce=null,ue=null,pe=null,me=null,_e=null,ge=null,Te=null,fe=null,Se=null,we=null,ve=null,Le=null,Me=null,Ce=null,ye=null,Be=null,Fe=null,Ee=null,Pe=null,be=null,Ae=null,Oe=null,Ie=null,Re=null,De=null,xe=null,Ne=null,Ge=null,We=null,ke=null,Ue=null,He=null,Ve=null,ze=null,Ye=null,Xe=null,je=null,Ke=null,qe=null,Qe=null,Ze=null,Je=null,$e=null,et=null,tt=null,it=null,nt=null,st=null,rt=null,at=null,ot=null,ht=null,lt=null,dt=null,ct=null,ut=null,pt=null,mt=null,_t=null,gt=null,Tt=null,ft=null,St=null,wt=null,vt=null,Lt=null,Mt=null,Ct=null,yt=null,Bt=null,Ft=null,Et=null,Pt=null,bt=null,At=null,Ot=null,It=null,Rt=null,Dt=null,xt=null,Nt=null,Gt=null,Wt=null,kt=null,Ut=null,Ht=null,Vt=null,zt=null,Yt=null,Xt=null,jt=null,Kt=null,qt=null,Qt=null,Zt=null,Jt=null,$t=null,ei=null,ti=null,ii=null,ni=null,si=null,ri=null,ai=null,oi=null,hi=null,li=null,di=null,ci=null,ui=null,pi=null,mi=null,_i=null,gi=null,Ti=null,fi=null;return r=[new Wd(1,J.LM1,5,5),new Wd(2,J.LM2,5,10),new Wd(3,J.LM3,10,15),new Wd(4,J.LM1,5,20),new Wd(3,J.LM2,5,20),new Wd(5,J.LM3,5,40),new Wd(5,J.LM1,5,40),new Wd(5,J.LM2,5,45),new Wd(6,J.LM3,5,50),new Wd(6,J.LM1,5,50),new Wd(6,J.LM2,5,50)],a=[J.TBOTTLE],o=[new xd(5,5,10,J.TBOTTLE,se.BUILDTOWER,-5),new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-50),new Nd(4,1,10,6e3,se.KILLOBJECT,1,",S3Ob1,")],h=Gd.create(1,6,800,1,3,"level 1",a,r,.3,o,l.p(104*s,375*s)),r=[new Wd(1,J.FLM1,2,10),new Wd(1,J.LM3,8,10),new Wd(2,J.FLM1,4,10),new Wd(2,J.LM2,5,10),new Wd(3,J.FLM1,5,15),new Wd(3,J.FLM2,5,15),new Wd(4,J.LM1,8,20),new Wd(4,J.LM3,2,20),new Wd(5,J.FLM1,6,33.15),new Wd(5,J.LM1,2,47.36),new Wd(5,J.FTM,2,56.84),new Wd(6,J.FLM1,2,44.73),new Wd(6,J.LM3,8,63.9),new Wd(7,J.LM1,8,60.44),new Wd(7,J.FLM2,2,45.31),new Wd(8,J.LM3,4,96.98),new Wd(8,J.FTM,6,116.38),new Wd(9,J.FLM1,5,79.47),new Wd(9,J.FLM2,5,79.47),new Wd(10,J.LM1,5,130.06),new Wd(10,J.FLM1,5,91.04),new Wd(10,J.LM2,5,130.06)],a=[J.TBOTTLE,J.TSHIT],o=[new xd(6,1,10,J.TSHIT,se.BUILDTOWER,-1),new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-50),new Nd(4,2,10,6e3,se.KILLOBJECT,2,",S3Ob1,S3Ob2,")],d=Gd.create(1,10,750,1,3,"level 2",a,r,.3,o,l.p(323*s,248*s)),r=[new Wd(1,J.LM1,5,5),new Wd(1,J.LM2,5,5),new Wd(2,J.LM2,5,10),new Wd(2,J.LM3,5,10),new Wd(3,J.LM1,5,15),new Wd(3,J.LM3,5,15),new Wd(4,J.LM2,5,20),new Wd(4,J.LM1,5,20),new Wd(5,J.FTM,10,50),new Wd(6,J.FTM,2,80),new Wd(6,J.LM1,8,60),new Wd(7,J.LM3,4,80),new Wd(7,J.FTM,6,100),new Wd(8,J.LM2,4,100),new Wd(8,J.LM3,6,100),new Wd(9,J.LM1,2,120),new Wd(9,J.FTM,2,140),new Wd(9,J.LM2,6,120),new Wd(10,J.LM2,5,150),new Wd(10,J.LM3,5,150),new Wd(10,J.FTM,2,200),new Wd(11,J.FTM,2,220),new Wd(11,J.LM3,8,170),new Wd(12,J.LM2,4,200),new Wd(12,J.LM1,6,200),new Wd(13,J.FTM,6,280),new Wd(13,J.LM2,4,240),new Wd(14,J.LM1,8,280),new Wd(14,J.FTM,2,340),new Wd(15,J.LM2,5,300),new Wd(15,J.FTM,8,350)],a=[J.TSHIT,J.TSTAR],o=[new xd(7,6,10,J.TSTAR,se.BUILDTOWER,-6),new xd(6,2,10,J.TSHIT,se.BUILDTOWER,-2),new Nd(4,2,10,6e3,se.KILLOBJECT,2,",L1Ob1,L1Ob2,")],c=Gd.create(1,15,900,1,3,"level 3",a,r,.3,o,l.p(186*s,120*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(2,J.LM2,5,10),new Wd(2,J.LM3,5,10),new Wd(3,J.LM3,2,15.45),new Wd(3,J.LM1,8,15.45),new Wd(4,J.FLM1,4,17.7),new Wd(4,J.FTM,6,30.35),new Wd(5,J.FLM1,5,49.19),new Wd(5,J.FLM2,5,49.19),new Wd(5,J.LM1,5,70.27),new Wd(5,J.LM2,5,70.27),new Wd(5,J.LM3,5,70.27),new Wd(5,J.FTM,5,84.32),new Wd(6,J.LM3,6,112.37),new Wd(6,J.FTM,4,134.84),new Wd(7,J.LM1,8,132.05),new Wd(7,J.FTM,2,158.47),new Wd(8,J.LM2,8,151.74),new Wd(8,J.FTM,2,182.09),new Wd(9,J.LM1,8,171.43),new Wd(9,J.FTM,2,205.72),new Wd(10,J.LM1,6,191.12),new Wd(10,J.LM2,6,191.12),new Wd(10,J.LM3,6,191.12)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR],o=[new xd(7,7,10,J.TSTAR,se.BUILDTOWER,-7),new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-80),new Nd(4,4,10,6e3,se.KILLOBJECT,4,",L1Ob1,L1Ob2,L1Ob3,L1Ob4,")],u=Gd.create(1,10,550,1,3,"level 4",a,r,.3,o,l.p(337*s,53*s)),r=[new Wd(1,J.LM1,4,10),new Wd(1,J.LM2,4,10),new Wd(2,J.LM3,4,10),new Wd(2,J.LM2,4,10),new Wd(3,J.FLM1,2,8),new Wd(3,J.LM2,6,12),new Wd(4,J.FLM2,2,12),new Wd(4,J.FTM,6,20),new Wd(5,J.FLM1,6,15),new Wd(5,J.FLM2,2,15),new Wd(6,J.LM2,3,25),new Wd(6,J.LM3,5,25),new Wd(7,J.FLM2,6,30),new Wd(7,J.FTM,2,50),new Wd(8,J.LM1,4,80),new Wd(8,J.FTM,4,100),new Wd(9,J.FTM,2,140),new Wd(9,J.FLM1,6,80.18),new Wd(10,J.FLM1,7,90),new Wd(10,J.SBL2,1,5),new Wd(11,J.FLM1,4,103.59),new Wd(11,J.FLM2,4,103.59),new Wd(12,J.SBL1,5,6.5)],a=[J.TBOTTLE,J.TSUN],o=[new xd(5,2,10,J.TBOTTLE,se.BUILDTOWER,-2),new Nd(4,2,10,6e3,se.KILLOBJECT,2,",B2Ob1,B2Ob2,"),new Nd(4,23,10,6e3,se.FINDTOWER,-3,"tstar,")],p=Gd.create(1,12,800,1,3,"level 5",a,r,.4,o,l.p(474*s,136*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(2,J.LM3,5,10),new Wd(2,J.LM2,5,10),new Wd(3,J.LM1,5,17.62),new Wd(3,J.LM2,5,17.62),new Wd(3,J.LM3,5,17.62),new Wd(4,J.LM3,5,32.29),new Wd(4,J.FTM,5,38.75),new Wd(5,J.LM3,5,87.99),new Wd(5,J.LM2,5,87.99),new Wd(5,J.LM1,5,87.99),new Wd(6,J.FLM1,5,82.12),new Wd(6,J.FLM2,5,82.12),new Wd(7,J.FLM1,5,98.51),new Wd(7,J.LM1,10,140.73),new Wd(8,J.FLM2,5,119.05),new Wd(8,J.LM2,10,170.06),new Wd(9,J.FTM,4,239.27),new Wd(9,J.FLM2,6,139.58),new Wd(9,J.LM3,5,199.39),new Wd(10,J.FTM,4,274.47),new Wd(10,J.FLM1,3,160.11),new Wd(10,J.FLM2,3,160.11),new Wd(10,J.SBFL1,1,4),new Wd(11,J.LM2,8,266.34),new Wd(11,J.LM1,7,266.34),new Wd(12,J.LM3,10,295.67),new Wd(12,J.FTM,5,354.8),new Wd(13,J.LM3,5,325),new Wd(13,J.LM1,5,325),new Wd(13,J.LM2,5,325),new Wd(14,J.FLM1,8,248.03),new Wd(14,J.FLM2,8,248.03),new Wd(15,J.SBL2,4,7),new Wd(15,J.SBL3,4,6),new Wd(16,J.FLM1,5,376.9),new Wd(16,J.FLM2,5,376.9),new Wd(16,J.LM3,5,538.42),new Wd(17,J.LM1,5,567.75),new Wd(17,J.LM2,5,567.75),new Wd(17,J.LM3,5,567.75),new Wd(18,J.LM3,5,597.08),new Wd(18,J.FTM,5,716.5),new Wd(18,J.FLM1,5,417.96),new Wd(19,J.FTM,2,751.7),new Wd(19,J.LM2,8,626.41),new Wd(19,J.LM3,5,626.41),new Wd(20,J.LM1,10,655.74),new Wd(20,J.LM2,10,655.74),new Wd(20,J.SBFT,1,15)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR,J.TSUN],o=[new xd(8,14,10,J.TSUN,se.BUILDTOWER,5),new xd(7,23,10,J.TSTAR,se.KILLMONSTER,-100),new Nd(4,5,10,6e3,se.KILLOBJECT,5,",S3Ob1,S3Ob2,S3Ob3,S3Ob4,S3Ob5,")],m=Gd.create(1,20,750,1,3,"level 6",a,r,.7,o,l.p(484*s,334*s)),r=[new Wd(1,J.LM2,5,10),new Wd(1,J.LM1,5,10),new Wd(2,J.LM3,4,10),new Wd(2,J.FTM,6,10),new Wd(3,J.LM2,8,16.63),new Wd(3,J.FTM,2,19.95),new Wd(4,J.LM2,6,28.05),new Wd(4,J.LM3,4,28.05),new Wd(5,J.LM1,5,78.94),new Wd(5,J.LM2,5,78.94),new Wd(5,J.LM3,5,78.94),new Wd(6,J.LM1,8,106.99),new Wd(6,J.LM2,7,106.99),new Wd(7,J.LM2,5,135.04),new Wd(7,J.LM3,10,135.04),new Wd(8,J.FLM1,9,114.16),new Wd(8,J.FLM2,6,114.16),new Wd(9,J.LM1,5,191.13),new Wd(9,J.FTM,10,229.36),new Wd(10,J.LM1,5,200),new Wd(10,J.LM2,5,200),new Wd(10,J.LM3,5,200),new Wd(10,J.SBL1,1,10),new Wd(11,J.FLM1,2,181.81),new Wd(11,J.LM2,8,259.73),new Wd(12,J.FLM2,4,197.8),new Wd(12,J.LM1,6,282.57),new Wd(13,J.FLM2,3,213.79),new Wd(13,J.FLM1,7,213.79),new Wd(14,J.LM2,6,328.25),new Wd(14,J.LM3,4,328.25),new Wd(15,J.FLM1,10,245.77),new Wd(15,J.FLM2,10,245.77),new Wd(16,J.FLM1,5,269.05),new Wd(16,J.FTM,10,461.22),new Wd(17,J.LM3,10,412.4),new Wd(17,J.FTM,5,494.88),new Wd(18,J.LM1,10,440.45),new Wd(18,J.FTM,5,528.54),new Wd(19,J.FLM1,10,327.95),new Wd(19,J.FLM2,5,327.95),new Wd(20,J.FLM1,5,338.88),new Wd(20,J.LM3,5,484.12),new Wd(20,J.SBL2,1,18)],a=[J.TBOTTLE,J.TBALL],o=[new xd(9,6,10,J.TBALL,se.BUILDTOWER,-6),new Nd(4,8,10,6e3,se.KILLOBJECT,8,",S2Ob1,S2Ob2,S2Ob3,S2Ob4,S2Ob5,S2Ob6,S2Ob7,S2Ob8,S2Ob9,L3Ob1,"),new Nd(3,25,10,120,se.EARNMONEY,-2e3)],_=Gd.create(1,20,400,1,3,"level 7",a,r,.6,o,l.p(651*s,406*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(2,J.LM3,5,10),new Wd(2,J.LM1,5,10),new Wd(3,J.LM2,4,13.7),new Wd(3,J.LM3,6,13.7),new Wd(4,J.FLM1,6,20.07),new Wd(4,J.LM3,4,28.67),new Wd(5,J.FLM2,5,61.11),new Wd(5,J.LM2,5,87.3),new Wd(5,J.FTM,2,104.76),new Wd(6,J.LM1,5,110.98),new Wd(6,J.LM2,5,110.98),new Wd(6,J.LM3,5,110.98),new Wd(7,J.FTM,5,188.14),new Wd(7,J.FLM1,5,109.75),new Wd(7,J.LM3,5,156.78),new Wd(8,J.FLM1,5,125.51),new Wd(8,J.LM2,5,185.51),new Wd(8,J.FLM2,5,125.51),new Wd(9,J.LM3,5,220),new Wd(9,J.LM2,5,220),new Wd(9,J.FTM,5,250),new Wd(10,J.FLM2,5,157.02),new Wd(10,J.FLM1,5,157.02),new Wd(10,J.SBFL1,1,6),new Wd(11,J.LM1,10,353.56),new Wd(11,J.LM2,10,353.56),new Wd(12,J.LM3,10,387.21),new Wd(12,J.FTM,10,488.66),new Wd(13,J.FLM1,10,280.6),new Wd(13,J.FLM2,10,280.6),new Wd(14,J.FLM1,10,311.16),new Wd(14,J.LM3,10,484.51),new Wd(15,J.FTM,10,608.2),new Wd(15,J.FLM2,10,260),new Wd(15,J.SBL3,1,20),new Wd(16,J.LM1,5,588.25),new Wd(16,J.FTM,5,687.9),new Wd(17,J.LM2,5,608.2),new Wd(17,J.LM3,5,608.2),new Wd(18,J.FLM1,5,425.7),new Wd(18,J.LM1,5,640.14),new Wd(19,J.FTM,5,700),new Wd(19,J.FLM1,5,420),new Wd(20,J.FLM1,5,700),new Wd(20,J.LM2,5,700),new Wd(20,J.SBFT,1,28),new Wd(21,J.FLM1,10,550),new Wd(21,J.FLM2,10,550),new Wd(22,J.FLM1,10,580),new Wd(22,J.LM3,10,780),new Wd(23,J.FTM,9,950),new Wd(23,J.LM3,9,810),new Wd(24,J.LM1,8,850),new Wd(24,J.FTM,8,980),new Wd(25,J.LM1,5,900),new Wd(25,J.LM2,5,900),new Wd(25,J.BMT,1,10)],a=[J.TSHIT,J.TSUN,J.TBALL],o=[new xd(6,3,10,J.TSHIT,se.BUILDTOWER,-3),new Nd(4,23,10,120,se.FINDTOWER,-3,"tstar,"),new Nd(4,23,10,6e3,se.FINDTOWER,-3,"tbottle,")],g=Gd.create(1,25,500,1,3,"level 8",a,r,.8,o,l.p(852*s,330*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.FTM,5,20),new Wd(2,J.FLM1,5,10),new Wd(2,J.LM3,5,10),new Wd(3,J.LM3,6,20),new Wd(3,J.LM2,4,20),new Wd(4,J.FLM2,8,30),new Wd(4,J.FLM1,2,30),new Wd(5,J.LM1,5,50),new Wd(5,J.LM2,5,50),new Wd(5,J.LM3,5,50),new Wd(6,J.FTM,5,100),new Wd(6,J.FLM2,3,60),new Wd(6,J.LM3,2,80),new Wd(7,J.LM3,5,100),new Wd(7,J.FTM,5,140),new Wd(8,J.FLM1,5,90),new Wd(8,J.FLM2,5,90),new Wd(9,J.LM1,5,160),new Wd(9,J.LM3,5,160),new Wd(10,J.LM3,5,220),new Wd(10,J.LM1,5,220),new Wd(10,J.LM2,5,220),new Wd(10,J.SBFT,1,16),new Wd(11,J.LM1,5,313.53),new Wd(11,J.FTM,5,376.23),new Wd(12,J.FLM1,5,241.86),new Wd(12,J.FLM2,5,241.86),new Wd(13,J.FLM2,5,264.24),new Wd(13,J.LM3,5,377.49),new Wd(14,J.FTM,5,491.36),new Wd(14,J.LM2,5,409.47),new Wd(15,J.FLM1,5,309.01),new Wd(15,J.FLM2,5,309.01),new Wd(15,J.FTM,10,529.74),new Wd(16,J.FTM,5,584.6),new Wd(16,J.FLM1,5,341.02),new Wd(17,J.LM3,5,519.15),new Wd(17,J.LM2,5,519.15),new Wd(18,J.FLM2,5,385.79),new Wd(18,J.LM2,5,551.13),new Wd(18,J.FTM,5,661.35),new Wd(19,J.FLM1,5,412.98),new Wd(19,J.FTM,5,707.97),new Wd(20,J.LM3,10,603.71),new Wd(20,J.SBL1,1,26),new Wd(21,J.LM3,5,633.92),new Wd(21,J.LM1,5,633.92),new Wd(21,J.FTM,5,760.71),new Wd(22,J.LM1,3,654.52),new Wd(22,J.FLM1,2,458.17),new Wd(22,J.FTM,10,785.43),new Wd(23,J.FLM1,5,472.59),new Wd(23,J.LM3,5,675.12),new Wd(23,J.LM2,5,675.12),new Wd(24,J.FLM1,5,487.01),new Wd(24,J.FLM2,5,487.01),new Wd(25,J.FTM,5,851.35),new Wd(25,J.FLM2,2,496.62),new Wd(25,J.LM2,8,709.46),new Wd(25,J.SBFT,1,60)],a=[J.TBOTTLE,J.TSTAR,J.TSUN,J.TBALL],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-100),new Nd(4,23,10,6e3,se.FINDTOWER,-8,"tshit,"),new Nd(4,3,10,6e3,se.KILLOBJECT,3,",B1Ob1,B1Ob2,B1Ob3,")],T=Gd.create(1,25,500,1,3,"level 9",a,r,.9,o,l.p(567*s,240*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(2,J.LM3,4,20),new Wd(2,J.LM1,6,20),new Wd(3,J.LM3,6,40),new Wd(3,J.FTM,4,50),new Wd(4,J.LM3,5,50),new Wd(4,J.LM2,5,50),new Wd(5,J.LM1,5,103.23),new Wd(5,J.LM2,5,103.23),new Wd(5,J.LM3,5,103.23),new Wd(6,J.LM3,6,148.34),new Wd(6,J.FTM,4,178),new Wd(7,J.FTM,8,224.32),new Wd(7,J.FLM2,2,130.85),new Wd(8,J.FLM1,5,157.87),new Wd(8,J.FLM2,5,157.87),new Wd(9,J.FLM1,8,184.88),new Wd(9,J.LM3,2,264.12),new Wd(10,J.FLM2,10,211.9),new Wd(10,J.SBL2,1,8),new Wd(11,J.FLM2,4,249.85),new Wd(11,J.LM1,6,356.93),new Wd(12,J.FLM1,8,276.87),new Wd(12,J.LM3,2,395.53),new Wd(13,J.LM2,6,434.12),new Wd(13,J.FTM,4,520.95),new Wd(14,J.LM1,8,472.72),new Wd(14,J.FTM,2,567.26),new Wd(15,J.FLM1,9,357.92),new Wd(15,J.SBFL2,1,8),new Wd(16,J.LM2,6,685.13),new Wd(16,J.FTM,4,822.16),new Wd(17,J.FLM2,8,506.61),new Wd(17,J.FLM1,2,506.61),new Wd(18,J.LM2,6,736.75),new Wd(18,J.LM1,4,736.75),new Wd(19,J.LM2,6,749.77),new Wd(19,J.LM3,4,749.77),new Wd(20,J.FLM1,7,533.95),new Wd(20,J.LM2,7,762.79),new Wd(20,J.SBFT,1,15)],a=[J.TBOTTLE,J.TICEFAN],o=[new xd(10,2,10,J.TICEFAN,se.BUILDTOWER,-2),new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-80),new Nd(4,23,10,6e3,se.FINDTOWER,-6,"")],f=Gd.create(1,20,700,1,3,"level 10",a,r,1,o,l.p(826*s,108*s)),r=[new Wd(1,J.LM1,4,10),new Wd(1,J.LM2,6,10),new Wd(2,J.LM3,4,15),new Wd(2,J.LM1,6,15),new Wd(3,J.FLM1,5,15),new Wd(3,J.LM3,5,25),new Wd(4,J.LM3,5,35),new Wd(4,J.LM2,5,35),new Wd(4,J.FTM,5,50),new Wd(5,J.LM2,5,50),new Wd(5,J.LM3,5,50),new Wd(5,J.LM1,5,50),new Wd(6,J.FLM1,5,80),new Wd(6,J.FLM2,5,80),new Wd(7,J.LM3,5,120),new Wd(7,J.LM2,5,120),new Wd(7,J.LM1,5,120),new Wd(8,J.LM3,8,200),new Wd(8,J.LM2,2,200),new Wd(9,J.LM1,10,250),new Wd(9,J.FTM,10,350),new Wd(10,J.FLM1,2,250),new Wd(10,J.FLM2,8,250),new Wd(10,J.SBFL1,1,6),new Wd(11,J.FLM1,2,300),new Wd(11,J.FLM2,8,300),new Wd(11,J.FTM,5,550),new Wd(12,J.LM2,10,400),new Wd(12,J.LM3,10,400),new Wd(13,J.LM2,10,450),new Wd(13,J.LM1,10,450),new Wd(14,J.FTM,2,500),new Wd(14,J.FLM1,6,350),new Wd(14,J.LM3,6,500),new Wd(15,J.SBL1,5,7),new Wd(15,J.SBL2,5,8),new Wd(16,J.LM1,5,600),new Wd(16,J.LM2,5,600),new Wd(16,J.LM3,5,600),new Wd(17,J.FLM2,10,500),new Wd(17,J.FLM1,10,500),new Wd(18,J.LM1,10,800),new Wd(18,J.LM2,10,800),new Wd(19,J.FTM,10,1e3),new Wd(19,J.LM3,10,850),new Wd(20,J.LM3,10,950),new Wd(20,J.LM2,10,950),new Wd(20,J.SBFT,1,28)],a=[J.TRANDOM],o=[new xd(5,4,10,J.TBOTTLE,se.BUILDTOWER,-4),new xd(7,23,10,J.TSTAR,se.KILLMONSTER,-90),new xd(10,2,10,J.TICEFAN,se.BUILDTOWER,-2)],S=Gd.create(1,20,1e3,1,3,"level 11",a,r,.7,o,l.p(n+123*s,156*s)),r=[new Wd(1,J.LM1,4,5),new Wd(2,J.LM3,4,10),new Wd(2,J.LM1,2,10),new Wd(3,J.LM2,4,15),new Wd(3,J.LM3,4,15),new Wd(4,J.LM1,2,30),new Wd(4,J.LM2,4,30),new Wd(5,J.LM1,5,100),new Wd(5,J.LM2,5,100),new Wd(6,J.LM1,4,150),new Wd(6,J.LM2,2,150),new Wd(7,J.LM2,2,200),new Wd(7,J.FTM,4,250),new Wd(8,J.FLM1,2,200),new Wd(8,J.LM3,4,250),new Wd(9,J.FLM1,4,250),new Wd(9,J.LM1,2,300),new Wd(10,J.FLM1,2,320),new Wd(10,J.FLM2,2,300),new Wd(11,J.LM1,3,650),new Wd(11,J.LM2,3,600),new Wd(12,J.FTM,2,800),new Wd(12,J.LM3,4,600),new Wd(13,J.FLM1,2,500),new Wd(13,J.LM3,4,700),new Wd(14,J.LM3,4,650),new Wd(14,J.FLM2,2,450),new Wd(15,J.LM3,4,800),new Wd(15,J.SBL3,1,11),new Wd(16,J.LM3,2,850),new Wd(16,J.FTM,4,1e3),new Wd(17,J.LM1,3,900),new Wd(17,J.LM3,3,900),new Wd(18,J.FLM1,3,800),new Wd(18,J.FTM,2,1200),new Wd(19,J.FLM2,3,800),new Wd(19,J.FLM1,2,800),new Wd(20,J.LM3,3,1248.37),new Wd(20,J.SBFT,1,21),new Wd(21,J.LM1,3,1280.31),new Wd(21,J.LM3,3,1280.31),new Wd(22,J.FTM,4,1300),new Wd(22,J.LM1,2,850),new Wd(23,J.FLM1,3,881.06),new Wd(23,J.FLM2,2,891.06),new Wd(24,J.LM1,3,1333.54),new Wd(24,J.LM2,3,1333.54),new Wd(24,J.FTM,3,1620.25),new Wd(25,J.FLM1,2,922.11),new Wd(25,J.LM3,2,1360.16),new Wd(25,J.SBFT,1,35)],a=[J.TSHIT,J.TSTAR,J.TBALL,J.TICEFAN],o=[new xd(9,8,10,J.TBALL,se.BUILDTOWER,-8),new xd(10,2,10,J.TICEFAN,se.BUILDTOWER,-2),new Nd(4,3,10,60,se.KILLOBJECT,3,",S3Ob1,S3Ob2,S3Ob3,")],w=Gd.create(1,25,999,1,3,"level 12",a,r,.7,o,l.p(n+98*s,326*s)),r=[new Wd(1,J.LM1,5,5),new Wd(1,J.LM2,5,5),new Wd(2,J.LM1,4,20),new Wd(2,J.LM3,6,20),new Wd(3,J.LM2,6,30),new Wd(3,J.LM3,4,30),new Wd(4,J.FTM,10,50),new Wd(5,J.LM1,5,60),new Wd(5,J.LM2,5,70),new Wd(5,J.LM3,5,80),new Wd(6,J.FLM1,5,50),new Wd(6,J.LM3,5,90),new Wd(7,J.LM2,5,200),new Wd(7,J.LM1,5,200),new Wd(8,J.LM1,5,210.1),new Wd(8,J.LM3,5,220.1),new Wd(9,J.FTM,8,350),new Wd(9,J.FLM2,2,150),new Wd(10,J.FTM,3,400.1),new Wd(10,J.LM3,7,250),new Wd(11,J.FLM2,5,400.1),new Wd(11,J.LM2,5,500),new Wd(12,J.FTM,2,900.6),new Wd(12,J.LM1,8,600),new Wd(13,J.LM1,5,800),new Wd(13,J.LM3,5,800),new Wd(14,J.FLM2,5,750),new Wd(14,J.LM2,5,1050.5),new Wd(15,J.FTM,10,1500),new Wd(15,J.SBFT,1,26),new Wd(16,J.LM1,5,1400.2),new Wd(16,J.LM3,5,1450),new Wd(17,J.LM1,5,1604),new Wd(17,J.LM3,5,1600),new Wd(18,J.FLM1,5,1400),new Wd(18,J.FLM2,5,1350),new Wd(19,J.FLM2,5,1450),new Wd(19,J.LM3,5,1650.6),new Wd(20,J.FLM1,5,1550.7),new Wd(20,J.LM2,5,1900),new Wd(20,J.SBFL1,1,26)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR,J.TICEFAN],o=[new xd(10,12,10,J.TICEFAN,se.BUILDTOWER,3),new xd(7,23,10,J.TSTAR,se.KILLMONSTER,-150),new Nd(3,8,10,6e3,se.KILLOBJECT,8,",SC1Ob1,SC1Ob2,SC1Ob3,SC1Ob4,BC1Ob1,BC1Ob2,BC1Ob3,BC1Ob4,")],v=Gd.create(1,20,500,1,3,"level 13",a,r,.7,o,l.p(n+218*s,434*s)),r=[new Wd(1,J.LM1,8,200),new Wd(1,J.LM2,8,250),new Wd(1,J.LM3,8,300),new Wd(2,J.FTM,10,600),new Wd(3,J.FLM1,10,500),new Wd(3,J.FLM2,10,650),new Wd(4,J.FLM1,8,800),new Wd(4,J.LM3,8,1e3),new Wd(4,J.BM1,1,100)],a=[J.TSHIT,J.TSTAR,J.TSUN,J.TBALL,J.TICEFAN],o=[new Nd(3,2,10,6e3,se.KILLOBJECT,2,",SC1Ob1,SC1Ob2,"),new Nd(4,23,10,6e3,se.FINDTOWER,-10,""),new Nd(3,25,10,120,se.EARNMONEY,-3e3)],L=Gd.create(1,4,1500,1,20,"level 14",a,r,1,o,l.p(n+413*s,463*s),150),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(1,J.SBB,1,80),new Wd(2,J.LM2,5,20),new Wd(2,J.LM3,5,20),new Wd(3,J.LM3,2,30),new Wd(3,J.LM1,8,30),new Wd(4,J.FLM1,4,25),new Wd(4,J.FTM,6,40),new Wd(5,J.FLM1,5,100),new Wd(5,J.FLM2,5,100),new Wd(5,J.LM1,5,200),new Wd(5,J.LM2,5,200),new Wd(5,J.LM3,5,200),new Wd(5,J.FTM,5,400),new Wd(6,J.LM3,6,500),new Wd(6,J.FTM,4,800),new Wd(7,J.LM1,8,600),new Wd(7,J.FTM,2,900),new Wd(8,J.LM2,8,800),new Wd(8,J.FTM,2,1e3),new Wd(9,J.LM1,6,1e3),new Wd(9,J.LM2,4,1e3),new Wd(10,J.LM1,6,1100),new Wd(10,J.LM2,6,1100),new Wd(10,J.LM3,6,1200),new Wd(11,J.FLM2,4,900),new Wd(11,J.FLM1,4,900),new Wd(11,J.LM3,7,1300),new Wd(12,J.LM3,5,1300),new Wd(12,J.LM2,5,1300),new Wd(12,J.LM1,5,1400),new Wd(13,J.LM2,6,1400),new Wd(13,J.FTM,6,1600),new Wd(13,J.LM3,3,1500),new Wd(14,J.FLM1,8,1100),new Wd(14,J.FLM2,2,1100),new Wd(14,J.LM1,7,1600),new Wd(15,J.FLM1,5,1300),new Wd(15,J.LM3,5,1700),new Wd(15,J.SBL1,1,35),new Wd(16,J.LM2,2,1800),new Wd(16,J.LM3,8,1800),new Wd(16,J.FTM,2,1900),new Wd(17,J.FLM1,5,1500),new Wd(17,J.FLM2,5,1500),new Wd(17,J.FTM,3,2e3),new Wd(18,J.LM1,5,1900),new Wd(18,J.LM3,10,1900),new Wd(19,J.LM1,10,2e3),new Wd(19,J.FTM,4,2200),new Wd(20,J.LM1,5,2100),new Wd(20,J.LM2,5,2200),new Wd(20,J.SBL2,1,60)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR,J.TSUN,J.TBALL],o=[new xd(5,14,10,J.TBOTTLE,se.BUILDTOWER,5),new xd(9,12,20,J.TBALL,se.BUILDTOWER,3),new Nd(4,10,10,180,se.KILLOBJECT,19,"")],M=Gd.create(1,20,2e3,1,3,"level 15",a,r,1,o,l.p(n+594*s,449*s)),r=[new Wd(1,J.LM1,20,10),new Wd(2,J.LM2,10,40),new Wd(2,J.LM1,10,40),new Wd(3,J.LM3,15,80),new Wd(3,J.LM2,10,80),new Wd(4,J.LM1,10,100),new Wd(4,J.FTM,15,140),new Wd(4,J.LM2,5,100),new Wd(5,J.FLM1,20,150),new Wd(6,J.FTM,10,400),new Wd(6,J.FLM1,10,200),new Wd(7,J.LM1,5,500),new Wd(7,J.LM2,15,500),new Wd(8,J.LM3,10,600),new Wd(8,J.FLM2,10,400),new Wd(9,J.FLM1,10,450),new Wd(9,J.LM1,10,600),new Wd(10,J.FLM2,19,600),new Wd(10,J.SBFL2,1,20),new Wd(11,J.LM1,5,1171.46),new Wd(11,J.LM2,15,1171.46),new Wd(12,J.FTM,10,1860.83),new Wd(13,J.FLM1,5,1029),new Wd(13,J.FLM2,5,1029),new Wd(14,J.LM3,15,1615.49),new Wd(14,J.LM1,5,1715.49),new Wd(15,J.SBFT,5,18),new Wd(15,J.SBL1,5,25),new Wd(16,J.LM3,15,1825.57),new Wd(16,J.LM2,5,1825.57),new Wd(17,J.FLM1,15,1400),new Wd(17,J.LM3,5,1800.23),new Wd(18,J.FLM2,5,1729.02),new Wd(18,J.LM2,15,2112.89),new Wd(19,J.FTM,5,1787.86),new Wd(19,J.FLM2,5,1500.58),new Wd(19,J.FLM1,5,1200.58),new Wd(20,J.LM1,25,2200.29),new Wd(20,J.FLM1,3,1389.29)],a=[J.TSUN,J.TBALL,J.TMOON],o=[new xd(11,23,20,J.TMOON,se.KILLMONSTER,-50),new xd(8,7,10,J.TSUN,se.BUILDTOWER,-7),new Nd(4,3,10,180,se.KILLOBJECT,3,",B1Ob1,B1Ob2,B1Ob3,")],C=Gd.create(2,20,500,1,3,"level 16",a,r,1,o,l.p(n+721*s,344*s)),r=[new Wd(1,J.LM1,5,5),new Wd(1,J.LM2,5,5),new Wd(2,J.LM1,5,7),new Wd(2,J.LM2,5,7),new Wd(3,J.LM1,5,11),new Wd(3,J.LM3,5,11),new Wd(3,J.FTM,5,20),new Wd(4,J.LM1,5,25),new Wd(4,J.FTM,10,35),new Wd(5,J.FLM1,8,30),new Wd(6,J.LM2,5,70),new Wd(6,J.FLM1,5,50),new Wd(7,J.FTM,5,120.17),new Wd(7,J.FLM2,5,75.93),new Wd(8,J.LM3,5,158.26),new Wd(8,J.LM2,5,158.26),new Wd(9,J.LM1,5,160),new Wd(9,J.LM2,5,160),new Wd(9,J.LM3,5,160),new Wd(10,J.SBFL1,2,5),new Wd(10,J.FLM1,8,140),new Wd(11,J.LM1,5,300),new Wd(11,J.LM2,5,300),new Wd(12,J.LM3,4,400),new Wd(12,J.LM2,6,400),new Wd(13,J.LM2,5,500),new Wd(13,J.LM3,5,500),new Wd(14,J.LM1,3,846.1),new Wd(14,J.LM3,7,846.1),new Wd(15,J.FTM,8,1090.82),new Wd(15,J.SBFT,2,1),new Wd(16,J.LM1,5,1178.2),new Wd(16,J.LM3,5,1178.2),new Wd(17,J.LM1,4,1182.12),new Wd(17,J.FTM,6,1242),new Wd(18,J.LM3,3,1240),new Wd(18,J.LM2,7,1240),new Wd(19,J.FTM,4,1513.49),new Wd(19,J.FLM2,5,602.87),new Wd(20,J.LM3,4,1281.03),new Wd(20,J.LM1,6,1281.03),new Wd(20,J.SBL2,4,15),new Wd(20,J.SBFT,4,15),new Wd(21,J.LM3,5,1548.08),new Wd(21,J.LM1,5,1548.08),new Wd(22,J.FLM2,6,857.51),new Wd(22,J.FLM1,4,857.51),new Wd(23,J.LM3,10,1587.65),new Wd(24,J.LM3,7,1657.65),new Wd(24,J.FTM,3,1828.91),new Wd(25,J.SBL1,10,18),new Wd(25,J.BMT,1,9.5)],a=[J.TICEFAN,J.TSHIT],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-30),new xd(10,13,10,J.TICEFAN,se.BUILDTOWER,4),new Nd(4,2,10,99,se.KILLOBJECT,2,",B1Ob2,B1Ob3,B1Ob1,B1Ob4,")],y=Gd.create(2,25,750,1,3,"level 17",a,r,.8,o,l.p(n+580*s,252*s)),r=[new Wd(1,J.SBFT,5,1),new Wd(2,J.SBL1,10,3),new Wd(3,J.SBFL1,6,20),new Wd(4,J.SBL3,15,35),new Wd(5,J.SBFL2,10,60),new Wd(6,J.BM1,1,70)],a=[J.TSUN],o=[new xd(6,2,10,J.TSHIT,se.BUILDTOWER,-2),new xd(8,16,10,J.TSUN,se.BUILDTOWER,7),new Nd(4,3,20,120,se.KILLOBJECT,3,",B1Ob1,B1Ob2,B1Ob3,B1Ob4,")],B=Gd.create(2,6,350,1,30,"level 18",a,r,1,o,l.p(n+453*s,165*s),200),r=[new Wd(1,J.LM3,20,1),new Wd(2,J.LM1,10,22.69),new Wd(2,J.LM2,10,22.69),new Wd(3,J.LM1,6,45.38),new Wd(3,J.LM3,4,45.38),new Wd(4,J.FTM,8,68.07),new Wd(4,J.LM2,2,56.72),new Wd(5,J.LM3,4,106.14),new Wd(5,J.LM2,6,106.14),new Wd(6,J.LM1,5,158.83),new Wd(6,J.FLM1,5,61.18),new Wd(7,J.LM2,4,181.51),new Wd(7,J.FLM2,6,97.06),new Wd(8,J.FLM1,20,122.94),new Wd(9,J.LM1,6,249.58),new Wd(9,J.FLM2,4,174.71),new Wd(10,J.SBL3,1,6),new Wd(11,J.LM3,10,299.5),new Wd(12,J.LM2,10,457.12),new Wd(13,J.FLM2,10,358.32),new Wd(14,J.LM1,5,732.37),new Wd(14,J.LM2,5,732.37),new Wd(15,J.SBFL2,1,7),new Wd(15,J.SBFL1,1,7),new Wd(16,J.LM3,4,1019.39),new Wd(16,J.FLM1,6,603.57),new Wd(17,J.FTM,4,1490.49),new Wd(17,J.FLM2,6,619.46),new Wd(18,J.LM2,6,1264.77),new Wd(18,J.FLM1,4,655.34),new Wd(19,J.LM3,4,1287.46),new Wd(19,J.FLM2,6,651.22),new Wd(20,J.SBL1,10,15)],a=[J.TROCKET,J.TSHIT,J.TSUN],o=[new xd(8,23,10,J.TSUN,se.KILLMONSTER,-50),new xd(8,6,10,J.TSUN,se.BUILDTOWER,-6),new Nd(3,25,10,99,se.EARNMONEY,-1200)],F=Gd.create(2,20,450,1,3,"level 19",a,r,1,o,l.p(n+667*s,73*s)),r=[new Wd(1,J.LM3,3,1),new Wd(1,J.LM2,7,1),new Wd(2,J.LM2,5,110.15),new Wd(2,J.LM1,5,110.15),new Wd(3,J.LM1,15,220.29),new Wd(4,J.LM3,7,290.01),new Wd(4,J.LM1,3,290.01),new Wd(5,J.FTM,8,420.37),new Wd(5,J.FLM1,2,250.22),new Wd(6,J.LM2,2,522.6),new Wd(6,J.LM3,8,522.6),new Wd(7,J.FLM2,20,350.74),new Wd(8,J.LM2,8,687.53),new Wd(8,J.LM3,2,687.53),new Wd(9,J.FLM2,10,576.19),new Wd(9,J.FLM1,10,576.19),new Wd(10,J.LM2,6,1452.45),new Wd(3,J.FLM1,4,516.72),new Wd(10,J.SBL1,2,17),new Wd(11,J.LM3,4,1327.27),new Wd(11,J.LM2,6,1327.27),new Wd(12,J.LM3,15,1349.56),new Wd(13,J.LM1,8,1582.99),new Wd(13,J.LM2,2,1582.99),new Wd(14,J.FTM,5,1886.34),new Wd(14,J.FLM2,5,833.7),new Wd(15,J.SBL1,9,20),new Wd(15,J.SBFL1,2,15),new Wd(16,J.LM3,5,2195.08),new Wd(16,J.FLM1,5,836.55),new Wd(17,J.LM2,8,2217.37),new Wd(17,J.FLM2,2,1052.16),new Wd(18,J.LM2,3,2239.66),new Wd(18,J.LM3,7,2239.66),new Wd(19,J.FLM1,20,1283.37),new Wd(20,J.FTM,8,2767.84),new Wd(20,J.FLM2,2,1614.57),new Wd(20,J.SBL3,2,35),new Wd(21,J.LM3,5,2382.32),new Wd(21,J.LM2,10,2382.32),new Wd(22,J.LM1,8,2415.76),new Wd(23,J.FTM,20,2420.31),new Wd(23,J.FLM2,2,1303.52),new Wd(24,J.FLM1,10,1737.85),new Wd(24,J.LM3,5,2482.64),new Wd(25,J.SBFT,8,40),new Wd(25,J.SBFL2,2,30)],a=[J.TBOTTLE,J.TICEFAN,J.TROCKET,J.TBALL],o=[new xd(9,23,10,J.TBALL,se.KILLMONSTER,-100),new xd(14,15,10,J.TROCKET,se.BUILDTOWER,6),new Nd(4,1,10,240,se.KILLOBJECT,1,",L3Ob1,")],E=Gd.create(2,25,5e3,1,3,"level 20",a,r,1.3,o,l.p(n+864*s,65*s)),r=[new Wd(1,J.FLM1,30,100),new Wd(2,J.LM3,5,230),new Wd(2,J.LM2,25,300),new Wd(3,J.LM1,15,800),new Wd(3,J.FTM,5,1e3),new Wd(4,J.LM2,4,3),new Wd(4,J.SBFT,16,15),new Wd(5,J.SBFL1,16,80),new Wd(5,J.BM2,1,82)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR],o=[new xd(7,23,10,J.TSTAR,se.KILLMONSTER,-30),new xd(5,11,10,J.TBOTTLE,se.BUILDTOWER,2),new Nd(4,4,10,180,se.KILLOBJECT,4,",B1Ob1,B1Ob2,B1Ob3,B1Ob4,")],P=Gd.create(2,5,1650,1,30,"level 21",a,r,1,o,l.p(2*n+81*s,108*s),260),r=[new Wd(1,1,J.LM2,15,5),new Wd(1,2,J.LM1,15,5),new Wd(2,1,J.LM3,2,9),new Wd(2,2,J.LM1,8,9),new Wd(3,1,J.LM2,5,16),new Wd(3,2,J.LM3,5,16),new Wd(4,2,J.FTM,2,35.5),new Wd(4,2,J.LM1,8,30),new Wd(5,1,J.FTM,4,90),new Wd(5,1,J.FLM1,6,60),new Wd(5,2,J.LM3,10,60),new Wd(6,1,J.LM2,15,100.67),new Wd(7,1,J.LM3,5,160.67),new Wd(7,1,J.FTM,5,200.67),new Wd(7,1,J.LM1,5,160.67),new Wd(8,1,J.LM2,5,200.67),new Wd(8,2,J.LM3,5,200.67),new Wd(9,2,J.FLM1,10,168.98),new Wd(10,2,J.FLM2,5,184.34),new Wd(10,2,J.SBL2,10,3),new Wd(11,1,J.LM2,8,337.95),new Wd(11,1,J.FLM2,2,236.57),new Wd(12,2,J.FTM,3,431.88),new Wd(12,2,J.FLM1,7,251.93),new Wd(12,1,J.LM1,5,359.9),new Wd(13,1,J.LM2,5,392.82),new Wd(13,2,J.LM3,5,392.82),new Wd(14,1,J.LM1,5,414.76),new Wd(14,1,J.FTM,5,497.71),new Wd(15,1,J.SBL1,5,10),new Wd(15,1,J.SBL2,3,10),new Wd(15,2,J.FLM2,8,305.69),new Wd(16,2,J.LM3,5,579.35),new Wd(16,1,J.LM2,5,579.35),new Wd(17,1,J.LM1,5,762.12),new Wd(17,2,J.LM2,5,762.12),new Wd(18,2,J.LM3,5,800.89),new Wd(18,2,J.LM2,5,800.89),new Wd(19,1,J.FLM2,15,650),new Wd(20,1,J.SBL3,5,10),new Wd(20,1,J.FTM,5,1100.51),new Wd(20,2,J.FLM1,10,550),new Wd(21,2,J.LM1,3,1000.51),new Wd(21,2,J.LM3,5,1000.51),new Wd(21,1,J.FLM1,10,600.51),new Wd(22,2,J.LM2,10,1000.51),new Wd(23,1,J.LM1,5,1350),new Wd(23,2,J.FTM,5,1500),new Wd(24,2,J.FLM1,5,650),new Wd(24,1,J.FLM2,15,650),new Wd(25,1,J.FTM,5,1500.5),new Wd(25,1,J.SBFL1,1,8),new Wd(25,2,J.SBL3,3,20),new Wd(26,1,J.LM1,8,1300),new Wd(26,2,J.LM3,7,1300),new Wd(27,1,J.FTM,10,1500.25),new Wd(28,2,J.LM3,5,1650),new Wd(28,1,J.LM2,5,1600),new Wd(29,2,J.FLM1,5,700),new Wd(29,2,J.FLM1,5,600),new Wd(30,1,J.SBL3,2,18),new Wd(30,2,J.FTM,8,1500),new Wd(30,1,J.BMT,1,8)],a=[J.TSUN,J.TMOON,J.TROCKET],o=[new xd(8,23,10,J.TSUN,se.KILLMONSTER,-120),new xd(14,4,10,J.TROCKET,se.BUILDTOWER,-4),new Nd(4,3,20,99,se.KILLOBJECT,3,",B2Ob1,B2Ob2,B2Ob3,")],b=Gd.create(2,30,1250,1,3,"level 22",a,r,.7,o,l.p(2*n+219*s,242*s)),r=[new Wd(1,J.LM1,5,5),new Wd(1,J.LM1,5,5),new Wd(2,J.LM1,5,10),new Wd(2,J.LM2,5,10),new Wd(3,J.LM2,10,15),new Wd(4,J.LM3,5,25),new Wd(4,J.LM1,10,25),new Wd(5,J.LM2,10,70),new Wd(5,J.LM3,10,70),new Wd(6,J.FLM1,10,70),new Wd(7,J.FTM,10,150),new Wd(8,J.FLM2,15,100),new Wd(9,J.LM1,8,200),new Wd(9,J.FLM1,4,140),new Wd(10,J.LM2,8,250),new Wd(10,J.FLM2,8,160),new Wd(11,J.LM3,8,400),new Wd(11,J.FTM,8,300),new Wd(12,J.FLM1,8,270.04),new Wd(12,J.FLM2,8,270.04),new Wd(13,J.LM1,8,450),new Wd(13,J.SBL1,3,5.5),new Wd(14,J.FLM1,8,419.68),new Wd(14,J.SBFL1,5,4),new Wd(15,J.SBFT,3,10),new Wd(15,J.FTM,18,783.03),new Wd(16,J.LM3,16,701.89),new Wd(16,J.SBL3,20,8),new Wd(17,J.FLM2,25,932.53),new Wd(18,J.LM2,18,975.06),new Wd(18,J.SBFT,5,11),new Wd(19,J.SBL1,1,20),new Wd(19,J.LM1,3,1008.79),new Wd(19,J.LM3,8,908.79),new Wd(19,J.SBL3,3,12),new Wd(20,J.SBFT,4,11),new Wd(20,J.SBFL1,2,9)],a=[J.TBOTTLE,J.TSTAR,J.TARROW],o=[new xd(7,23,10,J.TSTAR,se.KILLMONSTER,-30),new xd(5,12,10,J.TBOTTLE,se.BUILDTOWER,3),new Nd(4,4,20,120,se.KILLOBJECT,4,",B1Ob1,B1Ob2,B1Ob3,B1Ob4,")],A=Gd.create(2,20,580,1,3,"level 23",a,r,1,o,l.p(2*n+226*s,421*s)),r=[new Wd(1,J.LM1,10,1),new Wd(2,J.LM2,6,11.03),new Wd(2,J.LM1,4,11.03),new Wd(3,J.LM3,5,22.06),new Wd(3,J.LM2,5,22.06),new Wd(4,J.LM1,7,33.09),new Wd(4,J.FLM1,3,23.16),new Wd(5,J.FLM1,10,61.77),new Wd(6,J.FTM,10,132.36),new Wd(6,J.FLM2,3,77.21),new Wd(7,J.LM3,10,138.98),new Wd(7,J.FLM2,5,97.29),new Wd(8,J.FLM1,8,120.45),new Wd(8,J.FLM2,8,120.45),new Wd(9,J.LM2,10,207.37),new Wd(9,J.FTM,10,248.84),new Wd(10,J.SBL1,1,10),new Wd(10,J.LM1,35,551.49),new Wd(11,J.SBL2,6,10),new Wd(11,J.LM2,10,311.05),new Wd(12,J.FLM1,8,440),new Wd(12,J.SBFL2,8,9.85),new Wd(13,J.SBL3,5,12),new Wd(13,J.SBFL1,5,10.8),new Wd(14,J.FTM,10,1684.79),new Wd(14,J.SBFT,3,15),new Wd(14,J.FTM,5,1684.79),new Wd(15,J.FLM2,20,1159.06),new Wd(16,J.LM1,10,1839.22),new Wd(16,J.LM2,12,1839.22),new Wd(17,J.LM3,15,1887.75),new Wd(18,J.LM1,8,1920),new Wd(18,J.SBL2,5,23),new Wd(18,J.FLM1,5,1344.59),new Wd(19,J.FTM,20,2488),new Wd(20,J.SBL1,3,38),new Wd(20,J.SBL2,2,30),new Wd(20,J.SBL3,5,30),new Wd(21,J.LM2,10,2205.42),new Wd(21,J.FLM1,5,1543.79),new Wd(22,J.BMT,1,15),new Wd(22,J.FLM2,15,1600)],a=[J.TROCKET,J.TICEFAN,J.TARROW],o=[new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-30),new xd(14,18,10,J.TROCKET,se.BUILDTOWER,9),new Nd(4,2,20,220,se.KILLOBJECT,2,",L2Ob1,L2Ob2,")],O=Gd.create(2,22,1e3,1,3,"level 24",a,r,1,o,l.p(2*n+442*s,441*s)),r=[new Wd(1,J.LM1,4,10),new Wd(1,J.LM2,4,10),new Wd(2,J.LM3,4,20),new Wd(2,J.LM2,4,20),new Wd(3,J.FLM1,2,20),new Wd(3,J.LM2,6,30),new Wd(4,J.FLM2,2,25),new Wd(4,J.FTM,6,45),new Wd(5,J.FLM1,6,80),new Wd(5,J.FLM2,4,80),new Wd(6,J.LM3,4,200),new Wd(6,J.LM1,6,200),new Wd(7,J.FLM2,4,150),new Wd(7,J.FTM,6,300),new Wd(8,J.LM1,5,350),new Wd(8,J.FTM,5,500),new Wd(9,J.FTM,8,600),new Wd(9,J.FLM1,2,400),new Wd(10,J.FLM1,7,600),new Wd(10,J.SBL2,1,18),new Wd(11,J.FLM1,4,700),new Wd(11,J.FLM2,4,700),new Wd(12,J.LM2,4,1e3),new Wd(12,J.LM3,4,1e3),new Wd(13,J.LM3,6,1500),new Wd(13,J.FTM,2,1500),new Wd(14,J.LM1,2,2e3),new Wd(14,J.LM3,6,2e3),new Wd(15,J.LM1,5,2220),new Wd(15,J.LM2,5,2220),new Wd(16,J.FLM1,5,1530),new Wd(16,J.FLM2,5,1530),new Wd(17,J.LM2,5,2500),new Wd(17,J.FTM,5,3200),new Wd(18,J.FLM1,5,1630),new Wd(18,J.FTM,15,3300),new Wd(19,J.LM2,16,2640),new Wd(19,J.LM3,4,2700),new Wd(20,J.SBL3,5,65),new Wd(21,J.LM1,4,2900),new Wd(21,J.LM3,14,2920),new Wd(22,J.FLM1,8,1750),new Wd(22,J.FLM2,8,1800),new Wd(23,J.LM1,16,3100),new Wd(23,J.LM3,2,3100),new Wd(24,J.LM2,6,3400),new Wd(24,J.FTM,12,3700),new Wd(25,J.LM1,15,2600),new Wd(25,J.FLM2,5,1700),new Wd(25,J.SBFL2,1,65)],a=[J.TRANDOM],o=[new xd(13,23,10,J.TARROW,se.KILLMONSTER,-120),new xd(14,6,20,J.TROCKET,se.BUILDTOWER,-6),new Nd(4,1,10,90,se.KILLOBJECT,1,",BC1Ob1,BC1Ob2,BC1Ob3,BC1Ob4,")],I=Gd.create(2,25,800,1,3,"level 25",a,r,1,o,l.p(2*n+548*s,250*s)),r=[new Wd(1,1,J.LM2,8,5),new Wd(1,2,J.LM3,8,5),new Wd(2,1,J.LM1,10,15),new Wd(2,2,J.LM1,10,15),new Wd(3,1,J.LM3,10,20),new Wd(3,2,J.LM2,10,20),new Wd(4,1,J.FTM,10,45),new Wd(4,2,J.FTM,10,45),new Wd(5,1,J.FLM1,10,40),new Wd(5,2,J.FLM1,10,40),new Wd(6,1,J.FTM,8,100),new Wd(6,1,J.FLM2,3,50),new Wd(6,2,J.FTM,8,100),new Wd(6,2,J.FLM2,3,50),new Wd(7,1,J.FLM1,6,120),new Wd(7,1,J.FLM2,6,120),new Wd(7,2,J.FLM1,6,120),new Wd(7,2,J.FLM2,6,120),new Wd(8,1,J.SBL1,1,8),new Wd(8,2,J.SBL1,1,8),new Wd(9,1,J.LM2,7,232),new Wd(9,1,J.LM3,7,240),new Wd(9,2,J.LM2,7,232),new Wd(9,2,J.LM3,7,240),new Wd(10,1,J.SBFT,2,10),new Wd(10,2,J.SBFT,2,9.9),new Wd(11,1,J.LM1,10,262),new Wd(11,1,J.SBFL1,3,2.9),new Wd(11,2,J.LM1,10,255),new Wd(11,2,J.SBFL1,3,2.9),new Wd(12,1,J.SBFL2,3,8.3),new Wd(12,2,J.SBFL2,3,8.3),new Wd(13,1,J.LM1,7,800),new Wd(13,1,J.LM3,7,818),new Wd(13,2,J.LM1,7,800),new Wd(13,2,J.LM3,7,818),new Wd(14,1,J.LM2,6,920),new Wd(14,1,J.FTM,8,1220),new Wd(14,2,J.LM2,6,920),new Wd(14,2,J.FTM,8,1220),new Wd(15,1,J.SBL1,1,16.5),new Wd(15,1,J.SBL2,1,17.5),new Wd(15,1,J.SBL3,1,21),new Wd(15,2,J.SBL1,1,17),new Wd(15,2,J.SBL2,1,19),new Wd(15,2,J.SBL3,1,23),new Wd(16,1,J.FTM,5,1500),new Wd(16,2,J.FTM,5,1500),new Wd(16,2,J.FLM1,5,630),new Wd(16,2,J.FLM2,5,630),new Wd(17,1,J.SBL1,4,22),new Wd(17,1,J.SBL3,4,20),new Wd(17,2,J.SBFL1,4,10),new Wd(18,1,J.BMT,1,10),new Wd(18,2,J.BMT,1,10)],a=[J.TSHIT,J.TBALL,J.TARROW],o=[new xd(13,23,10,J.TARROW,se.KILLMONSTER,-90),new xd(6,22,10,J.TSHIT,se.BUILDTOWER,1),new Nd(4,23,20,70,se.FINDTOWER,-8,"tsun,")],R=Gd.create(2,18,750,1,3,"level 26",a,r,1,o,l.p(2*n+682*s,74*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(1,J.LM3,5,10),new Wd(2,J.FLM1,5,9.98),new Wd(2,J.FLM2,5,9.98),new Wd(2,J.LM3,5,14.25),new Wd(3,J.LM1,5,28.51),new Wd(3,J.LM2,5,28.51),new Wd(3,J.FTM,5,34.21),new Wd(4,J.FLM1,5,29.93),new Wd(4,J.LM1,5,42.76),new Wd(4,J.FLM2,5,29.93),new Wd(5,J.FLM1,5,80.82),new Wd(5,J.FLM2,5,81.82),new Wd(5,J.FTM,5,140.84),new Wd(6,J.FTM,5,180.05),new Wd(6,J.FLM1,5,99.78),new Wd(6,J.LM3,5,150.54),new Wd(7,J.LM3,5,180.04),new Wd(7,J.LM2,5,171.04),new Wd(7,J.LM1,5,171.04),new Wd(8,J.LM3,5,200.55),new Wd(8,J.LM2,5,201.55),new Wd(8,J.FTM,5,240.46),new Wd(9,J.LM2,5,230.06),new Wd(9,J.FLM1,5,161.64),new Wd(9,J.LM3,5,233.06),new Wd(10,J.FLM1,5,180.6),new Wd(10,J.FLM2,5,185.6),new Wd(10,J.SBL1,5,15),new Wd(10,J.SBL2,5,15),new Wd(11,J.LM1,10,812.63),new Wd(11,J.LM2,10,815.63),new Wd(12,J.FLM2,10,870.28),new Wd(12,J.LM3,10,980.98),new Wd(13,J.LM1,10,1100.32),new Wd(13,J.FTM,10,1440),new Wd(14,J.FTM,14,1550.6),new Wd(14,J.FLM1,6,610.76),new Wd(15,J.LM1,5,1575.01),new Wd(15,J.LM2,5,1575.01),new Wd(15,J.SBFL1,3,15.5),new Wd(16,J.FLM1,5,950.91),new Wd(16,J.FLM2,5,960.91),new Wd(16,J.LM1,5,1350.15),new Wd(16,J.LM3,5,1353.15),new Wd(17,J.FTM,5,1750.59),new Wd(17,J.FLM1,5,1100.51),new Wd(17,J.FLM2,5,1260.51),new Wd(17,J.LM3,5,1872.16),new Wd(18,J.FLM1,5,1490.12),new Wd(18,J.FLM2,5,1500.12),new Wd(18,J.LM1,1,1960.17),new Wd(18,J.LM2,2,2220.17),new Wd(19,J.LM1,5,1900.98),new Wd(19,J.LM2,5,1550.98),new Wd(19,J.LM3,5,1845.98),new Wd(19,J.FTM,5,1750.57),new Wd(20,J.FLM1,5,1531.69),new Wd(20,J.FLM2,5,1030.69),new Wd(20,J.LM3,5,1971.99),new Wd(20,J.SBFT,1,40)],a=[J.TPLANE,J.TICEFAN],o=[new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-130),new xd(10,11,10,J.TICEFAN,se.BUILDTOWER,2),new Nd(4,23,20,120,se.FINDTOWER,-2,"tarrow,")],D=Gd.create(2,20,550,1,3,"level 27",a,r,1.2,o,l.p(2*n+887*s,163*s)),r=[new Wd(1,J.LM1,8,2230),new Wd(1,J.SBL1,2,38),new Wd(1,J.LM1,8,2250.27),new Wd(2,J.SBL3,5,43),new Wd(2,J.LM3,10,2600),new Wd(2,J.FTM,10,3100),new Wd(3,J.FLM1,3,2330),new Wd(3,J.SBFL1,1,33),new Wd(3,J.FLM1,4,2330),new Wd(4,J.SBFL1,2,33),new Wd(4,J.FLM1,3,2340),new Wd(4,J.SBFL1,2,34),new Wd(5,J.FTM,5,3850),new Wd(5,J.SBFT,1,58),new Wd(5,J.FTM,10,3950.24),new Wd(5,J.BM3,1,80)],a=[J.TSTAR],o=[new xd(9,23,10,J.TBALL,se.KILLMONSTER,-10),new xd(7,13,10,J.TSTAR,se.BUILDTOWER,4),new Nd(4,23,10,60,se.FINDTOWER,-12,"tplane,")],x=Gd.create(2,5,9999,1,3,"level 28",a,r,.9,o,l.p(2*n+816*s,301*s),110),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(2,J.LM3,4,15),new Wd(2,J.LM2,6,15),new Wd(3,J.FLM1,5,15),new Wd(3,J.FLM2,5,15),new Wd(4,J.LM2,5,50),new Wd(4,J.LM3,5,50),new Wd(5,J.LM1,4,60),new Wd(5,J.LM2,4,60),new Wd(5,J.LM3,4,60),new Wd(6,J.LM1,5,110),new Wd(6,J.LM2,5,110),new Wd(7,J.LM3,5,160),new Wd(7,J.LM2,5,160),new Wd(8,J.FLM1,5,120),new Wd(8,J.FLM2,5,120),new Wd(9,J.LM3,6,220),new Wd(9,J.LM1,6,220),new Wd(10,J.LM2,4,320),new Wd(10,J.LM1,4,320),new Wd(10,J.SBL1,1,10),new Wd(11,J.LM1,7,400),new Wd(11,J.LM2,7,400),new Wd(12,J.FLM1,7,250),new Wd(12,J.FLM2,7,250),new Wd(13,J.SBL1,1,14),new Wd(13,J.SBFT,1,18),new Wd(14,J.LM1,5,600),new Wd(14,J.LM2,5,600),new Wd(15,J.LM3,5,700),new Wd(15,J.FTM,5,1e3),new Wd(15,J.LM1,5,700),new Wd(15,J.LM2,5,700),new Wd(16,J.FTM,15,900),new Wd(17,J.FTM,15,900),new Wd(18,J.LM1,10,800),new Wd(18,J.FLM1,10,600),new Wd(19,J.FLM1,5,800),new Wd(19,J.LM3,10,1e3),new Wd(20,J.SBL2,3,18),new Wd(20,J.SBL3,3,20),new Wd(20,J.SBL1,3,22)],a=[J.TBALL,J.TMOON,J.TARROW],o=[new xd(1,10,20,J.TOWEREND,se.KILLMONSTER,-200),new Nd(4,23,10,180,se.FINDTOWER,-4,"tplane,"),new Nd(4,3,10,120,se.KILLOBJECT,3,",L2Ob1,L2Ob2,L2Ob3,")],N=Gd.create(2,20,1500,1,3,"level 29",a,r,.7,o,l.p(2*n+726*s,441*s),0,1,2e5),r=[new Wd(1,J.FTM,10,10),new Wd(2,J.LM3,10,15.98),new Wd(3,J.LM2,4,31.95),new Wd(3,J.FTM,6,38.35),new Wd(4,J.LM3,5,47.93),new Wd(4,J.LM1,5,47.93),new Wd(5,J.LM2,10,127.82),new Wd(5,J.SBL3,1,2.5),new Wd(5,J.LM3,10,127.82),new Wd(6,J.LM2,8,230.08),new Wd(6,J.FTM,2,276.09),new Wd(7,J.LM3,6,262.03),new Wd(7,J.FLM1,4,183.42),new Wd(8,J.FLM1,8,205.79),new Wd(8,J.FLM2,8,205.79),new Wd(9,J.LM1,10,305.11),new Wd(9,J.LM2,6,305.11),new Wd(10,J.FLM1,5,227.37),new Wd(10,J.SBFT,1,18),new Wd(10,J.LM1,5,396.24),new Wd(11,J.LM3,2,466.54),new Wd(11,J.FLM2,8,256.58),new Wd(11,J.SBB,1,70),new Wd(12,J.LM1,8,604.34),new Wd(12,J.FLM1,2,326.04),new Wd(13,J.LM2,6,822.13),new Wd(13,J.FTM,4,906.56),new Wd(14,J.SBL3,10,10),new Wd(15,J.FLM1,5,664.4),new Wd(15,J.FLM2,5,664.4),new Wd(15,J.SBFL1,30,6),new Wd(16,J.LM2,5,1900),new Wd(16,J.FLM2,5,1e3),new Wd(16,J.LM1,5,1900),new Wd(17,J.LM3,6,1950),new Wd(17,J.LM2,6,1950),new Wd(17,J.FLM2,3,1e3),new Wd(18,J.FLM1,5,1259.38),new Wd(18,J.FTM,5,2501.8),new Wd(18,J.LM3,5,2084.84),new Wd(19,J.FLM2,5,1292.94),new Wd(19,J.LM2,5,2132.77)],a=[J.TSHIT,J.TARROW,J.TROCKET,J.TPLANE],o=[new xd(13,23,10,J.TARROW,se.KILLMONSTER,-100),new Nd(4,10,10,350,se.KILLOBJECT,25,""),new Nd(3,25,10,190,se.EARNMONEY,-4500)],G=Gd.create(2,19,420,1,3,"level 30",a,r,1,o,l.p(2*n+887*s,509*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(2,J.LM1,8,10),new Wd(2,J.FLM1,2,10),new Wd(3,J.LM1,5,16),new Wd(3,J.LM2,5,16),new Wd(4,J.FTM,5,42.05),new Wd(4,J.LM1,5,35.04),new Wd(5,J.LM3,5,108.16),new Wd(5,J.FTM,5,129.79),new Wd(6,J.LM1,5,120),new Wd(6,J.LM2,5,120),new Wd(7,J.FLM1,5,120),new Wd(7,J.LM1,5,180),new Wd(8,J.LM1,5,200),new Wd(8,J.LM3,5,200),new Wd(9,J.LM2,8,250),new Wd(9,J.FLM2,2,150),new Wd(10,J.SBL1,1,14),new Wd(11,J.LM1,5,340),new Wd(11,J.LM2,5,340),new Wd(11,J.LM3,5,340),new Wd(12,J.LM3,5,390),new Wd(12,J.LM2,5,390),new Wd(12,J.FTM,5,450),new Wd(13,J.FLM1,5,300),new Wd(13,J.FLM2,5,300),new Wd(14,J.FLM1,5,330),new Wd(14,J.FLM2,5,330),new Wd(15,J.SBFL1,1,16),new Wd(16,J.LM2,3,450),new Wd(16,J.FLM1,2,350),new Wd(16,J.LM1,10,450),new Wd(17,J.LM3,8,500),new Wd(17,J.LM2,8,500),new Wd(18,J.FTM,2,700),new Wd(18,J.LM2,8,550),new Wd(18,J.SBFT,1,23),new Wd(19,J.LM3,8,680),new Wd(19,J.FTM,2,750),new Wd(20,J.SBL1,5,7.5),new Wd(20,J.LM2,5,600),new Wd(20,J.LM3,5,600),new Wd(21,J.LM1,5,720),new Wd(21,J.LM2,5,720),new Wd(22,J.FTM,5,850.76),new Wd(22,J.LM3,5,780),new Wd(23,J.FLM1,5,500),new Wd(23,J.LM1,5,800),new Wd(24,J.FLM1,5,540),new Wd(24,J.LM2,5,840),new Wd(25,J.FLM1,5,580),new Wd(25,J.LM3,5,880),new Wd(25,J.SBL2,1,25)],a=[J.TBOTTLE,J.TSHIT,J.TSUN,J.TFISH],o=[new xd(8,12,10,J.TSUN,se.BUILDTOWER,3),new xd(16,23,20,J.TFISH,se.KILLMONSTER,-150),new Nd(4,5,10,150,se.KILLOBJECT,5,",S2Ob1,S2Ob2,S2Ob3,S2Ob4,S2Ob5,")],W=Gd.create(3,25,500,1,3,"level 31",a,r,1,o,l.p(3*n+122*s,502*s)),r=[new Wd(1,1,J.LM1,8,10),new Wd(2,2,J.LM2,8,8),new Wd(3,1,J.LM3,4,10),new Wd(3,2,J.LM2,4,15),new Wd(4,1,J.FTM,5,35),new Wd(4,2,J.LM3,4,25),new Wd(5,1,J.LM1,4,45),new Wd(5,1,J.LM2,4,45),new Wd(5,2,J.LM1,4,45),new Wd(5,2,J.LM2,4,45),new Wd(6,1,J.FLM1,6,50),new Wd(7,2,J.FLM2,6,52),new Wd(8,1,J.FLM1,5,55),new Wd(8,2,J.FLM2,5,55),new Wd(9,1,J.FTM,1,144.99),new Wd(9,1,J.FLM1,4,80),new Wd(9,2,J.LM1,1,120),new Wd(9,2,J.FLM2,4,80),new Wd(10,1,J.SBL1,5,2),new Wd(10,2,J.SBL2,5,2),new Wd(11,1,J.LM3,8,200),new Wd(11,2,J.LM2,8,214.42),new Wd(12,1,J.FLM1,6,160),new Wd(12,2,J.FLM2,6,160),new Wd(13,1,J.LM1,5,364.65),new Wd(13,2,J.FLM2,5,355.25),new Wd(14,1,J.LM1,4,430.58),new Wd(14,1,J.FTM,2,636.69),new Wd(14,2,J.LM3,4,430.58),new Wd(14,2,J.LM2,4,430.58),new Wd(15,1,J.SBFL1,1,12),new Wd(15,2,J.SBFL1,1,12),new Wd(16,1,J.LM1,6,583.76),new Wd(16,2,J.LM3,6,583.76),new Wd(17,1,J.LM1,7,604.28),new Wd(17,2,J.LM2,7,604.28),new Wd(18,1,J.FTM,7,809.27),new Wd(18,2,J.FTM,7,809.27),new Wd(19,1,J.LM1,5,701.54),new Wd(19,2,J.FTM,5,847.84),new Wd(20,1,J.FTM,4,855.4),new Wd(20,1,J.SBFT,1,25),new Wd(20,2,J.LM1,5,764.5),new Wd(20,2,J.SBL3,1,18),new Wd(21,1,J.LM1,7,780.26),new Wd(21,2,J.FLM1,7,500.18),new Wd(22,1,J.FTM,5,1004.89),new Wd(22,2,J.LM2,5,852.41),new Wd(23,1,J.LM1,5,535.37),new Wd(23,2,J.FLM1,5,550.76),new Wd(24,1,J.FTM,7,969.99),new Wd(24,2,J.FTM,1,859.99),new Wd(24,2,J.FLM1,5,550),new Wd(25,1,J.SBFL1,4,8),new Wd(25,1,J.BMT,1,7),new Wd(25,2,J.SBL1,4,14),new Wd(25,2,J.BMT,1,6)],a=[J.TSTAR,J.TICEFAN,J.TFISH],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-80),new xd(15,23,20,J.TPLANE,se.KILLMONSTER,-80),new Nd(4,23,10,150,se.FINDTOWER,-20,"")],k=Gd.create(3,25,1e3,1,3,"level 32",a,r,.8,o,l.p(3*n+244*s,397*s)),r=[new Wd(1,J.LM1,20,2e3),new Wd(2,J.FLM1,10,2500),new Wd(2,J.FLM1,10,2500),new Wd(2,J.SBFL1,1,100),new Wd(3,J.FLM1,10,3e3),new Wd(3,J.LM3,10,3600),new Wd(3,J.FTM,10,4e3),new Wd(3,J.BM1,1,120)],a=[J.TICEFAN,J.TFISH],o=[new xd(16,12,20,J.TFISH,se.BUILDTOWER,3),new Nd(4,10,10,60,se.KILLOBJECT,10,""),new Nd(4,23,10,140,se.FINDTOWER,-6,"trocket,")],U=Gd.create(3,3,5e3,1,50,"level 33",a,r,1,o,l.p(3*n+184*s,219*s),210),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(1,J.LM3,5,10),new Wd(2,J.FLM1,5,20),new Wd(2,J.FLM2,5,20),new Wd(2,J.LM3,5,40),new Wd(3,J.LM1,5,50),new Wd(3,J.LM2,5,50),new Wd(3,J.FTM,5,70),new Wd(4,J.FLM1,5,40),new Wd(4,J.LM1,5,70),new Wd(4,J.FLM2,5,40),new Wd(5,J.FLM1,5,80),new Wd(5,J.FLM2,5,80),new Wd(5,J.FTM,5,150),new Wd(6,J.FTM,5,170),new Wd(6,J.FLM1,5,90),new Wd(6,J.LM3,5,150),new Wd(7,J.LM3,5,200),new Wd(7,J.LM2,5,200),new Wd(7,J.LM1,5,200),new Wd(8,J.LM3,5,250),new Wd(8,J.LM2,5,250),new Wd(8,J.FTM,5,320),new Wd(9,J.LM2,5,300),new Wd(9,J.FLM1,5,210),new Wd(9,J.LM3,5,300),new Wd(10,J.FLM1,5,220),new Wd(10,J.FLM2,5,220),new Wd(10,J.SBL1,5,8),new Wd(10,J.SBL2,5,11),new Wd(11,J.LM1,10,700),new Wd(11,J.LM2,10,700),new Wd(12,J.FLM2,10,550),new Wd(12,J.LM3,10,750),new Wd(13,J.LM1,10,800),new Wd(13,J.FTM,10,900),new Wd(14,J.FTM,15,900),new Wd(14,J.FLM1,5,450),new Wd(15,J.LM1,5,900),new Wd(15,J.LM2,5,900),new Wd(15,J.SBFL1,1,16),new Wd(16,J.FLM1,5,700),new Wd(16,J.FLM2,5,700),new Wd(16,J.LM1,5,900),new Wd(16,J.LM3,5,900),new Wd(17,J.FTM,5,1200),new Wd(17,J.FLM1,5,600),new Wd(17,J.FLM2,5,650),new Wd(17,J.LM3,5,1e3),new Wd(18,J.FLM1,5,700),new Wd(18,J.FLM2,5,700),new Wd(18,J.LM1,1,1100),new Wd(18,J.LM2,1,1100),new Wd(19,J.LM1,5,1200),new Wd(19,J.LM2,5,1200),new Wd(19,J.LM3,5,1200),new Wd(19,J.FTM,5,1400),new Wd(20,J.FLM1,5,800),new Wd(20,J.FLM2,5,800),new Wd(20,J.LM3,5,1200),new Wd(20,J.SBFT,1,70)],a=[J.TSHIT,J.TICEFAN,J.TARROW,J.TFLASHLIGHT],o=[new xd(12,5,10,J.TFLASHLIGHT,se.BUILDTOWER,-5),new xd(10,22,20,J.TICEFAN,se.BUILDTOWER,1),new xd(12,23,10,J.TFLASHLIGHT,se.KILLMONSTER,-140)],H=Gd.create(3,20,300,1,3,"level 34",a,r,1,o,l.p(3*n+416*s,205*s)),r=[new Wd(1,J.FTM,10,10),new Wd(2,J.LM3,10,15),new Wd(3,J.LM2,4,20),new Wd(3,J.FTM,6,80.51),new Wd(4,J.LM3,5,40),new Wd(4,J.LM1,5,40),new Wd(5,J.LM2,10,80),new Wd(5,J.LM3,10,80),new Wd(5,J.SBL3,1,3),new Wd(6,J.LM2,8,120),new Wd(6,J.FTM,2,160),new Wd(7,J.LM3,8,200),new Wd(7,J.FLM1,2,120),new Wd(8,J.FLM1,8,170),new Wd(8,J.FLM2,8,170),new Wd(9,J.LM1,4,400),new Wd(9,J.LM2,6,400),new Wd(10,J.FLM1,5,350),new Wd(10,J.LM1,5,500),new Wd(10,J.SBFT,1,20),new Wd(11,J.LM3,2,700.78),new Wd(11,J.FLM2,8,450.35),new Wd(12,J.LM1,8,750.11),new Wd(12,J.FLM1,2,500.18),new Wd(13,J.LM2,6,850.11),new Wd(13,J.FTM,4,1097.73),new Wd(14,J.LM3,5,1e3),new Wd(14,J.LM1,5,1e3),new Wd(15,J.FLM1,5,750),new Wd(15,J.FLM2,5,750),new Wd(15,J.SBFL1,1,17),new Wd(16,J.LM2,5,1100.05),new Wd(16,J.FLM2,5,750.44),new Wd(16,J.LM1,5,1100.05),new Wd(17,J.LM3,6,1200.06),new Wd(17,J.LM2,6,1200.06),new Wd(17,J.FLM2,2,750.94),new Wd(18,J.FLM1,5,900.05),new Wd(18,J.FTM,5,1800.09),new Wd(18,J.LM3,5,1400.07),new Wd(19,J.FLM2,5,1000.16),new Wd(19,J.LM2,5,1500.09),new Wd(20,J.SBFL1,2,25),new Wd(21,J.LM1,5,1600.05),new Wd(21,J.LM2,5,1600.05),new Wd(21,J.LM3,5,1600.05),new Wd(22,J.FLM2,5,1000.07),new Wd(22,J.LM1,5,1700.07),new Wd(22,J.FTM,5,1900.05),new Wd(23,J.FLM1,5,1000.07),new Wd(23,J.FLM2,5,1100.96),new Wd(23,J.LM3,5,1700.09),new Wd(24,J.FLM2,5,1050.07),new Wd(24,J.FTM,5,2000.13),new Wd(24,J.FLM2,5,900.07),new Wd(25,J.LM3,5,1700.13),new Wd(25,J.FLM2,5,1100.49),new Wd(25,J.SBFT,1,90)],a=[J.TBOTTLE,J.TBALL,J.TMOON,J.TFLASHLIGHT],o=[new xd(12,12,10,J.TFLASHLIGHT,se.BUILDTOWER,3),new xd(12,23,20,J.TFLASHLIGHT,se.KILLMONSTER,-120),new Nd(4,4,10,180,se.KILLOBJECT,4,",S2Ob1,S2Ob2,S2Ob3,S2Ob4,")],V=Gd.create(3,25,600,1,3,"level 35",a,r,1,o,l.p(3*n+402*s,507*s)),r=[new Wd(1,J.SBL1,4,65),new Wd(1,J.SBL2,4,70),new Wd(1,J.SBL3,4,95),new Wd(1,J.BM2,1,320)],a=[J.TBOTTLE,J.TSTAR,J.TBALL,J.TFISH],o=[new xd(7,23,20,J.TSTAR,se.KILLMONSTER,-12),new xd(16,23,10,J.TFISH,se.KILLMONSTER,-12),new Nd(4,21,10,999,se.KILLOBJECT,43,"")],z=Gd.create(3,1,6e3,1,40,"level 36",a,r,1,o,l.p(3*n+878*s,452*s),39),r=[new Wd(1,J.LM1,4,5),new Wd(1,J.LM2,4,5),new Wd(2,J.FTM,6,15),new Wd(2,J.FLM1,2,10),new Wd(3,J.FTM,6,25),new Wd(3,J.LM2,2,20),new Wd(4,J.LM1,4,40),new Wd(4,J.LM2,4,30),new Wd(5,J.FLM1,4,30),new Wd(5,J.FLM2,4,30),new Wd(6,J.FLM2,6,40),new Wd(6,J.FTM,2,80),new Wd(7,J.LM2,4,60),new Wd(7,J.LM1,4,60),new Wd(8,J.FLM1,4,60),new Wd(8,J.FLM2,4,60),new Wd(9,J.FTM,2,150),new Wd(9,J.LM1,6,100),new Wd(10,J.LM2,8,150),new Wd(10,J.LM3,8,150),new Wd(11,J.LM2,4,200),new Wd(11,J.LM1,4,200),new Wd(12,J.FLM2,4,160),new Wd(12,J.LM2,4,250),new Wd(13,J.FLM1,4,200),new Wd(13,J.FTM,4,350),new Wd(14,J.LM3,4,350),new Wd(14,J.FTM,4,400),new Wd(15,J.FLM1,10,250.61),new Wd(15,J.FLM2,10,250.61),new Wd(16,J.LM2,8,500.43),new Wd(16,J.FTM,2,600.72),new Wd(17,J.LM3,6,600.33),new Wd(17,J.FTM,4,800.8),new Wd(18,J.LM2,5,650.89),new Wd(18,J.LM1,5,650.89),new Wd(19,J.FLM2,8,400.67),new Wd(19,J.LM1,2,700.45),new Wd(20,J.LM3,4,700),new Wd(20,J.SBFT,1,28),new Wd(21,J.LM3,4,800.19),new Wd(21,J.FTM,6,950),new Wd(22,J.FLM2,5,450),new Wd(22,J.FLM1,5,450),new Wd(23,J.FLM1,6,500.15),new Wd(23,J.LM3,4,900.24),new Wd(24,J.LM2,5,850.37),new Wd(24,J.LM1,5,800),new Wd(25,J.SBL1,5,10),new Wd(25,J.SBFT,5,15)],a=[J.TANCHOR,J.TFISH,J.TICEFAN],o=[new xd(17,4,10,J.TANCHOR,se.BUILDTOWER,-4),new xd(17,23,10,J.TANCHOR,se.KILLMONSTER,-150),new Nd(4,23,20,120,se.FINDTOWER,-7,"tanchor,")],Y=Gd.create(3,25,500,1,3,"level 37",a,r,1,o,l.p(3*n+708*s,392*s)),r=[new Wd(1,1,J.LM1,5,10),new Wd(1,1,J.LM2,5,10),new Wd(2,1,J.LM3,4,12),new Wd(2,1,J.LM2,6,12),new Wd(3,1,J.FLM1,5,20),new Wd(3,1,J.FLM2,5,20),new Wd(4,1,J.LM2,5,35),new Wd(4,1,J.LM3,5,35),new Wd(5,1,J.LM1,4,60),new Wd(5,1,J.LM2,4,60),new Wd(5,1,J.SBL1,1,4),new Wd(6,2,J.LM1,5,120),new Wd(6,2,J.LM2,5,120),new Wd(7,2,J.LM3,5,180),new Wd(7,2,J.LM2,5,180),new Wd(8,2,J.FLM1,5,150),new Wd(8,2,J.FLM2,5,150),new Wd(9,2,J.LM2,5,200),new Wd(9,2,J.LM3,5,200),new Wd(10,2,J.LM1,4,250),new Wd(10,2,J.LM2,4,250),new Wd(10,2,J.SBL1,1,12),new Wd(11,1,J.LM1,8,350),new Wd(11,2,J.LM2,8,350),new Wd(12,1,J.FLM1,10,250),new Wd(12,2,J.FLM2,10,250),new Wd(13,1,J.SBFL1,1,16),new Wd(13,2,J.SBFT,1,35),new Wd(14,1,J.LM1,5,1e3),new Wd(14,1,J.LM2,5,1e3),new Wd(14,2,J.LM1,5,1e3),new Wd(14,2,J.LM2,5,1e3),new Wd(15,1,J.LM1,5,1300),new Wd(15,1,J.FTM,5,2400),new Wd(15,2,J.LM2,5,1300),new Wd(15,2,J.LM3,5,2400),new Wd(16,1,J.FTM,15,2500),new Wd(17,2,J.FTM,15,2400),new Wd(18,1,J.LM1,10,2800.46),new Wd(18,2,J.FLM1,6,1300),new Wd(19,1,J.FLM1,5,1500),new Wd(19,2,J.LM3,10,2700),new Wd(20,1,J.SBL1,5,20),new Wd(20,1,J.SBL2,5,25),new Wd(20,1,J.SBL3,5,32),new Wd(20,2,J.SBFL1,5,14),new Wd(20,2,J.SBFL2,5,18),new Wd(20,2,J.SBFT,5,45)],a=[J.TSHIT,J.TPLANE,J.TARROW,J.TANCHOR],o=[new xd(15,12,10,J.TPLANE,se.BUILDTOWER,3),new xd(13,23,20,J.TARROW,se.KILLMONSTER,-120),new Nd(3,8,10,320,se.KILLOBJECT,8,",SC1Ob1,SC1Ob2,SC1Ob3,SC1Ob4,BC1Ob1,BC1Ob2,BC1Ob3,BC1Ob4,")],X=Gd.create(3,20,1500,1,3,"level 38",a,r,1.2,o,l.p(3*n+558*s,320*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(1,J.LM3,5,10),new Wd(2,J.LM2,5,50),new Wd(2,J.LM3,5,50),new Wd(2,J.LM1,5,50),new Wd(3,J.FLM1,8,50),new Wd(3,J.LM3,4,90),new Wd(3,J.LM2,3,90),new Wd(4,J.LM1,2,120),new Wd(4,J.FLM2,7,80),new Wd(4,J.FLM1,6,80),new Wd(5,J.LM1,6,180),new Wd(5,J.FTM,2,280),new Wd(5,J.LM3,7,180),new Wd(6,J.LM3,5,250),new Wd(6,J.FTM,4,320),new Wd(6,J.LM2,6,250),new Wd(7,J.LM3,5,300),new Wd(7,J.LM2,5,300),new Wd(7,J.LM1,5,300),new Wd(8,J.FLM2,5,250),new Wd(8,J.LM1,8,350),new Wd(8,J.FLM1,2,200),new Wd(9,J.LM1,3,450),new Wd(9,J.FLM1,6,300),new Wd(9,J.FLM2,6,300),new Wd(10,J.LM2,10,520),new Wd(10,J.LM1,10,520),new Wd(10,J.LM3,10,520),new Wd(11,J.LM3,6,800),new Wd(11,J.FLM1,4,600),new Wd(11,J.LM1,5,800),new Wd(12,J.FLM1,5,640),new Wd(12,J.FLM2,5,640),new Wd(12,J.LM1,5,880),new Wd(13,J.FLM1,4,700),new Wd(13,J.LM1,6,950),new Wd(13,J.LM3,5,950),new Wd(14,J.LM2,5,1e3),new Wd(14,J.FLM2,4,900),new Wd(14,J.LM1,6,1e3),new Wd(15,J.SBFL1,1,25),new Wd(15,J.FLM1,10,950),new Wd(15,J.FLM2,10,950),new Wd(16,J.LM3,5,1400),new Wd(16,J.LM1,5,1400),new Wd(16,J.FTM,5,1550),new Wd(17,J.LM2,8,1900),new Wd(17,J.FLM2,4,850),new Wd(17,J.FLM1,3,900),new Wd(18,J.LM1,5,2e3),new Wd(18,J.LM2,5,1800),new Wd(18,J.LM3,5,1700),new Wd(19,J.FLM2,5,1200),new Wd(19,J.FLM1,5,1200),new Wd(19,J.LM1,5,2050),new Wd(20,J.SBL1,1,30),new Wd(20,J.LM1,4,2e3),new Wd(20,J.SBL2,1,40),new Wd(20,J.LM1,4,2e3),new Wd(20,J.SBL3,1,48),new Wd(20,J.LM3,4,1900),new Wd(21,J.FLM1,3,1100),new Wd(21,J.LM2,2,2200),new Wd(21,J.FLM1,10,1e3),new Wd(22,J.LM3,3,2300),new Wd(22,J.LM1,2,2300),new Wd(22,J.FTM,10,2500),new Wd(23,J.FLM2,5,1350),new Wd(23,J.LM2,5,2300),new Wd(23,J.LM3,5,2300),new Wd(24,J.FLM1,5,1400),new Wd(24,J.FLM2,5,1400),new Wd(24,J.FTM,5,2400),new Wd(25,J.FLM1,10,1450),new Wd(25,J.LM2,5,2100),new Wd(25,J.BMT,1,21)],a=[J.TROCKET,J.TPLANE,J.TMOON,J.TFISH,J.TANCHOR],o=[new xd(5,23,20,J.TBOTTLE,se.KILLMONSTER,-150),new xd(16,23,10,J.TFISH,se.KILLMONSTER,-220),new Nd(4,23,10,240,se.FINDTOWER,-10,"tbottle,")],j=Gd.create(3,25,1e3,1,3,"level 39",a,r,1.5,o,l.p(3*n+667*s,162*s)),r=[new Wd(1,J.LM1,10,2e3),new Wd(1,J.SBL1,1,120),new Wd(2,J.LM2,10,2400),new Wd(2,J.SBL2,1,160),new Wd(3,J.FLM1,10,2500),new Wd(3,J.SBFL1,1,180),new Wd(4,J.FLM2,10,2800),new Wd(4,J.SBFL2,1,200),new Wd(5,J.FTM,10,3e3),new Wd(5,J.BM3,1,470)],a=[J.TSTAR,J.TMOON,J.TROCKET],o=[new xd(14,14,10,J.TROCKET,se.BUILDTOWER,5),new Nd(4,23,10,220,se.FINDTOWER,-30,""),new Nd(3,25,10,120,se.EARNMONEY,-9999)],K=Gd.create(3,5,1e3,1,50,"level 40",a,r,1,o,l.p(3*n+850*s,162*s),300),r=[new Wd(1,J.LM1,10,10),new Wd(1,J.LM2,10,10),new Wd(2,J.FLM1,10,40),new Wd(2,J.FLM2,10,40),new Wd(3,J.LM3,10,90),new Wd(3,J.FTM,10,105),new Wd(4,J.FLM1,10,80),new Wd(4,J.LM3,10,100),new Wd(5,J.LM3,10,200),new Wd(5,J.LM2,10,200),new Wd(5,J.LM1,10,200),new Wd(6,J.LM2,10,250),new Wd(6,J.LM3,10,250),new Wd(7,J.LM1,10,320),new Wd(7,J.LM3,10,320),new Wd(8,J.FLM1,10,320),new Wd(8,J.LM1,10,380),new Wd(9,J.FTM,5,650),new Wd(9,J.FLM1,15,400),new Wd(10,J.LM2,10,600),new Wd(10,J.FLM1,5,420),new Wd(10,J.SBL1,5,13),new Wd(11,J.LM1,10,750),new Wd(11,J.LM2,10,750),new Wd(12,J.FLM1,10,650),new Wd(12,J.FLM2,10,650),new Wd(13,J.LM2,10,800),new Wd(13,J.LM3,10,800),new Wd(14,J.FLM2,10,700),new Wd(14,J.FLM1,10,700),new Wd(15,J.SBFL1,1,42),new Wd(16,J.LM1,15,900),new Wd(16,J.FTM,2,1200),new Wd(16,J.FLM1,3,700),new Wd(17,J.LM1,10,1100),new Wd(17,J.FTM,5,1300),new Wd(17,J.LM3,5,1e3),new Wd(18,J.FLM1,10,800),new Wd(18,J.FLM2,10,800),new Wd(19,J.LM1,10,1200),new Wd(19,J.LM3,10,1200),new Wd(20,J.FLM2,10,900),new Wd(20,J.FTM,10,1350),new Wd(20,J.SBFL1,1,35)],a=[J.TCUTTLE,J.TBOTTLE,J.TSHIT],o=[new xd(18,5,10,J.TCUTTLE,se.BUILDTOWER,-5),new xd(5,23,20,J.TBOTTLE,se.KILLMONSTER,-80),new Nd(4,10,10,240,se.KILLOBJECT,11,",S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,S1Ob7,S1Ob8,S1Ob9,S1Ob0,S1Ob10,S1Ob11,")],q=Gd.create(3,20,500,1,3,"level 41",a,r,2,o,l.p(4*n+81*s,78*s)),r=[new Wd(1,1,J.LM1,10,25),new Wd(1,2,J.LM1,10,25),new Wd(2,1,J.FTM,10,65),new Wd(2,2,J.FLM2,10,42),new Wd(3,1,J.LM3,10,80),new Wd(3,2,J.LM2,10,80),new Wd(4,1,J.LM3,10,110),new Wd(4,2,J.FTM,10,120),new Wd(5,1,J.LM1,10,300),new Wd(5,1,J.LM2,10,260),new Wd(5,2,J.SBL1,1,12),new Wd(6,1,J.FLM1,20,260),new Wd(6,2,J.SBFT,1,30),new Wd(7,1,J.FLM1,10,400),new Wd(7,1,J.FTM,15,650),new Wd(7,2,J.SBFL1,1,18),new Wd(7,2,J.SBFT,1,48),new Wd(8,1,J.LM1,10,1100),new Wd(8,2,J.LM1,5,1100),new Wd(9,1,J.FLM1,8,400),new Wd(9,1,J.FLM2,8,400),new Wd(9,2,J.SBFT,2,46),new Wd(9,2,J.LM1,8,500),new Wd(10,1,J.SBFL1,1,22),new Wd(10,2,J.SBFL1,1,30),new Wd(11,1,J.LM2,20,900),new Wd(11,2,J.LM2,10,900),new Wd(12,1,J.LM1,5,900),new Wd(12,1,J.SBL1,1,26),new Wd(12,2,J.LM1,5,700),new Wd(12,2,J.SBL1,1,50),new Wd(13,1,J.LM1,4,1e3),new Wd(13,1,J.FTM,2,1600),new Wd(13,2,J.SBFL1,1,25),new Wd(13,2,J.SBFT,1,55),new Wd(14,1,J.LM1,4,1200),new Wd(14,1,J.FTM,2,1800),new Wd(14,2,J.FTM,4,1600),new Wd(15,1,J.BMT,1,10),new Wd(15,2,J.BMT,1,10)],a=[J.TROCKET,J.TFLASHLIGHT,J.TPLANE,J.TFISH,J.TANCHOR,J.TCUTTLE],o=[new xd(15,22,10,J.TPLANE,se.BUILDTOWER,1),new xd(12,23,10,J.TFLASHLIGHT,se.KILLMONSTER,-100),new Nd(4,4,10,150,se.KILLOBJECT,4,",S1Ob1,S1Ob2,S1Ob3,S1Ob4,")],Q=Gd.create(3,15,3e4,1,3,"level 42",a,r,1.2,o,l.p(4*n+253*s,104*s)),r=[new Wd(1,J.FLM1,5,10),new Wd(1,J.FLM2,5,10),new Wd(2,J.LM3,5,20),new Wd(2,J.LM1,5,20),new Wd(3,J.LM3,5,30),new Wd(3,J.LM2,5,30),new Wd(4,J.LM1,5,45),new Wd(4,J.LM2,5,45),new Wd(5,J.FLM1,5,50),new Wd(5,J.LM3,5,80),new Wd(6,J.FLM1,6,80),new Wd(6,J.FLM2,6,80),new Wd(7,J.LM2,6,140),new Wd(7,J.LM3,6,140),new Wd(8,J.FTM,8,220),new Wd(8,J.FLM2,4,140),new Wd(9,J.LM2,8,300),new Wd(9,J.FLM1,4,160),new Wd(10,J.LM1,6,400),new Wd(10,J.LM3,6,400),new Wd(10,J.SBFL1,1,12),new Wd(11,J.LM2,7,500),new Wd(11,J.FTM,7,700),new Wd(11,J.SBL2,1,22),new Wd(12,J.FLM2,7,600),new Wd(12,J.FTM,7,1e3),new Wd(13,J.FLM1,7,650),new Wd(13,J.FLM2,7,650),new Wd(14,J.FLM2,7,800),new Wd(14,J.LM1,7,1200),new Wd(15,J.LM1,7,1200),new Wd(15,J.FLM2,5,650),new Wd(15,J.SBFT,1,60),new Wd(16,J.FLM2,8,900),new Wd(16,J.LM2,8,1200),new Wd(17,J.FLM2,8,1e3),new Wd(17,J.LM2,8,1300),new Wd(18,J.LM3,13,1300),new Wd(18,J.FLM2,2,750),new Wd(19,J.FLM1,8,1e3),new Wd(19,J.FLM2,8,950),new Wd(20,J.LM1,8,1400),new Wd(20,J.FTM,8,1600),new Wd(20,J.BMT,1,19)],a=[J.TSHIT,J.TICEFAN,J.TMOON],o=[new xd(11,22,10,J.TMOON,se.BUILDTOWER,1),new xd(18,23,10,J.TCUTTLE,se.KILLMONSTER,-60),new Nd(4,10,20,200,se.KILLOBJECT,30,"")],Z=Gd.create(3,20,600,1,3,"level 43",a,r,1,o,l.p(4*n+442*s,151*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(2,J.LM1,5,20),new Wd(2,J.LM2,5,15),new Wd(3,J.LM3,5,35),new Wd(3,J.LM1,5,25),new Wd(4,J.FTM,10,50),new Wd(5,J.FLM1,5,80),new Wd(5,J.FLM2,5,80),new Wd(5,J.FTM,5,250),new Wd(6,J.LM1,5,250),new Wd(6,J.LM2,5,250),new Wd(6,J.LM3,5,250),new Wd(7,J.FLM1,8,250),new Wd(7,J.LM3,5,400),new Wd(7,J.FLM2,2,300),new Wd(8,J.LM3,3,600),new Wd(8,J.FLM1,6,400),new Wd(8,J.FLM2,6,450),new Wd(9,J.LM1,5,900),new Wd(9,J.LM2,5,900),new Wd(9,J.FTM,5,1100),new Wd(10,J.SBFL1,1,20),new Wd(10,J.SBFL2,1,20),new Wd(11,J.LM3,8,1300),new Wd(11,J.LM1,8,1300),new Wd(11,J.FLM2,3,900),new Wd(12,J.FLM1,8,1e3),new Wd(12,J.FLM2,8,1e3),new Wd(12,J.FTM,6,1600),new Wd(13,J.FTM,3,2e3),new Wd(13,J.FLM2,6,1100),new Wd(13,J.LM3,9,1500),new Wd(14,J.LM1,6,1600),new Wd(14,J.LM2,6,1600),new Wd(14,J.FTM,6,2100),new Wd(15,J.LM2,8,1800),new Wd(15,J.LM3,8,1800),new Wd(15,J.SBFT,1,60),new Wd(16,J.FTM,7,2300),new Wd(16,J.LM2,7,2e3),new Wd(16,J.FLM1,7,1400),new Wd(17,J.LM1,7,2200),new Wd(17,J.LM2,7,2200),new Wd(17,J.LM3,7,2200),new Wd(18,J.FLM1,7,1800),new Wd(18,J.FLM2,7,1800),new Wd(18,J.LM3,7,2300),new Wd(19,J.FLM1,7,1850),new Wd(19,J.FLM2,7,1850),new Wd(19,J.LM1,7,2400),new Wd(20,J.FLM1,7,1850),new Wd(20,J.FLM2,7,1850),new Wd(20,J.FTM,7,2600),new Wd(20,J.SBFT,1,180)],a=[J.TRANDOM],o=[new xd(10,12,10,J.TICEFAN,se.BUILDTOWER,-3),new xd(16,23,20,J.TFISH,se.KILLMONSTER,-100),new Nd(3,25,10,240,se.EARNMONEY,-12e3)],$=Gd.create(3,20,620,1,3,"level 44",a,r,1.6,o,l.p(4*n+608*s,189*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(2,J.LM2,5,15),new Wd(2,J.LM1,5,15),new Wd(3,J.LM2,4,20),new Wd(3,J.LM3,6,20),new Wd(4,J.LM3,6,25),new Wd(4,J.LM1,4,25),new Wd(5,J.FTM,10,100),new Wd(6,J.FLM1,5,70),new Wd(6,J.FLM2,5,70),new Wd(7,J.FLM1,4,90),new Wd(7,J.FLM2,6,90),new Wd(8,J.LM1,6,150),new Wd(8,J.LM3,4,150),new Wd(9,J.LM2,4,220),new Wd(9,J.LM3,6,220),new Wd(10,J.LM1,5,400),new Wd(10,J.LM2,5,400),new Wd(10,J.SBL1,1,13),new Wd(11,J.LM2,5,450),new Wd(11,J.LM3,5,450),new Wd(12,J.FTM,8,700),new Wd(12,J.FLM2,2,280),new Wd(13,J.FLM1,5,300),new Wd(13,J.FLM2,5,300),new Wd(14,J.LM3,2,700),new Wd(14,J.FLM1,8,400),new Wd(15,J.SBFL1,4,13),new Wd(16,J.LM2,5,900),new Wd(16,J.LM3,5,900),new Wd(17,J.LM1,5,1100),new Wd(17,J.LM2,5,1100),new Wd(18,J.FLM1,4,700),new Wd(18,J.LM1,6,1250),new Wd(19,J.FLM1,6,800),new Wd(19,J.LM2,4,1400),new Wd(20,J.FLM1,5,900),new Wd(20,J.FTM,5,1700),new Wd(20,J.SBFT,1,30),new Wd(21,J.LM2,5,1500),new Wd(21,J.LM1,5,1500),new Wd(22,J.FLM1,5,950),new Wd(22,J.FLM2,5,950),new Wd(23,J.FLM2,5,1050),new Wd(23,J.LM3,5,1600),new Wd(24,J.LM1,5,1700),new Wd(24,J.LM3,5,1700),new Wd(25,J.LM1,5,1650),new Wd(25,J.LM2,6,1650),new Wd(25,J.LM3,5,1650),new Wd(26,J.LM3,2,2e3),new Wd(26,J.FLM2,6,1050),new Wd(27,J.LM3,4,2e3),new Wd(27,J.FLM1,4,950),new Wd(28,J.LM2,5,1900),new Wd(28,J.LM1,5,1900),new Wd(29,J.LM1,8,1900),new Wd(29,J.FTM,2,2150),new Wd(30,J.SBL2,1,43),new Wd(30,J.SBFT,1,65)],a=[J.TBOTTLE,J.TSUN,J.TICEFAN,J.TROCKET,J.TANCHOR],o=[new xd(1,10,20,J.TOWEREND,se.KILLMONSTER,-300),new Nd(4,23,10,200,se.FINDTOWER,-15,""),new Nd(4,5,10,200,se.KILLOBJECT,5,",B1Ob1,B1Ob2,B1Ob3,B1Ob4,B1Ob5,")],ee=Gd.create(3,30,1300,1,3,"level 45",a,r,1,o,l.p(4*n+282*s,360*s),0,1,5e5),r=[new Wd(1,1,J.LM1,6,10),new Wd(1,1,J.LM2,6,10),new Wd(1,1,J.LM3,6,10),new Wd(2,1,J.LM1,7,15),new Wd(2,1,J.LM2,7,15),new Wd(2,1,J.LM3,7,15),new Wd(3,1,J.LM1,8,35),new Wd(3,1,J.LM2,8,30),new Wd(3,1,J.LM3,8,25),new Wd(4,1,J.LM1,9,50),new Wd(4,1,J.LM2,9,50),new Wd(4,1,J.LM3,9,50),new Wd(5,1,J.LM1,10,70),new Wd(5,1,J.LM2,10,70),new Wd(5,1,J.LM3,10,70),new Wd(6,2,J.LM1,8,120),new Wd(6,2,J.LM2,8,120),new Wd(6,2,J.LM3,8,120),new Wd(7,2,J.LM1,9,160),new Wd(7,2,J.LM2,9,160),new Wd(7,2,J.LM3,9,160),new Wd(8,2,J.LM1,10,220),new Wd(8,2,J.LM2,10,220),new Wd(8,2,J.LM3,10,220),new Wd(9,1,J.FTM,20,450),new Wd(9,2,J.FTM,20,450),new Wd(10,1,J.LM1,5,520),new Wd(10,1,J.SBL1,1,28),new Wd(10,2,J.LM2,5,520),new Wd(10,2,J.SBL2,1,25),new Wd(11,1,J.SBL1,5,17),new Wd(11,2,J.SBL2,5,15),new Wd(12,1,J.SBFL1,2,19),new Wd(12,1,J.SBFT,3,25),new Wd(12,2,J.SBFL2,2,16),new Wd(12,2,J.SBFT,3,22),new Wd(13,1,J.LM1,10,950),new Wd(13,1,J.LM2,10,950),new Wd(13,2,J.LM3,10,950),new Wd(13,2,J.LM1,10,950),new Wd(14,1,J.FLM1,10,800),new Wd(14,2,J.FLM2,10,800),new Wd(15,1,J.SBL1,5,18),new Wd(15,1,J.BMT,1,14),new Wd(15,2,J.SBL2,5,18),new Wd(15,2,J.BMT,1,12)],a=[J.TBOTTLE,J.TICEFAN],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-240),new xd(10,23,20,J.TICEFAN,se.KILLMONSTER,-200),new Nd(4,6,10,240,se.KILLOBJECT,6,",S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,")],te=Gd.create(3,15,600,1,3,"level 46",a,r,1,o,l.p(4*n+454*s,436*s)),r=[new Wd(1,J.LM1,5,5),new Wd(1,J.LM2,5,5),new Wd(2,J.LM2,6,10.1),new Wd(2,J.LM3,4,10.1),new Wd(3,J.FLM1,4,12.11),new Wd(3,J.LM3,6,20.19),new Wd(4,J.FLM2,8,20),new Wd(4,J.FTM,2,35),new Wd(5,J.FTM,8,100),new Wd(5,J.FLM2,2,50),new Wd(6,J.LM1,5,150),new Wd(6,J.LM3,5,150),new Wd(7,J.FLM1,5,150),new Wd(7,J.FLM2,5,150),new Wd(8,J.LM3,5,250),new Wd(8,J.LM2,5,250),new Wd(9,J.LM3,6,395.18),new Wd(9,J.FLM1,4,237.11),new Wd(10,J.FLM1,4,304.95),new Wd(10,J.LM3,6,508.25),new Wd(10,J.SBL1,1,11),new Wd(11,J.LM3,8,587.86),new Wd(11,J.FTM,4,705.43),new Wd(12,J.FTM,2,776.74),new Wd(12,J.LM3,8,647.28),new Wd(13,J.FLM1,8,438.91),new Wd(13,J.LM2,2,731.51),new Wd(14,J.LM2,5,815.74),new Wd(14,J.LM3,5,815.74),new Wd(15,J.SBFL1,5,8),new Wd(15,J.SBFL2,5,11),new Wd(16,J.LM2,4,1177.45),new Wd(16,J.FTM,6,1412),new Wd(17,J.LM1,5,1232.84),new Wd(17,J.LM3,5,1232.84),new Wd(18,J.FTM,3,1656),new Wd(18,J.FLM2,7,828.31),new Wd(19,J.FLM1,5,860.54),new Wd(19,J.FLM2,5,861),new Wd(20,J.FLM2,5,894.77),new Wd(20,J.FLM2,5,894.77),new Wd(20,J.SBFL1,1,23),new Wd(21,J.FLM1,5,921.42),new Wd(21,J.FLM2,5,921.42),new Wd(22,J.FTM,2,1936.31),new Wd(22,J.LM1,8,1650.78),new Wd(23,J.LM2,5,1650.78),new Wd(23,J.LM3,5,1650.78),new Wd(24,J.FLM1,5,992.38),new Wd(24,J.FLM2,5,992.38),new Wd(25,J.BMT,1,14)],a=[J.TROCKET,J.TPLANE,J.TCUTTLE],o=[new xd(15,23,10,J.TPLANE,se.KILLMONSTER,-160),new Nd(4,23,20,160,se.FINDTOWER,-10,""),new Nd(4,2,10,220,se.KILLOBJECT,2,",B2Ob1,B2Ob2,")],ie=Gd.create(3,25,600,1,3,"level 47",a,r,1.5,o,l.p(4*n+649*s,461*s)),r=[new Wd(1,J.LM1,10,5e3),new Wd(1,J.LM2,10,6e3),new Wd(1,J.LM3,10,7e3),new Wd(2,J.SBFT,15,95),new Wd(2,J.BM4,1,330)],a=[J.TBOTTLE,J.TSUN,J.TFISH,J.TANCHOR],o=[new xd(16,23,20,J.TFISH,se.KILLMONSTER,-10),new Nd(4,23,10,200,se.FINDTOWER,-16,""),new Nd(3,25,20,160,se.EARNMONEY,-2e4)],ne=Gd.create(3,2,1010,1,120,"level 48",a,r,1,o,l.p(4*n+803*s,375*s),180),r=[new Wd(1,J.FLM1,5,8),new Wd(1,J.FLM2,5,8),new Wd(2,J.LM3,5,15),new Wd(2,J.LM2,5,15),new Wd(3,J.LM3,4,25),new Wd(3,J.FTM,6,25),new Wd(4,J.FLM1,5,25),new Wd(4,J.FLM2,5,25),new Wd(5,J.LM1,5,50),new Wd(5,J.LM2,5,50),new Wd(5,J.LM3,5,50),new Wd(6,J.LM3,8,100),new Wd(6,J.FLM1,2,70),new Wd(7,J.LM1,6,150),new Wd(7,J.FLM2,4,100),new Wd(8,J.LM1,5,200),new Wd(8,J.FTM,5,300),new Wd(9,J.FLM2,5,200),new Wd(9,J.LM1,5,300),new Wd(10,J.FLM2,8,299.1),new Wd(10,J.LM2,5,427.29),new Wd(11,J.LM1,5,513.19),new Wd(11,J.FTM,2,615.83),new Wd(12,J.LM2,5,587.41),new Wd(12,J.LM3,5,587.41),new Wd(13,J.FLM2,5,467.23),new Wd(13,J.LM1,5,667.48),new Wd(14,J.FLM2,5,523.28),new Wd(14,J.LM2,5,747.54),new Wd(15,J.LM2,5,1175.11),new Wd(15,J.LM3,5,1175.11),new Wd(15,J.LM1,5,1175.11),new Wd(16,J.FTM,6,1517.88),new Wd(16,J.LM2,4,1264.9),new Wd(17,J.FLM1,5,1184.72),new Wd(17,J.FLM2,5,1184.72),new Wd(18,J.FLM1,5,1581.32),new Wd(18,J.LM2,5,2259.03),new Wd(19,J.FLM1,5,1637.36),new Wd(19,J.LM3,5,2339.09),new Wd(20,J.SBL1,10,26),new Wd(21,J.SBFL1,1,31),new Wd(21,J.SBFL2,1,34),new Wd(22,J.SBFT,1,95),new Wd(23,J.SBFL1,1,61),new Wd(24,J.SBL1,5,43),new Wd(24,J.SBL3,5,45),new Wd(25,J.SBFL1,5,19),new Wd(25,J.SBFL2,5,20)],a=[J.TBOTTLE,J.TMOON,J.TFLASHLIGHT,J.TARROW,J.TANCHOR,J.TCUTTLE],o=[new xd(11,12,10,J.TMOON,se.BUILDTOWER,3),new Nd(3,5,10,420,se.KILLOBJECT,5,",SC1Ob1,SC1Ob2,SC1Ob3,BC1Ob1,BC1Ob2,"),new Nd(2,21,20,900,se.KILLOBJECT,1,",DB2Ob1,")],re=Gd.create(3,25,2600,1,3,"level 49",a,r,1.4,o,l.p(4*n+740*s,189*s),0,1,6e5),r=[new Wd(1,J.LM1,1,10),new Wd(1,J.LM1,10,10),new Wd(2,J.LM3,10,20),new Wd(3,J.LM2,6,50),new Wd(3,J.FTM,4,100),new Wd(4,J.LM1,6,120),new Wd(4,J.LM2,4,120),new Wd(5,J.FTM,4,200),new Wd(5,J.LM3,6,150),new Wd(6,J.LM2,6,220),new Wd(6,J.LM1,6,220),new Wd(7,J.SBB,1,180),new Wd(8,J.FLM1,4,180),new Wd(8,J.FLM2,6,180),new Wd(9,J.LM3,5,339.76),new Wd(9,J.FTM,5,407.71),new Wd(10,J.LM2,5,384.99),new Wd(10,J.SBFT,1,10),new Wd(11,J.LM3,5,444.3),new Wd(11,J.FLM2,5,311.01),new Wd(12,J.LM2,8,500),new Wd(12,J.FLM1,2,300),new Wd(13,J.LM1,6,800),new Wd(13,J.FTM,4,800),new Wd(14,J.LM2,6,900),new Wd(14,J.FLM1,4,480),new Wd(15,J.LM3,10,1200),new Wd(16,J.LM2,6,1500),new Wd(16,J.FLM1,4,900),new Wd(17,J.LM3,4,1800),new Wd(17,J.LM1,6,1800),new Wd(18,J.LM2,4,2e3),new Wd(18,J.LM1,4,2e3),new Wd(19,J.LM2,8,2300),new Wd(19,J.FLM1,2,1400),new Wd(20,J.SBL3,1,65),new Wd(20,J.SBFL1,1,35),new Wd(21,J.LM2,6,2500),new Wd(21,J.FTM,2,2900),new Wd(22,J.SBFL1,5,25),new Wd(22,J.BMT,1,60)],a=[J.TSHIT,J.TFISH,J.TANCHOR,J.TCUTTLE],o=[new xd(6,22,20,J.TSHIT,se.BUILDTOWER,1),new xd(17,23,10,J.TANCHOR,se.KILLMONSTER,-100),new Nd(4,23,10,300,se.FINDTOWER,-12,"")],ae=Gd.create(3,22,1e3,1,3,"level 50",a,r,3,o,l.p(4*n+907*s,126*s)),r=[new Wd(1,J.LM3,10,10),new Wd(2,J.LM1,10,20),new Wd(3,J.LM2,12,30),new Wd(4,J.FTM,12,200),new Wd(5,J.FLM1,10,150),new Wd(6,J.FLM2,10,200),new Wd(7,J.LM3,10,520),new Wd(7,J.LM1,10,530),new Wd(8,J.LM2,10,893),new Wd(8,J.LM1,10,930),new Wd(9,J.FTM,10,1680),new Wd(9,J.LM3,12,1460),new Wd(10,J.FTM,15,3500),new Wd(10,J.FLM1,5,1200),new Wd(11,J.LM2,10,4500),new Wd(11,J.FLM2,10,2e3),new Wd(12,J.LM1,8,6e3),new Wd(12,J.SBL1,2,93),new Wd(12,J.LM1,8,6e3),new Wd(13,J.SBL3,5,85),new Wd(13,J.LM3,10,6300),new Wd(13,J.FTM,10,7e3),new Wd(14,J.FLM1,3,4e3),new Wd(14,J.SBFL1,1,80),new Wd(14,J.FLM1,4,5e3),new Wd(14,J.SBFL1,2,78),new Wd(14,J.FLM1,3,5200),new Wd(14,J.SBFL1,2,70),new Wd(15,J.FTM,5,9660),new Wd(15,J.SBFT,1,90),new Wd(15,J.FTM,10,7550.24),new Wd(15,J.SBFT,3,88.5),new Wd(16,J.BMT,1,32),new Wd(16,J.SBFL1,1,78),new Wd(16,J.SBFL2,1,80),new Wd(16,J.SBL3,1,160),new Wd(16,J.SBFT,1,200)],a=[J.TICEFAN,J.TMOON,J.TROCKET,J.TPLANE,J.TFLASHLIGHT],o=[new xd(12,23,10,J.TFLASHLIGHT,se.KILLMONSTER,-150),new xd(11,11,10,J.TMOON,se.BUILDTOWER,2),new Nd(3,25,20,240,se.EARNMONEY,-9e3)],oe=Gd.create(4,16,588,1,3,"level 51",a,r,1.3,o,l.p(5*n+132*s,153*s)),r=[new Wd(1,J.LM3,15,100),new Wd(1,J.LM1,15,100),new Wd(2,J.LM2,10,450),new Wd(3,J.LM1,6,1450),new Wd(3,J.FTM,4,1450),new Wd(4,J.LM1,6,1550),new Wd(4,J.LM2,4,1600),new Wd(5,J.SBFL2,10,15),new Wd(5,J.SBFT,10,15),new Wd(6,J.BM1,1,50)],a=[J.TBALL,J.TSUN,J.TARROW],o=[new xd(12,23,20,J.TFLASHLIGHT,se.KILLMONSTER,-20),new xd(9,11,10,J.TBALL,se.BUILDTOWER,2),new Nd(4,1,10,30,se.KILLOBJECT,1,",L2Ob1,")],he=Gd.create(4,6,550,1,40,"level 52",a,r,2,o,l.p(5*n+262*s,250*s),240),r=[new Wd(1,1,J.LM1,5,3),new Wd(1,2,J.LM1,5,3),new Wd(2,1,J.SBL2,1,.3),new Wd(2,2,J.SBL2,1,.3),new Wd(3,1,J.LM3,5,19),new Wd(3,2,J.LM3,5,19),new Wd(4,1,J.SBL1,1,1),new Wd(4,2,J.SBL1,1,1),new Wd(5,1,J.LM2,5,40),new Wd(5,2,J.LM3,5,40),new Wd(6,1,J.FTM,5,65),new Wd(6,2,J.LM1,5,48),new Wd(7,1,J.FTM,6,76),new Wd(7,2,J.FTM,6,76),new Wd(8,1,J.FLM1,5,50),new Wd(8,2,J.FLM1,5,50),new Wd(9,1,J.FTM,4,80),new Wd(9,1,J.FLM2,2,25),new Wd(9,2,J.FTM,4,80),new Wd(9,2,J.FLM2,2,25),new Wd(10,1,J.LM2,6,95),new Wd(10,1,J.SBL2,1,1.4),new Wd(10,2,J.LM1,6,95),new Wd(10,2,J.SBL1,1,1.4),new Wd(11,1,J.LM3,5,115),new Wd(11,1,J.SBFT,3,1.75),new Wd(11,2,J.LM3,5,115),new Wd(11,2,J.SBFT,3,1.75),new Wd(12,1,J.FLM1,5,95),new Wd(12,1,J.FLM2,5,100),new Wd(12,2,J.FLM2,5,95),new Wd(12,2,J.FLM1,5,100),new Wd(13,1,J.LM1,8,165),new Wd(13,1,J.SBFL1,1,1.2),new Wd(13,2,J.LM1,8,165),new Wd(13,2,J.SBFL1,1,1.2),new Wd(14,1,J.FTM,3,280),new Wd(14,1,J.FLM1,3,130),new Wd(14,1,J.FTM,3,310),new Wd(14,2,J.FTM,3,280),new Wd(14,2,J.FLM2,3,130),new Wd(14,2,J.FTM,3,310),new Wd(15,1,J.LM2,6,360),new Wd(15,1,J.SBL2,3,4.4),new Wd(15,2,J.LM3,6,360),new Wd(15,2,J.SBL3,3,4.4),new Wd(16,1,J.FLM1,6,285),new Wd(16,1,J.SBFL1,1,4.8),new Wd(16,2,J.FLM2,6,285),new Wd(16,2,J.SBFL2,1,4.8),new Wd(17,1,J.FTM,8,520),new Wd(17,1,J.SBFT,1,8.8),new Wd(17,2,J.FTM,8,520),new Wd(17,2,J.SBFT,1,8.8),new Wd(18,1,J.LM1,7,510),new Wd(18,1,J.FLM1,2,200),new Wd(18,2,J.LM1,7,510),new Wd(18,2,J.FLM2,2,200),new Wd(19,1,J.SBL1,2,7),new Wd(19,1,J.SBL2,2,7.7),new Wd(19,1,J.SBL3,2,8),new Wd(19,1,J.SBFT,2,10),new Wd(19,2,J.SBL1,2,7),new Wd(19,2,J.SBL2,2,7.7),new Wd(19,2,J.SBL3,2,8),new Wd(19,2,J.SBFT,2,10),new Wd(20,1,J.BMT,1,4),new Wd(20,1,J.LM43,4,300),new Wd(20,2,J.BMT,1,4),new Wd(20,2,J.LM41,4,300)],a=[J.TBOTTLE,J.TICEFAN,J.TSTAR,J.TFLASHLIGHT,J.TROCKET,J.TMOON,J.TBALL],o=[new xd(11,11,10,J.TMOON,se.BUILDTOWER,2),new Nd(4,3,10,140,se.KILLOBJECT,3,",B2Ob1,B2Ob2,B2Ob3,"),new Nd(4,10,30,320,se.KILLOBJECT,30,"")],le=Gd.create(4,20,660,1,3,"level 53",a,r,1.3,o,l.p(5*n+179*s,388*s)),r=[new Wd(1,J.LM2,8,5),new Wd(2,J.LM1,5,15),new Wd(2,J.LM3,5,15),new Wd(3,J.LM2,6,25),new Wd(3,J.LM3,6,25),new Wd(4,J.LM1,5,40),new Wd(4,J.FTM,7,40),new Wd(5,J.LM3,7,45),new Wd(5,J.LM2,7,50),new Wd(6,J.FTM,12,60),new Wd(7,J.LM1,8,80),new Wd(7,J.FLM1,2,20),new Wd(8,J.FLM1,10,50),new Wd(9,J.FLM2,2,70),new Wd(9,J.FTM,8,140),new Wd(9,J.FLM2,3,50),new Wd(10,J.SBL1,1,3.3),new Wd(10,J.SBL2,2,3),new Wd(10,J.SBL3,3,2.5),new Wd(11,J.LM3,12,320),new Wd(12,J.LM42,5,220),new Wd(13,J.LM1,8,350),new Wd(13,J.LM2,8,400),new Wd(14,J.FLM2,8,345),new Wd(14,J.FLM1,8,350),new Wd(15,J.FTM,12,600),new Wd(15,J.SBFT,3,10),new Wd(16,J.FTM,6,900),new Wd(16,J.LM3,6,700),new Wd(16,J.FLM2,8,395.96),new Wd(17,J.FTM,6,1100),new Wd(17,J.LM3,6,800),new Wd(17,J.FLM1,3,550),new Wd(18,J.LM42,1,1220),new Wd(18,J.FLM1,10,680),new Wd(18,J.FLM2,10,680),new Wd(19,J.SBL1,5,16),new Wd(19,J.SBL2,5,18),new Wd(20,J.SBFL1,5,15),new Wd(20,J.SBFL2,5,15),new Wd(21,J.SBFT,5,26),new Wd(21,J.LM43,5,1500),new Wd(22,J.BMT,1,15),new Wd(22,J.LM42,3,1600),new Wd(22,J.LM43,3,1900)],a=[J.TICEFAN,J.TARROW,J.TMOON,J.TSTAR,J.TPLANE],o=[new xd(15,23,10,J.TPLANE,se.KILLMONSTER,-150),new xd(11,11,20,J.TMOON,se.BUILDTOWER,2),new Nd(4,2,10,300,se.KILLOBJECT,2,",B1Ob1,B1Ob2,")],de=Gd.create(4,22,380,1,3,"level 54",a,r,2.6,o,l.p(5*n+386*s,367*s)),r=[new Wd(1,J.FTM,10,10),new Wd(2,J.LM1,10,20),new Wd(3,J.LM2,4,30),new Wd(3,J.LM3,6,30),new Wd(4,J.LM1,5,50),new Wd(4,J.LM2,5,50),new Wd(5,J.LM3,7,80),new Wd(5,J.LM2,3,80),new Wd(6,J.FLM2,5,40),new Wd(6,J.FTM,7,100),new Wd(7,J.LM2,10,100),new Wd(8,J.LM1,5,120),new Wd(8,J.FLM1,7,45),new Wd(9,J.LM3,5,140),new Wd(9,J.FLM2,9,46),new Wd(10,J.SBFL1,4,2),new Wd(11,J.SBL2,6,3.2),new Wd(12,J.FTM,12,550),new Wd(13,J.LM1,8,550),new Wd(13,J.SBFL2,3,2.2),new Wd(14,J.LM2,6,700),new Wd(14,J.LM3,6,750),new Wd(15,J.SBFT,2,12),new Wd(15,J.FTM,5,1100),new Wd(15,J.SBFT,3,14),new Wd(16,J.LM44,2,860),new Wd(16,J.SBFL2,2,6.3),new Wd(16,J.SBFL2,2,7),new Wd(17,J.LM2,8,1300),new Wd(17,J.LM1,8,1350),new Wd(18,J.SBFT,5,20),new Wd(18,J.LM3,10,1350),new Wd(19,J.SBL1,5,21),new Wd(19,J.SBL3,5,23),new Wd(20,J.SBFL1,1,10),new Wd(20,J.SBFL2,1,12),new Wd(20,J.SBFL1,2,14),new Wd(20,J.SBFL2,2,12),new Wd(20,J.SBFL1,2,11),new Wd(20,J.SBFL2,2,12),new Wd(21,J.LM41,3,1550),new Wd(21,J.LM44,3,1590),new Wd(22,J.BMT,1,11)],a=[J.TBOTTLE,J.TSTAR,J.TBALL,J.TSUN,J.TROCKET],o=[new xd(7,23,20,J.TSTAR,se.KILLMONSTER,-50),new Nd(2,21,20,900,se.KILLOBJECT,1,",DB1Ob1,"),new Nd(4,10,10,400,se.KILLOBJECT,24,"")],ce=Gd.create(4,22,1333,1,3,"level 55",a,r,1.8,o,l.p(5*n+536*s,462*s),0,1,5e5),r=[new Wd(1,J.LM1,10,1e4),new Wd(1,J.FLM1,10,8800),new Wd(1,J.BM2,1,120)],a=[J.TBOTTLE],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-5),new xd(15,23,30,J.TPLANE,se.KILLMONSTER,-1),new Nd(4,2,5,20,se.KILLOBJECT,2,",B1Ob1,B1Ob2,")],ue=Gd.create(4,1,9999,1,3,"level 56",a,r,1,o,l.p(5*n+749*s,491*s),99),r=[new Wd(1,1,J.LM2,5,2),new Wd(1,2,J.LM2,5,2),new Wd(2,1,J.LM3,5,4),new Wd(2,2,J.LM3,5,4),new Wd(3,1,J.LM1,6,6),new Wd(3,2,J.LM1,6,6),new Wd(4,1,J.FTM,6,12),new Wd(4,2,J.FTM,6,12),new Wd(5,1,J.LM2,5,12.5),new Wd(5,2,J.LM3,5,12.5),new Wd(6,1,J.FTM,5,20),new Wd(6,2,J.LM1,5,15),new Wd(7,1,J.SBL1,1,.75),new Wd(7,2,J.SBL3,1,.75),new Wd(8,1,J.FLM1,5,22),new Wd(8,2,J.FLM1,5,22),new Wd(9,1,J.FTM,3,50),new Wd(9,1,J.FLM2,3,18),new Wd(9,2,J.FTM,3,50),new Wd(9,2,J.FLM2,3,18),new Wd(10,1,J.LM2,6,55),new Wd(10,1,J.SBL2,1,1.1),new Wd(10,2,J.LM1,6,55),new Wd(10,2,J.SBL1,1,1.1),new Wd(11,1,J.LM3,5,75),new Wd(11,1,J.SBFT,3,1.6),new Wd(11,2,J.LM3,5,75),new Wd(11,2,J.SBFT,3,1.6),new Wd(12,1,J.FLM1,5,80),new Wd(12,1,J.FLM2,5,85),new Wd(12,2,J.FLM2,5,80),new Wd(12,2,J.FLM1,5,85),new Wd(13,1,J.LM1,8,100),new Wd(13,1,J.SBFL1,1,1),new Wd(13,2,J.LM1,8,100),new Wd(13,2,J.SBFL1,1,1),new Wd(14,1,J.FTM,3,180),new Wd(14,1,J.FLM1,3,70),new Wd(14,1,J.FTM,3,200),new Wd(14,2,J.FTM,3,180),new Wd(14,2,J.FLM2,3,70),new Wd(14,2,J.FTM,3,200),new Wd(15,1,J.LM2,6,200),new Wd(15,1,J.SBL2,3,2.5),new Wd(15,2,J.LM3,6,200),new Wd(15,2,J.SBL3,3,2.5),new Wd(16,1,J.FLM1,6,166),new Wd(16,1,J.SBFL1,1,1.8),new Wd(16,2,J.FLM2,6,166),new Wd(16,2,J.SBFL2,1,1.8),new Wd(17,1,J.FTM,8,280),new Wd(17,1,J.SBFT,1,3.8),new Wd(17,2,J.FTM,8,280),new Wd(17,2,J.SBFT,1,3.8),new Wd(18,1,J.LM1,7,280),new Wd(18,1,J.FLM1,2,140),new Wd(18,2,J.LM1,7,280),new Wd(18,2,J.FLM2,2,140),new Wd(19,1,J.SBL1,2,3),new Wd(19,1,J.SBL2,2,4),new Wd(19,1,J.SBL3,2,5),new Wd(19,1,J.SBFT,2,7),new Wd(19,2,J.SBL1,2,3),new Wd(19,2,J.SBL2,2,4),new Wd(19,2,J.SBL3,2,5),new Wd(19,2,J.SBFT,2,7),new Wd(20,1,J.BMT,1,3.3),new Wd(20,1,J.LM41,1,400),new Wd(20,2,J.BMT,1,3.3)],a=[J.TBOTTLE,J.TARROW,J.TFISH],o=[new xd(13,23,10,J.TARROW,se.KILLMONSTER,-90),new Nd(4,5,30,200,se.KILLOBJECT,5,",L1Ob1,L1Ob2,L1Ob3,L1Ob4,L1Ob5,"),new Nd(4,10,10,250,se.KILLOBJECT,24,"")],pe=Gd.create(4,20,222,1,3,"level 57",a,r,1.5,o,l.p(5*n+844*s,371*s)),r=[new Wd(1,J.LM3,10,23),new Wd(2,J.LM1,10,38),new Wd(3,J.LM2,12,78),new Wd(4,J.FTM,12,133),new Wd(5,J.FLM1,10,130),new Wd(6,J.FLM2,10,176),new Wd(7,J.LM3,10,400),new Wd(7,J.LM1,10,422),new Wd(8,J.LM2,10,755),new Wd(8,J.LM1,10,800),new Wd(9,J.FTM,10,1900),new Wd(9,J.LM3,12,1700),new Wd(10,J.FTM,12,2500),new Wd(10,J.FLM1,5,1300),new Wd(10,J.LM42,3,1800),new Wd(11,J.LM2,10,2660),new Wd(11,J.FLM2,10,1800),new Wd(12,J.LM1,6,3500),new Wd(12,J.SBL1,2,48.5),new Wd(12,J.LM1,6,3750.27),new Wd(13,J.SBL3,5,50),new Wd(13,J.LM3,5,4500),new Wd(13,J.FTM,5,7e3),new Wd(14,J.LM42,5,3800),new Wd(14,J.SBFL1,2,38),new Wd(14,J.LM44,5,3200),new Wd(14,J.SBFL2,2,35.5),new Wd(15,J.BMT,1,15),new Wd(15,J.SBL3,1,90),new Wd(15,J.SBFT,1,111),new Wd(15,J.SBFL1,1,60),new Wd(15,J.SBFL2,1,50)],a=[J.TBOTTLE,J.TMOON,J.TARROW,J.TROCKET,J.TANCHOR,J.TSTAR],o=[new xd(11,12,10,J.TMOON,se.BUILDTOWER,3),new Nd(4,10,10,400,se.KILLOBJECT,17,""),new Nd(3,25,20,240,se.EARNMONEY,-1e4)],me=Gd.create(4,15,1111,1,3,"level 58",a,r,3,o,l.p(5*n+667*s,296*s)),r=[new Wd(1,J.LM2,5,100),new Wd(1,J.LM3,5,100),new Wd(2,J.LM1,10,91.18),new Wd(3,J.LM2,6,182.35),new Wd(3,J.FTM,4,218.82),new Wd(4,J.LM3,6,273.53),new Wd(4,J.LM2,4,273.53),new Wd(5,J.SBFL1,10,4),new Wd(5,J.SBFT,5,6),new Wd(6,J.LM2,10,2917.6),new Wd(6,J.LM1,16,2917.6),new Wd(7,J.LM3,15,3632.67),new Wd(7,J.FLM2,15,2542.87),new Wd(8,J.FLM1,14,3017.89),new Wd(8,J.FLM2,16,3017.89),new Wd(9,J.LM3,15,4989.88),new Wd(9,J.FTM,15,5987.85),new Wd(10,J.SBL3,15,20),new Wd(10,J.BM3,1,92)],a=[J.TBOTTLE,J.TICEFAN,J.TFISH],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-70),new xd(10,23,20,J.TICEFAN,se.KILLMONSTER,-50),new Nd(4,10,5,140,se.KILLOBJECT,24,"")],_e=Gd.create(4,10,550,1,15,"level 59",a,r,1,o,l.p(5*n+549*s,135*s),200),r=[new Wd(1,J.LM3,8,38),new Wd(2,J.LM2,5,60),new Wd(2,J.LM1,5,68),new Wd(3,J.LM3,5,79),new Wd(3,J.LM2,5,85),new Wd(4,J.LM1,5,99),new Wd(4,J.FTM,5,131),new Wd(5,J.LM3,6,128),new Wd(5,J.LM2,6,134),new Wd(6,J.LM42,1,190),new Wd(6,J.FTM,5,205),new Wd(7,J.LM1,8,200),new Wd(7,J.FLM1,2,130),new Wd(8,J.FLM1,8,155),new Wd(9,J.FLM2,2,180),new Wd(9,J.FTM,5,340),new Wd(9,J.FLM2,3,220),new Wd(10,J.SBL1,1,6.6),new Wd(10,J.LM42,3,229.2),new Wd(11,J.FLM2,5,223),new Wd(11,J.SBL3,3,4.4),new Wd(12,J.FLM1,8,258),new Wd(12,J.SBL2,3,5.8),new Wd(13,J.LM2,5,688),new Wd(13,J.LM44,2,600.2),new Wd(14,J.LM41,3,670.2),new Wd(14,J.LM3,6,798),new Wd(15,J.FTM,12,1200),new Wd(15,J.SBFT,3,16),new Wd(16,J.FTM,6,1500),new Wd(16,J.LM3,6,900),new Wd(16,J.FLM2,5,500),new Wd(17,J.FTM,6,1890),new Wd(17,J.LM3,6,1199),new Wd(17,J.FLM1,8,700),new Wd(18,J.FLM1,10,990),new Wd(18,J.FLM2,10,1005),new Wd(19,J.SBL1,6,20),new Wd(19,J.SBL2,6,22.5),new Wd(20,J.SBFL1,5,17.5),new Wd(20,J.SBFL2,5,17.6),new Wd(21,J.BMT,1,10),new Wd(21,J.SBFT,3,50),new Wd(21,J.SBL1,1,25.3),new Wd(21,J.SBL3,1,26.3),new Wd(21,J.SBL2,1,27.3)],a=[J.TARROW,J.TPLANE,J.TICEFAN,J.TSUN,J.TBOTTLE],o=[new xd(10,11,20,J.TICEFAN,se.BUILDTOWER,2),new Nd(2,21,20,720,se.KILLOBJECT,1,",DB2Ob1,"),new Nd(4,4,10,360,se.KILLOBJECT,4,",B2Ob1,B2Ob2,B2Ob3,B2Ob4,")],ge=Gd.create(4,21,1919,1,3,"level 60",a,r,1.8,o,l.p(5*n+852*s,88*s),0,1,45e4),r=[new Wd(1,J.LM2,5,10),new Wd(1,J.LM1,5,35),new Wd(1,J.LM3,5,38),new Wd(1,J.FTM,5,55),new Wd(2,J.LM2,5,66),new Wd(2,J.LM1,5,75),new Wd(2,J.LM3,5,92),new Wd(2,J.FTM,5,122),new Wd(3,J.FLM1,5,105),new Wd(3,J.FLM2,5,110),new Wd(3,J.FTM,6,375),new Wd(3,J.LM42,2,115),new Wd(3,J.FLM1,5,120),new Wd(3,J.FLM2,5,125),new Wd(4,J.SBL1,5,19),new Wd(4,J.LM2,5,220),new Wd(4,J.FTM,5,422),new Wd(4,J.SBL2,5,25),new Wd(4,J.LM3,5,285),new Wd(4,J.SBL3,5,33),new Wd(4,J.LM1,5,290),new Wd(4,J.SBFT,5,48),new Wd(4,J.LM41,3,366),new Wd(5,J.BMT,1,8),new Wd(5,J.LM44,4,600),new Wd(5,J.SBFL1,3,43),new Wd(5,J.SBFT,3,85),new Wd(5,J.SBFL2,3,48),new Wd(5,J.LM41,4,600),new Wd(5,J.BMT,3,12),new Wd(5,J.LM42,5,666)],a=[J.TICEFAN,J.TMOON],o=[new xd(10,23,20,J.TICEFAN,se.KILLMONSTER,-50),new Nd(4,1,5,60,se.KILLOBJECT,1,",BC1Ob1,BC1Ob2,BC1Ob3,BC1Ob4,BC1Ob5,BC1Ob6,"),new Nd(4,10,20,150,se.KILLOBJECT,23,"")],Te=Gd.create(4,5,948,1,3,"level 61",a,r,.6,o,l.p(6*n+81*s,142*s)),r=[new Wd(1,J.LM1,10,5),new Wd(2,J.LM2,6,10),new Wd(2,J.LM1,4,10),new Wd(3,J.LM3,5,15),new Wd(3,J.LM2,5,15),new Wd(4,J.LM1,7,25),new Wd(4,J.LM2,3,15),new Wd(5,J.FLM1,10,30),new Wd(6,J.FTM,10,40),new Wd(6,J.FLM2,2,18),new Wd(7,J.LM3,10,38),new Wd(7,J.FLM2,5,20),new Wd(8,J.FLM1,6,35),new Wd(8,J.FLM2,6,38),new Wd(9,J.LM2,10,70),new Wd(9,J.FTM,10,100),new Wd(10,J.SBL1,1,2.5),new Wd(10,J.LM1,12,111),new Wd(11,J.SBL2,3,2.2),new Wd(11,J.LM2,10,140),new Wd(12,J.FLM1,8,140),new Wd(12,J.SBFL2,4,2.2),new Wd(13,J.SBFL1,3,4.5),new Wd(13,J.SBL3,3,8.5),new Wd(14,J.FTM,5,720),new Wd(14,J.SBFT,3,11),new Wd(14,J.FTM,5,750),new Wd(15,J.LM41,2,650),new Wd(15,J.FLM2,8,300),new Wd(16,J.LM1,5,900),new Wd(16,J.LM2,5,900),new Wd(17,J.LM3,5,940),new Wd(17,J.SBL2,5,12),new Wd(17,J.LM1,5,700),new Wd(18,J.FTM,8,1050),new Wd(18,J.LM41,5,650),new Wd(19,J.SBL1,1,17),new Wd(19,J.SBL2,1,18),new Wd(19,J.SBL3,1,19),new Wd(19,J.SBFL1,1,9),new Wd(19,J.SBFL2,1,9),new Wd(20,J.LM2,5,1200),new Wd(20,J.FLM1,5,650),new Wd(20,J.FTM,5,1500),new Wd(21,J.LM1,5,1300),new Wd(21,J.LM3,5,1300),new Wd(21,J.SBFL1,3,10),new Wd(22,J.SBFL2,1,13),new Wd(22,J.LM41,3,1e3),new Wd(22,J.BMT,1,14)],a=[J.TRANDOM],o=[new xd(5,23,20,J.TBOTTLE,se.KILLMONSTER,-90),new xd(15,23,20,J.TPLANE,se.KILLMONSTER,-60),new Nd(4,10,10,350,se.KILLOBJECT,16,",L3Ob1,L3Ob2,L3Ob3,L3Ob4,S3Ob1,S3Ob2,S3Ob3,S3Ob4,S3Ob5,S3Ob6,S3Ob7,S3Ob8,S3Ob9,S3Ob10,S3Ob11,S3Ob12,")],fe=Gd.create(4,22,400,1,3,"level 62",a,r,1.8,o,l.p(6*n+82*s,351*s)),r=[new Wd(1,1,J.LM2,1,38),new Wd(1,2,J.LM2,1,38),new Wd(2,1,J.LM3,2,48),new Wd(2,2,J.LM3,2,48),new Wd(3,1,J.LM1,3,55),new Wd(3,2,J.LM1,3,55),new Wd(4,1,J.FTM,4,60),new Wd(4,2,J.FTM,4,60),new Wd(5,1,J.FLM2,5,30),new Wd(5,2,J.FLM2,5,30),new Wd(6,1,J.FLM1,6,40),new Wd(6,2,J.FLM1,6,40),new Wd(7,1,J.BMT,1,.33),new Wd(7,2,J.BMT,1,.33),new Wd(8,1,J.SBL2,3,1.5),new Wd(8,1,J.LM2,4,85),new Wd(8,2,J.SBL3,3,1.5),new Wd(8,2,J.LM3,4,85),new Wd(9,1,J.LM1,4,200),new Wd(9,1,J.SBFT,4,5),new Wd(9,2,J.LM1,4,200),new Wd(9,2,J.SBFT,4,5),new Wd(10,1,J.LM42,2,200),new Wd(10,2,J.LM44,2,200),new Wd(11,1,J.SBFL1,3,5),new Wd(11,1,J.SBFL2,3,4),new Wd(11,2,J.SBFL1,3,5),new Wd(11,2,J.SBFL2,3,4),new Wd(12,1,J.SBFT,8,16),new Wd(12,2,J.SBFT,8,16),new Wd(13,1,J.LM3,4,450),new Wd(13,1,J.LM43,2,500),new Wd(13,2,J.LM2,4,450),new Wd(13,2,J.LM41,2,500),new Wd(14,1,J.LM44,4,450),new Wd(14,1,J.SBFL2,4,8),new Wd(14,2,J.LM42,4,450),new Wd(14,2,J.SBFL1,4,8),new Wd(15,1,J.BMT,3,5),new Wd(15,2,J.BMT,3,5),new Wd(16,1,J.SBFT,1,30),new Wd(16,1,J.SBL1,1,25.1),new Wd(16,1,J.LM41,1,520),new Wd(16,1,J.SBL2,1,25.3),new Wd(16,1,J.SBL3,1,30),new Wd(16,2,J.SBFT,1,30),new Wd(16,2,J.SBL1,1,25.1),new Wd(16,2,J.LM44,1,520),new Wd(16,2,J.SBL2,1,25.3),new Wd(16,2,J.SBL3,1,31)],a=[J.TBOTTLE,J.TICEFAN,J.TSUN,J.TARROW,J.TMOON,J.TPLANE,J.TFLASHLIGHT],o=[new xd(10,23,20,J.TICEFAN,se.KILLMONSTER,-50),new xd(15,23,10,J.TPLANE,se.KILLMONSTER,-150),new Nd(4,10,20,200,se.KILLOBJECT,14,",L2Ob1,L2Ob2,L2Ob3,L2Ob4,L2Ob5,L2Ob6,L2Ob7,L2Ob8,L2Ob9,L2Ob10,L2Ob11,L2Ob12,L2Ob13,L2Ob14,")],Se=Gd.create(4,16,960,1,4,"level 63",a,r,1.2,o,l.p(6*n+336*s,407*s)),r=[new Wd(1,J.FTM,10,10),new Wd(2,J.LM2,6,25),new Wd(2,J.LM1,4,30),new Wd(3,J.LM3,5,42),new Wd(3,J.LM2,5,50),new Wd(4,J.LM1,8,60),new Wd(4,J.FLM1,2,40),new Wd(5,J.FLM1,10,60),new Wd(6,J.FTM,10,200),new Wd(6,J.FLM2,3,80),new Wd(7,J.LM3,10,210),new Wd(7,J.FLM2,5,90),new Wd(8,J.FLM1,8,155),new Wd(8,J.FLM2,8,170),new Wd(9,J.LM2,6,280),new Wd(9,J.FTM,10,360),new Wd(10,J.SBL1,1,6.3),new Wd(10,J.LM1,12,400),new Wd(11,J.SBL2,3,6.8),new Wd(11,J.LM2,10,450),new Wd(12,J.FLM1,8,325),new Wd(12,J.SBFL2,5,4.2),new Wd(13,J.SBL3,5,8.8),new Wd(13,J.LM44,3,280),new Wd(13,J.SBFL1,5,5),new Wd(14,J.FTM,10,1300),new Wd(14,J.SBFT,3,17.2),new Wd(15,J.LM44,3,850),new Wd(16,J.LM1,8,1200),new Wd(16,J.SBL2,3,15),new Wd(16,J.FLM1,2,650),new Wd(17,J.LM2,6,1500),new Wd(17,J.FLM1,5,700),new Wd(17,J.FTM,5,1900),new Wd(18,J.BMT,1,10),new Wd(18,J.FLM2,8,950),new Wd(19,J.LM41,3,1e3),new Wd(19,J.LM44,3,900)],a=[J.TARROW,J.TPLANE,J.TSTAR,J.TROCKET,J.TSUN,J.TBALL],o=[new xd(5,23,30,J.TBOTTLE,se.KILLMONSTER,-90),new Nd(4,10,10,280,se.KILLOBJECT,54,""),new Nd(4,23,5,30,se.FINDTOWER,-1,"tmoon,")],we=Gd.create(4,19,1080,1,3,"level 64",a,r,2.8,o,l.p(6*n+235*s,226*s)),r=[new Wd(1,J.LM41,5,20),new Wd(2,J.LM42,10,40),new Wd(3,J.LM43,6,80),new Wd(3,J.SBB,1,75),new Wd(4,J.LM41,6,100),new Wd(4,J.LM45,4,100),new Wd(5,J.LM42,4,240),new Wd(5,J.LM43,6,240),new Wd(6,J.LM45,6,300),new Wd(6,J.LM43,6,300),new Wd(7,J.LM43,5,500),new Wd(7,J.LM41,5,500),new Wd(8,J.LM41,4,600),new Wd(8,J.LM42,6,600),new Wd(9,J.LM44,5,650),new Wd(9,J.LM41,5,650),new Wd(10,J.LM42,1,1800),new Wd(11,J.LM43,5,1100),new Wd(12,J.LM44,6,1200),new Wd(13,J.LM41,6,1300),new Wd(14,J.LM45,6,1420.66),new Wd(15,J.LM43,1,1777.49),new Wd(15,J.LM41,1,1777.49),new Wd(15,J.LM42,1,1777.49),new Wd(15,J.LM44,1,1777.49),new Wd(15,J.LM45,1,1777.49)],a=[J.TBOTTLE,J.TSHIT,J.TSUN,J.TARROW,J.TCUTTLE,J.TANCHOR],o=[new xd(8,23,20,J.TSUN,se.KILLMONSTER,-300),new xd(1,23,5,J.TCUTTLE,se.KILLMONSTER,-350),new Nd(4,2,20,150,se.KILLOBJECT,2,",BC1Ob1,BC1Ob2,")],ve=Gd.create(4,15,1200,1,3,"level 65",a,r,1,o,l.p(6*n+324*s,87*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM1,5,10),new Wd(2,J.LM1,5,20),new Wd(2,J.LM2,5,25),new Wd(3,J.LM2,10,25),new Wd(4,J.LM3,5,60),new Wd(4,J.LM1,10,50),new Wd(5,J.LM2,10,150),new Wd(5,J.LM3,10,150),new Wd(6,J.FLM1,10,180),new Wd(7,J.FTM,10,450),new Wd(8,J.FLM2,15,300),new Wd(9,J.LM1,10,650),new Wd(9,J.FLM1,5,400),new Wd(10,J.LM2,10,850),new Wd(10,J.FLM2,8,600),new Wd(11,J.LM3,10,1200),new Wd(11,J.FTM,10,1600),new Wd(12,J.FLM1,10,850),new Wd(12,J.FLM2,8,800),new Wd(13,J.LM1,10,1500),new Wd(13,J.SBL1,3,20),new Wd(14,J.FLM1,8,1050),new Wd(14,J.SBFL1,5,15),new Wd(15,J.SBFT,3,35),new Wd(15,J.FTM,16,2480),new Wd(16,J.LM3,15,2600),new Wd(16,J.LM1,2,3200),new Wd(17,J.FLM2,20,1700),new Wd(18,J.LM2,18,3e3),new Wd(18,J.FTM,2,4200),new Wd(19,J.LM2,8,3700),new Wd(19,J.LM1,8,3600),new Wd(19,J.LM3,8,3500),new Wd(20,J.SBFT,1,60),new Wd(20,J.SBFL1,1,26),new Wd(20,J.SBFT,2,65.5),new Wd(20,J.SBFL2,2,28.5)],a=[J.TBOTTLE,J.TMAGNET,J.TMOON,J.TSUN],o=[new xd(5,22,5,J.TBOTTLE,se.BUILDTOWER,1),new xd(11,12,10,J.TMOON,se.BUILDTOWER,3),new Nd(4,10,20,200,se.KILLOBJECT,26,"")],Le=Gd.create(5,20,300,1,3,"level 66",a,r,1,o,l.p(6*n+449*s,180*s)),r=[new Wd(1,1,J.LM1,5,2),new Wd(1,2,J.LM2,5,2),new Wd(2,1,J.LM1,5,9),new Wd(2,2,J.LM3,5,9),new Wd(3,1,J.LM3,6,12),new Wd(3,2,J.LM3,6,12),new Wd(4,1,J.LM1,8,17),new Wd(4,2,J.LM2,6,17),new Wd(5,1,J.LM3,10,23),new Wd(5,2,J.LM2,8,23),new Wd(6,1,J.LM3,10,33),new Wd(6,2,J.FTM,10,40),new Wd(7,1,J.LM1,10,50),new Wd(7,2,J.FTM,10,60),new Wd(8,1,J.FLM1,8,45),new Wd(8,2,J.LM2,10,80),new Wd(9,1,J.FLM1,10,46),new Wd(9,2,J.FLM1,8,40),new Wd(10,1,J.LM3,10,111),new Wd(10,2,J.FLM2,8,92),new Wd(11,1,J.FLM1,10,108),new Wd(11,2,J.FLM2,10,100),new Wd(12,1,J.FTM,6,160),new Wd(12,1,J.FLM1,8,95),new Wd(12,2,J.FTM,6,160),new Wd(12,2,J.FLM2,6,92),new Wd(13,1,J.LM2,10,245),new Wd(13,1,J.SBL2,1,5.2),new Wd(13,2,J.SBL1,1,5),new Wd(13,2,J.LM1,8,245),new Wd(14,1,J.FTM,8,350),new Wd(14,1,J.SBFT,3,7),new Wd(14,2,J.SBL3,1,6),new Wd(14,2,J.LM3,10,300),new Wd(15,1,J.SBFT,10,7),new Wd(15,2,J.SBFT,10,6.5),new Wd(16,1,J.FLM1,10,350),new Wd(16,1,J.SBFL1,1,9),new Wd(16,2,J.FLM2,10,350),new Wd(16,2,J.SBFL2,1,9),new Wd(17,1,J.SBFL2,6,7),new Wd(17,2,J.SBFL1,6,7),new Wd(18,1,J.LM1,5,900),new Wd(18,1,J.FTM,10,1e3),new Wd(18,2,J.LM2,8,900),new Wd(18,2,J.LM3,5,1e3),new Wd(19,1,J.SBFT,1,25),new Wd(19,1,J.FTM,15,1050),new Wd(19,2,J.SBFT,1,20),new Wd(19,2,J.FTM,15,880),new Wd(20,1,J.LM1,10,850),new Wd(20,1,J.FLM1,5,380),new Wd(20,2,J.LM1,10,850),new Wd(20,2,J.FLM1,5,380),new Wd(21,1,J.LM2,15,1050),new Wd(21,1,J.SBFL1,2,4.5),new Wd(21,2,J.LM3,13,900),new Wd(21,2,J.SBFL2,2,4),new Wd(22,1,J.FTM,5,1690),new Wd(22,1,J.FLM1,5,480),new Wd(22,1,J.FTM,5,1950),new Wd(22,2,J.FTM,5,1600),new Wd(22,2,J.FLM2,5,450),new Wd(22,2,J.FTM,5,1700),new Wd(23,1,J.FLM1,10,850),new Wd(23,1,J.FLM2,5,810),new Wd(23,2,J.FLM1,5,700),new Wd(23,2,J.FLM2,10,750),new Wd(24,1,J.SBL1,2,23),new Wd(24,1,J.SBFL1,2,13.5),new Wd(24,1,J.SBL3,4,25),new Wd(24,2,J.SBL1,2,21),new Wd(24,2,J.SBFL2,2,12),new Wd(24,2,J.SBL3,4,22),new Wd(25,1,J.BMT,1,8),new Wd(25,1,J.SBFT,2,50.6),new Wd(25,1,J.BMT,1,11),new Wd(25,2,J.SBFT,4,38),new Wd(25,2,J.BMT,1,9)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR,J.TBALL,J.TMOON,J.TMAGNET],o=[new xd(11,11,20,J.TMOON,se.BUILDTOWER,2),new Nd(4,23,5,130,se.FINDTOWER,-7,""),new Nd(4,2,10,65,se.KILLOBJECT,2,",B2Ob1,B2Ob2,")],Me=Gd.create(5,25,600,1,3,"level 67",a,r,1,o,l.p(6*n+533*s,318*s)),r=[new Wd(1,J.LM1,10,15),new Wd(2,J.LM2,6,30),new Wd(2,J.LM1,4,25),new Wd(3,J.LM3,5,60),new Wd(3,J.LM2,5,60),new Wd(4,J.LM1,7,100),new Wd(4,J.FLM1,3,70),new Wd(5,J.FLM1,10,100),new Wd(6,J.FTM,10,220),new Wd(6,J.FLM2,3,100),new Wd(7,J.LM3,10,220),new Wd(7,J.FLM2,5,120),new Wd(8,J.FLM1,8,180),new Wd(8,J.FLM2,8,180),new Wd(9,J.LM2,10,400),new Wd(9,J.FTM,10,600),new Wd(10,J.SBL1,1,10),new Wd(10,J.LM1,15,600),new Wd(11,J.SBL2,6,11),new Wd(11,J.LM2,10,800),new Wd(12,J.FLM1,8,550),new Wd(12,J.SBFL2,8,9),new Wd(13,J.SBL3,5,15),new Wd(13,J.SBFL1,5,11),new Wd(14,J.FTM,10,2100),new Wd(14,J.SBFT,3,25),new Wd(14,J.FTM,5,1900),new Wd(15,J.FLM2,20,1400),new Wd(16,J.LM1,10,2e3),new Wd(16,J.LM2,12,1900),new Wd(17,J.LM3,15,2200),new Wd(18,J.LM1,8,2500),new Wd(18,J.SBL2,5,19),new Wd(18,J.FLM1,5,1200),new Wd(19,J.FTM,20,3e3),new Wd(20,J.SBL1,1,51),new Wd(20,J.SBL2,1,50),new Wd(20,J.SBL3,1,45),new Wd(21,J.LM2,10,3200),new Wd(21,J.FLM1,5,1300),new Wd(21,J.FTM,5,3500),new Wd(22,J.BMT,1,22),new Wd(22,J.FLM2,8,1500)],a=[J.TSTAR,J.TSUN,J.TICEFAN],o=[new xd(8,14,5,J.TSUN,se.BUILDTOWER,5),new xd(10,12,10,J.TICEFAN,se.BUILDTOWER,3),new Nd(4,23,20,110,se.FINDTOWER,-4,"tball,")],Ce=Gd.create(5,22,500,1,3,"level 68",a,r,1.5,o,l.p(6*n+672*s,236*s)),r=[new Wd(1,J.LM3,10,3),new Wd(2,J.LM1,10,10),new Wd(3,J.LM2,12,16),new Wd(4,J.FTM,12,28),new Wd(5,J.FLM1,10,31),new Wd(6,J.FLM2,10,38),new Wd(7,J.LM3,10,120),new Wd(7,J.LM1,10,160),new Wd(8,J.LM2,10,400),new Wd(8,J.LM1,10,450),new Wd(9,J.FTM,10,1200),new Wd(9,J.LM3,12,899),new Wd(10,J.FTM,15,1900),new Wd(10,J.FLM1,5,1300),new Wd(11,J.LM2,10,2200),new Wd(11,J.FLM2,10,1700),new Wd(12,J.LM1,8,3e3),new Wd(12,J.SBL1,2,45),new Wd(12,J.LM45,5,2800),new Wd(13,J.SBL3,2,90.5),new Wd(13,J.LM3,8,3650),new Wd(13,J.FTM,8,4200),new Wd(14,J.FLM1,3,3400),new Wd(14,J.SBFL1,1,45),new Wd(14,J.FLM1,4,3300),new Wd(14,J.SBFL1,2,45),new Wd(14,J.FLM1,3,3500),new Wd(14,J.SBFL1,2,40),new Wd(15,J.FTM,5,5800),new Wd(15,J.SBFT,1,75),new Wd(15,J.FTM,10,6000.24),new Wd(15,J.SBFT,2,70.5),new Wd(16,J.BMT,1,45),new Wd(16,J.SBL3,1,95),new Wd(16,J.SBFT,1,135),new Wd(16,J.SBFL1,1,79),new Wd(16,J.SBFL2,1,80)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR,J.TBALL,J.TSUN,J.TMOON],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-80),new Nd(3,1,10,150,se.KILLOBJECT,1,",BC1Ob1,BC1Ob2,BC1Ob3,BC1Ob4,"),new Nd(4,10,10,290,se.KILLOBJECT,12,"")],ye=Gd.create(5,16,200,1,3,"level 69",a,r,1.5,o,l.p(6*n+749*s,385*s)),r=[new Wd(1,1,J.LM1,5,3),new Wd(1,2,J.LM3,5,3),new Wd(2,1,J.LM1,5,12),new Wd(2,2,J.LM1,5,12),new Wd(3,1,J.LM3,5,23),new Wd(3,2,J.LM3,5,23),new Wd(4,1,J.LM2,6,30),new Wd(4,2,J.LM1,6,30),new Wd(5,1,J.LM2,7,38),new Wd(5,2,J.LM3,7,38),new Wd(6,1,J.FTM,8,58),new Wd(6,2,J.LM1,8,49),new Wd(7,1,J.FTM,9,125),new Wd(7,2,J.FTM,9,125),new Wd(8,1,J.FLM1,5,110),new Wd(8,2,J.FLM1,5,110),new Wd(9,1,J.FTM,4,180),new Wd(9,1,J.FLM2,3,120),new Wd(9,2,J.FTM,4,180),new Wd(9,2,J.FLM2,3,120),new Wd(10,1,J.LM2,9,250),new Wd(10,1,J.SBL2,1,3.6),new Wd(10,2,J.LM1,9,250),new Wd(10,2,J.SBL1,1,3.6),new Wd(11,1,J.LM3,7,375),new Wd(11,1,J.SBFT,3,4),new Wd(11,2,J.LM3,7,375),new Wd(11,2,J.SBFT,3,4),new Wd(12,1,J.FLM1,5,315),new Wd(12,1,J.FLM2,5,325),new Wd(12,2,J.FLM2,5,315),new Wd(12,2,J.FLM1,5,325),new Wd(13,1,J.LM1,9,500),new Wd(13,1,J.SBFL1,1,4),new Wd(13,2,J.LM1,9,500),new Wd(13,2,J.SBFL1,1,4),new Wd(14,1,J.FTM,3,630),new Wd(14,1,J.FLM1,4,370),new Wd(14,1,J.FTM,5,655),new Wd(14,2,J.FTM,3,630),new Wd(14,2,J.FLM2,4,370),new Wd(14,2,J.FTM,5,655),new Wd(15,1,J.LM2,10,680),new Wd(15,1,J.SBL2,3,13.5),new Wd(15,2,J.LM3,10,680),new Wd(15,2,J.SBL3,3,13.5),new Wd(16,1,J.FLM1,10,660),new Wd(16,1,J.SBFL1,1,9.7),new Wd(16,2,J.FLM2,10,660),new Wd(16,2,J.SBFL2,1,9.7),new Wd(17,1,J.FTM,12,1100),new Wd(17,1,J.SBFT,1,19),new Wd(17,2,J.FTM,12,1100),new Wd(17,2,J.SBFT,1,19),new Wd(18,1,J.LM1,7,1e3),new Wd(18,1,J.FLM1,5,688),new Wd(18,2,J.LM1,7,1e3),new Wd(18,2,J.FLM2,5,688),new Wd(19,1,J.SBL1,2,17),new Wd(19,1,J.SBL2,2,19),new Wd(19,1,J.SBL3,2,20),new Wd(19,1,J.SBFT,2,24.4),new Wd(19,2,J.SBL1,2,17),new Wd(19,2,J.SBL2,2,19),new Wd(19,2,J.SBL3,2,20),new Wd(19,2,J.SBFT,2,24.4),new Wd(20,1,J.BMT,1,6.2),new Wd(20,1,J.SBFL1,3,11.5),new Wd(20,2,J.BMT,1,6.2),new Wd(20,2,J.SBFL2,3,11.5)],a=[J.TBOTTLE,J.TSUN,J.TBALL,J.TICEFAN,J.TFLASHLIGHT],o=[new xd(5,22,5,J.TBOTTLE,se.BUILDTOWER,1),new Nd(4,23,10,120,se.FINDTOWER,-1,"tmoon,"),new Nd(4,10,20,180,se.KILLOBJECT,33,"")],Be=Gd.create(5,20,700,1,3,"level 70",a,r,1.5,o,l.p(6*n+904*s,406*s)),r=[new Wd(1,J.FTM,10,6),new Wd(2,J.LM1,10,12),new Wd(3,J.LM2,15,35),new Wd(4,J.LM3,15,58),new Wd(4,J.FTM,5,80),new Wd(5,J.LM1,15,106),new Wd(5,J.LM2,10,115),new Wd(6,J.LM3,20,160),new Wd(6,J.FLM1,1,140),new Wd(7,J.LM2,15,220),new Wd(7,J.FLM1,5,150),new Wd(8,J.FLM2,4,186),new Wd(8,J.FLM2,6,186),new Wd(9,J.FLM1,3,210),new Wd(9,J.FLM1,7,220),new Wd(9,J.FLM2,4,245),new Wd(10,J.FTM,15,425),new Wd(10,J.SBFT,1,10.6),new Wd(11,J.LM1,15,480),new Wd(11,J.FLM1,10,250),new Wd(12,J.LM3,10,550),new Wd(12,J.FLM2,5,280),new Wd(12,J.SBFL2,1,5.5),new Wd(12,J.FLM2,5,300),new Wd(13,J.LM2,15,600),new Wd(13,J.FTM,8,750),new Wd(14,J.LM3,5,650),new Wd(14,J.LM1,5,650),new Wd(14,J.FLM1,5,300),new Wd(15,J.FLM2,5,360),new Wd(15,J.FLM2,10,380),new Wd(15,J.SBL1,3,9),new Wd(16,J.FTM,20,800),new Wd(16,J.SBFL1,3,4.5),new Wd(17,J.SBL1,5,14.6),new Wd(18,J.SBL2,1,15),new Wd(18,J.LM2,9,900),new Wd(18,J.SBL2,3,14),new Wd(19,J.LM3,8,900),new Wd(19,J.SBL3,2,12.6),new Wd(19,J.LM3,5,1000.9),new Wd(19,J.SBL3,3,13.6),new Wd(20,J.BMT,1,8),new Wd(20,J.SBFT,1,18),new Wd(20,J.SBFL1,1,6.5),new Wd(20,J.SBFL2,1,7.8)],a=[J.TSNOW,J.TBOTTLE,J.TSHIT,J.TSTAR,J.TSUN],o=[new xd(6,13,5,J.TSHIT,se.BUILDTOWER,4),new xd(7,23,20,J.TSTAR,se.KILLMONSTER,-80),new Nd(4,10,10,260,se.KILLOBJECT,21,"")],Fe=Gd.create(5,20,850,1,3,"level 71",a,r,2,o,l.p(7*n+75*s,266*s)),r=[new Wd(1,J.LM1,10,2),new Wd(2,J.LM2,6,4),new Wd(2,J.LM1,4,6),new Wd(3,J.LM3,5,8),new Wd(3,J.LM2,5,12),new Wd(4,J.LM1,7,13),new Wd(4,J.FLM1,3,6),new Wd(5,J.FLM1,10,12),new Wd(6,J.FTM,10,40),new Wd(6,J.FLM2,2,12),new Wd(7,J.LM3,10,45),new Wd(7,J.FLM2,3,22),new Wd(8,J.FLM1,7,40),new Wd(8,J.FLM2,7,44),new Wd(9,J.LM2,8,80),new Wd(9,J.FTM,8,120),new Wd(10,J.SBL1,1,4),new Wd(10,J.LM1,12,125),new Wd(11,J.SBL2,3,4),new Wd(11,J.LM2,10,150),new Wd(12,J.FLM1,8,180),new Wd(12,J.SBFL2,6,2),new Wd(13,J.SBL3,5,8.6),new Wd(13,J.SBFL1,5,2.5),new Wd(14,J.FTM,7,1100),new Wd(14,J.SBFT,3,15),new Wd(14,J.FTM,5,1200),new Wd(15,J.FLM2,10,700),new Wd(16,J.LM1,8,1100),new Wd(16,J.LM2,8,1180),new Wd(17,J.LM3,12,1500),new Wd(18,J.LM1,5,1580),new Wd(18,J.SBL2,5,18.8),new Wd(18,J.FLM1,5,550),new Wd(19,J.FTM,12,2200),new Wd(20,J.SBL1,1,28),new Wd(20,J.SBL2,1,30),new Wd(20,J.SBL3,1,33),new Wd(20,J.SBFL1,1,14),new Wd(20,J.SBFL2,1,16),new Wd(21,J.LM2,8,2400),new Wd(21,J.FLM1,5,800),new Wd(21,J.FTM,5,2700),new Wd(22,J.BMT,1,10),new Wd(22,J.FLM2,8,1200),new Wd(23,J.FLM1,8,1550),new Wd(23,J.FLM2,8,1460),new Wd(24,J.LM1,5,3200),new Wd(24,J.LM3,5,3e3),new Wd(24,J.SBFL1,5,16),new Wd(25,J.SBFT,3,46),new Wd(25,J.SBFL2,2,20),new Wd(25,J.SBL2,2,38)],a=[J.TBALL,J.TMOON,J.TARROW,J.TFLASHLIGHT,J.TMAGNET],o=[new xd(12,16,5,J.TFLASHLIGHT,se.BUILDTOWER,7),new Nd(4,7,20,210,se.KILLOBJECT,7,",L2Ob1,L2Ob2,L2Ob3,L2Ob4,L2Ob5,L2Ob6,L2Ob7,"),new Nd(2,21,10,900,se.KILLOBJECT,1,",DB1Ob1,")],Ee=Gd.create(5,25,300,1,3,"level 72",a,r,1.3,o,l.p(7*n+190*s,404*s),0,1,75e4),r=[new Wd(1,J.LM1,5,2e3),new Wd(1,J.FTM,5,3e3),new Wd(2,J.SBFT,5,50),new Wd(2,J.BM1,1,105)],a=[J.TFLASHLIGHT,J.TROCKET,J.TSNOW],o=[new xd(9,23,20,J.TBALL,se.KILLMONSTER,-10),new Nd(4,24,5,30,se.KILLOBJECT,3,",S3Ob3,S3Ob10,S1Ob14,"),new Nd(4,23,10,99,se.KILLOBJECT,6,",S2Ob4,S2Ob8,S2Ob17,S2Ob22,S2Ob24,S2Ob27,")],Pe=Gd.create(5,2,1250,1,60,"level 73",a,r,1.8,o,l.p(7*n+300*s,327*s),150),r=[new Wd(1,J.LM2,5,5),new Wd(1,J.LM3,5,5),new Wd(2,J.LM1,5,10),new Wd(2,J.LM3,5,10),new Wd(3,J.LM1,6,15),new Wd(3,J.LM3,6,15),new Wd(4,J.LM1,5,20),new Wd(4,J.FTM,7,30),new Wd(5,J.LM2,6,30),new Wd(5,J.LM3,7,30),new Wd(6,J.LM3,7,45),new Wd(6,J.FTM,8,60),new Wd(7,J.LM2,8,80),new Wd(7,J.LM3,8,75),new Wd(8,J.LM1,9,100),new Wd(8,J.FTM,9,150),new Wd(9,J.LM2,8,120),new Wd(9,J.FLM1,6,60),new Wd(10,J.SBL3,5,5.5),new Wd(10,J.SBL3,5,4),new Wd(11,J.LM1,12,235),new Wd(11,J.FLM2,3,199),new Wd(12,J.FTM,12,380),new Wd(12,J.FLM1,3,200),new Wd(13,J.LM1,12,462),new Wd(13,J.LM3,8,520),new Wd(14,J.LM1,12,500),new Wd(14,J.FLM1,8,270),new Wd(15,J.FTM,10,700),new Wd(15,J.SBFT,5,12),new Wd(16,J.FTM,10,750),new Wd(16,J.FLM2,10,350),new Wd(17,J.LM3,10,750),new Wd(17,J.FLM1,12,420),new Wd(18,J.FLM1,10,700),new Wd(18,J.FLM2,10,760),new Wd(19,J.SBL1,5,18),new Wd(19,J.SBL2,5,16),new Wd(20,J.BMT,1,13.5),new Wd(20,J.SBFL1,2,15.5),new Wd(20,J.SBFL2,2,13)],a=[J.TSHIT,J.TBALL,J.TARROW,J.TFLASHLIGHT,J.TMOON],o=[new xd(11,22,10,J.TMOON,se.BUILDTOWER,1),new xd(13,23,10,J.TARROW,se.KILLMONSTER,-100),new Nd(4,5,10,200,se.KILLOBJECT,5,",L3Ob1,L3Ob2,L3Ob3,L3Ob4,L3Ob5,")],be=Gd.create(5,20,300,1,3,"level 74",a,r,1.2,o,l.p(7*n+192*s,119*s)),r=[new Wd(1,J.LM2,8,2),new Wd(2,J.LM1,5,7),new Wd(2,J.LM3,5,8),new Wd(3,J.LM2,6,10),new Wd(3,J.LM3,6,15),new Wd(4,J.LM1,5,19),new Wd(4,J.FTM,7,27),new Wd(5,J.LM3,7,30),new Wd(5,J.LM2,7,38),new Wd(6,J.FTM,12,52),new Wd(7,J.LM1,10,55),new Wd(7,J.FLM1,3,26),new Wd(8,J.FLM1,12,50),new Wd(9,J.FLM2,2,62),new Wd(9,J.FTM,8,110),new Wd(9,J.FLM2,3,65),new Wd(10,J.SBL1,1,2),new Wd(10,J.SBL2,2,2.2),new Wd(10,J.SBL3,3,2.9),new Wd(11,J.LM3,12,280),new Wd(11,J.LM45,1,300),new Wd(12,J.FLM2,12,242),new Wd(13,J.LM1,8,400),new Wd(13,J.LM2,8,400),new Wd(14,J.FLM2,8,300),new Wd(14,J.FLM1,8,310),new Wd(15,J.FTM,12,750),new Wd(15,J.SBFT,3,10.6),new Wd(16,J.FTM,6,800),new Wd(16,J.FLM2,8,350),new Wd(16,J.LM3,6,600),new Wd(17,J.FTM,6,850),new Wd(17,J.LM3,6,750),new Wd(17,J.FLM1,8,400),new Wd(18,J.FLM1,7,650),new Wd(18,J.FLM2,7,650),new Wd(18,J.LM45,3,600),new Wd(19,J.SBL1,6,12),new Wd(19,J.SBL2,6,11.5),new Wd(20,J.SBFL1,5,9),new Wd(20,J.SBFL2,5,8),new Wd(21,J.FTM,20,1350),new Wd(22,J.LM1,10,1e3),new Wd(22,J.LM2,10,1e3),new Wd(22,J.LM3,10,1e3)],a=[J.TBOTTLE,J.TSTAR,J.TICEFAN,J.TARROW],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-300),new Nd(4,3,10,160,se.KILLOBJECT,3,",B1Ob1,B1Ob2,B1Ob3,"),new Nd(2,21,10,900,se.KILLOBJECT,1,",DB2Ob1,")],Ae=Gd.create(5,22,450,1,3,"level 75",a,r,2,o,l.p(7*n+428*s,93*s),0,1,95e4),r=[new Wd(1,J.LM1,8,10),new Wd(2,J.LM1,5,15),new Wd(2,J.LM3,5,15),new Wd(3,J.LM2,5,25),new Wd(3,J.LM3,5,25),new Wd(4,J.LM1,5,35),new Wd(4,J.FTM,7,45.5),new Wd(5,J.FTM,12,60),new Wd(6,J.LM3,10,100),new Wd(6,J.FLM1,3,50),new Wd(7,J.FLM2,10,80),new Wd(8,J.FTM,10,200),new Wd(8,J.FLM1,5,100),new Wd(9,J.FLM2,6,150),new Wd(9,J.FLM1,6,150),new Wd(10,J.SBFL1,5,5.5),new Wd(11,J.LM1,7,600),new Wd(11,J.LM2,7,600),new Wd(12,J.FTM,15,800),new Wd(12,J.SBFL2,1,6),new Wd(13,J.LM3,15,1e3),new Wd(14,J.SBFL2,1,10),new Wd(14,J.FLM2,7,600),new Wd(14,J.SBFL2,2,10),new Wd(15,J.FTM,10,1800),new Wd(15,J.SBFT,5,20),new Wd(16,J.LM2,15,1800),new Wd(17,J.SBL2,10,35),new Wd(18,J.LM1,10,2400),new Wd(18,J.LM3,10,2400),new Wd(19,J.SBL1,4,50),new Wd(19,J.SBL3,4,45),new Wd(20,J.SBFL1,5,35),new Wd(20,J.BMT,1,50),new Wd(20,J.SBFL2,4,25)],a=[J.TRANDOM],o=[new xd(12,23,20,J.TFLASHLIGHT,se.KILLMONSTER,-80),new Nd(4,23,10,200,se.FINDTOWER,-2,"tflashght,"),new Nd(4,2,5,75,se.KILLOBJECT,2,",L2Ob1,L2Ob2,")],Oe=Gd.create(5,20,500,1,3,"level 76",a,r,1.3,o,l.p(7*n+467*s,286*s)),r=[new Wd(1,J.SBL3,6,65),new Wd(1,J.SBL1,6,60),new Wd(2,J.BM2,1,330)],a=[J.TBOTTLE,J.TSUN,J.TMOON,J.TMAGNET],o=[new xd(19,4,5,J.TMAGNET,se.BUILDTOWER,-4),new xd(16,23,20,J.TFISH,se.KILLMONSTER,-8),new Nd(4,21,20,130,se.KILLOBJECT,9,",B1Ob1,B2Ob1,B2Ob2,B2Ob3,B2Ob4,B2Ob5,B2Ob6,B2Ob7,B2Ob8,")],Ie=Gd.create(5,2,1600,1,120,"level 77",a,r,1,o,l.p(7*n+421*s,462*s),200),r=[new Wd(1,J.LM3,10,1),new Wd(2,J.LM1,10,2),new Wd(3,J.LM2,12,6),new Wd(4,J.FTM,12,15),new Wd(5,J.FLM1,10,15),new Wd(6,J.FLM2,10,25),new Wd(7,J.LM3,5,70),new Wd(7,J.LM1,5,60),new Wd(8,J.LM2,6,120),new Wd(8,J.LM1,6,100),new Wd(9,J.FTM,6,160),new Wd(9,J.LM3,6,120),new Wd(10,J.FTM,8,200),new Wd(10,J.FLM1,5,60),new Wd(11,J.FLM1,10,120),new Wd(11,J.FLM2,10,100),new Wd(12,J.LM2,10,200),new Wd(12,J.FLM2,10,150),new Wd(13,J.LM1,5,300),new Wd(13,J.SBL1,2,4),new Wd(13,J.LM1,8,300),new Wd(14,J.LM45,5,380),new Wd(15,J.SBL3,5,5.5),new Wd(15,J.LM3,8,400),new Wd(15,J.FTM,8,480),new Wd(16,J.FLM1,3,320),new Wd(16,J.SBFL1,1,4.7),new Wd(16,J.FLM1,4,350),new Wd(16,J.SBFL1,2,4.8),new Wd(16,J.FLM1,3,370),new Wd(16,J.SBFL1,2,5.35),new Wd(17,J.FTM,5,800),new Wd(17,J.SBFT,1,9.8),new Wd(17,J.FTM,8,750),new Wd(17,J.SBFT,4,9.8),new Wd(18,J.SBL1,2,12.5),new Wd(18,J.SBL2,2,11),new Wd(18,J.SBL3,3,12.5),new Wd(19,J.BMT,1,9.2),new Wd(19,J.SBL3,1,15),new Wd(19,J.SBFT,1,18),new Wd(19,J.SBFL1,1,7),new Wd(19,J.SBFL2,1,7.5)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR,J.TROCKET,J.TARROW,J.TMAGNET],o=[new xd(6,12,10,J.TSHIT,se.BUILDTOWER,3),new Nd(4,10,10,250,se.KILLOBJECT,41,""),new Nd(4,1,10,130,se.KILLOBJECT,1,",B1Ob1,")],Re=Gd.create(5,19,200,1,3,"level 78",a,r,.8,o,l.p(7*n+707*s,392*s)),r=[new Wd(1,J.FTM,10,2),new Wd(2,J.LM1,10,10),new Wd(3,J.LM2,4,18),new Wd(3,J.LM3,6,20),new Wd(4,J.LM1,5,30),new Wd(4,J.LM2,5,33),new Wd(5,J.LM3,7,30),new Wd(5,J.FLM1,3,10),new Wd(6,J.FLM2,5,15),new Wd(6,J.FTM,7,115),new Wd(7,J.LM2,8,100),new Wd(7,J.LM45,2,100),new Wd(8,J.LM1,5,113),new Wd(8,J.FLM1,7,30),new Wd(9,J.LM3,5,220),new Wd(9,J.FLM2,9,50),new Wd(10,J.SBFL1,4,3.8),new Wd(10,J.LM45,1,250),new Wd(11,J.SBL2,6,8.2),new Wd(12,J.FTM,12,1e3),new Wd(13,J.LM1,8,1100),new Wd(13,J.SBFL2,3,5),new Wd(14,J.LM2,6,1400),new Wd(14,J.LM3,6,1450),new Wd(15,J.SBFT,2,21),new Wd(15,J.FTM,5,2e3),new Wd(15,J.SBFT,3,23.2),new Wd(16,J.SBFL2,6,15),new Wd(17,J.LM2,8,2e3),new Wd(17,J.LM1,8,2100),new Wd(18,J.SBFT,5,25),new Wd(18,J.LM3,10,2300),new Wd(19,J.SBL1,5,28),new Wd(19,J.SBL3,5,30.3),new Wd(20,J.SBFL1,2,20),new Wd(20,J.SBFL2,2,21),new Wd(20,J.LM45,2,2400),new Wd(20,J.SBFL1,2,22),new Wd(20,J.SBFL2,2,23.5)],a=[J.TSUN,J.TICEFAN,J.TBALL,J.TPLANE,J.TMOON],o=[new xd(9,23,20,J.TBALL,se.KILLMONSTER,-150),new xd(11,22,5,J.TMOON,se.BUILDTOWER,1),new Nd(4,10,10,300,se.KILLOBJECT,33,"")],De=Gd.create(5,20,200,1,3,"level 79",a,r,1.45,o,l.p(7*n+648*s,175*s),0,1,72e4),r=[new Wd(1,J.FLM1,5,10),new Wd(1,J.FLM2,5,10),new Wd(1,J.SBB,1,140),new Wd(2,J.LM3,5,102.97),new Wd(2,J.LM1,5,102.97),new Wd(3,J.LM3,5,149.78),new Wd(3,J.LM2,5,149.78),new Wd(4,J.LM1,5,196.59),new Wd(4,J.LM2,5,196.59),new Wd(5,J.FLM1,5,300),new Wd(5,J.LM3,5,486.79),new Wd(6,J.FLM1,6,380.28),new Wd(6,J.FLM2,6,380.28),new Wd(7,J.LM2,6,823.13),new Wd(7,J.LM3,6,823.13),new Wd(8,J.FTM,8,1279.03),new Wd(8,J.FLM2,4,746.1),new Wd(9,J.LM2,8,1308.58),new Wd(9,J.FLM1,4,900),new Wd(10,J.LM1,6,1551.31),new Wd(10,J.LM3,6,1551.31),new Wd(10,J.SBFL1,1,12),new Wd(11,J.LM2,7,1906.37),new Wd(11,J.FTM,7,2287.64),new Wd(11,J.SBL2,1,22),new Wd(12,J.FLM2,7,1300.11),new Wd(12,J.LM43,1,2200),new Wd(12,J.FTM,7,2736.18),new Wd(13,J.FLM1,7,1679.12),new Wd(13,J.FLM2,7,1679.12),new Wd(14,J.FLM2,7,1862.14),new Wd(14,J.LM1,7,2703.05),new Wd(15,J.LM1,7,2864.5),new Wd(15,J.FLM2,5,1850.15),new Wd(15,J.SBFT,1,60),new Wd(16,J.FLM2,8,2393.69),new Wd(16,J.LM45,1,5e3),new Wd(16,J.LM2,8,3419.56),new Wd(17,J.FLM2,8,2589.81),new Wd(17,J.LM2,8,3699.73),new Wd(18,J.LM3,13,3979.9),new Wd(18,J.FLM2,2,2785.93),new Wd(19,J.FLM1,8,2975.5),new Wd(19,J.LM44,1,5500),new Wd(19,J.FLM2,8,2975.5),new Wd(20,J.LM1,8,7000.89),new Wd(20,J.LM42,1,5500),new Wd(20,J.FTM,8,9500.6)],a=[J.TICEFAN,J.TROCKET,J.TPLANE,J.TFLASHLIGHT],o=[new xd(12,10,5,J.TFLASHLIGHT,se.BUILDTOWER,-10),new xd(15,23,20,J.TPLANE,se.KILLMONSTER,-90),new Nd(4,10,10,100,se.KILLOBJECT,7,"")],xe=Gd.create(5,20,850,1,3,"level 80",a,r,1,o,l.p(7*n+891*s,231*s)),r=[new Wd(1,1,J.LM2,8,1.5),new Wd(1,2,J.LM3,8,1.5),new Wd(2,1,J.LM1,10,15),new Wd(2,2,J.LM1,10,15),new Wd(3,1,J.LM3,10,23),new Wd(3,2,J.LM2,10,23),new Wd(4,1,J.FTM,10,40),new Wd(4,2,J.FTM,10,40),new Wd(5,1,J.FLM1,10,45),new Wd(5,2,J.FLM1,10,45),new Wd(6,1,J.FTM,8,100),new Wd(6,1,J.FLM2,3,40),new Wd(6,2,J.FTM,8,100),new Wd(6,2,J.FLM2,3,36),new Wd(7,1,J.FLM1,6,70),new Wd(7,1,J.FLM2,6,75),new Wd(7,2,J.FLM1,6,70),new Wd(7,2,J.FLM2,6,75),new Wd(8,1,J.SBL1,1,5),new Wd(8,2,J.SBL1,1,5),new Wd(9,1,J.LM2,7,190),new Wd(9,1,J.LM3,7,200),new Wd(9,2,J.LM2,7,190),new Wd(9,2,J.LM3,7,200),new Wd(10,1,J.SBFT,2,10),new Wd(10,2,J.SBFT,2,9.7),new Wd(11,1,J.LM1,10,260),new Wd(11,1,J.SBFL1,3,2.8),new Wd(11,2,J.LM1,10,250),new Wd(11,2,J.SBFL1,3,2.6),new Wd(12,1,J.SBFL2,3,8.38),new Wd(12,2,J.SBFL2,3,8.1),new Wd(13,1,J.LM1,7,750),new Wd(13,1,J.LM3,7,780),new Wd(13,2,J.LM1,7,740),new Wd(13,2,J.LM3,7,777),new Wd(14,1,J.LM2,6,920),new Wd(14,1,J.FTM,8,1220),new Wd(14,2,J.LM2,6,880),new Wd(14,2,J.FTM,8,1100),new Wd(15,1,J.SBL1,1,17.5),new Wd(15,1,J.LM44,1,952),new Wd(15,1,J.SBL2,1,19.3),new Wd(15,1,J.SBL3,1,25),new Wd(15,2,J.SBL1,1,17.5),new Wd(15,2,J.LM44,1,944),new Wd(15,2,J.SBL2,1,19.3),new Wd(15,2,J.SBL3,1,25),new Wd(16,1,J.FTM,5,1480),new Wd(16,1,J.FLM1,5,560),new Wd(16,1,J.FLM2,5,580),new Wd(16,2,J.FTM,5,1450),new Wd(16,2,J.FLM1,5,518),new Wd(16,2,J.FLM2,5,540),new Wd(17,1,J.SBL1,4,17.5),new Wd(17,1,J.SBL3,4,20),new Wd(17,1,J.SBFL1,1,8),new Wd(17,2,J.SBL2,4,16),new Wd(17,2,J.SBL3,4,18),new Wd(17,2,J.SBFL2,1,8),new Wd(18,1,J.BMT,1,19),new Wd(18,1,J.LM42,5,880),new Wd(18,2,J.BMT,1,18),new Wd(18,2,J.LM44,5,750)],a=[J.TMOON,J.TICEFAN,J.TFLASHLIGHT,J.TANCHOR,J.TFISH],o=[new xd(10,23,20,J.TICEFAN,se.KILLMONSTER,-70),new xd(11,11,10,J.TMOON,se.BUILDTOWER,2),new Nd(4,2,10,210,se.KILLOBJECT,2,",B1Ob1,B1Ob2,")],Ne=Gd.create(6,18,800,1,3,"level 81",a,r,2,o,l.p(8*n+69*s,409*s)),r=[new Wd(1,J.LM1,8,2),new Wd(2,J.LM3,5,5),new Wd(2,J.LM1,5,5),new Wd(3,J.LM2,5,10),new Wd(3,J.LM3,5,9),new Wd(4,J.FTM,7,25),new Wd(4,J.LM1,5,15),new Wd(5,J.FTM,12,50),new Wd(6,J.LM3,10,50),new Wd(6,J.FLM1,3,23),new Wd(7,J.FLM2,5,40),new Wd(7,J.FLM2,5,40),new Wd(8,J.FTM,10,100),new Wd(8,J.FLM1,5,50),new Wd(9,J.FLM2,6,80),new Wd(9,J.FLM1,6,85),new Wd(10,J.SBFL1,1,1.8),new Wd(10,J.SBFL1,2,2.2),new Wd(10,J.SBFL1,2,2.52),new Wd(11,J.LM1,7,345),new Wd(11,J.LM2,7,370),new Wd(12,J.FTM,15,500),new Wd(12,J.SBFL2,1,3.8),new Wd(13,J.LM43,2,650),new Wd(13,J.LM3,8,600),new Wd(14,J.SBFL2,1,8.5),new Wd(14,J.FLM2,7,530),new Wd(14,J.SBFL2,2,8.3),new Wd(15,J.FTM,10,1100),new Wd(15,J.SBFT,5,15),new Wd(16,J.LM2,6,1400),new Wd(16,J.LM2,9,1600),new Wd(17,J.SBL2,3,18.5),new Wd(17,J.LM43,1,2e3),new Wd(17,J.SBL2,5,19),new Wd(18,J.LM1,5,1700),new Wd(18,J.LM43,5,1450),new Wd(18,J.LM3,5,1800),new Wd(19,J.SBL1,5,25.6),new Wd(19,J.SBL3,5,29),new Wd(20,J.SBFL1,5,24),new Wd(20,J.BMT,1,22),new Wd(20,J.SBFL2,5,25.5)],a=[J.TBOTTLE,J.TSTAR,J.TBALL,J.TPLANE,J.TFISH,J.TMAGNET,J.TSNOW],o=[new xd(7,23,10,J.TSTAR,se.KILLMONSTER,-100),new xd(20,12,5,J.TSNOW,se.BUILDTOWER,3),new Nd(4,10,20,320,se.KILLOBJECT,31,"")],Ge=Gd.create(6,20,222,1,3,"level 82",a,r,1.9,o,l.p(8*n+308*s,375*s)),r=[new Wd(1,J.SBL1,1,1.1),new Wd(2,J.SBL2,1,2),new Wd(3,J.SBFT,1,3.8),new Wd(4,J.SBL3,1,3.7),new Wd(5,J.SBFL1,1,2.5),new Wd(6,J.SBFL2,1,3),new Wd(7,J.SBL1,2,4.3),new Wd(8,J.SBL2,2,8.3),new Wd(9,J.SBFT,2,15),new Wd(10,J.SBL3,2,16.2),new Wd(11,J.SBFL1,2,14.8),new Wd(12,J.SBFL2,2,18),new Wd(13,J.SBL1,3,23.2),new Wd(14,J.SBL2,3,26.3),new Wd(15,J.SBFT,3,42),new Wd(16,J.SBL3,3,44),new Wd(17,J.SBFL1,3,35.3),new Wd(18,J.SBFL2,3,39.5),new Wd(19,J.BMT,1,22)],a=[J.TBOTTLE,J.TSHIT,J.TSUN,J.TBALL,J.TARROW,J.TANCHOR,J.TFLASHLIGHT,J.TROCKET,J.TICEFAN,J.TMOON],o=[new xd(13,23,10,J.TARROW,se.KILLMONSTER,-10),new xd(11,11,5,J.TMOON,se.BUILDTOWER,2),new Nd(3,10,20,240,se.KILLOBJECT,15,"")],We=Gd.create(6,19,1888,3,5,"level 83",a,r,1.9,o,l.p(8*n+351*s,198*s)),r=[new Wd(1,1,J.LM2,5,5),new Wd(1,2,J.LM3,5,5),new Wd(2,1,J.LM1,6,15),new Wd(2,2,J.LM2,6,15),new Wd(3,1,J.LM3,7,25),new Wd(3,2,J.LM1,7,25),new Wd(4,1,J.FTM,8,43),new Wd(4,1,J.LM2,5,30),new Wd(4,2,J.FTM,8,43),new Wd(4,2,J.LM3,5,30),new Wd(5,1,J.FTM,8,60),new Wd(5,1,J.FLM1,5,30),new Wd(5,2,J.FTM,8,60),new Wd(5,2,J.FLM2,5,30),new Wd(6,1,J.FLM2,10,55),new Wd(6,2,J.FLM1,10,55),new Wd(7,1,J.SBL1,1,2.6),new Wd(7,2,J.SBL1,1,2.6),new Wd(8,1,J.SBL2,1,3.5),new Wd(8,1,J.SBL2,1,3.5),new Wd(8,1,J.SBL2,1,3.5),new Wd(8,2,J.SBL2,1,3.5),new Wd(8,2,J.SBL2,1,3.5),new Wd(8,2,J.SBL2,1,3.5),new Wd(9,1,J.FLM1,5,180),new Wd(9,1,J.FLM2,5,180),new Wd(9,2,J.FLM1,5,180),new Wd(9,2,J.FLM2,5,180),new Wd(10,1,J.SBFT,4,7),new Wd(10,2,J.SBFT,4,7),new Wd(11,1,J.BMT,1,3.33),new Wd(11,2,J.BMT,1,3.33),new Wd(12,1,J.LM2,8,420),new Wd(12,1,J.LM3,8,450),new Wd(12,2,J.LM2,8,420),new Wd(12,2,J.LM3,8,450),new Wd(13,1,J.SBFL1,2,7.5),new Wd(13,1,J.SBFL2,3,9),new Wd(13,2,J.SBFL2,2,7.5),new Wd(13,2,J.SBFL1,3,9),new Wd(14,1,J.FTM,8,830),new Wd(14,1,J.SBFT,2,12.5),new Wd(14,1,J.SBFT,3,11.6),new Wd(14,2,J.FTM,8,830),new Wd(14,2,J.SBFT,2,12.5),new Wd(14,2,J.SBFT,3,11.6),new Wd(15,1,J.LM2,10,1150),new Wd(15,2,J.LM2,10,1150),new Wd(16,1,J.LM3,5,1250),new Wd(16,1,J.LM43,3,1100),new Wd(16,2,J.LM3,5,1250),new Wd(16,2,J.LM43,3,1100),new Wd(17,1,J.SBL3,1,20),new Wd(17,1,J.SBL2,1,21.5),new Wd(17,1,J.SBL1,1,23),new Wd(17,2,J.SBL3,1,20),new Wd(17,2,J.SBL2,1,21.5),new Wd(17,2,J.SBL1,1,23),new Wd(18,1,J.BMT,1,8),new Wd(18,1,J.SBFT,3,23),new Wd(18,1,J.SBFL2,2,10.8),new Wd(18,2,J.BMT,1,8),new Wd(18,2,J.SBFT,3,23),new Wd(18,2,J.SBFL1,2,10.8)],a=[J.TBOTTLE,J.TSTAR,J.TBALL,J.TPLANE,J.TFLASHLIGHT,J.TMOON,J.TFISH,J.TCUTTLE],o=[new xd(18,23,10,J.TCUTTLE,se.KILLMONSTER,-180),new xd(11,11,5,J.TMOON,se.BUILDTOWER,2),new Nd(4,10,10,230,se.KILLOBJECT,5,",S3Ob1,S3Ob2,S3Ob3,B2Ob1,B2Ob2,")],ke=Gd.create(6,18,666,1,3,"level 84",a,r,3.3,o,l.p(8*n+509*s,169*s)),r=[new Wd(1,J.LM2,8,8),new Wd(2,J.LM1,5,35),new Wd(2,J.LM3,5,40),new Wd(3,J.LM2,6,48),new Wd(3,J.LM3,6,55),new Wd(4,J.LM1,5,60),new Wd(4,J.FTM,7,80),new Wd(5,J.LM3,7,90),new Wd(5,J.LM2,7,100),new Wd(6,J.FTM,12,150),new Wd(7,J.LM1,10,170),new Wd(7,J.FLM1,3,88),new Wd(8,J.FLM1,9,155),new Wd(8,J.LM43,1,230),new Wd(9,J.FLM2,2,190),new Wd(9,J.FTM,8,450),new Wd(9,J.FLM2,3,200),new Wd(10,J.SBL1,1,5.5),new Wd(10,J.SBL2,2,4),new Wd(10,J.SBL3,3,4),new Wd(11,J.FLM2,8,340),new Wd(11,J.SBL3,3,7),new Wd(12,J.FLM1,8,380),new Wd(12,J.SBL2,3,7),new Wd(13,J.LM2,5,800),new Wd(13,J.LM43,2,600),new Wd(14,J.LM43,4,700),new Wd(15,J.FTM,12,1200),new Wd(15,J.SBFT,3,14),new Wd(16,J.FTM,6,1400),new Wd(16,J.LM3,6,1100),new Wd(16,J.FLM2,5,580),new Wd(17,J.FTM,6,1500),new Wd(17,J.LM3,6,1200),new Wd(17,J.FLM1,5,580),new Wd(18,J.FLM1,8,780),new Wd(18,J.FLM2,8,810),new Wd(19,J.SBL1,6,15),new Wd(19,J.SBL2,6,13),new Wd(20,J.SBFL1,5,12),new Wd(20,J.SBFL2,5,11),new Wd(21,J.SBFT,5,32),new Wd(22,J.LM3,5,2e3)],a=[J.TBOTTLE,J.TSUN,J.TBALL,J.TROCKET,J.TPLANE,J.TANCHOR,J.TMAGNET,J.TSNOW],o=[new xd(20,23,20,J.TSNOW,se.KILLMONSTER,-20),new Nd(4,7,10,210,se.KILLOBJECT,7,",B1Ob1,B1Ob2,B1Ob3,B1Ob4,B1Ob5,B1Ob6,B1Ob7,"),new Nd(2,21,10,800,se.KILLOBJECT,1,",DB1Ob1,")],Ue=Gd.create(6,22,1300,1,3,"level 85",a,r,1.7,o,l.p(8*n+636*s,300*s),0,1,35e4),r=[new Wd(1,J.FTM,10,8),new Wd(2,J.LM2,6,28),new Wd(2,J.LM1,4,33),new Wd(3,J.LM3,5,35),new Wd(3,J.LM2,5,40),new Wd(4,J.LM1,7,45),new Wd(4,J.FLM1,3,30),new Wd(5,J.FLM1,10,50),new Wd(6,J.FTM,10,200),new Wd(6,J.FLM2,3,80),new Wd(7,J.LM3,10,250),new Wd(7,J.LM42,1,330),new Wd(8,J.FLM1,8,250),new Wd(8,J.FLM2,8,266),new Wd(9,J.LM2,10,600),new Wd(9,J.FTM,10,750),new Wd(10,J.SBL1,1,12),new Wd(10,J.LM1,15,800),new Wd(11,J.LM2,10,900),new Wd(11,J.SBL2,5,12.5),new Wd(12,J.FLM1,8,850),new Wd(12,J.SBFL2,8,12),new Wd(13,J.SBFL1,5,16),new Wd(13,J.SBL3,5,28),new Wd(14,J.FTM,10,2200),new Wd(14,J.SBFT,3,32),new Wd(14,J.FTM,5,2400),new Wd(15,J.LM42,5,2e3),new Wd(16,J.LM1,8,2600),new Wd(16,J.FLM1,5,1300),new Wd(16,J.SBL2,5,30),new Wd(17,J.LM2,10,2800),new Wd(17,J.LM42,1,2400),new Wd(17,J.FTM,5,3400),new Wd(18,J.BMT,1,33),new Wd(18,J.FLM2,9,2200)],a=[J.TBOTTLE,J.TSHIT],o=[new xd(20,23,20,J.TSNOW,se.KILLMONSTER,-25),new Nd(4,23,10,160,se.FINDTOWER,-4,"tflashght,"),new Nd(4,8,10,180,se.KILLOBJECT,8,",L3Ob1,L3Ob2,L3Ob3,L3Ob4,L3Ob5,L3Ob6,L3Ob7,L3Ob8,")],He=Gd.create(6,18,555,1,3,"level 86",a,r,2,o,l.p(8*n+550*s,494*s)),r=[new Wd(1,J.LM3,8,10),new Wd(2,J.LM1,8,15),new Wd(3,J.LM2,8,25),new Wd(4,J.FTM,8,40),new Wd(5,J.FLM1,10,25),new Wd(6,J.FLM2,10,36),new Wd(7,J.LM3,6,65),new Wd(7,J.LM1,6,70),new Wd(8,J.LM2,7,80),new Wd(8,J.LM1,7,90),new Wd(9,J.FTM,8,200),new Wd(9,J.LM3,8,150),new Wd(10,J.FTM,10,200),new Wd(10,J.FLM1,5,90),new Wd(11,J.FLM1,10,135),new Wd(11,J.FLM2,10,120),new Wd(12,J.LM2,8,288),new Wd(12,J.LM41,1,310),new Wd(13,J.LM1,5,480),new Wd(13,J.SBL1,2,7),new Wd(13,J.LM1,8,530),new Wd(14,J.SBL3,5,8),new Wd(14,J.LM3,8,600),new Wd(14,J.FTM,8,820),new Wd(15,J.FLM1,3,700),new Wd(15,J.SBFL1,1,14),new Wd(15,J.FLM1,3,600),new Wd(15,J.SBFL1,2,12),new Wd(15,J.FLM1,3,600),new Wd(15,J.SBFL1,2,14),new Wd(16,J.FTM,5,2300),new Wd(16,J.SBFT,1,25.5),new Wd(16,J.FTM,8,2e3),new Wd(16,J.SBFT,4,24),new Wd(17,J.SBL1,1,34),new Wd(17,J.SBL2,2,32.5),new Wd(17,J.SBL3,3,30),new Wd(17,J.LM44,2,1700.2),new Wd(18,J.BMT,1,24),new Wd(18,J.SBL3,1,45),new Wd(18,J.SBFT,1,55),new Wd(18,J.SBFL1,1,32),new Wd(18,J.SBFL2,1,26.2)],a=[J.TSNOW,J.TICEFAN,J.TMAGNET],o=[new Nd(4,2,10,260,se.KILLOBJECT,2,",B1Ob1,B1Ob2,"),new Nd(4,23,10,200,se.FINDTOWER,-2,"tcuttle,"),new xd(19,23,20,J.TMAGNET,se.KILLMONSTER,-40)],Ve=Gd.create(6,18,700,1,3,"level 87",a,r,1.5,o,l.p(8*n+872*s,497*s)),r=[new Wd(1,J.LM1,10,14e3),new Wd(2,J.LM2,10,15e3),new Wd(3,J.LM3,10,16e3),new Wd(4,J.BM1,1,450)],a=[J.TBALL,J.TANCHOR,J.TCUTTLE],o=[new xd(9,13,5,J.TBALL,se.BUILDTOWER,4),new Nd(4,2,20,80,se.KILLOBJECT,2,",L3Ob1,L3Ob2,"),new Nd(4,10,20,150,se.KILLOBJECT,22,"")],ze=Gd.create(6,4,18888,1,55,"level 88",a,r,4,o,l.p(8*n+868*s,315*s),240),r=[new Wd(1,J.LM1,10,4),new Wd(2,J.LM2,8,20),new Wd(3,J.LM3,6,28),new Wd(4,J.FLM1,5,33),new Wd(5,J.FTM,5,80),new Wd(6,J.FLM2,5,72),new Wd(7,J.SBL1,1,2),new Wd(8,J.SBL2,1,2.5),new Wd(8,J.SBL2,1,2),new Wd(9,J.SBFT,3,4),new Wd(10,J.SBL3,3,4.66),new Wd(10,J.LM44,1,400),new Wd(11,J.SBFL1,3,6.2),new Wd(12,J.SBFL2,3,6.3),new Wd(12,J.LM44,2,410),new Wd(13,J.SBL1,3,10.4),new Wd(13,J.SBL1,2,12.6),new Wd(14,J.SBL2,2,12),new Wd(14,J.SBL2,2,13.5),new Wd(14,J.SBL2,2,14.5),new Wd(15,J.SBFT,5,19),new Wd(15,J.LM44,3,600.2),new Wd(16,J.SBL3,8,18.3),new Wd(17,J.LM44,3,766.2),new Wd(17,J.SBFL1,6,18.5),new Wd(18,J.SBFL2,10,20),new Wd(19,J.BMT,1,5),new Wd(19,J.LM44,5,1500),new Wd(19,J.BMT,1,6.5),new Wd(19,J.BMT,1,8)],a=[J.TFISH,J.TCUTTLE,J.TBOTTLE],o=[new xd(16,11,5,J.TFISH,se.BUILDTOWER,2),new Nd(4,23,20,210,se.FINDTOWER,-2,"tflashght,"),new Nd(4,10,20,290,se.KILLOBJECT,33,"")],Ye=Gd.create(6,19,543,1,6,"level 89",a,r,2,o,l.p(8*n+762*s,214*s)),r=[new Wd(1,1,J.LM2,5,20),new Wd(1,2,J.LM1,5,20),new Wd(2,1,J.LM1,5,30),new Wd(2,2,J.LM3,5,30),new Wd(3,1,J.LM3,6,45),new Wd(3,2,J.LM3,6,40),new Wd(4,1,J.LM1,8,60),new Wd(4,2,J.LM2,8,45),new Wd(5,1,J.LM3,8,70),new Wd(5,2,J.LM2,8,50),new Wd(6,1,J.LM3,10,120),new Wd(6,2,J.FTM,10,85),new Wd(7,1,J.FTM,10,155),new Wd(7,2,J.LM1,10,95),new Wd(8,1,J.FLM1,8,160),new Wd(8,2,J.LM2,10,160),new Wd(9,1,J.FLM1,10,170),new Wd(9,2,J.FLM1,8,125),new Wd(10,1,J.LM3,10,310),new Wd(10,2,J.FLM2,8,140),new Wd(11,1,J.LM42,4,240),new Wd(11,2,J.LM43,3,190),new Wd(12,1,J.FTM,6,670),new Wd(12,1,J.FLM1,8,175),new Wd(12,2,J.FTM,6,590),new Wd(12,2,J.FLM2,6,100),new Wd(13,1,J.LM2,10,580),new Wd(13,1,J.SBL2,1,7.7),new Wd(13,2,J.SBL1,1,6.55),new Wd(13,2,J.LM1,8,470),new Wd(14,1,J.FTM,8,720),new Wd(14,1,J.SBFT,3,11),new Wd(14,2,J.SBL3,1,11.5),new Wd(14,2,J.LM3,10,600),new Wd(15,1,J.SBFT,5,15),new Wd(15,1,J.LM44,2,500),new Wd(15,2,J.SBFT,5,10),new Wd(15,2,J.LM45,2,300),new Wd(16,1,J.FLM1,10,600),new Wd(16,1,J.SBFL1,1,11),new Wd(16,2,J.FLM2,10,472),new Wd(16,2,J.SBFL2,1,9.5),new Wd(17,1,J.SBFL2,6,8.8),new Wd(17,2,J.SBFL1,6,7),new Wd(18,1,J.LM1,5,1400),new Wd(18,1,J.FTM,10,1700),new Wd(18,2,J.LM2,8,1e3),new Wd(18,2,J.LM3,5,1100),new Wd(19,1,J.SBFT,1,30),new Wd(19,1,J.FTM,15,1700),new Wd(19,2,J.SBFT,1,24.8),new Wd(19,2,J.FTM,15,1200),new Wd(20,1,J.LM1,10,1500),new Wd(20,1,J.LM42,3,930),new Wd(20,2,J.LM1,10,1180),new Wd(20,2,J.LM44,3,600),new Wd(21,1,J.LM2,15,1600),new Wd(21,1,J.SBFL1,2,10.6),new Wd(21,2,J.LM3,15,1160),new Wd(21,2,J.SBFL2,2,7.8),new Wd(22,1,J.FTM,5,1800),new Wd(22,1,J.FLM1,5,900),new Wd(22,1,J.FTM,5,2e3),new Wd(22,2,J.FTM,5,1800),new Wd(22,2,J.FLM2,5,600),new Wd(22,2,J.FTM,5,1900),new Wd(23,1,J.LM41,6,1e3),new Wd(23,2,J.LM43,6,690),new Wd(24,1,J.SBL1,2,20),new Wd(24,1,J.SBFL1,2,15),new Wd(24,1,J.SBL3,4,20),new Wd(24,2,J.SBL1,2,25),new Wd(24,2,J.SBFL2,2,15),new Wd(24,2,J.SBL3,4,25),new Wd(25,1,J.BMT,1,8.8),new Wd(25,1,J.SBFT,2,65),new Wd(25,1,J.BMT,1,10),new Wd(25,2,J.BMT,1,8.8),new Wd(25,2,J.SBFT,2,55),new Wd(25,2,J.BMT,1,10)],a=[J.TSUN,J.TBALL,J.TMAGNET,J.TSTAR],o=[new xd(8,14,5,J.TSUN,se.BUILDTOWER,5),new Nd(4,5,10,110,se.KILLOBJECT,5,",S2Ob1,S2Ob2,S2Ob3,S2Ob4,S2Ob5,"),new Nd(4,10,20,400,se.KILLOBJECT,34,"")],Xe=Gd.create(6,25,789,1,3,"level 90",a,r,3,o,l.p(8*n+904*s,149*s)),r=[new Wd(1,J.FTM,8,6),new Wd(2,J.LM1,6,8),new Wd(2,J.LM2,4,11),new Wd(3,J.LM3,5,23),new Wd(3,J.LM1,5,28),new Wd(4,J.LM2,9,34),new Wd(4,J.FLM1,1,20),new Wd(5,J.FLM2,8,28),new Wd(6,J.FTM,8,80),new Wd(6,J.FLM1,2,25),new Wd(7,J.LM3,9,80),new Wd(7,J.FLM2,4,25),new Wd(8,J.FLM1,6,80),new Wd(8,J.FLM2,6,83.5),new Wd(9,J.LM2,6,150),new Wd(9,J.FTM,8,210),new Wd(10,J.LM1,12,160),new Wd(10,J.SBL1,1,3.5),new Wd(11,J.SBL2,3,4),new Wd(11,J.LM2,7,260),new Wd(12,J.SBFL2,1,4),new Wd(12,J.FLM1,5,240),new Wd(12,J.SBFL2,2,4.3),new Wd(13,J.SBL3,5,8),new Wd(13,J.SBFL1,3,3.7),new Wd(14,J.FTM,6,700),new Wd(14,J.SBFT,3,12),new Wd(14,J.FTM,6,850),new Wd(15,J.FLM1,12,1e3),new Wd(16,J.LM1,5,1600),new Wd(16,J.SBL2,3,25),new Wd(16,J.FLM2,5,1200),new Wd(17,J.LM3,6,2300),new Wd(17,J.FLM1,5,1600),new Wd(17,J.FTM,5,3e3),new Wd(18,J.BMT,1,8),new Wd(18,J.FLM2,8,2e3),new Wd(19,J.SBFL1,4,28),new Wd(19,J.SBFL2,4,25)],a=[J.TSHIT,J.TMOON,J.TICEFAN],o=[new xd(13,23,10,J.TARROW,se.KILLMONSTER,-60),new Nd(4,1,10,150,se.KILLOBJECT,1,",B2Ob1,"),new Nd(4,10,10,300,se.KILLOBJECT,30,"")],je=Gd.create(6,19,798,1,3,"level 91",a,r,2,o,l.p(9*n+115*s,208*s)),r=[new Wd(1,J.SBL3,1,.5),new Wd(2,J.SBL1,1,1),new Wd(3,J.SBFT,1,1.8),new Wd(4,J.SBL2,1,2.3),new Wd(5,J.SBFL2,1,2),new Wd(6,J.SBFL1,1,2.4),new Wd(7,J.SBL2,1,2.8),new Wd(7,J.SBL2,1,3),new Wd(8,J.SBL3,2,3.5),new Wd(9,J.SBFT,1,8),new Wd(9,J.SBFT,1,12.6),new Wd(10,J.SBL1,2,12),new Wd(11,J.SBFL1,2,10),new Wd(12,J.SBFL2,2,14.5),new Wd(13,J.SBL2,3,24),new Wd(14,J.SBL3,3,30),new Wd(15,J.SBFT,3,55.3),new Wd(16,J.SBL1,3,65),new Wd(17,J.SBFL1,2,52),new Wd(17,J.SBFL2,2,52.5),new Wd(18,J.BMT,1,25)],a=[J.TBOTTLE,J.TMOON,J.TBALL,J.TCUTTLE,J.TFLASHLIGHT,J.TANCHOR,J.TARROW,J.TROCKET],o=[new xd(11,11,5,J.TMOON,se.BUILDTOWER,2),new Nd(3,1,20,100,se.KILLOBJECT,1,",BC1Ob1,BC1Ob2,BC1Ob3,BC1Ob4,"),new Nd(4,10,10,240,se.KILLOBJECT,41,"")],Ke=Gd.create(6,18,520,1,4,"level 92",a,r,1.1,o,l.p(9*n+182*s,400*s)),r=[new Wd(1,J.LM3,8,10),new Wd(2,J.LM2,5,20),new Wd(2,J.LM1,5,20),new Wd(3,J.LM3,6,30),new Wd(3,J.LM2,6,30),new Wd(4,J.LM1,5,50),new Wd(4,J.FTM,7,60),new Wd(5,J.LM3,6,80),new Wd(5,J.LM2,6,80),new Wd(6,J.FTM,8,120),new Wd(7,J.LM1,8,111),new Wd(7,J.FLM1,2,80),new Wd(8,J.LM43,5,100),new Wd(9,J.FLM2,2,95),new Wd(9,J.FTM,5,230),new Wd(9,J.FLM2,3,110),new Wd(10,J.SBL1,1,8),new Wd(11,J.FLM2,6,220),new Wd(11,J.SBL3,3,5),new Wd(12,J.FLM1,8,220),new Wd(12,J.SBL2,3,5.5),new Wd(13,J.LM2,6,550),new Wd(13,J.LM43,1,550),new Wd(14,J.LM3,7,600),new Wd(14,J.LM43,1,600),new Wd(15,J.FTM,12,1e3),new Wd(15,J.SBFT,3,15),new Wd(16,J.FLM2,7,700),new Wd(16,J.FTM,6,1400),new Wd(16,J.LM3,6,1e3),new Wd(17,J.FLM1,7,850),new Wd(17,J.FTM,6,1700),new Wd(17,J.LM3,6,1200),new Wd(18,J.FLM1,10,1050),new Wd(18,J.FLM2,10,1050),new Wd(19,J.SBL1,6,20),new Wd(19,J.SBL2,6,22.5),new Wd(20,J.SBFL1,5,17.5),new Wd(20,J.SBFL2,5,17.6),new Wd(21,J.SBFT,5,50),new Wd(21,J.LM1,4,2000.3),new Wd(21,J.LM2,4,2000.3),new Wd(21,J.LM3,4,2000.3)],a=[J.TRANDOM],o=[new xd(1,10,10,J.TOWEREND,se.KILLMONSTER,-300),new Nd(4,24,10,60,se.KILLOBJECT,1,",S1Ob17,"),new Nd(4,1,20,220,se.KILLOBJECT,1,",L1Ob1,")],qe=Gd.create(6,21,600,1,3,"level 93",a,r,2.3,o,l.p(9*n+339*s,481*s),0,1,64e4),r=[new Wd(1,J.BMT,1,.29),new Wd(2,J.FLM1,5,26),new Wd(3,J.FLM2,5,38.5),new Wd(4,J.FLM1,8,44),new Wd(5,J.FLM2,8,76),new Wd(6,J.BMT,3,.66),new Wd(7,J.FLM1,10,120),new Wd(8,J.FLM2,10,180),new Wd(9,J.FLM1,8,300),new Wd(9,J.SBFL1,2,4.6),new Wd(10,J.FLM2,8,380),new Wd(10,J.SBFL2,2,5.6),new Wd(11,J.FLM1,5,500),new Wd(11,J.FLM2,5,420),new Wd(11,J.SBFL1,2,8),new Wd(11,J.SBFL2,2,10.1),new Wd(12,J.SBFL1,5,14),new Wd(12,J.SBFL2,5,12.5),new Wd(13,J.BMT,2,11),new Wd(13,J.SBFL1,4,17)],a=[J.TPLANE,J.TROCKET,J.TICEFAN],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-40),new Nd(4,24,20,100,se.KILLOBJECT,7,",S2Ob8,S2Ob14,S2Ob16,S2Ob18,S3Ob1,S3Ob4,S3Ob5,"),new Nd(4,10,10,180,se.KILLOBJECT,46,"")],Qe=Gd.create(6,13,88,1,4,"level 94",a,r,4,o,l.p(9*n+577*s,479*s)),r=[new Wd(1,J.LM1,9,14e3),new Wd(1,J.BM2,1,450)],a=[J.TANCHOR,J.TBOTTLE],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-5),new Nd(4,4,20,80,se.KILLOBJECT,4,",B2Ob1,B2Ob2,B2Ob3,B2Ob4,"),new Nd(4,23,10,80,se.FINDTOWER,-16,"")],Ze=Gd.create(6,1,8e3,1,3,"level 95",a,r,1,o,l.p(9*n+430*s,348*s),200),r=[new Wd(1,J.FTM,8,50),new Wd(2,J.LM3,6,90),new Wd(2,J.LM2,4,100),new Wd(3,J.LM1,5,120),new Wd(3,J.LM3,5,140),new Wd(4,J.LM2,9,130),new Wd(4,J.FLM1,1,60),new Wd(5,J.FLM2,8,80),new Wd(6,J.FTM,8,250),new Wd(6,J.FLM1,2,130),new Wd(7,J.LM3,8,250),new Wd(7,J.FLM2,4,150),new Wd(8,J.FLM1,5,300),new Wd(8,J.FLM2,5,300),new Wd(9,J.LM2,6,500),new Wd(9,J.FTM,6,650),new Wd(10,J.LM1,12,600),new Wd(10,J.SBL1,1,9),new Wd(11,J.LM44,2,650),new Wd(12,J.SBL2,3,12.7),new Wd(12,J.LM2,7,990),new Wd(13,J.SBFL1,1,10),new Wd(13,J.FLM1,5,800),new Wd(13,J.SBFL1,2,10.88),new Wd(14,J.SBL3,5,12.3),new Wd(14,J.SBFL2,3,10),new Wd(15,J.FTM,5,2800),new Wd(15,J.SBFT,3,30.2),new Wd(15,J.FTM,5,2800),new Wd(16,J.LM1,5,2650),new Wd(16,J.SBL2,3,30.2),new Wd(16,J.FLM2,5,1180),new Wd(17,J.LM3,6,2900),new Wd(17,J.FLM1,5,1600),new Wd(17,J.FTM,5,3400),new Wd(18,J.BMT,1,8),new Wd(18,J.FLM2,8,1900),new Wd(19,J.SBL1,3,48),new Wd(19,J.SBL2,3,44),new Wd(19,J.SBL3,3,40),new Wd(20,J.BMT,1,10),new Wd(20,J.LM44,2,3260)],a=[J.TBOTTLE,J.TSUN,J.TFLASHLIGHT,J.TMAGNET],o=[new xd(8,15,10,J.TSUN,se.BUILDTOWER,6),new Nd(4,23,10,60,se.FINDTOWER,-1,"tmoon,"),new Nd(4,5,10,210,se.KILLOBJECT,5,",S2Ob1,S2Ob2,S2Ob3,S2Ob4,S2Ob5,")],Je=Gd.create(6,20,0,1,2,"level 96",a,r,4,o,l.p(9*n+292*s,198*s)),r=[new Wd(1,1,J.LM3,5,10),new Wd(1,2,J.LM3,5,10),new Wd(2,1,J.LM1,5,20),new Wd(2,2,J.LM2,5,20),new Wd(3,1,J.LM2,5,30),new Wd(3,2,J.LM1,5,30),new Wd(4,1,J.FTM,3,48),new Wd(4,1,J.LM3,5,38),new Wd(4,2,J.FTM,3,48),new Wd(4,2,J.LM2,5,38),new Wd(5,1,J.FTM,8,58),new Wd(5,1,J.FLM1,5,20),new Wd(5,2,J.FTM,8,58),new Wd(5,2,J.FLM2,5,20),new Wd(6,1,J.FLM2,10,23),new Wd(6,2,J.FLM1,10,23),new Wd(7,1,J.SBL1,1,1.23),new Wd(7,2,J.SBL1,1,1.23),new Wd(8,1,J.SBL2,1,.8),new Wd(8,1,J.SBL2,1,1),new Wd(8,1,J.SBL2,1,1.5),new Wd(8,2,J.SBL2,1,.8),new Wd(8,2,J.SBL2,1,1),new Wd(8,2,J.SBL2,1,1.5),new Wd(9,1,J.FLM1,5,45),new Wd(9,1,J.FLM2,5,50),new Wd(9,2,J.FLM1,5,45),new Wd(9,2,J.FLM2,5,50),new Wd(10,1,J.SBFT,4,1.66),new Wd(10,2,J.SBFT,4,1.66),new Wd(11,1,J.BMT,1,1.2),new Wd(11,2,J.BMT,1,1.2),new Wd(12,1,J.LM2,8,220),new Wd(12,1,J.LM3,8,260),new Wd(12,2,J.LM2,8,220),new Wd(12,2,J.LM3,8,260),new Wd(13,1,J.SBFL1,2,1.8),new Wd(13,1,J.SBFL1,3,2.1),new Wd(13,2,J.SBFL2,2,1.8),new Wd(13,2,J.SBFL1,3,2.1),new Wd(14,1,J.FTM,8,415),new Wd(14,1,J.SBFT,2,5),new Wd(14,1,J.SBFT,3,6),new Wd(14,2,J.FTM,8,415),new Wd(14,2,J.SBFT,2,5),new Wd(14,2,J.SBFT,3,6),new Wd(15,1,J.LM2,8,620),new Wd(15,2,J.LM2,8,620),new Wd(16,1,J.LM3,10,680),new Wd(16,2,J.LM3,10,680),new Wd(17,1,J.SBL3,1,11),new Wd(17,1,J.SBL2,1,13),new Wd(17,1,J.SBL1,1,15.6),new Wd(17,2,J.SBL3,1,11),new Wd(17,2,J.SBL2,1,13),new Wd(17,2,J.SBL1,1,15.6),new Wd(18,1,J.BMT,1,3),new Wd(18,1,J.SBFT,2,7),new Wd(18,1,J.SBFL2,1,2.6),new Wd(18,2,J.BMT,1,3),new Wd(18,2,J.SBFT,2,7),new Wd(18,2,J.SBFL1,1,2.6)],a=[J.TBOTTLE,J.TSHIT,J.TSUN,J.TBALL,J.TICEFAN,J.TMOON,J.TFLASHLIGHT,J.TROCKET,J.TFISH,J.TANCHOR,J.TCUTTLE],o=[new xd(8,12,10,J.TSUN,se.BUILDTOWER,3),new Nd(4,24,20,90,se.KILLOBJECT,1,",B1Ob1,"),new Nd(4,10,10,200,se.KILLOBJECT,12,",S2Ob1,S2Ob2,S2Ob3,S2Ob4,S2Ob5,S2Ob6,S2Ob7,S2Ob8,S2Ob9,S2Ob10,S2Ob11,S2Ob12,")],$e=Gd.create(6,18,2013,1,3,"level 97",a,r,3.2,o,l.p(9*n+474*s,79*s)),r=[new Wd(1,J.FTM,8,10),new Wd(2,J.LM2,6,30),new Wd(2,J.LM1,4,35),new Wd(3,J.LM3,5,45),new Wd(3,J.LM2,5,52),new Wd(4,J.LM1,9,62),new Wd(4,J.FLM2,1,30),new Wd(5,J.FLM1,8,60),new Wd(5,J.LM43,2,75),new Wd(6,J.FTM,8,155),new Wd(6,J.FLM2,2,35),new Wd(7,J.LM3,9,155),new Wd(7,J.FLM1,4,35),new Wd(8,J.FLM2,6,100),new Wd(8,J.FLM1,6,100),new Wd(9,J.LM45,6,115),new Wd(9,J.FTM,8,255),new Wd(10,J.LM1,12,290),new Wd(10,J.SBL1,1,8.1),new Wd(11,J.SBL2,3,6.5),new Wd(11,J.LM44,7,165),new Wd(12,J.SBFL2,1,4.2),new Wd(12,J.FLM1,5,250),new Wd(12,J.SBFL2,2,4.8),new Wd(13,J.SBL3,5,8.7),new Wd(13,J.SBFL1,3,4.3),new Wd(14,J.FTM,6,700),new Wd(14,J.SBFT,3,12),new Wd(14,J.FTM,6,680),new Wd(15,J.LM42,5,850),new Wd(15,J.LM43,5,800),new Wd(16,J.LM1,5,1400),new Wd(16,J.SBL2,3,17.2),new Wd(16,J.FLM2,5,650),new Wd(17,J.LM3,6,2e3),new Wd(17,J.FLM1,5,820),new Wd(17,J.FTM,5,2700),new Wd(18,J.BMT,1,10),new Wd(18,J.LM43,5,900),new Wd(18,J.FLM2,8,900),new Wd(19,J.SBFL1,4,25.5),new Wd(19,J.SBFL2,4,25.5)],a=[J.TBOTTLE],o=[new xd(5,15,10,J.TBOTTLE,se.BUILDTOWER,6),new Nd(4,24,10,130,se.KILLOBJECT,1,",S2Ob3,"),new Nd(4,4,10,220,se.KILLOBJECT,4,",B1Ob1,B1Ob2,B1Ob3,B1Ob4,")],et=Gd.create(6,19,560,1,3,"level 98",a,r,2.8,o,l.p(9*n+700*s,108*s)),r=[new Wd(1,J.LM2,8,2),new Wd(2,J.LM1,5,10),new Wd(2,J.LM3,5,14),new Wd(3,J.LM2,6,25),new Wd(3,J.LM3,6,28),new Wd(4,J.LM1,5,38),new Wd(4,J.FTM,7,56.6),new Wd(5,J.LM3,7,60),new Wd(5,J.LM2,7,67),new Wd(6,J.FTM,12,105),new Wd(7,J.LM1,10,110),new Wd(7,J.FLM1,3,70),new Wd(8,J.FLM1,12,100),new Wd(9,J.FLM2,2,155),new Wd(9,J.FTM,8,390),new Wd(9,J.FLM2,3,170),new Wd(10,J.SBL1,1,7.2),new Wd(10,J.SBL2,2,6.4),new Wd(10,J.SBL3,3,6.5),new Wd(11,J.LM3,12,500),new Wd(11,J.LM41,3,450),new Wd(12,J.FLM2,12,420),new Wd(13,J.LM1,8,900),new Wd(13,J.LM2,8,900),new Wd(14,J.FLM1,8,700),new Wd(14,J.LM44,4,700),new Wd(15,J.FTM,12,1500),new Wd(15,J.SBFT,3,22),new Wd(16,J.LM41,5,1500),new Wd(16,J.LM3,6,1e3),new Wd(16,J.FLM2,6,850),new Wd(17,J.LM42,5,2000.32),new Wd(17,J.FLM1,10,900),new Wd(18,J.FLM1,10,1216.25),new Wd(18,J.FLM2,10,1216.25),new Wd(19,J.SBL1,6,30),new Wd(19,J.SBL2,6,28),new Wd(20,J.SBFL1,5,20),new Wd(20,J.SBFL2,5,18.6),new Wd(21,J.SBFT,5,60)],a=[J.TBOTTLE,J.TSTAR,J.TBALL,J.TICEFAN,J.TMOON,J.TARROW],o=[new xd(11,11,10,J.TMOON,se.BUILDTOWER,2),new Nd(4,7,10,300,se.KILLOBJECT,7,",S2Ob1,S2Ob2,S2Ob3,S2Ob4,S2Ob5,S2Ob6,S2Ob7,"),new Nd(2,21,20,1500,se.KILLOBJECT,1,",DB3Ob1,")],tt=Gd.create(6,21,2014,1,3,"level 99",a,r,3.5,o,l.p(9*n+588*s,276*s),0,1,8e5),r=[new Wd(1,J.SBB,1,180),new Wd(1,J.LM1,4,10),new Wd(1,J.LM2,4,10),new Wd(2,J.FTM,6,250),new Wd(2,J.FLM1,2,150),new Wd(3,J.FTM,6,350),new Wd(3,J.LM2,2,300),new Wd(4,J.LM1,4,500),new Wd(4,J.LM2,4,500),new Wd(5,J.FLM1,4,350),new Wd(5,J.FLM2,4,350),new Wd(6,J.FLM2,6,550),new Wd(6,J.FTM,2,1250),new Wd(7,J.LM2,4,1634.45),new Wd(7,J.LM1,4,1634.45),new Wd(8,J.FLM1,4,1563.33),new Wd(8,J.FLM2,4,1563.33),new Wd(9,J.FTM,2,2898.64),new Wd(9,J.LM1,6,2832.2),new Wd(10,J.LM2,8,2931.07),new Wd(10,J.LM3,8,3031.07),new Wd(11,J.LM2,4,5745.51),new Wd(11,J.LM1,4,5745.51),new Wd(12,J.FLM2,4,4500),new Wd(12,J.LM2,4,8344.39),new Wd(13,J.FLM1,4,5260.28),new Wd(13,J.FTM,4,8731.91),new Wd(14,J.LM3,4,8e3),new Wd(14,J.FTM,4,9800),new Wd(15,J.FLM1,8,5e3),new Wd(15,J.FLM2,8,5e3)],a=[J.TBOTTLE,J.TARROW,J.TROCKET,J.TPLANE,J.TFLASHLIGHT,J.TANCHOR,J.TSNOW],o=[new xd(5,22,10,J.TBOTTLE,se.BUILDTOWER,1),new xd(12,19,10,J.TFLASHLIGHT,se.BUILDTOWER,10),new Nd(3,1,10,45,se.KILLOBJECT,1,",BC1Ob1,")],it=Gd.create(6,15,18880,1,3,"level 100",a,r,1,o,l.p(9*n+828*s,340*s)),r=[new Wd(1,J.LM1,6,0),new Wd(2,J.LM3,8,0),new Wd(3,J.LM2,10,0),new Wd(4,J.LM1,7,0),new Wd(4,J.FLM1,2,0),new Wd(5,J.FLM1,8,0),new Wd(6,J.FTM,5,0),new Wd(6,J.FLM2,5,0),new Wd(7,J.LM3,7,0),new Wd(7,J.FLM1,3,0),new Wd(8,J.FLM2,5,0),new Wd(8,J.FLM1,5,0),new Wd(9,J.LM2,5,0),new Wd(9,J.FTM,6,0),new Wd(10,J.SBL1,1,0),new Wd(10,J.LM1,10,0),new Wd(11,J.SBL3,3,0),new Wd(11,J.LM3,7,0),new Wd(12,J.FLM1,8,0),new Wd(12,J.SBFL2,2,0),new Wd(13,J.FLM2,6,0),new Wd(13,J.SBFL1,4,0),new Wd(14,J.FTM,12,0),new Wd(15,J.LM2,5,0),new Wd(15,J.SBL2,3,0),new Wd(15,J.LM2,5,0),new Wd(16,J.FTM,5,0),new Wd(16,J.SBFT,5,0),new Wd(16,J.FTM,5,0),new Wd(17,J.FLM1,6,0),new Wd(17,J.FLM2,6,0),new Wd(18,J.SBL1,1,0),new Wd(18,J.SBL3,1,0),new Wd(18,J.SBL1,2,0),new Wd(18,J.SBL3,2,0),new Wd(19,J.SBFL1,4,0),new Wd(19,J.SBFL2,4,0),new Wd(20,J.SBL2,2,0),new Wd(20,J.BMT,1,0),new Wd(20,J.SBL2,2,0)],a=[J.TBOTTLE,J.TBALL,J.TICEFAN,J.TMOON,J.TFISH,J.TSTAR,J.TSUN,J.TANCHOR],o=[new xd(11,11,5,J.TMOON,se.BUILDTOWER,2),new xd(16,22,5,J.TFISH,se.BUILDTOWER,1),new Nd(4,23,10,120,se.FINDTOWER,-6,"tfirebottle,")],nt=Gd.create(7,20,188,1,3,"level 101",a,r,1.2,o,l.p(10*n+35*s,267*s)),r=[new Wd(1,J.LM2,8,3),new Wd(2,J.LM1,10,4.5),new Wd(3,J.LM3,10,10),new Wd(4,J.FTM,10,28),new Wd(5,J.LM2,8,45),new Wd(5,J.FLM1,2,20),new Wd(6,J.FLM1,10,36),new Wd(7,J.LM1,8,80),new Wd(7,J.FLM2,4,40),new Wd(8,J.FLM2,6,66),new Wd(8,J.FLM1,6,80),new Wd(9,J.FTM,7,185),new Wd(9,J.LM3,3,116),new Wd(10,J.FTM,3,230),new Wd(10,J.SBFL2,1,3),new Wd(10,J.FTM,5,245),new Wd(11,J.LM2,8,238),new Wd(11,J.SBL2,1,4),new Wd(12,J.SBFL1,5,3),new Wd(13,J.LM1,9,320),new Wd(13,J.LM41,1,330),new Wd(14,J.LM41,3,288),new Wd(15,J.SBL1,1,15),new Wd(15,J.SBL2,1,18),new Wd(15,J.SBL3,1,20),new Wd(16,J.SBFT,5,15),new Wd(16,J.LM42,1,420),new Wd(17,J.LM42,3,350),new Wd(17,J.FLM1,5,300),new Wd(18,J.LM2,4,400),new Wd(18,J.LM41,1,800),new Wd(18,J.FLM2,5,400),new Wd(19,J.FLM1,8,500),new Wd(19,J.SBFL2,3,15.5),new Wd(20,J.SBL1,3,23),new Wd(20,J.SBL3,3,27),new Wd(21,J.LM41,3,800),new Wd(21,J.LM42,3,800),new Wd(22,J.SBL2,3,30),new Wd(22,J.LM41,2,700),new Wd(22,J.SBFL1,3,15),new Wd(22,J.LM42,2,750),new Wd(23,J.BMT,1,13.3),new Wd(23,J.SBFT,4,35)],a=[J.TFIREBOTTLE,J.TBOTTLE,J.TSTAR,J.TARROW,J.TSHIT,J.TPLANE,J.TANCHOR,J.TMAGNET],o=[new xd(21,3,5,J.TFIREBOTTLE,se.BUILDTOWER,-3),new Nd(4,23,10,90,se.FINDTOWER,-1,"tfirebottle,"),new Nd(4,2,10,120,se.KILLOBJECT,2,",B1Ob1,B1Ob2,")],st=Gd.create(7,23,500,1,3,"level 102",a,r,1.1,o,l.p(10*n+49*s,98*s)),r=[new Wd(1,J.FTM,6,0),new Wd(2,J.LM3,8,0),new Wd(3,J.LM2,8,0),new Wd(3,J.LM1,2,0),new Wd(4,J.LM1,10,0),new Wd(5,J.FTM,4,0),new Wd(5,J.FLM2,4,0),new Wd(6,J.FLM2,8,0),new Wd(7,J.LM2,5,0),new Wd(7,J.FLM1,5,0),new Wd(8,J.FLM2,5,0),new Wd(8,J.FLM1,5,0),new Wd(9,J.LM3,10,0),new Wd(10,J.LM1,5,0),new Wd(10,J.FTM,6,0),new Wd(11,J.SBL2,1,0),new Wd(11,J.LM2,9,0),new Wd(12,J.SBL3,2,0),new Wd(12,J.LM1,7,0),new Wd(13,J.SBL1,3,0),new Wd(13,J.SBL3,3,0),new Wd(14,J.FLM1,9,0),new Wd(14,J.SBFL1,1,0),new Wd(15,J.FLM2,7,0),new Wd(15,J.SBFL2,3,0),new Wd(16,J.FTM,10,0),new Wd(17,J.LM41,3,0),new Wd(18,J.LM2,5,0),new Wd(18,J.SBL2,3,0),new Wd(18,J.LM2,5,0),new Wd(19,J.SBL3,1,0),new Wd(19,J.SBL1,1,0),new Wd(19,J.SBL3,2,0),new Wd(19,J.SBL1,2,0),new Wd(20,J.BMT,1,0),new Wd(20,J.LM42,2,0),new Wd(21,J.SBFL1,4,0),new Wd(21,J.FLM2,6,0),new Wd(22,J.SBFL2,4,0),new Wd(22,J.FLM1,6,0),new Wd(23,J.LM42,5,0),new Wd(24,J.SBL2,1,0),new Wd(24,J.SBL3,1,0),new Wd(24,J.SBL1,1,0),new Wd(25,J.SBFT,2,0),new Wd(25,J.SBFT,2,0),new Wd(25,J.LM41,2,0),new Wd(25,J.LM42,2,0)],a=[J.TFISH,J.TBALL,J.TARROW,J.TROCKET,J.TFIREBOTTLE,J.TFLASHLIGHT,J.TBOTTLE,J.TMOON],o=[new Nd(4,24,10,90,se.KILLOBJECT,1,",L1Ob6,"),new Nd(4,25,20,200,se.KILLOBJECT,1,",BC1Ob1,"),new Nd(4,23,10,160,se.FINDTOWER,-13,"tboomerang,")],rt=Gd.create(7,25,588,1,3,"level 103",a,r,1.4,o,l.p(10*n+182*s,78*s),0,1,9e5),r=[new Wd(1,1,J.LM3,5,0),new Wd(1,2,J.LM3,5,0),new Wd(2,1,J.FTM,6,0),new Wd(2,2,J.FTM,6,0),new Wd(3,1,J.LM2,4,0),new Wd(3,1,J.LM1,4,0),new Wd(3,2,J.LM2,4,0),new Wd(3,2,J.LM1,4,0),new Wd(4,1,J.LM2,10,0),new Wd(4,2,J.LM2,10,0),new Wd(5,1,J.FLM1,5,0),new Wd(5,2,J.FLM1,5,0),new Wd(6,1,J.LM3,5,0),new Wd(6,1,J.LM1,5,0),new Wd(6,2,J.LM3,5,0),new Wd(6,2,J.LM1,5,0),new Wd(7,1,J.LM43,2,0),new Wd(7,2,J.LM43,2,0),new Wd(8,1,J.FTM,10,0),new Wd(8,2,J.FTM,10,0),new Wd(9,1,J.LM2,5,0),new Wd(9,1,J.FLM2,5,0),new Wd(9,2,J.LM2,5,0),new Wd(9,2,J.FLM2,5,0),new Wd(10,1,J.FLM2,10,0),new Wd(10,2,J.FLM2,10,0),new Wd(11,1,J.LM3,5,0),new Wd(11,1,J.LM43,2,0),new Wd(11,1,J.SBL3,1,0),new Wd(11,2,J.LM3,5,0),new Wd(11,2,J.LM43,2,0),new Wd(11,2,J.SBL3,1,0),new Wd(12,1,J.SBL1,3,0),new Wd(12,1,J.LM1,7,0),new Wd(12,2,J.SBL1,3,0),new Wd(12,2,J.LM1,7,0),new Wd(13,1,J.FTM,9,0),new Wd(13,1,J.SBFT,1,0),new Wd(13,2,J.FTM,9,0),new Wd(13,2,J.SBFT,1,0),new Wd(14,1,J.FLM1,6,0),new Wd(14,1,J.FLM2,6,0),new Wd(14,2,J.FLM2,6,0),new Wd(14,2,J.FLM1,6,0),new Wd(15,1,J.LM2,10,0),new Wd(15,2,J.LM2,10,0),new Wd(16,1,J.SBL2,8,0),new Wd(16,2,J.SBL2,8,0),new Wd(17,1,J.LM43,5,0),new Wd(17,1,J.LM1,5,0),new Wd(17,2,J.LM43,5,0),new Wd(17,2,J.LM1,5,0),new Wd(18,1,J.LM3,10,0),new Wd(18,2,J.LM3,10,0),new Wd(19,1,J.FTM,10,0),new Wd(19,2,J.FTM,10,0),new Wd(20,1,J.FLM2,5,0),new Wd(20,1,J.SBFL2,3,0),new Wd(20,2,J.FLM2,5,0),new Wd(20,2,J.SBFL2,3,0),new Wd(21,1,J.SBFT,4,0),new Wd(21,1,J.FLM1,8,0),new Wd(21,2,J.SBFT,4,0),new Wd(21,2,J.FLM1,8,0),new Wd(22,1,J.SBFL1,3,0),new Wd(22,1,J.LM43,5,0),new Wd(22,2,J.LM43,5,0),new Wd(22,2,J.SBFL1,3,0),new Wd(23,1,J.SBL1,1,0),new Wd(23,1,J.SBL2,1,0),new Wd(23,1,J.SBL3,1,0),new Wd(23,2,J.SBL1,1,0),new Wd(23,2,J.SBL2,1,0),new Wd(23,2,J.SBL3,1,0),new Wd(24,1,J.LM43,7,0),new Wd(24,2,J.LM43,7,0),new Wd(25,1,J.BMT,1,0),new Wd(25,1,J.FLM1,6,0),new Wd(25,2,J.BMT,1,0),new Wd(25,2,J.FLM2,6,0)],a=[J.TBOOMERANG,J.TFIREBOTTLE,J.TBALL,J.TSNOW,J.TBOTTLE,J.TMAGNET],o=[new xd(22,6,5,J.TBOOMERANG,se.BUILDTOWER,-6),new xd(20,14,10,J.TSNOW,se.BUILDTOWER,5),new Nd(4,23,10,60,se.FINDTOWER,-1,"tsun,")],at=Gd.create(7,25,800,1,3,"level 104",a,r,1.5,o,l.p(10*n+258*s,189*s)),r=[new Wd(1,J.LM1,3,9e3),new Wd(1,J.FTM,3,12e3),new Wd(2,J.LM2,5,13300),new Wd(3,J.SBFT,2,200),new Wd(3,J.BM1,1,300),new Wd(4,J.SBL3,3,200)],a=[J.TFIREBOTTLE,J.TARROW,J.TROCKET,J.TPLANE,J.TICEFAN,J.TMAGNET,J.TBOOMERANG,J.TFISH],o=[new Nd(3,25,10,100,se.EARNMONEY,-8188),new xd(5,23,20,J.TBOTTLE,se.KILLMONSTER,-1),new Nd(4,10,10,130,se.KILLOBJECT,22,"")],ot=Gd.create(7,4,1618,1,55,"level 105",a,r,1.2,o,l.p(10*n+424*s,209*s),260),r=[new Wd(1,J.LM1,8,0),new Wd(2,J.LM2,10,0),new Wd(3,J.LM3,10,0),new Wd(4,J.LM1,7,0),new Wd(4,J.FLM2,3,0),new Wd(4,J.FLM2,10,0),new Wd(6,J.FTM,5,0),new Wd(6,J.FLM1,4,0),new Wd(7,J.LM3,7,0),new Wd(7,J.FLM2,3,0),new Wd(8,J.FLM2,5,0),new Wd(8,J.FLM1,5,0),new Wd(9,J.LM2,5,0),new Wd(9,J.FTM,6,0),new Wd(10,J.SBL1,1,0),new Wd(10,J.LM1,10,0),new Wd(11,J.SBL3,3,0),new Wd(11,J.LM3,7,0),new Wd(12,J.FLM2,8,0),new Wd(12,J.SBFL2,2,0),new Wd(13,J.FLM1,6,0),new Wd(13,J.SBFL1,4,0),new Wd(14,J.FTM,12,0),new Wd(15,J.LM2,5,0),new Wd(15,J.SBL2,3,0),new Wd(15,J.LM2,5,0),new Wd(16,J.FTM,5,0),new Wd(16,J.SBFT,5,0),new Wd(16,J.FTM,5,0),new Wd(17,J.FLM2,6,0),new Wd(17,J.FLM1,6,0),new Wd(18,J.LM41,3,0),new Wd(19,J.SBFL1,3,0),new Wd(19,J.SBFL2,3,0),new Wd(20,J.SBFT,3,0),new Wd(20,J.LM42,3,0),new Wd(21,J.LM43,1,0),new Wd(21,J.LM41,1,0),new Wd(21,J.LM42,1,0),new Wd(22,J.BMT,1,0),new Wd(22,J.SBL1,1,0),new Wd(22,J.SBL2,1,0),new Wd(22,J.SBL3,1,0)],a=[J.TBOOMERANG,J.TSTAR,J.TFLASHLIGHT,J.TRANDOM],o=[new xd(6,2,5,J.TSHIT,se.BUILDTOWER,-2),new Nd(4,23,10,100,se.FINDTOWER,-2,"tplane,"),new Nd(4,10,20,240,se.KILLOBJECT,33,"")],ht=Gd.create(7,22,666,1,3,"level 106",a,r,1,o,l.p(10*n+314*s,348*s)),r=[new Wd(1,J.LM3,4,0),new Wd(1,J.LM2,4,0),new Wd(2,J.FTM,8,0),new Wd(3,J.LM1,10,0),new Wd(4,J.LM3,10,0),new Wd(5,J.FTM,4,0),new Wd(5,J.FLM2,4,0),new Wd(6,J.FLM2,8,0),new Wd(7,J.LM2,5,0),new Wd(7,J.FLM1,5,0),new Wd(8,J.FLM2,5,0),new Wd(8,J.FLM1,5,0),new Wd(9,J.LM3,10,0),new Wd(10,J.LM1,5,0),new Wd(10,J.FTM,6,0),new Wd(11,J.SBL2,1,0),new Wd(11,J.LM2,9,0),new Wd(12,J.SBL3,3,0),new Wd(12,J.LM41,3,0),new Wd(13,J.SBL1,5,0),new Wd(14,J.FLM1,9,0),new Wd(14,J.SBFL1,1,0),new Wd(15,J.FLM2,7,0),new Wd(15,J.SBFL2,3,0),new Wd(16,J.FTM,10,0),new Wd(17,J.LM44,3,0),new Wd(18,J.LM2,5,0),new Wd(18,J.SBL2,3,0),new Wd(18,J.LM2,5,0),new Wd(19,J.SBL3,1,0),new Wd(19,J.SBL1,1,0),new Wd(19,J.SBL3,2,0),new Wd(19,J.SBL1,2,0),new Wd(20,J.BMT,1,0),new Wd(20,J.LM43,2,0),new Wd(21,J.SBFL1,4,0),new Wd(21,J.FLM2,6,0),new Wd(22,J.SBFL2,4,0),new Wd(22,J.FLM1,6,0),new Wd(23,J.LM42,5,0),new Wd(24,J.SBL2,1,0),new Wd(24,J.SBL3,1,0),new Wd(24,J.SBL1,1,0),new Wd(25,J.LM41,1,0),new Wd(25,J.LM42,1,0),new Wd(25,J.LM43,1,0),new Wd(25,J.LM44,1,0)],a=[J.TSUN,J.TMOON,J.TSNOW,J.TCUTTLE,J.TFLASHLIGHT,J.TANCHOR],o=[new xd(20,11,5,J.TSNOW,se.BUILDTOWER,2),new Nd(3,25,10,160,se.EARNMONEY,-5e3),new Nd(4,3,20,160,se.KILLOBJECT,3,",B2Ob1,B2Ob2,B2Ob3,")],lt=Gd.create(7,25,555,1,3,"level 107",a,r,1.3,o,l.p(10*n+490*s,439*s)),r=[new Wd(1,J.LM2,8,0),new Wd(2,J.LM1,10,0),new Wd(3,J.LM3,10,0),new Wd(4,J.FTM,10,0),new Wd(5,J.LM2,8,0),new Wd(5,J.FLM1,2,0),new Wd(6,J.FLM1,10,0),new Wd(7,J.LM1,8,0),new Wd(7,J.FLM2,4,0),new Wd(8,J.FLM2,6,0),new Wd(8,J.FLM1,6,0),new Wd(9,J.FTM,7,0),new Wd(9,J.LM3,3,0),new Wd(10,J.FTM,3,0),new Wd(10,J.SBFL2,1,0),new Wd(10,J.FTM,5,0),new Wd(11,J.LM2,8,0),new Wd(11,J.SBL2,1,0),new Wd(12,J.SBFL1,5,0),new Wd(13,J.LM1,9,0),new Wd(13,J.LM41,1,0),new Wd(14,J.LM41,2,0),new Wd(15,J.SBL1,1,0),new Wd(15,J.SBL2,1,0),new Wd(15,J.SBL3,1,0),new Wd(16,J.SBFT,4,0),new Wd(16,J.LM42,1,0),new Wd(17,J.LM42,2,0),new Wd(17,J.FLM1,5,0),new Wd(18,J.LM2,5,0),new Wd(18,J.LM41,1,0),new Wd(19,J.FLM1,10,0),new Wd(19,J.SBFL2,2,0),new Wd(20,J.SBL1,3,0),new Wd(20,J.SBL3,2,0),new Wd(21,J.LM41,3,0),new Wd(21,J.LM42,2,0),new Wd(22,J.SBL2,3,0),new Wd(22,J.SBFL1,3,0),new Wd(23,J.BMT,1,0),new Wd(23,J.SBFT,2,0),new Wd(24,J.LM44,4,0),new Wd(25,J.LM1,4,0),new Wd(25,J.LM2,4,0),new Wd(25,J.LM3,4,0),new Wd(26,J.BMT,2,0)],a=[J.TROCKET,J.TFIREBOTTLE,J.TSTAR,J.TMAGNET,J.TMOON,J.TRANDOM],o=[new xd(18,2,5,J.TCUTTLE,se.BUILDTOWER,-2),new xd(6,23,20,J.TSHIT,se.KILLMONSTER,-9),new Nd(4,10,20,210,se.KILLOBJECT,15,",B2Ob1,B2Ob2,B2Ob3,B2Ob4,B2Ob5,B2Ob6,S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,S1Ob7,S1Ob8,S1Ob9,")],dt=Gd.create(7,26,2222,1,3,"level 108",a,r,1.1,o,l.p(10*n+693*s,406*s),0,1,45e4),r=[new Wd(1,J.FTM,8,0),new Wd(2,J.LM2,4,0),new Wd(2,J.LM1,4,0),new Wd(3,J.LM3,9,0),new Wd(4,J.LM2,10,0),new Wd(5,J.FLM1,4,0),new Wd(5,J.FLM1,4,0),new Wd(6,J.LM1,10,0),new Wd(7,J.FTM,8,0),new Wd(7,J.FLM2,2,0),new Wd(8,J.FLM2,8,0),new Wd(9,J.LM42,2,0),new Wd(9,J.LM42,2,0),new Wd(10,J.LM3,9,0),new Wd(10,J.SBL3,1,0),new Wd(11,J.LM1,7,0),new Wd(11,J.SBL1,3,0),new Wd(12,J.LM2,6,0),new Wd(12,J.SBL2,4,0),new Wd(13,J.LM41,5,0),new Wd(14,J.FLM1,5,0),new Wd(14,J.FLM2,5,0),new Wd(15,J.SBFT,1,0),new Wd(15,J.SBFT,1,0),new Wd(15,J.SBFT,1,0),new Wd(16,J.FLM2,8,0),new Wd(16,J.SBFL2,2,0),new Wd(17,J.LM44,6,0),new Wd(18,J.FLM1,8,0),new Wd(18,J.SBFL1,2,0),new Wd(19,J.LM1,6,0),new Wd(19,J.LM2,6,0),new Wd(20,J.SBL3,5,0),new Wd(21,J.FLM2,6,0),new Wd(21,J.LM42,2,0),new Wd(21,J.LM43,2,0),new Wd(22,J.SBFT,2,0),new Wd(22,J.SBFL2,3,0),new Wd(22,J.SBFT,3,0),new Wd(23,J.BMT,1,0),new Wd(23,J.BMT,1,0)],a=[J.TICEFAN,J.TFISH,J.TSNOW],o=[new Nd(4,10,10,180,se.KILLOBJECT,10,",S3Ob1,S3Ob2,S3Ob3,S3Ob4,S3Ob5,S3Ob6,S3Ob7,S3Ob8,S3Ob9,S3Ob10,"),new xd(20,23,10,J.TSNOW,se.KILLMONSTER,-30),new Nd(4,23,20,100,se.FINDTOWER,-4,"tflashght,")],ct=Gd.create(7,23,1618,1,3,"level 109",a,r,1.4,o,l.p(10*n+770*s,238*s)),r=[new Wd(1,J.LM3,8,1600),new Wd(2,J.FLM1,8,1800),new Wd(3,J.LM42,2,2600),new Wd(4,J.BM1,1,180),new Wd(4,J.SBFL2,4,20),new Wd(5,J.LM41,2,3e3),new Wd(5,J.LM43,2,3e3)],a=[J.TBOTTLE,J.TSHIT,J.TSUN,J.TBALL,J.TPLANE,J.TBOOMERANG,J.TCUTTLE],o=[new Nd(4,24,5,60,se.KILLOBJECT,3,",S3Ob2,L2Ob1,L2Ob4,"),new xd(13,23,20,J.TARROW,se.KILLMONSTER,-20),new xd(6,23,20,J.TSHIT,se.KILLMONSTER,-1)],ut=Gd.create(7,5,888,1,50,"level 110",a,r,1.1,o,l.p(10*n+874*s,98*s),300),r=[new Wd(1,J.LM1,5,0),new Wd(1,J.LM1,5,0),new Wd(2,J.LM2,10,0),new Wd(3,J.FTM,8,0),new Wd(4,J.LM3,10,0),new Wd(5,J.FLM1,8,0),new Wd(6,J.LM1,6,0),new Wd(6,J.LM2,6,0),new Wd(7,J.FLM2,10,0),new Wd(8,J.LM45,1,0),new Wd(8,J.LM45,1,0),new Wd(9,J.FTM,5,0),new Wd(9,J.FLM1,5,0),new Wd(10,J.SBFT,3,0),new Wd(11,J.LM3,4,0),new Wd(11,J.FLM2,8,0),new Wd(12,J.SBL1,2,0),new Wd(12,J.SBL2,2,0),new Wd(13,J.SBFL1,1,0),new Wd(13,J.SBFL2,1,0),new Wd(14,J.LM44,4,0),new Wd(15,J.LM3,7,0),new Wd(15,J.SBL3,3,0),new Wd(16,J.FTM,10,0),new Wd(17,J.SBFT,1,0),new Wd(17,J.LM45,1,0),new Wd(17,J.SBFT,2,0),new Wd(17,J.LM45,2,0),new Wd(18,J.BMT,3,0)],a=[J.TMAGNET,J.TMOON,J.TBOTTLE,J.TRANDOM],o=[new xd(16,3,5,J.TFISH,se.BUILDTOWER,-3),new xd(22,23,10,J.TBOOMERANG,se.KILLMONSTER,-50),new Nd(4,10,20,270,se.KILLOBJECT,26,"")],pt=Gd.create(7,18,321,1,3,"level 111",a,r,1.3,o,l.p(11*n+140*s,108*s)),r=[new Wd(1,J.LM3,8,3.3),new Wd(2,J.LM2,10,4.4),new Wd(3,J.LM1,10,10),new Wd(4,J.FTM,10,27),new Wd(5,J.LM2,8,36),new Wd(5,J.FLM1,2,20),new Wd(6,J.FLM1,10,33),new Wd(7,J.LM1,8,70),new Wd(7,J.FLM2,4,40),new Wd(8,J.FLM2,6,63),new Wd(8,J.FLM1,6,78),new Wd(9,J.FTM,7,178),new Wd(9,J.LM3,3,105),new Wd(10,J.FTM,3,230),new Wd(10,J.SBFL2,1,2),new Wd(10,J.FTM,5,245),new Wd(11,J.LM2,8,238),new Wd(11,J.SBL2,1,4),new Wd(12,J.LM1,9,320),new Wd(12,J.LM41,1,330),new Wd(13,J.LM43,5,288),new Wd(14,J.SBL1,1,15),new Wd(14,J.SBL2,1,18),new Wd(14,J.SBL3,1,20),new Wd(15,J.SBFT,5,15),new Wd(15,J.LM42,1,400),new Wd(16,J.LM42,5,350),new Wd(16,J.FLM1,5,300),new Wd(17,J.LM2,5,400),new Wd(17,J.LM41,1,760),new Wd(17,J.FLM2,5,400),new Wd(18,J.FLM1,10,500),new Wd(18,J.SBFL2,3,15.5),new Wd(19,J.SBL1,3,23),new Wd(19,J.SBL3,3,27),new Wd(20,J.LM41,4,800),new Wd(20,J.LM42,4,800),new Wd(21,J.SBL2,3,30),new Wd(21,J.LM44,3,700),new Wd(21,J.SBFL1,3,15),new Wd(22,J.SBFT,4,35),new Wd(22,J.BMT,1,10)],a=[J.TARROW,J.TFIREBOTTLE,J.TSTAR,J.TANCHOR,J.TCUTTLE,J.TFLASHLIGHT,J.TRANDOM],o=[new Nd(4,23,5,80,se.FINDTOWER,-4,"tmoon,"),new xd(14,23,10,J.TROCKET,se.KILLMONSTER,-20),new Nd(3,25,20,300,se.EARNMONEY,-8e3)],mt=Gd.create(7,22,818,1,3,"level 112",a,r,1.3,o,l.p(11*n+196*s,260*s)),r=[new Wd(1,1,J.LM1,4,0),new Wd(1,2,J.LM2,4,0),new Wd(2,1,J.LM3,5,0),new Wd(2,2,J.LM1,5,0),new Wd(3,1,J.FTM,5,0),new Wd(3,1,J.LM2,5,0),new Wd(3,2,J.FTM,5,0),new Wd(3,2,J.LM3,5,0),new Wd(4,1,J.FLM1,5,0),new Wd(4,2,J.FLM2,5,0),new Wd(5,1,J.SBL1,1,0),new Wd(5,2,J.SBL1,1,0),new Wd(6,1,J.LM45,1,0),new Wd(6,2,J.LM45,1,0),new Wd(7,1,J.SBL2,1,0),new Wd(7,1,J.SBL2,1,0),new Wd(7,1,J.SBL2,1,0),new Wd(7,2,J.SBL2,1,0),new Wd(7,2,J.SBL2,1,0),new Wd(7,2,J.SBL2,1,0),new Wd(8,1,J.LM3,8,0),new Wd(8,2,J.LM3,8,0),new Wd(9,1,J.LM1,4,0),new Wd(9,1,J.FTM,5,0),new Wd(9,2,J.LM1,4,0),new Wd(9,2,J.FTM,5,0),new Wd(10,1,J.FLM1,10,0),new Wd(10,2,J.FLM1,10,0),new Wd(11,1,J.SBFT,4,0),new Wd(11,2,J.SBFT,4,0),new Wd(12,1,J.FLM2,10,0),new Wd(12,2,J.FLM2,10,0),new Wd(13,1,J.LM44,3,0),new Wd(13,2,J.LM44,3,0),new Wd(14,1,J.LM1,10,0),new Wd(14,2,J.LM1,10,0),new Wd(15,1,J.FTM,7,0),new Wd(15,1,J.SBFT,1,0),new Wd(15,1,J.SBFT,2,0),new Wd(15,2,J.FTM,7,0),new Wd(15,2,J.SBFT,1,0),new Wd(15,2,J.SBFT,2,0),new Wd(16,1,J.SBFL1,2,0),new Wd(16,1,J.SBFL2,3,0),new Wd(16,2,J.SBFL1,3,0),new Wd(16,2,J.SBFL2,2,0),new Wd(17,1,J.LM2,10,0),new Wd(17,2,J.LM2,10,0),new Wd(18,1,J.LM3,5,0),new Wd(18,1,J.LM43,3,0),new Wd(18,2,J.LM3,5,0),new Wd(18,2,J.LM43,3,0),new Wd(19,1,J.SBL3,1,0),new Wd(19,1,J.SBL2,1,0),new Wd(19,1,J.SBL1,1,0),new Wd(19,2,J.SBL3,1,0),new Wd(19,2,J.SBL2,1,0),new Wd(19,2,J.SBL1,1,0),new Wd(20,1,J.BMT,3,0),new Wd(20,2,J.BMT,3,0)],a=[J.TFISH,J.TMAGNET,J.TICEFAN,J.TBALL,J.TCUTTLE,J.TPLANE,J.TSUN,J.TBOOMERANG,J.TFIREBOTTLE,J.TBOTTLE],o=[new Nd(4,1,10,80,se.KILLOBJECT,1,",L3Ob1,"),new xd(18,23,5,J.TCUTTLE,se.KILLMONSTER,-60),new Nd(4,10,20,300,se.KILLOBJECT,14,",B2Ob1,B2Ob2,B2Ob3,B2Ob4,B2Ob5,B2Ob6,B2Ob7,S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,S1Ob7,")],_t=Gd.create(7,20,999,1,3,"level 113",a,r,1.4,o,l.p(11*n+196*s,427*s)),r=[new Wd(1,J.FTM,10,1500),new Wd(2,J.LM2,5,1900),new Wd(2,J.FLM1,5,1800),new Wd(3,J.FLM2,10,2e3),new Wd(4,J.LM44,3,6e3),new Wd(4,J.LM45,3,6600),new Wd(5,J.BM1,1,170),new Wd(5,J.SBL1,2,50),new Wd(5,J.SBL3,2,60)],a=[J.TSUN,J.TMOON,J.TSTAR,J.TSNOW,J.TBALL,J.TFLASHLIGHT,J.TBOOMERANG,J.TFIREBOTTLE,J.TROCKET,J.TARROW],o=[new Nd(4,23,5,50,se.FINDTOWER,-2,"tcuttle,"),new Nd(3,10,10,120,se.KILLOBJECT,10,",SC1Ob1,SC1Ob2,SC1Ob3,SC1Ob4,SC1Ob5,SC1Ob6,SC1Ob7,SC1Ob8,SC1Ob9,SC1Ob10,"),new xd(20,23,10,J.TSNOW,se.KILLMONSTER,-3)],gt=Gd.create(7,5,1111,1,40,"level 114",a,r,1.2,o,l.p(11*n+462*s,512*s),260),r=[new Wd(1,J.FLM1,5,10),new Wd(1,J.FLM2,5,10),new Wd(1,J.SBB,1,300),new Wd(2,J.LM3,5,102.97),new Wd(2,J.LM1,5,102.97),new Wd(3,J.LM3,5,149.78),new Wd(3,J.LM2,5,149.78),new Wd(4,J.LM1,5,196.59),new Wd(4,J.LM2,5,196.59),new Wd(5,J.FLM1,5,300),new Wd(5,J.LM3,5,486.79),new Wd(6,J.FLM1,6,380.28),new Wd(6,J.FLM2,6,380.28),new Wd(7,J.LM2,6,823.13),new Wd(7,J.LM3,6,823.13),new Wd(8,J.FTM,8,1279.03),new Wd(8,J.FLM2,4,746.1),new Wd(9,J.LM2,8,1308.58),new Wd(9,J.FLM1,4,900),new Wd(10,J.LM1,6,1551.31),new Wd(10,J.LM3,6,1551.31),new Wd(10,J.SBFL1,1,12),new Wd(11,J.LM2,7,1906.37),new Wd(11,J.FTM,7,2287.64),new Wd(11,J.SBL2,1,22),new Wd(12,J.FLM2,7,1300.11),new Wd(12,J.LM43,1,2200),new Wd(12,J.FTM,7,2736.18),new Wd(13,J.FLM1,7,1679.12),new Wd(13,J.FLM2,7,1679.12),new Wd(14,J.FLM2,7,1862.14),new Wd(14,J.LM1,7,2703.05),new Wd(15,J.LM1,7,2864.5),new Wd(15,J.FLM2,5,1850.15),new Wd(15,J.SBFT,1,60),new Wd(16,J.FLM2,8,2393.69),new Wd(16,J.LM45,1,5e3),new Wd(16,J.LM2,8,3419.56),new Wd(17,J.FLM2,8,2589.81),new Wd(17,J.LM2,8,3699.73),new Wd(18,J.LM3,13,3979.9),new Wd(18,J.FLM2,2,2785.93),new Wd(19,J.FLM1,8,2975.5),new Wd(19,J.LM44,1,5500),new Wd(19,J.FLM2,8,2975.5),new Wd(20,J.LM1,8,7000.89),new Wd(20,J.LM42,1,5500),new Wd(20,J.FTM,8,9500.6)],a=[J.TRANDOM,J.TSHIT,J.TMAGNET,J.TMOON,J.TBOTTLE,J.TICEFAN],o=[new xd(21,2,5,J.TFIREBOTTLE,se.BUILDTOWER,-2),new Nd(4,10,10,100,se.KILLOBJECT,6,",L1Ob1,L1Ob2,L1Ob3,L1Ob4,L1Ob5,L1Ob6,"),new xd(17,23,10,J.TANCHOR,se.KILLMONSTER,-30)],Tt=Gd.create(7,20,8090,1,3,"level 115",a,r,1.5,o,l.p(11*n+709*s,429*s)),r=[new Wd(1,J.LM2,5,10),new Wd(1,J.LM1,5,10),new Wd(2,J.LM3,4,10),new Wd(2,J.FTM,6,10),new Wd(3,J.LM2,8,16.63),new Wd(3,J.FTM,2,19.95),new Wd(4,J.LM2,6,28.05),new Wd(4,J.LM3,4,28.05),new Wd(5,J.LM1,5,78.94),new Wd(5,J.LM2,5,78.94),new Wd(5,J.LM3,5,78.94),new Wd(6,J.LM1,8,106.99),new Wd(6,J.LM2,7,106.99),new Wd(7,J.LM2,5,135.04),new Wd(7,J.LM3,10,135.04),new Wd(8,J.FLM1,9,114.16),new Wd(8,J.FLM2,6,114.16),new Wd(9,J.LM1,5,191.13),new Wd(9,J.FTM,10,229.36),new Wd(10,J.LM1,5,200),new Wd(10,J.LM2,5,200),new Wd(10,J.LM3,5,200),new Wd(10,J.SBFT,2,200),new Wd(10,J.SBL1,1,10),new Wd(11,J.FLM1,2,181.81),new Wd(11,J.LM2,8,259.73),new Wd(12,J.FLM2,4,197.8),new Wd(12,J.LM1,6,282.57),new Wd(13,J.FLM2,3,213.79),new Wd(13,J.FLM1,7,213.79),new Wd(14,J.LM2,6,328.25),new Wd(14,J.LM3,4,328.25),new Wd(15,J.FLM1,10,245.77),new Wd(15,J.FLM2,10,245.77),new Wd(15,J.SBL3,2,245.77),new Wd(16,J.FLM1,5,269.05),new Wd(16,J.FTM,10,461.22),new Wd(17,J.LM3,10,412.4),new Wd(17,J.FTM,5,494.88),new Wd(18,J.LM1,10,440.45),new Wd(18,J.FTM,5,528.54),new Wd(19,J.FLM1,10,327.95),new Wd(19,J.FLM2,5,327.95),new Wd(20,J.FLM1,5,338.88),new Wd(20,J.LM3,5,484.12),new Wd(20,J.SBL2,3,18)],a=[J.TSHIT,J.TBALL,J.TBOOMERANG],o=[new xd(6,12,5,J.TSHIT,se.BUILDTOWER,3),new xd(22,23,5,J.TBOOMERANG,se.KILLMONSTER,-150),new Nd(4,1,10,160,se.KILLOBJECT,1,",B1Ob1,")],ft=Gd.create(8,20,400,1,3,"level 116",a,r,.6,o,l.p(11*n+606*s,310*s)),r=[new Wd(1,J.LM1,2,5),new Wd(1,J.LM2,2,5),new Wd(2,J.LM2,6,10.1),new Wd(2,J.LM3,4,10.1),new Wd(3,J.FLM1,4,12.11),new Wd(3,J.LM3,6,20.19),new Wd(4,J.FLM2,8,20),new Wd(4,J.FTM,2,35),new Wd(5,J.FTM,8,100),new Wd(5,J.FLM2,2,50),new Wd(6,J.LM1,5,150),new Wd(6,J.LM3,5,150),new Wd(7,J.FLM1,5,150),new Wd(7,J.FLM2,5,150),new Wd(8,J.LM3,5,250),new Wd(8,J.LM2,5,250),new Wd(9,J.LM3,6,395.18),new Wd(9,J.FLM1,4,237.11),new Wd(10,J.FLM1,4,304.95),new Wd(10,J.LM3,6,508.25),new Wd(10,J.SBL1,1,11),new Wd(11,J.LM3,8,587.86),new Wd(11,J.FTM,4,705.43),new Wd(12,J.FTM,2,776.74),new Wd(12,J.LM3,8,647.28),new Wd(13,J.FLM1,15,438.91),new Wd(13,J.LM2,5,731.51),new Wd(14,J.LM2,15,815.74),new Wd(14,J.LM3,15,815.74),new Wd(15,J.SBFL1,3,8),new Wd(15,J.SBFL2,3,11),new Wd(16,J.LM2,14,1177.45),new Wd(16,J.FTM,6,1412),new Wd(17,J.LM1,5,1232.84),new Wd(17,J.LM3,15,1232.84),new Wd(18,J.FTM,3,1656),new Wd(18,J.FLM2,7,828.31),new Wd(19,J.FLM1,5,860.54),new Wd(19,J.FLM2,15,861),new Wd(20,J.FLM2,10,894.77),new Wd(20,J.FLM2,5,894.77),new Wd(20,J.SBFL1,1,23),new Wd(21,J.FLM1,5,921.42),new Wd(21,J.FLM2,15,921.42),new Wd(22,J.FTM,12,1936.31),new Wd(22,J.LM1,8,1650.78),new Wd(23,J.LM2,15,1650.78),new Wd(23,J.LM3,15,1650.78),new Wd(24,J.FLM1,15,992.38),new Wd(24,J.FLM2,15,992.38),new Wd(25,J.BMT,1,14),new Wd(25,J.FTM,30,14)],a=[J.TBOTTLE,J.TICEFAN,J.TFIREBOTTLE,J.TMOON],o=[new Nd(4,23,5,130,se.FINDTOWER,-3,"tsnow,"),new xd(5,13,5,J.TBOTTLE,se.BUILDTOWER,4),new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-50)],St=Gd.create(8,25,2400,1,3,"level 117",a,r,1,o,l.p(11*n+519*s,191*s)),r=[new Wd(1,1,J.LM2,5,2),new Wd(1,2,J.LM2,5,2),new Wd(2,1,J.LM3,5,4),new Wd(2,2,J.LM3,5,4),new Wd(3,1,J.LM1,6,6),new Wd(3,2,J.LM1,6,6),new Wd(4,1,J.FTM,6,12),new Wd(4,2,J.FTM,6,12),new Wd(5,1,J.LM2,5,12.5),new Wd(5,2,J.LM3,5,12.5),new Wd(6,1,J.FTM,5,20),new Wd(6,2,J.LM1,5,15),new Wd(7,1,J.FLM1,5,.75),new Wd(7,2,J.FLM2,5,.75),new Wd(8,1,J.FLM1,5,22),new Wd(8,2,J.FLM1,5,22),new Wd(9,1,J.FTM,3,50),new Wd(9,1,J.FLM2,3,18),new Wd(9,2,J.FTM,3,50),new Wd(9,2,J.FLM2,3,18),new Wd(10,1,J.LM2,6,55),new Wd(10,1,J.SBL2,1,1.1),new Wd(10,2,J.LM1,6,55),new Wd(10,2,J.SBL1,1,1.1),new Wd(11,1,J.LM3,5,75),new Wd(11,1,J.SBFT,3,1.6),new Wd(11,2,J.LM3,5,75),new Wd(11,2,J.SBFT,3,1.6),new Wd(12,1,J.FLM1,5,80),new Wd(12,1,J.FLM2,5,85),new Wd(12,2,J.FLM2,5,80),new Wd(12,2,J.FLM1,5,85),new Wd(13,1,J.LM1,8,100),new Wd(13,1,J.SBFL1,1,1),new Wd(13,2,J.LM1,8,100),new Wd(13,2,J.SBFL1,1,1),new Wd(14,1,J.FTM,3,180),new Wd(14,1,J.FLM1,3,70),new Wd(14,1,J.FTM,3,200),new Wd(14,2,J.FTM,3,180),new Wd(14,2,J.FLM2,3,70),new Wd(14,2,J.FTM,3,200),new Wd(15,1,J.LM2,6,200),new Wd(15,1,J.SBL2,3,2.5),new Wd(15,2,J.LM3,6,200),new Wd(15,2,J.SBL3,3,2.5),new Wd(16,1,J.FLM1,6,166),new Wd(16,1,J.SBFL1,1,1.8),new Wd(16,2,J.FLM2,6,166),new Wd(16,2,J.SBFL2,1,1.8),new Wd(17,1,J.FTM,8,280),new Wd(17,1,J.SBFT,1,3.8),new Wd(17,2,J.FTM,8,280),new Wd(17,2,J.SBFT,1,3.8),new Wd(18,1,J.LM1,7,280),new Wd(18,1,J.FLM1,2,140),new Wd(18,2,J.LM1,7,280),new Wd(18,2,J.FLM2,2,140),new Wd(19,1,J.SBL1,1,3),new Wd(19,1,J.SBL2,1,4),new Wd(19,1,J.SBL3,2,5),new Wd(19,1,J.SBFT,1,7),new Wd(19,2,J.SBL1,1,3),new Wd(19,2,J.SBL2,1,4),new Wd(19,2,J.SBL3,1,5),new Wd(19,2,J.SBFT,1,7),new Wd(20,1,J.BMT,1,3.3),new Wd(20,1,J.LM41,3,400),new Wd(20,2,J.FLM2,10,3.3)],a=[J.TSUN,J.TCUTTLE,J.TMOON,J.TMAGNET],o=[new xd(19,10,5,J.TMAGNET,se.BUILDTOWER,-5),new xd(11,12,10,J.TMOON,se.BUILDTOWER,3),new xd(8,13,5,J.TSUN,se.BUILDTOWER,4)],wt=Gd.create(8,20,880,1,3,"level 118",a,r,1,o,l.p(11*n+627*s,81*s)),r=[new Wd(1,J.FLM1,5,8),new Wd(1,J.FLM2,5,8),new Wd(2,J.LM3,5,15),new Wd(2,J.LM2,5,15),new Wd(3,J.LM3,4,25),new Wd(3,J.FTM,6,25),new Wd(4,J.FLM1,5,25),new Wd(4,J.FLM2,5,25),new Wd(5,J.LM1,5,50),new Wd(5,J.LM2,5,50),new Wd(5,J.LM3,5,50),new Wd(6,J.LM3,8,100),new Wd(6,J.FLM1,2,70),new Wd(7,J.LM1,6,150),new Wd(7,J.FLM2,4,100),new Wd(8,J.LM1,5,200),new Wd(8,J.FTM,5,300),new Wd(9,J.FLM2,5,200),new Wd(9,J.LM1,5,300),new Wd(10,J.FLM2,8,299.1),new Wd(10,J.LM2,5,427.29),new Wd(11,J.LM1,5,513.19),new Wd(11,J.FTM,2,615.83),new Wd(12,J.LM2,5,587.41),new Wd(12,J.LM3,5,587.41),new Wd(13,J.FLM2,5,467.23),new Wd(13,J.LM1,5,667.48),new Wd(14,J.FLM2,5,523.28),new Wd(14,J.LM2,5,747.54),new Wd(15,J.LM2,5,1175.11),new Wd(15,J.LM3,5,1175.11),new Wd(15,J.LM1,5,1175.11),new Wd(16,J.FTM,6,1517.88),new Wd(16,J.LM2,4,1264.9),new Wd(17,J.FLM1,5,1184.72),new Wd(17,J.FLM2,5,1184.72),new Wd(18,J.FLM1,5,1581.32),new Wd(18,J.LM2,5,2259.03),new Wd(19,J.FLM1,5,1637.36),new Wd(19,J.LM3,5,2339.09),new Wd(20,J.SBL1,10,26),new Wd(21,J.SBFL1,1,31),new Wd(21,J.SBFL2,1,34),new Wd(22,J.SBFT,5,95),new Wd(23,J.SBFL1,5,61),new Wd(24,J.SBL1,5,43),new Wd(24,J.SBL3,5,45),new Wd(25,J.SBFL1,3,19),new Wd(25,J.SBFL2,4,20)],a=[J.TANCHOR,J.TFLASHLIGHT,J.TARROW,J.TSHIT],o=[new Nd(4,23,5,50,se.FINDTOWER,-5,""),new xd(13,23,10,J.TARROW,se.KILLMONSTER,-30),new Nd(4,10,20,300,se.KILLOBJECT,28,"")],vt=Gd.create(8,25,780,1,3,"level 119",a,r,.8,o,l.p(11*n+777*s,84*s)),r=[new Wd(1,J.LM3,10,23),new Wd(2,J.LM1,10,38),new Wd(3,J.LM2,12,78),new Wd(4,J.FTM,12,133),new Wd(5,J.FLM1,10,130),new Wd(6,J.FLM2,10,176),new Wd(7,J.LM3,10,400),new Wd(7,J.LM1,10,422),new Wd(8,J.LM2,10,755),new Wd(8,J.LM1,10,800),new Wd(9,J.FTM,10,1900),new Wd(9,J.LM3,12,1700),new Wd(10,J.FTM,12,2500),new Wd(10,J.FLM1,5,1300),new Wd(10,J.LM42,3,1800),new Wd(11,J.LM2,10,2660),new Wd(11,J.FLM2,10,1800),new Wd(12,J.LM1,6,3500),new Wd(12,J.SBL1,2,48.5),new Wd(12,J.LM1,6,3750.27),new Wd(13,J.SBL3,5,50),new Wd(13,J.LM3,5,4500),new Wd(13,J.FTM,5,7e3),new Wd(14,J.LM42,5,3800),new Wd(14,J.SBFL1,2,38),new Wd(14,J.LM44,5,3200),new Wd(14,J.SBFL2,2,35.5),new Wd(15,J.BMT,1,15),new Wd(15,J.SBL3,1,90),new Wd(15,J.SBFT,1,111),new Wd(15,J.SBFL1,1,60),new Wd(15,J.SBFL2,1,50)],a=[J.TBALL,J.TBOOMERANG,J.TFISH,J.TSNOW,J.TBOTTLE,J.TSTAR],o=[new xd(22,3,5,J.TBOOMERANG,se.BUILDTOWER,-3),new Nd(4,23,10,110,se.FINDTOWER,-4,"trocket,"),new xd(7,23,10,J.TSTAR,se.KILLMONSTER,-50)],Lt=Gd.create(8,15,480,1,3,"level 120",a,r,1.1,o,l.p(11*n+845*s,245*s)),r=[new Wd(1,J.FLM1,30,100),new Wd(2,J.LM3,5,230),new Wd(2,J.LM2,25,300),new Wd(3,J.LM1,15,800),new Wd(3,J.FTM,5,1e3),new Wd(4,J.LM2,4,3),new Wd(4,J.SBFT,16,15),new Wd(5,J.SBFL1,16,80),new Wd(5,J.BM3,1,82)],a=[J.TSTAR],o=[new xd(7,10,5,J.TSTAR,se.BUILDTOWER,-10),new xd(15,23,10,J.TPLANE,se.KILLMONSTER,-5),new Nd(4,23,10,180,se.FINDTOWER,-1,"tsun,")],Mt=Gd.create(8,5,6666,1,15,"level 121",a,r,1.4,o,l.p(12*n+39*s,265*s),165),r=[new Wd(1,J.LM1,4,10),new Wd(1,J.LM2,4,10),new Wd(2,J.LM3,4,20),new Wd(2,J.LM2,4,20),new Wd(3,J.FLM1,2,20),new Wd(3,J.LM2,6,30),new Wd(4,J.FLM2,2,25),new Wd(4,J.FTM,6,45),new Wd(5,J.FLM1,6,80),new Wd(5,J.FLM2,4,80),new Wd(6,J.LM3,4,200),new Wd(6,J.LM1,6,200),new Wd(7,J.FLM2,4,150),new Wd(7,J.FTM,6,300),new Wd(8,J.LM1,5,350),new Wd(8,J.FTM,5,500),new Wd(9,J.FTM,8,600),new Wd(9,J.FLM1,2,400),new Wd(10,J.FLM1,7,600),new Wd(10,J.SBL2,1,18),new Wd(11,J.FLM1,4,700),new Wd(11,J.FLM2,4,700),new Wd(12,J.LM2,4,1e3),new Wd(12,J.LM3,4,1e3),new Wd(13,J.LM3,6,1500),new Wd(13,J.FTM,2,1500),new Wd(14,J.LM1,2,2e3),new Wd(14,J.LM3,6,2e3),new Wd(15,J.LM1,5,2220),new Wd(15,J.LM2,5,2220),new Wd(16,J.FLM1,5,1530),new Wd(16,J.FLM2,5,1530),new Wd(17,J.LM2,5,2500),new Wd(17,J.FTM,5,3200),new Wd(18,J.FLM1,5,1630),new Wd(18,J.FTM,15,3300),new Wd(19,J.LM2,16,2640),new Wd(19,J.LM3,4,2700),new Wd(20,J.SBL3,5,65),new Wd(21,J.LM1,4,2900),new Wd(21,J.LM3,14,2920),new Wd(22,J.FLM1,8,1750),new Wd(22,J.FLM2,8,1800),new Wd(23,J.LM1,16,3100),new Wd(23,J.LM3,2,3100),new Wd(24,J.LM2,6,3400),new Wd(24,J.FTM,12,3700),new Wd(25,J.LM1,15,2600),new Wd(25,J.FLM2,5,1700),new Wd(25,J.SBFL2,1,65)],a=[J.TFLASHLIGHT,J.TMAGNET,J.TMOON,J.TFIREBOTTLE,J.TBALL],o=[new xd(1,10,10,J.TOWEREND,se.KILLMONSTER,-400),new Nd(4,23,10,240,se.FINDTOWER,-1,"tbottle,"),new xd(11,11,5,J.TMOON,se.BUILDTOWER,2)],Ct=Gd.create(8,25,888,1,3,"level 122",a,r,1.4,o,l.p(12*n+176*s,306*s),0,1,8e5),r=[new Wd(1,J.LM3,10,1),new Wd(2,J.LM1,10,2),new Wd(3,J.LM2,12,6),new Wd(4,J.FTM,12,15),new Wd(5,J.FLM1,10,15),new Wd(6,J.FLM2,10,25),new Wd(7,J.LM3,5,70),new Wd(7,J.LM1,5,60),new Wd(8,J.LM2,6,120),new Wd(8,J.LM1,6,100),new Wd(9,J.FTM,6,160),new Wd(9,J.LM3,6,120),new Wd(10,J.FTM,8,200),new Wd(10,J.FLM1,5,60),new Wd(11,J.FLM1,10,120),new Wd(11,J.FLM2,10,100),new Wd(12,J.LM2,10,200),new Wd(12,J.FLM2,10,150),new Wd(13,J.LM1,5,300),new Wd(13,J.SBL1,2,4),new Wd(13,J.LM1,8,300),new Wd(14,J.LM45,5,380),new Wd(15,J.SBL3,5,5.5),new Wd(15,J.LM3,8,400),new Wd(15,J.FTM,8,480),new Wd(16,J.FLM1,3,320),new Wd(16,J.SBFL1,1,4.7),new Wd(16,J.FLM1,4,350),new Wd(16,J.SBFL1,2,4.8),new Wd(16,J.FLM1,3,370),new Wd(16,J.SBFL1,2,5.35),new Wd(17,J.FTM,5,800),new Wd(17,J.SBFT,1,9.8),new Wd(17,J.FTM,8,750),new Wd(17,J.SBFT,4,9.8),new Wd(18,J.SBL1,2,12.5),new Wd(18,J.SBL2,2,11),new Wd(18,J.SBL3,3,12.5),new Wd(19,J.SBL3,2,12.5),new Wd(19,J.SBFL1,2,11),new Wd(18,J.SBFL2,3,12.5),new Wd(20,J.BMT,1,9.2),new Wd(20,J.SBL3,1,15),new Wd(20,J.SBFT,1,18),new Wd(20,J.SBFL1,1,7),new Wd(20,J.SBFL2,1,7.5)],a=[J.TMOON,J.TICEFAN,J.TMAGNET],o=[new xd(19,12,10,J.TMAGNET,se.BUILDTOWER,3),new xd(19,23,10,J.TMAGNET,se.KILLMONSTER,-100),new Nd(4,2,10,350,se.KILLOBJECT,2,",L3Ob1,L3Ob2,")],yt=Gd.create(8,20,750,1,3,"level 123",a,r,1,o,l.p(12*n+242*s,463*s)),r=[new Wd(1,J.LM1,5,5),new Wd(1,J.LM2,5,5),new Wd(2,J.LM1,5,7),new Wd(2,J.LM2,5,7),new Wd(3,J.LM1,5,11),new Wd(3,J.LM3,5,11),new Wd(3,J.FTM,5,20),new Wd(4,J.LM1,5,25),new Wd(4,J.FTM,10,35),new Wd(5,J.FLM1,8,30),new Wd(6,J.LM2,5,70),new Wd(6,J.FLM1,5,50),new Wd(7,J.FTM,5,120.17),new Wd(7,J.FLM2,5,75.93),new Wd(8,J.LM3,5,158.26),new Wd(8,J.LM2,5,158.26),new Wd(9,J.LM1,5,160),new Wd(9,J.LM2,5,160),new Wd(9,J.LM3,5,160),new Wd(10,J.SBFL1,2,5),new Wd(10,J.FLM1,8,140),new Wd(11,J.LM1,5,300),new Wd(11,J.LM2,5,300),new Wd(12,J.LM3,4,400),new Wd(12,J.LM2,6,400),new Wd(13,J.LM2,5,500),new Wd(13,J.LM3,5,500),new Wd(14,J.LM1,3,846.1),new Wd(14,J.LM3,7,846.1),new Wd(15,J.FTM,8,1090.82),new Wd(15,J.SBFT,2,1),new Wd(16,J.LM1,5,1178.2),new Wd(16,J.LM3,5,1178.2),new Wd(17,J.LM1,4,1182.12),new Wd(17,J.FTM,6,1242),new Wd(18,J.LM3,3,1240),new Wd(18,J.LM2,7,1240),new Wd(19,J.FTM,4,1513.49),new Wd(19,J.FLM2,6,602.87),new Wd(20,J.LM3,5,1281.03),new Wd(20,J.LM1,10,1281.03),new Wd(20,J.SBL2,5,15),new Wd(20,J.SBFT,5,15),new Wd(21,J.LM3,5,1548.08),new Wd(21,J.LM1,5,1548.08),new Wd(22,J.FLM2,6,857.51),new Wd(22,J.FLM1,4,857.51),new Wd(23,J.LM3,10,1587.65),new Wd(24,J.LM3,7,1657.65),new Wd(24,J.FTM,3,1828.91),new Wd(25,J.SBL2,10,18)],a=[J.TSUN,J.TBALL,J.TFLASHLIGHT,J.TCUTTLE,J.TBOOMERANG,J.TARROW],o=[new xd(8,13,10,J.TSUN,se.BUILDTOWER,4),new xd(18,23,10,J.TCUTTLE,se.KILLMONSTER,-100),new Nd(4,10,5,300,se.KILLOBJECT,11,"")],Bt=Gd.create(8,25,600,1,3,"level 124",a,r,2,o,l.p(12*n+404*s,482*s)),r=[new Wd(1,1,J.LM2,1,38),new Wd(1,2,J.LM2,1,38),new Wd(2,1,J.LM3,2,48),new Wd(2,2,J.LM3,2,48),new Wd(3,1,J.LM1,3,55),new Wd(3,2,J.LM1,3,55),new Wd(4,1,J.FTM,4,60),new Wd(4,2,J.FTM,4,60),new Wd(5,1,J.FLM2,5,30),new Wd(5,2,J.FLM2,5,30),new Wd(6,1,J.FLM1,6,40),new Wd(6,2,J.FLM1,6,40),new Wd(7,1,J.BMT,1,.33),new Wd(7,2,J.BMT,1,.33),new Wd(8,1,J.SBL2,3,1.5),new Wd(8,1,J.LM2,4,85),new Wd(8,2,J.SBL3,3,1.5),new Wd(8,2,J.LM3,4,85),new Wd(9,1,J.LM1,4,200),new Wd(9,1,J.SBFT,4,5),new Wd(9,2,J.LM1,4,200),new Wd(9,2,J.SBFT,4,5),new Wd(10,1,J.LM42,2,200),new Wd(10,2,J.LM44,2,200),new Wd(11,1,J.SBFL1,3,5),new Wd(11,1,J.SBFL2,3,4),new Wd(11,2,J.SBFL1,3,5),new Wd(11,2,J.SBFL2,3,4),new Wd(12,1,J.SBFT,8,16),new Wd(12,2,J.SBFT,8,16),new Wd(13,1,J.LM3,4,450),new Wd(13,1,J.LM43,2,500),new Wd(13,2,J.LM2,4,450),new Wd(13,2,J.LM41,2,500),new Wd(14,1,J.LM44,4,450),new Wd(14,1,J.SBFL2,4,8),new Wd(14,2,J.LM42,4,450),new Wd(14,2,J.SBFL1,4,8),new Wd(15,1,J.BMT,1,5),new Wd(15,2,J.BMT,1,5)],a=[J.TPLANE,J.TBOOMERANG,J.TSHIT,J.TBALL],o=[new xd(22,4,10,J.TBOOMERANG,se.BUILDTOWER,-4),new Nd(4,23,5,80,se.FINDTOWER,-4,"tsnow,"),new Nd(3,2,20,160,se.KILLOBJECT,2,",SC1Ob1,SC1Ob2,")],Ft=Gd.create(8,15,1500,1,3,"level 125",a,r,1,o,l.p(12*n+510*s,332*s)),r=[new Wd(1,J.FTM,8,0),new Wd(2,J.LM2,4,0),new Wd(2,J.LM1,4,0),new Wd(3,J.LM3,9,0),new Wd(4,J.LM2,10,0),new Wd(5,J.FLM1,4,0),new Wd(5,J.FLM1,4,0),new Wd(6,J.LM1,7,0),new Wd(7,J.FTM,8,0),new Wd(7,J.FLM2,1,0),new Wd(8,J.FLM2,8,0),new Wd(9,J.LM42,3,0),new Wd(9,J.LM42,3,0),new Wd(10,J.LM3,10,0),new Wd(10,J.SBL3,2,0),new Wd(11,J.LM1,10,0),new Wd(11,J.SBL1,5,0),new Wd(11,J.LM2,10,0),new Wd(11,J.SBL2,5,0),new Wd(12,J.LM41,8,0),new Wd(12,J.FLM1,5,0),new Wd(12,J.FLM2,5,0),new Wd(13,J.SBFT,2,0),new Wd(13,J.SBFT,2,0),new Wd(13,J.SBFT,2,0),new Wd(13,J.FLM2,8,0),new Wd(13,J.SBFL2,4,0),new Wd(14,J.SBL3,2,0),new Wd(14,J.FLM1,5,0),new Wd(14,J.SBFL1,4,0),new Wd(14,J.FLM2,5,0),new Wd(14,J.LM42,3,0),new Wd(14,J.LM43,3,0),new Wd(15,J.SBFT,2,0),new Wd(15,J.SBFL2,3,0),new Wd(15,J.SBFT,3,0),new Wd(15,J.BMT,1,0)],a=[J.TANCHOR,J.TSNOW],o=[new Nd(4,1,5,130,se.KILLOBJECT,1,",BC1Ob1,"),new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-90),new xd(20,22,10,J.TSNOW,se.BUILDTOWER,1)],Et=Gd.create(8,15,222,1,3,"level 126",a,r,1.2,o,l.p(12*n+544*s,179*s)),r=[new Wd(1,J.LM3,8,3.3),new Wd(2,J.LM2,10,4.4),new Wd(3,J.LM1,10,10),new Wd(4,J.FTM,10,27),new Wd(5,J.LM2,8,36),new Wd(5,J.FLM1,2,20),new Wd(6,J.FLM1,10,33),new Wd(7,J.LM1,8,70),new Wd(7,J.FLM2,4,40),new Wd(8,J.FLM2,6,63),new Wd(8,J.FLM1,6,78),new Wd(9,J.FTM,7,178),new Wd(9,J.LM3,3,105),new Wd(10,J.FTM,3,230),new Wd(10,J.SBFL2,1,2),new Wd(10,J.FTM,5,245),new Wd(11,J.LM2,8,238),new Wd(11,J.SBL2,1,4),new Wd(12,J.LM1,9,320),new Wd(12,J.LM41,2,330),new Wd(13,J.LM43,5,288),new Wd(14,J.SBL1,2,15),new Wd(14,J.SBL2,2,18),new Wd(14,J.SBL3,2,20),new Wd(15,J.SBFT,6,15),new Wd(15,J.LM42,2,400),new Wd(16,J.LM42,3,350),new Wd(16,J.FLM1,5,300),new Wd(17,J.LM2,6,400),new Wd(17,J.LM41,1,760),new Wd(17,J.FLM2,6,400),new Wd(18,J.FLM1,10,500),new Wd(18,J.SBFL2,5,15.5),new Wd(19,J.SBL1,3,23),new Wd(19,J.SBL3,3,27),new Wd(19,J.SBFL1,2,15.5),new Wd(20,J.LM41,2,800),new Wd(20,J.LM42,3,800),new Wd(21,J.SBL2,2,30),new Wd(21,J.LM44,2,700),new Wd(21,J.SBFL2,3,15),new Wd(22,J.SBFT,5,35),new Wd(22,J.BMT,1,10)],a=[J.TBOOMERANG,J.TFIREBOTTLE,J.TBOTTLE,J.TARROW,J.TCUTTLE],o=[new xd(15,23,10,J.TPLANE,se.KILLMONSTER,-111),new Nd(4,23,5,60,se.FINDTOWER,-1,"tmoon,"),new Nd(4,10,10,180,se.KILLOBJECT,17,"")],Pt=Gd.create(8,22,680,1,3,"level 127",a,r,1.3,o,l.p(12*n+633*s,79*s)),r=[new Wd(1,J.LM1,2,8800),new Wd(1,J.FTM,3,12e3),new Wd(2,J.LM2,4,13300),new Wd(3,J.SBFT,2,200),new Wd(3,J.BM2,1,290),new Wd(4,J.SBL3,1,200),new Wd(5,J.FLM1,2,200),new Wd(5,J.FLM2,2,200)],a=[J.TFLASHLIGHT,J.TBALL,J.TFISH,J.TPLANE,J.TMOON],o=[new Nd(4,24,5,80,se.KILLOBJECT,2,",S1Ob1,S3Ob2,"),new xd(14,23,10,J.TROCKET,se.KILLMONSTER,-6),new Nd(3,25,20,120,se.EARNMONEY,-3333)],bt=Gd.create(8,5,180,1,55,"level 128",a,r,.7,o,l.p(12*n+776*s,84*s),333),r=[new Wd(1,J.LM2,3,0),new Wd(1,J.LM3,3,0),new Wd(2,J.FTM,6,0),new Wd(3,J.LM1,8,0),new Wd(4,J.LM3,9,0),new Wd(5,J.FTM,6,0),new Wd(5,J.FLM2,1,0),new Wd(6,J.FLM2,5,0),new Wd(7,J.LM2,5,0),new Wd(7,J.FLM1,3,0),new Wd(8,J.FLM2,5,0),new Wd(8,J.FLM1,5,0),new Wd(9,J.LM3,10,0),new Wd(10,J.LM1,5,0),new Wd(10,J.FTM,6,0),new Wd(11,J.SBL2,1,0),new Wd(11,J.LM2,9,0),new Wd(12,J.SBL3,3,0),new Wd(12,J.LM41,3,0),new Wd(13,J.SBL1,3,0),new Wd(13,J.SBFL1,1,0),new Wd(13,J.SBFL2,1,0),new Wd(14,J.FLM1,9,0),new Wd(14,J.SBFL1,2,0),new Wd(15,J.FLM2,7,0),new Wd(15,J.SBFL2,3,0),new Wd(16,J.FTM,15,0),new Wd(17,J.LM44,3,0),new Wd(18,J.LM2,5,0),new Wd(18,J.SBL2,5,0),new Wd(18,J.LM2,5,0),new Wd(19,J.SBL3,2,0),new Wd(19,J.SBL1,2,0),new Wd(19,J.SBL3,2,0),new Wd(19,J.SBL1,2,0),new Wd(20,J.BMT,1,0),new Wd(20,J.LM43,2,0),new Wd(21,J.SBFL1,4,0),new Wd(21,J.FLM2,6,0),new Wd(22,J.SBFL2,4,0),new Wd(22,J.FLM1,6,0),new Wd(23,J.LM42,5,0),new Wd(24,J.SBL2,1,0),new Wd(24,J.SBL3,1,0),new Wd(24,J.SBL1,1,0),new Wd(25,J.LM41,1,0),new Wd(25,J.LM42,1,0),new Wd(25,J.LM43,1,0),new Wd(25,J.LM44,1,0)],a=[J.TMOON,J.TRANDOM,J.TMAGNET],o=[new xd(20,3,10,J.TSNOW,se.BUILDTOWER,-4),new Nd(4,10,10,240,se.KILLOBJECT,23,""),new Nd(4,23,5,100,se.FINDTOWER,-4,"tshit,")],At=Gd.create(8,25,999,1,3,"level 129",a,r,1,o,l.p(12*n+786*s,236*s)),r=[new Wd(1,J.LM1,5,0),new Wd(2,J.LM3,7,0),new Wd(3,J.LM2,9,0),new Wd(4,J.LM1,4,0),new Wd(4,J.FLM1,2,0),new Wd(5,J.FLM1,6,0),new Wd(6,J.FTM,3,0),new Wd(6,J.FLM2,1,0),new Wd(7,J.LM3,5,0),new Wd(7,J.FLM1,2,0),new Wd(8,J.FLM2,4,0),new Wd(8,J.FLM1,4,0),new Wd(9,J.LM2,9,0),new Wd(9,J.FTM,6,0),new Wd(10,J.SBL1,1,0),new Wd(10,J.LM1,12,0),new Wd(11,J.SBL3,5,0),new Wd(11,J.LM3,10,0),new Wd(12,J.FLM1,12,0),new Wd(12,J.SBFL2,3,0),new Wd(13,J.FLM2,9,0),new Wd(13,J.SBFL1,6,0),new Wd(14,J.LM1,6,0),new Wd(14,J.SBFT,3,0),new Wd(14,J.LM2,6,0),new Wd(15,J.SBL3,4,0),new Wd(15,J.SBFL1,3,0),new Wd(15,J.SBFL2,3,0)],a=[J.TSUN,J.TMOON,J.TSTAR],o=[new Nd(4,25,5,130,se.KILLOBJECT,2,",BC1Ob1,BC1Ob2,"),new xd(11,23,20,J.TMOON,se.KILLMONSTER,-88),new Nd(4,10,10,150,se.KILLOBJECT,14,"")],Ot=Gd.create(8,15,1e3,1,3,"level 130",a,r,.85,o,l.p(12*n+888*s,298*s)),r=[new Wd(1,J.LM2,8,2),new Wd(2,J.LM1,5,10),new Wd(2,J.LM3,5,14),new Wd(3,J.LM2,6,25),new Wd(3,J.LM3,6,28),new Wd(4,J.LM1,5,38),new Wd(4,J.FTM,7,56.6),new Wd(5,J.LM3,7,60),new Wd(5,J.LM2,7,67),new Wd(6,J.FTM,12,105),new Wd(7,J.LM1,10,110),new Wd(7,J.FLM1,3,70),new Wd(8,J.FLM1,12,100),new Wd(9,J.FLM2,2,155),new Wd(9,J.FTM,8,390),new Wd(9,J.FLM2,3,170),new Wd(10,J.SBL1,1,7.2),new Wd(10,J.SBL2,2,6.4),new Wd(10,J.SBL3,3,6.5),new Wd(11,J.LM3,12,500),new Wd(11,J.LM41,3,450),new Wd(12,J.FLM2,12,420),new Wd(13,J.LM1,12,900),new Wd(13,J.LM2,12,900),new Wd(14,J.FLM1,8,700),new Wd(14,J.LM44,4,700),new Wd(15,J.FTM,12,1500),new Wd(15,J.SBFT,3,22),new Wd(16,J.LM41,5,1500),new Wd(16,J.LM3,6,1e3),new Wd(16,J.FLM2,6,850),new Wd(17,J.LM42,5,2000.32),new Wd(17,J.FLM1,10,900),new Wd(18,J.FLM1,10,1216.25),new Wd(18,J.FLM2,10,1216.25),new Wd(19,J.SBL1,6,30),new Wd(19,J.SBL2,6,28),new Wd(20,J.SBFL1,5,20),new Wd(20,J.SBFL2,5,18.6),new Wd(21,J.BMT,1,60),new Wd(21,J.SBFT,5,60)],a=[J.TBOOMERANG,J.TBOTTLE,J.TSHIT,J.TMAGNET],o=[new Nd(4,4,10,120,se.KILLOBJECT,4,",L2Ob1,L2Ob2,L2Ob3,L2Ob4,"),new Nd(4,24,5,80,se.KILLOBJECT,1,",S1Ob3,"),new xd(19,23,10,J.TMAGNET,se.KILLMONSTER,-20)],It=Gd.create(8,21,320,1,3,"level 131",a,r,1.4,o,l.p(13*n+65*s,294*s)),r=[new Wd(1,J.LM3,6,0),new Wd(2,J.LM1,8,0),new Wd(3,J.LM2,10,0),new Wd(4,J.LM1,7,0),new Wd(4,J.FLM1,2,0),new Wd(5,J.FLM2,8,0),new Wd(6,J.FTM,8,0),new Wd(6,J.FLM1,2,0),new Wd(7,J.LM3,7,0),new Wd(7,J.FLM2,3,0),new Wd(8,J.FLM2,5,0),new Wd(8,J.FLM1,5,0),new Wd(9,J.LM2,5,0),new Wd(9,J.FTM,6,0),new Wd(10,J.SBL1,1,0),new Wd(10,J.LM1,10,0),new Wd(11,J.SBL3,3,0),new Wd(11,J.LM3,7,0),new Wd(12,J.FLM1,8,0),new Wd(12,J.SBFL2,2,0),new Wd(13,J.FLM2,7,0),new Wd(13,J.SBFL1,3,0),new Wd(14,J.FTM,15,0),new Wd(15,J.LM2,5,0),new Wd(15,J.SBL2,3,0),new Wd(15,J.LM2,5,0),new Wd(16,J.FTM,5,0),new Wd(16,J.SBFT,5,0),new Wd(16,J.FTM,5,0),new Wd(17,J.FLM1,6,0),new Wd(17,J.FLM2,6,0),new Wd(18,J.SBL1,1,0),new Wd(18,J.SBL3,1,0),new Wd(18,J.SBL1,2,0),new Wd(18,J.SBL3,2,0),new Wd(19,J.SBFL1,3,0),new Wd(19,J.LM43,3,0),new Wd(19,J.SBFL2,3,0),new Wd(20,J.SBL2,2,0),new Wd(20,J.BMT,1,0),new Wd(20,J.SBL2,2,0)],a=[J.TMAGNET,J.TSNOW,J.TSHIT,J.TFISH],o=[new Nd(3,25,10,120,se.EARNMONEY,-1600),new Nd(4,23,10,80,se.FINDTOWER,-2,"tplane,"),new xd(16,23,10,J.TFISH,se.KILLMONSTER,-88)],Rt=Gd.create(8,20,1,1,3,"level 132",a,r,1.3,o,l.p(13*n+154*s,130*s)),r=[new Wd(1,J.FTM,8,2),new Wd(2,J.LM1,10,10),new Wd(3,J.LM2,4,18),new Wd(3,J.LM3,6,20),new Wd(4,J.LM1,5,30),new Wd(4,J.LM2,5,33),new Wd(5,J.LM3,7,30),new Wd(5,J.FLM1,3,10),new Wd(6,J.FLM2,5,15),new Wd(6,J.FTM,7,115),new Wd(7,J.LM2,8,100),new Wd(7,J.LM45,2,100),new Wd(8,J.LM1,5,113),new Wd(8,J.FLM1,7,30),new Wd(9,J.LM3,5,220),new Wd(9,J.FLM2,9,50),new Wd(10,J.SBFL1,4,3.8),new Wd(10,J.LM45,1,250),new Wd(11,J.SBL2,6,8.2),new Wd(12,J.FTM,12,1e3),new Wd(13,J.LM1,8,1100),new Wd(13,J.SBFL2,3,5),new Wd(14,J.LM2,6,1400),new Wd(14,J.LM3,6,1450),new Wd(15,J.SBFT,2,21),new Wd(15,J.FTM,5,2e3),new Wd(15,J.SBFT,3,23.2),new Wd(16,J.SBFL2,6,15),new Wd(17,J.LM2,8,2e3),new Wd(17,J.LM1,8,2100),new Wd(18,J.SBFT,5,25),new Wd(18,J.LM3,10,2300),new Wd(19,J.SBL1,5,28),new Wd(19,J.SBL3,5,30.3),new Wd(20,J.SBFL1,2,20),new Wd(20,J.SBFL2,2,21),new Wd(20,J.LM45,2,2400),new Wd(20,J.SBFL1,2,22),new Wd(20,J.SBFL2,2,23.5),new Wd(21,J.FLM1,7,1216.25),new Wd(21,J.FLM2,7,1216.25),new Wd(22,J.SBL1,6,30),new Wd(22,J.SBL2,6,28),new Wd(23,J.SBFL1,5,20),new Wd(23,J.SBFL2,5,18.6),new Wd(24,J.SBFT,5,60),new Wd(25,J.LM44,4,60)],a=[J.TRANDOM,J.TCUTTLE],o=[new xd(11,4,5,J.TMOON,se.BUILDTOWER,-4),new xd(22,23,10,J.TBOOMERANG,se.KILLMONSTER,-100),new Nd(4,21,10,360,se.KILLOBJECT,1,",DB2Ob1,")],Dt=Gd.create(8,25,400,1,3,"level 133",a,r,1.4,o,l.p(13*n+343*s,110*s),0,1,6e5),r=[new Wd(1,1,J.LM2,4,0),new Wd(1,2,J.LM1,4,0),new Wd(2,1,J.LM1,5,0),new Wd(2,2,J.LM3,5,0),new Wd(3,1,J.FTM,5,0),new Wd(3,1,J.LM2,5,0),new Wd(3,2,J.FTM,5,0),new Wd(3,2,J.LM3,5,0),new Wd(4,1,J.FLM1,5,0),new Wd(4,2,J.FLM2,5,0),new Wd(5,1,J.SBL1,1,0),new Wd(5,1,J.SBL1,1,0),new Wd(5,2,J.SBL1,1,0),new Wd(5,2,J.SBL1,1,0),new Wd(6,1,J.SBL3,1,0),new Wd(6,2,J.SBL3,1,0),new Wd(7,1,J.LM45,1,0),new Wd(7,1,J.SBL2,1,0),new Wd(7,2,J.LM45,1,0),new Wd(7,2,J.SBL2,1,0),new Wd(8,1,J.LM3,8,0),new Wd(8,2,J.LM3,8,0),new Wd(9,1,J.LM1,4,0),new Wd(9,1,J.FTM,5,0),new Wd(9,2,J.LM1,4,0),new Wd(9,2,J.FTM,5,0),new Wd(10,1,J.FLM1,10,0),new Wd(10,2,J.FLM1,10,0),new Wd(11,1,J.SBFT,4,0),new Wd(11,2,J.SBFT,4,0),new Wd(12,1,J.FLM2,10,0),new Wd(12,2,J.FLM2,10,0),new Wd(13,1,J.LM44,2,0),new Wd(13,2,J.LM44,2,0),new Wd(14,1,J.LM1,10,0),new Wd(14,2,J.LM1,10,0),new Wd(15,1,J.FTM,7,0),new Wd(15,1,J.SBFT,2,0),new Wd(15,1,J.SBFT,2,0),new Wd(15,2,J.FTM,7,0),new Wd(15,2,J.SBFT,2,0),new Wd(15,2,J.SBFT,2,0),new Wd(16,1,J.SBFL1,3,0),new Wd(16,1,J.SBFL2,3,0),new Wd(16,2,J.SBFL1,3,0),new Wd(16,2,J.SBFL2,3,0),new Wd(17,1,J.LM2,12,0),new Wd(17,2,J.LM2,12,0),new Wd(18,1,J.LM3,5,0),new Wd(18,1,J.LM43,2,0),new Wd(18,2,J.LM3,5,0),new Wd(18,2,J.LM43,2,0),new Wd(19,1,J.SBL3,1,0),new Wd(19,1,J.SBL2,1,0),new Wd(19,1,J.SBL1,1,0),new Wd(19,1,J.LM42,1,0),new Wd(19,2,J.SBL3,1,0),new Wd(19,2,J.SBL2,1,0),new Wd(19,2,J.SBL1,1,0),new Wd(19,2,J.LM42,1,0),new Wd(20,1,J.SBFT,3,0),new Wd(20,1,J.LM41,2,0),new Wd(20,2,J.SBFT,3,0),new Wd(20,2,J.LM41,2,0),new Wd(21,1,J.SBFL1,5,0),new Wd(21,1,J.SBFL2,5,0),new Wd(21,2,J.BMT,1,0)],a=[J.TFIREBOTTLE,J.TBOOMERANG,J.TFLASHLIGHT,J.TSNOW,J.TARROW,J.TANCHOR,J.TICEFAN,J.TBOTTLE],o=[new Nd(4,10,10,100,se.KILLOBJECT,11,",B2Ob1,S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,S1Ob7,S1Ob8,S1Ob9,S1Ob10,"),new xd(20,13,10,J.TSNOW,se.BUILDTOWER,4),new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-80)],xt=Gd.create(8,21,900,1,3,"level 134",a,r,1.3,o,l.p(13*n+499*s,216*s)),r=[new Wd(1,J.LM1,5,10),new Wd(1,J.LM2,5,10),new Wd(1,J.LM3,5,10),new Wd(2,J.LM2,5,50),new Wd(2,J.LM3,5,50),new Wd(2,J.LM1,5,50),new Wd(2,J.SBB,1,60),new Wd(3,J.FLM1,8,50),new Wd(3,J.LM3,4,90),new Wd(3,J.LM2,3,90),new Wd(4,J.LM1,2,120),new Wd(4,J.FLM2,7,80),new Wd(4,J.FLM1,6,80),new Wd(5,J.LM1,6,180),new Wd(5,J.FTM,2,280),new Wd(5,J.LM3,7,180),new Wd(6,J.LM3,5,250),new Wd(6,J.FTM,4,320),new Wd(6,J.LM2,6,250),new Wd(7,J.LM3,5,300),new Wd(7,J.LM2,5,300),new Wd(7,J.LM1,5,300),new Wd(8,J.FLM2,5,250),new Wd(8,J.LM1,8,350),new Wd(8,J.FLM1,2,200),new Wd(9,J.LM1,3,450),new Wd(9,J.FLM1,6,300),new Wd(9,J.FLM2,6,300),new Wd(10,J.LM2,10,520),new Wd(10,J.LM1,10,520),new Wd(10,J.LM3,10,520),new Wd(11,J.LM3,6,800),new Wd(11,J.FLM1,4,600),new Wd(11,J.LM1,5,800),new Wd(12,J.FLM1,5,640),new Wd(12,J.FLM2,5,640),new Wd(12,J.LM1,5,880),new Wd(13,J.FLM1,4,700),new Wd(13,J.LM1,6,950),new Wd(13,J.LM3,5,950),new Wd(14,J.LM2,5,1e3),new Wd(14,J.FLM2,4,900),new Wd(14,J.LM1,6,1e3),new Wd(15,J.SBFL1,1,25),new Wd(15,J.FLM1,10,950),new Wd(15,J.FLM2,10,950),new Wd(15,J.BMT,5,950)],a=[J.TBOTTLE,J.TSHIT,J.TICEFAN,J.TFISH,J.TANCHOR,J.TBALL,J.TPLANE,J.TFIREBOTTLE,J.TROCKET,J.TCUTTLE],o=[new xd(10,23,10,J.TICEFAN,se.KILLMONSTER,-50),new Nd(4,10,10,300,se.KILLOBJECT,11,""),new xd(9,12,10,J.TBALL,se.BUILDTOWER,3)],Nt=Gd.create(8,15,999,1,3,"level 135",a,r,.8,o,l.p(13*n+367*s,451*s)),r=[new Wd(1,J.FTM,8,0),new Wd(2,J.LM2,5,0),new Wd(2,J.FTM,5,0),new Wd(3,J.LM3,8,0),new Wd(4,J.LM1,6,0),new Wd(4,J.FLM2,6,0),new Wd(5,J.SBFT,2,0),new Wd(5,J.LM3,8,0),new Wd(6,J.LM3,8,0),new Wd(7,J.FLM2,12,0),new Wd(8,J.SBFT,3,0),new Wd(8,J.LM2,3,0),new Wd(8,J.FLM1,4,0),new Wd(9,J.LM1,8,0),new Wd(9,J.SBFL1,4,0),new Wd(10,J.LM2,8,0),new Wd(11,J.FLM2,12,0),new Wd(12,J.SBL2,10,0),new Wd(13,J.LM2,8,0),new Wd(13,J.SBFL1,4,0),new Wd(14,J.FTM,4,0),new Wd(14,J.SBL3,3,0),new Wd(14,J.FLM1,4,0),new Wd(15,J.LM44,4,0),new Wd(15,J.LM1,10,0),new Wd(16,J.SBL1,2,0),new Wd(16,J.LM3,6,0),new Wd(16,J.FLM2,6,0),new Wd(17,J.SBFL2,4,0),new Wd(17,J.FLM2,8,0),new Wd(18,J.FTM,3,0),new Wd(18,J.LM1,3,0),new Wd(18,J.FLM2,4,0),new Wd(19,J.LM1,5,0),new Wd(19,J.FTM,5,0),new Wd(20,J.LM42,4,0),new Wd(20,J.SBL3,5,0)],a=[J.TBOTTLE,J.TPLANE,J.TICEFAN,J.TFIREBOTTLE,J.TPIN],o=[new xd(15,12,10,J.TPLANE,se.BUILDTOWER,3),new Nd(4,2,10,100,se.KILLOBJECT,2,",B1Ob1,B1Ob2,"),new Nd(4,10,20,200,se.KILLOBJECT,37,"")],Gt=Gd.create(9,20,920,1,3,"level 136",a,r,1.2,o,l.p(553*s,145*s)),r=[new Wd(1,1,J.LM2,4,0),new Wd(1,1,J.FTM,4,0),new Wd(1,2,J.LM2,4,0),new Wd(1,2,J.FTM,4,0),new Wd(2,1,J.LM3,8,0),new Wd(2,2,J.LM3,8,0),new Wd(3,1,J.LM1,6,0),new Wd(3,1,J.FLM2,4,0),new Wd(3,2,J.LM1,6,0),new Wd(3,2,J.FLM2,4,0),new Wd(4,1,J.SBFT,2,0),new Wd(4,1,J.LM3,7,0),new Wd(4,2,J.SBFT,2,0),new Wd(4,2,J.LM3,7,0),new Wd(5,1,J.LM3,12,0),new Wd(5,2,J.LM3,12,0),new Wd(6,1,J.LM2,7,0),new Wd(6,1,J.SBFT,1,0),new Wd(6,2,J.LM2,7,0),new Wd(6,2,J.SBFT,1,0),new Wd(7,1,J.LM1,6,0),new Wd(7,1,J.SBL1,1,0),new Wd(7,2,J.LM1,6,0),new Wd(7,2,J.SBL1,1,0),new Wd(8,1,J.LM2,8,0),new Wd(8,2,J.LM2,8,0),new Wd(9,1,J.SBL2,3,0),new Wd(9,1,J.LM2,5,0),new Wd(9,2,J.SBL2,3,0),new Wd(9,2,J.LM2,5,0),new Wd(10,1,J.LM2,8,0),new Wd(10,1,J.SBL1,2,0),new Wd(10,2,J.LM2,8,0),new Wd(10,2,J.SBL1,2,0),new Wd(11,1,J.FTM,4,0),new Wd(11,1,J.SBL3,3,0),new Wd(11,1,J.FLM1,4,0),new Wd(11,2,J.FTM,4,0),new Wd(11,2,J.SBL3,3,0),new Wd(11,2,J.FLM1,4,0),new Wd(12,1,J.LM44,4,0),new Wd(12,1,J.LM1,10,0),new Wd(12,2,J.LM44,4,0),new Wd(12,2,J.LM1,10,0),new Wd(13,1,J.SBL2,2,0),new Wd(13,1,J.LM3,8,0),new Wd(13,2,J.SBL2,2,0),new Wd(13,2,J.LM3,8,0),new Wd(14,1,J.FTM,3,0),new Wd(14,1,J.LM1,3,0),new Wd(14,1,J.FLM2,4,0),new Wd(14,2,J.FTM,3,0),new Wd(14,2,J.LM1,3,0),new Wd(14,2,J.FLM2,4,0),new Wd(15,1,J.LM1,5,0),new Wd(15,1,J.FTM,5,0),new Wd(15,2,J.LM1,5,0),new Wd(15,2,J.FTM,5,0),new Wd(16,1,J.LM42,3,0),new Wd(16,1,J.SBL3,4,0),new Wd(16,2,J.LM42,3,0),new Wd(16,2,J.SBL3,4,0)],a=[J.TFISH,J.TSNOW,J.TBOOMERANG,J.TMOON,J.TARROW,J.TPIN,J.TBOTTLE],o=[new xd(11,22,20,J.TMOON,se.BUILDTOWER,1),new Nd(3,3,20,135,se.KILLOBJECT,3,",SC1Ob1,SC1Ob2,SC1Ob3,"),new xd(16,8,10,J.TFISH,se.BUILDTOWER,-8)],Wt=Gd.create(9,16,760,1,3,"level 137",a,r,1.2,o,l.p(718*s,100*s)),r=[new Wd(1,J.LM1,5,0),new Wd(1,J.FTM,5,0),new Wd(2,J.LM1,10,0),new Wd(3,J.LM2,12,0),new Wd(4,J.LM2,6,0),new Wd(4,J.FLM1,6,0),new Wd(5,J.SBFT,4,0),new Wd(5,J.LM1,8,0),new Wd(6,J.SBL1,2,0),new Wd(6,J.LM2,6,0),new Wd(6,J.FLM1,6,0),new Wd(7,J.LM2,6,0),new Wd(7,J.FLM1,6,0),new Wd(8,J.FTM,3,0),new Wd(8,J.LM3,3,0),new Wd(8,J.FLM1,4,0),new Wd(9,J.SBL3,4,0),new Wd(9,J.LM1,6,0),new Wd(9,J.FLM1,6,0),new Wd(10,J.SBL3,4,0),new Wd(10,J.LM2,10,0),new Wd(11,J.FLM1,12,0),new Wd(12,J.FTM,3,0),new Wd(12,J.LM1,3,0),new Wd(12,J.SBFL1,4,0),new Wd(13,J.FTM,4,0),new Wd(13,J.SBL1,3,0),new Wd(13,J.FLM2,4,0),new Wd(14,J.LM2,5,0),new Wd(14,J.FTM,5,0),new Wd(15,J.LM1,6,0),new Wd(15,J.FLM2,6,0),new Wd(16,J.LM2,6,0),new Wd(16,J.FTM,6,0),new Wd(17,J.LM43,4,0),new Wd(17,J.FTM,8,0),new Wd(18,J.SBFT,3,0),new Wd(18,J.LM1,3,0),new Wd(18,J.FLM1,4,0),new Wd(19,J.SBFL1,4,0),new Wd(19,J.LM42,2,0),new Wd(19,J.LM1,4,0),new Wd(20,J.BMT,1,0),new Wd(20,J.SBL1,3,0),new Wd(20,J.LM2,6,0)],a=[J.TRANDOM],o=[new Nd(3,4,10,180,se.KILLOBJECT,4,",SC1Ob1,SC1Ob2,SC1Ob3,SC1Ob4,"),new xd(10,3,10,J.TICEFAN,se.BUILDTOWER,-3),new Nd(4,10,20,260,se.KILLOBJECT,38,"")],kt=Gd.create(9,20,920,1,3,"level 138",a,r,1.3,o,l.p(902*s,94*s)),r=[new Wd(1,1,J.LM2,5,0),new Wd(1,1,J.FTM,5,0),new Wd(1,2,J.LM2,5,0),new Wd(1,2,J.FTM,5,0),new Wd(2,1,J.LM3,8,0),new Wd(2,2,J.LM3,8,0),new Wd(3,1,J.LM1,6,0),new Wd(3,1,J.FLM2,5,0),new Wd(3,2,J.LM1,6,0),new Wd(3,2,J.FLM2,5,0),new Wd(4,1,J.SBFT,2,0),new Wd(4,1,J.LM1,8,0),new Wd(4,2,J.SBFT,2,0),new Wd(4,2,J.LM1,8,0),new Wd(5,1,J.LM3,8,0),new Wd(5,2,J.LM3,8,0),new Wd(6,1,J.FLM2,8,0),new Wd(6,2,J.FLM2,8,0),new Wd(7,1,J.SBL1,2,0),new Wd(7,1,J.LM2,10,0),new Wd(7,2,J.SBL1,2,0),new Wd(7,2,J.LM2,10,0),new Wd(8,1,J.LM1,6,0),new Wd(8,1,J.FLM1,6,0),new Wd(8,2,J.LM1,6,0),new Wd(8,2,J.FLM1,6,0),new Wd(9,1,J.FTM,6,0),new Wd(9,1,J.FLM2,6,0),new Wd(9,2,J.FTM,6,0),new Wd(9,2,J.FLM2,6,0),new Wd(10,1,J.SBL1,2,0),new Wd(10,1,J.LM3,6,0),new Wd(10,1,J.FLM1,6,0),new Wd(10,2,J.SBL1,2,0),new Wd(10,2,J.LM3,6,0),new Wd(10,2,J.FLM1,6,0),new Wd(11,1,J.SBL2,2,0),new Wd(11,1,J.SBFL1,2,0),new Wd(11,1,J.LM1,3,0),new Wd(11,2,J.SBL2,2,0),new Wd(11,2,J.SBFL1,2,0),new Wd(11,2,J.LM1,3,0),new Wd(12,1,J.LM3,8,0),new Wd(12,2,J.LM3,8,0),new Wd(13,1,J.LM3,5,0),new Wd(13,1,J.FTM,5,0),new Wd(13,2,J.LM3,5,0),new Wd(13,2,J.FTM,5,0),new Wd(14,1,J.LM41,4,0),new Wd(14,1,J.LM1,10,0),new Wd(14,2,J.LM41,4,0),new Wd(14,2,J.LM1,10,0),new Wd(15,1,J.BMT,1,0),new Wd(15,1,J.LM45,3,0),new Wd(15,1,J.SBL3,4,0),new Wd(15,2,J.BMT,1,0),new Wd(15,2,J.LM45,3,0),new Wd(15,2,J.SBL3,4,0)],a=[J.TFISH,J.TFLASHLIGHT,J.TBOOMERANG,J.TICEFAN,J.TBOTTLE],o=[new Nd(3,25,20,105,se.EARNMONEY,-5500),new xd(22,23,10,J.TBOOMERANG,se.KILLMONSTER,-200),new xd(10,12,20,J.TICEFAN,se.BUILDTOWER,3)],Ut=Gd.create(9,15,1e3,1,3,"level 139",a,r,1.1,o,l.p(1*n+112*s,162*s)),r=[new Wd(1,J.SBFT,5,200),new Wd(2,J.SBL2,5,220),new Wd(3,J.LM2,3,1e4),new Wd(3,J.SBFL1,3,250),new Wd(4,J.SBL2,5,150),new Wd(5,J.LM41,3,11e3),new Wd(5,J.FLM1,3,12500),new Wd(5,J.BM1,1,280)],a=[J.TCUTTLE,J.TPLANE,J.TBOOMERANG,J.TBALL,J.TBOTTLE],o=[new Nd(4,23,10,25,se.FINDTOWER,-4,"tsun,"),new Nd(3,25,20,90,se.EARNMONEY,-6e3),new xd(18,8,20,J.TCUTTLE,se.BUILDTOWER,-8)],Ht=Gd.create(9,5,920,1,3,"level 140",a,r,1.1,o,l.p(1*n+294*s,167*s),295),r=[new Wd(1,J.LM2,8,0),new Wd(2,J.LM3,8,0),new Wd(3,J.LM1,6,0),new Wd(3,J.FLM2,6,0),new Wd(4,J.LM2,6,0),new Wd(4,J.FLM1,6,0),new Wd(5,J.LM3,5,0),new Wd(5,J.FTM,5,0),new Wd(6,J.LM1,8,0),new Wd(6,J.SBFL1,4,0),new Wd(7,J.LM3,8,0),new Wd(8,J.LM1,8,0),new Wd(8,J.SBFL2,4,0),new Wd(9,J.LM3,6,0),new Wd(9,J.FLM2,6,0),new Wd(10,J.FLM1,12,0),new Wd(11,J.LM3,5,0),new Wd(11,J.FTM,5,0),new Wd(12,J.FLM1,12,0),new Wd(13,J.FLM2,12,0),new Wd(14,J.LM2,5,0),new Wd(14,J.FTM,5,0),new Wd(15,J.SBL1,4,0),new Wd(15,J.SBFL1,4,0),new Wd(16,J.LM3,5,0),new Wd(16,J.FTM,5,0),new Wd(17,J.LM3,5,0),new Wd(17,J.FTM,5,0),new Wd(18,J.SBL1,2,0),new Wd(18,J.LM3,10,0),new Wd(19,J.SBL3,3,0),new Wd(19,J.LM1,6,0),new Wd(19,J.SBFL1,3,0),new Wd(20,J.LM44,4,0),new Wd(20,J.FLM2,10,0),new Wd(21,J.LM2,6,0),new Wd(21,J.FLM1,6,0),new Wd(22,J.LM43,4,0),new Wd(22,J.SBFL1,5,0),new Wd(23,J.SBL3,10,0),new Wd(24,J.LM3,5,0),new Wd(24,J.SBFT,5,0),new Wd(25,J.BMT,1,0),new Wd(25,J.LM41,4,0),new Wd(25,J.SBL3,7,0)],a=[J.TMAGNET,J.TMOON,J.TFISH,J.TBLUESTAR,J.TBOTTLE,J.TARROW],o=[new Nd(4,5,20,110,se.KILLOBJECT,5,",B2Ob1,B2Ob2,B2Ob3,B2Ob4,B2Ob5,"),new xd(11,22,10,J.TMOON,se.BUILDTOWER,1),new xd(19,23,10,J.TMAGNET,se.KILLMONSTER,-50)],Vt=Gd.create(9,25,100,1,3,"level 141",a,r,1.3,o,l.p(1*n+474*s,135*s)),r=[new Wd(1,J.LM1,10,0),new Wd(2,J.FTM,3,0),new Wd(2,J.LM1,3,0),new Wd(2,J.FLM2,4,0),new Wd(3,J.LM1,6,0),new Wd(3,J.FLM1,6,0),new Wd(4,J.LM2,12,0),new Wd(5,J.SBFT,2,0),new Wd(5,J.LM3,8,0),new Wd(6,J.LM3,15,0),new Wd(7,J.FLM2,12,0),new Wd(8,J.SBL1,2,0),new Wd(8,J.LM1,6,0),new Wd(8,J.FLM1,6,0),new Wd(9,J.SBFL1,4,0),new Wd(9,J.FLM2,8,0),new Wd(10,J.LM3,8,0),new Wd(11,J.FLM1,12,0),new Wd(12,J.LM42,4,0),new Wd(12,J.SBL3,10,0),new Wd(13,J.LM3,5,0),new Wd(13,J.SBFL1,5,0),new Wd(14,J.SBL2,8,0),new Wd(15,J.SBL3,2,0),new Wd(15,J.LM2,10,0),new Wd(16,J.LM41,4,0),new Wd(16,J.FLM2,10,0),new Wd(17,J.LM41,4,0),new Wd(17,J.SBFL2,5,0),new Wd(18,J.SBFT,6,0),new Wd(18,J.FLM1,6,0),new Wd(20,J.FLM1,6,0),new Wd(17,J.SBFL2,5,0),new Wd(21,J.LM41,4,0),new Wd(21,J.SBFL1,5,0)],a=[J.TMOON,J.TSHIT,J.TFLASHLIGHT,J.TCUTTLE,J.TICEFAN,J.TBALL,J.TARROW],o=[new Nd(2,21,20,360,se.KILLOBJECT,1,",DB1Ob1,"),new xd(11,22,20,J.TMOON,se.BUILDTOWER,1),new Nd(3,3,10,115,se.KILLOBJECT,3,",SC1Ob1,SC1Ob2,SC1Ob3,")],zt=Gd.create(9,21,920,1,3,"level 142",a,r,1.5,o,l.p(1*n+667*s,142*s),0,1,65e4),r=[new Wd(1,J.BM2,1,450),new Wd(1,J.LM3,5,7500),new Wd(2,J.SBL1,2,150),new Wd(2,J.LM2,3,13e3),new Wd(3,J.LM41,2,12e3),new Wd(3,J.FLM2,3,13e3),new Wd(4,J.SBL1,2,160),new Wd(4,J.SBFL2,3,160),new Wd(5,J.LM2,3,15e3),new Wd(5,J.FTM,3,15e3),new Wd(6,J.SBL1,3,150),new Wd(6,J.SBFL1,3,150)],a=[J.TSUN,J.TMOON,J.TPLANE,J.TROCKET,J.TBOTTLE,J.TICEFAN],o=[new Nd(4,4,10,80,se.KILLOBJECT,4,",L3Ob1,L3Ob2,L3Ob3,L3Ob4,"),new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-10),new Nd(4,10,20,115,se.KILLOBJECT,32,"")],Yt=Gd.create(9,6,920,1,3,"level 143",a,r,1.1,o,l.p(1*n+791*s,225*s),260),r=[new Wd(1,J.LM1,8,0),new Wd(2,J.LM2,8,0),new Wd(3,J.FLM1,12,0),new Wd(4,J.FLM2,12,0),new Wd(5,J.SBL3,2,0),new Wd(5,J.LM1,10,0),new Wd(6,J.FTM,4,0),new Wd(6,J.SBL3,2,0),new Wd(6,J.FLM1,4,0),new Wd(7,J.FTM,4,0),new Wd(7,J.SBL3,3,0),new Wd(7,J.FLM2,4,0),new Wd(8,J.SBL1,5,0),new Wd(8,J.FLM1,6,0),new Wd(9,J.SBL3,5,0),new Wd(9,J.FLM2,6,0),new Wd(10,J.LM42,4,0),new Wd(10,J.SBL2,5,0),new Wd(11,J.LM42,4,0),new Wd(11,J.SBL3,5,0),new Wd(12,J.LM41,4,0),new Wd(12,J.SBFL1,5,0),new Wd(13,J.LM41,4,0),new Wd(13,J.SBFL2,5,0),new Wd(14,J.SBL1,5,0),new Wd(14,J.LM2,12,0),new Wd(15,J.SBL2,4,0),new Wd(15,J.FTM,8,0),new Wd(16,J.LM3,6,0),new Wd(16,J.FLM1,6,0),new Wd(17,J.SBFL1,6,0),new Wd(17,J.FLM2,8,0),new Wd(18,J.SBL2,15,0),new Wd(19,J.SBL3,15,0),new Wd(20,J.BMT,1,0),new Wd(20,J.LM45,6,0),new Wd(20,J.SBFL2,7,0)],a=[J.TSUN,J.TBLUESTAR,J.TPLANE,J.TSTAR,J.TBOTTLE,J.TMOON,J.TPIN],o=[new xd(11,23,20,J.TMOON,se.KILLMONSTER,-100),new Nd(3,4,10,165,se.KILLOBJECT,4,",BC1Ob1,BC1Ob2,BC1Ob3,BC1Ob4,"),new xd(8,12,20,J.TSUN,se.BUILDTOWER,3)],Xt=Gd.create(9,20,420,1,3,"level 144",a,r,1.2,o,l.p(1*n+843*s,349*s)),r=[new Wd(1,J.LM1,8,0),new Wd(2,J.FTM,5,0),new Wd(2,J.LM1,5,0),new Wd(3,J.LM1,8,0),new Wd(3,J.FLM1,4,0),new Wd(4,J.LM2,8,0),new Wd(5,J.SBFT,4,0),new Wd(5,J.LM3,8,0),new Wd(6,J.LM3,12,0),new Wd(7,J.FLM2,12,0),new Wd(8,J.SBL1,2,0),new Wd(8,J.LM1,6,0),new Wd(8,J.FLM1,6,0),new Wd(9,J.SBFL1,4,0),new Wd(9,J.FLM2,8,0),new Wd(10,J.SBL3,12,0),new Wd(11,J.SBFT,5,0),new Wd(11,J.LM3,3,0),new Wd(11,J.FLM1,4,0),new Wd(12,J.BMT,1,0),new Wd(12,J.SBFL1,12,0),new Wd(13,J.LM41,4,0),new Wd(13,J.SBFL2,10,0),new Wd(14,J.LM42,4,0),new Wd(14,J.SBL3,10,0),new Wd(15,J.SBL1,5,0),new Wd(15,J.SBFL1,4,0),new Wd(16,J.SBL3,5,0),new Wd(16,J.LM1,10,0),new Wd(17,J.SBL3,5,0),new Wd(17,J.LM2,10,0),new Wd(18,J.LM41,4,0),new Wd(18,J.SBFL1,10,0),new Wd(19,J.LM41,4,0),new Wd(19,J.SBFL2,10,0),new Wd(20,J.LM41,4,0),new Wd(20,J.SBFL1,5,0),new Wd(21,J.LM41,4,0),new Wd(21,J.SBFL2,5,0),new Wd(22,J.SBL3,6,0),new Wd(22,J.SBFL1,10,0),new Wd(23,J.SBL2,6,0),new Wd(23,J.SBFL2,10,0),new Wd(24,J.LM45,10,0),new Wd(24,J.SBL3,10,0),new Wd(25,J.BMT,3,0),new Wd(25,J.LM41,6,0),new Wd(25,J.SBL1,10,0)],a=[J.TSHIT,J.TICEFAN,J.TMOON,J.TBLUESTAR,J.TSNOW,J.TFISH],o=[new Nd(3,5,20,135,se.KILLOBJECT,5,",SC1Ob1,SC1Ob2,SC1Ob3,BC1Ob1,BC1Ob2,"),new xd(10,23,20,J.TICEFAN,se.KILLMONSTER,-300),new xd(6,23,10,J.TSHIT,se.KILLMONSTER,-20)],jt=Gd.create(9,25,540,1,3,"level 145",a,r,1.3,o,l.p(1*n+760*s,459*s)),r=[new Wd(1,J.LM3,1,0),new Wd(1,J.LM3,1,0),new Wd(1,J.LM3,1,0),new Wd(2,J.FTM,5,0),new Wd(3,J.LM1,8,0),new Wd(4,J.LM2,9,0),new Wd(5,J.FTM,7,0),new Wd(5,J.FLM2,1,0),new Wd(6,J.FLM2,1,0),new Wd(6,J.LM1,1,0),new Wd(6,J.FLM1,1,0),new Wd(7,J.LM2,1,0),new Wd(7,J.LM2,1,0),new Wd(7,J.LM2,1,0),new Wd(8,J.FLM2,1,0),new Wd(8,J.FLM2,1,0),new Wd(8,J.FLM1,1,0),new Wd(8,J.FLM1,1,0),new Wd(9,J.LM3,1,0),new Wd(9,J.LM3,1,0),new Wd(9,J.LM3,1,0),new Wd(9,J.LM3,1,0),new Wd(9,J.LM3,1,0),new Wd(9,J.LM3,1,0),new Wd(10,J.LM1,2,0),new Wd(10,J.LM1,3,0),new Wd(10,J.FTM,2,0),new Wd(10,J.FTM,3,0),new Wd(11,J.SBL2,1,0),new Wd(11,J.LM2,5,0),new Wd(12,J.LM41,1,0),new Wd(12,J.SBL3,1,0),new Wd(13,J.SBFL1,1,0),new Wd(13,J.SBL1,1,0),new Wd(13,J.SBFL2,1,0),new Wd(14,J.FLM1,9,0),new Wd(14,J.SBFL1,1,0),new Wd(14,J.SBFL1,1,0),new Wd(15,J.FLM2,8,0),new Wd(15,J.SBFL2,1,0),new Wd(15,J.SBFL2,1,0),new Wd(16,J.FTM,15,0),new Wd(17,J.LM44,1,0),new Wd(17,J.FLM1,4,0),new Wd(17,J.FLM2,4,0),new Wd(18,J.LM2,2,0),new Wd(18,J.SBL2,4,0),new Wd(18,J.LM2,2,0),new Wd(19,J.SBL3,1,0),new Wd(19,J.SBL1,1,0),new Wd(19,J.SBL3,1,0),new Wd(19,J.SBL1,1,0),new Wd(20,J.LM42,1,0),new Wd(20,J.FTM,2,0),new Wd(20,J.LM2,2,0),new Wd(21,J.SBFL1,1,0),new Wd(21,J.SBFL1,1,0),new Wd(21,J.FLM2,5,0),new Wd(22,J.SBFL2,1,0),new Wd(22,J.SBFL2,1,0),new Wd(22,J.FLM1,5,0),new Wd(23,J.FTM,2,0),new Wd(23,J.LM43,1,0),new Wd(24,J.SBL2,1,0),new Wd(24,J.SBL3,1,0),new Wd(24,J.SBL1,1,0),new Wd(24,J.FLM1,2,0),new Wd(24,J.FLM2,2,0),new Wd(25,J.LM44,1,0),new Wd(25,J.SBFT,4,0)],a=[J.TBOTTLE,J.TFIREBOTTLE,J.TANCHOR,J.TBOOMERANG,J.TARROW,J.TMAGNET,J.TPIN,J.TBLUESTAR,J.TSTAR,J.TROCKET],o=[new Nd(4,4,10,130,se.KILLOBJECT,4,",B2Ob1,B2Ob2,B2Ob3,B2Ob4,"),new Nd(4,23,20,180,se.FINDTOWER,-13,"tshit,"),new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-70)],Kt=Gd.create(9,25,499,1,3,"level 146",a,r,.9,o,l.p(1*n+616*s,513*s)),r=[new Wd(1,1,J.LM1,3,0),new Wd(1,2,J.LM2,3,0),new Wd(2,1,J.LM3,4,0),new Wd(2,2,J.LM3,4,0),new Wd(3,1,J.FTM,3,0),new Wd(3,1,J.LM2,4,0),new Wd(3,2,J.FTM,3,0),new Wd(3,2,J.LM1,4,0),new Wd(4,1,J.FLM1,5,0),new Wd(4,2,J.FLM2,5,0),new Wd(5,1,J.SBL3,1,0),new Wd(5,1,J.SBL3,1,0),new Wd(5,2,J.SBL3,1,0),new Wd(5,2,J.SBL3,1,0),new Wd(6,1,J.SBL1,1,0),new Wd(6,2,J.SBL2,1,0),new Wd(7,1,J.LM45,1,0),new Wd(7,2,J.FLM1,1,0),new Wd(7,2,J.FLM1,1,0),new Wd(7,2,J.FLM2,1,0),new Wd(7,2,J.FLM2,1,0),new Wd(8,1,J.FLM1,2,0),new Wd(8,1,J.FTM,3,0),new Wd(8,2,J.FLM1,2,0),new Wd(8,2,J.FTM,3,0),new Wd(9,1,J.FLM1,6,0),new Wd(9,2,J.FLM1,6,0),new Wd(10,1,J.SBFT,4,0),new Wd(10,2,J.SBFT,4,0),new Wd(11,1,J.FLM2,9,0),new Wd(11,2,J.FLM2,9,0),new Wd(12,1,J.LM44,2,0),new Wd(12,2,J.LM44,2,0),new Wd(13,1,J.LM1,10,0),new Wd(13,2,J.LM1,10,0),new Wd(14,1,J.FTM,7,0),new Wd(14,1,J.SBFT,2,0),new Wd(14,1,J.SBFT,2,0),new Wd(14,2,J.FTM,7,0),new Wd(14,2,J.SBFT,2,0),new Wd(14,2,J.SBFT,2,0),new Wd(15,1,J.SBFL1,2,0),new Wd(15,1,J.SBFL2,2,0),new Wd(15,2,J.SBFL1,2,0),new Wd(15,2,J.SBFL2,2,0),new Wd(16,1,J.LM2,12,0),new Wd(16,2,J.LM2,12,0),new Wd(17,1,J.LM3,5,0),new Wd(17,1,J.LM43,1,0),new Wd(17,2,J.LM3,5,0),new Wd(17,2,J.LM43,1,0),new Wd(18,1,J.SBL3,1,0),new Wd(18,1,J.SBL2,1,0),new Wd(18,1,J.SBL1,1,0),new Wd(18,1,J.LM42,1,0),new Wd(18,2,J.SBL3,1,0),new Wd(18,2,J.SBL2,1,0),new Wd(18,2,J.SBL1,1,0),new Wd(18,2,J.LM42,1,0),new Wd(19,1,J.SBFT,3,0),new Wd(19,1,J.LM41,2,0),new Wd(19,2,J.SBFT,3,0),new Wd(19,2,J.LM41,2,0),new Wd(20,1,J.SBFL1,4,0),new Wd(20,1,J.BMT,1,0),new Wd(20,2,J.SBFL2,4,0),new Wd(20,2,J.BMT,1,0)],a=[J.TFISH,J.TPIN],o=[new Nd(4,10,20,70,se.KILLOBJECT,12,",S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,S1Ob7,S1Ob8,S1Ob9,S1Ob10,S1Ob11,S1Ob12,"),new Nd(3,25,10,90,se.EARNMONEY,-5888),new xd(9,23,10,J.TBALL,se.KILLMONSTER,-30)],qt=Gd.create(9,20,999,1,3,"level 147",a,r,.5,o,l.p(1*n+410*s,514*s)),r=[new Wd(1,J.LM2,2,8e3),new Wd(1,J.FTM,2,1e4),new Wd(2,J.LM3,3,8e3),new Wd(3,J.SBFT,1,180),new Wd(4,J.SBL1,1,200),new Wd(5,J.FLM2,2,12e3),new Wd(5,J.BM3,1,220),new Wd(5,J.FLM1,2,12500)],a=[J.TMAGNET,J.TBOOMERANG,J.TBLUESTAR,J.TPIN,J.TSUN],o=[new Nd(3,25,10,185,se.EARNMONEY,-5088),new Nd(4,23,10,80,se.FINDTOWER,-10,"tplane,"),new Nd(4,10,20,190,se.KILLOBJECT,19,"")],Qt=Gd.create(9,5,365,1,55,"level 148",a,r,1.2,o,l.p(1*n+240*s,430*s),400),r=[new Wd(1,J.LM1,8,0),new Wd(2,J.LM2,5,0),new Wd(2,J.FTM,5,0),new Wd(3,J.LM3,8,0),new Wd(4,J.FLM1,6,0),new Wd(4,J.FLM2,6,0),new Wd(5,J.LM1,8,0),new Wd(5,J.SBFT,2,0),new Wd(6,J.LM2,5,0),new Wd(6,J.LM42,1,0),new Wd(7,J.SBFL2,1,0),new Wd(7,J.FLM2,9,0),new Wd(8,J.LM2,4,0),new Wd(8,J.FLM1,6,0),new Wd(9,J.LM1,7,0),new Wd(9,J.SBFL1,2,0),new Wd(10,J.SBFT,2,0),new Wd(10,J.LM43,4,0),new Wd(11,J.SBL3,2,0),new Wd(11,J.SBL3,2,0),new Wd(11,J.SBL3,2,0),new Wd(12,J.SBL2,3,0),new Wd(12,J.FLM2,9,0),new Wd(12,J.SBL2,2,0),new Wd(13,J.LM1,10,0),new Wd(13,J.SBFL1,4,0),new Wd(14,J.FTM,10,0),new Wd(14,J.LM41,3,0),new Wd(14,J.FLM1,5,0),new Wd(15,J.LM44,6,0),new Wd(15,J.LM1,12,0),new Wd(16,J.SBL1,5,0),new Wd(16,J.LM3,7,0),new Wd(16,J.FLM2,8,0),new Wd(17,J.FTM,10,0),new Wd(17,J.LM1,8,0),new Wd(17,J.FLM1,8,0),new Wd(18,J.LM2,10,0),new Wd(18,J.LM43,5,0),new Wd(18,J.SBFT,10,0),new Wd(19,J.BMT,1,0),new Wd(19,J.BMT,1,0)],a=[J.TCUTTLE,J.TBOTTLE,J.TFIREBOTTLE,J.TPIN,J.TBALL,J.TANCHOR],o=[new Nd(4,5,10,115,se.KILLOBJECT,5,",B1Ob1,B1Ob2,B1Ob3,B1Ob4,B1Ob5,"),new Nd(3,25,10,165,se.EARNMONEY,-4e3),new Nd(4,23,20,130,se.FINDTOWER,-4,"ticefan,")],Zt=Gd.create(9,19,300,1,3,"level 149",a,r,1.2,o,l.p(1*n+48*s,337*s)),r=[new Wd(1,J.FTM,8,0),new Wd(2,J.LM3,10,0),new Wd(3,J.FLM1,8,0),new Wd(4,J.LM1,6,0),new Wd(4,J.LM2,6,0),new Wd(5,J.FLM2,10,0),new Wd(6,J.LM45,1,0),new Wd(6,J.LM45,1,0),new Wd(7,J.SBFT,3,0),new Wd(8,J.FLM1,5,0),new Wd(8,J.FLM2,5,0),new Wd(9,J.FTM,5,0),new Wd(9,J.FLM1,5,0),new Wd(10,J.SBFT,3,0),new Wd(11,J.LM3,4,0),new Wd(11,J.FLM2,8,0),new Wd(12,J.SBL1,2,0),new Wd(12,J.SBL2,2,0),new Wd(13,J.SBFL1,1,0),new Wd(13,J.SBFL2,1,0),new Wd(14,J.LM44,4,0),new Wd(15,J.LM3,7,0),new Wd(15,J.SBL3,3,0),new Wd(16,J.FTM,10,0),new Wd(17,J.SBFT,1,0),new Wd(17,J.LM45,1,0),new Wd(17,J.SBFT,2,0),new Wd(17,J.LM45,2,0),new Wd(18,J.BMT,2,0)],a=[J.TFLASHLIGHT,J.TBOOMERANG,J.TMAGNET,J.TSUN,J.TSTAR,J.TBLUESTAR,J.TICEFAN,J.TROCKET,J.TBOTTLE],o=[new Nd(4,5,10,110,se.KILLOBJECT,5,",B2Ob1,B2Ob2,B2Ob3,B2Ob4,B2Ob5,"),new Nd(4,23,20,50,se.FINDTOWER,-8,"tanchor,"),new xd(14,23,10,J.TROCKET,se.KILLMONSTER,-50)],Jt=Gd.create(9,18,100,1,3,"level 150",a,r,1.1,o,l.p(788*s,371*s),0,1,5e5),r=[new Wd(1,J.LM1,2,5),new Wd(1,J.LM2,3,5),new Wd(2,J.LM2,2,10.1),new Wd(2,J.LM3,4,10.1),new Wd(3,J.FLM1,4,12.11),new Wd(3,J.LM3,6,20.19),new Wd(4,J.FLM2,8,20),new Wd(4,J.FTM,2,35),new Wd(5,J.FTM,8,100),new Wd(5,J.FLM2,2,50),new Wd(6,J.LM1,5,150),new Wd(6,J.LM3,5,150),new Wd(7,J.FLM1,5,150),new Wd(7,J.FLM2,5,150),new Wd(8,J.LM3,5,250),new Wd(8,J.LM2,5,250),new Wd(9,J.LM3,6,395.18),new Wd(9,J.FLM1,4,237.11),new Wd(10,J.FLM1,4,304.95),new Wd(10,J.LM3,6,508.25),new Wd(10,J.SBL1,1,11),new Wd(11,J.LM3,6,587.86),new Wd(11,J.FTM,4,705.43),new Wd(12,J.FTM,2,776.74),new Wd(12,J.LM3,8,647.28),new Wd(13,J.FLM1,7,438.91),new Wd(13,J.LM2,5,731.51),new Wd(14,J.LM2,7,815.74),new Wd(14,J.LM3,7,815.74),new Wd(15,J.SBFL1,3,8),new Wd(15,J.SBFL2,3,11),new Wd(16,J.LM2,10,1177.45),new Wd(16,J.FTM,5,1412),new Wd(17,J.LM1,10,1232.84),new Wd(17,J.LM3,8,1232.84),new Wd(18,J.FTM,10,1656),new Wd(18,J.FLM2,7,828.31),new Wd(19,J.FLM1,5,860.54),new Wd(19,J.FLM2,15,861),new Wd(20,J.FLM2,6,894.77),new Wd(20,J.FLM2,6,894.77),new Wd(20,J.SBFL1,1,23),new Wd(21,J.FLM1,8,921.42),new Wd(21,J.FLM2,8,921.42),new Wd(22,J.FTM,12,1936.31),new Wd(22,J.LM1,10,1650.78),new Wd(23,J.LM2,12,1650.78),new Wd(23,J.LM3,12,1650.78),new Wd(24,J.FLM1,13,992.38),new Wd(24,J.FLM2,13,992.38),new Wd(25,J.BMT,1,14),new Wd(25,J.FTM,15,14)],a=[J.TSHIT,J.TSNOW,J.TMOON,J.TMAGNET],o=[new Nd(4,10,20,260,se.KILLOBJECT,14,",S2Ob1,S2Ob2,S2Ob3,L2Ob1,L2Ob2,L2Ob3,L2Ob4,L2Ob5,L2Ob6,L2Ob7,L2Ob8,L2Ob9,L2Ob10,L2Ob11,"),new Nd(3,25,10,180,se.EARNMONEY,-3e3),new xd(14,23,20,J.TROCKET,se.KILLMONSTER,-90)],$t=Gd.create(9,25,1,1,3,"level 151",a,r,1.4,o,l.p(615*s,466*s)),r=[new Wd(1,J.LM3,5,3),new Wd(2,J.LM1,8,10),new Wd(3,J.LM2,15,16),new Wd(4,J.FTM,15,28),new Wd(4,J.LM45,1,0),new Wd(5,J.SBFL1,3,0),new Wd(5,J.FLM1,20,31),new Wd(6,J.SBFL2,5,0),new Wd(6,J.FLM2,18,38),new Wd(6,J.SBFL2,1,0),new Wd(7,J.FTM,10,1200),new Wd(7,J.LM3,10,899),new Wd(7,J.LM2,10,899),new Wd(8,J.LM1,12,3e3),new Wd(8,J.SBL1,3,45),new Wd(8,J.LM45,3,2800),new Wd(9,J.SBL3,5,90.5),new Wd(9,J.LM3,10,3650),new Wd(9,J.FTM,10,4200),new Wd(10,J.FLM1,6,3400),new Wd(10,J.SBFL1,3,45),new Wd(10,J.FLM1,6,3300),new Wd(11,J.SBFL1,3,45),new Wd(11,J.FLM1,6,3500),new Wd(11,J.SBFL1,3,40),new Wd(12,J.FTM,10,5800),new Wd(12,J.SBFT,6,75),new Wd(12,J.FTM,10,6000.24),new Wd(12,J.SBFT,6,70.5),new Wd(13,J.BMT,1,45),new Wd(13,J.SBL3,2,95),new Wd(13,J.SBFT,2,135),new Wd(13,J.SBFL1,1,79),new Wd(13,J.SBFL2,1,80)],a=[J.TRANDOM],o=[new xd(11,23,10,J.TMOON,se.KILLMONSTER,-10),new xd(18,23,20,J.TCUTTLE,se.KILLMONSTER,-100),new Nd(4,10,10,300,se.KILLOBJECT,21,"")],ei=Gd.create(9,13,1888,1,3,"level 152",a,r,1.7,o,l.p(428*s,498*s)),r=[new Wd(1,J.LM41,1,8800),new Wd(1,J.FTM,3,12e3),new Wd(2,J.LM42,3,13300),new Wd(3,J.LM43,2,2e4),new Wd(4,J.SBFL1,2,200),new Wd(4,J.SBFL2,2,200),new Wd(5,J.BM4,1,290),new Wd(5,J.LM44,3,2e4)],a=[J.TBOTTLE,J.TBOOMERANG,J.TARROW,J.TROCKET,J.TPLANE,J.TMAGNET,J.TANCHOR,J.TPIN,J.TFISH,J.TFIREBOTTLE],o=[new Nd(3,25,10,70,se.EARNMONEY,-6e3),new xd(6,23,10,J.TSHIT,se.KILLMONSTER,-1),new xd(22,23,20,J.TBOOMERANG,se.KILLMONSTER,-10)],ti=Gd.create(9,5,300,1,50,"level 153",a,r,1.2,o,l.p(231*s,467*s),365),r=[new Wd(1,J.LM2,8,0),new Wd(2,J.LM1,10,0),new Wd(3,J.LM3,10,0),new Wd(4,J.FTM,10,0),new Wd(5,J.LM2,10,0),new Wd(5,J.FLM1,2,0),new Wd(6,J.FLM1,13,0),new Wd(7,J.LM1,10,0),new Wd(7,J.FLM2,5,0),new Wd(8,J.FLM2,9,0),new Wd(8,J.FLM1,9,0),new Wd(9,J.FTM,6,0),new Wd(9,J.SBFL2,1,0),new Wd(9,J.LM42,1,0),new Wd(9,J.FTM,6,0),new Wd(10,J.LM2,8,0),new Wd(10,J.SBL2,1,0),new Wd(10,J.SBFL1,5,0),new Wd(11,J.SBL1,1,0),new Wd(11,J.SBL2,1,0),new Wd(11,J.SBL3,1,0),new Wd(11,J.LM41,1,0),new Wd(12,J.SBFT,10,0),new Wd(12,J.LM43,3,0),new Wd(13,J.LM44,2,0),new Wd(13,J.FLM1,5,0),new Wd(14,J.LM2,5,0),new Wd(14,J.LM41,1,0),new Wd(14,J.FLM2,5,0),new Wd(15,J.FLM1,12,0),new Wd(15,J.SBFL2,3,0),new Wd(16,J.SBL1,4,0),new Wd(16,J.SBL3,4,0),new Wd(17,J.LM42,3,0),new Wd(17,J.LM43,3,0),new Wd(18,J.SBL2,3,0),new Wd(18,J.LM44,3,0),new Wd(18,J.SBFL1,5,0),new Wd(19,J.BMT,1,0),new Wd(19,J.SBFT,5,0),new Wd(20,J.LM41,2,0),new Wd(20,J.LM42,2,0),new Wd(20,J.LM43,2,0),new Wd(20,J.LM44,2,0),new Wd(21,J.LM1,5,0),new Wd(21,J.LM2,5,0),new Wd(21,J.LM3,5,0),new Wd(22,J.BMT,1,0),new Wd(22,J.SBFL1,3,0),new Wd(22,J.SBFL2,3,0)],a=[J.TFLASHLIGHT,J.TROCKET,J.TCUTTLE,J.TSUN,J.TSNOW,J.TICEFAN,J.TPLANE,J.TARROW,J.TPIN,J.TMAGNET],o=[new Nd(4,24,10,30,se.KILLOBJECT,1,",S1Ob3,"),new Nd(4,1,20,140,se.KILLOBJECT,1,",B2Ob1,"),new Nd(2,21,10,660,se.KILLOBJECT,1,",DB3Ob1,")],ii=Gd.create(9,22,666,1,3,"level 154",a,r,1.5,o,l.p(120*s,377*s),0,1,3e5),r=[new Wd(1,1,J.SBL1,1,0),new Wd(1,2,J.SBL1,1,0),new Wd(2,1,J.SBL2,1,0),new Wd(2,1,J.SBL2,1,0),new Wd(2,2,J.SBL3,1,0),new Wd(2,2,J.SBL3,1,0),new Wd(3,1,J.SBFT,1,0),new Wd(3,1,J.SBFT,1,0),new Wd(3,1,J.SBFT,1,0),new Wd(3,2,J.SBFT,1,0),new Wd(3,2,J.SBFT,1,0),new Wd(3,2,J.SBFT,1,0),new Wd(4,1,J.SBL1,1,0),new Wd(4,1,J.SBL2,1,0),new Wd(4,1,J.SBL3,1,0),new Wd(4,2,J.SBL1,1,0),new Wd(4,2,J.SBL2,1,0),new Wd(4,2,J.SBL3,1,0),new Wd(5,1,J.BMT,1,0),new Wd(5,2,J.BMT,1,0),new Wd(6,1,J.SBFL1,1,0),new Wd(6,1,J.SBFL1,1,0),new Wd(6,1,J.SBFL1,1,0),new Wd(6,2,J.SBFL2,1,0),new Wd(6,2,J.SBFL2,1,0),new Wd(6,2,J.SBFL2,1,0),new Wd(7,1,J.SBFL2,1,0),new Wd(7,1,J.SBFL2,1,0),new Wd(7,1,J.SBFL2,2,0),new Wd(7,2,J.SBFL1,1,0),new Wd(7,2,J.SBFL1,1,0),new Wd(7,2,J.SBFL1,2,0),new Wd(8,1,J.SBL1,2,0),new Wd(8,1,J.LM45,1,0),new Wd(8,2,J.SBL2,2,0),new Wd(8,2,J.LM44,1,0),new Wd(9,1,J.SBFT,2,0),new Wd(9,1,J.SBL3,2,0),new Wd(9,1,J.SBL3,2,0),new Wd(9,1,J.SBFT,2,0),new Wd(9,2,J.SBFT,2,0),new Wd(9,2,J.SBL3,2,0),new Wd(9,2,J.SBL3,2,0),new Wd(9,2,J.SBFT,2,0),new Wd(10,1,J.LM43,2,0),new Wd(10,1,J.BMT,1,0),new Wd(10,1,J.SBFL1,1,0),new Wd(10,1,J.SBFL2,1,0),new Wd(10,1,J.BMT,1,0),new Wd(10,2,J.LM43,2,0),new Wd(10,2,J.BMT,1,0),new Wd(10,2,J.SBFL1,1,0),new Wd(10,2,J.SBFL2,1,0),new Wd(10,2,J.BMT,1,0)],a=[J.TBLUESTAR,J.TSTAR,J.TMOON,J.TSUN],o=[new Nd(4,24,10,60,se.KILLOBJECT,3,",S3Ob5,S3Ob12,S3Ob17,"),new Nd(4,10,10,140,se.KILLOBJECT,34,""),new xd(22,23,20,J.TBOOMERANG,se.KILLMONSTER,-10)],ni=Gd.create(9,10,888,1,4,"level 155",a,r,1.1,o,l.p(256*s,289*s)),r=[new Wd(1,1,J.LM1,6,20),new Wd(2,2,J.LM1,7,20),new Wd(3,1,J.LM3,8,35),new Wd(3,2,J.LM2,8,45),new Wd(4,1,J.FTM,6,100),new Wd(4,2,J.FTM,8,100),new Wd(5,1,J.SBL1,2,2),new Wd(5,2,J.FLM2,9,80),new Wd(6,1,J.FTM,8,120),new Wd(6,2,J.SBFL2,2,2),new Wd(6,2,J.SBL2,4,3),new Wd(7,1,J.LM41,3,120),new Wd(7,1,J.LM3,12,230),new Wd(7,2,J.FLM2,8,150),new Wd(8,1,J.SBFL1,2,3),new Wd(8,2,J.BMT,1,3),new Wd(9,1,J.SBL1,4,8),new Wd(9,2,J.LM43,6,450),new Wd(10,1,J.LM3,10,550),new Wd(10,2,J.SBFT,3,15),new Wd(10,2,J.FLM2,8,450),new Wd(11,1,J.LM42,6,250),new Wd(11,2,J.LM42,3,400),new Wd(12,1,J.SBL2,8,14),new Wd(12,2,J.LM3,12,840),new Wd(12,2,J.FTM,3,1100),new Wd(13,1,J.SBFT,4,20),new Wd(13,2,J.SBFL1,6,7),new Wd(14,1,J.FLM2,14,700),new Wd(14,2,J.BMT,1,15),new Wd(14,2,J.LM44,4,800)],a=[J.TBOTTLE,J.TSTAR,J.TSHIT,J.TSUN],o=[new Nd(4,3,20,100,se.KILLOBJECT,3,",SC1Ob1,SC1Ob2,BC1Ob1,"),new xd(8,23,10,J.TSUN,se.KILLMONSTER,-90),new xd(6,12,10,J.TSHIT,se.BUILDTOWER,3)],si=Gd.create(10,14,1500,1,4,"level 156",a,r,.8,o,l.p(420*s,396*s)),r=[new Wd(1,1,J.LM3,5,10),new Wd(1,2,J.LM1,5,10),new Wd(2,1,J.FTM,6,30),new Wd(2,2,J.FTM,6,50),new Wd(3,1,J.SBL2,3,1),new Wd(3,2,J.LM2,6,100),new Wd(4,1,J.LM1,7,220),new Wd(4,2,J.SBFT,4,1),new Wd(5,1,J.LM2,8,310),new Wd(5,2,J.SBL2,4,1),new Wd(6,1,J.LM3,9,350),new Wd(7,1,J.FTM,7,410),new Wd(7,1,J.LM3,6,450),new Wd(7,2,J.FLM2,5,420),new Wd(8,1,J.SBL1,6,5.3),new Wd(8,2,J.LM3,8,450),new Wd(9,1,J.FLM1,6,580),new Wd(9,2,J.FTM,6,580),new Wd(10,1,J.LM42,3,610),new Wd(11,1,J.LM44,3,660),new Wd(11,1,J.FTM,6,680),new Wd(12,1,J.SBFT,6,7),new Wd(12,2,J.SBFL2,3,7),new Wd(13,1,J.SBFL2,4,8),new Wd(13,2,J.SBL1,4,8),new Wd(14,1,J.SBL2,5,9.5),new Wd(14,2,J.FLM2,6,950),new Wd(15,1,J.LM3,8,990),new Wd(15,1,J.SBL3,3,11.5),new Wd(16,1,J.BMT,2,16),new Wd(16,2,J.LM43,3,1200),new Wd(16,2,J.FLM2,6,1150)],a=[J.TSHIT,J.TSUN,J.TBALL,J.TICEFAN,J.TSTAR],o=[new xd(8,12,10,J.TSUN,se.BUILDTOWER,3),new xd(10,10,10,J.TICEFAN,se.KILLMONSTER,-60),new Nd(4,21,10,150,se.KILLOBJECT,2,",B1Ob1,B1Ob2,")],ri=Gd.create(10,16,1150,1,4,"level 157",a,r,1.5,o,l.p(526*s,301*s)),r=[new Wd(1,1,J.LM1,20,1),new Wd(1,2,J.LM2,20,1),new Wd(2,1,J.LM3,12,1),new Wd(2,2,J.LM1,12,1),new Wd(3,1,J.FLM1,6,50),new Wd(3,2,J.FTM,10,100),new Wd(3,2,J.SBFT,1,4),new Wd(4,1,J.FLM2,8,60),new Wd(4,2,J.LM2,7,160),new Wd(4,2,J.SBL2,2,2),new Wd(5,1,J.LM41,5,100),new Wd(5,2,J.SBL1,5,2),new Wd(5,2,J.FTM,4,150),new Wd(6,1,J.SBFL1,3,1),new Wd(6,1,J.FLM1,5,120),new Wd(6,2,J.SBFT,4,5),new Wd(7,1,J.FLM1,15,160),new Wd(8,1,J.BMT,1,3),new Wd(8,2,J.LM43,5,200),new Wd(9,1,J.SBFL2,8,2),new Wd(9,1,J.FLM2,4,300),new Wd(9,2,J.BMT,2,7),new Wd(10,1,J.LM42,6,500),new Wd(10,2,J.SBFL1,8,5),new Wd(11,1,J.SBFL2,8,5),new Wd(11,2,J.LM1,12,1200),new Wd(12,1,J.SBL1,6,10),new Wd(12,2,J.FTM,9,1600),new Wd(13,1,J.LM44,3,530),new Wd(13,1,J.LM45,3,600),new Wd(13,2,J.LM3,9,1400),new Wd(14,1,J.LM1,12,1400),new Wd(14,2,J.FTM,3,2e3),new Wd(15,1,J.BMT,2,13.2),new Wd(15,2,J.FLM2,3,700),new Wd(16,1,J.FTM,7,2e3),new Wd(16,1,J.FLM1,2,700),new Wd(16,2,J.BMT,1,14)],a=[J.TSHIT,J.TSTAR,J.TICEFAN],o=[new xd(6,23,20,J.TSHIT,se.KILLMONSTER,-60),new Nd(4,2,10,75,se.KILLOBJECT,2,",B1Ob3,B1Ob4,"),new xd(10,12,10,J.TICEFAN,se.BUILDTOWER,3)],ai=Gd.create(10,16,1400,1,3,"level 158",a,r,.8,o,l.p(589*s,160*s)),r=[new Wd(1,1,J.LM1,8,50),new Wd(1,2,J.LM1,8,50),new Wd(2,1,J.LM2,4,60),new Wd(2,2,J.FTM,6,60),new Wd(3,1,J.LM3,6,80),new Wd(3,2,J.SBL3,3,.8),new Wd(4,1,J.FTM,6,120),new Wd(4,2,J.FLM1,5,122),new Wd(5,1,J.LM2,6,160),new Wd(5,2,J.FLM2,4,160),new Wd(6,1,J.FTM,8,210),new Wd(6,2,J.SBFL1,2,2),new Wd(7,1,J.FTM,6,240),new Wd(7,2,J.LM3,3,300),new Wd(8,1,J.FLM2,8,320),new Wd(8,2,J.FLM2,8,370),new Wd(9,1,J.SBL1,3,4.6),new Wd(10,1,J.LM3,6,580),new Wd(10,2,J.SBFT,3,5.3),new Wd(11,1,J.LM1,6,660),new Wd(11,2,J.LM42,3,660),new Wd(12,1,J.SBL2,3,8.6),new Wd(12,720,J.LM3,8,9.2),new Wd(12,2,J.LM3,20,850),new Wd(13,1,J.SBL3,5,9),new Wd(13,2,J.SBFT,3,9.5),new Wd(14,1,J.FLM2,6,1e3),new Wd(14,2,J.BMT,1,11),new Wd(15,1,J.SBFT,5,11.5),new Wd(15,1,J.LM43,2,950),new Wd(16,1,J.BMT,2,10.5),new Wd(16,2,J.SBFL1,6,11.5)],a=[J.TBOTTLE,J.TSHIT,J.TBALL,J.TSUN],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-30),new Nd(4,21,10,90,se.KILLOBJECT,1,",BC1Ob1,"),new xd(8,23,10,J.TSUN,se.KILLMONSTER,-100)],oi=Gd.create(10,16,1100,1,3,"level 159",a,r,1.8,o,l.p(703*s,68*s)),r=[new Wd(1,1,J.LM1,12,35),new Wd(2,2,J.LM3,10,90),new Wd(3,1,J.LM1,10,130),new Wd(3,2,J.LM2,8,200),new Wd(4,1,J.FLM1,8,110),new Wd(4,2,J.FLM2,10,180),new Wd(5,1,J.LM1,6,280),new Wd(5,1,J.LM2,8,280),new Wd(5,2,J.LM1,6,280),new Wd(5,2,J.LM2,8,280),new Wd(6,1,J.SBL1,1,12),new Wd(7,2,J.SBL2,1,12),new Wd(8,1,J.LM2,8,390),new Wd(8,1,J.SBL1,4,9),new Wd(8,2,J.SBL3,4,9),new Wd(9,2,J.LM1,10,500),new Wd(9,2,J.LM2,8,580),new Wd(9,2,J.SBL3,4,11.5),new Wd(10,1,J.LM2,10,500),new Wd(10,1,J.LM3,8,580),new Wd(10,1,J.SBL2,4,11.5),new Wd(11,1,J.SBFT,1,65),new Wd(9,1,J.LM2,6,950),new Wd(11,2,J.SBL1,3,21),new Wd(9,2,J.FLM1,10,550),new Wd(12,1,J.LM41,4,1050),new Wd(12,2,J.LM42,4,650),new Wd(13,1,J.LM1,4,1350),new Wd(13,1,J.FLM1,8,1250),new Wd(13,1,J.LM2,3,28),new Wd(13,2,J.FLM2,4,1e3),new Wd(14,1,J.SBL2,3,24),new Wd(14,1,J.LM2,8,1250),new Wd(14,2,J.SBFL2,2,15),new Wd(14,2,J.LM3,8,1050),new Wd(15,1,J.SBFL1,3,25),new Wd(15,1,J.LM2,8,1250),new Wd(15,2,J.LM43,5,950),new Wd(16,1,J.SBFT,1,95),new Wd(16,1,J.FLM1,8,1350),new Wd(16,2,J.SBFT,1,95),new Wd(16,2,J.LM3,10,1350)],a=[J.TBOTTLE,J.TSTAR,J.TSHIT,J.TBALL],o=[new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-100),new Nd(4,4,10,130,se.KILLOBJECT,4,",B1Ob1,B1Ob2,B1Ob3,B1Ob4,"),new Nd(4,23,10,160,se.FINDTOWER,-17,",tstar,ticefan,tsun,tball")],hi=Gd.create(10,16,1e3,1,3,"level 160",a,r,1,o,l.p(838*s,198*s)),r=[new Wd(1,1,J.LM1,15,20),new Wd(1,2,J.LM2,15,20),new Wd(1,2,J.SBL1,4,.2),new Wd(2,1,J.LM3,12,30),new Wd(2,2,J.FTM,12,30),new Wd(2,2,J.SBFT,2,.3),new Wd(3,2,J.BMT,1,.4),new Wd(4,1,J.SBFT,4,2),new Wd(4,2,J.FTM,8,100),new Wd(5,1,J.FLM1,8,80),new Wd(5,2,J.FLM2,8,70),new Wd(6,1,J.LM3,10,100),new Wd(6,2,J.SBL3,10,1),new Wd(7,1,J.FTM,12,300),new Wd(7,2,J.FLM1,12,160),new Wd(8,1,J.SBFT,3,4),new Wd(8,2,J.SBFL1,8,3),new Wd(9,1,J.SBFL2,2,5),new Wd(9,2,J.SBL1,10,7),new Wd(10,1,J.SBL1,5,10),new Wd(10,2,J.FTM,16,1230),new Wd(11,1,J.LM41,2,370),new Wd(11,1,J.BMT,2,10),new Wd(11,2,J.LM45,2,300),new Wd(11,2,J.LM3,9,900),new Wd(12,1,J.LM42,2,480),new Wd(12,2,J.SBL3,8,12),new Wd(13,1,J.SBFL1,8,8),new Wd(13,2,J.LM2,12,1400),new Wd(14,1,J.LM3,12,1900),new Wd(14,2,J.SBFL2,8,9),new Wd(15,1,J.FTM,10,2200),new Wd(15,2,J.FLM2,10,1200),new Wd(16,1,J.SBFL1,5,13),new Wd(16,2,J.FLM1,5,1e3),new Wd(16,2,J.LM2,5,1800),new Wd(17,1,J.BMT,1,14),new Wd(17,2,J.BMT,2,13)],a=[J.TROCKET,J.TBALL,J.TMOON],o=[new Nd(4,5,20,90,se.KILLOBJECT,5,",S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,"),new Nd(4,1,10,180,se.KILLOBJECT,1,",BC1Ob1,"),new xd(9,23,10,J.TBALL,se.KILLMONSTER,-80)],li=Gd.create(10,17,600,1,3,"level 161",a,r,1.7,o,l.p(1*n+64*s,174*s)),r=[new Wd(1,1,J.LM1,10,10),new Wd(2,2,J.LM2,10,10),new Wd(3,1,J.LM1,8,30),new Wd(3,6,J.LM2,5,30),new Wd(3,2,J.LM1,8,30),new Wd(3,2,J.LM2,6,30),new Wd(4,1,J.LM3,10,30),new Wd(4,2,J.FLM1,10,30),new Wd(5,1,J.SBL1,7,1.5),new Wd(6,1,J.LM1,10,210),new Wd(6,2,J.SBL2,3,5.5),new Wd(7,1,J.FLM1,7,250),new Wd(7,2,J.FLM2,8,200),new Wd(8,1,J.FLM2,10,270),new Wd(8,2,J.LM2,10,270),new Wd(9,1,J.LM2,10,550),new Wd(9,1,J.LM3,10,550),new Wd(9,2,J.LM2,10,550),new Wd(9,2,J.LM3,10,550),new Wd(10,1,J.LM1,12,1050),new Wd(10,1,J.SBL2,3,21),new Wd(10,2,J.FLM1,12,850),new Wd(10,2,J.SBL2,2,21),new Wd(11,1,J.SBFT,1,40),new Wd(11,2,J.LM2,7,1550),new Wd(11,2,J.LM2,6,1550),new Wd(12,1,J.LM41,5,1650),new Wd(12,2,J.SBL3,3,23),new Wd(13,1,J.FLM2,8,1250),new Wd(13,1,J.LM44,5,1250),new Wd(13,2,J.LM43,5,1250),new Wd(14,2,J.SBL2,8,25),new Wd(14,1,J.LM1,5,1100),new Wd(14,1,J.SBL1,5,15),new Wd(14,2,J.LM2,6,950),new Wd(14,2,J.SBFL1,3,9),new Wd(15,1,J.LM2,12,1450),new Wd(15,1,J.SBL1,4,23),new Wd(15,2,J.LM2,12,1450),new Wd(15,2,J.SBL1,4,20),new Wd(16,1,J.BMT,1,17),new Wd(16,1,J.LM42,5,1050),new Wd(16,1,J.SBL1,4,20),new Wd(16,2,J.BMT,1,17),new Wd(16,2,J.LM42,5,1050),new Wd(16,1,J.SBL1,4,20)],a=[J.TBOTTLE,J.TBALL,J.TPLANE,J.TMOON,J.TARROW],o=[new xd(13,23,10,J.TARROW,se.KILLMONSTER,-150),new Nd(4,23,10,70,se.KILLOBJECT,18,",S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,S1Ob7,S1Ob8,S1Ob9,S1Ob10,S1Ob11,S1Ob12,S1Ob13,S1Ob14,S1Ob15,S1Ob16,S1Ob17,S1Ob18,"),new xd(11,12,10,J.TMOON,se.BUILDTOWER,3)],di=Gd.create(10,16,1100,1,3,"level 162",a,r,1.5,o,l.p(1*n+157*s,297*s)),r=[new Wd(1,1,J.LM1,10,10),new Wd(1,2,J.LM2,10,10),new Wd(2,1,J.LM3,12,40),new Wd(2,2,J.LM1,12,60),new Wd(3,1,J.LM2,10,400),new Wd(3,2,J.LM3,10,200),new Wd(4,1,J.SBL3,3,4),new Wd(4,2,J.BMT,1,5),new Wd(5,1,J.FTM,8,400),new Wd(5,2,J.FLM1,7,300),new Wd(6,1,J.SBFT,4,10),new Wd(6,2,J.FTM,8,750),new Wd(7,1,J.LM1,15,700),new Wd(7,2,J.LM2,15,600),new Wd(7,1,J.LM43,2,200),new Wd(8,1,J.SBL3,8,10),new Wd(8,2,J.SBL1,9,11),new Wd(9,1,J.FTM,9,1400),new Wd(9,2,J.FTM,9,1400),new Wd(10,1,J.SBFT,6,16),new Wd(10,2,J.SBFL1,10,9),new Wd(11,1,J.SBFL2,10,10),new Wd(11,2,J.SBL1,4,18),new Wd(12,1,J.SBL1,8,22),new Wd(12,2,J.FTM,11,1800),new Wd(13,1,J.LM43,4,800),new Wd(13,2,J.LM41,4,1e3),new Wd(13,1,J.LM42,3,1100),new Wd(13,2,J.LM44,3,800),new Wd(14,1,J.LM42,7,1200),new Wd(14,2,J.LM44,7,1100),new Wd(14,1,J.FLM1,10,1300),new Wd(14,2,J.FLM2,10,1200),new Wd(15,1,J.FLM1,5,1600),new Wd(15,2,J.LM2,12,2300),new Wd(15,1,J.FTM,10,2300),new Wd(16,1,J.LM3,7,2700),new Wd(16,1,J.LM1,4,3e3),new Wd(16,1,J.BMT,1,23),new Wd(16,2,J.SBFL2,1,24),new Wd(17,1,J.SBFL1,5,16),new Wd(17,2,J.FLM2,12,1700),new Wd(17,1,J.BMT,2,23),new Wd(17,2,J.LM44,3,1800)],a=[J.TPLANE,J.TBOTTLE],o=[new Nd(3,25,10,15,se.EARNMONEY,-1e4),new Nd(4,8,10,100,se.FINDTOWER,-8,"tshit,"),new xd(5,23,10,J.TBOTTLE,se.KILLMONSTER,-90)],ci=Gd.create(10,17,1200,1,3,"level 163",a,r,1.5,o,l.p(1*n+73*s,395*s)),r=[new Wd(1,1,J.LM3,6,55),new Wd(1,2,J.LM1,6,55),new Wd(2,1,J.LM2,7,75),new Wd(2,2,J.LM2,7,72),new Wd(3,1,J.LM1,8,112),new Wd(3,2,J.LM3,8,111),new Wd(4,1,J.FLM2,7,136),new Wd(4,2,J.FTM,5,138),new Wd(5,1,J.SBL1,4,2.7),new Wd(6,2,J.LM43,2,280),new Wd(7,1,J.LM3,6,370),new Wd(7,1,J.FLM2,4,21),new Wd(7,2,J.FLM1,6,390),new Wd(7,2,J.FTM,4,420),new Wd(8,1,J.SBL3,3,5),new Wd(8,2,J.SBFL2,3,5.3),new Wd(9,1,J.SBFL1,3,6),new Wd(9,2,J.SBL2,3,6.4),new Wd(10,1,J.SBFT,2,9),new Wd(10,2,J.SBFT,5,9),new Wd(11,1,J.SBL1,3,9.5),new Wd(11,1,J.FLM1,6,660),new Wd(11,2,J.SBL1,3,10),new Wd(11,2,J.FLM1,6,990),new Wd(12,1,J.LM41,2,1070),new Wd(12,2,J.LM41,2,1070),new Wd(13,1,J.LM3,5,1100),new Wd(13,1,J.LM43,3,1100),new Wd(13,2,J.LM44,2,1100),new Wd(13,2,J.FLM2,10,1220),new Wd(14,1,J.LM3,8,1400),new Wd(14,1,J.FLM2,10,1220),new Wd(14,2,J.FLM1,7,1350),new Wd(14,2,J.FTM,13,1500),new Wd(15,1,J.SBL3,6,16),new Wd(15,2,J.SBFL2,4,16),new Wd(16,1,J.BMT,1,17.2),new Wd(16,1,J.SBFL2,6,16.5),new Wd(16,2,J.LM43,4,2e3),new Wd(16,2,J.BMT,1,17.6)],a=[J.TSUN,J.TMOON,J.TARROW,J.TPLANE],o=[new xd(11,12,10,J.TMOON,se.BUILDTOWER,3),new xd(13,23,10,J.TARROW,se.KILLMONSTER,-100),new Nd(4,21,10,130,se.KILLOBJECT,7,",L1Ob1,L1Ob2,L1Ob3,L1Ob4,L1Ob5,L1Ob6,L1Ob7,")],ui=Gd.create(10,16,1200,1,3,"level 164",a,r,1.5,o,l.p(1*n+213*s,465*s)),r=[new Wd(1,1,J.LM1,10,30),new Wd(2,2,J.LM2,10,37),new Wd(3,1,J.LM3,10,52),new Wd(3,2,J.LM1,10,51),new Wd(4,2,J.LM1,8,395.2),new Wd(4,2,J.SBL1,1,12.9),new Wd(5,1,J.LM2,10,295),new Wd(5,1,J.SBL3,3,12.9),new Wd(6,1,J.FLM1,10,510),new Wd(6,2,J.FLM2,10,510),new Wd(7,1,J.LM1,5,600),new Wd(7,1,J.FLM1,7,600),new Wd(7,2,J.LM2,7,610),new Wd(7,2,J.FLM2,5,610),new Wd(8,1,J.SBFL1,2,19),new Wd(8,1,J.LM1,10,880),new Wd(8,2,J.SBFL2,3,15),new Wd(8,2,J.LM2,2,950),new Wd(9,1,J.LM3,12,1e3),new Wd(9,1,J.LM2,2,1e3),new Wd(9,2,J.FLM2,12,900),new Wd(9,2,J.FLM1,2,900),new Wd(10,1,J.SBFT,1,90),new Wd(10,1,J.LM3,12,1400),new Wd(10,1,J.FLM2,7,1200),new Wd(10,2,J.SBFT,1,95),new Wd(10,2,J.LM2,10,1400),new Wd(8,2,J.FLM1,8,1235),new Wd(11,1,J.LM1,12,2300),new Wd(11,1,J.LM2,7,2400),new Wd(11,1,J.SBL3,3,30),new Wd(12,2,J.FLM1,9,1600),new Wd(12,2,J.SBL3,5,35),new Wd(13,1,J.LM41,5,1750),new Wd(13,2,J.FLM1,8,1950),new Wd(13,2,J.FLM3,10,1450),new Wd(13,2,J.SBFL2,3,30),new Wd(14,1,J.SBL3,5,41),new Wd(14,1,J.FLM2,10,1700),new Wd(14,2,J.LM42,6,1700),new Wd(15,1,J.LM41,5,2001),new Wd(15,1,J.SBFL2,5,33),new Wd(15,2,J.LM43,5,1900),new Wd(15,2,J.SBFL1,5,30),new Wd(16,1,J.LM1,8,2200),new Wd(16,1,J.LM3,8,2200),new Wd(16,1,J.SBL3,4,61),new Wd(16,2,J.LM1,10,2200),new Wd(16,2,J.LM2,10,2200),new Wd(16,2,J.SBL2,4,61)],a=[J.TBOTTLE,J.TSHIT,J.TMOON,J.TSTAR,J.TPLANE],o=[new xd(15,10,10,J.TPLANE,se.BUILDTOWER,-10),new xd(7,23,10,J.TSTAR,se.KILLMONSTER,-150),new Nd(3,25,10,110,se.EARNMONEY,5e3,"")],pi=Gd.create(10,16,1100,1,3,"level 165",a,r,1,o,l.p(1*n+342*s,376*s)),r=[new Wd(1,1,J.LM1,10,170),new Wd(2,2,J.LM2,8,190),new Wd(2,2,J.FLM1,5,155),new Wd(3,1,J.FTM,5,290),new Wd(3,1,J.LM3,5,330),new Wd(3,2,J.FLM2,6,250),new Wd(4,1,J.LM1,10,330),new Wd(4,1,J.SBL2,2,10),new Wd(4,2,J.SBL2,2,10),new Wd(5,2,J.LM3,6,750),new Wd(5,2,J.FLM3,6,750),new Wd(5,2,J.FLM1,12,750),new Wd(6,1,J.SBL3,1,18),new Wd(6,1,J.LM3,5,570),new Wd(6,2,J.FLM1,6,550),new Wd(6,2,J.SBFL1,1,12.5),new Wd(7,1,J.SBFT,1,45),new Wd(7,2,J.SBFT,1,46),new Wd(8,1,J.SBL1,2,28),new Wd(8,1,J.SBL2,2,25),new Wd(8,2,J.SBFL1,2,21),new Wd(9,1,J.LM1,10,1800),new Wd(9,2,J.FLM3,6,1800),new Wd(9,2,J.LM1,10,1800),new Wd(9,2,J.FLM3,6,1800),new Wd(10,1,J.LM41,2,2130),new Wd(10,2,J.LM41,2,2730),new Wd(11,1,J.LM42,5,2220),new Wd(11,2,J.LM2,5,2450),new Wd(11,2,J.FLM1,7,2350),new Wd(12,1,J.LM44,2,2150),new Wd(12,1,J.SBL2,2,44),new Wd(12,2,J.SBFL2,2,43),new Wd(12,2,J.LM43,2,1600),new Wd(13,1,J.SBFL1,4,41),new Wd(13,2,J.LM2,10,2450),new Wd(13,2,J.SBFL2,4,47),new Wd(14,1,J.LM1,12,4300),new Wd(14,1,J.FLM3,8,3800),new Wd(14,2,J.LM1,12,4600),new Wd(14,2,J.FLM3,8,4300),new Wd(15,1,J.SBFT,1,150),new Wd(15,1,J.FLM2,10,2800),new Wd(15,2,J.SBFT,1,150),new Wd(15,2,J.LM2,8,3800),new Wd(16,1,J.LM42,3,3200),new Wd(16,2,J.SBL2,3,75),new Wd(16,2,J.FLM2,8,4100),new Wd(17,1,J.SBL2,2,40),new Wd(17,1,J.FLM1,8,3400),new Wd(17,2,J.LM1,8,5900),new Wd(18,1,J.LM1,3,3500),new Wd(18,1,J.LM3,7,5e3),new Wd(18,1,J.SBFT,1,160),new Wd(18,2,J.BMT,1,34),new Wd(18,2,J.LM2,6,2650),new Wd(18,2,J.FLM2,8,3800)],a=[J.TARROW,J.TSUN,J.TSHIT,J.TBOTTLE,J.TROCKET],o=[new Nd(4,3,10,90,se.KILLOBJECT,3,",S3Ob1,S3Ob2,S3Ob3,"),new xd(8,23,10,J.TSUN,se.KILLMONSTER,-100),new xd(6,22,10,J.TSHIT,se.BUILDTOWER,2)],mi=Gd.create(10,18,1200,1,3,"level 166",a,r,1.2,o,l.p(1*n+467*s,212*s)),r=[new Wd(1,1,J.LM43,1,20),new Wd(2,1,J.FLM1,5,46),new Wd(2,2,J.LM3,8,48),new Wd(3,1,J.LM3,5,75),new Wd(3,2,J.FTM,7,78),new Wd(4,1,J.LM2,6,140),new Wd(4,2,J.LM1,6,140),new Wd(5,1,J.LM1,5,200),new Wd(5,2,J.FLM2,5,150),new Wd(6,1,J.FLM1,6,190),new Wd(6,2,J.SBL1,5,2.1),new Wd(7,1,J.SBFT,4,2.4),new Wd(7,2,J.FLM2,6,210),new Wd(8,1,J.FTM,5,340),new Wd(8,1,J.SBL3,2,3.3),new Wd(8,2,J.FTM,5,320),new Wd(8,2,J.SBL1,2,3.1),new Wd(9,1,J.SBFL2,2,4.1),new Wd(9,2,J.LM41,2,410),new Wd(10,1,J.SBFL1,2,5.1),new Wd(10,2,J.SBFT,2,5.2),new Wd(11,1,J.FTM,6,570),new Wd(11,2,J.FLM2,12,550),new Wd(11,2,J.SBL2,3,7.1),new Wd(12,1,J.LM41,1,720),new Wd(12,1,J.LM43,2,730),new Wd(12,2,J.LM42,2,950),new Wd(12,2,J.LM44,1,1060),new Wd(13,1,J.SBL1,4,11),new Wd(13,1,J.SBL2,3,10.2),new Wd(13,2,J.SBL3,5,12),new Wd(14,1,J.SBFT,4,11.5),new Wd(14,2,J.SBFL1,3,11.2),new Wd(14,2,J.SBFL2,3,12.3),new Wd(15,1,J.BMT,1,13),new Wd(15,2,J.LM45,3,1240),new Wd(16,1,J.SBL3,6,13.5),new Wd(16,1,J.FLM2,10,1400),new Wd(16,2,J.SBFT,6,17),new Wd(16,2,J.SBFL1,6,16.5)],a=[J.TBALL,J.TICEFAN,J.TMOON,J.TBOTTLE],o=[new xd(14,6,10,J.TROCKET,se.BUILDTOWER,-6),new xd(11,11,10,J.TMOON,se.BUILDTOWER,2),new Nd(14,21,10,150,se.FINDTOWER,-6,"trocket,")],_i=Gd.create(10,16,1200,1,3,"level 167",a,r,1.5,o,l.p(1*n+578*s,95*s)),r=[new Wd(1,1,J.LM1,10,30),new Wd(2,1,J.LM2,10,30),new Wd(2,2,J.LM3,10,30),new Wd(3,1,J.FLM1,10,100),new Wd(3,2,J.FLM2,10,100),new Wd(4,1,J.LM3,7,850),new Wd(4,1,J.FLM1,8,850),new Wd(4,2,J.FTM,7,950),new Wd(4,2,J.FLM2,8,950),new Wd(5,1,J.SBL1,2,32),new Wd(5,1,J.SBL2,2,32),new Wd(5,2,J.LM3,8,1e3),new Wd(5,2,J.FLM2,7,800),new Wd(6,1,J.LM2,10,800),new Wd(6,1,J.SBFL1,3,19),new Wd(6,2,J.LM1,10,800),new Wd(6,2,J.SBFL2,3,20),new Wd(7,1,J.LM2,6,1200),new Wd(7,1,J.LM3,9,1200),new Wd(7,2,J.FLM1,8,1200),new Wd(7,2,J.FLM3,7,1200),new Wd(8,1,J.SBFT,1,60),new Wd(8,1,J.LM3,12,1200),new Wd(8,2,J.SBFT,1,60),new Wd(8,2,J.LM2,12,1200),new Wd(9,1,J.FLM1,12,1100),new Wd(9,1,J.FLM2,8,980),new Wd(9,2,J.SBFL1,3,20),new Wd(9,2,J.SBFL2,3,20),new Wd(10,1,J.LM41,4,1500),new Wd(10,2,J.LM42,5,1500),new Wd(11,1,J.LM43,5,1300),new Wd(11,1,J.LM2,7,1300),new Wd(11,2,J.SBL2,5,60),new Wd(11,2,J.LM2,9,1300),new Wd(12,1,J.LM2,8,1300),new Wd(12,1,J.FLM2,9,1100),new Wd(12,2,J.LM44,5,1300),new Wd(12,2,J.SBFL1,3,40),new Wd(13,1,J.FTM,10,1300),new Wd(13,1,J.SBL3,3,45),new Wd(13,2,J.FLM2,10,1200),new Wd(13,2,J.SBFL2,3,30),new Wd(14,1,J.FLM2,12,1100),new Wd(14,1,J.SBFL2,4,32),new Wd(14,2,J.SBFT,1,80),new Wd(14,2,J.LM1,10,1500),new Wd(15,1,J.LM41,2,1600),new Wd(15,1,J.LM42,5,1300),new Wd(15,2,J.LM45,5,1300),new Wd(15,2,J.LM44,2,1600),new Wd(16,1,J.SBFL2,5,42),new Wd(16,2,J.SBL1,3,42),new Wd(16,2,J.FLM1,8,1400),new Wd(17,1,J.LM2,10,1400),new Wd(17,1,J.FLM1,8,1400),new Wd(17,2,J.SBFL2,5,42),new Wd(18,1,J.LM41,3,1500),new Wd(18,1,J.LM2,5,1400),new Wd(18,1,J.FLM1,7,1300),new Wd(18,2,J.LM45,4,1400),new Wd(18,2,J.SBL3,2,42),new Wd(18,2,J.SBFL2,3,42)],a=[J.TBOTTLE,J.TSHIT,J.TSTAR,J.TICEFAN],o=[new xd(5,12,10,J.TBOTTLE,se.BUILDTOWER,3),new xd(15,23,10,J.TPLANE,se.KILLMONSTER,-100),new Nd(4,10,10,30,se.KILLOBJECT,27,",SC1Ob1,SC1Ob2,SC1Ob3,SC1Ob4,SC1Ob5,SC1Ob6,SC1Ob7,S2Ob1,S2Ob2,S2Ob3,S2Ob4,S2Ob5,S2Ob6,S2Ob7,S2Ob8,S2Ob9,S3Ob1,L3Ob1,L3Ob2,L3Ob3,L3Ob4,L3Ob5,L3Ob6,L3Ob7,L3Ob8,L3Ob9,L3Ob10,")],gi=Gd.create(10,18,1200,1,3,"level 168",a,r,2.5,o,l.p(1*n+705*s,185*s)),r=[new Wd(1,1,J.LM1,1,60),new Wd(2,1,J.LM3,2,60),new Wd(3,1,J.BMT,2,.5),new Wd(4,1,J.FTM,12,40),new Wd(5,1,J.SBL1,7,2),new Wd(5,2,J.LM1,10,200),new Wd(6,1,J.FLM1,6,100),new Wd(6,1,J.LM41,2,100),new Wd(6,2,J.SBFL2,7,2),new Wd(7,1,J.LM3,2,300),new Wd(7,2,J.SBFT,7,2),new Wd(8,1,J.SBL1,4,3.5),new Wd(8,2,J.FTM,12,400),new Wd(9,1,J.SBFL2,6,3),new Wd(9,2,J.FLM2,6,200),new Wd(10,1,J.FTM,6,1e3),new Wd(10,2,J.LM2,8,900),new Wd(11,1,J.LM2,12,1100),new Wd(11,2,J.LM43,7,500),new Wd(12,1,J.LM45,6,800),new Wd(12,2,J.LM41,6,800),new Wd(13,1,J.FLM1,7,700),new Wd(13,2,J.FTM,7,2500),new Wd(14,1,J.LM44,6,1e3),new Wd(14,2,J.LM3,8,3e3),new Wd(15,1,J.SBFL2,8,10),new Wd(15,2,J.BMT,5,17),new Wd(16,1,J.FLM1,8,2e3),new Wd(16,2,J.LM2,8,4e3),new Wd(17,1,J.BMT,3,20),new Wd(17,2,J.SBFT,10,20)],a=[J.TPLANE,J.TBALL,J.TMOON],o=[new Nd(4,23,10,90,se.KILLOBJECT,9,",S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,S1Ob7,S1Ob8,S1Ob9,"),new Nd(4,6,20,100,se.FINDTOWER,-6,"ticefan,"),new xd(11,12,10,J.TMOON,se.BUILDTOWER,3)],Ti=Gd.create(10,17,1020,1,3,"level 169",a,r,1.5,o,l.p(1*n+817*s,306*s)),r=[new Wd(1,1,J.LM1,8,50),new Wd(1,2,J.LM2,6,25),new Wd(2,1,J.SBL1,2,1),new Wd(2,2,J.LM3,6,66),new Wd(3,1,J.FLM2,6,160),new Wd(3,2,J.LM1,6,160),new Wd(4,1,J.FLM1,8,225),new Wd(4,2,J.FTM,5,260),new Wd(5,1,J.LM3,20,310),new Wd(5,2,J.SBL2,2,2),new Wd(6,1,J.LM41,3,410),new Wd(6,2,J.FTM,6,400),new Wd(7,1,J.LM3,8,560),new Wd(7,1,J.SBFL1,3,4),new Wd(7,2,J.SBFT,2,5),new Wd(8,1,J.SBL3,4,6.1),new Wd(8,2,J.FLM2,6,530),new Wd(9,1,J.FTM,11,700),new Wd(9,2,J.FLM1,6,580),new Wd(10,1,J.LM41,3,860),new Wd(10,2,J.LM42,1,720),new Wd(11,1,J.SBL3,8,10),new Wd(12,1,J.SBFT,6,12.1),new Wd(12,2,J.SBFL1,1,12),new Wd(13,1,J.FLM2,7,1600),new Wd(13,1,J.SBL2,4,14.2),new Wd(13,2,J.SBL2,4,14),new Wd(14,1,J.BMT,1,16),new Wd(14,2,J.LM3,20,1550),new Wd(15,1,J.SBFL2,6,19),new Wd(15,2,J.SBFT,2,17),new Wd(16,1,J.LM45,2,1970),new Wd(16,2,J.FTM,11,1890),new Wd(17,1,J.SBL3,5,23),new Wd(17,1,J.LM43,3,2200),new Wd(17,2,J.SBL1,4,20),new Wd(17,2,J.LM45,1,1820),new Wd(18,1,J.BMT,2,19),new Wd(18,1,J.LM43,6,2200),new Wd(18,2,J.SBFL1,3,16.5),new Wd(18,2,J.BM1,1,17.5)],a=[J.TSHIT,J.TPLANE,J.TROCKET,J.TMOON,J.TBALL],o=[new xd(11,11,20,J.TMOON,se.BUILDTOWER,2),new Nd(4,21,20,155,se.KILLOBJECT,14,",S1Ob1,S1Ob2,S1Ob3,S1Ob4,S1Ob5,S1Ob6,S1Ob7,S1Ob8,S1Ob9,S1Ob10,S1Ob11,S1Ob12,S1Ob13,S1Ob14,"),new xd(6,7,20,J.TSHIT,se.KILLMONSTER,-7)],fi=Gd.create(10,18,1300,1,3,"level 170",a,r,1.2,o,l.p(1*n+945*s,346*s)),this.allLevels=[h,d,c,u,p,m,_,g,T,f,S,w,v,L,M,C,y,B,F,E,P,b,A,O,I,R,D,x,N,G,W,k,U,H,V,z,Y,X,j,K,q,Q,Z,$,ee,te,ie,ne,re,ae,oe,he,le,de,ce,ue,pe,me,_e,ge,Te,fe,Se,we,ve,Le,Me,Ce,ye,Be,Fe,Ee,Pe,be,Ae,Oe,Ie,Re,De,xe,Ne,Ge,We,ke,Ue,He,Ve,ze,Ye,Xe,je,Ke,qe,Qe,Ze,Je,$e,et,tt,it,nt,st,rt,at,ot,ht,lt,dt,ct,ut,pt,mt,_t,gt,Tt,ft,St,wt,vt,Lt,Mt,Ct,yt,Bt,Ft,Et,Pt,bt,At,Ot,It,Rt,Dt,xt,Nt,Gt,Wt,kt,Ut,Ht,Vt,zt,Yt,Xt,jt,Kt,qt,Qt,Zt,Jt,$t,ei,ti,ii,ni],this.allLevels.push(si,ri,ai,oi,hi,li,di,ci,ui,pi,mi,_i,gi,Ti,fi),this}}),Dd=l.Class.extend({nImgIndex:0,nMissionNum:0,dataType:se.UNKNOWDATATYPE,nGoldCoins:0,nCount:356,nFinishCount:356,ctor:function(e,t,i,n,s){arguments.length>1?(s=s||0,n=n||0,this.nImgIndex=e||0,this.nMissionNum=t||0,this.dataType=i||se.UNKNOWDATATYPE,this.nGoldCoins=n+678,s<0?(this.nCount=s-356,this.nFinishCount=-356):(this.nCount=s+356,this.nFinishCount=356)):e instanceof Dd&&(this.nImgIndex=e.nImgIndex,this.nMissionNum=e.nMissionNum,this.dataType=e.dataType,this.nGoldCoins=e.nGoldCoins,this.nCount=e.nCount,this.nFinishCount=e.nFinishCount)},copyWithZone:function(e){return new Dd(this)},getFinishCount:function(){var e=this.nFinishCount;return this.nCount<0?e+=356:e-=356,e},getTaskCount:function(){var e=this.nCount;return e<0?e=-(e+=356):e-=356,e},getcount:function(){var e=this.nCount;return e<0?e+=356:e-=356,e},getGoldCoins:function(){return this.nGoldCoins-678},isEqual:function(){return this.nCount==this.nFinishCount},isFullCount:function(){return Math.abs(parseInt(this.nCount))<=Math.abs(parseInt(this.nFinishCount))},isLessMore:function(){return this.nCount>0},isFinished:function(){var e=!0;return(this.nFinishCount<-1||this.nFinishCount>1)&&(e=!1),e},isSuccessful:function(){return 1==this.nFinishCount},addFinishCount:function(e){this.nFinishCount<0?this.nFinishCount-=e:this.nFinishCount+=e},actionDone:function(e){e=void 0===e||e,this.nFinishCount=e?1:0},clearFinishCount:function(){this.nCount<0?this.nFinishCount=-356:this.nFinishCount=356}}),xd=Dd.extend({isWhatTower:J.UNKNOW,isWhat:J.UNKNOW,ctor:function(e,t,i,n,s,r,a){0===arguments.length?this._super():e instanceof xd?(this._super(e),void 0!==e.isWhatTower&&(this.isWhatTower=e.isWhatTower),void 0!==e.itiswhat&&(this.isWhat=e.itiswhat)):(this._super(e,t,s,i,r),void 0!==n&&(this.isWhatTower=n),void 0!==a&&(this.isWhat=a))},copyWithZone:function(e){return new xd(this)}}),Nd=Dd.extend({beActionName:null,actionTime:0,ctor:function(e,t,i,n,s,r,a){0===arguments.length?this._super():e instanceof Nd?(this._super(e),void 0!==e.actionTime&&(this.actionTime=e.actionTime),this.beActionName=void 0!==e.beActionName?e.beActionName:null):(this._super(e,t,s,i,r),void 0!==n&&(this.actionTime=n+890),this.beActionName=void 0!==a?a:null)},copyWithZone:function(e){return new Nd(this)},getActionTime:function(){return this.actionTime-890}}),Gd=l.Class.extend({nWaves:0,nMoney:0,nMonsterSpan:0,nEveryListSpan:0,nBossModeSecond:0,strLevelName:null,towerType:null,wavesList:null,fObjectHP:1,tasks:null,ptLevelNum:0,ctor:function(e,t,i,n,s,r,a,o,h,l,d,c,u,p){arguments.length>0&&(void 0!==e&&(10==e&&(e=1),this.nTheme=e),void 0!==t&&(this.nWaves=t),void 0!==i&&(this.nMoney=i),void 0!==n&&(this.nMonsterSpan=n),void 0!==s&&(this.nEveryListSpan=s),void 0!==c&&(this.nBossModeSecond=c),void 0!==d&&(this.ptLevelNum=d),void 0!==r&&(this.strLevelName=r),void 0!==a&&(this.towerType=a),void 0!==o&&(this.wavesList=o),void 0!==h&&(this.fObjectHP=h),void 0!==l&&(this.tasks=l),void 0!==u&&(this.bPresentGate=u),void 0!==p&&(this.nStart01HP=p))}});Gd.create=function(e,t,i,n,s,r,a,o,h,l,d,c,u,p){return new Gd(e,t,i,n,s,r,a,o,h,l,d,c,u,p)};var Wd=l.Class.extend({nWave:0,nPathNum:1,nMonsterType:J.UNKNOW,nMonsterCount:0,fHPIncreasePercent:1,ctor:function(e,t,i,n,s){arguments.length>0&&(e instanceof Wd?(this.nWave=e.nWave,this.nPathNum=e.nPathNum,this.nMonsterCount=e.nMonsterCount,this.nMonsterType=e.nMonsterType,this.fHPIncreasePercent=e.fHPIncreasePercent):(void 0!==e&&(this.nWave=e),5==arguments.length?(this.nPathNum=t||1,void 0!==i&&(this.nMonsterType=i),void 0!==n&&(this.nMonsterCount=n),void 0!==s&&(this.fHPIncreasePercent=s)):(void 0!==t&&(this.nMonsterType=t),void 0!==i&&(this.nMonsterCount=i),void 0!==n&&(this.fHPIncreasePercent=n))))}}),kd={MENU_HOME:100,MENU_SHOP:101,MENU_TIME:102,MENU_CUP:103,MENU_CLOSE:104,MENU_RATE:105,MENU_ROULETTE:106,MENU_DISCOUNT:107,MENU_SHARE:108,MENU_KT_SHARE:109,MENU_AQIU_TIP:110},Ud=function(e,t){var i;switch(t){case 1:i=e<1e3?"dl1k-":e<5e3?"dl1k-5k":e<1e4?"dl1w-2w":e<2e4?"dl1w-2w":e<3e4?"dl2w-3w":"dl3w+";break;case 2:i=0===e?"gm0":e<=200?"gm0-200":e<=600?"gm200-600":e<=2e3?"gm600-2k":e<=6e3?"gm2k-6k":"gm6k+";break;case 3:i=e<1e3?"xh1k-":e<5e3?"xh1k-5k":e<1e4?"xh5k-1w":e<2e4?"xh1w-2w":e<3e4?"xh2w-3w":"xh3w+";break;case 4:i=e<100?"sy100-":e<500?"sy100-500":e<1e3?"sy500-1k":e<2e3?"sy1k-2k":e<3e3?"sy2k-3k":"sy3k+"}return i},Hd=function(e,t){var i;switch(t){case 1:i=e<10?"dl10-":e<50?"dl10-50":e<100?"dl50-100":e<200?"dl100-200":e<300?"dl200-300":"dl300+";break;case 2:i=0===e?"gm0":e<=10?"gm0-10":e<=20?"gm10-20":"gm20+";break;case 3:i=e<10?"xh10-":e<50?"xh10-50":e<100?"xh50-100":e<200?"xh100-200":e<300?"xh200-300":"xh300+";break;case 4:i=e<1?"sy0":e<5?"sy0-5":e<10?"sy5-10":e<20?"sy10-20":e<3e3?"sy20-30":"sy30+"}return i},Vd=l.Menu.extend({ctor:function(e){this._super(e)},_onTouchBegan:function(e,t){var i=t.getCurrentTarget(),n=wr.getModel();if(i._state!=l.MENU_STATE_WAITING||!i.isVisible()||n.bLockMenu)return!1;for(var s=i.getParent();null!=s;s=s.getParent())if(!1===s.isVisible())return!1;return i._selectedItem=i._itemForTouch(e),!!i._selectedItem&&(i._state=l.MENU_STATE_TRACKING_TOUCH,i._selectedItem.selected(),!0)}});Vd.createWithArray=function(e){return new Vd(e)};var zd={MOVETO_LEFT:0,MOVETO_RIGHT:1,MOVETO_UP:2,MOVETO_DOWN:3},Yd=Xs.extend({mDis:0,mFrom:0,mTo:0,mTimes:0,spriteRoute:null,mMoveDirection:0,spriteSelectItem:null,nStarCount:0,spRightMenu:null,spTime:null,m_spTips:null,mCloudLayer:null,GM:0,_GS:0,RM:0,RS:0,RouletteState:0,LifeForeverPCut:0,m_dlg:null,spHeadBG:null,bLeft:!1,bRight:!1,DisGM:0,DisGS:0,bCanShowAD:!0,mBgLayer:null,buildItems:null,spriteItems:null,spriteItemsRouteMap:null,_listener1:null,_listener2:null,listener:null,m_loadingBg:null,spStarcounter:null,labelRouletteSecond:null,labelRouletteMinute:null,mSuperPackageRedPoint:null,mMoveLength:0,btnTag:0,dotSpr:null,luoboHonor:null,isShowLevelInfo:!1,friends:null,mapCount:0,usePartRes:!1,shownoi:!1,shareLayer:null,_rewardSpr:null,_cupList:null,ctor:function(){this._super(),this.addLayerName("scene-map")},init:function(){this._super();var e=wr.getModel();if(this.usePartRes=Yd.isUsePartRes(),lp&&SDKInterface.logEvent&&SDKInterface.logEvent("enterMap"),e.selLayer=this,e.m_nGameMode=ge.NORMALMODE,this.mBgLayer=new l.Layer,this.addChild(this.mBgLayer),this.usePartRes?(this.spriteItems=new l.SpriteBatchNode("res/Themes/LevelSelect/LevelSel01_part1.png"),this.buildItems=this.spriteItems,this.spriteItemsRouteMap=new l.SpriteBatchNode("res/Themes/LevelSelect/routemap_part1.png")):(this.buildItems=new l.SpriteBatchNode("res/Themes/LevelSelect/LevelSel01-hd.png"),this.spriteItems=new l.SpriteBatchNode(String.formatC("res/Themes%s/LevelSelect/LevelSel01-hd%s.png",e.usersData.m_nLanguage,e.usersData.m_nLanguage)),this.spriteItemsRouteMap=new l.SpriteBatchNode("res/Themes/LevelSelect/routemap1-hd.png")),this.mBgLayer.addChild(this.spriteItemsRouteMap,100),this.usePartRes||this.mBgLayer.addChild(this.buildItems,102),this.mBgLayer.addChild(this.spriteItems,103),e.bShowStarsInLevelSel)this.bCanShowAD=!1,this.showLoadingStars(),e.bShowStarsInLevelSel=!1;else if(l.director.getScheduler().isWaite=!1,dp||this.addCloudLayer(),this.registerWithTouchDispatcher(!0),e.usersData.bShowLogin||!e.bBackMainScene||e.bTodayShowSina)e.usersData.bhadLogin||0==(t=0)&&Tt.onReward("weibo-login-levelsel",1);else{e.bTodayShowSina=!0;var t=0;if(e.usersData.runsTick%10==0&&0!=t){var i=Al.create();this.addChild(i,77777)}}var n=this;return this._listener1=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"msgShowFreeStone",callback:function(e){n.getMessage()}}),l.eventManager.addListener(this._listener1,1),!0},loadData:function(e){if(dp)if("function"==typeof e){var t=this;if((n=wr.getModel()).m_nGameMode!=ge.NORMALMODE)return;var i=n.usersData.loginFromMain?1:0;n.usersData.loginFromMain=!1,Ql.entertheme({type:Le.NORMALMODE,mainenter:i},function(i,n){n?ju.Retry(n,function(){t.loadData(e)}):(t.loadResourcesEx(),t.loadServerData(i),e())})}else this.loadResourcesEx(),this.loadServerData(e);else{var n=wr.getModel();this.LoadLastRes(n.usersData.getOpenedLevel(),e)}},LoadLastRes:function(e,t){var i=[];e>=60&&(i=[Ki("res/Themes/LevelSelect/basemap2-hd.plist"),Ki("res/Themes/LevelSelect/basemap2-hd.png")]);var n=this;qu.loadResAsync(i,function(){n.loadResourcesEx(),t&&t()})},loadServerData:function(e){if(void 0!==e){var t=wr.getModel(),i=t.usersData;if(t.stageType=Le.NORMALMODE,this.nStarCount=e.star,t.setThemes(e.cfg),i.setStarCount(this.nStarCount),i.setWaitTime(e.laststartime),i.openmaxstage=e.openmaxstage?e.openmaxstage:135,i.setOpenLevel(e.openedlevel,!1),this.luoboHonor=e.luobos,i.resurgencediamondddu=e.resurgencediamond,e.buystar&&e.buystar instanceof Array&&(i.setConsumePropPriceById(1002,e.buystar[0]),i.setConsumePropPriceById(1003,e.buystar[1])),i.openPropsByOpenLv(),this.isUnlockNextlevel(),t.m_nGameMode!=ge.HIGHERMODE){this.showCheckPoint(this.luoboHonor),i.setGoldCount(0);var n=i.getGoldCount();e.glb&&i.setGoldCount(e.glb-n),i.setHonorCount(0),n=i.getTaskHonorCount(),e.zsj&&i.setHonorCount(e.zsj-n),this.addBGLayer(),this.addMenuLayer(),this.addCloudLayer(),this.showAQ(),this.showManor(),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&i.isShowPromptingShare&&this.showPromptingShare();var s=this;lp&&SDKInterface.getFriendList(50,function(e){s.sendFriendsList(e)}),t.playMuiscWithType($.MTSTARTBGMSC,1,!0),l.addTimePoint("level end"),l.printTimePoint("level start","level end")}}},showPromptingShare:function(){var e=this;qu.loadResAsync(Yi,function(){var t=e.mBgLayer.x>-100?0:1,i=e.mBgLayer.x>-100?0:e.width;e.shareLayer=sp.create(),e.addChild(e.shareLayer,99),e.shareLayer.setAnchorPoint(t,0),i=i?i+e.shareLayer.width:i-e.shareLayer.width,e.shareLayer.setPosition(i,100),e.shareLayer.show(),e.shareLayer.closeBack=function(){e.shareLayer=null}})},sendFriendsList:function(e){var t=this;if(dp){t.friends=e;var i=[];for(var n in e)i.push(e[n].id);Ql.cgetfriendsinfo(Le.NORMALMODE,i,function(e){t.loadFriendsData(e.friends)})}},loadFriendsData:function(e){if(void 0!=e){var t=[],i=GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook?"":100;for(var n in e){var s=e[n];for(var r in this.friends){var a=this.friends[r];if(a.id!==l.playerInfo.openid){if(a.id===s.openid){s.photo=a.photo+i,s.name=a.name;break}}else s.photo=l.playerInfo.photo,s.name=l.playerInfo.name}s.stage<136&&t.push(s)}this.friends=t,this.addFriendsLayer()}},isUnlockNextlevel:function(){var e=wr.getModel(),t=e.usersData.getOpenedLevel();for(var i in this.luoboHonor){var n=this.luoboHonor[i],s=n[0],r=n[1];if(s==t&&r>0&&t<e.usersData.openmaxstage){e.usersData.setOpenLevel(t+1);break}}},showCheckPoint:function(e){if(void 0!=e&&e.length)for(var t=wr.getModel().usersData,i=0;i<e.length;i++){var n=e[i],s=n[0],r=n[1],a=n[2],o=n[3];t.setLevelFirstHonor(s,r,0),a&&(t.setLevelFinishTask(s,1,0),t.setLevelFinishTask(s,2,0),t.setLevelFinishTask(s,3,0)),o&&t.setLevelClearHonor(s)}},loadCountDown:function(){this.spTime=this.menuItemWithFile("#stagemap_toolbar_timer_normal.png",kd.MENU_TIME,l.p(146,26),"#stagemap_toolbar_timer_pressed.png");var e=Vd.createWithArray([this.spTime]);e.setPosition(0,0),e.setAnchorPoint(0,0),this.spRightMenu.addChild(e,-2,6),this.lableMinute=new l.LabelAtlas(String.formatC("%02lu",this.GM),"num_white_18.png",18,30,"./0123456789"),this.lableMinute&&(this.lableMinute.setAnchorPoint(0,0),this.lableMinute.setPosition(30,42),this.spTime.addChild(this.lableMinute),this.lableSecond=new l.LabelAtlas(String.formatC("%02lu",this._GS),"num_white_18.png",18,30,"./0123456789"),this.lableSecond&&(this.lableSecond.setAnchorPoint(0,0),this.lableSecond.setPosition(76,42),this.spTime.addChild(this.lableSecond)))},showAD:function(){if(this.bCanShowAD){var e=wr.getModel();e.bBackMainScene&&!e.usersData.noAD()&&(e.bBackMainScene=!1)}},onEnterTransitionDidFinish:function(){this._super();var e=wr.getModel(),t=e.usersData;e.m_nGameMode!=ge.HIGHERMODE&&(void 0==t._awardrecord?Ql.gethomerecord(function(t){var i=t.awardrecords;e.usersData.setawardrecord(i),e.usersData.setfirstrecord(t.firstrecords),t.isopendaydayup&&(e.mIsUnlockedDayDayUp=t.isopendaydayup),kl.unLockTheme()}):kl.unLockTheme()),this.showAD()},showRateDlg:function(){wr.getModel().bLockMenu=!0,qu.addRes(this,"res/Themes/Items/pingfen-hd.plist");var e=nr.share().getWinSize(),t=new l.LayerColor(l.color(0,0,0,178),e.width,e.height);this.addChild(t,256,256);var i=new l.Sprite("#news_bg.png");i.setPosition(nr.share().getMapOffset().width+460,312),t.addChild(i);var n=null,s=new l.Sprite("#rate.jpg");(n=new l.MenuItemSprite(s,null,null,this,this.menuCallback.bind(this))).setTag(kd.MENU_RATE);var r=l.p(.536*i.width,.534*i.height);n.setPosition(r);var a=new l.Menu(n);a.setPosition(0,0),i.addChild(a);var o=this.menuItemWithFile("#news_close.png",kd.MENU_CLOSE,l.p(nr.share().getMapOffset().width+840,488)),h=new l.Menu(o);h.setPosition(0,0),t.addChild(h,10)},msgRateCallFun:function(e,t){var i=wr.getModel(),n=i.usersData;0==t?i.usersData.goCommented=i.getCurSystemTime():n.getOpenedLevel()>=20?n.goCommented=2:n.getOpenedLevel()>=10&&(n.goCommented=1)},loadResourcesEx:function(){wr.getModel();var e=Yd.getUsedRes();for(var t in e){var i=e[t];".plist"===l.path.extname(i)&&qu.addRes(this,i)}},showLoadingStars:function(){var e=nr.share().getWinSize();this.m_loadingBg=new l.Sprite("#loading_bg.png"),this.addChild(this.m_loadingBg),this.m_loadingBg.setPosition(.5*e.width,.5*e.height),this.m_loadingBg.setOpacity(0),this.m_loadingBg.setScale(2);for(var t=wr.getModel(),i=t.m_nGameMode==ge.HIGHERMODE?t.m_oHigher.getGameStars():t.usersData.getGameStars(),n=l.spriteFrameCache.getSpriteFrame("loading_star.png"),s=l.spriteFrameCache.getSpriteFrame("loading_star_back.png"),r=387,a=r,o=0;o<5;o++){var h=new l.Sprite(s);if(h.setPosition(r,380),this.m_loadingBg.addChild(h),i>o){var d=new l.Sprite(n);d.setPosition(r,380),d.setScale(.5),this.m_loadingBg.addChild(d),a=r+81}r+=81}var c=new l.Sprite(n);c.setPosition(a,380),c.setScale(.5),this.m_loadingBg.addChild(c),this.m_loadingBg.runAction(l.spawn(l.scaleTo(.2,1),l.fadeOut(.2,255)));var u=l.callFunc(this.lostLoadingUpdate.bind(this,c));c.runAction(l.sequence(l.delayTime(1),l.spawn(l.moveTo(.6,e.width/2,e.height/2),l.sequence(l.spawn(l.flipX(!0),l.scaleTo(.1,.15,1.5)),l.spawn(l.flipX(!1),l.scaleTo(.5,11.5)))),u,l.hide())),this.loadResourcesEx()},lostLoadingStarcount:function(){var e=wr.getModel().usersData.getStarCount();this.spStarcounter||(this.spStarcounter=new l.Sprite("#loading_star_counter.png"),this.m_loadingBg.addChild(this.spStarcounter),this.spStarcounter.setPosition(559,250),this.spStarcounter.setTag(798));var t=this.spStarcounter.getChildByTag(11);t&&this.spStarcounter.removeChild(t,!0);var i=this.spStarcounter.getChildByTag(5879);if(null==i){i=new l.LabelAtlas(e,"num_white_18.png",18,30,"./0123456789");var n=l.p(115,36);e>99&&(i.setScale(.8),n=l.p(115,38)),i.setPosition(n),this.spStarcounter.addChild(i,0,11)}i.setVisible(!0),e>=5?this.spStarcounter.setVisible(!0):this.spStarcounter.setVisible(!1)},lostLoadingUpdate:function(){this.removeChild(this.m_loadingBg,!0),l.director.getScheduler().isWaite=!1,this.addBGLayer(),this.addMenuLayer(),this.addFriendsLayer(),this.addCloudLayer(),this.registerWithTouchDispatcher(!0);var e=wr.getModel();if(e.playMuiscWithType($.MTSTARTBGMSC,1,!0),!e.usersData.bShowLogin&&e.bBackMainScene&&!e.bTodayShowSina){e.bTodayShowSina=!0;if(e.usersData.runsTick,!1){var t=Al.create();this.addChild(t,77777)}}this.bCanShowAD=!0,this.showAD()},showManor:function(){var e=wr.getModel(),t=e.usersData;if(t.showCastleAnimation()){e.playSoundWithType($.MTTEMPLEUPTREE),t.bShowedTempleEntranceAnimate=!0,e.usersData.xOffsetLevelSel=2*he+988,(m=new l.Sprite("stageani_temple_cover.png")).setPosition(2*he+958,424),this.buildItems.addChild(m,4,1526);var i=l.callFunc(this.Stageani2Animate1.bind(this)),n=l.scaleTo(.08,1.1),s=l.moveBy(.08,0,10),r=l.spawn(n,s),a=l.scaleTo(.16,0),o=l.moveBy(.16,0,-50),h=l.spawn(a,o);m.runAction(l.sequence(r,h,l.hide(),l.delayTime(.4),i))}else if(t.showCastleLevel()){var d=new l.Sprite("#stageani_2_temple_shadow.png");d.setPosition(2*he+995,402),this.buildItems.addChild(d,4);var c=new l.Sprite("#stageani_2_temple.png");c.setPosition(2*he+957,410),this.buildItems.addChild(c,4,1524);var u=new l.Sprite("#stageani_2_temple_shine.png");u.setPosition(c.width/2,c.height/2),u.setOpacity(0),c.addChild(u),u.runAction(l.repeatForever(l.sequence(l.fadeIn(1),l.fadeOut(2),l.delayTime(1))));var p=new l.Sprite("map_themetag_manor.png");p.setPosition(2*he+952,334),this.spriteItems.addChild(p,100),e.playMuiscWithType($.MTSTARTBGMSC,1,!0)}else{var m=new l.Sprite("stageani_temple_cover.png");m.setPosition(2*he+958,424),this.buildItems.addChild(m,4,1526)}},showAQ:function(){var e=wr.getModel(),t=e.usersData;if(t.showAQiuAnimation())e.usersData.mIsShowedAQiuTipsAnimation||this.showMeetAqiuTipAnimation(),e.playSoundWithType($.MTTEMPLEUPTREE),e.usersData.bShowedAQiuEntranceAnimate=!0,this.showAQiuEntranAnimation();else if(t.showAQiuLevel()){var i=new l.Sprite("stageani_aqo.png");i.setPosition(he+367,377),this.buildItems.addChild(i,100,1625);var n=new l.Sprite("stageani_aqo_shine.png");n.setPosition(150,150),n.setOpacity(100),i.addChild(n);var s=l.fadeTo(2,255),r=l.fadeTo(2,100);n.runAction(l.repeatForever(l.sequence(s,r)));var a=new l.Sprite("map_themetag_meetaqo.png");a.setPosition(he+349,304),this.spriteItems.addChild(a,100),e.playMuiscWithType($.MTSTARTBGMSC,1,!0),e.usersData.mIsShowedAQiuTipsAnimation||this.showMeetAqiuTipAnimation()}else{var o=new l.Sprite("stageani_aqo_cover.png");o.setPosition(he+372,388),this.buildItems.addChild(o,100,1626)}},getOpenMapCount:function(){var e=wr.getModel(),t=parseInt(e.usersData.openmaxstage/10)+1;return e.usersData.openmaxstage>100&&t++,t<=1&&(t=2),t},addBGLayer:function(){var e=wr.getModel(),t=e.usersData,i=nr.share().getWinSize(),n=this.getOpenMapCount();this._cupList=[];for(var s=1;s<=O.MAINTHEMEMAPCOUNT&&!(this.usePartRes&&s>2||s>n);s++){this.mapCount=s;var r;switch(r=1===s?String.formatC("stagemap_%d-%d.png",s,10*s):String.formatC("stagemap_%d1-%d.png",s-1,10*s),(A=new l.Sprite(r)).setAnchorPoint(0,0),A.setPosition((s-1)*he,0),this.mBgLayer.addChild(A,1),s){case 1:(y=new l.Sprite("stageani_1_1.png")).setPosition((s-1)*he+520,486),this.buildItems.addChild(y);for(var a=[],o=1;o<6;o++){var h=l.spriteFrameCache.getSpriteFrame(String.formatC("stageani_1_%d.png",o));a.push(h)}a.push(l.spriteFrameCache.getSpriteFrame("stageani_1_5.png")),(g=new l.Animation(a,.2)).setRestoreOriginalFrame(!0);T=l.sequence(l.delayTime(3),l.animate(g));if(y.runAction(l.repeatForever(T)),L=t.getThemeHonor(1)){var d=1==L?"#themeaward_cup.png":3==L?"#themeaward_cup_clear.png":5==L?"#themeaward_cup_mission.png":"#themeaward_cup_clearandmission.png";(M=new l.Sprite(d)).setPosition((s-1)*he+728,285),this.spriteItems.addChild(M,100),this._cupList.push(M),(C=new l.Sprite("#themeaward_cover_1.png")).setPosition((s-1)*he+710,255),this.buildItems.addChild(C,100,1801)}break;case 2:dp||this.showAQ(),(L=t.getThemeHonor(2))&&((M=new l.Sprite(1==L?"#themeaward_cup.png":3==L?"#themeaward_cup_clear.png":5==L?"#themeaward_cup_mission.png":"#themeaward_cup_clearandmission.png")).setPosition((s-1)*he+937,389),this.spriteItems.addChild(M,100),this._cupList.push(M),(C=new l.Sprite("#themeaward_cover_2.png")).setPosition((s-1)*he+940,384),this.buildItems.addChild(C,100,1802));break;case 3:(f=new l.Sprite("stageani_2_windmills.png")).setPosition((s-1)*he+385,295),this.buildItems.addChild(f),(S=new l.Sprite("stageani_2_windmills_wheel.png")).setPosition(f.width/2,f.height/2),f.addChild(S),S.runAction(l.repeatForever(l.rotateBy(5,360))),e.playMuiscWithType($.MTSTARTBGMSC,1,!0),dp||this.showManor();break;case 4:(S=new l.Sprite("#stageani_3_4.png")).setPosition((s-1)*he+309,550),this.buildItems.addChild(S);T=l.sequence(l.moveTo(2,(s-1)*he+309,540),l.moveTo(2,(s-1)*he+309,550));S.runAction(l.repeatForever(T)),(f=new l.Sprite("#stageani_3_3.png")).setPosition((s-1)*he+309,550),this.buildItems.addChild(f),(L=t.getThemeHonor(3))&&((M=new l.Sprite(1==L?"#themeaward_cup.png":3==L?"#themeaward_cup_clear.png":5==L?"#themeaward_cup_mission.png":"#themeaward_cup_clearandmission.png")).setPosition((s-1)*he+596,522),this.spriteItems.addChild(M,100),this._cupList.push(M),(C=new l.Sprite("#themeaward_cover_3.png")).setPosition((s-1)*he+620,515),this.buildItems.addChild(C,100,1803));break;case 5:(S=new l.Sprite("#stageani_3_2.png")).setPosition((s-1)*he+164,156),this.buildItems.addChild(S);T=l.sequence(l.moveTo(3,(s-1)*he+154,166),l.moveTo(3,(s-1)*he+154,156));S.runAction(l.repeatForever(T)),(f=new l.Sprite("#stageani_3_1.png")).setPosition((s-1)*he+164,166),this.buildItems.addChild(f);var c=new l.Sprite("#stageani_3_6.png");c.setPosition((s-1)*he+107,452),this.buildItems.addChild(c);w=l.sequence(l.moveTo(2,(s-1)*he+107,442),l.moveTo(2,(s-1)*he+107,452));c.runAction(l.repeatForever(w));var u=new l.Sprite("#stageani_3_5.png");u.setPosition((s-1)*he+107,452),this.buildItems.addChild(u);break;case 6:(y=new l.Sprite("#stageani_4.png")).setPosition((s-1)*he+816,570),this.buildItems.addChild(y),y.setOpacity(0);T=l.sequence(l.fadeTo(.3,255),l.delayTime(3),l.fadeTo(2,0));y.runAction(l.repeatForever(T));break;case 7:var p=l.spriteFrameCache.getSpriteFrame("stageani_5_1.png"),m=l.spriteFrameCache.getSpriteFrame("stageani_5_2.png"),_=l.spriteFrameCache.getSpriteFrame("stageani_5_3.png");(y=new l.Sprite(p)).setPosition((s-1)*he+783,164),this.buildItems.addChild(y),(a=[]).push(m),a.push(_),a.push(p);var g=new l.Animation(a,.2),T=l.sequence(new l.animate(g));y.runAction(l.repeatForever(T)),(L=t.getThemeHonor(4))&&((M=new l.Sprite(1==L?"#themeaward_cup.png":3==L?"#themeaward_cup_clear.png":5==L?"#themeaward_cup_mission.png":"#themeaward_cup_clearandmission.png")).setPosition((s-1)*he+219,420),this.spriteItems.addChild(M,100),this._cupList.push(M),(C=new l.Sprite("#themeaward_cover_4.png")).setPosition((s-1)*he+212,430),this.buildItems.addChild(C,100,1804));break;case 8:(L=t.getThemeHonor(5))&&((M=new l.Sprite(1==L?"#themeaward_cup.png":3==L?"#themeaward_cup_clear.png":5==L?"#themeaward_cup_mission.png":"#themeaward_cup_clearandmission.png")).setPosition((s-1)*he+551,496),this.spriteItems.addChild(M,100),this._cupList.push(M),(C=new l.Sprite("#themeaward_cover_5.png")).setPosition((s-1)*he+555,490),this.buildItems.addChild(C,100,1805));break;case 9:var f=new l.Sprite("#stageani_6_1.png");f.setPosition((s-1)*he+889,7),this.buildItems.addChild(f);T=l.sequence(l.moveTo(4,(s-1)*he+889,47),l.moveTo(4,(s-1)*he+889,7));f.runAction(l.repeatForever(T));var S=new l.Sprite("#stageani_6_2.png");S.setPosition((s-1)*he+889,-23),this.buildItems.addChild(S);var w=l.sequence(l.moveTo(2,(s-1)*he+889,7),l.moveTo(2,(s-1)*he+889,-23));S.runAction(l.repeatForever(w)),(L=t.getThemeHonor(6))&&((M=new l.Sprite(1==L?"#themeaward_cup.png":3==L?"#themeaward_cup_clear.png":5==L?"#themeaward_cup_mission.png":"#themeaward_cup_clearandmission.png")).setPosition((s-1)*he+740,369),this.spriteItems.addChild(M,100,1806),this._cupList.push(M),(C=new l.Sprite("#themeaward_cover_6.png")).setPosition((s-1)*he+745,376),this.buildItems.addChild(C,100,1806));break;case 10:break;case 11:var p=l.spriteFrameCache.getSpriteFrame("stageani_7-1.png"),m=l.spriteFrameCache.getSpriteFrame("stageani_7-2.png"),_=l.spriteFrameCache.getSpriteFrame("stageani_7-3.png"),v=l.spriteFrameCache.getSpriteFrame("stageani_7-4.png");(y=new l.Sprite(p)).setPosition((s-1)*he+902,506),this.buildItems.addChild(y),(a=[]).push(m),a.push(_),a.push(v),a.push(p);var g=new l.Animation(a,.25),T=l.sequence(new l.animate(g));y.runAction(l.repeatForever(T));break;case 12:(L=t.getThemeHonor(7))&&((M=new l.Sprite(1==L?"#themeaward_cup.png":3==L?"#themeaward_cup_clear.png":5==L?"#themeaward_cup_mission.png":"#themeaward_cup_clearandmission.png")).setPosition((s-1)*he+462,387),this.spriteItems.addChild(M,100),this._cupList.push(M),(C=new l.Sprite("#themeaward_cover_7.png")).setPosition((s-1)*he+480,375),this.buildItems.addChild(C,100,1807));break;case 13:var L=t.getThemeHonor(8);if(L){var M=new l.Sprite(1==L?"#themeaward_cup.png":3==L?"#themeaward_cup_clear.png":5==L?"#themeaward_cup_mission.png":"#themeaward_cup_clearandmission.png");M.setPosition((s-1)*he+648,313),this.spriteItems.addChild(M,100),this._cupList.push(M);var C=new l.Sprite("#themeaward_cover_8.png");C.setPosition((s-1)*he+640,285),this.buildItems.addChild(C,100,1808)}break;case 14:var p=l.spriteFrameCache.getSpriteFrame("stageani_8-1.png"),m=l.spriteFrameCache.getSpriteFrame("stageani_8-2.png"),_=l.spriteFrameCache.getSpriteFrame("stageani_8-3.png"),v=l.spriteFrameCache.getSpriteFrame("stageani_8-4.png"),y=new l.Sprite(p);y.setPosition((s-1)*he+153,506),this.buildItems.addChild(y),(a=[]).push(m),a.push(_),a.push(v),a.push(p);var g=new l.Animation(a,.25),T=l.sequence(new l.animate(g));y.runAction(l.repeatForever(T));var B;t.getOpenedLevel()>=O.MAINLEVELCOUNT&&((B=new l.Sprite("#map_theend_135.png")).setPosition((s-1)*he+497,453),this.mBgLayer.addChild(B,102))}}for(var F,E,P=O.MAINLEVELCOUNT+1,b=1;b<P;b++){E=(F=e.mapConfig.allLevels[b-1]).ptLevelNum;var A=null,I=t.getFirstHonor(b);if(I>0)switch(I){case 1:A=new l.Sprite(t.getTaskHonor(b)?"#stagepoint_mission_wood.png":"#stagepoint_wood.png");break;case 2:A=new l.Sprite(t.getTaskHonor(b)?"#stagepoint_mission_silver.png":"#stagepoint_silver.png");break;case 3:A=new l.Sprite(t.getTaskHonor(b)?"#stagepoint_mission_gold.png":"#stagepoint_gold.png")}else A=0!=F.nBossModeSecond?new l.Sprite("#stagepoint_boss.png"):F.bPresentGate?new l.Sprite("#stagepoint_gate.png"):new l.Sprite("#stagepoint_adv.png");A&&(A.setPosition(E),this.spriteItems.addChild(A,3,k+b)),(this.usePartRes&&b>14||b>e.usersData.openmaxstage)&&(A.visible=!1)}var R=0,D=e.curLevel;D&&(R=(F=e.mapConfig.allLevels[D-1]).ptLevelNum.x),this.xOffSet=i.width/2-R,this.xOffSet>0&&(this.xOffSet=0),R=this.mapCount<O.MAINTHEMEMAPCOUNT?0:242;var x=-he*(this.mapCount-1)+i.width-he+R;if(this.xOffSet<x&&(this.xOffSet=x),this.mBgLayer.setPosition(this.xOffSet,0),t.getNewThemeUnlockLevel()==O.SHOWMEETAQIU){var N=e.usersData.m_nLanguage,G=[],W=String.formatC("res/Themes%s/scene/modeunlock%s.plist",N,N);G.push(Ki(W)),G.push(Ki(W.replace(".plist",".png")));var U=this;qu.loadResAsync(G,function(){U.showNoticeDialog()})}if(e.m_nGameMode!=ge.HIGHERMODE){var H=t.getOpenedLevel();t.bWinNewLevel&&H-1>0?(this.ShowRouteMap(1,H-1),this.AnimateShowRouteMap(H-1,H)):(this.ShowRouteMap(1,H),this.showUserHead(),this.ShowCircleAnimate())}},showHonor:function(){},addMenuLayer:function(){var e=nr.share().getWinSize(),t=new l.Sprite("#stagemap_toolbar_leftbg.png");t.setAnchorPoint(0,1),t.setPosition(0,e.height),this.addChild(t,98,98);var i=this.menuItemWithFile("#stagemap_toolbar_home.png",kd.MENU_HOME,l.p(61,54),null),n=this.menuItemWithFile("#stagemap_toolbar_shop.png",kd.MENU_SHOP,l.p(162,54),null),s=this.menuItemWithFile("#stagemap_toolbar_leaderboard.png",kd.MENU_CUP,l.p(262.4,54),null),r=this;this._listener2&&l.eventManager.removeListener(this._listener2),this._listener2=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"msgShowSuperPackageRedPoint",callback:function(e){r.isShowSuperPackageRedPoint()}}),l.eventManager.addListener(this._listener2,1);var a=wr.getModel(),o=Vd.createWithArray([i,n,s]);if(o.setPosition(0,0),o.setAnchorPoint(0,0),t.addChild(o),this.spRightMenu=new l.Sprite("#stagemap_toolbar_rightbg.png"),this.spRightMenu.setAnchorPoint(1,1),this.spRightMenu.setPosition(e.width,e.height),this.addChild(this.spRightMenu,99,599),this.spRightStarMore=this.spRightMenu.getChildByTag(767),this.spRightStarMore);else{var h=!GamePlatform.isCN()&&this.usePartRes?"stagemap_toolbar_overten_en.png":"stagemap_toolbar_overten.png";this.spRightStarMore=new l.Sprite(a.m_nGameMode==ge.HIGHERMODE?"#stagemap_toolbar_floor.png":h),this.spRightStarMore.setAnchorPoint(0,0),this.spRightStarMore.setPosition(0,0),this.spRightMenu.addChild(this.spRightStarMore,767)}if(this.nStarCount=a.m_nGameMode==ge.HIGHERMODE?a.m_oHigher.getGameStars():a.usersData.getGameStars(),(this.nStarCount<=5||a.usersData.isLifeForever())&&this.spRightStarMore.setVisible(!1),a.usersData.getOpenedLevel(),1){if(a.usersData.showDiscountMenu()){var d=a.usersData.GetDisCountTime();d.h,d.m,d.s;d.result?this.schedule(this.DisCountTimeUpdate,1):a.usersData.GetDisCountSale(),this.ShowDiscountMenu()}}else{var c=a.usersData.getRouletteTime(this.RM,this.RS);if(this.RouletteState=c.result,this.RM=c.m,this.RS=c.s,this.RouletteState){var u=new l.Sprite("wheel_btn_bg.png");u.setAnchorPoint(.5,.5),u.setPosition(.5*e.width,e.height+20),this.addChild(u,99,x),u.runAction(l.repeatForever(l.rotateBy(8,360)));var p=null,m=!0;a.m_bFeast&&a.m_oFeast.getCurFeastType()==mn?(p=this.menuItemWithFile("wheel_btn_allday.png",kd.MENU_ROULETTE,l.p(100,100),"wheel_btn_allday.png"),m=!1):p=this.menuItemWithFile("wheel_btn.png",kd.MENU_ROULETTE,l.p(100,100),"wheel_btn.png");var _=Vd.createWithArray([p]);_.setPosition(.5*e.width-100,e.height-105),this.addChild(_,99,N),m&&(this.labelRouletteMinute=new l.LabelAtlas(String.formatC("%02lu",this.RM),"num_white_18.png",18,30,"./0123456789"),this.labelRouletteMinute.setAnchorPoint(.5,.5),this.labelRouletteMinute.setPosition(76,46),p.addChild(this.labelRouletteMinute),this.labelRouletteSecond=new l.LabelAtlas(String.formatC("%02lu",this.RS),"num_white_18.png",18,30,"./0123456789"),this.labelRouletteSecond.setAnchorPoint(.5,.5),this.labelRouletteSecond.setPosition(124,46),p.addChild(this.labelRouletteSecond),this.schedule(this.UpdateRouletteTime,1))}else if(a.usersData.showDiscountMenu()){(d=a.usersData.GetDisCountTime()).h,d.m,d.s;d.result?a.usersData.GetDisCountSale():this.schedule(this.DisCountTimeUpdate,1),this.ShowDiscountMenu()}}if(!dp&&a.usersData.isLifeForever()){var g=new l.Sprite("#stagemap_toolbar_unlimited.png");return g.setAnchorPoint(0,0),g.setPosition(0,0),void this.spRightMenu.addChild(g)}var T=a.m_nGameMode===ge.HIGHERMODE?a.usersData.getHigherLifeStarByUM():a.usersData.getLifeStarWithTime();if(this.nStarCount<T){var f=a.m_nGameMode===ge.HIGHERMODE?a.m_oHigher.getWaitMS():a.usersData.getWaitMS();this.GM=f.m,this._GS=f.s,this.loadCountDown()}(this.nStarCount<=5||a.usersData.isLifeForever())&&this.spRightStarMore.setVisible(!1),this.UpdateStar(0);var S=GamePlatform.getCurrentPlatForm();if(S==PlatformType.QQ){var w=S===PlatformType.QQ,v=w?"newfront_btn_retract.png":"newfront_btn_top.png",L=w?"newfront_btn_retract_pressed.png":"newfront_btn_top_pressed.png",M=this.menuItemWithFile(v,yu,l.p(60,70),L);this.dotSpr=new l.Sprite("quickstart_prompt.png"),this.dotSpr.setPosition(.75*M.width,.85*M.height),M.addChild(this.dotSpr);var C=new l.Menu(M);C.setPosition(0,0),this.addChild(C,10,yu)}},addFriendsLayer:function(){var e=wr.getModel(),t=e.usersData;t.setFriendList(this.friends),console.log("addFriendsLayer:"+JSON.stringify(this.friends));for(var i in this.friends){var n=this.friends[i];if(n.openid!==l.playerInfo.openid){var s=n.stage;if(!(s===t.getOpenedLevel()||s>135||s>e.usersData.openmaxstage)){s>135&&(s=135);var r=e.mapConfig.allLevels[s-1].ptLevelNum;this.createUserHead(n.photo,n.name,r,103)}}}},addCloudLayer:function(){var e=wr.getModel(),t=e.usersData.getOpenedLevel();if(!(t>120||this.usePartRes)){this.mCloudLayer=new l.Layer,this.mBgLayer.addChild(this.mCloudLayer,104);var i=(he*this.mapCount-1.5*he)/(.5*he),n=0,s=null,r=null,a=e.usersData.openmaxstage-t,o=0;a>=0&&a<=10&&(o=a<5?2:1);for(var h=0,d=0;d<i;d++)n=d%4+1,80==e.usersData.openmaxstage||120==e.usersData.openmaxstage?n=3:100==e.usersData.openmaxstage&&(n=3,h=80),d>=Math.floor((t-1)/5-o)&&(s=String.formatC("#stagemap_cloud_%d.png",n),(r=new l.Sprite(s)).setAnchorPoint(0,0),r.setPosition(1.5*he+d*he*.5-h,0),this.mCloudLayer.addChild(r))}},onExit:function(){this._listener1&&l.eventManager.removeListener(this._listener1),this.listener&&l.eventManager.removeListener(this.listener),this._listener2&&l.eventManager.removeListener(this._listener2);var e=wr.getModel();e.selLayer=null,this.unschedule(this.UpdateFailTime),this.unschedule(this.AnimateShowRouteMapSchedule),this.unschedule(this.DisCountTimeUpdate),e.playMuiscWithType($.MTSTARTBGMSC,2),qu.clearOwner(this),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this.removeAllChildren(),this._super()},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){var i=wr.getModel();if(i.bLockMenu||this.shownoi)return!0;var n=this.getChildByTag(U);if(n&&n.isVisible())return!0;this.mMoveLength=0;var s=this.convertTouchToNodeSpace(e);s.x=s.x-this.xOffSet;for(var r=Math.ceil(this.xOffSet/he),a=-1,o=10*(r*=-1);o<10*(r+2);o++)if(o<i.mapConfig.allLevels.length){var h=i.mapConfig.allLevels[o].ptLevelNum;if(l.pDistance(h,s)<30){a=o+1;break}}return a>0&&a<=i.usersData.getOpenedLevel()&&(this.spriteSelectItem=this.mBgLayer.getChildByTag(k+a),this.spriteSelectItem&&this.spriteSelectItem.setScale(1.2)),!0},ccTouchMoved:function(e,t){if(!wr.getModel().bLockMenu){var i=this.getChildByTag(U);if(!(i&&i.isVisible()||this.shownoi)){var n=nr.share().getWinSize(),s=this.convertTouchToNodeSpace(e),r=this.convertTouchToNodeSpace(e),a=e.getPreviousLocationInView();a=l.director.convertToGL(a),a=this.convertToNodeSpace(a),s=l.director.convertToGL(s),s=this.convertToNodeSpace(s);var o=l.pSub(s,a);l.view._isRotated&&(o={x:o.y,y:o.x}),this.mMoveLength+=-o.x,this.mBgLayer.stopActionByTag(1e3),this.mMoveLength>0?this.bLeft&&(this.bLeft=!this.bLeft):this.bRight&&(this.bRight=!this.bRight),(this.mMoveLength>=30||this.mMoveLength<=-30)&&this.spriteSelectItem&&(this.spriteSelectItem.setScale(1),this.spriteSelectItem=null);var h=o.x;if(this.shareLayer&&!this.shareLayer.getIsRunaction()&&l.rectContainsPoint(this.shareLayer.getBoundingBox(),r))return l.log("isTouch"),void((h<-20||h>20)&&this.shareLayer.hide());this.mDis=8*o.x,o.y=0;var d=this.mapCount<O.MAINTHEMEMAPCOUNT?-he*(this.mapCount-1)+n.width-he:-he*(this.mapCount-1)+n.width-he+242,c=l.pAdd(this.mBgLayer.getPosition(),o);c.x>0?(c.x=0,this.bLeft||(this.bLeft=!0)):c.x<d&&(c.x=d,this.bRight||(this.bRight=!0)),this.xOffSet=c.x,this.mBgLayer.setPosition(c)}}},ccTouchEnded:function(e,t){if(!this.shownoi){var i=wr.getModel();if(!i.showRewardLayer){var n=this.convertTouchToNodeSpace(e),s=this.getChildByTag(5678);if(!this.shareLayer||!l.rectContainsPoint(this.shareLayer.getBoundingBox(),n))if(s&&s.isVisible()){var r=s.getChildByTag(7);if(r&&l.rectContainsPoint(r.getBoundingBox(),n)){o=this;return(h=GamePlatform.getCurrentPlatForm()==PlatformType.QQ)?kl.shareScreenshot(Wl.REWARD_SHARE,function(e){e&&o._rewardSpr&&(o._rewardSpr.removeFromParent(),o._rewardSpr=null)}):kl.shareMessage("","",Wl.REWARD_SHARE,0,1,null,function(e){e&&o._rewardSpr&&(o._rewardSpr.removeFromParent(),o._rewardSpr=null)}),void Tt.onShare("#sina-weibo","goldcup")}var a=s.getChildByTag(8);if(a&&l.rectContainsPoint(a.getBoundingBox(),n)){var o=this,h=GamePlatform.getCurrentPlatForm()==PlatformType.QQ;h?kl.shareScreenshot(Wl.REWARD_SHARE,function(e){e&&o._rewardSpr&&(o._rewardSpr.removeFromParent(),o._rewardSpr=null)}):kl.shareMessage(null,"",Wl.REWARD_SHARE,0,1,null,function(e){e&&o._rewardSpr&&(o._rewardSpr.removeFromParent(),o._rewardSpr=null)})}}else if(!i.bLockMenu){var d=this.getChildByTag(U);if(d&&d.isVisible()){d.setVisible(!1);var c=this.getChildByTag(U+1);c&&c.isVisible()&&c.setVisible(!1);var u=this.getChildByTag(U+2);u&&u.isVisible()&&u.setVisible(!1);var p=this.getChildByTag(H);p&&p.isVisible()&&p.setVisible(!1);o=this;return l.addTimePoint("shopopen_s"),void qu.loadResAsync(ri,function(){var e=fo.create(3);o.addChild(e,100)})}var m=i.m_nGameMode==ge.HIGHERMODE?i.m_oHigher.getGameStars():i.usersData.getGameStars();if(!i.usersData.isLifeForever()&&m>=5&&this.spRightMenu){var _,g=this.spRightMenu.getContentSize();if(_=0!=this.DisGM||0!=this.DisGS?l.rect(this.spRightMenu.x-g.width,this.spRightMenu.y-g.height,g.width,g.height):l.rect(this.spRightMenu.x-g.width,this.spRightMenu.y-g.height+40,g.width,g.height),l.rectContainsPoint(_,n)){o=this;return l.addTimePoint("LifeRequestDlg_s"),void qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(2),o.addChild(e,99,199)})}}if((this.mDis<-4||this.mDis>4)&&this.SlowDownShow(),this.spriteSelectItem&&(this.spriteSelectItem.setScale(1),this.spriteSelectItem=null),this.mMoveLength<30&&this.mMoveLength>-30&&!(this.ClickOnTempleEntrance(e)||this.ClickOnDoubleCarrotEntrance(e)||this.ClickOnFriendHead(n)||this.ClickOnLevelItem(n))){var T=this.mBgLayer.convertTouchToNodeSpace(e);for(var f in this._cupList)if((s=this._cupList[f])&&l.rectContainsPoint(s.getBoundingBox(),T)){o=this;Ql.opengoldencup(function(e){qu.loadResAsync(gi,function(){o.showCheckPoint(e.luobos),o.showThemeHonor()})})}}}}}},showFriendsDlg:function(){},showLevelDlg:function(){},showLevelInfo:function(e){if(!this.isShowLevelInfo){var t=wr.getModel(),i=this,n=[],s=t.getCurTheme(),r=t.usersData.m_nLanguage,a=String.formatC("res/Themes/Maps/BG%02lu-hd",e),o=String.formatC("res/Themes%s/Maps/BG%02lu-hd%s",r,e,r);n.push(Ki(a+".png")),n.push(Ki(a+".plist")),n.push(Ki(o+".png")),n.push(Ki(o+".plist")),n.push(Ki(String.formatC("res/Themes/Theme%d/BG-hd.plist",s))),n.push(Ki(String.formatC("res/Themes/Theme%d/BG-hd.png",s))),this.isShowLevelInfo=!0,l.addTimePoint("LevelInfoDlg_s"),qu.loadResAsync(n,function(){var n=Ra.create();t.usersData.getFirstHonor(e)>0?t.usersData.getTaskHonor(e)?n.SetShowLayer(1):n.SetShowLayer(2):n.SetShowLayer(1),i.addChild(n,99),i.isShowLevelInfo=!1})}},getCurLevelHonor:function(e){for(var t in this.luoboHonor){var i=this.luoboHonor[t],n=i[0],s=i[1];if(e===n)return s}return 0},entranceTemple:function(){var e=wr.getModel();e.bLockMenu=!1,e.usersData.getTempleOpenedLevel()<136&&e.usersData.setTempleOpenLevel(136);var t=e.usersData.getTempleOpenedLevel();e.setCurLevel(t),l.addTimePoint("levelSel_start"),qi.preloadWithLoadingTag(qt,we.LEVELSELCIRCLE)},menuCallback:function(e){var t=wr.getModel(),i=this;if(!t.showRewardLayer)switch(t.playSoundWithType($.MTMENUSELECT),e.getTag()){case kd.MENU_HOME:l.addTimePoint("GO_MAIN_S"),qi.preloadWithLoadingTag(Ht,we.MAIN),t.bBackMainScene=!0;break;case kd.MENU_SHOP:if(this.btnTag==kd.MENU_SHOP)return;this.btnTag=kd.MENU_SHOP,l.addTimePoint("shopopen_s"),qu.loadResAsync(ri,function(){i.btnTag=0;var e=fo.create(1);i.addChild(e,100)});break;case kd.MENU_TIME:if(t.usersData.isLifeForever())break;l.addTimePoint("LifeRequestDlg_s"),qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(vr.LEVEL),i.addChild(e,99,199)});break;case kd.MENU_CUP:t.m_nGameMode==ge.HIGHERMODE?qu.loadResAsync(bi.concat(Ri),function(){var e=vl.create();e.showFriends(fl.FLOOR_PERSONAL),i.addChild(e,99,459)}):(l.addTimePoint("friendHonorDlgopen_s"),qu.loadResAsync(Ni,function(){var e=Mr.create();e.showFriends(vr.ALL),i.addChild(e,99)}));break;case kd.MENU_ROULETTE:var n=this.getChildByTag(x);n&&n.runAction(l.moveBy(.2,0,300));var s=this.getChildByTag(N);s&&s.runAction(l.moveBy(.2,0,300)),qu.loadResAsync(ai,function(){var e=_c.create();i.addChild(e,99)});break;case kd.MENU_DISCOUNT:this.unschedule(this.DisCountTimeUpdate),qu.loadResAsync(Ii,function(){var e=yr.create();i.addChild(e,100)});break;case 8888:(r=this.getChildByTag(8887))&&this.removeChildByTag(8887),this.shownoi=!1;break;case 8889:var r=this.getChildByTag(8887);r&&this.removeChildByTag(8887),this.shownoi=!1;break;case kd.MENU_AQIU_TIP:var a=nr.share().getWinSize(),o=this.mBgLayer.getPosition();if(Math.abs(o.x-1327)<a.width)return;this.xOffSet=a.width/2-1327,this.mBgLayer.setPosition(this.xOffSet,o.y);break;case yu:if(lp){this.dotSpr&&this.dotSpr.setVisible(!1);var h=GamePlatform.getCDN();SDKInterface.switchToMsgList(b.Share_Title,h+"res/icon_120.png",function(){})}break;case kd.MENU_CLOSE:l.director.getScheduler().isWaite=!1,(d=this.getChildByTag(5678))&&d.isVisible()&&(d.setVisible(!1),t.bLockMenu=!1),(d=this.getChildByTag(256))&&d.isVisible()&&(d.setVisible(!1),t.bLockMenu=!1,this.msgRateCallFun(this,1));break;case kd.MENU_RATE:var d=this.getChildByTag(256);d&&d.isVisible()&&(d.setVisible(!1),t.bLockMenu=!1),this.msgRateCallFun(this,0)}},menuItemWithFile:function(e,t,i,n){var s=new l.Sprite(e),r=null;r=null==n?new l.Sprite(e):new l.Sprite(n);var a=new l.MenuItemSprite(s,r,null,this,this.menuCallback.bind(this));return a.setTag(t),a.setPosition(i),a},SlowDownShow:function(){var e=nr.share().getWinSize(),t=l.p(this.mDis,0),i=l.pAdd(this.mBgLayer.getPosition(),t);this.mDis=0,i.x<-he*(this.mapCount-1)+e.width-he+242&&(i.x=-he*(this.mapCount-1)+e.width-he+242),i.x>0&&(i.x=0);var n=l.moveTo(1,i);this.mBgLayer.stopActionByTag(1e3),n.setTag(1e3),this.mBgLayer.runAction(n.easing(l.easeExponentialOut())),this.xOffSet=i.x},ClickOnLevelItem:function(e){var t=wr.getModel(),i=t.usersData;e.x-=this.xOffSet;for(var n=Math.ceil(this.xOffSet/he),s=-1,r=10*(n*=-1);r<10*(n+2);r++)if(r<t.mapConfig.allLevels.length){var a=t.mapConfig.allLevels[r].ptLevelNum;if(l.pDistance(a,e)<50){s=r+1;break}}if(s>0){if(s>i.getOpenedLevel())return!0;if(t.playSoundWithType($.MTPAGESELECT),t.setCurLevel(s),!t.usersData.canPlay()){var o=this;return qu.loadResAsync(xi,function(){o.m_dlg=Qc.create(),o.m_dlg.setOnCloseCallback(o,o.onCloseCallback.bind(o)),o.addChild(o.m_dlg,99)}),!0}var h=this;if(t.usersData.getOpenedLevel()<32&&31==s&&!i.isCarrotBuy2(Me.CarrotGla)){if(!t.usersData.getThirdWaitHMS().r)return qu.loadResAsync(fi,function(){var e=Fr.create();e.mCurLevel=31,h.addChild(e,222,505)}),!0;t.usersData.setCarrotTheme(Me.CarrotGla)}return 51==s&&i.getGoldCount()<40&&51==i.getOpenedLevel()&&0==i.isCarrotBuy2(Me.CarrotSky)?(qu.loadResAsync(fi,function(){var e=Fr.create();e.mCurLevel=51,h.addChild(e,222,505)}),!0):66==s&&i.getTaskHonorCount()<45&&66==i.getOpenedLevel()&&0==i.isCarrotBuy2(Me.CarrotDes)?(qu.loadResAsync(fi,function(){var e=Fr.create();e.mCurLevel=66,h.addChild(e,222,505)}),!0):81==s&&81==i.getOpenedLevel()&&0==i.isCarrotBuy2(Me.BuyPolarRegion)&&(i.getGoldCount()<60||i.getTaskHonorCount()<55)?(qu.loadResAsync(fi,function(){var e=Fr.create();e.mCurLevel=81,h.addChild(e,222,505)}),!0):101==s&&101==i.getOpenedLevel()&&!i.IsUnlockSeventh()&&i.getGoldCount()<70?(qu.loadResAsync(fi,function(){var e=Fr.create();e.mCurLevel=101,h.addChild(e,222,505)}),!0):116==s&&116==i.getOpenedLevel()&&0==i.isCarrotBuy2(Me.BuyIceland)&&(i.getGoldCount()<80||i.getTaskHonorCount()<75)?(qu.loadResAsync(fi,function(){var e=Fr.create();e.mCurLevel=116,h.addChild(e,222,505)}),!0):(this.showLevelInfo(s),!0)}return!1},showThemeHonor:function(){var e=wr.getModel();e.bLockMenu=!0;var t=GamePlatform.getLanguage();qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/AwardBG%s.plist",t,t)),qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",t));var i=nr.share().getMapOffset(),n=this.getChildByTag(5678);if(null==n){var s=nr.share().getWinSize(),r=new l.LayerColor(l.color(0,0,0,178),s.width,s.height);this.addChild(r,5678,5678);var a=new l.Sprite("themeaward_bg.png");a.setPosition(.5*s.width,.5*s.height),r.addChild(a,2,2);for(var o=[l.p(182+i.width,440),l.p(329+i.width,440),l.p(477+i.width,440),l.p(625+i.width,440),l.p(773+i.width,440),l.p(182+i.width,199),l.p(329+i.width,199),l.p(477+i.width,199),l.p(625+i.width,199),l.p(773+i.width,199)],h=1;h<11;h++){var d=e.usersData.getThemeHonor(h),c=new l.Sprite(0==d?"themeaward_disable.png":1==d?"themeaward_cup.png":3==d?"themeaward_cup_clear.png":5==d?"themeaward_cup_mission.png":"themeaward_cup_clearandmission.png");c.setPosition(o[h-1]),r.addChild(c,5)}var u=new l.Sprite("popup_close_frame.png");u.setPosition(867+i.width,575),r.addChild(u,6,6);var p=this.menuItemWithFile("popup_close.png",kd.MENU_CLOSE,l.p(867+i.width,575)),m=new l.Menu(p);m.setPosition(0,0),r.addChild(m,15,15);var _=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,g=GamePlatform.isCN()?_?"themeaward_share_qq.png":"themeaward_share_wechat.png":"themeaward_share.png",T=new l.Sprite(g);T.setPosition(60+i.width,207),r.addChild(T,7,8),e.usersData.isShareWeChat()||GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook||(this._rewardSpr=new l.Sprite("themeaward_share_wechat_new.png"),this._rewardSpr.setAnchorPoint(1,.5),this._rewardSpr.setPosition(23,.5*T.height),T.addChild(this._rewardSpr))}else n.setVisible(!0),e.usersData.isShareWeChat()&&this._rewardSpr&&(this._rewardSpr.removeFromParent(),this._rewardSpr=null)},ShineBgAnimate:function(){var e=this.getChildByTag(U),t=l.fadeTo(.3,128),i=l.fadeTo(.3,255),n=l.repeatForever(l.sequence(t,i));e.runAction(n)},ClickOnFriendHead:function(e){var t=l.p(e.x,e.y);t.x=t.x-this.xOffSet;var i=Math.ceil(this.xOffSet/he);i*=-1;for(var n=wr.getModel(),s=10*i;s<=10*(i+2);s++)n.mapConfig.allLevels.length;return!1},ClickOnUserMeHead:function(e){if(null==this.spHeadBG)return!1;var t=this.spHeadBG.getPosition();if(t.y+=25,l.pDistance(t,e)<this.spHeadBG.width/2){var i=wr.getModel();i.setCurLevel(i.usersData.getOpenedLevel());var n=this;return l.addTimePoint("friendHonorDlgopen_s"),qu.loadResAsync(Ni,function(){var e=Mr.create();e.showFriends(vr.LEVEL),n.addChild(e,99)}),!0}return!1},ClickOnTempleEntrance:function(e){var t=!1,i=this.mBgLayer.convertTouchToNodeSpace(e),n=wr.getModel();if(this.ClickOnLevelItem(this.convertTouchToNodeSpace(e)))return!0;var s=this.buildItems.getChildByTag(1524);s&&l.rectContainsPoint(s.getBoundingBox(),i)&&(t=!0,n.usersData.xOffsetLevelSel=s.x);var r=this.buildItems.getChildByTag(1525);if(r&&l.rectContainsPoint(r.getBoundingBox(),i)&&(n.usersData.xOffsetLevelSel=s.x,t=!0),t)if(n.playSoundWithType($.MTPAGESELECT),n.usersData.bShowTempleEntranceAD||!n.usersData.isCarrotBuy(ue.CARROT_GIRL)){var a=this;qu.loadResAsync(fi,function(){var e=Fr.create();e.setDescrip(136),a.addChild(e,222,505),n.usersData.bShowTempleEntranceAD=!1})}else this.entranceTemple();return t},ClickOnDoubleCarrotEntrance:function(e){var t=!1,i=this.mBgLayer.convertTouchToNodeSpace(e),n=wr.getModel();if(this.ClickOnLevelItem(this.convertTouchToNodeSpace(e)))return!0;var s=this.buildItems.getChildByTag(1625);if(s&&l.rectContainsPoint(s.getBoundingBox(),i)&&(t=!0,n.usersData.xOffsetLevelSel=s.x),t)if(n.usersData.isCarrotBuy(ue.CARROT_GIRL))n.usersData.getDoubelOpenedLevel()<156&&n.usersData.setDoubelOpenLevel(156),l.addTimePoint("meetfiend_start"),qi.preloadWithLoadingTag(Ai,we.MEETFRIEND);else{var r=this;qu.loadResAsync(fi,function(){var e=Fr.create();e.setDescrip(156),r.addChild(e,222,505)})}return t},showNoticeDialog:function(){var e=wr.getModel();this.shownoi=!0;var t=nr.share().getWinSize(),i=nr.share().getMapOffset(),n=e.usersData.m_nLanguage,s=String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",n,n);qu.addRes(this,s),qu.addRes(this,String.formatC("res/Themes%s/scene/modeunlock%s.plist",n,n));var r=null;if(e.usersData.getNewThemeUnlockLevel()==O.SHOWMEETAQIU)null!=(a=l.spriteFrameCache.getSpriteFrame("modeunlock_meetaqo_text.png"))&&(r=new l.Sprite(a)).setPosition(401,340);else if(e.usersData.getNewThemeUnlockLevel()==O.SHOWMEETADAI)null!=(a=l.spriteFrameCache.getSpriteFrame("modeunlock_meetaqo_text.png"))&&(r=new l.Sprite(a)).setPosition(401,340);else{if(e.usersData.getNewThemeUnlockLevel()-1!=O.SHOWMEETADA)return;var a=l.spriteFrameCache.getSpriteFrame("modeunlock_meetaqo_text.png");null!=a&&(r=new l.Sprite(a)).setPosition(401,340)}if(null!=r){var o=l.spriteFrameCache.getSpriteFrame("woodbg_notice.png"),h=new l.Sprite(o);h.setPosition(i.width+478,311),h.addChild(r);var d=js.create(l.color(0,0,0,180),t.width,t.height);d.addChild(h,99),this.addChild(d,101,8887);var c=new l.Sprite("popup_close_frame.png"),u=new l.Sprite("popup_close.png");u.setPosition(.5*c.width,.5*c.height),c.addChild(u);var p=new l.MenuItemSprite(c,null,null,this,this.menuCallback.bind(this));p.setTag(8888),p.setPosition(743,410);var m=new l.Sprite("btn_blue_b.png"),_=new l.Sprite("btn_blue_b_pressed.png"),g=new l.Sprite("modeunlock_btn_go.png");g.setPosition(m.width/2,m.height/2);var T=new l.MenuItemSprite(m,_,null,this,this.menuCallback.bind(this));T.addChild(g),T.setTag(8889),T.setPosition(403,154);var f=new l.Menu(T,p);f.setPosition(0,0),h.addChild(f),e.usersData.showNewThemeUnlock(0)}},onCloseCallback:function(){this.m_dlg=null},isShowSuperPackageRedPoint:function(e){null!=this.mSuperPackageRedPoint&&this.mSuperPackageRedPoint.setVisible(!1)},showAQiuEntranAnimation:function(){var e=new l.Sprite("stageani_aqo_cover.png");if(null!=e){var t=l.callFunc(this.showAQiuEntranAnimation1.bind(this)),i=l.callFunc(this.showAQiuEntranAnimation2.bind(this));e.setPosition(he+372,388),this.buildItems.addChild(e,100,1626);var n=l.scaleTo(.08,1.1),s=l.moveBy(.08,0,10),r=l.spawn(n,s),a=l.scaleTo(.16,0),o=l.moveBy(.16,0,-50),h=l.spawn(a,o),d=l.spawn(t,i);e.runAction(l.sequence(r,h,l.hide(),l.delayTime(.4),d))}},showAQiuEntranAnimation1:function(){var e=new l.Sprite("stageani_aqo.png");e.setScale(0),e.setPosition(l.p(he+367,457)),this.buildItems.addChild(e,100,1625);var t=l.callFunc(this.showAQiuEntranAnimation3.bind(this)),i=l.scaleTo(.08,1.1),n=l.scaleTo(.16,1),s=l.moveBy(.08,0,-80);e.runAction(l.sequence(i,n,s,t));var r=new l.Sprite("stageani_aqo_shine.png");r.setPosition(150,150),r.setOpacity(100),e.addChild(r,100);var a=l.fadeTo(2,255),o=l.fadeTo(2,100);r.runAction(l.repeatForever(l.sequence(a,o)))},showAQiuEntranAnimation2:function(){var e=new l.Sprite("stageani_aqo_shadow.png");e.setScale(0),e.setPosition(he+372,344),this.buildItems.addChild(e,100,1625);var t=l.callFunc(this.showAQiuEntranAnimation4.bind(this)),i=l.scaleTo(.08,1.1),n=l.scaleTo(.16,1),s=l.fadeOut(.08);e.runAction(l.sequence(i,n,s,l.delayTime(.16),t))},showAQiuEntranAnimation3:function(){var e=new l.Sprite("stageani_aqo_dust.png");e.setScaleX(1.2),e.setScaleY(1.3),e.setPosition(he+367,320),this.buildItems.addChild(e,100);var t=l.scaleTo(.33,2),i=l.moveBy(.33,0,20),n=l.spawn(t,i),s=l.fadeOut(.33);e.runAction(l.sequence(n,s))},showAQiuEntranAnimation4:function(){var e=new l.Sprite("map_themetag_meetaqo.png");e.setScaleX(0),e.setPosition(he+349,316),this.spriteItems.addChild(e,100);var t=l.scaleTo(.17,1),i=l.moveBy(.17,0,-12),n=l.spawn(t,i);e.runAction(n)},showMeetAqiuTipAnimation:function(){var e=new l.Sprite("stageani_tiptoaqo_01.png"),t=new l.Sprite("stageani_tiptoaqo_01.png"),i=new l.MenuItemSprite(e,t,null,this,this.menuCallback.bind(this));i.setPosition(50,264),i.setTag(kd.MENU_AQIU_TIP);for(var n=new l.Animation,s=1;s<12;s++){var r=0;r=s%2==1?1:4==s||8==s?3:2;var a=String.formatC("stageani_tiptoaqo_0%d.png",r),o=l.spriteFrameCache.getSpriteFrame(a);n.addSpriteFrame(o)}n.setLoops(1),n.setDelayPerUnit(.08);var h=l.animate(n);e.runAction(l.repeatForever(l.sequence(h,l.delayTime(.5))));var d=new l.Menu(i);d.setPosition(0,0),this.addChild(d)},AnimateShowRouteMap:function(e,t){e>0&&(e>=134&&(e=134),t>=135&&(t=135),this.mFrom=e,this.mTo=t,this.schedule(this.AnimateShowRouteMapSchedule,.02))},AnimateShowRouteMapSchedule:function(e){var t=nr.share().getWinSize();if(null==this.spriteRoute){i=String.formatC("route_%d-%d.png",this.mFrom,this.mTo);this.spriteRoute=new l.Sprite(i.toString()),this.spriteItemsRouteMap.addChild(this.spriteRoute,2)}else{var i=String.formatC("route_%d-%d.png",this.mFrom,this.mTo),n=l.spriteFrameCache.getSpriteFrame(i.toString());this.spriteRoute.setSpriteFrame(n)}if(this.spriteRoute){var s=this.spriteRoute.getTextureRect(),r=wr.getModel(),a=r.mapConfig.allLevels[this.mFrom-1].ptLevelNum,o=r.mapConfig.allLevels[this.mTo-1].ptLevelNum;a.x>=o.x?a.y>=o.y?s.width>=s.height?this.mMoveDirection=zd.MOVETO_LEFT:this.mMoveDirection=zd.MOVETO_DOWN:s.width>=s.height?this.mMoveDirection=zd.MOVETO_LEFT:this.mMoveDirection=zd.MOVETO_UP:a.y>=o.y?s.width>=s.height?this.mMoveDirection=zd.MOVETO_RIGHT:this.mMoveDirection=zd.MOVETO_DOWN:s.width>=s.height?this.mMoveDirection=zd.MOVETO_RIGHT:this.mMoveDirection=zd.MOVETO_UP,this.mTimes+=1;var h=6*this.mTimes,d=Math.floor(this.mFrom/10);this.bSet=!1,this.mFrom%10==0&&(this.bSet=!0),this.mMoveDirection==zd.MOVETO_RIGHT?(h>s.width&&(h=s.width),this.spriteRoute.setTextureRect(l.rect(s.x,s.y,s.width-s.width+h,s.height)),this.bSet?this.spriteRoute.setPosition(he*d-(s.width-h)/2,t.height/2):this.spriteRoute.setPosition(he*d+he/2-(s.width-h)/2,t.height/2),h>=s.width&&(this.mTimes=0,this.EndAnimateShowRouteMapSchedule())):this.mMoveDirection==zd.MOVETO_LEFT?(h>s.width&&(h=s.width),this.spriteRoute.setTextureRect(l.rect(s.x+s.width-h,s.y,h,s.height)),this.bSet?this.spriteRoute.setPosition(he*d+(s.width-h)/2,t.height/2):this.spriteRoute.setPosition(he*d+he/2+(s.width-h)/2,t.height/2),h>=s.width&&(this.mTimes=0,this.EndAnimateShowRouteMapSchedule())):this.mMoveDirection==zd.MOVETO_DOWN?(h>s.height&&(h=s.height),this.spriteRoute.setTextureRect(l.rect(s.x,s.y,s.width,h)),this.bSet?this.spriteRoute.setPosition(l.p(he*d,t.height/2+(s.height-h)/2)):this.spriteRoute.setPosition(l.p(he*d+he/2,t.height/2+(s.height-h)/2)),h>=s.height&&(this.mTimes=0,this.EndAnimateShowRouteMapSchedule())):(h>s.height&&(h=s.height),this.spriteRoute.setTextureRect(l.rect(s.x,s.y+s.height-h,s.width,h)),this.bSet?this.spriteRoute.setPosition(l.p(he*d,t.height/2-(s.height-h)/2)):this.spriteRoute.setPosition(l.p(he*d+he/2,t.height/2-(s.height-h)/2)),h>=s.height&&(this.mTimes=0,this.EndAnimateShowRouteMapSchedule()))}},EndAnimateShowRouteMapSchedule:function(){this.unschedule(this.AnimateShowRouteMapSchedule);var e=wr.getModel(),t=e.usersData;t.setWinNewLevel(!1);var i=e.mapConfig.allLevels[t.getOpenedLevel()-1].ptLevelNum;this.spHeadBG=new l.Sprite("stage_avatar_single.png"),this.spHeadBG.setAnchorPoint(.5,0),this.spHeadBG.setPosition(i.x,i.y-this.spHeadBG.height/2+85),this.mBgLayer.addChild(this.spHeadBG,103);var n=null;if(l.playerInfo.photo)n=Rt.createPhotoSprite(),Rt.loadUserPhoto(l.playerInfo.photo,n);else{var s=l.spriteFrameCache.getSpriteFrame("UserHead.png");(n=new l.Sprite(s)).setScale(1.2)}if(n&&(n.setPosition(this.spHeadBG.width/2,this.spHeadBG.height/2),this.spHeadBG.addChild(n,-1),this.spHeadBG.setScaleY(.1),this.spHeadBG.runAction(l.sequence(l.scaleTo(.2,1,1.2),l.scaleTo(.1,.8)))),this.ShowCircleAnimate(),t.bIsShowFigureAnimateInLevelSel&&this.ShowNewFigureAnimate(),t.getNewThemeUnlockLevel()==O.SHOWMEETAQIU){var r=e.usersData.m_nLanguage,a=[],o=String.formatC("res/Themes%s/scene/modeunlock%s.plist",r,r);a.push(Ki(o)),a.push(Ki(o.replace(".plist",".png")));var h=this;qu.loadResAsync(a,function(){h.showNoticeDialog()})}},ShowCircleAnimate:function(){var e=wr.getModel(),t=e.usersData.getOpenedLevel();t>135&&(t=135);var i=e.mapConfig.allLevels[t-1].ptLevelNum,n=new l.Sprite("stagemap_local.png");n.setPosition(i),this.spriteItems.addChild(n,2),n.setScale(.1),n.runAction(l.repeatForever(l.sequence(l.scaleTo(.6,1.4),l.spawn(l.fadeTo(.4,0),l.scaleTo(.4,2)),l.delayTime(.6),l.spawn(l.fadeTo(0,255),l.scaleTo(0,.1)))));var s=new l.Sprite("#stagemap_local.png");s.setPosition(i),this.spriteItems.addChild(s,2),s.setScale(.1);var r=l.callFunc(this.Circle2Animate.bind(this,s));s.runAction(l.sequence(l.hide(),l.delayTime(.3),l.show(),r));var a=new l.Sprite("#stagemap_local.png");a.setPosition(i),this.spriteItems.addChild(a,2),a.setScale(.1);var o=l.callFunc(this.Circle2Animate.bind(this,a));a.runAction(l.sequence(l.hide(),l.delayTime(.6),l.show(),o))},Circle2Animate:function(e){e.runAction(l.repeatForever(l.sequence(l.scaleTo(.6,1.4),l.spawn(l.fadeTo(.4,0),l.scaleTo(.4,2)),l.delayTime(.6),l.spawn(l.fadeTo(0,255),l.scaleTo(0,.1)))))},ShowRouteMap:function(e,t){for(var i=e;i<t;i++){var n=nr.share().getWinSize(),s=Math.floor(i/10);this.bSet=!1,i%10==0&&(this.bSet=!0);var r=l.spriteFrameCache.getSpriteFrame(String.formatC("route_%d-%d.png",i,i+1));if(r){var a=new l.Sprite(r);this.bSet?a.setPosition(he*s,n.height/2):a.setPosition(he*s+he/2,n.height/2),this.spriteItemsRouteMap.addChild(a,2)}}},UpdateRouletteTime:function(e){if(0!=this.RM||0!=this.RS)0==this.RS?(this.RS=59,this.RM--,this.labelRouletteMinute.setString(String.formatC("%02lu",this.RM))):this.RS--,this.labelRouletteSecond.setString(String.formatC("%02lu",this.RS));else{var t=this.getChildByTag(x);t&&t.runAction(l.moveBy(.2,0,300));var i=this.getChildByTag(N);i&&i.runAction(l.moveBy(.2,0,300)),this.unschedule(this.UpdateRouletteTime);var n=wr.getModel();if(n){var s=n.usersData.getRouletteTime(this.RM,this.RS);this.RouletteState=s.result,this.RM=s.m,this.RS=s.s}}},UpdateFailTime:function(e){0!=this.GM||0!=this._GS?(0==this._GS?(this._GS=59,this.GM--):this._GS--,this.UpdateStar(3),this.m_dlg&&this.m_dlg.UpDateTimes()):this.UpdateStar(1)},DisCountTimeUpdate:function(e){var t=wr.getModel(),i=t.usersData.GetDisCountTime();i.h,i.m,i.s;i.result||(t.usersData.GetDisCountSale(),this.ShowDiscountMenu())},UpdateDiscountTime:function(e){if(0!=this.DisGM||0!=this.DisGS)0==this.DisGS?(this.DisGS=59,this.DisGM--):this.DisGS--;else{this.unschedule(this.UpdateDiscountTime);var t=this.spRightMenu.getChildByTag(W);t&&t.setVisible(!1)}},actionUpdateStar:function(){var e=wr.getActivedModel();if(e){var t=e.usersData.getRouletteTime(this.RM,this.RS);this.RouletteState=t.result,this.RM=t.m,this.RS=t.s}this.UpdateStar(4)},getFriendPoint:function(e){var t=l.p(0,0);if(this.spriteItems){var i=this.spriteItems.getChildByTag(k+e);i&&((t=i.getPosition()).y+=i.height*(1-i.anchorY))}return t},keyBackClicked:function(){var e=wr.getModel();e.bLockMenu||(e.playSoundWithType($.MTMENUSELECT),qi.preloadWithLoadingTag(Ht,we.MAIN),e.bBackMainScene=!0)},shotCurScreen:function(){var e=nr.share().getWinSize(),t=new l.RenderTexture(e.width,e.height),i=this;if(t&&i){t.begin();for(var n=0;n<i.getChildren().length;n++){var s=i.getChildren()[n];4!=s.getTag()&&15!=s.getTag()&&1e3!=s.getTag()&&1001!=s.getTag()&&61!=s.getTag()&&s.visit()}t.end(),t.cleanup(),t.setPosition(e.width/2,e.height/2);t.saveToFile("".toString())}},lifeForeverUpdate:function(){this.unschedule(this.UpdateFailTime),this.spRightMenu.removeAllChildren();var e=new l.Sprite("#stagemap_toolbar_unlimited.png");e&&(e.setAnchorPoint(0,0),e.setPosition(0,0),this.spRightMenu.addChild(e))},weiboCallBack:function(){wr.getModel().usersData.bhadLogin||Tt.onReward("weibo-levelsel-login",1)},pingFenCallBack:function(){},ChangeDiscountMenuItem:function(){},UpdateStar:function(e){var t=wr.getModel();if(!t.usersData.isLifeForever())switch(e){case 0:h=[78,66,110,154,198,242];if(this.nStarCount>5)this.lifeStarMoreUpdate();else for(c=1;c<6;c++){var i,n=l.p(h[c],h[0]),s=null;if(this.nStarCount>=c?(i=t.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png",s=new l.Sprite(i.toString())):(i=t.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png",s=new l.Sprite(i.toString())),!s)return;s.setPosition(n),this.spRightMenu.addChild(s,1,c)}this.nStarCount<(t.m_nGameMode==ge.HIGHERMODE?t.usersData.getHigherLifeStarByUM():t.usersData.getLifeStarWithTime())?this.schedule(this.UpdateFailTime,1):this.m_spTips&&(this.m_spTips.setPosition(32,12),t.usersData.YSLoseTimes>2&&this.m_spTips.setVisible(!1));break;case 1:case 2:case 4:if((t=wr.getModel()).m_nGameMode==ge.HIGHERMODE){this.nStarCount=t.m_oHigher.getGameStars();r=t.m_oHigher.getWaitMS();this.GM=r.m,this._GS=r.s}else{this.nStarCount=t.usersData.getGameStars();var r=t.usersData.getWaitMS();this.GM=r.m,this._GS=r.s}if(1==e){var a=this.getChildByTag(199);a&&a.UpdateStars(this.nStarCount)}if(!this.spRightMenu)break;var o=this.spRightMenu.getChildByTag(this.nStarCount);if(null==o)if(this.nStarCount<=5&&this.nStarCount>0){if(!(T=l.spriteFrameCache.getSpriteFrame(t.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png")))return;var s=this.spRightMenu.getChildByTag(this.nStarCount),h=[78,66,110,154,198,242];s=new l.Sprite(T);n=l.p(h[this.nStarCount],h[0]);s.setPosition(n),this.spRightMenu.addChild(s,1,this.nStarCount)}else 4!=e&&this.lifeStarMoreUpdate();if(o&&e<4){if(this.nStarCount<=5){if(!(T=l.spriteFrameCache.getSpriteFrame(t.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png")))return;if(1==e){for(var d=[],c=1;c<4;c++){var u=String.formatC((t.m_nGameMode==ge.HIGHERMODE?"floor_":"")+"lifestar_flash%d.png",c),p=l.spriteFrameCache.getSpriteFrame(u);if(!p)return;d.push(p)}d.push(T);var m=new l.Animation(d,.1);o.runAction(l.animate(m))}else o.setSpriteFrame(T)}else this.lifeStarMoreUpdate();if(this.nStarCount>=(t.m_nGameMode==ge.HIGHERMODE?t.usersData.getHigherLifeStarByUM():t.usersData.getLifeStarWithTime())){var _=t.usersData.getLifeForeverPCutTime();_.m,_.s;if(this.LifeForeverPCut=_.result,this.LifeForeverPCut){var g=new l.Sprite(2==this.LifeForeverPCut?"#stagemap_toolbar_limited.png":"#stagemap_toolbar_limited_6.png");if(!g)return;g.setPosition(this.spRightMenu.width/2,27),this.spRightMenu.addChild(g,-2,W)}}}else if(4==e)if(this.nStarCount<=5)for(c=1;c<6;c++){var T=null;if(!(T=this.nStarCount>=c?l.spriteFrameCache.getSpriteFrame(t.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_active.png":"lifestar_active.png"):l.spriteFrameCache.getSpriteFrame(t.m_nGameMode==ge.HIGHERMODE?"floor_lifestar_disable.png":"lifestar_disable.png")))return;h=[78,66,110,154,198,242];if(null==(s=this.spRightMenu.getChildByTag(c))){if(!(s=new l.Sprite(T)))return;n=l.p(h[c],h[0]);s.setPosition(n),this.spRightMenu.addChild(s,1,c)}else s.setSpriteFrame(T)}else this.lifeStarMoreUpdate();case 3:if(this.nStarCount>=(t.m_nGameMode==ge.HIGHERMODE?t.usersData.getHigherLifeStarByUM():t.usersData.getLifeStarWithTime())){if(this.unschedule(this.UpdateFailTime),this.spTime&&t.m_nGameMode!=ge.HIGHERMODE){var n=this.spTime.getPosition(),f=l.moveTo(1,n.x,n.y+300);this.spTime.runAction(f)}}else{var S=String.formatC("%02lu",this.GM);this.lableMinute.setString(S);var w=String.formatC("%02lu",this._GS);this.lableSecond.setString(w)}}},ShowNewFigureAnimate:function(){var e=wr.getModel(),t=e.usersData;if(!t.isUnlockCarrot(ue.CARROT_OLD)){e.usersData.showFigureAnimateInLevelSel(!1);var i=nr.share().getWinSize(),n=new l.LayerColor(l.color(0,0,0,178),i.width,i.height);this.addChild(n,9999,U+2),qu.addRes(this,"res/Themes/Items/Common_shine_bg-hd.plist");var s=this.getChildByTag(U);null==s?((s=new l.Sprite("#shine_bg.png")).setPosition(i.width/2,i.height/2),this.addChild(s,9999,U)):s.setVisible(!0),s.setScale(.1);var r=l.scaleTo(.2,1),a=l.callFunc(this.ShineBgAnimate.bind(this,s));s.runAction(l.sequence(r,a));var o=this.getChildByTag(H);null==o?((o=new l.Sprite("newcarrot_bg.png")).setPosition(nr.share().getMapOffset().width+482,333),this.addChild(o,9999,H)):o.setVisible(!0),o.setScale(.1);var h=o.getChildByTag(1);if(t.isUnlockCarrot(ue.CARROT_OLD)){null==h?((h=new l.Sprite("#shop_carrot_old.png")).setPosition(o.width/2,o.height/2+100),o.addChild(h,1,1)):h.stopAllActions();for(var d=[],c=1;c<=2;++c){_=String.formatC("shop_carrot_old_%d.png",c);d.push(l.spriteFrameCache.getSpriteFrame(_.toString()))}for(var u=new l.Animation(d,.1),p=[],m=1;m<=3;++m){var _=null;_=3!=m?String.formatC("shop_carrot_old_%d.png",m):String.formatC("shop_carrot_old.png"),p.push(l.spriteFrameCache.getSpriteFrame(_.toString()))}var g=new l.Animation(p,.1),T=l.sequence(l.delayTime(2),l.animate(u),l.animate(u),l.animate(u),l.animate(g));h.runAction(l.repeatForever(T))}else if(t.isUnlockCarrot(ue.CARROT_FAT)){var f=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat.png");null==h?((h=new l.Sprite(f)).setPosition(o.width/2,o.height/2+100),o.addChild(h,1,1)):h.stopAllActions();var S=[],w=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_1.png"),v=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_2.png"),L=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_3.png"),M=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_4.png");S.push(w),S.push(v),S.push(L),S.push(v),S.push(w),S.push(v),S.push(L),S.push(v),S.push(M),S.push(f);var C=new l.Animation(S,.1),y=l.sequence(l.delayTime(2),l.animate(C));h.runAction(l.repeatForever(y))}else if(t.isUnlockCarrot(ue.CARROT_GIRL)){var B=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl.png");null==h?((h=new l.Sprite(B)).setPosition(o.width/2,o.height/2+100),o.addChild(h,1,1)):h.stopAllActions();var F=[],E=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_1.png"),P=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_2.png"),b=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_3.png"),A=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_4.png");F.push(E),F.push(P),F.push(b),F.push(A),F.push(E),F.push(P),F.push(b),F.push(A),F.push(B);var O=new l.Animation(F,.1),I=l.sequence(l.delayTime(2),l.animate(O));h.runAction(l.repeatForever(I))}var R=new l.Sprite("newcarrot_cover.png");R.setPosition(o.width/2,o.height/2),o.addChild(R),o.runAction(l.scaleTo(.3,1))}},lifeStarMoreUpdate:function(){var e=wr.getModel();if(this.nStarCount=e.m_nGameMode==ge.HIGHERMODE?e.m_oHigher.getGameStars():e.usersData.getGameStars(),!(this.nStarCount<5)){for(var t=1;t<6;t++){var i=this.spRightMenu.getChildByTag(t);i&&i.setVisible(!1)}var n=this.spRightStarMore.getChildByTag(11),s=GamePlatform.isCN()?String.formatC("%03d",this.nStarCount):String.formatC("%02d",this.nStarCount);if(null==n){if(!(n=new l.LabelAtlas(s,"num_white_18.png",18,30,"./0123456789")))return;n.setPosition(GamePlatform.isCN()?190:203,64),this.spRightStarMore.addChild(n,0,11)}else n.setString(s);n.setVisible(!0),this.spRightStarMore.setVisible(!0),this.spTime&&this.nStarCount>=(e.m_nGameMode==ge.HIGHERMODE?e.usersData.getHigherLifeStarByUM():e.usersData.getLifeStarWithTime())&&(this.spTime.setVisible(!1),this.m_spTips&&(this.m_spTips.setPosition(32,12),e.usersData.YSLoseTimes>2&&this.m_spTips.setVisible(!1)))}},showUserHead:function(){var e=wr.getModel(),t=e.usersData;t.setWinNewLevel(!1);var i=t.getOpenedLevel();i>135&&(i=135);var n=e.mapConfig.allLevels[i-1].ptLevelNum;this.spHeadBG=this.createUserHead(l.playerInfo.photo,l.playerInfo.name,n,103)},createUserHead:function(e,t,i,n){if(void 0!=i){var s=new l.Sprite("stage_avatar_single.png");s.setAnchorPoint(.5,0),s.setPosition(i.x,i.y-s.height/2+85),this.mBgLayer.addChild(s,n);var r=e,a=null;return r?(a=Rt.createPhotoSprite(),Rt.loadUserPhoto(r,a)):(a=new l.Sprite("UserHead.png")).setScale(1.2),a&&(a.setPosition(s.width/2,s.height/2),s.addChild(a,-1),s.setScale(.8)),s}},ShowDiscountMenu:function(){var e=wr.getModel(),t=null,i=null;switch(e.usersData.discountSelect){case le.SALE_FIGUREGIRL_10:t="discount_tag_girl.png",i=l.spriteFrameCache.getSpriteFrame(e.isDiscount()?"discount_tag_5zhe.png":"discount_tag_7zhe.png");break;case le.SALE_FIGUREFAT_15:t="discount_tag_fat.png",i=l.spriteFrameCache.getSpriteFrame((e.isDiscount(),"discount_tag_6zhe.png"));break;case le.SALE_FIGUREOLD_15:t="discount_tag_old.png",i=l.spriteFrameCache.getSpriteFrame(e.isDiscount()?"discount_tag_3zhe.png":"discount_tag_7zhe.png");break;case le.SALE_STONE_750_15:case le.SALE_STONE_480_10:t="discount_tag_stone.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_8zhe.png");break;case le.SALE_STONE_300_6:t="discount_tag_stone.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_STONE_150_4:t="discount_tag_stone.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_9zhe.png");break;case le.SALE_STONE_100_2:t="discount_tag_stone.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_6zhe.png");break;case le.SALE_BOMB_4_2:t="discount_tag_bomb.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_BLOOD_4_2:t="discount_tag_blood.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_SPEED_10_2:t="discount_tag_speed.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_6zhe.png");break;case le.SALE_ICE_6_2:t="discount_tag_ice.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_SLOW_6_2:t="discount_tag_slow.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_5zhe.png");break;case le.SALE_PACKAGEPLATINUM_6:t="discount_tag_pack.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_THEME_4_6:t="discount_tag_theme4.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_THEME_5_4:t="discount_tag_theme5.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_THEME_6_6:t="discount_tag_theme6.png",i=l.spriteFrameCache.getSpriteFrame("discount_tag_7zhe.png");break;case le.SALE_LIFE_FOREVER_12:return}var n=nr.share().getWinSize();this.removeChildByTag(G);var s=this.menuItemWithFile(t,kd.MENU_DISCOUNT,l.p(100,50),t);if(i){var r=new l.Sprite(i);r.setPosition(s.width/2,s.height/2),s.addChild(r)}var a=Vd.createWithArray([s]);a.setPosition(.5*n.width-100,n.height-99),this.addChild(a,99,G)},RouletteUpdate:function(){var e=this.getChildByTag(x);if(e){i=l.sequence(l.moveBy(.2,0,-330),l.moveBy(.1,0,30));e.runAction(i)}var t=this.getChildByTag(N);if(t){var i=l.sequence(l.moveBy(.2,0,-330),l.moveBy(.1,0,30));t.runAction(i)}},showFreeStone:function(){var e=this;qu.loadResAsync(Ti,function(){var t=Wa.create();t.setPosition(0,0),t.spTopFrame=null,e.addChild(t,2e3,2e3),t.setShowAdWall()});var t=wr.getModel();t&&(t.bLockMenu=!0)},messageDraw:function(e){},getMessage:function(e){this.showFreeStone()},Stageani2Animate1:function(){wr.getModel().playSoundWithType($.MTTEMPLEHOME);var e=new l.Sprite("stageani_2_temple.png");e.setPosition(l.p(2*he+957,490)),e.setScale(0),this.buildItems.addChild(e,4,1524);var t=l.callFunc(this.Stageani2Animate2.bind(this)),i=l.scaleTo(.08,1.1),n=l.scaleTo(.16,1),s=l.moveBy(.08,0,-80);e.runAction(l.sequence(i,n,s,t));var r=new l.Sprite("stageani_2_temple_shine.png");r.setPosition(.5*e.width,.5*e.height),r.setOpacity(100),e.addChild(r,100);var a=l.fadeTo(2,255),o=l.fadeTo(2,100);r.runAction(l.repeatForever(l.sequence(a,o)));var h=new l.Sprite("stageani_2_temple_shadow.png");h.setPosition(2*he+995,402),h.setScale(0),this.buildItems.addChild(h,4);var d=l.callFunc(this.Stageani2Animate3.bind(this)),c=l.scaleTo(.08,1.1),u=l.scaleTo(.16,1),p=l.fadeOut(.08);h.runAction(l.sequence(c,u,p,l.delayTime(.16),d))},Stageani2Animate2:function(e,t){var i=new l.Sprite("stageani_2_dust.png");i.setPosition(2*he+972,412),this.buildItems.addChild(i,4),i.setScaleX(1.2),i.setScaleY(1.3);var n=l.scaleTo(.33,2),s=l.moveBy(.33,0,20),r=l.spawn(n,s),a=l.fadeOut(.33);i.runAction(l.sequence(r,a))},Stageani2Animate3:function(e,t){var i=new l.Sprite("map_themetag_manor.png");i.setScaleX(0),i.setPosition(2*he+952,334),this.spriteItems.addChild(i,100);var n=l.callFunc(this.Stageani2Animate4.bind(this)),s=l.scaleTo(.17,1),r=l.moveBy(.17,0,-12),a=l.spawn(s,r,n);i.runAction(a)},Stageani2Animate4:function(){wr.getModel().playSoundWithType($.MTUNLOCK)}});Yd.create=function(){return new Yd},Yd.isUsePartRes=function(){return wr.getModel().usersData.getOpenedLevel()<11},Yd.getUsedRes=function(){return this.isUsePartRes()?jt:Xt},Yd.scene=function(){var e=new l.Scene,t=new Yd;return nr.share().scaleScene(t),e.addChild(t,0,1),e.loadData=t.loadData.bind(t),e};var Xd=5e3,jd=5001,Kd=0,qd=1,Qd=2,Zd=3,Jd=4,$d=5,ec=6,tc=7,ic=8,nc=9,sc=10,rc=11,ac=12,oc=13,hc=0,lc=1,dc=2,cc=3,uc=Yd.extend({m_pStorey1:null,m_pStorey2:null,m_pBalloon:null,m_pTree:null,m_spHundred:null,m_spTen:null,m_spSingle:null,m_spScissor:null,m_SkyLayer:null,m_CloudLayer:null,bTouchShare:!1,m_nCurFloor:0,m_nTarFloor:0,m_bDelay:0,m_nState:0,listener:null,_showChangeAction:!1,ctor:function(){this._super(),this.selTowerUpdate=[],this.additionalTowers=[],this.arryBatchTower=[],this.m_nCurFloor=0,this.m_nTarFloor=0,this.m_spHundred=null,this.m_spTen=null,this.m_spSingle=null,this.m_spScissor=null,this.bTouchShare=!1},init:function(){if(l.log("★★★ Storey-init"),this.addLayerName("storey-map"),qu.addRes(this,"res/Themes/LevelSelect/Storey_Common-hd.plist"),!this._super())return!1;var e=wr.getModel();return e.selLayer=this,e.m_nGameMode=ge.HIGHERMODE,e.m_oHigher.randomCurMap(),this.registerWithTouchDispatcher(),this.mScale=.5,nr.share().isIPad()&&(this.mScale=1),this.m_SkyLayer=new l.Layer,this.addChild(this.m_SkyLayer,1),this.m_CloudLayer=new l.Layer,this.addChild(this.m_CloudLayer,2),this.mBgLayer=new l.Layer,this.addChild(this.mBgLayer,3),e.playMuiscWithType($.MTSTARTBGMSC,1,!0),this.m_pBalloon=null,this.loadResources(),l.director.getScheduler().isWaite=!1,!0},onExit:function(){this.listener&&l.eventManager.removeListener(this.listener),qu.clearOwner(this),this._super()},loadData:function(e){var t=wr.getModel();if(dp)if("function"==typeof e){var i=this;Ql.opendaydayup(function(n){n.isopendaydayup?(0==i.m_nState&&(t.m_oHigher._lastPassCount=n.tier+1),t.m_oHigher.m_nPassCount=n.tier+1,t.m_oHigher.setStarCount(n.starcountddu),t.m_oHigher.setWaitTime(n.laststartime),t.m_oHigher.setUseStars(n.cfg.unlocks),t.usersData.setConsumePropPrice(n.shopcfg.props),t.usersData.bIsDayDayUpShared=n.issharedaydayup,t.usersData.resurgencediamondddu=n.resurgencediamondddu,t.m_oHigher.setMaxtier(n.maxtier),t.m_oHigher.m_nSaveStoreyLevel=n.protecttiers,t.m_oHigher.m_bProtected=t.m_oHigher.m_nSaveStoreyLevel>0,i.addMapLevel(),i.addMenuLayer(),i.changeFloor(i.m_nState),e()):qi.preloadWithLoadingTag(Ht,we.MAIN)})}else i.addMapLevel(),i.addMenuLayer();else this.LoadLastRes(t.usersData.getOpenedLevel(),e)},onEnterTransitionDidFinish:function(){this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){var i=this.m_pTree.convertTouchToNodeSpace(e),n=wr.getModel();if(!n.showRewardLayer&&!n.bLockMenu){if(this.m_pBalloon&&l.rectContainsPoint(this.m_pBalloon.getBoundingBox(),i)){var s=this.getChildByTag(19933);if(s&&s.isVisible())return;s=Ia.create(),this.addChild(s,99,19933)}var r=.5;if(nr.share().isIPad()&&(r=1),n.m_oHigher.getGameStars()>=O.STARFULLCOUNT&&this.spRightMenu){var a,o=this.spRightMenu.getContentSize();if(a=0!=this.DisGM||0!=this.DisGS?l.rect(this.spRightMenu.x-o.width,this.spRightMenu.y-o.height,o.width,o.height):l.rect(this.spRightMenu.x-o.width,this.spRightMenu.y-o.height+40*r,o.width,o.height),l.rectContainsPoint(a,i)){var h=this;l.addTimePoint("LifeRequestDlg_s"),qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(2),h.addChild(e,99,19933)})}}}},loadResources:function(){qu.addRes(this,"res/Themes/LevelSelect/Storey1-hd.plist"),qu.addRes(this,"res/Themes/LevelSelect/Storey2-hd.plist");var e=wr.getModel().usersData.m_nLanguage;qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",e));var t=String.formatC("res/Themes%s/LevelSelect/Storey_Common-hd%s.plist",e,e);qu.addRes(this,t);var i=String.formatC("res/Themes%s/LevelSelect/Storey1-hd%s.plist",e,e),n=String.formatC("res/Themes%s/LevelSelect/Storey2-hd%s.plist",e,e);qu.addRes(this,i),qu.addRes(this,n)},addMapLevel:function(){var e=.5;nr.share().isIPad()&&(e=1);var t=nr.share().getWinSize(),i=new l.Sprite("floor_skycolor_p1.png");i.setPosition(t.width/2,(640*e*100+88*e*99)/4),i.setScaleX(t.width/20*e+200),i.setScaleY((640*e*100+88*e*99)/3200*e),this.m_SkyLayer.addChild(i,Kd);var n=new l.Sprite("floor_skycolor_p2.png");n.setPosition(t.width/2,3*(640*e*100+88*e*99)/4),n.setScaleX(t.width/20*e+200),n.setScaleY((640*e*100+88*e*99)/3200*e),this.m_SkyLayer.addChild(n,Kd);var s=wr.getModel();this.loadCloudRes(s.m_oHigher.getPassCount())},menuItemWithFileEx:function(e,t,i,n,s){var r=new l.Sprite(e),a=null;t&&(a=new l.Sprite(t));var o=new l.MenuItemSprite(r,a,null,this,this.menuCallback.bind(this));return o.setTag(i),o.setPosition(n),o},menuCallback:function(e){if(!this.getChildByTag(19933)){this._super(e);var t=wr.getModel(),i=e;if(!t.bLockMenu&&!t.showRewardLayer){n=this;switch(i.getTag()){case 200:if(t.playSoundWithType($.MTPAGESELECT),!t.usersData.isLifeForever()&&t.m_oHigher.getGameStars()<t.m_oHigher.getUsedStar()){var n=this;qu.loadResAsync(xi,function(){n.m_dlg=Qc.create(),n.m_dlg.setOnCloseCallback(n,n.onCloseCallback.bind(n)),n.addChild(n.m_dlg,99)})}else{if(t.m_oHigher.getPassCount()>t.m_oHigher.getMaxtier())return void ju.showLiteralsTip(b.Dialog_Hint5);i.setEnabled(!1),t.m_nGameMode=ge.HIGHERMODE,qi.preloadWithGameScene(),t.playMuiscWithType($.MTSTARTBGMSC,2)}break;case kd.MENU_HOME:t.m_oHigher.HigherExit();break;case kd.MENU_SHARE:s=!t.usersData.bIsDayDayUpShared&&t.m_oHigher.getPassCount()>=5;kl.shareMessage(b.Share_Title6,b.ShareText6,Wl.DAYDAY_SHARE,0,4,null,function(e){e&&s&&n.shareCallBack()}),this.bTouchShare=!0,t.ys_ShareFloor=!0,Tt.onShare(this.getLayerName(),"sina-weibo","share-storey");break;case kd.MENU_KT_SHARE:var s=!t.usersData.bIsDayDayUpShared&&t.m_oHigher.getPassCount()>=5;kl.shareMessage(b.Share_Title6,b.ShareText6,Wl.DAYDAY_SHARE,0,4,null,function(e){e&&s&&n.shareCallBack()})}}}},shareCallBack:function(){var e=this;if(e._shareBtn){var t=e._shareBtn.getChildByTag(21232);t&&t.removeFromParent();var i=GamePlatform.isCN()?GamePlatform.getCurrentPlatForm()==PlatformType.QQ?"floor_btn_share_normal_qq.png":"floor_btn_share_normal_wechat.png":"floor_btn_share_normal.png",n=l.spriteFrameCache.getSpriteFrame(i);n&&e._shareBtn.getNormalImage().setSpriteFrame(n),i=GamePlatform.isCN()?GamePlatform.getCurrentPlatForm()==PlatformType.QQ?"floor_btn_share_pressed_qq.png":"floor_btn_share_pressed_wechat.png":"floor_btn_share_pressed.png";var s=l.spriteFrameCache.getSpriteFrame(i);if(e._shareBtn.getSelectedImage())s&&e._shareBtn.getSelectedImage().setSpriteFrame(s);else{var r=new l.Sprite(s);r.setAnchorPoint(0,0),e._shareBtn.setSelectedImage(r)}e._shareBtn.x=935,e._shareBtn.y=350}},addMapInfo:function(e,t,i,n,s){this.m_pTree=e;var r=.5;nr.share().isIPad()&&(r=1);var a,o=wr.getModel(),h=o.m_oHigher;a=String.formatC("res/Themes/Theme%lu/BG-hd.plist",i),qu.addRes(this,a);var d=new l.Sprite(String.formatC("BG%lu.png",i)),c=d.getTextureRect();d.setTextureRect(l.rect(c.x+88*r,c.y,960*r,590*r)),d.setPosition(568*r,381*r),d.setScale(.47),e.addChild(d,ec),qu.addRes(this,String.formatC("res/Themes/Maps/BG%02lu-hd.plist",t));var u=o.usersData.m_nLanguage;qu.addRes(this,String.formatC("res/Themes%s/Maps/BG%02lu-hd%s.plist",u,t,u));var p=new l.Sprite(String.formatC("Path%lu.png",t)),m=p.getTextureRect();if(p.isTextureRectRotated()){var _=l.rect(m.x,m.y+88*r,590*r,960*r);p.setRotation(-90),p.setTextureRect(_),p.setAnchorPoint(.5,.5),p.setPosition(d.width/2-(640*r-m.height)/2,d.height/2)}else p.setTextureRect(l.rect(m.x+88*r,m.y,960*r,m.height-50*r)),p.setAnchorPoint(0,0),p.setPosition(0,(d.height-p.height)/2);d.addChild(p);var g=new l.Sprite("floor_map_cover.png");g.setPosition(568*r,381*r),e.addChild(g,tc);var T=n,f=null;n>99?(f=new l.Sprite("floor_sign_sbg_100.png"),n-=100):f=new l.Sprite("floor_sign_sbg.png"),f.setPosition(569*r,519*r);var S=new l.LabelAtlas("00","floor_sign_num.png",34,60,"./0123456789");S.setString(String.formatC("%2d",n));var w=T>99?134*r:130*r,v=T>99?86*r:88*r;GamePlatform.isCN()?S.setPosition(w,v):S.setPosition(w-16*r,v),S.setAnchorPoint(.5,.5),f.addChild(S),e.addChild(f,12),h.mapData.towerType||h.randomTowers(!1);var L=h.getCurMapLevel(),M=null,C=new l.LabelAtlas("00","floor_mode_num.png",12,20,"./0123456789");if(C.setAnchorPoint(.5,.5),h.getCurLevelMode()==Rn){M=new l.Sprite("floor_mode_boss.png");y=String.formatC("%lu",L.nBossModeSecond);C.setString(y),GamePlatform.isCN()?C.setPosition(148*r,15*r):C.setPosition(140*r,17*r),M.addChild(C)}else if(h.getCurLevelMode()==Dn)M=new l.Sprite("floor_mode_gate.png");else{M=new l.Sprite("floor_mode_normal.png");var y=String.formatC("%lu",L.nWaves);C.setString(y),GamePlatform.isCN()?C.setPosition(150*r,16*r):C.setPosition(96*r,17*r),M.addChild(C)}M&&(M.setPosition(567*r,224*r),e.addChild(M));var B=L.towerType.length,F=56*B*r+6*(B-1)*r,E=e.width/2-F/2,P=e.height/2-150*r;for(var b in L.towerType){var A=L.towerType[b];if(A){var O=String.formatC("stower_%s.png",o.gameObjectConfig.towerGroup[A].strName),I=l.spriteFrameCache.getSpriteFrame(O);if(I){var R=new l.Sprite(I);R&&(R.setPosition(E+28*r,P),e.addChild(R))}}E+=62*r}var D=this.menuItemWithFileEx("btn_green_b.png","btn_green_b_pressed.png",200,l.p(568*r,99*r),r),x=new l.Sprite("floor_btn_start.png"),N=new l.Sprite(String.formatC("floor_btn_start_%d.png",h.getUsedStar()));x.setPosition(0,0),x.setAnchorPoint(0,0),N.setPosition(12,0),N.setAnchorPoint(0,0),D.addChild(N),D.addChild(x),this._shareBtn=this.showRewardSpr(kd.MENU_SHARE);var G=new l.Menu(D,this._shareBtn);G.setPosition(0,0),e.addChild(G,Jd,8888);var W=new l.Sprite("floor_btn_cover.png");W.setPosition(670*r,56*r),e.addChild(W,$d)},showRewardSpr:function(e){var t=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,i=GamePlatform.isCN()?t?"floor_btn_share_reward_qq.png":"floor_btn_share_reward_wechat.png":"floor_btn_share_reward.png",n=GamePlatform.isCN()?t?"floor_btn_share_normal_qq.png":"floor_btn_share_normal_wechat.png":"floor_btn_share_normal.png",s=GamePlatform.isCN()?t?"floor_btn_share_pressed_qq.png":"floor_btn_share_pressed_wechat.png":"floor_btn_share_pressed.png",r=wr.getModel(),a=r.m_oHigher.getPassCount(),o=!r.usersData.bIsDayDayUpShared&&a>=5,h=this.menuItemWithFileEx(o?i:n,o?"":s,e,l.p(935,o?250:303),1);if(o){var d=new l.LabelAtlas(50,"rankingup_number2.png",28,38,"0123456789x+");d.setAnchorPoint(.5,.5),d.setPosition(.5*h.width-5,.5*h.height),h.addChild(d,1,21232)}return h},changeFloor:function(e){var t=.5;nr.share().isIPad()&&(t=1);var i=wr.getModel(),n=nr.share().getWinSize(),s=null,r=null,a=i.curLevel,o=i.curTheme,h=a,d=o,c=i.m_oHigher._lastPassCount,u=i.m_oHigher.getPassCount();switch(e){case 0:if(1==c)(s=new l.Sprite("floor_bg_base.png")).setPosition(.5*n.width,.5*n.height),this.mBgLayer.addChild(s,Qd),this.mBgLayer.setPosition(0,.5*n.height-s.getPositionY()),this.m_SkyLayer.setPosition(this.mBgLayer.getPosition()),this.addMapInfo(s,a,o,c,e);else{if(i.m_oHigher.isAchievement()){(s=new l.Sprite("floor_bg_circ.png")).setPosition(.5*n.width,.5*n.height+n.height*(c-1)+88*t*(c-1)),this.mBgLayer.addChild(s,Qd),(p=new l.Sprite("floor_bg_end.png")).setPosition(.5*n.width,.5*n.height+n.height*(c-1)+88*t*(c-1)),this.mBgLayer.addChild(p,Qd),this.mBgLayer.setPosition(0,.5*n.height-s.getPositionY()),this.m_SkyLayer.setPosition(this.mBgLayer.getPosition());m=this.showRewardSpr(kd.MENU_KT_SHARE);return(_=new l.Menu(m)).setPosition(0,0),p.addChild(_,Jd,8888),void(this.m_pTree=s)}(s=new l.Sprite(1==u?"floor_bg_base.png":"floor_bg_circ.png")).setPosition(.5*n.width,.5*n.height+n.height*(c-1)+88*t*(c-1)),u>1&&((w=new l.Sprite("floor_cover_stg1.png")).setPosition(.5*s.width,.5*s.height),s.addChild(w,Zd)),this.mBgLayer.addChild(s,Qd),this.mBgLayer.setPosition(0,.5*n.height-s.getPositionY()),this.m_SkyLayer.setPosition(this.mBgLayer.getPosition()),this.addMapInfo(s,h,d,c,e)}this.addBalloon(e);break;case 1:if(h=i.curLevel,d=i.curTheme,i.m_oHigher.randomCurMap(),i.playSoundWithType($.MTFLOORWIN),u==O.DAYDAYUPLEVELCOUNT+1||u>i.m_oHigher.getMaxtier()){(s=new l.Sprite("floor_bg_circ.png")).setPosition(.5*n.width,.5*n.height+n.height*(c-1)+88*t*(c-1)),this.mBgLayer.addChild(s,Qd);var p=new l.Sprite("floor_bg_end.png");p.setPosition(.5*n.width,.5*n.height+n.height*(c-1)+88*t*(c-1)),this.mBgLayer.addChild(p,Qd),this.mBgLayer.setPosition(0,.5*n.height-s.getPositionY()),this.m_SkyLayer.setPosition(this.mBgLayer.getPosition());var m=this.showRewardSpr(kd.MENU_KT_SHARE),_=new l.Menu(m);return _.setPosition(0,0),p.addChild(_,Jd,8888),void(this.m_pTree=s)}if(this.showRollPanel(c,u),(s=new l.Sprite(c-1==0?"floor_bg_base.png":"floor_bg_circ.png")).setPosition(.5*n.width,.5*n.height+n.height*(c-1)+88*t*(c-1)),c>1&&((w=new l.Sprite("floor_cover_stg1.png")).setPosition(.5*s.width,.5*s.height),s.addChild(w,Zd)),this.mBgLayer.addChild(s,Qd),(r=new l.Sprite("floor_bg_circ.png")).setPosition(.5*n.width,.5*n.height+n.height*(u-1)+88*t*(u-1)),(w=new l.Sprite("floor_cover_stg1.png")).setPosition(.5*r.width,.5*r.height),r.addChild(w),this.mBgLayer.addChild(r,Qd),(v=new l.Sprite("floor_bg_mid.png")).setPosition(.5*n.width,n.height*c+88*(c-1)*t+88*t*.5),this.mBgLayer.addChild(v,Qd),this.mBgLayer.setPosition(0,.5*n.height-s.getPositionY()),this.m_SkyLayer.setPosition(this.mBgLayer.getPosition()),this.addMapInfo(s,a,o,c,e),r){var g=l.callFunc(this.addBalloon.bind(this,e)),T=l.sequence(l.moveTo(1.3,0,.5*n.height-r.getPositionY()),g);this.mBgLayer.runAction(T);L=l.sequence(l.moveTo(1.3,0,.5*n.height-r.getPositionY()));this.m_SkyLayer.runAction(L),this.addMapInfo(r,h,d,u,e)}break;case 2:h=i.curLevel,d=i.curTheme,i.m_oHigher.randomCurMap(),c>u&&i.playSoundWithType($.MTFLOORLOSE),(s=new l.Sprite(1==c?"floor_bg_base.png":"floor_bg_circ.png")).setPosition(.5*n.width,.5*n.height+n.height*(c-1)+88*t*(c-1)),this.mBgLayer.addChild(s,Qd),this.mBgLayer.setPosition(0,.5*n.height-s.getPositionY()),this.m_SkyLayer.setPosition(this.mBgLayer.getPosition());for(var f=0;f<c-u;f++){if(u<1)return;if(0==f)(r=new l.Sprite(1==u?"floor_bg_base.png":"floor_bg_circ.png")).setPosition(.5*n.width,.5*n.height+n.height*(u+f-1)+88*t*(u+f-1)),u>1&&((w=new l.Sprite("floor_cover_stg1.png")).setPosition(.5*r.width,.5*r.height),r.addChild(w,Zd)),this.mBgLayer.addChild(r,Qd);else{var S=new l.Sprite(1==u?"floor_bg_base.png":"floor_bg_circ.png");if(S.setPosition(.5*n.width,.5*n.height+n.height*(u+f-1)+88*t*(u+f-1)),u>1){var w=new l.Sprite("floor_cover_stg1.png");w.setPosition(.5*S.width,.5*S.height),S.addChild(w,Zd)}this.addMapInfo(S,a,o,u+f,e),this.mBgLayer.addChild(S,Qd)}var v=new l.Sprite("floor_bg_mid.png");v.setPosition(.5*n.width,n.height*(u+f)+88*(u+f-1)*t+88*t*.5),this.mBgLayer.addChild(v,Qd)}if(c==u?(this.addMapInfo(s,h,d,c,e),this.addBalloon(e)):this.addMapInfo(s,a,o,c,e),r){var g=l.callFunc(this.addBalloon.bind(this,e)),T=l.sequence(l.moveTo(.9+.4*(c-u),0,.5*n.height-r.getPositionY()),g);this.mBgLayer.runAction(T);var L=l.sequence(l.moveTo(.9+.4*(c-u),0,.5*n.height-r.getPositionY()));this.m_SkyLayer.runAction(L),this.showRollPanel(c,u),this.addMapInfo(r,h,d,u,e),l.sys.os===l.sys.OS_IOS&&(this._showChangeAction=!0)}}i.m_oHigher._lastPassCount=i.m_oHigher.getPassCount()},showRollPanel:function(e,t){var i=this;qu.loadResAsync(Pi,function(){qu.addRes(this,"res/Themes/LevelSelect/Storey3-hd.plist"),i.showRollAnim(e,t)})},changeToColor:function(e,t){console.log("changeToColor ");var i=l.shaderCache.programForKey(t?l.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY:l.SHADER_SPRITE_POSITION_TEXTURECOLOR);e.getLocalZOrder()<6e3&&e.setShaderProgram(i);var n=e.getChildren();for(var s in n)this.changeToColor(n[s],t)},showNumAnim:function(e,t,i,n){e&&(this.showOneAnim(this.m_spHundred,e,n,!1,this.m_bDelay),this.m_spHundred=e),t&&(this.showOneAnim(this.m_spTen,t,n,!1,this.m_bDelay),this.m_spTen=t),i&&(this.showOneAnim(this.m_spSingle,i,n,!0,this.m_bDelay),this.m_spSingle=i),this.m_bDelay=!1},showOneAnim:function(e,t,i,n,s){var r=0,a=0;i?(r=130,a=10):(r=-130,a=-10);var o=l.moveBy(.3,0,r+a),h=l.fadeOut(.2),d=l.spawn(o,h),c=l.callFunc(this.cb_removeSprite.bind(this,e)),u=l.moveBy(.3,0,r+a),p=l.moveBy(.1,0,-a),m=null;n&&(m=l.callFunc(this.loopNum.bind(this)));var _=null,g=null,T=l.spawn(u,l.sequence(l.delayTime(.15),l.fadeIn(.2)));if(s){var s=l.delayTime(.5);_=l.sequence(s,d,c);var f=l.delayTime(.5);g=m?l.sequence(f,T,p,m):l.sequence(f,T,p)}else _=l.sequence(d,c),g=m?l.sequence(T,p,m):l.sequence(T,p);e.runAction(_),t.runAction(g)},cb_removeSprite:function(e){e&&e.getParent().removeChild(e)},loopNum:function(){if(this.m_nCurFloor!=this.m_nTarFloor){var e=this.m_nTarFloor-this.m_nCurFloor>0,t=parseInt(this.m_nCurFloor/100),i=parseInt(this.m_nCurFloor%100/10),n=this.m_nCurFloor%10,s=n,r=i,a=t,o=0;if(e){this.m_nCurFloor++,o=-1;var h=n+1;s=h%10,r=parseInt(i+h/10)%10,a=parseInt(t+(i+h/10)/10)}else this.m_nCurFloor--,o=1,s=n-1,0==n&&(s=9,r=i-1,0==i&&(r=9,a=t-1));var d=.5;nr.share().isIPad()&&(d=1);var c=null,u=null,p=String.formatC("floor_bignum_%d.png",s),m=new l.Sprite(p);if(m.setOpacity(0),m.setPosition(299*d,75*d+130*o*d),this.m_spScissor.addChild(m),r!=i){var _=String.formatC("floor_bignum_%d.png",r);(u=new l.Sprite(_)).setOpacity(0),u.setPosition(200*d,75*d+130*o*d),this.m_spScissor.addChild(u)}if(a!=t){var g=String.formatC("floor_bignum_%d.png",a);(c=new l.Sprite(g)).setOpacity(0),c.setPosition(101*d,75*d+130*o*d),this.m_spScissor.addChild(c)}this.showNumAnim(c,u,m,e)}},showRollAnim:function(e,t){if(e!=t){var i=.5;nr.share().isIPad()&&(i=1),wr.getModel().bLockMenu=!0;var n=400*i;this.m_animBase=new l.Sprite,this.m_animBase.setPosition(0,0),this.addChild(this.m_animBase,ic);var s=this.showStarAnim(e,t);this.m_nCurFloor=e,this.m_nTarFloor=t,this.m_bDelay=!0;var r=nr.share().getWinSize(),a=new l.Sprite("floor_bigcounter_bg.png");this.m_animBase.addChild(a,rc),this.m_spScissor=new l.Node,this.m_spScissor.setContentSize(n,150),this.m_spScissor.setAnchorPoint(.5,.5),this.m_spScissor.setPosition(.5*a.width,.5*a.height+10),a.addChild(this.m_spScissor);var o=parseInt(e/100),h=parseInt(e%100/10),d=parseInt(e%10),c=t-e,u=String.formatC("floor_bignum_%d.png",o);this.m_spHundred=new l.Sprite(u),this.m_spHundred.setPosition(101*i,75),this.m_spScissor.addChild(this.m_spHundred);var p=String.formatC("floor_bignum_%d.png",h);this.m_spTen=new l.Sprite(p),this.m_spTen.setPosition(200*i,75),this.m_spScissor.addChild(this.m_spTen);var m=String.formatC("floor_bignum_%d.png",d);this.m_spSingle=new l.Sprite(m),this.m_spSingle.setPosition(299*i,75),this.m_spScissor.addChild(this.m_spSingle),this.loopNum();var _=Math.abs(c)-1,g=0,T=0,f=0;c>0?(g=10,f=-114,T=786):(g=-10,f=786,T=-114),a.setPosition(r.width/2*i,f*i);var S=l.moveTo(.4,r.width/2*i,r.height/2*i-g*i),w=l.moveTo(2+.4*_,r.width/2*i,r.height/2*i+g*i),v=l.moveTo(.4,r.width/2*i,T*i),L=null;s||(L=l.callFunc(this.clearAnim.bind(this)));var M;M=L?l.sequence(S,w,v,L):l.sequence(S,w,v),a.runAction(M);var C=new l.Sprite("floor_bigcounter_cover.png");C.setPosition(0,0),C.setAnchorPoint(0,0),a.addChild(C)}},showStarAnim:function(e,t){if(t-e!=1)return!1;var i=.5;nr.share().isIPad()&&(i=1);var n=new l.Sprite("floor_upstar_small.png");n.setPosition(480*i,-654*i),this.m_animBase.addChild(n,nc);var s=l.moveTo(.46,480*i,1294*i);n.runAction(s);var r=new l.Sprite("floor_upstar_shadow.png");r.setPosition(480*i,-618*i),this.m_animBase.addChild(r,sc);var a=l.delayTime(.4),o=l.moveTo(.9,480*i,1258*i),h=l.sequence(a,o);r.runAction(h),this.showMidStar(),this.showBigStar();var d=new l.Sprite("floor_upstar_shine.png");d.setPosition(480*i,750*i),this.m_animBase.addChild(d,oc);var c=l.delayTime(2.8),u=l.moveTo(.2,480*i,730*i),p=l.moveTo(1.5,480*i,530*i),m=l.fadeOut(1.5),_=l.spawn(p,m,null),g=l.callFunc(this.clearAnim.bind(this)),T=l.sequence(c,u,_,g);return d.runAction(T),!0},clearAnim:function(){this.removeChild(this.m_animBase,!0),wr.getModel().bLockMenu=!1,2==this.m_nState&&l.sys.os===l.sys.OS_IOS&&(this._showChangeAction=!1),this.addLostBalloon()},showMidStar:function(){var e=.5;nr.share().isIPad()&&(e=1);for(var t=0,i=[582,293,934,420,177,487,835,325,598,1015,127,751,393,878,1036,616,247,928,361,758,187,448,1034,908,698,93,378,805,448,202,976,636,588,372,904,150,770,1040,463,259],n=[.4,.01,.03,.02,.03,.03,.01,.03,.02,.03,0,.02,.03,.03,.02,.01,.02,.01,.03,.02,.01,.04,.02,.02,.01,.02,.02,.03,.01,.02,.05,.02,.03,.01,.05,.02,.05,.02,.03,.04],s=0;s<40;s++){var r=new l.Sprite("floor_upstar_mid.png");r.setPosition(i[s]*e,-220*e),this.m_animBase.addChild(r,ac),t+=n[s];var a=l.delayTime(t),o=l.moveTo(.16,i[s]*e,860*e),h=l.sequence(a,o);r.runAction(h)}},showBigStar:function(){var e=.5;nr.share().isIPad()&&(e=1);for(var t=0,i=[713,237,864,473,146,445,924,666,957,238,859,480,923,287,674],n=[.6,.02,.06,.03,.1,.04,.02,.08,.1,.01,.05,.03,.13,.05,.03],s=0;s<15;s++){var r=new l.Sprite("floor_upstar_mid.png");r.setPosition(i[s]*e,-310*e),this.m_animBase.addChild(r,oc),t+=n[s];var a=l.delayTime(t),o=l.moveTo(.33,i[s]*e,950*e),h=l.sequence(a,o);r.runAction(h)}},addBalloon:function(e){var t=.5;nr.share().isIPad()&&(t=1);var i=wr.getModel(),n=i.m_oHigher.getPassCount();if(!(n<11)){var s=i.m_oHigher.getDownLimite();if(0!=s){var r=this.m_pTree.getChildByTag(lc);r||((r=new l.Sprite("floor_balloon_line.png")).setPosition(114*t+88,205*t),this.m_pTree.addChild(r,Zd,lc));var a=this.m_pTree.getChildByTag(dc);if(a){var o=a.getChildByTag(1),h=l.spriteFrameCache.getSpriteFrame(String.formatC("floor_balloon_%d.png",s));o.setSpriteFrame(h),this.m_pBalloon.stopActionByTag(cc)}else(a=new l.Sprite("floor_balloon_tied.png")).setPosition(80*t+88,312*t),this.m_pTree.addChild(a,Zd,dc),(o=new l.Sprite(String.formatC("floor_balloon_%d.png",s))).setPosition(a.width/2,a.height/2),a.addChild(o),o.setTag(1);this.m_pBalloon=a;var d=l.repeatForever(l.sequence(l.moveBy(1,-5,10),l.moveBy(2,5,-10)));d.setTag(cc),a.runAction(d);for(var c=[11,21,31,41,51,61,71,81,91,101,111,121,131,141],u=0;u<c.length;u++)if(n==c[u]&&s<=n-11){var p=this.getChildByTag(19933);if(p&&p.isVisible())return;p=Ia.create(),this.addChild(p,99,19933)}}else{this.m_pBalloon=new l.Sprite("floor_balloon_float.png"),this.m_pBalloon.setPosition(55*t+88,-20*t),this.m_pTree.addChild(this.m_pBalloon,Zd,hc);var m=l.callFunc(this.balloonRepRun.bind(this,this.m_pBalloon));this.m_pBalloon.runAction(l.sequence(l.moveTo(2,l.p(55*t+88,237*t)),m))}}},addLostBalloon:function(){var e=wr.getModel(),t=.5;nr.share().isIPad()&&(t=1);var i=e.m_oHigher.getPassCount();if(!(i<11)){for(var n=e.m_oHigher.getDownLimite(),s=[11,21,31,41,51,61,71,81,91,101,111,121,131,141],r=0;r<s.length;r++)if(i==s[r]&&n<=i-11){var a=this.getChildByTag(19933);if(a&&a.isVisible())return;a=Ia.create(),this.addChild(a,99,19933)}if(i==n+1&&2==this.m_nState){e.playSoundWithType($.MTBALLOON);var o=88,h=new l.Sprite("floor_balloon_up.png");h.setPosition(o,-300*t),this.m_pTree.addChild(h,100),h.runAction(l.moveTo(1.5,l.p(88,940*t))),l.sys.os===l.sys.OS_IOS&&h.setShaderProgram(l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR));var d=new l.Sprite("floor_balloon_up.png");d.setPosition(o+320*t,-300*t),this.m_pTree.addChild(d,100),d.runAction(l.sequence(l.delayTime(.2),l.moveTo(.7,l.p(o+320*t,940*t)))),l.sys.os===l.sys.OS_IOS&&d.setShaderProgram(l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR));var c=new l.Sprite("floor_balloon_up.png");c.setPosition(o+960*t,-300*t),this.m_pTree.addChild(c,100),c.runAction(l.sequence(l.delayTime(.2),l.moveTo(1,l.p(o+960*t,940*t)))),l.sys.os===l.sys.OS_IOS&&c.setShaderProgram(l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR));var u=new l.Sprite("floor_balloon_up.png");u.setPosition(o+480*t,-300*t),this.m_pTree.addChild(u,100),u.runAction(l.sequence(l.delayTime(.4),l.moveTo(.9,l.p(o+480*t,940*t)))),l.sys.os===l.sys.OS_IOS&&u.setShaderProgram(l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR));var p=new l.Sprite("floor_balloon_up.png");p.setPosition(o+800*t,-300*t),this.m_pTree.addChild(p,100),p.runAction(l.sequence(l.delayTime(.5),l.moveTo(.7,l.p(o+800*t,940*t)))),l.sys.os===l.sys.OS_IOS&&p.setShaderProgram(l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR));var m=new l.Sprite("floor_balloon_up.png");m.setPosition(o+160*t,-300*t),this.m_pTree.addChild(m,100),m.runAction(l.sequence(l.delayTime(.6),l.moveTo(.8,l.p(o+160*t,940*t)))),l.sys.os===l.sys.OS_IOS&&m.setShaderProgram(l.shaderCache.programForKey(l.SHADER_POSITION_TEXTURECOLOR))}}},buyStayFloor:function(){this.removeChildByTag(19933),this.m_pTree.removeChildByTag(hc),this.addBalloon(1);wr.getModel()},balloonRepRun:function(e){if(e){var t=wr.getModel();e.runAction(l.repeatForever(l.sequence(l.moveBy(1,0,10),l.moveBy(2,0,-10))));for(var i=t.m_oHigher.getPassCount(),n=t.m_oHigher.getDownLimite(),s=[11,21,31,41,51,61,71,81,91,101,111,121,131,141],r=0;r<s.length;r++)if(i==s[r]&&n<=i-11){var a=this.getChildByTag(19933);if(a&&a.isVisible())return;a=Ia.create(),this.addChild(a,99,19933)}}},loadCloudRes:function(e){var t=[];e>=1&&e<20?t.push(Ki("res/Themes/LevelSelect/Floor_cloud_1-hd.plist")):e>=20&&e<40?(t.push(Ki("res/Themes/LevelSelect/Floor_cloud_2_1-hd.plist")),t.push(Ki("res/Themes/LevelSelect/Floor_cloud_2_2-hd.plist")),t.push(Ki("res/Themes/LevelSelect/Floor_cloud_2_3-hd.plist"))):e>=40&&e<60?t.push(Ki("res/Themes/LevelSelect/Floor_cloud_3-hd.plist")):e>=60&&e<80?(t.push(Ki("res/Themes/LevelSelect/Floor_cloud_4_1-hd.plist")),t.push(Ki("res/Themes/LevelSelect/Floor_cloud_4_2-hd.plist"))):e>=80&&e<=150&&t.push(Ki("res/Themes/LevelSelect/Floor_cloud_5-hd.plist"));var i=this;qu.loadResAsync(t,function(){i.addCloudBg(e)})},addCloudBg:function(e){var t=.5;nr.share().isIPad()&&(t=1);var i=nr.share().getMapOffset(),n=0;88!=i.width&&(n=-88);var s=null,r=null,a=null;if(e>=1&&e<20){qu.addRes(this,"res/Themes/LevelSelect/Floor_cloud_1-hd.plist"),s=new l.Sprite,(y=new l.Sprite("floor_ani_stg1_1.png")).setPosition(n*t+949*t-150*(e-1)*t,327*t),y.runAction(l.repeatForever(l.sequence(l.moveTo(y.width/25,l.p(y.x-y.width,327*t)),l.moveTo(.01,y.getPosition())))),s.addChild(y),(B=new l.Sprite("floor_ani_stg1_1.png")).setPosition(n*t+949*t-150*(e-1)*t+B.width,327*t),B.runAction(l.repeatForever(l.sequence(l.moveTo(y.width/25,l.p(B.x-y.width,327*t)),l.moveTo(.01,B.getPosition())))),s.addChild(B),a=new l.Sprite;var o=new l.Sprite("floor_ani_stg1_2.png");o.setPosition(n*t+821*t-80*(e-1)*t,330*t),o.runAction(l.repeatForever(l.sequence(l.moveTo(o.width/10,l.p(o.x-o.width,330*t)),l.moveTo(.01,o.getPosition())))),a.addChild(o);var h=new l.Sprite("floor_ani_stg1_2.png");h.setPosition(n*t+949*t-80*(e-1)*t+h.width,330*t),h.runAction(l.repeatForever(l.sequence(l.moveTo(h.width/10,l.p(h.x-h.width,330*t)),l.moveTo(.01,h.getPosition())))),a.addChild(h)}else if(e>=20&&e<40){qu.addRes(this,"res/Themes/LevelSelect/Floor_cloud_2_1-hd.plist"),qu.addRes(this,"res/Themes/LevelSelect/Floor_cloud_2_2-hd.plist"),qu.addRes(this,"res/Themes/LevelSelect/Floor_cloud_2_3-hd.plist"),s=new l.Sprite,(y=new l.Sprite("floor_ani_stg1_4.png")).setPosition(n*t+557*t-0*t,678*t-70*(e-21)*t),y.runAction(l.repeatForever(l.sequence(l.moveTo(y.height/25,y.x,y.y-y.height),l.moveTo(.01,y.getPosition())))),y.runAction(l.repeatForever(l.sequence(l.moveBy(3,40,0),l.moveBy(3,-40,0)))),s.addChild(y),(B=new l.Sprite("floor_ani_stg1_4.png")).setPosition(n*t+557*t-0*t,678*t-70*(e-21)*t+B.height),B.runAction(l.repeatForever(l.sequence(l.moveTo(B.height/25,B.x,B.y-B.height),l.moveTo(.01,B.getPosition())))),B.runAction(l.repeatForever(l.sequence(l.moveBy(3,40,0),l.moveBy(3,-40,0)))),s.addChild(B),r=new l.Sprite;var d=new l.Sprite("floor_ani_stg1_5.png");d.setPosition(n*t+557*t-0*t,678*t-50*(e-21)*t),d.runAction(l.repeatForever(l.sequence(l.moveTo(d.height/20,l.p(d.x,d.y-d.height)),l.moveTo(.01,d.getPosition())))),d.runAction(l.repeatForever(l.sequence(l.moveBy(3,-40,0),l.moveBy(3,40,0)))),r.addChild(d);var c=new l.Sprite("floor_ani_stg1_5.png");c.setPosition(n*t+557*t-0*t,678*t-50*(e-21)*t+c.height),c.runAction(l.repeatForever(l.sequence(l.moveTo(c.height/20,l.p(c.x,c.y-c.height)),l.moveTo(.01,c.getPosition())))),c.runAction(l.repeatForever(l.sequence(l.moveBy(3,-40,0),l.moveBy(3,40,0)))),r.addChild(c),a=new l.Sprite;for(var u=new l.Sprite("floor_ani_stg1_3.png"),p=0;p<150*t*(e-20)%u.height+2;p++)(u=new l.Sprite("floor_ani_stg1_3.png")).setPosition(n*t+568*t,p*u.height+684*t-150*(e-21)*t),a.addChild(u)}else if(e>=40&&e<60){qu.addRes(this,"res/Themes/LevelSelect/Floor_cloud_3-hd.plist"),s=new l.Sprite,(y=new l.Sprite("floor_ani_stg1_6.png")).setPosition(n*t+949*t-150*(e-40)*t,327*t),y.runAction(l.repeatForever(l.sequence(l.moveTo(y.width/25,y.x-y.width,327*t),l.moveTo(.01,y.getPosition())))),s.addChild(y),(B=new l.Sprite("floor_ani_stg1_6.png")).setPosition(n*t+949*t-150*(e-40)*t+B.width,327*t),B.runAction(l.repeatForever(l.sequence(l.moveTo(B.width/25,B.x-y.width,327*t),l.fadeOut(.01),l.moveTo(.01,B.getPosition())))),s.addChild(B);var m=null,_=null,g=null,T=null,f=null,S=null,w=null,v=new l.Sprite("font_light_1.png");v.setPosition(i.width+12*t,490*t),v.setOpacity(128),s.addChild(v),m=l.scaleTo(1.6,1.25),_=l.fadeTo(1.6,255),g=l.scaleTo(1.6,1),T=l.fadeTo(1.6,128),w=l.sequence(l.spawn(m,_),l.spawn(g,T)),v.runAction(l.repeatForever(w));var L=new l.Sprite("font_light_2.png");L.setPosition(i.width+12*t,490*t),L.setOpacity(128),s.addChild(L),m=l.scaleTo(1.3,1.5),_=l.fadeTo(1.3,76.5),g=l.scaleTo(1.3,1),T=l.fadeTo(1.3,128),w=l.sequence(l.spawn(m,_),l.spawn(g,T)),L.runAction(l.repeatForever(w));var M=new l.Sprite("font_light_1.png");M.setPosition(i.width+17*t,428*t),M.setScale(1.4),s.addChild(M),_=l.fadeTo(3.3,178.5),f=l.moveTo(3.3,i.width-13*t,428*t),T=l.fadeTo(3.3,255),S=l.moveTo(3.3,i.width+17*t,428*t),w=l.sequence(l.spawn(f,_),l.spawn(S,T)),M.runAction(l.repeatForever(w));var C=new l.Sprite("font_light_2.png");C.setPosition(i.width+42*t,490*t),C.setOpacity(128),s.addChild(C),f=l.moveTo(2,i.width+12*t,490*t),S=l.moveTo(2,i.width+42*t,490*t),w=l.sequence(f,S),C.runAction(l.repeatForever(w))}else if(e>=60&&e<80){qu.addRes(this,"res/Themes/LevelSelect/Floor_cloud_4_1-hd.plist"),qu.addRes(this,"res/Themes/LevelSelect/Floor_cloud_4_2-hd.plist"),s=new l.Sprite;var y=new l.Sprite("floor_ani_stg1_8.png");y.setPosition(n*t+557*t-0*t,678*t-70*(e-61)*t),y.runAction(l.repeatForever(l.sequence(l.moveTo(y.height/25,y.x,y.y-y.height),l.moveTo(.01,y.getPosition())))),y.runAction(l.repeatForever(l.sequence(l.moveBy(3,40,0),l.moveBy(3,-40,0)))),s.addChild(y);var B=new l.Sprite("floor_ani_stg1_8.png");B.setPosition(n*t+557*t-0*t,678*t-70*(e-61)*t+B.height),B.runAction(l.repeatForever(l.sequence(l.moveTo(B.height/25,B.x,B.y-B.height),l.moveTo(.01,B.getPosition())))),B.runAction(l.repeatForever(l.sequence(l.moveBy(3,40,0),l.moveBy(3,-40,0)))),s.addChild(B),a=new l.Sprite;for(var u=new l.Sprite("floor_ani_stg1_7.png"),p=0;p<70*(e-60)*t%u.height+2;p++)(u=new l.Sprite("floor_ani_stg1_7.png")).setPosition(n*t+568*t,p*u.height-70*(e-61)*t+684*t),a.addChild(u)}else if(e>=80&&e<=150){e>101&&(e=101),qu.addRes(this,"res/Themes/LevelSelect/Floor_cloud_5-hd.plist"),s=new l.Sprite;var F=new l.Sprite("floor_ani_stg1_10.png");F.setPosition(n*t+568*t,25*-(e-80)*t+352*t),s.addChild(F),a=new l.Sprite,(u=new l.Sprite("floor_ani_stg1_9.png")).setPosition(n*t+568*t,320*t),a.addChild(u)}a&&this.m_CloudLayer.addChild(a,qd),r&&this.m_CloudLayer.addChild(r,qd),s&&this.m_CloudLayer.addChild(s,qd)},weiboCallBack:function(){var e=wr.getModel();if(e.m_oHigher.getPassCount()>=4&&this.bTouchShare){if(!(e=wr.getModel()).usersData.bIsDayDayUpShared){e.usersData.bIsDayDayUpShared=!0,e.usersData.addDiamond(200,!0);var t=ha.create();this.addChild(t,9998),t.setTextStyle(kr),Tt.onReward("weibo-story-login",1)}var i=.5;nr.share().isIPad()&&(i=1);var n=this.m_pTree.getChildByTag(8888);if(n){var s=n.getChildByTag(Yh);s.setPosition(935*i,303*i);var r=l.spriteFrameCache.getSpriteFrame("floor_btn_share_normal.png");s.getNormalImage().setSpriteFrame(r);var a=l.spriteFrameCache.getSpriteFrame("floor_btn_share_pressed.png");if(s.getSelectedImage())s.getSelectedImage().setSpriteFrame(a);else{var o=new l.Sprite(a);o.setAnchorPoint(.5,.5),s.setSelectedImage(o),s.getNormalImage().setAnchorPoint(.5,.5),s.getNormalImage().setPosition(o.getPosition())}}this.bTouchShare=!1}},shareOver:function(){var e=wr.getModel();if(!e.usersData.bIsDayDayUpShared){e.usersData.bIsDayDayUpShared=!0,e.usersData.addDiamond(200,!0);var t=ha.create();this.addChild(t,9998),t.setTextStyle(kr),Tt.onReward("weibo-story-login",1)}var i=.5;nr.share().isIPad()&&(i=1);var n=this.m_pTree.getChildByTag(8888);if(n){var s=n.getChildByTag(Yh);s.setPosition(935*i,303*i);var r=l.spriteFrameCache.getSpriteFrame("floor_btn_share_normal.png");s.getNormalImage().setSpriteFrame(r);var a=l.spriteFrameCache.getSpriteFrame("floor_btn_share_pressed.png");if(s.getSelectedImage())s.getSelectedImage().setSpriteFrame(a);else{var o=new l.Sprite(a);o.setAnchorPoint(.5,.5),s.setSelectedImage(o),s.getNormalImage().setAnchorPoint(.5,.5),s.getNormalImage().setPosition(o.getPosition())}}},keyBackClicked:function(){var e=wr.getModel();e.bLockMenu||(e.m_oHigher.HigherExit(),e.playSoundWithType($.MTMENUSELECT),qi.preloadWithLoadingTag(Ht,we.MAIN),e.bBackMainScene=!0)},onCloseCallback:function(){this.m_dlg=null}});uc.scene=function(e){var t=new l.Scene,i=new uc;return i.m_nState=e,t.loadData=i.loadData.bind(i),nr.share().scaleScene(i),t.addChild(i,0,1),t},uc.create=function(){return new uc};var pc={ITEM_LIGHT:0,ITEM_ROULETTE:1,ITEM_ROULETTE_MISTINESS:2,ITEM_MENU:3,ITEM_ROURED:4,ITEM_WIN:5,ITEM_START_BG:6,ITEM_ADDSTONE:7,ITEM_STONETEXT:8,ITEM_WAIT:9,ITEM_FREEPLAY:10,ITEM_SHARE:11,ITEM_BIGWINBG:12,ITEM_BIGWINWHITE:13},mc={PRIZE_WITH_STONE1888:0,PRIZE_WITH_STONE999:1,PRIZE_WITH_STONE666:2,PRIZE_WITH_STONE66:3,PRIZE_WITH_BOMB2:4,PRIZE_WITH_SPEED6:5,PRIZE_WITH_ICE3:6,PRIZE_WITH_SLOW3:7},_c=Zs.extend({m_bOnRotating:!1,m_bOnExtraPlay:!1,spStoneShop:null,mMoveLength:0,m_nPrizeStyle:0,m_fAngleLast:0,lableStoneCount:null,costdiamond:50,listener:null,m_bState:0,_angle1:0,ctor:function(){this._super(Ks.DT_TAB),this.addLayerName("dlg-roulette")},onExit:function(){this.getParent()&&this.getParent().RouletteUpdate(),this.removeAllChildrenWithCleanup(!0),l.eventManager.removeListener(this.listener),qu.clearOwner(this),this._super()},addChildItems:function(){this.registerWithTouchDispatcher();var e=wr.getModel(),t=new l.Sprite("stone_bg.png");t.setPosition(110,478),this.spMainFrame.addChild(t,99);var i=new l.Sprite("stone_add.png");i.setPosition(169,486),i.setTag(pc.ITEM_ADDSTONE),this.spMainFrame.addChild(i,99);var n=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,s=GamePlatform.isCN()?n?"themeaward_share_qq.png":"themeaward_share_wechat.png":"themeaward_share.png",r=new l.Sprite(s);r.setPosition(12,268),r.setTag(pc.ITEM_SHARE),this.spMainFrame.addChild(r,2);var a=e.usersData.getDiamond();this.lableStoneCount=new l.LabelAtlas("0000","num_white_18.png",18,30,"./0123456789"),this.lableStoneCount.setString(a.toString()),this.lableStoneCount.setPosition(60,470),this.spMainFrame.addChild(this.lableStoneCount,111,pc.ITEM_STONETEXT);var o=new l.Sprite("wheel_mainbg.png");o.setPosition(410,275),this.spMainFrame.addChild(o);var h=new l.Sprite("wheel_shine_1.png");h.setPosition(412,275),h.setTag(pc.ITEM_LIGHT),this.spMainFrame.addChild(h);var d=[];d.push(l.spriteFrameCache.getSpriteFrame("wheel_shine_1.png")),d.push(l.spriteFrameCache.getSpriteFrame("wheel_shine_2.png"));var c=new l.Animation(d,.2);h.runAction(l.repeatForever(l.animate(c)));var u=new l.Sprite("wheel_thewheel.png");u.setPosition(412,275),u.setTag(pc.ITEM_ROULETTE),this.spMainFrame.addChild(u,2);var p=new l.Sprite("wheel_spin.png");p.setPosition(412,275),p.setTag(pc.ITEM_ROULETTE_MISTINESS),p.setOpacity(0),this.spMainFrame.addChild(p,2);var m=new l.Sprite("wheel_start_bg.png");m.setPosition(412,275),m.setTag(pc.ITEM_START_BG),this.spMainFrame.addChild(m,2);var _=this.spMainFrame.getBoundingBox(),g=null;g=e.m_bFeast&&e.m_oFeast.getCurFeastType()==mn?this.menuItemWithFile("wheel_startdiscount_normal.png",D,l.p(.503*_.width,.5*_.height),"wheel_startdiscount_pressed.png",null):this.menuItemWithFile("wheel_start_normal.png",D,l.p(.503*_.width,.5*_.height),"wheel_start_pressed.png",null);var T=new l.Menu(g);T.setPosition(0,0),T.setTag(pc.ITEM_MENU),this.spMainFrame.addChild(T,2);var f=new l.Sprite("wheel_mainframe.png");f.setPosition(412,274),this.spMainFrame.addChild(f,2);var S=this;qu.loadResAsync(Ti,function(){S.spStoneShop=Wa.create(),S.spStoneShop.setPosition(0,-1800),S.spStoneShop.spTopFrame=S.spMainFrame,S.addChild(S.spStoneShop)}),this.sendOpen()},sendOpen:function(){var e=this;wr.getModel().usersData;Ql.openRotaryTable(function(t){e.costdiamond=t.cfg.costdiamond})},sendStartRotation:function(){var e=this,t=wr.getModel().usersData;Ql.RotaryTableBeganToTurn(function(i){t.setDiamond(i.dm),e.changeStoneCount(),e.setReward(i.rewardid),e.beganRotate(),t.setPropByPropid(i.propid,i.count)})},loadResources:function(){qu.addRes(this,"res/Themes/LevelSelect/Roulette-hd.plist");var e=wr.getModel().usersData.m_nLanguage,t=String.formatC("res/Themes%s/LevelSelect/Roulette-hd%s.plist",e,e.toString());qu.addRes(this,t)},registerWithTouchDispatcher:function(){this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){if(this.isBusy)return!0;this.mMoveLength=0;var i=this.spMainFrame.convertTouchToNodeSpace(e),n=this.spMainFrame.getChildByTag(pc.ITEM_ADDSTONE);if(n){var s=n.getContentSize(),r=l.rect(n.x-s.width/2,n.y-s.height/2,s.width,s.height);if(l.rectContainsPoint(r,i))return n.setScale(1.1),!0}var a=this.spMainFrame.getChildByTag(pc.ITEM_SHARE);if(a){var o=a.getContentSize(),h=l.rect(a.x-o.width/2,a.y-o.height/2,o.width,o.height);if(l.rectContainsPoint(h,i))return a.setScale(1.1),!0}return!0},ccTouchMoved:function(e,t){if(!this.isBusy){var i=this.convertTouchToNodeSpace(e),n=e.getPreviousLocationInView();n=l.director.convertToGL(n),n=this.convertToNodeSpace(n);var s=l.pSub(i,n);if(this.mMoveLength+=-s.x,this.mMoveLength>=5||this.mMoveLength<=-5){var r=this.spMainFrame.getChildByTag(pc.ITEM_ADDSTONE);r&&r.setScale(1);var a=this.spMainFrame.getChildByTag(pc.ITEM_SHARE);a&&a.setScale(1)}}},ccTouchEnded:function(e,t){if(!this.isBusy){nr.share().isIPad()&&1;var i=wr.getModel();if(!i.showRewardLayer){var n=this.spMainFrame.convertTouchToNodeSpace(e),s=this.spMainFrame.getChildByTag(pc.ITEM_ADDSTONE),r=this.spMainFrame.getChildByTag(pc.ITEM_STONETEXT),a=this;if(s){var o=s.getContentSize(),h=l.rect(s.x-o.width/2,s.y-o.height/2,o.width,o.height);if(l.rectContainsPoint(h,n)){i.playSoundWithType($.MTPAGESELECT),s.setScale(1);var d=this.spMainFrame.getPosition(),c=l.moveTo(.1,d.x,d.y+30),u=l.moveTo(.2,d.x,d.y+670);this.spMainFrame.runAction(l.sequence(c,u));var p=l.moveTo(.2,0,-30),m=l.moveTo(.1,0,0),_=l.callFunc(function(){a.spStoneShop.showPrice()}.bind(a,a.spStoneShop));return void this.spStoneShop.runAction(l.sequence(p,m,_))}}r.getContentSize();var g=l.rect(r.x-4,r.y-6,82,38);if(l.rectContainsPoint(g,n)){i.playSoundWithType($.MTPAGESELECT);var d=this.spMainFrame.getPosition(),c=l.moveTo(.1,d.x,d.y+30),u=l.moveTo(.2,d.x,d.y+670);this.spMainFrame.runAction(l.sequence(c,u));var p=l.moveTo(.2,0,-30),m=l.moveTo(.1,0,0),_=l.callFunc(function(){a.spStoneShop.showPrice()}.bind(a,a.spStoneShop));this.spStoneShop.runAction(l.sequence(p,m,_))}else{var T=this.spMainFrame.getChildByTag(pc.ITEM_SHARE);if(T){var f=T.getContentSize(),S=l.rect(T.x-f.width/2,T.y-f.height/2,f.width,f.height);if(l.rectContainsPoint(S,n))return i.playSoundWithType($.MTPAGESELECT),GamePlatform.getCurrentPlatForm()==PlatformType.QQ?kl.shareScreenshot(Wl.REWARD_SHARE):kl.shareMessage(null,"",Wl.REWARD_SHARE,0,1,null),Tt.onShare("sina-weibo","roulette"),void T.setScale(1)}}}}},menuCallback:function(e){nr.share().isIPad();var t=wr.getModel();if(!t.bNoStoneDlgOpen&&!t.showRewardLayer)switch(e.getTag()){case D:if(this.m_bOnRotating)return;if(this.m_bOnExtraPlay){t.playSoundWithType($.MTPAGESELECT),(u=this.spMainFrame.getChildByTag(pc.ITEM_START_BG))&&u.runAction(l.fadeIn(.2)),(p=this.spMainFrame.getChildByTag(pc.ITEM_MENU))&&p.runAction(l.fadeIn(.2)),(m=this.spMainFrame.getChildByTag(pc.ITEM_ROURED))&&m.runAction(l.fadeOut(.2));var i=this.spMainFrame.getChildByTag(pc.ITEM_WIN);if(i){var n=l.callFunc(this.clickWinBtn,this,i),s=l.sequence(l.fadeOut(.2),n);i.runAction(s)}if(this.m_nPrizeStyle==mc.PRIZE_WITH_STONE1888||this.m_nPrizeStyle==mc.PRIZE_WITH_STONE999||this.m_nPrizeStyle==mc.PRIZE_WITH_STONE666){var r=this.getChildByTag(pc.ITEM_BIGWINBG);r&&r.setVisible(!1);var a=this.spMainFrame.getChildByTag(pc.ITEM_LIGHT);if(a){a.stopAllActions();var o=[];o.push(l.spriteFrameCache.getSpriteFrame("wheel_shine_1.png")),o.push(l.spriteFrameCache.getSpriteFrame("wheel_shine_2.png"));var h=new l.Animation(o,.2);a.runAction(l.repeatForever(l.animate(h)))}}return void(this.m_bOnExtraPlay=!1)}var d=0,c=$.MTROULETTEROCK;if(1==this.m_bState)this.m_bState=2,t.usersData.setRoulettePlayed(),c=$.MTROULETTESTART,this.spMainFrame.getChildByTag(pc.ITEM_FREEPLAY)&&this.spMainFrame.removeChildByTag(pc.ITEM_FREEPLAY);else{if(d=this.costdiamond,t.m_bFeast&&t.m_oFeast.getCurFeastType()==mn&&(d=1+t.m_oFeast.getRouletteCutOff()),t.usersData.getDiamond()<d)return t.playSoundWithType($.MTPAGESELECT),void(t.usersData.enablepay?this.addNoStoneDlg():ju.alert(GamePlatform.isCN()?b.Dialog_Hint:"The gem is not enough to be Trade！"));c=$.MTROULETTESTART}this.setBusyTag(!0),this.m_bOnRotating=!0,t.playSoundWithType(c);var u=this.spMainFrame.getChildByTag(pc.ITEM_START_BG);u&&(u.stopAllActions(),u.setOpacity(0));var p=this.spMainFrame.getChildByTag(pc.ITEM_MENU);p&&(p.stopAllActions(),p.setOpacity(0));var m=this.spMainFrame.getChildByTag(pc.ITEM_ROURED);m||((m=new l.Sprite("wheel_win_bg.png")).setPosition(412,275),m.setTag(pc.ITEM_ROURED),this.spMainFrame.addChild(m,1)),m.stopAllActions(),m.setVisible(!0),m.setOpacity(255),m.setScale(.1),m.runAction(l.scaleTo(.2,1));var _=this.spMainFrame.getChildByTag(pc.ITEM_WAIT);_||((_=new l.Sprite("wheel_win_wait.png")).setPosition(412,275),_.setTag(pc.ITEM_WAIT),this.spMainFrame.addChild(_,1)),_.stopAllActions(),_.setVisible(!0),_.setScale(1.5),_.runAction(l.scaleTo(.2,1)),dp?this.sendStartRotation():(t.usersData.addDiamond(-d),this.changeStoneCount(),this.randomStyle(),this.beganRotate())}},randomStyle:function(){var e=wr.getModel().usersData.GetRoulettePermillage(),t=F()%e;if(this._angle1=0,t<2)this._angle1=315,this.m_nPrizeStyle=mc.PRIZE_WITH_STONE1888;else if(t<8)this._angle1=225,this.m_nPrizeStyle=mc.PRIZE_WITH_STONE999;else if(t<23)this._angle1=135,this.m_nPrizeStyle=mc.PRIZE_WITH_STONE666;else if(t<60)this._angle1=45,this.m_nPrizeStyle=mc.PRIZE_WITH_STONE66;else{var i=(e-60)/4;t<60+i?(this._angle1=0,this.m_nPrizeStyle=mc.PRIZE_WITH_BOMB2):t<60+2*i?(this._angle1=270,this.m_nPrizeStyle=mc.PRIZE_WITH_SPEED6):t<60+3*i?(this._angle1=90,this.m_nPrizeStyle=mc.PRIZE_WITH_ICE3):(this._angle1=180,this.m_nPrizeStyle=mc.PRIZE_WITH_SLOW3)}},setReward:function(e){switch(this._angle1=0,e){case 7:this._angle1=315,this.m_nPrizeStyle=mc.PRIZE_WITH_STONE1888;break;case 1:this._angle1=225,this.m_nPrizeStyle=mc.PRIZE_WITH_STONE999;break;case 3:this._angle1=135,this.m_nPrizeStyle=mc.PRIZE_WITH_STONE666;break;case 5:this._angle1=45,this.m_nPrizeStyle=mc.PRIZE_WITH_STONE66;break;case 6:this._angle1=0,this.m_nPrizeStyle=mc.PRIZE_WITH_BOMB2;break;case 8:this._angle1=270,this.m_nPrizeStyle=mc.PRIZE_WITH_SPEED6;break;case 2:this._angle1=90,this.m_nPrizeStyle=mc.PRIZE_WITH_ICE3;break;case 4:this._angle1=180,this.m_nPrizeStyle=mc.PRIZE_WITH_SLOW3}},beganRotate:function(){wr.getModel();var e=this.spMainFrame.getChildByTag(pc.ITEM_ROULETTE);if(e){e.unscheduleAllCallbacks();r=3600;r-=this.m_fAngleLast,r+=this._angle1,this.m_fAngleLast=this._angle1;var t=l.callFunc(this.rotateFinish,this,e),i=l.rotateBy(5,r),n=l.sequence(i.easing(l.easeInOut(3)),t);e.runAction(n)}var s=this.spMainFrame.getChildByTag(pc.ITEM_ROULETTE_MISTINESS);if(s){var r=360;s.unscheduleAllCallbacks();i=l.rotateBy(5,r);s.runAction(i.easing(l.easeInOut(3)));var a=l.sequence(l.delayTime(.5),l.fadeIn(.3),l.delayTime(3.4),l.fadeOut(.3));s.runAction(a)}},rotateFinish:function(){var e=wr.getModel(),t=e.usersData;e.playSoundWithType($.MTROULETTEEND);var i=this.spMainFrame.getChildByTag(pc.ITEM_WAIT);i&&i.setVisible(!1);var n=null;this.m_nPrizeStyle!=mc.PRIZE_WITH_STONE1888&&this.m_nPrizeStyle!=mc.PRIZE_WITH_STONE999&&this.m_nPrizeStyle!=mc.PRIZE_WITH_STONE666&&this.m_nPrizeStyle!=mc.PRIZE_WITH_STONE66||(n=new String("wheel_win_stone.png"));var s=null;switch(this.m_nPrizeStyle){case mc.PRIZE_WITH_STONE1888:s=new String("wheel_win_stone_1888.png"),t.addDiamond(1888,!1),t.GMDiamond+=50,t.DLDiamond-=50,this.changeStoneCount();break;case mc.PRIZE_WITH_STONE999:s=new String("wheel_win_stone_999.png"),t.addDiamond(999,!1),t.GMDiamond+=50,t.DLDiamond-=50,this.changeStoneCount();break;case mc.PRIZE_WITH_STONE666:s=new String("wheel_win_stone_666.png"),t.addDiamond(666,!1),t.GMDiamond+=50,t.DLDiamond-=50,this.changeStoneCount();break;case mc.PRIZE_WITH_STONE66:s=new String("wheel_win_stone_66.png"),t.addDiamond(66,!1),t.GMDiamond+=50,t.DLDiamond-=50,this.changeStoneCount();break;case mc.PRIZE_WITH_BOMB2:s=new String("wheel_win_bomb.png"),t.addClearBB(1,!1),t.DLClearBB-=1,t.GMClearBB+=1;break;case mc.PRIZE_WITH_SPEED6:s=new String("wheel_win_speed.png"),t.addShootSP(5,!1),t.DLShootSP-=5,t.GMShootSP+=5;break;case mc.PRIZE_WITH_ICE3:s=new String("wheel_win_ice.png"),t.addStopBB(2,!1),t.DLStopBB-=2,t.GMStopBB+=2;break;case mc.PRIZE_WITH_SLOW3:s=new String("wheel_win_slow.png"),t.addSlowBB(2,!1),t.DLSlowBB-=2,t.GMSlowBB+=2}var r=null;if(n){r=new l.Sprite(n.toString());var a=new l.Sprite(s.toString());a.setPosition(r.width/2,r.height/2),r.addChild(a)}else s&&(r=new l.Sprite(s.toString()));r.setPosition(412,475),r.setTag(pc.ITEM_WIN),this.spMainFrame.addChild(r,1),r.setScaleY(.5);var o=l.callFunc(this.extraPlay,this,r);r.runAction(l.sequence(l.spawn(l.scaleTo(.2,1),l.moveTo(.2,412,265)),l.moveTo(.1,412,275),o))},extraPlay:function(){if(this.m_nPrizeStyle==mc.PRIZE_WITH_STONE1888||this.m_nPrizeStyle==mc.PRIZE_WITH_STONE999||this.m_nPrizeStyle==mc.PRIZE_WITH_STONE666){var e=wr.getModel(),t=nr.share().getWinSize(),i=this.getChildByTag(pc.ITEM_BIGWINWHITE);i||((i=l.LayerColor(l.color(255,255,255,255),t.width,t.height)).setTag(pc.ITEM_BIGWINWHITE),this.addChild(i,999)),i.setOpacity(255),e.playSoundWithType($.MTROULETTEBIGBOUN);var n=l.callFunc(this.whiteLayerFinish,this,i);i.runAction(l.sequence(l.delayTime(.2),l.fadeOut(.8),n))}else this.m_bOnRotating=!1,this.m_bOnExtraPlay=!0,this.setBusyTag(!1)},whiteLayerFinish:function(){var e=nr.share().getWinSize(),t=this.getChildByTag(pc.ITEM_BIGWINBG);t||((t=new l.Sprite("wheel_bigwin_bg.png")).setPosition(e.width/2,e.height/2),t.setTag(pc.ITEM_BIGWINBG),this.addChild(t,0)),t.setVisible(!0),t.setOpacity(127),t.runAction(l.repeatForever(l.sequence(l.fadeTo(.3,255),l.fadeTo(.3,127))));var i=this.spMainFrame.getChildByTag(pc.ITEM_LIGHT);if(i){i.stopAllActions();var n=[l.spriteFrameCache.getSpriteFrame("wheel_shine_1.png"),,l.spriteFrameCache.getSpriteFrame("wheel_shine_2.png")],s=new l.Animation(n,.1);i.runAction(l.repeatForever(l.animate(s)))}this.m_bOnRotating=!1,this.m_bOnExtraPlay=!0,this.setBusyTag(!1)},menuItemWithFile:function(e,t,i,n,s){var r=new l.Sprite(e);if(null!=s){var a=new l.Sprite(s);a.setPosition(0,0),a.setAnchorPoint(0,0),r.addChild(a)}var o=null;if(o=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var h=new l.Sprite(s);h.setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(r,o,null,this,this.menuCallback.bind(this));return d.setTag(t),d.setPosition(i),d},addNoStoneDlg:function(){var e=this.getChildByTag(998);if(null==e){var t=this;wr.getModel().usersData.enablepay?qu.loadResAsync(Wi,function(){var e=aa.create();t.addChild(e,100,998),e.setParent(t,Wr.PARENT_ROULETTE),e.setShowDescription1(ea)}):ju.showLiteralsTip(GamePlatform.isCN()?b.Dialog_Hint:"The gem is not enough to be Trade！")}else e.setVisible(!0)},changeStoneCount:function(){var e=wr.getModel().usersData.getDiamond();this.lableStoneCount&&(this.lableStoneCount.setString(e.toString()),this.spStoneShop&&this.spStoneShop.changeStoneCount())},NoStoneUpdate:function(){var e=this.spMainFrame.getPosition(),t=l.moveTo(.1,e.x,e.y+30),i=l.moveTo(.2,e.x,e.y+670);this.spMainFrame.runAction(l.sequence(t,i));var n=l.moveTo(.2,0,-30),s=l.moveTo(.1,0,0);this.spStoneShop.runAction(l.sequence(n,s))},clickWinBtn:function(){this.spMainFrame.removeChildByTag(pc.ITEM_WIN)},shotCurScreen:function(){l.log("%s","shot cur screen");var e=nr.share().getWinSize(),t=new l.RenderTexture(e.width,e.height),i=this.getParent();if(t&&i){t.begin();for(var n=0;n<i.getChildren().length;n++){var s=i.getChildren()[n];4!=s.getTag()&&15!=s.getTag()&&1e3!=s.getTag()&&1001!=s.getTag()&&61!=s.getTag()&&s.visit()}t.end(),t.cleanup(),t.setPosition(e.width/2,e.height/2);t.saveToFile("".toString())}}});_c.create=function(){return new _c};var gc=0,Tc=l.Sprite.extend({curHP:0,nListID:0,curHPTOBe:0,nInitHP:0,gridIndex:-1,cutDownCount:0,cutDownHP:0,gateLastSmokeCount:0,objName:null,nToBeTowerType:0,nHPPercent:0,define:null,bSelect:!1,_className:"Goods",bAddTime:!1,bPlaySound:!1,bChoosed:!1,bInChoosed:!1,nAnimateCount:0,m_nWhichPath:1,ctor:function(e,t,i){this._super(),void 0===t&&(t=null),void 0===i&&(i=null);var n=wr.getModel();this.define=n.getObjectByType(e),this.curHPTOBe=this.nInitHP=this.curHP=this.define.nHP=parseInt(this.define.nHP);var s=null;if(e==J.GATE){var r=String.formatC(n.gameObjectConfig.strGatePic,10==n.curTheme?1:n.curTheme);l.spriteFrameCache.getSpriteFrame(r)||l.spriteFrameCache.addSpriteFrames(r),s=String.formatC(this.define.strPic,n.curLevel,1,0);var a=l.spriteFrameCache.getSpriteFrame(s);this.initWithSpriteFrame(a);for(var o=[],h=1;h<5;h++)o.push(l.spriteFrameCache.getSpriteFrame(String.formatC(this.define.strPic,n.curLevel,1,h)));(T=new l.Animation(o,.1)).setRestoreOriginalFrame(!0),this.runAction(l.repeatForever(l.sequence(l.animate(T),l.delayTime(5))));var d=new l.Sprite(String.formatC(this.define.strPic,0,0,0));return d.setPosition(0,0),d.setAnchorPoint(0,0),d.setTag(1011),this.addChild(d),this.curHPTOBe=this.nInitHP=this.curHP=n.curMapConfig.nStart01HP=parseInt(n.curMapConfig.nStart01HP),this.nAnimateCount=0,this.gateLastSmokeCount=0,void(this.objName=i)}if(e>J.OBJECTEND?(s=String.formatC(this.define.strPic,1),this.objName=String.formatC(this.define.strPic,1)):(s=t,this.objName=i,null===s&&l.error("")),(a=l.spriteFrameCache.getSpriteFrame(s))&&this.initWithSpriteFrame(a),"B2.png"==s)switch(n.curTheme){case 1:break;case 2:if(a=l.spriteFrameCache.getSpriteFrame("B21.png")){var c=new l.Sprite(a);c.setAnchorPoint(.5,.5),c.setPosition(.5*this.width,.5*this.height+3),this.addChild(c,1,7520),c.runAction(l.repeatForever(l.rotateBy(1,10)))}}else if("L3.png"==s)switch(n.curTheme){case 9:var u=[],p=l.spriteFrameCache.getSpriteFrame("L3.png"),m=l.spriteFrameCache.getSpriteFrame("L34.png"),_=l.spriteFrameCache.getSpriteFrame("L35.png"),g=l.spriteFrameCache.getSpriteFrame("L36.png");u.push(p),u.push(m),u.push(_),u.push(g);var T=new l.Animation(u,.2),f=l.sequence(l.animate(T));this.runAction(l.repeatForever(f))}this.bSelect=!1,this.bAddTime=!1,this.bPlaySound=!1,this.nListID=-1,this.nAnimateCount=0},getPointWithTime:function(e){return this.getPosition()},garbageGoods:function(e){void 0===e&&(e=!0),this.hideAnimation(),this.setOpacity(0);var t=this.getChildByTag(7520);t&&t.setOpacity(0);var i=wr.getModel(),n=i.animeLayer,s=this.define.type;if(e){var r=i.usersData,a=i.getGiveMoney(this.define);if(i.changeMoney(a),r.allMoney+=a,s<J.OBJECTEND?r.clearObjects+=1:s>J.OBJECTEND&&s<J.BOMB&&(i.curLevelGetScore+=1,s<J.BMT?(i.curKillMonsters+=5,r.ShowGiftBox()&&i.gameLayer.gameHUD.showDropGiftBox(this._position)):r.killBoss+=1),n.showMoneyWithPt(l.p(this.x+6,this.y+.5*this.height),a),!i.isPlayMess()&&i.m_nGameMode!=ge.HIGHERMODE){var o=parseInt(.2*(i.curKillMonsters-3)),h=i.usersData.getDropType(o);h<0&&n.showMoneyWithPt(l.p(this.x+106,this.y+.5*this.height),h)}}n.showDustWithPt(this._position,s>J.FLM2?2:s>J.OBJECTEND?0:1),i.curSelGoods&&i.curSelGoods==this&&(i.animeLayer.showSelPointWithSprite(this,0),i.curSelGoods=null),i.gameLayer.changeSelGroupWithType(s)},beShootWithTower:function(e,t,i,n){n=void 0===n||n;var s=this.define.type,r=this.curHP>0,a=wr.getModel(),o=this.hitToDeathWithPower(e,t-1,i);if(o)if(r){switch(this.garbageGoods(),n&&a.creepsTask(e.type,s,this.define.nMoney,this.objName),e.type){case J.TSNOW:case J.TMOON:case J.CSNOW:this.nAnimateCount++,this.runAction(l.sequence(l.delayTime(.1),l.callFunc(this.animationFinished,this)));break;case J.TPIN:case J.TARROW:case J.TBLUESTAR:this.nAnimateCount++,this.animationFinished()}(s>=J.BM1||s==J.GATE)&&a.gameLayer.gameHUD.changeTopHPBar(0)}else e.type!=J.TPIN&&(c=a.animeLayer)&&c.showExplodeWithTower(e,this._position);else{if(this.showMonsterHP(),s<=J.SBB&&s>=J.BM1){var h=Math.max(1,Math.floor(e.nPower[t-1]*i*.01));a.changeMoney(h),(p=a.gameLayer).changeSelGroupWithType(s)}if(e.type==J.TMAGNET&&this.define.type>J.OBJECTEND){var d=e.exPower[t-1];a.changeMoney(d.slowSpeed),a.usersData.allMoney+=d.slowSpeed;var c=a.animeLayer,u=this._position;c.showMoneyWithPt(l.p(u.x,u.y+.3*this.height),d.slowSpeed);var p=a.gameLayer;p.changeSelGroupWithType(this.define.type)}}return o},setcurHP:function(e){this.curHP=e},scaleHP:function(e){this.curHPTOBe=this.curHP=this.nInitHP=parseInt(this.nInitHP*e)},hitToDeathWithPower:function(e,t,i){var n=!0,s=e.type;if(this.curHP>0){if(this.curHP-=e.nPower[t]*i,this.curHP>0){if(n=!1,this.define.type==J.GATE){this.gateLastSmokeCount=30;var r=this.getChildByTag(gc);r?r.isVisible()||null!=r.getActionByTag(gc)||(r.setVisible(!0),this.schedule(this.GateLastSmoke,.1)):((r=new l.Sprite("GateSmoke1.png")).setPosition(this.width/2,0),r.setAnchorPoint(.5,0),this.addChild(r,99,gc),this.schedule(this.GateLastSmoke,.1))}if(s==J.TPIN||s==J.TARROW){var a=e.exPower[t];if(this.cutDownCount=a.nLastSecond/e.fMaxFadeSecd,s==J.TARROW){var o=this.getChildByTag(ar.EPIN);(d=this.getChildByTag(ar.EARROW))&&null!=d.getActionByTag(ar.EARROW)&&o&&null!=o.getActionByTag(ar.EPIN)||(this.cutDownHP=a.nShootHP,this.showBeatAnimation(e,t,!1),this.schedule(this.lastcutDownHP,e.fMaxFadeSecd))}else if(s==J.TPIN){var h=this.getChildByTag(ar.EARROW);h&&(this.unschedule(this.lastcutDownHP),null!=h.getActionByTag(ar.EARROW)&&h.stopActionByTag(ar.EARROW),h&&h.setVisible(!1));var d=this.getChildByTag(ar.EPIN);d&&null!=d.getActionByTag(ar.EPIN)||(this.cutDownHP=a.nShootHP,this.showBeatAnimation(e,t,!1),this.schedule(this.lastcutDownHP,e.fMaxFadeSecd))}return n}}else{var c=wr.getModel();this.define.type<J.OBJECTEND&&0==this.bPlaySound&&(this.bPlaySound=!0,c.playSoundWithType($.MTOBJECT)),this.stopActionByTag(rr.SPEEDACTIONS),this.stopActionByTag(rr.NORMALSPEED),this.stopActionByTag(rr.SLOWSPEED)}s==J.TFISH&&this.curHP>0&&this.define.type>J.OBJECTEND&&0==this.isSlowActionWithType(ar.ESNOW)?this.bChoosed?this.showBeatAnimation(e,t,!1):F()%100<e.exPower[t].nShootHP?(this.bChoosed=!0,this.showBeatAnimation(e,t,!0)):this.showBeatAnimation(e,t,!1):this.showBeatAnimation(e,t,!0),s!=J.TPIN&&s!=J.TARROW||(this.unschedule(this.lastcutDownHP),this.cutDownCount=0)}switch(s){case J.TSTAR:case J.TMAGNET:case J.TANCHOR:case J.TROCKET:case J.CROCKET:case J.TFIREBOTTLE:case J.TBOOMERANG:case J.TBLUESTAR:this.cutNearHP(e,t)}return n},cutNearHP:function(e,t){var i=wr.getModel(),n=e.exPower[t];if(this.define.type<J.OBJECTEND){var s=null;for(var r in i.objects)(s=i.objects[r])!=this&&l.pDistance(s._position,this._position)<=.71*n.nExplodeRange&&s.curHP>0&&(s.curHPTOBe=parseInt(s.curHPTOBe-n.nShootHP),s.curHP=parseInt(s.curHP-n.nShootHP),s.showBeatAnimation(e,t,!1),s.curHP<1?(s.garbageGoods(),s.nAnimateCount++,s.animationFinished(),i.creepsTask(e.type,s.define.type,s.define.nMoney,s.objName)):s.showMonsterHP())}else for(r=0;r<i.curIndexEnd;r++){var a=i.getIndexOfCreepsByID(r);if(!(a<0||a>=i.creeps.length)&&((s=i.creeps[a])!=this&&l.pDistance(s._position,this._position)<=.71*n.nExplodeRange&&s.curHP>0))if(s.curHPTOBe=parseInt(s.curHPTOBe-n.nShootHP),s.curHP=parseInt(s.curHP-n.nShootHP),s.showBeatAnimation(e,t,!1),s.curHP<1)s.garbageGoods(),s.nAnimateCount++,s.animationFinished(),i.creepsTask(e.type,s.define.type,s.define.nMoney,s.objName);else if(s.showMonsterHP(),e.type==J.TMAGNET){var o=n.slowSpeed/2;o<1&&(o=1),i.changeMoney(o),i.usersData.allMoney+=o;var h=i.animeLayer,d=s._position;h.showMoneyWithPt(l.p(d.x,d.y+.3*this.height),o),i.gameLayer.changeSelGroupWithType(this.define.type)}else e.type==J.TBLUESTAR&&0==this.isSlowActionWithType(ar.ESHIT)&&(this.hideSlowActions(ar.EMOON),t<e.exPower.length&&e.exPower.length&&s.SlowMoveWithPer(e.exPower[t]))}},destoryNearObject:function(){for(var e=wr.getModel(),t=e.objects.length-1;t>=0;t--){var i=e.objects[t];i!=this&&l.pDistance(i._position,this._position)<=this.nInitHP&&(i.garbageGoods(),i.curHP=-1,i.nAnimateCount++,i.animationFinished(),e.creepsTask(J.UNKNOW,i.define.type,i.define.nMoney,i.objName))}e.buildspace.push(e.rectWidthSprite(this))},lastcutDownHP:function(e){if(this.cutDownCount>0){if(this.curHP<1)return void this.unschedule(this.lastcutDownHP);if(this.cutDownCount--,this.curHPTOBe=parseInt(this.curHPTOBe-this.cutDownHP),this.curHP=parseInt(this.curHP-this.cutDownHP),this.curHP<1){this.unschedule(this.lastcutDownHP);var t=wr.getModel(),i=this.define.type;0==this.bPlaySound&&(this.bPlaySound=!0,i<J.OBJECTEND?t.playSoundWithType($.MTOBJECT):i<J.BMT?t.playSoundWithMTType(i):t.playSoundWithType((J.BMT,$.MTSMALLBOSS))),this.garbageGoods(),this.nAnimateCount++,this.animationFinished(),t.creepsTask(this.define.type,this.define.type,this.define.nMoney,this.objName)}else this.showMonsterHP()}else{var n=this.getChildByTag(ar.EARROW);n&&(n.setVisible(!1),n.stopActionByTag(ar.EARROW)),(n=this.getChildByTag(ar.EPIN))&&(n.setVisible(!1),n.stopActionByTag(ar.EPIN)),this.unschedule(this.lastcutDownHP)}},GateLastSmoke:function(e){if(this.gateLastSmokeCount>0){if(this.gateLastSmokeCount--,null==(a=this.getChildByTag(gc)).getActionByTag(gc)){for(var t=[],i=1;i<=7;i++){var n="GateSmoke"+i+".png";t.push(l.spriteFrameCache.getSpriteFrame(n))}var s=new l.Animation(t,.1),r=l.repeatForever(l.sequence(l.animate(s),l.hide(),l.delayTime(.7),l.show()));r.setTag(gc),a.runAction(r)}}else{var a=this.getChildByTag(gc);a.setVisible(!1),a.stopActionByTag(gc),this.unschedule(this.GateLastSmoke)}},showBeatAnimation:function(e,t,i){switch(e.type){case J.TBOTTLE:this.addSpriteWithPicPath(e,ar.PBOTTLE,!1);break;case J.TARROW:this.addSpriteWithPicPath(e,ar.EARROW,!0);break;case J.TCUTTLE:this.addSpriteWithPicPath(e,ar.PCUTTLE,!1);break;case J.TFIREBOTTLE:case J.TFLASHLIGHT:this.addSpriteWithPicPath(e,ar.PFIREBOTTLE,!1);break;case J.TSHIT:if(this.addSpriteWithPicPath(e,ar.PSHIT,!1),this.define.type<J.OBJECTEND)return;0==this.isSlowActionWithType(ar.EFISH)&&this.curHP>0&&this.addSpriteWithPicPath(e,ar.ESHIT,!0);break;case J.TSTAR:i?((n=wr.getModel()).playSoundWithType($.MTPSTAR),this.addSpriteWithPicPath(e,ar.ESTAR,!1)):this.addSpriteWithPicPath(e,ar.PSTAR,!1);break;case J.TPLANE:this.addSpriteWithPicPath(e,ar.PPLANE,!1);break;case J.TFISH:this.addSpriteWithPicPath(e,ar.PFISH,!1),this.bChoosed&&0==this.isSlowActionWithType(ar.ESNOW)&&this.addSpriteWithPicPath(e,ar.EFISH,i);break;case J.TANCHOR:i?((n=wr.getModel()).playSoundWithType($.MTPSTAR),this.addSpriteWithPicPath(e,ar.EANCHOR,!1)):this.addSpriteWithPicPath(e,ar.PANCHOR,!1);break;case J.TPIN:this.addSpriteWithPicPath(e,ar.EPIN,!1);break;case J.TSNOW:this.define.type>J.OBJECTEND&&(0==this.isSlowActionWithType(ar.EICE)&&this.curHP>0&&this.addSpriteWithPicPath(e,ar.ESNOW,!1),this.setScale(1));break;case J.CSNOW:if(this.addSpriteWithPicPath(e,ar.PSNOW,!1),this.define.type<J.OBJECTEND)return;0==this.isSlowActionWithType(ar.EICE)&&this.curHP>0&&this.addSpriteWithPicPath(e,ar.ESNOW,!0);break;case J.TICEFAN:if(this.addSpriteWithPicPath(e,ar.PFAN,!1),this.define.type<J.OBJECTEND)return;0==this.isSlowActionWithType(ar.EMOON)&&this.curHP>0&&this.addSpriteWithPicPath(e,ar.ECOOLFAN,!0);break;case J.TROCKET:case J.CROCKET:i?((n=wr.getModel()).playSoundWithType($.MTPSTAR),this.addSpriteWithPicPath(e,ar.EROCKET,!1)):this.addSpriteWithPicPath(e,ar.PROCKET,!1);break;case J.TBALL:this.addSpriteWithPicPath(e,ar.PBALL,!1);break;case J.TSUN:this.addSpriteWithPicPath(e,ar.PSUN,!1);break;case J.TMOON:if(this.addSpriteWithPicPath(e,ar.PMOON,!1),this.define.type<J.OBJECTEND)return;0==this.isSlowActionWithType(ar.EBLUESTAR)&&this.curHP>0&&this.addSpriteWithPicPath(e,ar.EMOON,!0);break;case J.TMAGNET:i?((n=wr.getModel()).playSoundWithType($.MTPSTAR),this.addSpriteWithPicPath(e,ar.EMAGNET,!1)):this.addSpriteWithPicPath(e,ar.PMOON,!1);break;case J.TBOOMERANG:var n=wr.getModel();n.playSoundWithType($.MTPBOOMERANG),this.addSpriteWithPicPath(e,ar.PBOOMERANG,!1);break;case J.TBLUESTAR:if(this.addSpriteWithPicPath(e,ar.PBLUESTAR,!1),this.define.type<J.OBJECTEND)return;0==this.isSlowActionWithType(ar.ESHIT)&&this.curHP>0&&this.addSpriteWithPicPath(e,ar.EBLUESTAR,!0)}},showMonsterHP:function(){var e=this.define.type;if(e>J.SBFL2&&e<J.SBB||e==J.GATE){var t=(c=wr.getModel()).gameLayer.gameHUD;if(this.curHP>0&&(t.changeTopHPBar(this.curHP/this.nInitHP),e==J.GATE))if(1==c.bShowGateNotHitAnimate&&(c.bShowGateNotHitAnimate=!1,(r=this.getChildByTag(100))&&this.removeChildByTag(100,!0)),this.curHP/this.nInitHP*100<=30){if(0==this.nHPPercent)return;this.nHPPercent=0;s=l.spriteFrameCache.getSpriteFrame("GateFire31.png");(r=this.getChildByTag(99))?(r.stopAllActions(),r.setSpriteFrame(s)):((r=new l.Sprite(s)).setAnchorPoint(0,0),r.setPosition(0,0),r.setTag(99),this.addChild(r));for(var i=[],n=1;n<7;n++)i.push(l.spriteFrameCache.getSpriteFrame("GateFire3"+n+".png"));o=new l.Animation(i,.1);r.runAction(l.repeatForever(l.sequence(l.animate(o))))}else if(this.curHP/this.nInitHP*100<=60&&this.curHP/this.nInitHP*100>30){if(1==this.nHPPercent)return;this.nHPPercent=1;var s=l.spriteFrameCache.getSpriteFrame("GateFire21.png");(r=this.getChildByTag(99))?(r.stopAllActions(),r.setSpriteFrame(s)):((r=new l.Sprite(s)).setAnchorPoint(0,0),r.setPosition(0,0),r.setTag(99),this.addChild(r));for(var i=[],n=1;n<7;n++)i.push(l.spriteFrameCache.getSpriteFrame("GateFire2"+n+".png"));o=new l.Animation(i,.1);r.runAction(l.repeatForever(l.sequence(l.animate(o))))}else if(this.curHP/this.nInitHP*100<=80&&this.curHP/this.nInitHP*100>60){if(2==this.nHPPercent)return;this.nHPPercent=2;var r=this.getChildByTag(99);if(!r){(r=new l.Sprite("GateFire11.png")).setAnchorPoint(0,0),r.setPosition(0,0),r.setTag(99),this.addChild(r);for(var i=[],n=1;n<7;n++){var a=String.formatC("GateFire1%d.png",n);i.push(l.spriteFrameCache.getSpriteFrame(a))}var o=new l.Animation(i,.1);r.runAction(l.repeatForever(l.sequence(l.animate(o))))}}}else{this.unschedule(this.hideHP);var h=this.curHP/this.nInitHP,d=this.getChildByTag(ar.PHPBG);if(d)d.setVisible(!0),h<0&&(h=0),(m=d.getChildByTag(ar.PHP)).setScaleX(1-h);else{var c=wr.getModel(),u=c.getObjectByType(J.MONSTERHP),p=String.formatC(u.strPic,e==J.SBB?1:0,1);if(null==(s=l.spriteFrameCache.getSpriteFrame(p)))return;if(d=new l.Sprite(s)){if(p=String.formatC(u.strPic,e==J.SBB?1:0,2),s=l.spriteFrameCache.getSpriteFrame(p)){nr.share().isIPad()&&1;var m=new l.Sprite(s);m.setAnchorPoint(1,0),m.setPosition(d.width-2,2),d.addChild(m,1,ar.PHP),m.setScaleX(1-h)}d.setAnchorPoint(0,1),d.setPosition(.5*(this.width-d.width),this.height),this.addChild(d,999,ar.PHPBG)}}this.schedule(this.hideHP,3)}},addSpriteWithPicPath:function(e,t,i,n){var s=0,r=0,a=0,o=this.define.type;n?t==ar.ECOOLFAN&&(a=-10):i&&t==ar.EBLUESTAR?a=-2:t<ar.PBOTTLE&&(a=-1);var h=e.strProjPic;a<0?(r=e.fSlowSpanSecd,s=t==ar.EBLUESTAR?1:e.nSlowPicCount):(r=e.fProjExpSpanSecd,s=e.nProjExpPicCount);var d=null,c=null;if(s>0){if((c=this.getChildByTag(t))&&c.getActionByTag(t))return void(c.visible=!0);var u=c?c._frames:null;if(!u){u=[];for(var p=1;p<=s;++p){var m=null;m=t==ar.EICE?String.formatC("PIce%d%d.png",a,p):String.formatC(h,a,p),u.push(l.spriteFrameCache.getSpriteFrame(m))}}var _=new l.Animation(u,r);if(d=i||t==ar.EFISH?l.repeatForever(l.animate(_)):l.animate(_),null===c){T=u[u.length-1];c=new l.Sprite(T),this.addChild(c,t-ar.PTYPESTART,t),c._frames=u}t==ar.ESNOW?(c.setAnchorPoint(.5,1),c.setPosition(.5*this.width,this.height)):t==ar.ESHIT||t==ar.ECOOLFAN||t==ar.PSUN||t==ar.EMOON||t==ar.EARROW||t==ar.EPIN||o>=ar.BMT&&t==ar.PSNOW?(c.setAnchorPoint(.5,0),c.setPosition(.5*this.width,0)):(c.setAnchorPoint(.5,.5),c.setPosition(.5*this.width,.5*this.height))}if(o>J.OBJECTEND&&t==ar.PBLUESTAR&&0==this.isSlowActionWithType(ar.EMUSHROOM)){var g=this.getChildByTag(ar.SBLUESTAR);if(g)g.setVisible(!0);else{var T=l.spriteFrameCache.getSpriteFrame(String.formatC(h,-2,1));(g=new l.Sprite(T)).setAnchorPoint(.5,0),g.setPosition(.5*this.width,0),this.addChild(g,ar.SBLUESTAR-ar.PTYPESTART,ar.SBLUESTAR)}}t==ar.EFISH&&(a=1,i=!0);var f=null,S=null,w=null;if(a<0?e.fMaxFadeSecd>0&&(e.nRotateDegrs>0&&(f=l.rotateBy(e.fMaxFadeSecd,e.nRotateDegrs)),w=l.scaleTo(e.fMaxFadeSecd,1.5),S=l.fadeOut(e.fMaxFadeSecd)):!i&&s>0&&(S=l.fadeOut(e.fProjExpFadeSecd)),d&&c)if(c.setVisible(!0),c.setOpacity(255),c.setScale(1),i)d.setTag(t),c.runAction(d);else{var v=l.callFunc(this.animationFinished,this),L=null;void 0==(L=f&&S?l.sequence(d,l.spawn(w,f,S),v):S?l.sequence(d,S,v):f?l.sequence(d,f,v):l.sequence(v))&&l.log("undefined == seq"),L.setTag(t),this.nAnimateCount++,c.runAction(L)}},hideAnimation:function(e){this.stopActionByTag(rr.NORMALSPEED),this.stopActionByTag(rr.SLOWSPEED);var t=this.getChildByTag(ar.EARROW);t&&t.setVisible(!1);var i=this.getChildByTag(ar.EPIN);i&&i.setVisible(!1),this.hideSlowActions(ar.EICE),this.hideHP(0)},hideSlowActions:function(e){var t=null;switch(e){case ar.EICE:(t=this.getChildByTag(ar.EICE))&&t.setVisible(!1);case ar.ESNOW:(t=this.getChildByTag(ar.ESNOW))&&t.setVisible(!1);case ar.EFISH:(t=this.getChildByTag(ar.EFISH))&&t.setVisible(!1);case ar.ESHIT:(t=this.getChildByTag(ar.ESHIT))&&t.setVisible(!1);case ar.EBLUESTAR:(t=this.getChildByTag(ar.EBLUESTAR))&&t.setVisible(!1);case ar.EMUSHROOM:(t=this.getChildByTag(ar.EMUSHROOM))&&t.setVisible(!1);case ar.EMOON:(t=this.getChildByTag(ar.EMOON))&&t.setVisible(!1);case ar.ECOOLFAN:(t=this.getChildByTag(ar.ECOOLFAN))&&t.setVisible(!1);case ar.SBLUESTAR:(t=this.getChildByTag(ar.SBLUESTAR))&&t.setVisible(!1)}},hideHP:function(e){this.unschedule(this.hideHP);var t=this.getChildByTag(ar.PHPBG);t&&t.setVisible(!1)},isSlowActionWithType:function(e){var t=null;switch(e){case ar.SBLUESTAR:if((t=this.getChildByTag(ar.SBLUESTAR))&&t.isVisible())return 1;case ar.ECOOLFAN:if((t=this.getChildByTag(ar.ECOOLFAN))&&t.isVisible())return 1;case ar.EMUSHROOM:if((t=this.getChildByTag(ar.EMUSHROOM))&&t.isVisible())return 1;case ar.EMOON:if((t=this.getChildByTag(ar.EMOON))&&t.isVisible())return 1;case ar.EBLUESTAR:if((t=this.getChildByTag(ar.EBLUESTAR))&&t.isVisible())return 1;case ar.ESHIT:if((t=this.getChildByTag(ar.ESHIT))&&t.isVisible())return 1;case ar.EFISH:if((t=this.getChildByTag(ar.EFISH))&&t.isVisible())return 1;case ar.ESNOW:if((t=this.getChildByTag(ar.ESNOW))&&t.isVisible())return 1;case ar.EICE:if((t=this.getChildByTag(ar.EICE))&&t.isVisible())return 1}return 0},animationFinished:function(){this.nAnimateCount--;for(var e=ar.ESHIT;e<ar.PTYPEEND;e++){var t=this.getChildByTag(e);null!=t&&(null==t.getActionByTag(e)&&t.setVisible(!1))}0==this.nAnimateCount&&this.curHP<1&&(this.bSelect=!1,this.setVisible(!1),this.setOpacity(255),this.setScale(1),this.nAnimateCount=-100,this.stopAllActions(),this.unscheduleAllCallbacks(),wr.getModel().garbageMonster(this))},setWhichPath:function(e){this.m_nWhichPath=e},getWhichPath:function(){return this.m_nWhichPath}}),fc=Tc.extend({curWayPoint:0,curActionType:rr.MONSTERCM,fSpeedSlowPer:0,bSnow:0,nShit:0,nSnow:0,nFish:0,nBlueStar:0,nMushroom:0,moveSpeed:null,waypoints:null,waypointssting:null,_className:"Creep",ctor:function(e){if(void 0!==e)return e instanceof Tc?(this._super(),this.initWithFile(e.define.strPic),this.define=e.define,this.moveSpeed=e.moveSpeed,this.waypoints=e.waypoints,this.curWayPoint=e.curWayPoint,void(this.curHP=e.curHP)):(this._super(e),this.fSpeedSlowPer=1,this.nShit=this.nSnow=this.nFish=this.nBlueStar=this.nMushroom=-1,void(this.bSnow=!1));this._super()},getCurWayPoint:function(){var e=null;return this.waypoints&&this.waypoints.length&&(e=this.curWayPoint<this.waypoints.length?this.waypoints[this.curWayPoint]:this.waypoints[this.waypoints.length-1]),e},IsWayPointTransfer01:function(){var e=this.waypointssting[this.curWayPoint];return e&&-1!=e.indexOf("01")},IsWayPointTransfer02:function(){var e=this.waypointssting[this.curWayPoint];return e&&-1!=e.indexOf("02")},IsNextWayPointTranferO1:function(){var e=this.waypointssting[this.curWayPoint+1];return e&&-1!=e.indexOf("01")},curDuration:function(){return this.moveSpeed?this.moveSpeed.durationsWithIndex(this.curWayPoint):-1},getWayPoint:function(e){void 0==e&&(e=!0);return e?this.waypoints[this.curWayPoint-1]:this.waypoints[this.curWayPoint+1]},getNextWayPoint:function(e){if(++this.curWayPoint>this.waypoints.length-2){if(!e)return null;this.curWayPoint=1}var t=this.curWayPoint-1,i=this.curWayPoint,n=this.curWayPoint+1;if(t<this.waypoints.length&&n<this.waypoints.length&&this.waypoints.length){var s=this.waypoints[t],r=this.waypoints[i],a=r;if(s.y==a.y)s.x<a.x?this.setFlippedX(!1):s.x!=a.x&&this.setFlippedX(!0);else if(n<this.waypoints.length){var o=this.waypoints[n];a.x>o.x?this.setFlippedX(!0):a.x!=o.x&&this.setFlippedX(!1)}return r}return null},getPointWithTime:function(e,t,i,n){var s=l.p(0,0);if(arguments.length>1){if(this.moveSpeed){var r=e*this.moveSpeed.moveSpeed*this.fSpeedSlowPer;i.x<n.x?(s.x=t.x+r,s.y=t.y):i.x==n.x?i.y<n.y?(s.x=t.x,s.y=t.y+r):(s.x=t.x,s.y=t.y-r):(s.x=t.x-r,s.y=t.y)}return s}if(this.define.type<J.OBJECTEND)return this._super(e);var a=this.waypoints.length,o=a-2,h=this.curWayPoint-1;if(a&&this.curWayPoint>o&&o<this.waypoints.length)s=this.waypoints[o];else if(a&&this.moveSpeed&&h<a){var i=this.waypoints[h],n=this.waypoints[this.curWayPoint],d=l.pSub(n,this._position),c=e;c=d.x>0&&0==d.y||d.x<0&&0==d.y?Math.abs(d.x/this.moveSpeed.moveSpeed):Math.abs(d.y/this.moveSpeed.moveSpeed),s.x=this.x,s.y=this.y,c<e?(s=this.getPointWithTime(c,s,i,n),c=e-c,i=n,this.curWayPoint+1<a&&(n=this.waypoints[this.curWayPoint+1])):c=e,s=this.getPointWithTime(c,s,i,n)}return s},creepLogic:function(e){var t=this.getCurWayPoint();if(t){var i=l.pSub(t,this._position),n=l.pToAngle(i),s=l.radiansToDegrees(-1*n),r=.5/Math.PI,a=Math.abs(n*r);this.runAction(l.sequence(l.rotateTo(a,s)))}},_frames:null,_animePic:"",_fCount:0,runRepeatActionWithDefine:function(e){if(null===this._frames||this._animePic!=e.strPic||this._fCount!=e.nPicCount){for(var t=[],i=1;i<=e.nPicCount;++i)t.push(l.spriteFrameCache.getSpriteFrame(String.formatC(e.strPic,i)));this._frames=t,this._animePic=e.strPic,this._fCount=e.nPicCount}var n=new l.Animation(this._frames,e.fSpanSecond),s=l.repeatForever(l.animate(n));s.setTag(rr.REPEATACTION),this.runAction(s)},showMonsterCm:function(){for(var e=wr.getModel(),t=e.getObjectByType(J.AIRWITHCREAT),i=[],n=1;n<=t.nPicCount;++n)i.push(l.spriteFrameCache.getSpriteFrame(String.formatC(t.strPic,n)));var s=t.nRunSpeed/1e3,r=new l.Animation(i,t.fSpanSecond),a=l.animate(r),o=l.rotateBy(s,t.nHP),h=l.scaleTo(s,t.nMoney/100),d=l.fadeOut(s),c=l.spawn(o,d);d.setTag(ar.EDUST);var u=l.sequence(a,h,c,l.hide());u.setTag(rr.MONSTERCM);var p=this.getChildByTag(J.AIRWITHCREAT);if(null==p){var m=i[0];if(!m)return;(p=new l.Sprite(m))&&(p.setAnchorPoint(.5,.5),p.setPosition(this.width/2,this.height/2),this.addChild(p,9,J.AIRWITHCREAT))}e.playSoundWithType($.MTMSTCM),p.setVisible(!0),p.setOpacity(255),p.runAction(u)},MoveAction:function(){if(this.moveSpeed){var e=this.getCurWayPoint(),t=l.pSub(this._position,e),i=0;(i=Math.abs(t.x)>Math.abs(t.y)?t.x/this.moveSpeed.moveSpeed:t.y/this.moveSpeed.moveSpeed)<0&&(i=-i);var n=wr.getModel(),s=l.sequence(l.moveTo(i/this.fSpeedSlowPer,e),l.callFunc(n.gameLayer.FollowPath,n.gameLayer,this));s.setTag(rr.SLOWSPEED),this.curActionType=rr.SLOWSPEED,this.runAction(s)}},NomalMoveSpeed:function(){this.fSpeedSlowPer=1,this.setScale(1),this.nSnow=-1,this.nFish=-1,this.nShit=-1,this.nBlueStar=-1,this.nMushroom=-1,this.bSnow=!1,this.bChoosed=!1,this.bInChoosed=!1,this.stopActionByTag(rr.NORMALSPEED),this.stopActionByTag(rr.SLOWSPEED),this.hideSlowActions(ar.EICE),this.MoveAction()},SlowMoveWithPer:function(e){this.fSpeedSlowPer=e.slowSpeed,this.stopActionByTag(rr.SPEEDACTIONS),this.stopActionByTag(rr.NORMALSPEED),this.stopActionByTag(rr.SLOWSPEED);var t=l.sequence(l.callFunc(this.MoveAction,this),l.delayTime(e.nLastSecond),l.callFunc(this.NomalMoveSpeed,this));t.setTag(rr.SPEEDACTIONS),this.curActionType=rr.SPEEDACTIONS,this.runAction(t)},slowNearCreeps:function(e,t){var i=wr.getModel(),n=e.exPower[t];if(this.define.type<J.OBJECTEND){for(var s in i.objects){a=i.objects[s];l.pDistance(a._position,this._position)<=.71*n.nExplodeRange&&a.curHP>0&&(a.curHPTOBe=parseInt(a.curHPTOBe-n.nShootHP),a.curHP=parseInt(a.curHP-n.nShootHP),a.showBeatAnimation(e,t,!1),a.curHP<1?(a.garbageGoods(),a.nAnimateCount++,a.animationFinished(),i.creepsTask(e.type,a.define.type,a.define.nMoney,a.objName)):a.showMonsterHP())}}else for(s=0;s<i.curIndexEnd;s++){var r=i.getIndexOfCreepsByID(s);if(!(r<0)&&(r<i.creeps.length&&i.creeps.length)){var a=i.creeps[r];l.pDistance(a._position,this._position)<=.71*n.nExplodeRange&&a.curHP>0&&(a.curHP=parseInt(a.curHP-n.nShootHP),a.curHPTOBe=parseInt(a.curHPTOBe-n.nShootHP),a.curHP<1?(a.garbageGoods(),a.nAnimateCount++,a.animationFinished(),i.creepsTask(e.type,a.define.type,a.define.nMoney,a.objName)):(a.bChoosed=!0,a.hideSlowActions(ar.ESNOW),a.showBeatAnimation(e,t,!1),a.bChoosed=!1,t<e.exPower.length&&e.exPower.length&&a.SlowMoveWithPer(e.exPower[t]),a.showMonsterHP()))}}},hitToDeathWithPower:function(e,t,i){var n=this._super(e,t,i);if(!n){var s=t;switch(e.type){case J.TICEFAN:this.nBlueStar<=s&&0==this.isSlowActionWithType(ar.EMOON)&&(this.nBlueStar=s,this.hideSlowActions(ar.SBLUESTAR),t<e.exPower.length&&e.exPower.length&&this.SlowMoveWithPer(e.exPower[t]));break;case J.TSHIT:this.nShit<=s&&0==this.isSlowActionWithType(ar.EFISH)&&(this.nShit=s,this.hideSlowActions(ar.EBLUESTAR),t<e.exPower.length&&e.exPower.length&&this.SlowMoveWithPer(e.exPower[t]));break;case J.TBLUESTAR:this.nShit<=s&&0==this.isSlowActionWithType(ar.ESHIT)&&(this.nShit=s,this.hideSlowActions(ar.EMOON),t<e.exPower.length&&e.exPower.length&&this.SlowMoveWithPer(e.exPower[t]));break;case J.TMOON:if(this.nMushroom<=s&&0==this.isSlowActionWithType(ar.EBLUESTAR)&&(this.nMushroom=s,this.hideSlowActions(ar.ECOOLFAN),t<e.exPower.length&&e.exPower.length)){var r=e.exPower[t];this.SlowMoveWithPer(r)}break;case J.TFISH:if(this.bInChoosed)break;if(this.nFish<=s&&0==this.isSlowActionWithType(ar.ESNOW)&&this.bChoosed){this.bInChoosed=!0;var a=wr.getModel();this.nFish=s,this.hideSlowActions(ar.ESHIT);var o=e.exPower[t];this.curHP=parseInt(this.curHP-o.nShootHP),this.curHPTOBe=parseInt(this.curHPTOBe-o.nShootHP),this.curHP<1?(this.bInChoosed=!1,this.bChoosed=!1,this.garbageGoods(),this.nAnimateCount++,this.animationFinished(),a.creepsTask(e.type,this.define.type,this.define.nMoney,this.objName)):(this.bChoosed=!0,this.hideSlowActions(ar.ESNOW),this.showBeatAnimation(e,t,!1),t<e.exPower.length&&e.exPower.length&&this.SlowMoveWithPer(e.exPower[t]),this.showMonsterHP())}break;case J.TSNOW:!n&&this.nSnow<=s&&0==this.isSlowActionWithType(ar.EICE)&&(this.nSnow=s,this.hideSlowActions(ar.EFISH),t<e.exPower.length&&e.exPower.length&&this.SlowMoveWithPer(e.exPower[t]));break;case J.CSNOW:this.nSnow<=s&&0==this.isSlowActionWithType(ar.EICE)&&(this.nSnow=s,this.hideSlowActions(ar.EFISH),t<e.exPower.length&&e.exPower.length&&this.SlowMoveWithPer(e.exPower[t]))}}return n},garbageGoods:function(e){if(void 0===e&&(e=!0),0==this.bPlaySound){this.bPlaySound=!0,this.runAction(l.callFunc(this.playSound,this));var t=wr.getModel();if(e&&this.define.type>J.LM3&&this.define.type<J.FTM&&(this.define.type-J.LM41)%2==0&&(t.addChildCreep(this._position,this.waypoints==t.waypoints?1:2,this.curWayPoint,this.define.nLevelCount,this.define.type),0==t.bInAddChildMonster&&(t.bInAddChildMonster=!0,t.gameLayer.showChildMonsterBegan())),!t.isPlayMess()){if(t.curDropCreepID--,0==t.curDropCreepID&&t.curDropDiamond>0)if(t.m_nGameMode==ge.HIGHERMODE){n=0;if(t.curDropDiamond<3)t.curDropCreepID=2+F()%8,(n=t.curDropDiamond)<1&&(n=2);else{var i=t.m_oHigher.getPassCount();i<30?(t.curDropCreepID=10+F()%30,n=F()%2+1):i<60?(t.curDropCreepID=10+F()%20,n=F()%3+2):i<O.DAYDAYUPLEVELCOUNT+1&&(t.curDropCreepID=10+F()%20,n=F()%2+4)}(n=t.m_oHigher.getDropDiamondCount(n))>0&&t.curDropDiamond>0?(t.curDropDiamond<n&&(n=t.curDropDiamond),t.curDropDiamond-=n,(r=t.animeLayer).showMoneyWithPt(l.p(this.x+6-this.width,this.y+.5*this.height),-n),t.addCurLevelDiamond(n),l.log("》》》普通掉落宝石%lu",n)):t.curDropDiamond=0}else{var n=0;t.curDropDiamond<6?(n=t.curDropDiamond)<1&&(n=2):n=F()%4+2,t.curDropDiamond-=n,t.curDropCreepID=10+F()%20,(r=t.animeLayer).showMoneyWithPt(l.p(this.x+6-this.width,this.y+.5*this.height),-n),t.addCurLevelDiamond(n),l.log("》》》普通掉落宝石%lu",n)}if(t.m_bFeast&&t.m_oFeast.getCurFeastType()==hn){var s=t.m_oFeast.getDropDiamondCount(t.curLevel);if(s>0){var r=t.animeLayer;r.showMoneyWithPt(l.p(this.x+6-this.width,this.y+.5*this.height),-s),t.addCurLevelDiamond(s)}}}}this._super(e)},playSound:function(){var e=wr.getModel(),t=this.define.type;t<J.BMT?e.playSoundWithMTType(t):e.playSoundWithType(t>=J.BM1?$.MTBIGBOSS:$.MTSMALLBOSS)},moveFinish:function(){this.setVisible(!1),this.curHPTOBe=this.curHP=-1,this.unscheduleAllCallbacks(),this.stopAllActions()},UpSlowMoveWithDefine:function(e){if(e)if(F()%10<e.nPowerPort){this.fSpeedSlowPer=e.slowSpeed,this.stopActionByTag(rr.SPEEDACTIONS),this.stopActionByTag(rr.NORMALSPEED),this.stopActionByTag(rr.SLOWSPEED);var t=l.sequence(l.callFunc(this.MoveAction,this),l.delayTime(e.nLastSecond),l.callFunc(this.NomalMoveSpeed,this));t.setTag(rr.SPEEDACTIONS),this.curActionType=rr.SPEEDACTIONS,this.runAction(t),(i=this.getChildByTag(ar.EFISH))&&i.setVisible(!0)}else{var i=this.getChildByTag(ar.EFISH);i&&-1==this.nFish&&i.setVisible(!1)}}});fc.create=function(e){return new fc(e)};var Sc=l.Sprite.extend({bFree:!1,type:null,ctor:function(){this._super(),this.bFree=!1,this.type=J.PROJBOOM},hideCall:function(){this.setVisible(!1),this.setOpacity(255),this.stopAllActions(),this.bFree=!0},pauseActions:function(){this.pause(),this.setVisible(!1),this.bFree=!0}}),wc=1e3,vc=1010,Lc=1020,Mc=1019,Cc=1021,yc=1030,Bc=1,Fc=Xs.extend({hotSprites:null,coolSprites:null,timeTip:null,beSelGoods:null,selObjectAnimate:null,towerUpdatelower:null,towerUpdateUpper:null,towerMagic1:null,towerMagic2:null,towerMagic3:null,towerMagic4:null,towerMagic5:null,countDownTime:-1,mbReShowCount:!1,ctor:function(){this._super()},showDustWithPt:function(e,t){var i=wr.getModel().getObjectByType(J.AIRWITHBUILD),n=String.formatC(i.strPic,t,1),s=this.getAnimeSpriteWithPic(n,ee.DUST);s.setPosition(e);var r=[],a=i.nPicCount;2==t&&(a=i.nHP);for(var o=1;o<=a;++o)r.push(l.spriteFrameCache.getSpriteFrame(String.formatC(i.strPic,t,o)));var h=new l.Animation(r,i.fSpanSecond),d=l.animate(h),c=l.fadeOut(i.nRunSpeed/1e3),u=l.callFunc(s.hideCall,s);d.setTag(1),c.setTag(1),u.setTag(1);var p=l.sequence(d,c,u);p.setTag(rr.DUSTACTION),s.runAction(p)},showUpdateFalshWithTowe:function(e){var t=wr.getModel();if(t.gameLayer){var i=t.getObjectByType(J.AIRWITHBUILD),n=e.getContentSize();if(null==this.towerUpdatelower){var s=String.formatC(i.strPic,3,5);this.towerUpdatelower=new l.Sprite(s),this.towerUpdatelower.setPosition(e.x-e.anchorX*n.width+.5*n.width,e.y-e.anchorY*n.height+.5*n.height),s=String.formatC(i.strPic,3,1),this.towerUpdateUpper=new l.Sprite(s),this.towerUpdateUpper.setAnchorPoint(.5,0),this.towerUpdateUpper.setPosition(e.x-e.anchorX*n.width+.5*n.width,e.y-e.anchorY*n.height-20),t.gameLayer&&(t.gameLayer.addChild(this.towerUpdatelower,sr.LTOWER-1),t.gameLayer.addChild(this.towerUpdateUpper,sr.LTOWER+1))}else this.towerUpdateUpper.setVisible(!0),this.towerUpdateUpper.setOpacity(255),this.towerUpdateUpper.setPosition(e.x-e.anchorX*n.width+.5*n.width,e.y-e.anchorY*n.height-20),this.towerUpdatelower.setScale(1),this.towerUpdatelower.setVisible(!0),this.towerUpdatelower.setOpacity(255),this.towerUpdatelower.setPosition(e.x-e.anchorX*n.width+.5*n.width,e.y-e.anchorY*n.height+.5*n.height);for(var r=[],a=2;a<5;++a)r.push(l.spriteFrameCache.getSpriteFrame(String.formatC(i.strPic,3,a)));var o=new l.Animation(r,.08);o.setRestoreOriginalFrame(!0),this.towerUpdatelower.runAction(l.sequence(l.spawn(l.animate(o),l.scaleTo(.32,1.2)),l.fadeOut(.2))),this.towerUpdateUpper.runAction(l.sequence(l.moveTo(.32,l.pAdd(this.towerUpdatelower.getPosition(),l.p(0,e.height))),l.fadeOut(.2)))}},showMoneyWithPt:function(e,t){var i=wr.getModel(),n=i.getObjectByType(J.MONSTERMONEY),s=String.formatC(n.strPic,t),r=l.spriteFrameCache.getSpriteFrame(s);if(r){var a=this.getAnimeSpriteWithPic(s,ee.MONEYS);a.setSpriteFrame(r),a.setPosition(e),a.setAnchorPoint(.5,0),a.setScale(1);var o=l.moveTo(.001*n.nHP,l.pAdd(e,l.p(0,n.nMoney+(5==t?5:0)))),h=l.fadeOut(.001*n.nRunSpeed),d=l.delayTime(t<-5?1:t<=5?2:n.fSpanSecond),c=l.callFunc(a.hideCall,a),u=null;if(t<-5){var p=i.gameLayer.gameHUD;p.curDropItem=-t+pe.BOTTOM_BAR_BOMB-6;var m=p.bottomBar.getChildByTag(p.curDropItem);a.setOpacity(0);var _=l.spawn(o,l.fadeIn(.001*n.nHP)),g=l.spawn(l.scaleTo(.3,.1),l.moveTo(.3,l.pAdd(m.getPosition(),l.p(.3*m.width,.4*m.height))));u=l.sequence(_,d,g,l.callFunc(this.changePic.bind(this,a)),l.scaleTo(.1,1),l.callFunc(p.GetDropItem.bind(p)),l.scaleTo(.2,.1),c)}else u=5==t?l.sequence(o,d,l.spawn(l.moveTo(.5,nr.share().getMapOffset().width+320,20),l.scaleTo(.5,.2)),h,c):l.sequence(o,d,h,c);u.setTag(rr.MONEYACTION),a.runAction(u)}},changePic:function(e){var t=l.spriteFrameCache.getSpriteFrame("adv_bottoolbar_shine.png");if(t){var i=e;i.setSpriteFrame(t),i.setAnchorPoint(.5,.5)}},showUpdateTip:function(e){var t=wr.getModel().getObjectByType(J.SHOWUPDATE),i=this.findSpriteWithType(ee.UPDATETIP);if(i)i.resume(),i.setVisible(!0);else{var n=String.formatC(t.strPic,1),s=l.spriteFrameCache.getSpriteFrame(n);s&&(i=new Sc)&&(i.initWithSpriteFrame(s),i.type=ee.UPDATETIP,i.setAnchorPoint(.5,.142),this.hotSprites.push(i),this.addChild(i,ee.UPDATETIP));for(var r=[],a=1;a<=t.nPicCount;++a)r.push(l.spriteFrameCache.getSpriteFrame(String.formatC(t.strPic,a)));var o=new l.Animation(r,t.fSpanSecond),h=l.repeatForever(l.animate(o));h.setTag(rr.REPEATACTION),i&&i.runAction(h)}i&&i.setPosition(e)},hideUpdateTip:function(e){if(this.hotSprites)for(var t in this.hotSprites){var i=this.hotSprites[t];if(i&&i.type==ee.UPDATETIP&&i.x==e.x&&i.y==e.y){i.pauseActions();break}}},showLastWaveTip:function(){var e=wr.getModel().getObjectByType(J.LASTWAVETIP),t=nr.share().getWinSize(),i=this.findSpriteWithType(ee.LASTWAVE);if(i)i.setVisible(!0),i.setOpacity(255);else{var n=l.spriteFrameCache.getSpriteFrame(e.strPic);(i=new Sc).initWithSpriteFrame(n),i.type=ee.LASTWAVE,i.setAnchorPoint(.5,.5),this.addChild(i,9)}var s=nr.share().isIPad()?1:.5;i.setPosition(t.width/2,700*s);var r=l.moveTo(.2,t.width/2,580*s),a=l.moveTo(.1,t.width/2,610*s),o=l.delayTime(3),h=l.moveTo(.1,t.width/2,580*s),d=l.moveTo(.2,t.width/2,700*s),c=l.callFunc(i.hideCall,i),u=l.sequence(r,a,o,h,d,c);u.setTag(rr.REPEATACTION),i.runAction(u)},showBuildSpace:function(){var e=wr.getModel(),t=e.getObjectByType(J.TOWERSELCENTER),i=String.formatC(t.strPic,0),n=l.spriteFrameCache.getSpriteFrame(i),s=e.szTileRng,r=0;for(var a in e.buildspace)for(var o=e.buildspace[a],h=parseInt(o.width/s.width),d=parseInt(o.height/s.height),c=0;c<d;c++)for(var u=0;u<h;u++){var p=l.pAdd(l.p(o.x,o.y),l.p((u+.5)*s.width,(c+.5)*s.height)),m=!1;for(var _ in e.towers){var g=e.towers[_];l.rectContainsPoint(g.getBoundingBox(),p)&&(m=!0)}if(!m){var T=new l.Sprite(n);T.setPosition(p),T.runAction(l.repeatForever(l.sequence(l.fadeOut(1),l.fadeIn(1)))),this.addChild(T,0,2e3+r),r++}}},resumeObjAndChild:function(e){e.resume();for(var t in e.getChildren())this.resumeObjAndChild(e.getChildren()[t])},pasuObjAndChild:function(e){e.pause();for(var t in e.getChildren())this.pasuObjAndChild(e.getChildren()[t])},reShowCountDownTip:function(e){e=e||!1;var t=wr.getModel();null!=this.getChildByTag(1222)||null!=this.getChildByTag(2048)||0!=this.countDownTime&&101!=this.countDownTime||(t.bLockMenu=!0,this.countDownTime=0,this.timeTip&&this.timeTip.removeFromParent(),e&&(this.countDownTime=-1),this.timeTip=null,this.mbReShowCount=!0,this.pasuObjAndChild(t.gameLayer),Bc=l.director.getScheduler().getTimeScale(),l.director.getScheduler().setTimeScale(1),this.schedule(this.showCountDownTip,.1))},showCountDownTip:function(e){var t=++this.countDownTime,i=wr.getModel();if(0==t)return i.gameLayer.gameHUD.bBeforeStart=!0,this.showBuildSpace(),this.showMonsterCome(),i.pauseAllMonsterAndTower(),this.unschedule(this.showCountDownTip),void this.schedule(this.showCountDownTip,.1);if(t%10==1){t=parseInt((t+9)/10);var n=i.getObjectByType(J.COUNTDOWN);if(this.countDownTime>40){this.mbReShowCount&&(this.resumeObjAndChild(i.gameLayer),this.mbReShowCount=!1,l.director.getScheduler().setTimeScale(Bc)),this.unschedule(this.showCountDownTip);T=null;return(T=l.sequence(l.scaleTo(.1,0),l.callFunc(this.hideCountDownTip,this))).setTag(rr.STOPMOVE),this.timeTip.runAction(T),i.gameLayer.gameHUD.playGameMusic(),void i.gameLayer.gameHUD.registerWithTouchDispatcher(!0)}if(0==i.bRestart&&t<4&&i.playSoundWithType($.MTCOUNTDOWN),null==this.timeTip){_=String.formatC(n.strPic,1,1);this.timeTip=new l.Sprite(_);var s=nr.share().getWinSize();this.timeTip.setAnchorPoint(.5,.5),this.timeTip.setPosition(.5*s.width,.63*s.height),this.addChild(this.timeTip,1e4);var r=null;if(0==i.bRestart&&(_=String.formatC(n.strPic,0,3),(r=new l.Sprite(_)).setScale(0),r.setAnchorPoint(.5,.5),r.setPosition(.5*this.timeTip.width,.317*this.timeTip.height),this.timeTip.addChild(r,2,1),r.runAction(l.scaleTo(.1,1))),_=String.formatC(n.strPic,1,2),(r=new l.Sprite(_)).setAnchorPoint(.5,.5),r.setPosition(.5*this.timeTip.width,.5*this.timeTip.height),this.timeTip.addChild(r,1),i.m_nGameMode==ge.HIGHERMODE){nr.share().isIPad()&&1;var a=new l.Sprite("countdown_11_floor.png");a.setPosition(r.width/2,r.height/2),r.addChild(a);var o=new l.LabelAtlas("00","countdown_11_floor_num.png",22,34,"./0123456789");o.setString(String.formatC("%02d",i.m_oHigher.getPassCount())),GamePlatform.isCN()?o.setPosition(99,209):o.setPosition(89,209),o.setAnchorPoint(.5,.5),r.addChild(o)}r.setScaleY(.05);var h=l.sequence(l.scaleTo(.1,1,1.2),l.scaleTo(.05,1));r.runAction(h),_=String.formatC(n.strPic,1,3),(r=new l.Sprite(_)).setScale(0),r.setAnchorPoint(.5,.5),r.setPosition(.5*this.timeTip.width,.317*this.timeTip.height),this.timeTip.addChild(r,3);var d=l.callFunc(this.playGoMusic.bind(this)),c=l.sequence(l.delayTime(i.bRestart?.1:3.4),l.scaleTo(.01,.05),l.scaleTo(.1,1.3),d,l.scaleTo(.1,1),l.delayTime(.5),l.fadeOut(.01));r.runAction(c),_=String.formatC(n.strPic,1,4),(r=new l.Sprite(_)).setScale(0),r.setAnchorPoint(.5,.5),r.setPosition(.5*this.timeTip.width,.317*this.timeTip.height),this.timeTip.addChild(r,4);var u=l.sequence(l.delayTime(i.bRestart?.8:4.1),l.scaleTo(.01,.05),l.scaleTo(.19,2));r.runAction(u);var p=new l.LayerColor(l.color(0,0,0,178),s.width,s.height);this.addChild(p,1999,1999),p.runAction(l.sequence(l.delayTime(i.bRestart?1.1:4.4),l.fadeOut(.1))),i.bRestart&&(this.countDownTime=31)}else if(t<4){if(!(r=this.timeTip.getChildByTag(1)))return;var m=4-t,_=String.formatC(n.strPic,0,m),g=l.spriteFrameCache.getSpriteFrame(_);r.setSpriteFrame(g),r.setScale(.05),r.setOpacity(255);var T=l.sequence(l.scaleTo(.1,1.3),l.scaleTo(.1,1),l.delayTime(.75),l.fadeOut(.01));r.runAction(T)}}},playGoMusic:function(){wr.getModel().playSoundWithType($.MTGOPLAY)},hideCountDownTip:function(){var e=wr.getModel();e.resumeAllMonsterAndTower(),e.playMuiscWithType($.MTWARBGMSC,1,!0),e.bLoopPath&&e.gameLayer.gameHUD.showBossModeTimeBar(),this.timeTip.setVisible(!1),this.removeChild(this.timeTip,!0),e.bLockMenu=!1,e.bGameStart=!0,e.gameLayer.gameHUD.bBeforeStart=!1,this.countDownTime=101;for(var t=1999;;t++){var i=this.getChildByTag(t);if(!i)break;this.removeChild(i,!0)}},showMonsterCome:function(){var e=wr.getModel();if(this.countDownTime>103)return this.countDownTime=0,void e.gameLayer.schedule(e.gameLayer.nextWave);if(e.waypoints){var t=e.waypoints[0],i=e.waypoints[1],n=!1,s=0;t.y==i.y?t.x>i.x&&(n=!0):s=t.y>i.y?90:-90;var r,a,o=!1,h=0;e.waypoints2.length>0&&(r=e.waypoints2[0],a=e.waypoints2[1],o=!1,h=0,r.y==a.y?r.x>a.x&&(o=!0):h=r.y>a.y?90:-90);for(var d=e.getObjectByType(J.MONSTERCOME),c=d.nHP,u=0;u<c&&e.gameLayer;u++){var p=e.gameLayer.getChildByTag(ee.MSTCOMEARROW+u);if(null==p){_=l.spriteFrameCache.getSpriteFrame(d.strPic);p=new l.Sprite(_),e.gameLayer.addChild(p,sr.LPATHSTART,ee.MSTCOMEARROW+u)}if(p.setPosition(l.pAdd(t,t.y==i.y?l.p((n?-1:1)*p.width*(1+.82*u),.5*-p.height):l.p(0,(s>0?-1:1)*p.width*(1+.82*u)))),p.setFlippedX(n),p.setRotation(s),p.setOpacity(0),p.setScale(.5),e.waypoints2.length>0){var m=e.gameLayer.getChildByTag(ee.MSTCOMEARROW+3+u);if(null==m){var _=l.spriteFrameCache.getSpriteFrame(d.strPic);m=new l.Sprite(_),e.gameLayer.addChild(m,sr.LPATHSTART,ee.MSTCOMEARROW+3+u)}m.setPosition(l.pAdd(r,r.y==a.y?l.p((o?-1:1)*m.width*(1+.82*u),.5*-m.height):l.p(0,(h>0?-1:1)*m.width*(1+.82*u)))),m.setFlippedX(o),m.setRotation(h),m.setOpacity(0),m.setScale(.5),m.runAction(l.sequence(l.delayTime(u*d.fSpanSecond),l.spawn(l.scaleTo(d.fSpanSecond,1),l.fadeIn(d.fSpanSecond)),l.delayTime(.001*d.nRunSpeed),l.fadeOut(.001*d.nMoney)))}var g=null;u+1==c?(g=l.callFunc(this.showMonsterCome.bind(this)),p.runAction(l.sequence(l.delayTime(u*d.fSpanSecond),l.spawn(l.scaleTo(d.fSpanSecond,1),l.fadeIn(d.fSpanSecond)),l.delayTime(.001*d.nRunSpeed),l.fadeOut(.001*d.nMoney),g))):p.runAction(l.sequence(l.delayTime(u*d.fSpanSecond),l.spawn(l.scaleTo(d.fSpanSecond,1),l.fadeIn(d.fSpanSecond)),l.delayTime(.001*d.nRunSpeed),l.fadeOut(.001*d.nMoney)))}this.countDownTime>100&&this.countDownTime++}},showExplodeWithTower:function(e,t){var i=e,n=ar.PBOTTLE+(i.type-J.TBOTTLE),s=i.strProjPic,r=i.fProjExpSpanSecd,a=i.nProjExpPicCount,o=this.findSpriteWithType(n);if(null==o){var h=l.spriteFrameCache.getSpriteFrame(String.formatC(s,0,a));(o=new Sc).initWithSpriteFrame(h),o.type=n,o.setAnchorPoint(.5,.5),this.hotSprites.push(o),this.addChild(o,n-ar.PTYPESTART,n)}else o.setVisible(!0),o.setOpacity(255);o.setPosition(t);for(var d=[],c=1;c<=a;++c)d.push(l.spriteFrameCache.getSpriteFrame(String.formatC(s,0,c)));var u=new l.Animation(d,r),p=l.animate(u),m=l.fadeOut(i.fProjExpFadeSecd),_=l.callFunc(o.hideCall,o),g=l.sequence(p,m,_);g.setTag(n),o.runAction(g)},showSelPointWithSprite:function(e,t){if(0!=t){if(e!=this.beSelGoods){this.beSelGoods&&e!=this.beSelGoods&&this.selObjectAnimate&&(this.beSelGoods.define.type>J.OBJECTEND?this.beSelGoods.removeChild(this.selObjectAnimate,!0):this.removeChild(this.selObjectAnimate,!0));var i=wr.getModel().getObjectByType(J.SELPOINT);if(null==this.selObjectAnimate){var n=String.formatC(i.strPic,1);this.selObjectAnimate=new l.Sprite(n)}if(null==this.selObjectAnimate.getActionByTag(rr.REPEATACTION)){for(var s=[],r=1;r<=i.nPicCount;++r)s.push(l.spriteFrameCache.getSpriteFrame(String.formatC(i.strPic,r)));s.push(l.spriteFrameCache.getSpriteFrame(String.formatC(i.strPic,i.nPicCount)));var a=new l.Animation(s,i.fSpanSecond),o=l.repeatForever(l.animate(a));o.setTag(rr.REPEATACTION),this.selObjectAnimate.setAnchorPoint(.5,0),this.selObjectAnimate.runAction(o)}this.selObjectAnimate.setVisible(!0),e.define.type>J.OBJECTEND?(this.selObjectAnimate.getParent()!=e&&(this.selObjectAnimate.setParent(null),e.addChild(this.selObjectAnimate,ee.OBJECTSEL)),this.selObjectAnimate.setPosition(.5*e.width,e.height-6)):(this.selObjectAnimate.getParent()!=this&&(this.selObjectAnimate.setParent(null),this.addChild(this.selObjectAnimate,ee.LSELECT)),this.selObjectAnimate.setPosition(l.pAdd(e.getPosition(),l.p(0,.5*(e.height-6))))),this.beSelGoods=e}}else e==this.beSelGoods&&(this.selObjectAnimate&&(this.selObjectAnimate.setVisible(!1),e.define.type>J.OBJECTEND?e.removeChild(this.selObjectAnimate,!0):this.removeChild(this.selObjectAnimate,!0)),this.beSelGoods=null)},findSpriteWithType:function(e){var t=null,i=[];switch(e){case ee.DUST:case ee.LASTWAVE:case ee.TOWERAIR:case ee.TOWERBUFF:i=this.coolSprites;break;case ee.MONEYS:case ee.UPDATETIP:case ar.PBOTTLE:case ar.PSHIT:case ar.PSTAR:case ar.PFAN:case ar.PBALL:default:i=this.hotSprites}for(var n in i){var s=i[n];if(s&&s.bFree&&s.type==e){s.bFree=!1,t=s;break}}return t},getAnimeSpriteWithPic:function(e,t){var i=this.findSpriteWithType(t);if(!i){var n=l.spriteFrameCache.getSpriteFrame(e);if(n&&(i=new Sc)){switch(i.initWithSpriteFrame(n),i.type=t,t){case ee.DUST:case ee.TOWERAIR:case ee.TOWERBUFF:i.setAnchorPoint(.5,.5),this.coolSprites.push(i);break;case ee.MONEYS:case ee.UPDATETIP:i.setAnchorPoint(.5,0),this.hotSprites.push(i)}this.addChild(i,t)}}return i&&(i.setVisible(!0),i.setOpacity(255),i.setScale(1)),i},onExit:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),this.timeTip=null,this.selObjectAnimate=null,this.towerUpdatelower=null,this.towerUpdateUpper=null,this.towerMagic1=null,this.towerMagic2=null,this.towerMagic3=null,this.towerMagic4=null,this.towerMagic5=null,this.removeAllChildrenWithCleanup(!0),qu.clearOwner(this),this._super()},init:function(){return!!this._super()&&(this.hotSprites=[],this.coolSprites=[],this.timeTip=null,this.countDownTime=-1,this.selObjectAnimate=null,this.towerUpdatelower=null,!0)},clearSprites:function(){this.selObjectAnimate&&this.selObjectAnimate.setVisible(!1);var e=[this.hotSprites,this.coolSprites];for(var t in e){var i=e[t];for(var n in i){var s=i[n];s&&s.removeFromParent()}i.length=0}},showBuffFalshWithTowe:function(e){var t=this.getAnimeSpriteWithPic("PBuff01.png",ee.TOWERBUFF);t.setPosition(e),t.setOpacity(0),t.runAction(l.repeatForever(l.sequence(l.fadeIn(.5),l.fadeOut(.5),l.fadeIn(.5),l.fadeOut(.5),l.fadeIn(.5),l.fadeOut(.5),l.delayTime(3))))},moveBuffFalsh:function(e){for(var t in this.coolSprites){var i=this.coolSprites[t];if(l.pointEqualToPoint(i.getPosition(),e)&&i.type==ee.TOWERBUFF){i.hideCall();break}}},showPropMagic:function(e){var t=wr.getModel(),i=nr.share().getWinSize();if(nr.share().isIPad()&&1,l.spriteFrameCache.addSpriteFrames("res/Themes/Items/PropMagic-hd.plist"),"ice"===e){N=l.spriteFrameCache.getSpriteFrame("magic_ice_1.png");null==this.towerMagic1?(this.towerMagic1=new l.Sprite(N),this.towerMagic1.setPosition(i.width/2,i.height/2),this.addChild(this.towerMagic1,9999)):this.towerMagic1.setSpriteFrame(N),this.towerMagic1.setScale(.1),this.towerMagic1.setVisible(!0);var n=l.scaleTo(.2,5),s=l.delayTime(.8),r=l.hide();this.towerMagic1.runAction(l.sequence(l.show(),n,s,r)),N=l.spriteFrameCache.getSpriteFrame("magic_ice_3.png"),null==this.towerMagic3?(this.towerMagic3=new l.Sprite(N),this.towerMagic3.setPosition(i.width/2,i.height/2),this.addChild(this.towerMagic3,9999)):this.towerMagic3.setSpriteFrame(N),this.towerMagic3.setScale(1.5),this.towerMagic3.setOpacity(0),this.towerMagic3.setVisible(!0);var a=l.delayTime(.3),o=l.fadeIn(.2),h=l.delayTime(.4),d=l.scaleTo(.2,4);this.towerMagic3.runAction(l.sequence(a,o,h,d,r)),N=l.spriteFrameCache.getSpriteFrame("magic_ice_3.png"),null==this.towerMagic4?(this.towerMagic4=new l.Sprite(N),this.towerMagic4.setPosition(i.width/2,i.height/2),this.addChild(this.towerMagic4,9999)):this.towerMagic4.setSpriteFrame(N),this.towerMagic4.setScale(4),this.towerMagic4.setOpacity(255),this.towerMagic4.setVisible(!0);var c=l.fadeOut(.2),u=l.scaleTo(.2,1),p=l.delayTime(.6);this.towerMagic4.runAction(l.sequence(a,l.spawn(c,u),p,r)),null==this.towerMagic5&&(this.towerMagic5=new l.Sprite("magic_spark.png"),this.towerMagic5.setPosition(i.width/2,i.height/2),this.addChild(this.towerMagic5,9999)),this.towerMagic5.setScale(.1),this.towerMagic5.setVisible(!0);var m=l.delayTime(.5),_=l.scaleTo(.4,4);this.towerMagic5.runAction(l.sequence(m,_,l.hide())),N=l.spriteFrameCache.getSpriteFrame("magic_ice_2.png"),null==this.towerMagic2?(this.towerMagic2=new l.Sprite(N),this.towerMagic2.setPosition(i.width/2,i.height/2),this.addChild(this.towerMagic2,9999)):this.towerMagic2.setSpriteFrame(N),this.towerMagic2.setScale(.1),this.towerMagic2.setVisible(!0);var g=l.rotateTo(.1,360),T=l.scaleTo(.1,1),f=l.scaleTo(.8,1.2),S=l.scaleTo(.1,5);this.towerMagic2.runAction(l.sequence(l.spawn(g,T),f,S,r)),t.gameLayer.gameHUD.showIceLastMagic()}else if("bomb"===e)for(var w=1;w<=9;w++){var v,L=1;switch(w){case 1:v=l.p(658,401),L=.6;break;case 2:v=l.p(135,492),L=.8;break;case 3:v=l.p(407,426);break;case 4:v=l.p(532,517),L=.8;break;case 5:v=l.p(718,271);break;case 6:v=l.p(823,602);break;case 7:v=l.p(287,567),L=.6;break;case 8:v=l.p(427,192),L=.8;break;case 9:v=l.p(137,223),L=.6}var M=this.getChildByTag(wc+w),C=nr.share().getMapOffset();if(null==M){(M=new l.Sprite("magic_bomb_1.png")).setPosition(C.width+v.x,i.height+M.height),M.setScale(L),M.setTag(wc+w),this.addChild(M,9998);for(var y=[],B=1;B<=4;++B)y.push(l.spriteFrameCache.getSpriteFrame(String.formatC("magic_bomb_%d.png",B)));var F=new l.Animation(y,.1);M.runAction(l.repeatForever(l.animate(F)))}else M.setPosition(C.width+v.x,i.height+M.height/2),M.setVisible(!0);var E=(M.y-v.y-100)/50*.1,P=l.moveTo(E,C.width+v.x,v.y+100),b=l.moveTo(.2,C.width+v.x,v.y),A=l.callFunc(this.BombProjectileExplode.bind(this,M));M.runAction(l.sequence(l.delayTime(.1*(w-1)),P,A,b,l.hide()))}else if("blood"===e){var O=this.getChildByTag(Lc);null==O?(O=new l.Sprite("magic_blood_1.png"),this.addChild(O,9999,Lc)):(O.setVisible(!0),O.setRotation(0));A=l.callFunc(this.addCarrotBlood.bind(this));if(O.setPosition(nr.share().getMapOffset().width+479,318),O.setScale(.05),O.runAction(l.sequence(l.scaleTo(.2,1.2),l.scaleTo(.1,1),l.delayTime(.3),l.scaleTo(.1,1.5),l.scaleTo(.1,1),l.scaleTo(.1,1.3),l.scaleTo(.1,1),l.delayTime(.3),l.spawn(l.rotateTo(.2,-30),l.scaleTo(.2,.05),l.moveTo(.2,t.waypoints[t.waypoints.length-1])),A,l.hide())),t.m_nGameMode==ge.DOUBLECARROT){var I=this.getChildByTag(Mc);null==I?(I=new l.Sprite("magic_blood_1.png"),this.addChild(I,9999,Mc)):(I.setVisible(!0),I.setRotation(0)),I.setPosition(nr.share().getMapOffset().width+479,318),I.setScale(.05),I.runAction(l.sequence(l.scaleTo(.2,1.2),l.scaleTo(.1,1),l.delayTime(.3),l.scaleTo(.1,1.5),l.scaleTo(.1,1),l.scaleTo(.1,1.3),l.scaleTo(.1,1),l.delayTime(.3),l.spawn(l.rotateTo(.2,-30),l.scaleTo(.2,.05),l.moveTo(.2,t.waypoints2[t.waypoints2.length-1])),l.hide()))}}else if("speed"===e){var R=this.getChildByTag(Cc);null==R?((R=new l.Sprite("magic_speed_2.png")).setPosition(i.width/2,i.height/2),this.addChild(R,9999,Cc)):R.setVisible(!0),R.setScale(.05),R.runAction(l.sequence(l.spawn(l.rotateBy(1,360),l.scaleTo(1,5)),l.hide()));var D=this.getChildByTag(Cc+1);null==D?((D=new l.Sprite("magic_speed_3.png")).setPosition(i.width/2,i.height/2),this.addChild(D,9999,Cc+1)):D.setVisible(!0),D.setScale(5),D.setOpacity(127),D.runAction(l.sequence(l.spawn(l.rotateBy(.5,360),l.fadeTo(.5,255),l.scaleTo(.5,2)),l.hide())),null==(X=this.getChildByTag(Cc+2))&&((X=new l.Sprite("magic_spark.png")).setPosition(i.width/2,i.height/2),this.addChild(X,9999,Cc+2),X.setVisible(!1)),X.setScale(.1),X.runAction(l.sequence(l.delayTime(.5),l.show(),l.scaleTo(.4,4),l.hide()));var x=this.getChildByTag(Cc+3);null==x?((x=new l.Sprite("magic_speed_1.png")).setPosition(i.width/2,i.height/2),this.addChild(x,9999,Cc+3)):x.setVisible(!0),x.setScale(.1),x.runAction(l.sequence(l.scaleTo(.1,1),l.scaleTo(.8,1.2),l.scaleTo(.1,5),l.hide()))}else if("slow"===e){var N=l.spriteFrameCache.getSpriteFrame("magic_slow_2.png"),G=this.getChildByTag(yc+1);null==G?(G=new l.Sprite(N),this.addChild(G,9999,yc+1)):G.setVisible(!0);var W=0,k=0;W=1136==i.width?1250:1250-nr.share().getMapOffset().width,G.setPosition(W,330),G.setScaleX(2.6),G.setScaleY(5.5),G.runAction(l.sequence(l.spawn(l.moveTo(1,50,330),l.scaleTo(1,5.6,5.5)),l.hide()));var U=this.getChildByTag(yc+2);null==U&&(U=new l.Sprite(N),this.addChild(U,9999,yc+2),U.setVisible(!1)),1136==i.width?(W=2150,k=-1e3):(W=2150-nr.share().getMapOffset().width,k=-1e3+nr.share().getMapOffset().width),U.setPosition(W,270),U.setScaleX(4),U.setScaleY(4),U.runAction(l.sequence(l.delayTime(.4),l.show(),l.moveTo(.6,l.p(k,270)),l.hide()));var H=this.getChildByTag(yc+3);null==H&&(H=new l.Sprite(N),this.addChild(H,9999,yc+3),H.setVisible(!1)),1136==i.width?(W=-450,k=1590):(W=-450+nr.share().getMapOffset().width,k=1590-nr.share().getMapOffset().width),H.setPosition(W,620),H.setScaleX(1.8),H.setScaleY(1.8),H.runAction(l.sequence(l.delayTime(.3),l.show(),l.moveTo(.4,l.p(k,620)),l.hide()));var V=this.getChildByTag(yc+4);null==V&&(V=new l.Sprite(N),this.addChild(V,9999,yc+4),V.setVisible(!1)),1136==i.width?(W=1386,k=-250):(W=1386-nr.share().getMapOffset().width,k=-250+nr.share().getMapOffset().width),V.setPosition(W,120),V.setScaleX(1),V.setScaleY(1),V.runAction(l.sequence(l.delayTime(.3),l.show(),l.moveTo(.4,l.p(k,120)),l.hide()));var z=this.getChildByTag(yc+5);null==z&&(z=new l.Sprite(N),this.addChild(z,9999,yc+5),z.setVisible(!1)),1136==i.width?(W=1151,k=-425):(W=1151-nr.share().getMapOffset().width,k=-425+nr.share().getMapOffset().width),z.setPosition(W,515),z.setScaleX(2.1),z.setScaleY(1.65),z.runAction(l.sequence(l.delayTime(.2),l.show(),l.moveTo(.2,l.p(k,515)),l.hide()));var Y=this.getChildByTag(yc+6);null==Y&&(Y=new l.Sprite(N),this.addChild(Y,9999,yc+6),Y.setVisible(!1)),1136==i.width?(W=-532,k=1689):(W=-532+nr.share().getMapOffset().width,k=1689-nr.share().getMapOffset().width),Y.setPosition(W,176),Y.setScaleX(2.272),Y.setScaleY(1),Y.runAction(l.sequence(l.delayTime(.3),l.show(),l.moveTo(.2,l.p(k,176)),l.hide()));var X=this.getChildByTag(yc+7);null==X&&((X=new l.Sprite("magic_spark.png")).setPosition(i.width/2,i.height/2),this.addChild(X,9999,yc+7),X.setVisible(!1)),X.setScale(.1),X.runAction(l.sequence(l.delayTime(.5),l.show(),l.scaleTo(.4,4),l.hide()));var j=this.getChildByTag(yc+8);null==j?((j=new l.Sprite("magic_slow_1.png")).setPosition(i.width/2,i.height/2),this.addChild(j,9999,yc+8)):j.setVisible(!0),j.setScaleX(.1),j.runAction(l.sequence(l.scaleTo(.1,1),l.scaleTo(.8,1.2),l.scaleTo(.1,5),l.hide()))}},BombProjectileExplode:function(e){var t,i=wr.getModel(),n=e.getTag()-wc,s=1;switch(n){case 1:t=l.p(658,401),s=.6;break;case 2:t=l.p(135,492),s=.8,i.gameLayer.gameHUD.dropBigbomb(5);break;case 3:t=l.p(407,426);break;case 4:t=l.p(532,517),s=.8;break;case 5:t=l.p(718,271),i.gameLayer.gameHUD.dropBigbomb(5);break;case 6:t=l.p(823,602);break;case 7:t=l.p(287,567),s=.6;break;case 8:t=l.p(427,192),s=.8;break;case 9:t=l.p(137,223),s=.6,i.gameLayer.gameHUD.dropBigbomb(5)}var r=this.getChildByTag(vc+n),a=nr.share().getMapOffset();null==r?((r=new l.Sprite("magic_bomb_smoke_1.png")).setPosition(a.width+t.x,t.y),r.setScale(s),r.setTag(vc+n),this.addChild(r,9999)):r.setVisible(!0);for(var o=[],h=1;h<=7;++h)o.push(l.spriteFrameCache.getSpriteFrame(String.formatC("magic_bomb_smoke_%d.png",h)));var d=new l.Animation(o,.1);r.runAction(l.sequence(l.animate(d),l.hide()))},addCarrotBlood:function(){wr.getModel().gameLayer.gameHUD.dropBigbomb(4)}});Fc.create=function(){return Qs(Fc)};var Ec=l.SpriteBatchNode.extend({m_nType:0,ctor:function(){this._super(),this.ptEnd=l.p(0,0)},SetType:function(e){this.m_nType=e},GetType:function(){return this.m_nType}});Ec.createWithTexture=function(e,t){var i=new Ec;return i.initWithTexture(e,t),i};var Pc=Xs.extend({BG:null,houselife:null,house:null,selTowerUpdate:null,curSelTower:null,gameHUD:null,additionalTowers:null,szContentCount:null,bInCheckConfig:!1,arryBatchTower:null,nGameState:0,m_secondHouseLife:null,m_secondHouse:null,resList:[],map:null,ctor:function(e){this.map=e,this._super(),this.selTowerUpdate=[],this.additionalTowers=[],this.arryBatchTower=[]},onEnter:function(){this._super();var e=wr.getModel(),t=e.curLevel;qu.perloadWithKey("GameOverwin"),qu.perloadWithKey("GameOverlose"),e.canShareMessData()&&qu.perloadWithKey("MessShare"),t==O.MAINLEVELCOUNT&&e.m_nGameMode==ge.NORMALMODE&&qu.perloadWithKey("GameFinal"),this.map=null},addRes:function(e){qu.addRes(this,e)},clearRes:function(){for(var e in this.resList){var t=this.resList[e];l.spriteFrameCache.removeSpriteFramesFromFile(t)}this.resList.length=0},canBuildOnTilePosition:function(e){var t=wr.getModel(),i=null;for(var n in t.buildspace){var s=i=t.buildspace[n];if(l.rectContainsPoint(s,e))return!0}return!1},replaceAllObjects:function(){},addObjects:function(){for(var e=this.map,t=l.size(25,70),i=wr.getModel(),n=e.getObjectGroup(O.kMPath),s=e.getProperty(O.kMPObj).split(","),r=0;r<3;r++)if(1!=r)this.addRes(String.formatC(i.gameObjectConfig.strItemsPic,r));else switch(i.usersData.getCarrotFigure()){case ue.CARROT_NORMAL:this.addRes(String.formatC(i.gameObjectConfig.strItemsPic,r));break;case ue.CARROT_FAT:this.addRes(String.formatC(i.gameObjectConfig.strItemsPic,7))}this.addRes(String.formatC(i.gameObjectConfig.strMonsterPic,10==i.curTheme?1:i.curTheme)),this.addRes("res/Themes_cn/Items/FTMonsters-hd.plist");for(var a in i.curMapConfig.towerType){var o=parseInt(i.curMapConfig.towerType[a]);if(o>=0){var h=i.gameObjectConfig.towerGroup[o].strPicGroup;this.addRes(h)}}if(this.addRes(String.formatC(i.gameObjectConfig.strObjectPic,10==i.curTheme?1:i.curTheme)),i.curMapConfig.bPresentGate){var d=String.formatC(i.gameObjectConfig.strGatePic,10==i.curTheme?1:i.curTheme);this.addRes(d)}var c=null,u=i.curMapConfig.fObjectHP,p=i.m_nGameMode==ge.HIGHERMODE&&i.m_oHigher.isHalfBattle();i.m_nGameMode==ge.HIGHERMODE&&p&&i.m_oHigher.loadObjects();for(var m=null,_=s.length,g=0;g<_;g++)for(r=1;;r++){var T=s[g],f=f=T+"Ob"+r;if(null==(m=n.getObject(f)))break;var S=String.formatC("%s.png",T),w=0;-1!=T.indexOf("SC")?w=3:-1!=T.indexOf("BC")?w=4:-1!=T.indexOf("DB")?w=5:-1!=T.indexOf("S")?w=0:-1!=T.indexOf("L")?w=1:-1!=T.indexOf("B")&&(w=2);var v=J.SMALLOBJECT1+w,L=-1,M=.5*m.width,C=.5*m.height,y=m.x+M+t.width+nr.share().getMapOffset().width,B=m.y+C+t.height;L=m.x/70<<4|m.y/70;var E=0;if(p){for(var P=i.buildspace.length,b=0;b<P;b++){var A=i.buildspace[b];if(l.pointEqualToPoint(l.p(A.x,A.y),l.p(y,B))){E=parseInt(A.width),i.buildspace.splice(b,1);break}}if(E<1)continue}if(null==(c=new Tc(v,S,f)))break;if(c.gridIndex=L,c.scaleHP(u),E&&(c.curHP=c.curHPTOBe=E),void 0!=(d=m.RT)&&d.length>0){null==i.randomTowers&&(i.randomTowers=[]);Y=dr.create(l.rect(m.x+t.width+nr.share().getMapOffset().width,m.y+t.height,m.width,m.height),d);i.randomTowers.push(Y)}if(c.nToBeTowerType=m.type?parseInt(m.type):0,c.setFlippedX(!!m.flipx&&m.flipx),c.setFlippedY(!!m.flipy&&m.flipy),c.bAddTime=m.AT,c.setPosition(y,B),5==w){var I=c.getChildByTag(1011);I&&(I.setFlippedX(!!m.flipx&&m.flipx),I.setFlippedY(!!m.flipy&&m.flipy))}if(this.addChild(c,sr.LOBJECT),i.objects.push(c),J.BIGOBJECT3==v&&1==i.curTheme||10==i.curTheme){var R=l.moveTo(1.5,l.pAdd(c.getPosition(),l.p(0,2))),D=l.moveTo(2.5,l.pSub(c.getPosition(),l.p(0,2))),x=l.repeatForever(l.sequence(R,D,l.delayTime(F()%7+2)));x.setTag(rr.REPEATACTION),c.runAction(x)}}for(var N,G=1,M=.5*i.szTileRng.width,C=i.szTileRng.height/16,r=1;r<100;r++){if(N=n.getObject(String.formatC("PT%d",G))){var y=N.x+M+t.width+nr.share().getMapOffset().width+nr.share().getAndroid_MapOffset().width,B=N.y-C+t.height;i.waypoints.push(l.p(y,B)),i.waypointsstring.push(String.formatC("PT%d",G))}else{if(!(N=n.getObject(String.formatC("PT%d01",G))))break;var y=N.x+M+t.width+nr.share().getMapOffset().width+nr.share().getAndroid_MapOffset().width,B=N.y-C+t.height;if(i.waypoints.push(l.p(y,B)),i.waypointsstring.push(String.formatC("PT%d01",G)),N=n.getObject(String.formatC("PT%d02",G))){var y=N.x+M+t.width+nr.share().getMapOffset().width+nr.share().getAndroid_MapOffset().width,B=N.y-C+t.height;i.waypoints.push(l.p(y,B)),i.waypointsstring.push(String.formatC("PT%d02",G))}}G++}var W=i.waypoints[0],k=i.waypoints[i.waypoints.length-1];l.pointEqualToPoint(W,k)&&(i.waypoints.push(l.p(i.waypoints[1].x,i.waypoints[1].y)),i.bLoopPath=!0),G=1;for(r=1;r<100;r++){if(N=n.getObject(String.formatC("2PT%d",G))){var y=N.x+M+t.width+nr.share().getMapOffset().width+nr.share().getAndroid_MapOffset().width,B=N.y-C+t.height;i.waypoints2.push(l.p(y,B)),i.waypointsstring2.push(String.formatC("2PT%d",G))}else{if(!(N=n.getObject(String.formatC("2PT%d01",G))))break;var y=N.x+M+t.width+nr.share().getMapOffset().width+nr.share().getAndroid_MapOffset().width,B=N.y-C+t.height;if(i.waypoints2.push(l.p(y,B)),i.waypointsstring2.push(String.formatC("2PT%d01",G)),N=n.getObject(String.formatC("2PT%d02",G))){var y=N.x+M+t.width+nr.share().getMapOffset().width+nr.share().getAndroid_MapOffset().width,B=N.y-C+t.height;i.waypoints2.push(l.p(y,B)),i.waypointsstring2.push(String.formatC("2PT%d02",G))}}G++}var U=i.monsterDifSpeed();for(var b in U){H=U[b];(V=new Tn).setSpeed(H,i.waypoints),i.creepspeed.push(V)}if(i.creepspeed2)for(var b in U){var H=U[b],V=new Tn;V.setSpeed(H,i.waypoints2),i.creepspeed2.push(V)}if(i.m_nGameMode==ge.HIGHERMODE&&i.m_oHigher.isHalfBattle())i.m_oHigher.loadBuildPlace();else for(G=1;N=n.getObject("Obj"+G);){var z=A=l.rect(N.x+t.width+nr.share().getMapOffset().width,N.y+t.height,N.width,N.height);if(i.buildspace.push(z),G++,void 0!=(d=N.RT)&&d.length>0){null==i.randomTowers&&(i.randomTowers=[]);var Y=dr.create(A,d);i.randomTowers.push(Y)}}for(X=1;X<10;X++)if(null!=(N=n.getObject(X+"TP1"))){for(var s=[],b=1;b<=2;b++){var y=(N=n.getObject(String.formatC("%dTP%d",X,b))).x+M+t.width+nr.share().getMapOffset().width+nr.share().getAndroid_MapOffset().width,B=N.y-M+t.height;s.push(l.p(y,B))}i.slideWay.push(s)}for(var X=1;X<10;X++)if(null!=(N=n.getObject(X+"TPT1"))){for(var s=[],b=1;b<=2;b++){var M=.5*(N=n.getObject(String.formatC("%dTPT%d",X,b))).width,C=.5*N.height,y=N.x+M+t.width+nr.share().getMapOffset().width,B=N.y+C+t.height,j=new It;j.initWithFrameName("#slidewaybase.png"),j.setPosition(y,B),j.SetIndex(b),this.addChild(j,sr.LTOWER),s.push(j)}i.slideWayBase.push(s)}},addTower:function(){var e=wr.getModel();if(e.m_nGameMode==ge.HIGHERMODE&&e.m_oHigher.isHalfBattle())e.m_oHigher.loadTower();else{var t;nr.share().isIPad()&&1;var i=l.size(25,70),n=(l.size(70,70),this.map);l.log("★★★ 加載的地圖是:"+e.getMapPath());for(var s=n.getObjectGroup(O.kMPath),r=-1,a=J.MONSTEREND+1;a<J.TOWEREND;a++)for(var o=1;;o++){var h;if(h=a-J.TBOTTLE+1+"T"+o,null==(t=s.getObject(h)))break;var d=.5*t.width,c=.5*t.height,u=t.x+d+i.width+nr.share().getMapOffset().width,p=t.y+c+i.height;r=t.x/70<<4|t.y/70;var m=parseInt(t.type);m<=0&&(m=1),e.curNewTowerCard<1&&t.new&&(e.curNewTowerCard=a-J.MONSTEREND),e.addTower(l.p(u,p),a,m,1,r)}}if(!e.bLoopPath){var _=502;e.m_nGameMode==ge.DOUBLECARROT&&(_=506),e.m_nGameMode==ge.DOUBLECARROT?this.getCarrotImg(e.usersData.getSecondCarrotFigure(),_):this.getCarrotImg(e.usersData.getCarrotFigure(),_)}},getCarrotImg:function(e,t){var i=wr.getModel();if(e==ue.CARROT_GIRL||e==ue.CARROT_OLD){var n=e==ue.CARROT_GIRL?J.CSNOW:J.CROCKET,s=i.getObjectByType(n);this.addRes(s.strPicGroup);var r=this.getChildByTag(t);i.addTower(l.pAdd(r.getPosition(),l.p(0,.5*-r.height)),n,1,0)}},loadData:function(e){if(dp){var t=wr.getModel();if("function"==typeof e){if(t.isPlayMess())return this.initData(),e&&e();var i=this;if(t.m_nGameMode==ge.HIGHERMODE)Ql.startdaydayup(function(n){t.clearCurLvGetDiamond(),t.clearCostprops(),t.usersData.clearObtainPropList(),t.usersData.setStarCount(n.starcountddu),t.usersData.setWaitTime(n.laststartime),t.m_oHigher.m_nFailedCount=n.losetiers?n.losetiers:0,t.usersData.OpenAllProps();var s=n.hadProps;if(s)for(var r=0;r<s.length;r++)t.usersData.setPropByPropid(r+1,s[r]);i.initData(),e&&e()},function(){qi.preloadWithLoadingTag(Ht,we.MAIN)});else if(t.m_nGameMode==ge.CHALLENGEMODE)Ql.startdailywar(function(n){t.clearCurLvGetDiamond(),t.clearCostprops(),t.usersData.clearObtainPropList(),t.usersData.setStarCount(n.starcount),t.usersData.setWaitTime(n.laststartime),t.usersData.openPropsByOpenLv();var s=n.hadProps;if(s)for(var r=0;r<s.length;r++)t.usersData.setPropByPropid(r+1,s[r]);i.initData(),e&&e()},function(){qi.preloadWithLoadingTag(Ht,we.MAIN)});else{var n=Le.NORMALMODE;(t.m_nGameMode==ge.DOUBLECARROT||t.curLevel>135)&&(n=t.m_nGameMode==ge.DOUBLECARROT?Le.DOUBLECARROT:Le.MANORMODE);var s=t.bRestart?1:0;kl.enterStage(n,s,function(){i.initData(),e&&e()},function(){i.replaceScene()})}}}},replaceScene:function(e){var t=wr.getModel();if(t.m_nGameMode==ge.CHALLENGEMODE)l.addTimePoint("GO_MAIN_S"),qi.preloadWithLoadingTag(Ht,we.MAIN,e);else if(t.curLevel<136){i=[];i=t.m_nGameMode==ge.HIGHERMODE?Ei:Yd.getUsedRes(),l.addTimePoint("level start"),l.addTimePoint("storey_start"),qi.preloadWithLoadingTag(i,we.THEME,e)}else if(t.curLevel>135&&t.curLevel<156){var i=[];i=t.m_nGameMode==ge.HIGHERMODE?Ei:qt,l.addTimePoint("storey_start"),l.addTimePoint("levelSel_start"),qi.preloadWithLoadingTag(i,we.THEMETEMPLE,e)}else t.curLevel>155&&t.curLevel<mr?(l.addTimePoint("meetfiend_start"),qi.preloadWithLoadingTag(Ai,we.MEETFRIEND,e)):(l.addTimePoint("GO_MAIN_S"),qi.preloadWithLoadingTag(Ht,we.MAIN,e))},initData:function(){var e=wr.getModel();e.curShowPlayerGuid>re.CLEARBBGUIDE?e.isShowGuid()&&(e.curShowPlayerGuid=re.UNKNOWGUIDE):e.curShowPlayerGuid>re.PROPSGUIDE?e.usersData.showBottomBomb(e.curShowPlayerGuid-re.SLOWBBGUIDE)?e.curShowPlayerGuid=re.UNKNOWGUIDE:e.usersData.setBottomBomb(e.curShowPlayerGuid-re.SLOWBBGUIDE):e.curShowPlayerGuid>re.UNKNOWGUIDE&&e.usersData.isCurLevelPlayed()&&(e.curShowPlayerGuid=re.UNKNOWGUIDE);e.usersData.loginFromMain;e.usersData.loginFromMain=!1;var t=this,i=Fc.create();e.animeLayer=i;var n=this.parent;n.addChild(i,3,3);var s=rn.create();if(t.gameHUD=s,n.addChild(s,2,2),l.director.getScheduler().isWaite=!1,l.director.getScheduler().setTimeScale(1),e.isPlayMess())return this.loadLastMessWave(),void s.showMessMenu();t.addTower(),this.showGuide()},showGuide:function(){var e=!0,t=this.gameHUD,i=wr.getModel(),n=this,s=i.animeLayer;if(i.curShowPlayerGuid>re.CLEARBBGUIDE);else if(i.curShowPlayerGuid>re.PROPSGUIDE)qu.loadResAsync(Bi,function(){t.showNewPropCard(i.curShowPlayerGuid-re.SLOWBBGUIDE)});else if(i.curShowPlayerGuid>re.PLAYEDGUIDE)qu.loadResAsync(Mi,function(){t.showModeTips()});else if(i.curNewTowerCard>0&&0==i.bRestart)qu.loadResAsync(Ci,function(){t.showNewTowerCard()});else if(i.curShowPlayerGuid==re.UNKNOWGUIDE)if(i.m_nGameMode==ge.HIGHERMODE&&!i.m_oHigher.isHalfBattle()||i.m_nGameMode==ge.NORMALMODE&&i.curTheme>1&&!i.bLoopPath)e=!1,qu.loadResAsync(Li,function(){t.showGiftBall()});else if(s.showCountDownTip(0),i.m_nGameMode==ge.HIGHERMODE&&i.m_oHigher.isHalfBattle()){e=!1,i.m_oHigher.pickupMagic();var r=n.getChildByTag(O.TOWERHOUSETAG);if(r){var a=i.nCarrotHP,o=i.usersData.getCarrotFigure();if(a<10)switch(a%2==0&&a--,o){case ue.CARROT_OLD:case ue.CARROT_GIRL:if(n.house){var h=n.house;h.bCanDoAction=!1,h.setOpacity(255),h.tower.setVisible(!1)}default:d=String.formatC("hlb%d_%d.png",o-ue.CARROT_NORMAL+1,a);(c=l.spriteFrameCache.getSpriteFrame(d))&&r.setSpriteFrame(c)}else if(a>=10&&o==ue.CARROT_FAT){var d=String.formatC("hlb3_%d.png",a>11?61:11==a?41:10),c=l.spriteFrameCache.getSpriteFrame(d);c&&r.setSpriteFrame(c)}}}e&&(i.m_nGameMode==ge.HIGHERMODE?i.m_oHigher.resetPackage():i.mapCompose&&i.mapCompose.resetPackage())},init:function(){if(!this._super())return!1;var e=wr.getModel();if(e.gameLayer=this,e.m_nGameMode==ge.HIGHERMODE){0==e.m_nRecoveryTime&&e.usersData.wastePlayTime(e.m_oHigher.getUsedStar());t=""+(1e3+e.m_oHigher.getPassCount());this.addLayerName(t)}else{var t=String.formatC("%lu",e.curLevel);this.addLayerName(t),dp||0==e.m_nRecoveryTime&&e.usersData.wastePlayTime(e.usersData.getUsedStar())}nr.share().isIPad();var i=this.map;e.szTileRng=l.size(i.getTileSize().width,i.getTileSize().height),this.szContentCount=i.getMapSize(),e.clearCurLvGetDiamond(),e.clearCostprops(),e.usersData.clearObtainPropList(),e.m_nGameMode==ge.HIGHERMODE?e.usersData.OpenAllProps():e.usersData.openPropsByOpenLv();var n=i.getProperty(O.kMProperty);n&&(e.curShowPlayerGuid=parseInt(n)),GamePlatform.isCN()||(e.usersData.getOpenedLevel()<=2&&2==e.curLevel||e.usersData.getOpenedLevel()<=3&&3==e.curLevel)&&(e.curShowPlayerGuid1=e.curShowPlayerGuid,e.curShowPlayerGuid=e.usersData.getOpenedLevel()<=2&&2==e.curLevel?re.FBPLAYEDGUIDE:re.FBPLAYEDGUIDE1);var s=nr.share().getWinSize(),r=String.formatC("res/Themes/Theme%lu/BG-hd.plist",10==e.curTheme?1:e.curTheme);this.addRes(r);u=String.formatC("#BG%lu.png",10==e.curTheme?1:e.curTheme);this.BG=new l.Sprite(u),this.BG.setPosition(s.width/2,s.height/2),this.addChild(this.BG,sr.LMAINBG);var a=e.usersData.m_nLanguage,o=String.formatC("res/Themes%s/Items/Items02-hd%s.plist",a,a);if(this.addRes(o),e.m_nGameMode==ge.CHALLENGEMODE)r=String.formatC("res/Themes/DayMaps/BG%s.plist",e.m_oChallenge.getMapName());else{r=String.formatC("res/Themes/Maps/BG%02lu-hd.plist",e.curLevel);var h=String.formatC("res/Themes%s/Maps/BG%02lu-hd%s.plist",a,e.curLevel,a);this.addRes(h)}this.addRes(r);var d=null,c=null;if(e.m_nGameMode==ge.CHALLENGEMODE){var u=String.formatC("BG%s.png",e.m_oChallenge.getMapName());d=l.spriteFrameCache.getSpriteFrame(u)}else d=l.spriteFrameCache.getSpriteFrame(String.formatC("Path%lu.png",e.curLevel));d&&((c=new l.Sprite(d)).setPosition(this.BG.width/2,this.BG.height/2),this.BG.addChild(c,111)),this.addObjects(i),this.nGameState=0,this.createTowerBatch()},updateTower:function(e){if(null==this.curSelTower)return 0;var t=!1;for(var i in this.selTowerUpdate){var n=this.selTowerUpdate[i];if(l.pDistance(n.getPosition(),e)<=.71*n.width&&n.nType>J.UNKNOW){var s=wr.getModel();if(n.nType==J.TOWERUPDATE){var r=this.curSelTower.curMoneyForUpdate();r>0&&s.getAllMoney()>=r&&(s.playSoundWithType($.MTTOWERUPDATA),this.curSelTower.updateTower(),s.changeMoney(-r),t=!0)}else{s.playSoundWithType($.MTTOWERSELL);var a=this.curSelTower.curMoneyForSell();s.curShowPlayerGuid==re.PLAYEDGUIDE?s.changeMoney(s.curMapConfig.nMoney-s.getAllMoney()):s.changeMoney(a);var o=!1;for(var h in this.selTowerUpdate){var d=this.selTowerUpdate[h];if(d.nType==J.TOWERSELBG)for(var c=d.getPosition(),u=0;u<s.slideWayBase.length;u++)for(var p=s.slideWayBase[u],m=0;m<p.length;m++){var _=p[m];l.rectContainsPoint(_.getBoundingBox(),c)&&(_.SetTower(null),o=!0)}}o||s.buildspace.push(s.rectWidthSprite(this.curSelTower)),this.curSelTower.sellTower(),s.towers.remove(this.curSelTower),this.removeChild(this.curSelTower,!0),t=!0}}n.runAction(l.scaleTo(.12,0))}return this.curSelTower=null,this.showUpdateTip(null),t?2:1},towerUpdate:function(e){this.curSelTower=e;var t=.5;nr.share().isIPad()&&(t=1),this.hideUpdateTip(this.curSelTower);var i=e.getContentSize(),n=nr.share().getWinSize(),s=l.p(e.x,e.y+1.1*i.height);s.y+.55*i.height>this.BG.y+(1-this.BG.anchorY)*this.BG.height&&(s.x=e.x+1.1*i.width,s.y=e.y,s.x+.55*i.width>=n.width&&(s.x=e.x-1.1*i.width));var r=l.p(e.x,e.y-1.1*i.height);if(r.y-.55*i.height<this.BG.y-this.BG.anchorY*this.BG.height+i.height&&(r.x=e.x+1.1*i.width,r.y=e.y,r.x+.55*i.width>n.width&&(r.x=e.x-1.1*i.width)),!this.selTowerUpdate||this.selTowerUpdate.length<1){var a=[];this.selTowerUpdate=a;var o=new bt;o.initUpdateSpriteWithTower(e),o.setPosition(s),this.gameHUD.addChild(o,sr.LUPDATEBTN),a.push(o);var h=new bt;h.initSellSpriteWithTower(e),h.setPosition(r),this.gameHUD.addChild(h,sr.LUPDATEBTN),a.push(h);var d=new bt;d.initCenterSprite(),d.setPosition(e.getPosition()),this.addChild(d,0),a.push(d);var c=new bt;c.initSelBGSprite(this.curSelTower.nRange),c.setPosition(e.getPosition()),this.gameHUD.addChild(c,sr.LUPDATEBG),a.push(c)}for(var u in this.selTowerUpdate){var p=this.selTowerUpdate[u];switch(p.setScale(.1),p.nType){case J.TOWERUPDATE:p.setPosition(s),p.changePicWithMoney(p.nType,this.curSelTower);break;case J.TOWERSELL:p.setPosition(r),p.changePicWithMoney(p.nType,this.curSelTower);break;case J.TOWERSELBG:p.changeSelBGRangePic(e);default:p.setPosition(e.getPosition())}(t=l.scaleTo(.12,1)).setTag(rr.SCALEACTION),p.runAction(t)}},showUpdateTip:function(e){var t=0,i=wr.getModel();if(e)!e.bShowUpdateTip&&i.getAllMoney()>=e.define.nBuyMoney[e.nCurLevel]&&(t=.5*e.height,e.bShowUpdateTip=!0,i.animeLayer.showUpdateTip(l.pAdd(l.p(0,t),e.getPosition())));else{var n=i.getAllMoney();for(var s in i.towers){var r=i.towers[s];t=.5*r.height,r!=this.curSelTower&&(r.bShowUpdateTip?n<r.define.nBuyMoney[r.nCurLevel]&&(r.bShowUpdateTip=!1,i.animeLayer.hideUpdateTip(l.pAdd(l.p(0,t),r.getPosition()))):r.nCurLevel<r.define.nLevelCount&&n>=r.define.nBuyMoney[r.nCurLevel]&&(r.bShowUpdateTip=!0,i.animeLayer.showUpdateTip(l.pAdd(l.p(0,t),r.getPosition()))))}}},hideUpdateTip:function(e){var t=0,i=wr.getModel();if(e)e.bShowUpdateTip&&(t=.5*e.height,e.bShowUpdateTip=!1,i.animeLayer.hideUpdateTip(l.pAdd(l.p(0,t),e.getPosition())));else for(var n in i.towers){var s=i.towers[n];s.bShowUpdateTip&&(0==t&&(t=.5*s.height),i.getAllMoney()<s.define.nBuyMoney[s.nCurLevel]&&(s.bShowUpdateTip=!1,i.animeLayer.hideUpdateTip(l.pAdd(l.p(0,t),s.getPosition()))))}},changeSelGroupWithType:function(e){if(!(e>J.MONSTEREND)){var t=wr.getModel();if(this.selTowerUpdate&&this.curSelTower&&this.curSelTower.nCurLevel<this.curSelTower.define.nLevelCount&&this.selTowerUpdate[0].changePicWithMoney(J.TOWERUPDATE,this.curSelTower),this.gameHUD.changeMoney(t.getAllMoney()),this.gameHUD.bShowSelGroup)for(var i in this.gameHUD.selGroup){var n=this.gameHUD.selGroup[i];n.nType>J.UNKNOW&&n.changePicWithMoney(n.nType,null)}this.showUpdateTip(null)}},schedule_nextWave:function(e){this.schedule(this.nextWave,e)},nextWave:function(e){this.unschedule(this.nextWave);var t=wr.getModel();t.bCurWaveNoMonster=!1,t.nextWave();var i=t.curWave<=t.curMapConfig.nWaves?t.curWave:t.curMapConfig.nWaves;this.gameHUD.showNextWave(i);var n=.83*t.curMapConfig.nMonsterSpan;if(GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&SDKInterface.wxtriggerGC(),this.schedule(this.showMonster,n),t.nCountDownTime<-1){t.nCountDownTime=-t.nCountDownTime;var s=this;this.gameHUD.schedule(s.gameHUD.changeBossModeTime,1)}t.bLoopPath&&t.curWave<t.curMapConfig.nWaves&&this.schedule(this.nextWave,t.curMapConfig.nEveryListSpan)},showMonster:function(e){var t=wr.getModel();if(!t.bCreepStopCome){var i=t.addTarget(),n=t.addTarget2();i||n||(this.unschedule(this.showMonster),this.changeSelGroupWithType(J.TOWEREND),t.bCurWaveNoMonster=!0,t.checkNextWave())}},showChildMonster:function(e){var t=wr.getModel();t.addChildMonster()||(this.unschedule(this.showChildMonster),t.bInAddChildMonster=!1)},showChildMonsterBegan:function(){this.schedule(this.showChildMonster,.5)},showChildMonsterEnd:function(){this.unschedule(this.showChildMonster)},victorious:function(e){if(0==this.nGameState){this.nGameState=1,this.unscheduleAllCallbacks(),this.gameHUD.unscheduleAllCallbacks(),l.director.getScheduler().isWaite=!0,l.director.getScheduler().setTimeScale(1);var t=wr.getModel();if(t.usersData.bUserLoseStar=!1,t.m_nGameMode==ge.HIGHERMODE)this.gameHUD.m_isShowVideoReborn?this.gameHUD.showRebornAnim(1):(l.log("TurorialLayer.....victorious:...curLevel=%d.;curTheme=%d;...预加载的tileMap是 %s",t.curLevel,t.curTheme,t.getMapPath()),t.m_oHigher.setCurLevelWin(),this.showStoryWinOrLose(!0));else if(this.gameHUD.m_isShowVideoReborn)this.gameHUD.showRebornAnim(2);else{var i=this,n=ci,s=t.curLevel;s!=O.MAINLEVELCOUNT&&s!=t.usersData.openmaxstage||t.m_nGameMode!=ge.NORMALMODE||(n=n.concat(oi),n=s==t.usersData.openmaxstage?n.concat(li):n.concat(hi)),l.addTimePoint("gameover_s"),qu.loadResAsync(n,function(){Xc.sceneWin(i.gameHUD.getParent())}),t.creepsTask(J.UNKNOW,J.UNKNOW,0,""),this.clearTask()}}},clearTask:function(){var e=wr.getModel().tasks;if(e)for(var t=e.length,i=0;i<t;i++){var n=e[i];n&&!n.isFinished()&&n.clearFinishCount()}},defeated:function(e){if(0==this.nGameState){this.nGameState=2,this.unscheduleAllCallbacks(),this.gameHUD.unscheduleAllCallbacks(),l.director.getScheduler().setTimeScale(1),l.director.getScheduler().isWaite=!0;var t=wr.getModel();if(t.m_nGameMode==ge.HIGHERMODE)if(t.isPlayMess()||t.m_nRecoveryTime||t.m_oHigher.getCurLevelMode()==Nn.MT_BOSS||t.m_oHigher.getCurLevelMode()==Nn.MT_SUPERBOSS)t.m_oHigher.setCurLevelLose(),this.showStoryWinOrLose(!1);else{l.director.getScheduler().isWaite=!0;i=this;qu.loadResAsync(vi,function(){i.gameHUD.showRebornAnim(0)})}else if(l.director.getScheduler().isWaite=!0,t.isPlayMess()||t.m_nRecoveryTime>2||t.bLoopPath||t.m_nGameMode==ge.CHALLENGEMODE){t.playSoundWithType($.MTLOSEGAME);i=this;l.addTimePoint("gameover_s"),qu.loadResAsync(di,function(){Xc.sceneLose(i.gameHUD.getParent())}),t.creepsTask(J.UNKNOW,J.UNKNOW,0,""),this.clearTask()}else{var i=this;qu.loadResAsync(vi,function(){i.gameHUD.showRebornAnim(0)})}}},showStoryWinOrLose:function(e){var t=e?we.STOREY_V:we.STOREY_L,i=wr.getModel(),n=[];if(e){var s=i.usersData.getObtainPropList();for(var r in s){var a=s[r];n.push([a.id,a.count])}}var o=[],h=i.getCostprops();for(var r in h){var l=h[r];o.push([l.id,l.count])}if(dp){var d={issuccess:e,dm:i.getCurLevelDiamond(),props:n,costprops:o};Ql.finishdaydayup(d,function(e){i.usersData.setDiamond(e.dm),qi.preloadWithStoreyScene(t)},function(){qi.preloadWithStoreyScene(t)})}else qi.preloadWithStoreyScene(t)},FollowPath:function(e){var t=e,i=t.define.nRunSpeed,n=wr.getModel(),s=t.curDuration(),r=l.p(0,0),a=null;if(t.IsWayPointTransfer01()){var o=t.getNextWayPoint(n.bLoopPath);s=t.curDuration();var h=o,d=t.IsNextWayPointTranferO1(),c=t.getNextWayPoint(n.bLoopPath);return h.y==c.y?(r.x=h.x,r.y=-35+h.y,t.setPosition(r),c.x,h.x,r.x=0,r.y=-35,r.x+=c.x,r.y+=c.y,a=d?l.sequence(l.spawn(l.scaleTo(.1,1.2),l.moveTo(.1,h)),l.scaleTo(.1,1),l.moveTo(s/t.fSpeedSlowPer,c),l.scaleTo(.1,1.2),l.spawn(l.scaleTo(.1,.1),l.moveTo(.1,r)),l.callFunc(this.FollowPath,this,t)):l.sequence(l.spawn(l.scaleTo(.1,1.2),l.moveTo(.1,h)),l.scaleTo(.1,1),l.moveTo(s/t.fSpeedSlowPer,c),l.callFunc(this.FollowPath,this,t))):h.x==c.x&&(c.y>h.y?(r.x=0,r.y=-35,r.x+=c.x,r.y+=c.y,t.setPosition(h),a=d?l.sequence(l.scaleTo(.1,1.2),l.scaleTo(.1,1),l.moveTo(s/t.fSpeedSlowPer-35/i,r),l.scaleTo(.1,1.2),l.scaleTo(.1,.1),l.callFunc(this.FollowPath,this,t)):l.sequence(l.scaleTo(.1,1.2),l.scaleTo(.1,1),l.moveTo(s/t.fSpeedSlowPer,c),l.callFunc(this.FollowPath,this,t))):(r.x=0,r.y=-35,r.x+=h.x,r.y+=h.y,t.setPosition(r),a=d?l.sequence(l.scaleTo(.1,1.2),l.scaleTo(.1,1),l.moveTo(s/t.fSpeedSlowPer-35/i,c),l.scaleTo(.1,1.2),l.scaleTo(.1,.1),l.callFunc(this.FollowPath,this,t)):l.sequence(l.scaleTo(.1,1.2),l.scaleTo(.1,1),l.moveTo(s/t.fSpeedSlowPer-35/i,c),l.callFunc(this.FollowPath,this,t)))),void(a&&(a.setTag(rr.NORMALSPEED),t.curActionType=rr.NORMALSPEED,t.runAction(a)))}var u=t.getNextWayPoint(n.bLoopPath);if(null==u){t.moveFinish(),n.playSoundWithType($.MTMSTCRASH),n.curSelGoods==t&&n.animeLayer.showSelPointWithSprite(t,!1);var p=t.getWhichPath();if(n.m_nGameMode==ge.DOUBLECARROT)if(1==p){var m=t.define.type;m==J.SBB?n.nCarrotHP=0:m>J.LM3&&m<J.FTM&&(m-J.LM41)%2==0?n.nCarrotHP-=3:n.nCarrotHP-=m<J.BMT?1:m==J.BMT?3:2}else(m=t.define.type)==J.SBB?n.nSecondCarrotHP=0:m>J.LM3&&m<J.FTM&&(m-J.LM41)%2==0?n.nSecondCarrotHP-=3:n.nSecondCarrotHP-=m<J.BMT?1:m==J.BMT?3:2;else(m=t.define.type)==J.SBB?n.nCarrotHP=0:m>J.LM3&&m<J.FTM&&(m-J.LM41)%2==0?n.nCarrotHP-=3:n.nCarrotHP-=m<J.BMT?1:m==J.BMT?3:2;var _=1==p?n.nCarrotHP:n.m_nGameMode==ge.DOUBLECARROT?n.nSecondCarrotHP:n.nCarrotHP;if(n.m_nGameMode==ge.CHALLENGEMODE&&(_-=7),!(_>0))return l.audioEngine.end(),n.playMuiscWithType(J.MTWARBGMSC,3),n.bLockMenu=!0,this.defeated(),void(n.bGameStart=!1);n.animeLayer&&n.animeLayer.showDustWithPt(t._position,1);var g=String.formatC("%ld",_);n.m_nGameMode==ge.DOUBLECARROT?1==p?this.houselife.setString(g):this.m_secondHouseLife.setString(g):this.houselife.setString(g);var T=n.nCarrotHP,f=n.usersData.getCarrotFigure();switch(n.m_nGameMode==ge.DOUBLECARROT&&1!=p&&(T=n.nSecondCarrotHP,f=n.usersData.getSecondCarrotFigure()),f){case ue.CARROT_OLD:case ue.CARROT_GIRL:var S=1==p?this.house:n.m_nGameMode==ge.DOUBLECARROT?this.m_secondHouse:this.house;S.bCanDoAction=!1,S.setOpacity(255),S.tower.setVisible(!1)}if(T<=(n.m_nGameMode==ge.DOUBLECARROT)?5:10){var w=n.gameObjectConfig.objectGroup[J.TOWERHOUSE];f==ue.CARROT_FAT&&T==(n.m_nGameMode==ge.DOUBLECARROT?6:11)?T=41:T%2==0&&T<(n.m_nGameMode==ge.DOUBLECARROT?5:10)?n.m_nGameMode==ge.DOUBLECARROT?T=2*T+1:T+=1:n.m_nGameMode==ge.DOUBLECARROT&&(5==T?T*=2:T=2*T+1),g=String.formatC(w.strPic,f-ue.CARROT_NORMAL+1,T);var v=l.spriteFrameCache.getSpriteFrame(g);if(v)if(n.m_nGameMode==ge.DOUBLECARROT&&1!=p){this.m_secondHouse.stopAllActions(),this.m_secondHouse.setSpriteFrame(v),this.m_secondHouse.setRotation(0);var L=F()%12+2,M=p;this.m_secondHouse.runAction(l.sequence(l.delayTime(L),l.callFunc(this.gameHUD.showCarrotAnimate,this.gameHUD,M)))}else if(this.house){this.house.stopAllActions(),this.house.setSpriteFrame(v),this.house.setRotation(0);L=F()%12+2;M=p,this.house.runAction(l.sequence(l.delayTime(L),l.callFunc(this.gameHUD.showCarrotAnimate,this.gameHUD,M)))}}return l.log("before garbageMonster "+n.curCreepCount),n.garbageMonster(t,!1),void l.log("after garbageMonster "+n.curCreepCount)}if(t.IsWayPointTransfer01()){var C=t.getWayPoint(),c=u;C.y==c.y?c.x>C.x?(r.x=0,r.y=35,r.x+=u.x,r.y+=u.y,a=l.sequence(l.moveTo(s,u),l.scaleTo(.1,1.2),l.spawn(l.scaleTo(.1,.1),l.moveTo(.1,r)),l.callFunc(this.FollowPath,this,t))):(r.x=0,r.y=-35,r.x+=u.x,r.y+=u.y,a=l.sequence(l.moveTo(s,u),l.scaleTo(.1,1.2),l.spawn(l.scaleTo(.1,.1),l.moveTo(.1,r)),l.callFunc(this.FollowPath,this,t))):C.x==c.x&&(c.y>C.y?(r.x=0,r.y=-35,r.x+=u.x,r.y+=u.y,a=l.sequence(l.moveTo(s/t.fSpeedSlowPer-70/i,l.pAdd(u,l.p(0,-70))),l.scaleTo(.1,1.2),l.spawn(l.scaleTo(.1,.1),l.moveTo(.1,r)),l.callFunc(this.FollowPath,this,t))):(r.x=0,r.y=-35,r.x+=u.x,r.y+=u.y,a=l.sequence(l.moveTo(s/t.fSpeedSlowPer,u),l.scaleTo(.1,1.2),l.spawn(l.scaleTo(.1,.1),l.moveTo(.1,r)),l.callFunc(this.FollowPath,this,t)))),a||l.log("action is "+a)}else a=l.sequence(l.moveTo(s/t.fSpeedSlowPer,u),l.callFunc(this.FollowPath,this,t));a||(a=l.sequence(l.moveTo(s/t.fSpeedSlowPer,u),l.callFunc(this.FollowPath,this,t))),a?(a.setTag(rr.NORMALSPEED),t.curActionType=rr.NORMALSPEED,t.runAction(a)):l.log("ptPre.x :"+C.x+"  ptNext.x:"+c.x+" ptNext.y :"+c.y+" ptPre.y :"+C.y)},changeCarrotHP:function(){var e=wr.getModel(),t=e.bLockMenu;e.bLockMenu=!1;var i=e.nCarrotHP;e.isPlayMess()||e.m_nGameMode!=ge.CHALLENGEMODE||(i-=7);var n=i;if(this.houselife.setString(n),this.gameHUD.showCarrotAnimate(1,1),e.m_nGameMode==ge.DOUBLECARROT){var s=e.nSecondCarrotHP,r=String.formatC("%d",s);this.m_secondHouseLife.setString(r),this.gameHUD.showCarrotAnimate(1,2)}e.bLockMenu=t},onExit:function(){var e=wr.getModel();e.isPlayMess()||e.usersData.setLastPlayedLevel(e.curLevel,!0),this.stopAllActions(),this.unscheduleAllCallbacks(),this.removeAllChildrenWithCleanup(!0),this.doBeforeExit(),this.BG=null,this.houselife=null,this.house=null,this.curSelTower=null,this.gameHUD=null;if(this.arryBatchTower)for(var t in this.arryBatchTower){var i=this.arryBatchTower[t];i&&i.removeAllChildrenWithCleanup(!0)}e.releaseCurLevel(),qu.clearOwner(this),this.clearRes(),this._super()},doBeforeExit:function(){var e=wr.getModel();e.gameLayer=null,e.animeLayer=null},createTowerBatch:function(){var e=wr.getModel(),t=e.curMapConfig.towerType;if(t){var i=t.length;this.arryBatchTower=null,this.arryBatchTower=[];for(var n=0;n<i;n++){var s=e.getObjectByType(t[n]),r=String.formatC(s.strPicGroup,""),a=l.textureCache.getTextureForKey(r);if(a){var o=Ec.createWithTexture(a,50);o&&(this.addChild(o,sr.LTOWER),o.SetType(s.type)),this.arryBatchTower.push(o)}}}},addToTowerBatch:function(e,t){if(e){var i=!1;if(this.arryBatchTower)for(var n in this.arryBatchTower){var s=this.arryBatchTower[n];if(s.GetType()==e.define.type){i=!0,s.addChild(e,t),s._setZOrder(t);break}}if(!i){var r=!1,a=wr.getModel().getObjectByType(e.define.type);if(a){var o=String.formatC(a.strPicGroup,""),h=l.textureCache.getTextureForKey(o);if(h){var d=Ec.createWithTexture(h,50);d&&(this.addChild(d,sr.LTOWER),d.SetType(a.type)),this.arryBatchTower.push(d),d.addChild(e,t),d._setZOrder(t),r=!0}}r||this.addChild(e,t)}}},removeTowerFromBatch:function(e,t){if(e){var i=!1;if(this.arryBatchTower)for(var n in this.arryBatchTower){var s=this.arryBatchTower[n];if(s&&s.GetType()==e.define.type){i=!0,s.removeChild(e,t);break}}i||this.removeChild(e,!0)}},loadLastMessWave:function(){var e=wr.getModel().getMessData();e&&e.waves.length&&this.loadMessWave(e.waves.length-1)},loadMessWave:function(e){var t=wr.getModel(),i=t.getMessData();if(i&&i.waves.length>e&&e>=0){var n=i.waves[e],s=i.datas[e];t.loadMessWaveData(n,s)}}});Pc.scene=function(e){wr.getModel().isPlayMess();var t=new l.Scene,i=new Pc(e);return t.addChild(i,1,1),l.director.getScheduler().isWaite=!1,l.director.getScheduler().setTimeScale(1),t.loadData=i.loadData.bind(i),nr.share().scaleScene(t),t},Pc.create=function(){return new Pc};var bc=0,Ac=1,Oc=2,Ic=3,Rc=4,Dc=5,xc=6,Nc=7,Gc=8,Wc=9,kc=10,Uc=11,Hc=12,Vc=13,zc=14,Yc=15,Xc=Xs.extend({mLayerNormal:null,mLayerFinal:null,darkBg:null,mLogo:null,mBg:null,lableWaves:null,lableCurWave:null,lableStageNum:null,lableMessShareCD:null,messDisableNode:null,lableStone:null,mIsWin:!1,mIsBossMode:!1,mPopupTip:null,mIsStep:!1,nStepNum:0,loseadv:null,mNumShine:null,m_spTitle:null,m_spShine:null,mLogo2:null,pItemFinalStone:null,m_aryLvStatus:null,nStoneNum:0,m_animaStep:0,mLayerAnimate:null,m_spShineBg:null,pItemPlay:null,pItemHome:null,pItemMess:null,pItemWeibo:null,mLayerNotice:null,CurrentPlatForm:0,stageType:0,listener:null,_honor:0,openedlv:0,beforeGold:0,overfriend:null,_pMenu:null,_rewardSpr:null,_isNeedShow:!1,ctor:function(){this._super(),qu.addRes(this,String.formatC("res/Themes%s/tencent/tencent_share.plist",GamePlatform.getLanguage())),this.m_aryLvStatus=[];for(var e=0;e<3;e++)this.m_aryLvStatus[e]={},this.m_aryLvStatus[e].bIsSeccuss=!1,this.m_aryLvStatus[e].stoneCount=0,this.m_aryLvStatus[e].bIsFinished=!1;this.CurrentPlatForm=GamePlatform.getCurrentPlatForm()},initWinLose:function(e,t){GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC();var i=wr.getModel();i.bLockMenu=!0,this.mIsWin=e,this.mIsBossMode=i.bLoopPath;var n=i.isPlayMess();if(this.stageType=Le.NORMALMODE,(i.m_nGameMode==ge.DOUBLECARROT||i.curLevel>135)&&(this.stageType=i.m_nGameMode==ge.DOUBLECARROT?Le.DOUBLECARROT:Le.MANORMODE),n||i.m_nGameMode!=ge.CHALLENGEMODE||i.m_oChallenge.setPlayDay(this.mIsWin),!dp){qu.addRes(this,String.formatC("res/Themes/scene/gameover_%s.plist",this.mIsWin?"win":"lose"));var s=i.usersData.m_nLanguage,r=String.formatC("res/Themes%s/scene/gameover_%s%s.plist",s,this.mIsWin?"win":"lose",s);qu.addRes(this,r)}},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},onEnterTransitionDidFinish:function(){this._super();var e=wr.getModel();e.bLockMenu=!0,this.beforeGold=e.usersData.getGoldCount();e.isPlayMess();dp?this.uploadUserData():(this.showWinOrLoseTitle(),this.mIsWin&&this.setAryLvStatus(),this.showWinOrLoseInfo(this.mIsWin)),this.registerWithTouchDispatcher(!0)},showWinOrLoseTitle:function(){var e=wr.getModel().usersData,t=nr.share().getMapOffset();this.mLayerNormal=new l.Layer,this.addChild(this.mLayerNormal,1,2003);var i=l.spriteFrameCache.getSpriteFrame(String.formatC("%s_bg.png",this.mIsWin?"win":"lose"));i&&(this.darkBg=new l.Sprite(i),this.darkBg.setPosition(480+t.width,320),this.mLayerNormal.addChild(this.darkBg,0)),(i=l.spriteFrameCache.getSpriteFrame("winlose_bg.png"))&&(this.mBg=new l.Sprite(i),this.mBg.setPosition(480+t.width,300),this.mLayerNormal.addChild(this.mBg,1,2004)),e.IsShowEnToCn()?this.m_spTitle=new l.Sprite(String.formatC("#%s_title_whb.png",this.mIsWin?"win":"lose")):this.m_spTitle=new l.Sprite(String.formatC("#%s_title.png",this.mIsWin?"win":"lose")),this.m_spTitle&&this.mBg&&(this.m_spTitle.setPosition(.5*this.mBg.width,466),this.mBg.addChild(this.m_spTitle,0));var n=this.showHonor();this.showLogo(n)},showWinOrLoseInfo:function(e){this.mIsWin=e;var t=wr.getModel(),i=t.usersData,n=t.curLevel,s=t.isPlayMess();if(this.mIsWin?(this.showWinLayer(),t.setGuidState(!1)):this.showFailLayer(),this.addMenuItem(),t.curKillMonsters<1e4&&(i.killMonsters+=.2*(t.curKillMonsters-3)),this.mIsBossMode){if(this.mIsWin){t.playSoundWithType($.MTPERFECT);var r=t.getObjectByType(J.WAVENUM),a=r.szTile;a=l.size(2*a.width,2*a.height),this.lableCurWave=new l.LabelAtlas("00",r.strPic,a.width,a.height,"./0123456789");var o=t.nCountDownTime;o<0&&(o=0),this.lableCurWave.setString(String.formatC("%.2d",o)),this.lableCurWave.setAnchorPoint(0,1),this.lableCurWave.setPosition(440,368)}var h=String.formatC("names_%.2lu.png",n),d=l.spriteFrameCache.getSpriteFrame(h);d&&new l.Sprite(d).setPosition(480,292)}else this.mIsWin&&t.playSoundWithType($.MTPERFECT);if(i.finalLevelFailCount=3,this.mIsWin){var c=this.showHonor();s||(0==t.objects.length&&t.m_nGameMode!=ge.CHALLENGEMODE&&i.setLevelClearHonor(n),t.m_nGameMode!=ge.CHALLENGEMODE&&i.setLevelFirstHonor(t.curLevel,c,!0)&&(i.setWinNewLevel(!0),(15==t.curLevel&&16==t.usersData.getOpenedLevel()||25==t.curLevel&&26==t.usersData.getOpenedLevel()||40==t.curLevel&&41==t.usersData.getOpenedLevel())&&i.showNewThemeUnlock(t.curLevel)))}else this.mLogo=new l.Sprite("lose_rip.png"),this.mLogo&&(this.mLogo.setPosition(this.mIsWin?l.p(564,528):l.p(570,458)),this.mLogo.setScale(this.mIsWin?0:1),this.mLogo.setScaleY(this.mIsWin?1:0),this.mBg.addChild(this.mLogo,0));if(t.m_nGameMode!=ge.CHALLENGEMODE&&(3==i.getFirstHonor(n)&&Tt.onEvent("gold_honor"),i.getClearHonor(n)&&Tt.onEvent("clear_honor"),i.getTaskHonor(n)&&Tt.onEvent("task_honor")),!s&&this.mIsWin)for(var u=0;u<this.m_aryLvStatus.length;u++){var p=this.m_aryLvStatus[u];if(p.bIsFinished&&!p.bIsSeccuss){var m=this.mBg.getChildByTag(4001+u);m&&m.setScale(1)}}if(this.beganRunAction(),s||(!this.mIsWin||n!=O.MAINLEVELCOUNT&&n!=t.usersData.openmaxstage||t.m_nGameMode!=ge.NORMALMODE||(i.bIsAllPass=!0,this.showFinalLayer()),t.m_nGameMode==ge.HIGHERMODE&&(this.mIsWin?t.m_oHigher.setCurLevelWin():t.m_oHigher.setCurLevelLose())),GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook){var _=qu.getLoadImage("res/Themes_en/scene/share_2_en.jpg"),g=qu.getLoadImage("res/Themes_en/scene/imagetxt_lb.png"),T=document.createElement("canvas");T.width=_.width,T.height=_.height;var f=T.getContext("2d");_&&f.drawImage(_,0,0),g&&Rt.drawTextImage(f,g,t.usersData.getGoldCount()+"","0123456789x+","center",795,338);var S=qu.getLoadImage(l.playerInfo.photo);(S=S||qu.getLoadImage("res/Themes_en/FaceBook/fbUsersHead.png"))&&f.drawImage(S,0,0,S.width,S.height,496,190,177,177);var w=T.toDataURL("image/png"),v={context:!1,immediately:!1};SDKInterface.shareMessage("",l.playerInfo.name+" get "+t.usersData.getGoldCount()+" Gloden Carrot Trophies in Carrot Defense!",w,{index:1003},v),SDKInterface.logEvent&&SDKInterface.logEvent("finishLevel",1,{level:t.curLevel,type:this.mIsWin?"isWin":"isLose"})}},showWinLayer:function(){var e=wr.getModel(),t=e.isPlayMess(),i=null;if(t){(i=new l.Sprite("win_mess.png"))&&(i.setPosition(568,280),this.mBg.addChild(i,0));var n=e.getMessData(),s=Rt.cutString(n.playerName,10),r=new l.LabelTTF(String.format(b.Dialog_Hint11,s,e.curLevel),"Arial",36);this.mBg.addChild(r),r.setHorizontalAlignment(l.TEXT_ALIGNMENT_CENTER),r.enableShadow(l.color(0,0,0),l.p(1,-1),2),r.x=.5*this.width,r.y=260}else if(e.m_nGameMode==ge.CHALLENGEMODE){(i=new l.Sprite("#winlose_daily.png"))&&(i.setPosition(568,252),this.mBg.addChild(i,0));var a=e.m_oChallenge.getPlayDay();a>7&&(a=7);for(var o=0;o<a;o++)(i=new l.Sprite("#win_checked.png"))&&(i.setPosition(238+124*o,294),this.mBg.addChild(i,0))}else(i=new l.Sprite("#winlose_winover.png"))&&(i.setPosition(568,320),this.mBg.addChild(i,0));var h=e.curMapConfig;if(h){if(t||e.m_nGameMode==ge.CHALLENGEMODE||this.executionTaskAction(h,e.curLevel),this.lableStone=new l.LabelAtlas("00","res/Themes/Items/num_white_24.png",24,40,"./0123456789"),this.lableStone.setString(String.formatC("%.2d",0)),this.lableStone.setAnchorPoint(.5,.5),t?this.lableStone.setPosition(286,34):this.lableStone.setPosition(356,54),this.loseadv=new l.Sprite(t?"win_mess_gem.png":"#win_getstone.png"),this.loseadv){var d=t?l.p(568,386):l.p(568,396);if(this.loseadv.setPosition(d),this.mBg.addChild(this.loseadv,0),this.loseadv.setScale(0),this.loseadv.addChild(this.lableStone,3),!t){var c=this.loseadv.getContentSize(),u=new l.Sprite("shop_gem.png");u.setAnchorPoint(l.p(.5,.5)),u.setScale(1.6),u.setPosition(l.p(118,.5*c.height+2)),this.loseadv.addChild(u)}}this.mNumShine=new l.Sprite("#winlose_shine.png"),this.mNumShine&&(this.mNumShine.setPosition(356,54),this.loseadv.addChild(this.mNumShine,4),this.mNumShine.setScaleX(0),this.mNumShine.setScaleY(0)),this.m_spShine=new l.Sprite("#winlose_shine.png"),this.m_spShine&&(this.m_spShine.setPosition(564,543),this.mBg.addChild(this.m_spShine,199),this.m_spShine.setScale(0)),this.lableStone.setScaleX(this.mIsWin?1:0),this.lableStone.setScaleY(this.mIsWin?1:0),t||(this.lableStageNum=new l.LabelAtlas("000","num_blue_18.png",18,30,"./0123456789"),this.lableStageNum.setString(String.formatC(e.m_nGameMode==ge.CHALLENGEMODE?"%lu":"%.2lu",e.m_nGameMode==ge.CHALLENGEMODE?e.m_oChallenge.getPlayDay():e.curLevel)),this.lableStageNum.setAnchorPoint(.5,.5),e.m_nGameMode==ge.CHALLENGEMODE?GamePlatform.isCN()?this.lableStageNum.setPosition(592,335):this.lableStageNum.setPosition(680,335):this.lableStageNum.setPosition(570,336),this.mBg.addChild(this.lableStageNum,1,1))}},executionTaskAction:function(e,t){if(void 0!=e&&void 0!=this.mBg){t=t||0;var i=4001,n=189,s=e.tasks,r=0;if(s&&(r=s.length)>0)for(var a=0;a<r;a++){var o=s[a];if(o){var h=String.formatC("micon_b%lu.png",o.nImgIndex),d=l.spriteFrameCache.getSpriteFrame(h);if(d){var c=new l.Sprite(d);c.setPosition(n,250),this.mBg.addChild(c)}var u=String.formatC("micon_s%lu.png",o.nMissionNum),p=l.spriteFrameCache.getSpriteFrame(u);if(p){var m=new l.Sprite(p);m.setPosition(n,250),this.mBg.addChild(m)}var _=String.formatC("mission%lu_%d.png",t,a+1),g=l.spriteFrameCache.getSpriteFrame(_);if(g){var T=new l.Sprite(g);T.setPosition(n+124,250),this.mBg.addChild(T)}var f=l.spriteFrameCache.getSpriteFrame("win_checked.png");if(f){var S=new l.Sprite(f);S.setPosition(l.p(n+206,291)),S.setScale(0),this.mBg.addChild(S,186,i)}i++,n+=300}}}},showFailLayer:function(){var e=wr.getModel(),t=new l.Sprite("#winlose_loseover.png");t&&(t.setPosition(568,310),this.mBg.addChild(t,0));var i=F()%7+1;(t=new l.Sprite("#"+String.formatC("lose_tip_%d.png",i)))&&(t.setPosition(568,238),this.mBg.addChild(t));var n=e.curMapConfig;if(0!=n.nBossModeSecond)this.loseadv=new l.Sprite("#lose_boss.png"),this.loseadv&&(this.loseadv.setPosition(568,396),this.mBg.addChild(this.loseadv,0),this.loseadv.setScale(this.mIsWin?0:1));else if(n.bPresentGate)this.loseadv=new l.Sprite("#lose_gate.png"),this.loseadv&&(this.loseadv.setPosition(568,396),this.mBg.addChild(this.loseadv,0),this.loseadv.setScale(this.mIsWin?0:1));else if(this.loseadv=new l.Sprite("#lose_adv.png"),this.loseadv){this.loseadv.setPosition(568,396),this.mBg.addChild(this.loseadv,0),this.loseadv.setScale(this.mIsWin?0:1);var s=e.getObjectByType(J.WAVES),r=s.szTile;r=l.size(2*r.width,2*r.height),this.lableWaves=new l.LabelAtlas("00","res/Themes/Items/num_white_24.png",24,40,"./0123456789"),this.lableWaves.setString(String.formatC("%.2lu",e.curMapConfig.nWaves)),this.lableWaves.setAnchorPoint(.5,.5),this.lableWaves.setPosition(314,54),this.loseadv.addChild(this.lableWaves,3),r=(s=e.getObjectByType(J.WAVENUM)).szTile,r=l.size(2*r.width,2*r.height),this.lableCurWave=new l.LabelAtlas("00","res/Themes/Items/num_white_24.png",24,40,"./0123456789");var a=e.curWave<=e.curMapConfig.nWaves?e.curWave:e.curMapConfig.nWaves;this.lableCurWave.setString(String.formatC("%.2d",a)),this.lableCurWave.setAnchorPoint(.5,.5),this.lableCurWave.setPosition(238,54),this.loseadv.addChild(this.lableCurWave,3)}},updateMessShareCD:function(e){var t=wr.getModel(),i=t.getCurSystemTime(),n=parseInt(t.canShareMessTime-i);if(n<=0)this.messDisableNode.visible=!1,this.pItemMess.visible=!0,this.stopActionByTag(-1211),this.unschedule(this.updateMessShareCD);else{var s=Math.floor(n/3600);n%=3600;var r=Math.floor(n/60),a=n%=60;s<10&&(s="0"+s),r<10&&(r="0"+r),a<10&&(a="0"+a),this.lableMessShareCD.setString(String.format("{0}:{1}:{2}",s,r,a))}},disableMessShareBtn:function(){var e=wr.getModel(),t=e.getCurSystemTime();if(t<e.canShareMessTime){e.canShareMessTime;if(this.pItemMess.visible=!1,null===this.messDisableNode){var i=new l.Node,n=new l.Sprite("lose_mess_disable.png");n.anchorX=0,n.anchorY=0,i.setContentSize(n.getContentSize()),i.addChild(n);var s=new l.LabelTTF("00:00:00","Arial",40);s.x=.5*i.width,s.y=.5*i.height,s.color=l.color(250,230,180),s.enableShadow(l.color(0,0,0,255),l.p(1,-1),2),i.addChild(s),this.lableMessShareCD=s,this.messDisableNode=i,i.setAnchorPoint(this.pItemMess.getAnchorPoint()),i.setPosition(this.pItemMess.getPosition()),this.addChild(i,1)}this.messDisableNode.visible=!0;this.stopActionByTag(-1211),this.updateMessShareCD(0);var r=l.repeatForever(l.sequence(l.delayTime(1),l.callFunc(this.updateMessShareCD,this)));r.setTag(-1211),this.runAction(r)}return this.messDisableNode},addMenuItem:function(){var e=wr.getModel(),t=[],i=!this.mIsWin&&e.canShareMessData(),n=i?"btn_blue_ss.png":"btn_blue_s.png",s=i?"btn_green_m.png":"btn_green_b.png",r=new l.Sprite(n),a=new l.Sprite(n);a.scale=1.05;var o=new l.Sprite("#winlose_home.png");this.pItemPlay=new l.MenuItemSprite(r,a,null,this,this.menuCallback.bind(this)),this.pItemPlay.setTag(Nc),o.setPosition(.5*r.width,50),this.pItemPlay.addChild(o),t.push(this.pItemPlay),r=new l.Sprite(s),(a=new l.Sprite(s)).scale=1.05;var h=null;h=e.m_nGameMode==ge.CHALLENGEMODE?"win_dailyfinish.png":(e.isPlayMess(),"win_continue.png");var d="#"+(this.mIsWin?h:"lose_retry.png");o=new l.Sprite(d),this.pItemHome=new l.MenuItemSprite(r,a,null,this,this.menuCallback),this.pItemHome.setTag(this.mIsWin?Ic:Oc),o.setPosition(.5*r.width,50),this.pItemHome.addChild(o),t.push(this.pItemHome);var c=null;i&&(r=new l.Sprite(s),(a=new l.Sprite(s)).scale=1.05,d="lose_mess.png",(o=new l.Sprite(d)).setPosition(.5*r.width,50),this.pItemMess=new l.MenuItemSprite(r,a,null,this,this.menuCallback),this.pItemMess.addChild(o),this.pItemMess.setTag(Yc),t.push(this.pItemMess),c=this.disableMessShareBtn());var u=this.CurrentPlatForm==PlatformType.QQ,p=GamePlatform.isCN()?u?"win_qq.png":"win_wechat.png":"win_weibo.png",r=new l.Sprite(n);if((a=new l.Sprite(n)).scale=1.05,o=new l.Sprite(p),this.pItemWeibo=new l.MenuItemSprite(r,a,null,this,this.menuCallback.bind(this)),this.pItemWeibo.setTag(Gc),o.setPosition(.5*r.width,50),this.pItemWeibo.addChild(o),t.push(this.pItemWeibo),!e.isPlayMess()&&!e.usersData.bIsShareWeChat&&GamePlatform.getCurrentPlatForm()!=PlatformType.FaceBook){var m=new l.Sprite("gem_3.png");m.setAnchorPoint(.5,0),m.setPosition(.5*this.pItemWeibo.width+10,.5*this.pItemWeibo.height+20),this.pItemWeibo.addChild(m,1,3),this._rewardSpr=m}var _=new l.Menu(t);_.setPosition(0,0),_.setTag(Ac);var g=0;for(var T in t)g+=t[T].width;var f=t.length>=4?-5:10;g+=f*(t.length-1);for(var S=0,w=.5*(this.width-g),T=0;T<t.length;T++){var v=t[T];v.x=w+S+v.width*v.anchorX,S+=v.width,S+=f,v.y=92}c&&(c.setAnchorPoint(this.pItemMess.getAnchorPoint()),c.setPosition(this.pItemMess.getPosition()),this.addChild(c,1)),this.mBg.addChild(_,0),this._pMenu=_},beganRunAction:function(){var e=wr.getModel();if(this.mIsStep=!0,this.mIsWin)this.m_animaStep=1,e.m_nGameMode==ge.NORMALMODE&&this.menuEnable(!1),this.runAnimation();else{var t=l.scaleBy(0,1,0),i=l.scaleTo(.1,1,1.2),n=l.scaleTo(.1,1,1);this.mLogo.runAction(l.sequence(l.delayTime(.5),t,i,n));var s=e.mapConfig.allLevels[e.curLevel-1];0!=s.nBossModeSecond||s.bPresentGate||this.lableCurWave.runAction(l.repeatForever(l.sequence(l.delayTime(.01),l.callFunc(this.runLoseAnimation.bind(this)))))}},showHonor:function(){if(this._honor)return this._honor;var e=wr.getModel(),t=e.usersData,i=1;if(e.m_nGameMode==ge.CHALLENGEMODE)i=3;else if(this.mIsBossMode)i=(n=e.nCountDownTime)<4?1:n<10?2:3;else{var n=e.nCarrotHP;e.m_nGameMode===ge.DOUBLECARROT&&(n+=e.nSecondCarrotHP),i=n>=10?3:n>=4?2:1}return t.finalLevelFailCount=3-i,this._honor=i,i},showLogo:function(e){var t="";switch(e){case 3:t=String.formatC("cup_gold.png");break;case 2:t=String.formatC("cup_silver.png");break;case 1:default:t=String.formatC("cup_wood.png")}this.mLogo=new l.Sprite(String.formatC("%s",this.mIsWin?t:"lose_rip.png")),this.mLogo&&(this.mLogo.setPosition(this.mIsWin?l.p(564,528):l.p(570,458)),this.mLogo.setScale(this.mIsWin?0:1),this.mLogo.setScaleY(this.mIsWin?1:0),this.mBg.addChild(this.mLogo,0))},setAryLvStatus:function(){var e=wr.getModel(),t=e.usersData,i=e.curLevel;if(e.tasks&&e.m_nGameMode!=ge.CHALLENGEMODE)for(var n=e.tasks.length,s=t.getFinishTask(i),r=0;r<n;r++){if(1&s)this.m_aryLvStatus[r].bIsSeccuss=!1,this.m_aryLvStatus[r].stoneCount=0,this.m_aryLvStatus[r].bIsFinished=!0;else{var a=e.tasks[r];a.isSuccessful()?(t.setLevelFinishTask(e.curLevel,r+1,a.getGoldCoins()),this.m_aryLvStatus[r].bIsSeccuss=a.isFinished(),this.m_aryLvStatus[r].stoneCount=a.getGoldCoins(),this.m_aryLvStatus[r].bIsFinished=!0):a.isLessMore()&&a.dataType!=se.KILLOBJECT&&(a.isFinished()||(t.setLevelFinishTask(e.curLevel,r+1,a.getGoldCoins()),this.m_aryLvStatus[r].bIsSeccuss=!0,this.m_aryLvStatus[r].stoneCount=a.getGoldCoins(),this.m_aryLvStatus[r].bIsFinished=!0))}s>>=1}},onExit:function(){qu.clearOwner(this),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},uploadUserData:function(){var e=wr.getModel(),t=e.usersData,i=e.isPlayMess(),n=[],s=[],r=!1,a=e.getCostprops();for(var o in a){var h=a[o];s.push([h.id,h.count])}if(!i){this.mIsWin&&0==e.objects.length&&e.m_nGameMode!=ge.CHALLENGEMODE&&(r=!0,t.setLevelClearHonor(e.curLevel));var d=t.getObtainPropList();for(var o in d){var c=d[o];n.push([c.id,c.count])}}var u=e.curLevel,p=this.showHonor();0==p?this.mIsWin=!1:p=this.mIsWin?p:0;var m=this;if(i){r=0==e.objects.length;var _=e.getMessData();this.nStoneNum=_.getAwardGem(),Ql.finishMess(_.playerID,e.curLevel,1,this.nStoneNum,p,r,s,function(e,t){var i=t;if(e&&0===e.code){var n=wr.getModel();m.showWinOrLose(m.mIsWin),e.msg.dm&&n.usersData.setDiamond(e.msg.dm)}else e&&e.msg&&(i=e.msg),ju.alert(i,qi.loadLevelSelScene())})}else if(e.m_nGameMode!=ge.CHALLENGEMODE){if(this.nStoneNum=0,this.mIsWin){this.setAryLvStatus();for(var o in this.m_aryLvStatus)this.nStoneNum+=this.m_aryLvStatus[o].stoneCount;this.nStoneNum+=e.getCurLevelDiamond()}var g=this.nStoneNum,T={stageid:u,stagetype:this.stageType,dm:g,props:n,luobohealth:p,allclear:r,task1complete:!!this.mIsWin&&this.m_aryLvStatus[0].bIsFinished,task2complete:!!this.mIsWin&&this.m_aryLvStatus[1].bIsFinished,task3complete:!!this.mIsWin&&this.m_aryLvStatus[2].bIsFinished,costprops:s,openids:t.getAllFriendsOpenIds(),imei:"",clienttime:Math.floor(Date.now()/1e3),wechatversion:""};lp&&(T.wechatversion=SDKInterface.version),l.log("finishStage :"+JSON.stringify(T)),l.addTimePoint("gameover_loadserver_s"),Ql.finishStage(T,this.finishStage.bind(this),function(){m.mIsWin=!1,qu.loadResAsync(di,function(){m.showWinOrLose(m.mIsWin)})})}else{this.nStoneNum=e.getCurLevelDiamond();var f={issuccess:this.mIsWin,dm:this.nStoneNum,props:n,costprops:s};Ql.finishdailywar(f,this.finishdailywar.bind(this),function(){m.mIsWin=!1,qu.loadResAsync(di,function(){m.showWinOrLose(m.mIsWin)})})}},finishStage:function(e){if(void 0!=e){var t=this,i=wr.getModel(),n=i.usersData;n.clearObtainPropList(),i.clearCostprops(),n.setDiamond(e.dm),void 0==e.isopendaydayup||n.mIsUnlockedDayDayUp||(n.mIsUnlockedDayDayUp=e.isopendaydayup,this._isNeedShow=!0),void 0==e.isopendailywar||n.mIsUnlckedEverydayChanllenge||(n.mIsUnlckedEverydayChanllenge=e.isopendailywar,this._isNeedShow=!0),void 0!=e.overfriend&&(t.overfriend=e.overfriend),t.issharepassall=e.issharepassall,t.openedlv=e.openedlevel,t.stagetype===Le.NORMALMODE?n.setOpenLevel(e.openedlevel):t.stagetype===Le.DOUBLECARROT?n.setDoubelOpenLevel(e.openedlevel):t.stagetype===Le.MANORMODE&&n.setTempleOpenLevel(e.openedlevel);for(var s in e.prodata){var r=e.prodata[s];r&&n.setPropByPropid(r.propid,r.count)}e.thirdcd&&(n.bFisrtThird_Theme=!1,n.tirThemeWaitTime=e.thirdcd),n.zeroearnings=e.zeroearnings,n.getZeroearningsTime().result&&(t.nStoneNum=0),t.showWinOrLose(t.mIsWin),t.reportToSever(),l.addTimePoint("gameover_e"),l.printTimePoint("gameover_s","gameover_e")}},finishdailywar:function(e){if(void 0!=e){var t=wr.getModel();t.usersData.clearObtainPropList(),t.clearCostprops();for(var i in e.prodata){var n=e.prodata[i];n&&t.usersData.setPropByPropid(n.propid,n.count)}t.usersData.setDiamond(e.dm),t.usersData.zeroearnings=e.zeroearnings,t.usersData.getZeroearningsTime().result&&(this.nStoneNum=0),this.showWinOrLose(this.mIsWin),this.reportToSever(),l.addTimePoint("gameover_loadserver_e"),l.printTimePoint("gameover_loadserver_s","gameover_loadserver_e")}},reportToSever:function(){if(this.mIsWin&&lp){var e=wr.getModel(),t=e.usersData.getGoldCount(),i=e.usersData.getTaskHonorCount();GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp?SDKInterface.reportUserData({gold:t,crystal:i}):GamePlatform.getCurrentPlatForm()==PlatformType.QQ&&SDKInterface.reportUserData({openlv:this.openedlv,gold:t,crystal:i})}},showWinOrLose:function(e){var t=wr.getModel(),i=t.usersData.m_nLanguage;qu.addRes(this,String.formatC("res/Themes/scene/gameover_%s.plist",e?"win":"lose"));var i=t.usersData.m_nLanguage,n=String.formatC("res/Themes%s/scene/gameover_%s%s.plist",i,e?"win":"lose",i);qu.addRes(this,n),this.showWinOrLoseTitle(),this.showWinOrLoseInfo(e)},runAnimation:function(){var e=wr.getModel();switch(this.m_animaStep){case 1:this.m_spTitle.setPosition(.5*this.mBg.width,650);var t=l.moveTo(.1,.5*this.mBg.width,466),i=l.scaleTo(.1,1,.8),n=l.scaleTo(.1,1,1);this.m_animaStep=2,this.m_spTitle.runAction(l.sequence(l.delayTime(1),t,i,n,l.callFunc(this.runAnimation.bind(this))));break;case 2:var i=l.scaleBy(0,0,0),n=l.scaleTo(.2,2.5,2.5),s=l.scaleTo(.2,0,0);this.m_animaStep=3,this.m_spShine.runAction(l.sequence(l.delayTime(.1),i,n,l.callFunc(this.runAnimation.bind(this)),s));break;case 3:this.mLogo.setScale(1),this.loseadv.setScale(2);var i=l.scaleTo(.2,.8,.8),n=l.scaleTo(.1,1,1);this.m_animaStep=this.nStoneNum>0?4:5,this.loseadv.runAction(l.sequence(i,n,l.callFunc(this.runAnimation.bind(this))));break;case 4:this.lableStone.runAction(l.repeatForever(l.sequence(l.delayTime(.01),l.callFunc(this.runStoneNum.bind(this)))));break;case 5:if(this.nStoneNum>0&&this.runShine(),e.m_nGameMode==ge.CHALLENGEMODE){this.m_animaStep=8,this.runAnimation();break}o=this.mBg.getChildByTag(4001);if(this.m_aryLvStatus[0].bIsSeccuss&&o){var r=l.scaleTo(.2,.5,.5),a=l.scaleTo(.1,1,1);o.setScaleX(6),o.setScaleY(6),this.m_animaStep=6,o.runAction(l.sequence(r,a,l.callFunc(this.runAnimation.bind(this))))}else this.m_animaStep=6,this.runAnimation();break;case 6:o=this.mBg.getChildByTag(4002);if(this.m_aryLvStatus[1].bIsSeccuss&&o){var r=l.scaleTo(.2,.5,.5),a=l.scaleTo(.1,1,1);o.setScaleX(6),o.setScaleY(6),this.m_animaStep=7,o.runAction(l.sequence(r,a,l.callFunc(this.runAnimation.bind(this))))}else this.m_animaStep=7,this.runAnimation();break;case 7:var o=this.mBg.getChildByTag(4003);if(this.m_aryLvStatus[2].bIsSeccuss&&o){var r=l.scaleTo(.2,.5,.5),a=l.scaleTo(.1,1,1);o.setScaleX(6),o.setScaleY(6),this.m_animaStep=8,o.runAction(l.sequence(l.delayTime(.1),r,a,l.callFunc(this.runAnimation.bind(this))))}else this.m_animaStep=8,this.runAnimation();break;case 8:this.nStepNum=this.nStoneNum,this.lableStone.runAction(l.repeatForever(l.sequence(l.delayTime(.01),l.callFunc(this.runStoneNum.bind(this)))));break;case 9:if(e.m_nGameMode!=ge.CHALLENGEMODE){(this.m_aryLvStatus[0].stoneCount||this.m_aryLvStatus[1].stoneCount||this.m_aryLvStatus[2].stoneCount)&&this.runShine();var h=this.m_aryLvStatus[0].stoneCount+this.m_aryLvStatus[1].stoneCount+this.m_aryLvStatus[2].stoneCount;this.m_aryLvStatus[0].bIsFinished&&this.m_aryLvStatus[1].bIsFinished&&this.m_aryLvStatus[2].bIsFinished&&h>0?this.m_animaStep=10:this.m_animaStep=12,this.runAnimation()}else this.m_animaStep=12,this.mLogo.runAction(l.sequence(l.delayTime(30),l.callFunc(this.runAnimation.bind(this))));break;case 10:if(this.mLogo2=new l.Sprite("#win_cup_mission.png"),this.mLogo2){this.mLogo2.setPosition(564,720),this.mBg.addChild(this.mLogo2,11111);var d=l.moveTo(.1,564,471),i=l.scaleTo(.1,1,.8),n=l.scaleTo(.1,1,1);this.m_animaStep=12,this.mLogo2.runAction(l.sequence(l.delayTime(.1),d,l.callFunc(this.hideCup.bind(this)),i,n,l.callFunc(this.runAnimation.bind(this))))}break;case 11:break;case 12:var c=this;if(e.m_nGameMode==ge.NORMALMODE)if(GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp)if(3===this.showHonor()){var u=new np("surpass_friend");u.x=.5*this.width,u.y=.5*this.height;var p=!1;setTimeout(function(){p=!0},400),this.addChild(u,1);var m=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0},onTouchMoved:null,onTouchEnded:function(){p&&u.removeFromParent(),c.showNextStep()}});l.eventManager.addListener(m,u)}else this.showNextStep();else this.overfriend?GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook?qu.loadImages(Yt,this.runRankChange.bind(this)):this.runRankChange():(console.log("showNextStep"),this.showNextStep());this.m_animaStep=11,this.runAction(l.sequence(l.delayTime(30),l.callFunc(this.runAnimation,this)))}},runRankChange:function(){var e=this;qu.loadResAsync(Oi,function(){var t=Dl.create(e.overfriend,e.beforeGold);t.callBack=function(t){console.log("GameOver RankChange CallBack"),e.showNextStep(),t&&e._rewardSpr&&e._rewardSpr.removeFromParent()},t.showInTagret(e)})},showNextStep:function(){var e=wr.getModel(),t=e.usersData;e.isPlayMess()?this.menuEnable(!0):(l.log("users.rewardShortcut :"+t.rewardShortcut+" data.curLevel:"+e.curLevel),t.rewardShortcut==Ad.Type_Carriedout&&2==e.curLevel&&kl.coercionShowShortCut(Ad.Type_NoNeed),this.showNewNoticeOrFigure())},showNewNoticeOrFigure:function(){var e=[],t=!1;if(this.needShowNoticeDialog()&&(t=!0),this.needShowNewFigureAnimate()&&(e.push(Ki("res/Themes/Items/Common_shine_bg-hd.plist")),e.push(Ki("res/Themes/Items/Common_shine_bg-hd.png")),e.push(Ki("res/Themes/LevelSelect/shop_carrot.png")),e.push(Ki("res/Themes/LevelSelect/shop_carrot.plist")),t=!0),t){this.menuEnable(!1);var i=this,n=wr.getModel().usersData.m_nLanguage,s=String.formatC("res/Themes%s/scene/modeunlock%s.plist",n,n);e.push(Ki(s)),e.push(Ki(s.replace(".plist",".png"))),qu.loadResAsync(e,function(){for(var t in e){var n=e[t];".plist"===l.path.extname(n)&&qu.addRes(i,n)}i.showNoticeDialog()||i.ShowNewFigureAnimate()})}else this.menuEnable(!0)},hideCup:function(){var e=l.fadeOut(.2);this.mLogo.runAction(l.sequence(e))},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){wr.getModel().showRewardLayer||null!=this.mLayerAnimate&&(this.mLayerAnimate.removeFromParent(),this.mLayerAnimate=null,this.menuEnable(!0))},runShine:function(){if(this.mNumShine){this.mNumShine.setPosition(this.lableStone.getPosition());var e=l.scaleBy(0,0,0),t=l.scaleTo(.2,1,1),i=l.scaleTo(.1,0,0);this.mNumShine.runAction(l.sequence(l.delayTime(.1),e,t,i))}},runLoseAnimation:function(){if(1==this.mIsStep){this.nStepNum++;var e=wr.getModel();if(this.nStepNum>e.curWave)return;this.lableCurWave.setString(String.formatC("%.2d",this.nStepNum)),this.lableCurWave.setAnchorPoint(.5,.5),this.lableCurWave.setPosition(238,54),this.nStepNum==e.curWave&&this.lableCurWave.stopAllActions()}},runStoneNum:function(){if(1==this.mIsStep&&(this.nStoneNum>this.nStepNum&&this.nStepNum++,this.lableStone.setScale(1),this.lableStone.setString(String.formatC("%.2d",this.nStepNum)),this.lableStone.setAnchorPoint(.5,.5),this.nStepNum==this.nStoneNum))switch(this.lableStone.stopAllActions(),this.m_animaStep){case 4:this.m_animaStep=5,this.runAnimation();break;case 8:this.m_animaStep=9,this.runAnimation()}},update:function(e){if(this.unscheduleUpdate(),this.mIsWin){var t=l.spriteFrameCache.getSpriteFrame("winlose_shine_1.png");if(t){var i=new l.Sprite;i.initWithSpriteFrame(t),i.setPosition(564,543),this.mBg.addChild(i,10);for(var n=[],s=1;;){var r=l.spriteFrameCache.getSpriteFrame(String.formatC("winlose_shine_%d.png",s++));if(!r)break;n.push(r)}if(n.length){var a=new l.Animation(n,1/7),o=null;o=l.animate(a),i.runAction(l.sequence(l.delayTime(1),o))}}}},menuEnable:function(e){this._pMenu&&this._pMenu.setEnabled(e),this.pItemHome&&this.pItemHome.setEnabled(e),this.pItemPlay&&this.pItemPlay.setEnabled(e),this.pItemWeibo&&this.pItemWeibo.setEnabled(e),this.pItemMess&&this.pItemMess.setEnabled(e)},menuCallback:function(e){if(!this.getChildByTag(9999)){l.director.getScheduler().isWaite=!0,l.director.getScheduler().setTimeScale(1);var t=e,i=wr.getModel();if(!i.showRewardLayer){if(i.playSoundWithType($.MTMENUSELECT),this.mPopupTip&&this.mPopupTip.isVisible()){this.mPopupTip.setVisible(!1);var n=this.getChildByTag(5);n&&n.setEnabled(!0)}else this.menuEnable(!1);switch(t.getTag()){case Nc:i.bRestart=!1,i.playMuiscWithType($.MTACCOMPLISH,2);o=!1;this.replaceScene(o),i.bLockMenu=!1;break;case Ic:i.isPlayMess()?qi.preloadWithLoadingTag(Yd.getUsedRes(),we.LEVELSEL):160==i.curLevel&&i.usersData.getOpenedLevel()<27?qi.preloadWithLoadingTag(Ai,we.MEETFRIEND,o):this.continueNextLevel();break;case Gc:i.ys_ShareGameMenu=!0;var s=i.isPlayMess()?Wl.None:Wl.REWARD_SHARE,r=this;if(d=GamePlatform.getCurrentPlatForm()==PlatformType.QQ)kl.shareScreenshot(s,function(e){if(e){var t=r.pItemWeibo.getChildByTag(3);t&&t.removeFromParent()}});else{var a=this.mIsWin?1:2;kl.shareMessage(null,"",Wl.REWARD_SHARE,0,a,null,function(e){if(e){var t=r.pItemWeibo.getChildByTag(3);t&&t.removeFromParent()}})}Tt.onShare("sina-weibo","gameover"),this.menuEnable(!0),(h=t.getParent())&&h.setEnabled(!0);break;case kc:(h=t.getParent())&&(h.setEnabled(!0),this.menuEnable(!0)),(d=GamePlatform.getCurrentPlatForm()==PlatformType.QQ)?kl.shareScreenshot(Wl.PASSALL_SHARE,function(){h&&h.setVisible(!0)}):kl.shareMessage(null,b.Share_Text1,Wl.PASSALL_SHARE,0,5,null,function(){h&&h.setVisible(!0)});break;case Oc:i.bRestart=!0;var o=!1;i.isPlayMess()?qi.preloadWithGameScene(!1,i.getMessData()):(i.usersData.canPlay()?i.m_nGameMode==ge.CHALLENGEMODE?i.m_oChallenge.playCurLevel(o):(i.bRestart=!0,qi.preloadWithGameScene(o)):(i.bRestart=!1,this.replaceScene(o)),this.menuEnable(!0)),i.bLockMenu=!1;break;case Dc:return void(i.bLockMenu=!1);case Wc:this.menuEnable(!0);var h=t.getParent();h&&(h.setEnabled(!0),this.menuEnable(!0)),i.usersData.bhideFreeStone2||(h.setVisible(!1),i.usersData.bhideFreeStone2=!0,Tt.onReward("weibo-finish",1));var d=GamePlatform.getCurrentPlatForm()==PlatformType.QQ;d?kl.shareScreenshot(Wl.PASSALL_SHARE,function(){h&&h.setVisible(!0)}):kl.shareMessage(null,b.Share_Text1,Wl.PASSALL_SHARE,0,5,null,function(){h&&h.setVisible(!0)});break;case Uc:null!=this.mLayerNotice&&(this.removeChild(this.mLayerNotice),this.menuEnable(!0));break;case Hc:l.addTimePoint("GO_MAIN_S"),qi.preloadWithLoadingTag(Ht,we.MAIN);break;case Vc:l.addTimePoint("level start"),qi.preloadWithLoadingTag(Yd.getUsedRes(),we.LEVELSEL);break;case zc:null!=this.mLayerAnimate&&(this.mLayerAnimate.removeFromParent(),this.mLayerAnimate=null),this.menuEnable(!1),this.registerWithTouchDispatcher(!1);r=this;l.addTimePoint("shopopen_s"),qu.loadResAsync(ri,function(){var e=fo.create(3);e.closeCB=function(){r.menuEnable(!0),r.registerWithTouchDispatcher(!0)},r.addChild(e,100)});case Yc:var r=this,c=i.curLevel,u=String.format("{0}_{1}_{2}",l.playerInfo.id,c,1),p=l.path.join(GamePlatform.getCDN(),"res/shareImg/shareMess.jpg");if(!lp){this.menuEnable(!0);var m=i.getWaveDataForShare();return void this.sendShareMessToServer(c,1,m)}var _={context:!0,immediately:!0};SDKInterface.shareMessage(b.Share_Text24,b.Share_Text25,p,{mess:u},_,function(e){if(e){r._pMenu.setEnabled(!1);var t=i.getWaveDataForShare();r.sendShareMessToServer(c,1,t),Qu.show("")}else r.menuEnable(!0)})}}}},sendShareMessToServer:function(e,t,i){var n=this,s=wr.getModel();Ql.shareMess(e,t,i,function(e,t){if(Qu.hide(),n.menuEnable(!0),e)if(0==e.code){var i=e.msg;s.canShareMessTime=i.nexttime,ju.showLiteralsTip(b.Dialog_Hint10),n.disableMessShareBtn()}else ju.alert(e.msg);else ju.alert(t)})},replaceScene:function(e){var t=wr.getModel();if(t.m_nGameMode==ge.CHALLENGEMODE)l.addTimePoint("GO_MAIN_S"),qi.preloadWithLoadingTag(Ht,we.MAIN,e);else if(t.curLevel<136){i=[];i=t.m_nGameMode==ge.HIGHERMODE?Ei:Yd.getUsedRes(),l.addTimePoint("level start"),l.addTimePoint("storey_start"),qi.preloadWithLoadingTag(i,we.THEME,e)}else if(t.curLevel>135&&t.curLevel<156){var i=[];i=t.m_nGameMode==ge.HIGHERMODE?Ei:qt,l.addTimePoint("storey_start"),l.addTimePoint("levelSel_start"),qi.preloadWithLoadingTag(i,we.THEMETEMPLE,e)}else t.curLevel>155&&t.curLevel<mr?(l.addTimePoint("meetfiend_start"),qi.preloadWithLoadingTag(Ai,we.MEETFRIEND,e)):(l.addTimePoint("GO_MAIN_S"),qi.preloadWithLoadingTag(Ht,we.MAIN,e))},removeFramesFile:function(e){},continueNextLevel:function(){var e=wr.getModel();if(e.bRestart=!1,e.curLevel>=e.usersData.openmaxstage&&e.curLevel<135)this.replaceScene();else{if(e.m_nGameMode==ge.CHALLENGEMODE)return qi.preloadWithLoadingTag(Ht,we.MAIN),void(e.bLockMenu=!1);if(e.curLevel!=e.usersData.getOpenedLevel())if(e.usersData.canPlay()){var t=we.THEME;if(this.mIsWin&&e.curLevel<135){if(50==e.curLevel&&e.usersData.getGoldCount()<40&&51==e.usersData.getNextLevel())return void this.replaceSceneToTheme();if(30==e.curLevel&&!e.usersData.bIsBuyCarrotThird&&31==e.usersData.getNextLevel())return void this.replaceSceneToTheme();if(65==e.curLevel&&e.usersData.getTaskHonorCount()<55&&66==e.usersData.getNextLevel())return void this.replaceSceneToTheme();if(80==e.curLevel&&81==e.usersData.getNextLevel()){if(e.usersData.getTaskHonorCount()<60||e.usersData.getGoldCount()<55)return void this.replaceSceneToTheme()}else if(100==e.curLevel&&101==e.usersData.getNextLevel()){if(e.usersData.getGoldCount()<70)return void this.replaceSceneToTheme()}else if(115==e.curLevel&&116==e.usersData.getNextLevel()&&(e.usersData.getGoldCount()<80||e.usersData.getTaskHonorCount()<75))return void this.replaceSceneToTheme();e.curLevel=e.usersData.getLastPlayedLevel()+1,t=we.GAME}else e.curLevel>135&&e.curLevel<155?(e.curLevel=e.usersData.getTempleLastPlayedLevel()+1,t=we.GAME):e.curLevel>155&&e.curLevel<170&&(e.curLevel=e.usersData.getDoubelLastPlayedLevel()+1,t=we.GAME);t===we.GAME?(e.usersData.userEnter(),qi.preloadWithGameScene()):this.replaceSceneToTheme(),e.bLockMenu=!1,this.setShowAch()}else e.m_nGameMode==ge.DOUBLECARROT?qi.preloadWithLoadingTag(Ai,we.MEETFRIEND):this.replaceScene();else this.replaceSceneToTheme()}},replaceSceneToTheme:function(){var e=[];e=wr.getModel().m_nGameMode==ge.HIGHERMODE?Ei:Yd.getUsedRes(),qi.preloadWithLoadingTag(e,we.THEME)},setShowAch:function(){},showFinalLayer:function(){if(!this.mLayerFinal){this.mLayerNormal&&this.mLayerNormal.removeAllChildrenWithCleanup(!0);var e=wr.getModel();qu.addRes(this,"res/Themes/scene/gameover01.plist");var t=e.usersData.m_nLanguage,i="";i=e.usersData.openmaxstage==e.curLevel?String.formatC("res/Themes%s/scene/gamefinal50%s.plist",t,t):String.formatC("res/Themes%s/scene/gameover01%s.plist",t,t),qu.addRes(this,i),this.mLayerFinal=new l.Layer,this.addChild(this.mLayerFinal,100);var n=nr.share().getMapOffset(),s=l.spriteFrameCache.getSpriteFrame("final_bg.png");if(s){var r=new l.Sprite;r.initWithSpriteFrame(s),r.setPosition(480+n.width,320),this.mLayerFinal.addChild(r)}if(s=l.spriteFrameCache.getSpriteFrame("final_goon.png")){var a=new l.Sprite;a.initWithSpriteFrame(s),a.setPosition(601+n.width,464),this.mLayerFinal.addChild(a);var o=l.delayTime(1),h=l.scaleTo(0,0,1),d=l.scaleTo(0,.1,1),c=l.scaleTo(.2,1.2,1),u=l.scaleTo(.1,1,1),p=l.sequence(h,o,d,c,u);a.runAction(p)}if(s=l.spriteFrameCache.getSpriteFrame("final_text.png")){var m=new l.Sprite;m.initWithSpriteFrame(s),m.setPosition(480+n.width,504),this.mLayerFinal.addChild(m),m.setOpacity(0);var _=l.fadeIn(1);m.runAction(_)}var g=null,T=null,f=null,S=this.CurrentPlatForm==PlatformType.QQ,w=new l.Sprite(S?"final_share_qq_2.png":"final_share_wechat_2.png");w&&((T=new l.MenuItemSprite(w,null,null,this,this.menuCallback.bind(this))).setTag(Wc),T.setPosition(743+n.width,396));var v=new l.Sprite(S?"final_share_qq.png":"final_share_wechat.png");if(v){(f=new l.MenuItemSprite(v,null,null,this,this.menuCallback.bind(this))).setTag(kc),f.setPosition(839+n.width,483);var L=l.scaleTo(.2,1.3),M=l.scaleTo(.2,.8),C=l.scaleTo(.2,1),y=l.delayTime(3),p=l.sequence(L,M,C,y),B=l.repeatForever(p);f.runAction(l.repeatForever(B))}var F=new l.Sprite("#final_close.png"),E=new l.Sprite("#final_close.png");if(F){(g=new l.MenuItemSprite(F,E,null,this,this.menuCallback.bind(this))).setTag(Nc);var P=GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp?60:0;g.setPosition(l.p(nr.share().getWinSize().width-g.width*(1-g.anchorX),nr.share().getWinSize().height-g.height*(1-g.anchorY)-P))}var b=new l.Menu(g,T,f);b.setPosition(0,0),this.mLayerFinal.addChild(b),e.playMuiscWithType($.MTACCOMPLISH,1)}},showFinalLayer155:function(){if(!this.mLayerFinal){this.mLayerNormal&&this.mLayerNormal.removeAllChildrenWithCleanup(!0),qu.addRes(this,"res/Themes/scene/ip6.plist"),this.mLayerFinal=new l.Layer,this.addChild(this.mLayerFinal,100);var e=nr.share().getMapOffset(),t=null;if(t=l.spriteFrameCache.getSpriteFrame("ip6_bg.png")){var i=new l.Sprite;i.initWithSpriteFrame(t),i.setPosition(480+e.width,320),this.mLayerFinal.addChild(i)}if(t=l.spriteFrameCache.getSpriteFrame("final_text.png")){var n=new l.Sprite;n.initWithSpriteFrame(t),n.setPosition(480+e.width,504),this.mLayerFinal.addChild(n),n.setOpacity(0);var s=l.fadeIn(1);n.runAction(s)}var r=wr.getModel(),a=GamePlatform.getCurrentPlatForm()==PlatformType.QQ,o=GamePlatform.isCN()?a?"themelocked_theme3_share_qq.png":"themelocked_theme3_share_wechat.png":"themelocked_theme3_share.png",h=new l.Sprite(o),d=new l.Sprite(o),c=new l.Sprite("#btn_green_m.png");c.addChild(h),h.setPosition(c.width/2,c.height/2);var u=new l.Sprite("#btn_green_m_pressed.png");u.addChild(d),d.setPosition(u.width/2,u.height/2);var p=new l.MenuItemSprite(c,u,null,this,this.menuCallback.bind(this));p.setTag(Gc),p.setPosition(626+e.width,217);var m=null,_=new l.Sprite("#ip6_close.png"),g=new l.Sprite("#ip6_close.png");_&&((m=new l.MenuItemSprite(_,g,null,this,this.menuCallback.bind(this))).setTag(Nc),m.setPosition(864+e.width,501));var T=new l.Menu(p,m);T.setPosition(0,0),this.mLayerFinal.addChild(T),r.playMuiscWithType($.MTACCOMPLISH,1)}},shotCurScreen:function(){Rt.share(null)},needShowNoticeDialog:function(){var e=wr.getModel(),t=(nr.share().getWinSize(),nr.share().getMapOffset(),e.curLevel),i=e.usersData.getOpenedLevel()-1;return!(t!=O.SHOWEVERYDAYCHALLAENGE||e.usersData.mIsUnlckedEverydayChanllenge&&!this._isNeedShow)||(t==O.SHOWCASTLELEVEL&&!e.usersData.bShowedTempleEntranceAnimate||(!(t!=O.SHOWHIGHSTOREY||e.usersData.mIsUnlockedDayDayUp&&!this._isNeedShow||!GamePlatform.getIsShowAll())||(t==O.SHOWMEETAQIULEFT&&i==O.SHOWMEETAQIULEFT||24==t&&24==i&&(e.usersData.bIsUnlockedSuperPackage=!0,!1))))},showNoticeDialog:function(){var e=wr.getModel(),t=nr.share().getWinSize(),i=nr.share().getMapOffset(),n=e.curLevel,s=e.usersData.getOpenedLevel()-1,r=-1,a=null;if(n!=O.SHOWEVERYDAYCHALLAENGE||e.usersData.mIsUnlckedEverydayChanllenge&&!this._isNeedShow)if(n!=O.SHOWCASTLELEVEL||e.usersData.bShowedTempleEntranceAnimate)if(n!=O.SHOWHIGHSTOREY||e.usersData.mIsUnlockedDayDayUp&&!this._isNeedShow||!GamePlatform.getIsShowAll())if(n==O.SHOWMEETAQIULEFT&&s==O.SHOWMEETAQIULEFT){var o=l.spriteFrameCache.getSpriteFrame("modeunlock_meetaqo615_text.png");null!=o&&((a=new l.Sprite(o)).setPosition(l.p(401,340)),r=Vc,e.usersData.mIsShowedAQiuTipsAnimation=!1)}else{if(24!=n||24!=s)return!1;e.usersData.bIsUnlockedSuperPackage=!0}else null!=(o=l.spriteFrameCache.getSpriteFrame("modeunlock_up_text.png"))&&((a=new l.Sprite(o)).setPosition(l.p(401,340)),r=Hc,e.usersData.mIsUnlockedDayDayUp=!0);else null!=(o=l.spriteFrameCache.getSpriteFrame("modeunlock_temple_text.png"))&&((a=new l.Sprite(o)).setPosition(l.p(401,340)),r=Vc);else null!=(o=l.spriteFrameCache.getSpriteFrame("modeunlock_daily_text.png"))&&((a=new l.Sprite(o)).setPosition(l.p(401,340)),r=Hc,e.usersData.mIsUnlckedEverydayChanllenge=!0);if(null==a)return!1;var h=l.spriteFrameCache.getSpriteFrame("woodbg_notice.png"),d=new l.Sprite(h);d.setPosition(l.p(478+i.width,311)),d.addChild(a),this.mLayerNotice=new l.LayerColor(l.color(0,0,0,180),t.width,t.height),this.mLayerNotice.setAnchorPoint(.5,.5),this.mLayerNotice.addChild(d,99),this.addChild(this.mLayerNotice,101);var c=l.spriteFrameCache.getSpriteFrame("popup_close_frame.png"),u=new l.Sprite(c);c=l.spriteFrameCache.getSpriteFrame("popup_close.png");var p=new l.Sprite(c);p.setPosition(.5*u.width,.5*u.height),u.addChild(p);var m=new l.MenuItemSprite(u,null,null,this,this.menuCallback.bind(this));m.setTag(Uc),m.setPosition(l.p(743,410)),c=l.spriteFrameCache.getSpriteFrame("btn_blue_b.png");var _=new l.Sprite("btn_blue_b.png");c=l.spriteFrameCache.getSpriteFrame("btn_blue_b_pressed.png");var g=new l.Sprite(c);c=l.spriteFrameCache.getSpriteFrame("modeunlock_btn_go.png");var T=new l.Sprite(c),f=new l.Sprite(c);T.setPosition(_.width/2,_.height/2),f.setPosition(g.width/2,g.height/2),_.addChild(T),g.addChild(f);var S=new l.MenuItemSprite(_,g,null,this,this.menuCallback.bind(this));S.setTag(r),S.setPosition(l.p(403,154));var w=new l.Menu(S,m);return w.setPosition(0,0),d.addChild(w),!0},needShowNewFigureAnimate:function(){var e=wr.getModel(),t=e.usersData;e.usersData.showFigureAnimateInLevelSel(!1);var i=e.usersData.getOpenedLevel()-1,n=e.curLevel==O.SHOWMEETAQIU&&i==O.SHOWMEETAQIU&&t.isUnlockCarrot(ue.CARROT_GIRL)&&!t.isCarrotBuy(ue.CARROT_GIRL),s=e.curLevel==O.SHOWMEETADAI&&i==O.SHOWMEETADAI&&t.isUnlockCarrot(ue.CARROT_FAT)&&!t.isCarrotBuy(ue.CARROT_FAT),r=e.curLevel==O.SHOWMEETADA&&i==O.SHOWMEETADA&&!t.mIsUnlockedCarrotOld&&!t.isCarrotBuy(ue.CARROT_OLD);return!!(n||s||r)},ShowNewFigureAnimate:function(){var e=wr.getModel(),t=e.usersData;e.usersData.showFigureAnimateInLevelSel(!1);var i=nr.share().getWinSize(),n=e.usersData.getOpenedLevel()-1,s=e.curLevel==O.SHOWMEETAQIU&&n==O.SHOWMEETAQIU&&t.isUnlockCarrot(ue.CARROT_GIRL)&&!t.isCarrotBuy(ue.CARROT_GIRL),r=e.curLevel==O.SHOWMEETADAI&&n==O.SHOWMEETADAI&&t.isUnlockCarrot(ue.CARROT_FAT)&&!t.isCarrotBuy(ue.CARROT_FAT),a=e.curLevel==O.SHOWMEETADA&&n==O.SHOWMEETADA&&!t.mIsUnlockedCarrotOld&&!t.isCarrotBuy(ue.CARROT_OLD);if(!s&&!r&&!a)return!1;this.mLayerAnimate=new l.LayerColor(l.color(0,0,0,178),i.width,i.height),this.addChild(this.mLayerAnimate,101),this.m_spShineBg=new l.Sprite("shine_bg.png"),null!=this.m_spShineBg&&(this.m_spShineBg.setPosition(i.width/2,i.height/2),this.mLayerAnimate.addChild(this.m_spShineBg,99)),this.m_spShineBg.setScale(.1);var o=l.scaleTo(.2,1),h=l.callFunc(this.ShineBgAnimate.bind(this));this.m_spShineBg.runAction(l.sequence(o,h));var d=new l.Sprite("newcarrot_bg.png"),c=new l.Sprite("newcarrot_bg.png"),u=new l.MenuItemSprite(d,c,null,this,this.menuCallback.bind(this));if(null!=u&&(u.setTag(zc),u.setPosition(.5*this.mLayerAnimate.width,.5*this.mLayerAnimate.height)),a){(b=new l.Sprite("shop_carrot_old.png")).setPosition(u.width/2,u.height/2+100),u.addChild(b,1,1),null!=b&&b.stopAllActions();for(var p=[],m=1;m<=2;++m){f=String.formatC("shop_carrot_old_%d.png",m);p.push(l.spriteFrameCache.getSpriteFrame(f))}for(var _=new l.Animation(p,.1),g=[],T=1;T<=3;++T){var f=null;f=3!=T?String.formatC("shop_carrot_old_%d.png",T):String.formatC("shop_carrot_old.png"),g.push(l.spriteFrameCache.getSpriteFrame(f))}var S=new l.Animation(g,.1),w=l.sequence(l.delayTime(2),l.animate(_),l.animate(_),l.animate(_),l.animate(S));b.runAction(l.repeatForever(w)),t.mIsUnlockedCarrotOld=!0}else if(r){var v=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat.png");(b=new l.Sprite(v)).setPosition(u.width/2,u.height/2+100),u.addChild(b,1,1),null!=b&&b.stopAllActions();var L=[],M=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_1.png"),C=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_2.png"),y=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_3.png"),B=l.spriteFrameCache.getSpriteFrame("shop_carrot_fat_4.png");L.push(M),L.push(C),L.push(y),L.push(C),L.push(M),L.push(C),L.push(y),L.push(C),L.push(B),L.push(v);var F=new l.Animation(L,.1),E=l.sequence(l.delayTime(2),l.animate(F));b.runAction(l.repeatForever(E)),e.usersData.bIsUnlockedSuperPackage=!0}else if(s){var P=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl.png"),b=new l.Sprite(P);b.setPosition(u.width/2,u.height/2+100),u.addChild(b,1,1),null!=b&&b.stopAllActions();var A=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_1.png"),I=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_2.png"),R=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_3.png"),D=l.spriteFrameCache.getSpriteFrame("shop_carrot_girl_4.png"),x=[A,I,R,D,A,I,R,D,P],N=new l.Animation(x,.1),G=l.sequence(l.delayTime(2),l.animate(N));b.runAction(l.repeatForever(G)),e.usersData.bIsUnlockedSuperPackage=!0}var W=new l.Sprite("newcarrot_cover.png");W.setPosition(u.width/2,u.height/2),u.addChild(W);var k=new l.Menu(u);return k.setPosition(0,0),this.mLayerAnimate.addChild(k),!0},ShineBgAnimate:function(){var e=l.fadeTo(.3,128),t=l.fadeTo(.3,255),i=l.repeatForever(l.sequence(e,t));this.m_spShineBg.runAction(i)}});Xc.create=function(){return new Xc},Xc.sceneWin=function(e){wr.getModel().curLevelResult=2;var t=Xc.create();return t.initWinLose(!0,e),e.addChild(t,1e3,1e3),e},Xc.sceneLose=function(e){wr.getModel().curLevelResult=1;var t=Xc.create();return t.initWinLose(!1,e),e.addChild(t,1001,1001),e};var jc=1e3,Kc=Zs.extend({spProp:null,spStoneShop:null,nSub:0,nItemTag:0,lableItemCount:null,nBuy:0,listener:null,_first:!0,_Customlistener:null,ctor:function(){this._super(Ks.DT_TITLE)},addChildItems:function(){var e=.5;nr.share().isIPad()&&(e=1),this.registerWithTouchDispatcher();var t=new l.Sprite("getprop_title.png");t.setPosition(412*e,509*e),this.spMainFrame.addChild(t);var i=new l.Sprite("getprop_stone.png");i.setPosition(413*e,353*e),this.spMainFrame.addChild(i);var n=new l.Sprite("sepline.png");n.setPosition(412*e,152*e),this.spMainFrame.addChild(n);var s=new l.Sprite("stone_amountbg.png");s.setPosition(258*e,214*e),this.spMainFrame.addChild(s);var r=s.getContentSize(),a=new l.Sprite("shop_gem.png");a.setAnchorPoint(l.p(.5,.5)),a.setScale(1.4),a.setPosition(l.p(28,.5*r.height-3)),s.addChild(a);var o=this.spMainFrame.getBoundingBox(),h=this.menuItemWithFile("stone_add.png",R,l.p(.415*o.width,.39*o.height)),d=this.menuItemWithFile("getprop_get.png",jc,l.p(.5*o.width,.18*o.height)),c=wr.getModel();h.visible=c.usersData.enablepay;var u=new l.Menu(h,d);if(u.setPosition(0,0),this.spMainFrame.addChild(u,99),GamePlatform.isCN()&&c.usersData.enablepay){var p=this;qu.loadResAsync(Ti,function(){p.spStoneShop=Wa.create(),p.spStoneShop.setPosition(0,-1800*e),p.spStoneShop.spTopFrame=p.spMainFrame,p.addChild(p.spStoneShop)})}this.addCustomListener()},loadResources:function(){qu.addRes(this,"res/Themes/LevelSelect/StoneToProp-hd.plist");var e=wr.getModel().usersData.m_nLanguage,t=String.formatC("res/Themes%s/LevelSelect/StoneToProp-hd%s.plist",e.toString(),e.toString());qu.addRes(this,t)},addCustomListener:function(){var e=this;this._Customlistener&&l.eventManager.removeListener(this._Customlistener),this._Customlistener=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"diamondChange",callback:function(t){e.changeStoneCount()}}),l.eventManager.addListener(this._Customlistener,1)},changeStoneCount:function(){var e=wr.getModel(),t=String.formatC("%lu",e.usersData.getDiamond());this.lableStoneCount.setString(t.toString()),this.spStoneShop&&this.spStoneShop.changeStoneCount()},onExit:function(){this.removeAllChildren(!0),this.listener&&l.eventManager.removeListener(this.listener),this._Customlistener&&l.eventManager.removeListener(this._Customlistener),qu.clearOwner(this),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},ShowProp:function(e){this.nItemTag=e;var t=.5;nr.share().isIPad()&&(t=1);var i=null,n=null;switch(e){case 100:this.nSub=400,i=String.formatC("getprop_bomb.png"),n=String.formatC("getprop_name_bomb.png");break;case 101:this.nSub=300,i=String.formatC("getprop_blood.png"),n=String.formatC("getprop_name_blood.png");break;case 102:this.nSub=150,i=String.formatC("getprop_speed.png"),n=String.formatC("getprop_name_speed.png");break;case 103:this.nSub=200,i=String.formatC("getprop_ice.png"),n=String.formatC("getprop_name_ice.png");break;case 104:this.nSub=200,i=String.formatC("getprop_slow.png"),n=String.formatC("getprop_name_slow.png")}this.spProp=new l.Sprite(i.toString()),this.spProp.setPosition(413*t,353*t),this.spMainFrame.addChild(this.spProp);var s=new l.Sprite(n.toString());s.setPosition(516*t,213*t),this.spMainFrame.addChild(s);var r=wr.getModel(),a=r.usersData.getDiamond();this.lableStoneCount=new l.LabelAtlas("0000","num_white_18.png",18*t,30*t,"./0123456789"),this.lableStoneCount.setString(String.formatC("%lu",a)),this.lableStoneCount.setPosition(210*t,198*t),this.spMainFrame.addChild(this.lableStoneCount,111,111);var o=new l.Sprite("counterbg_s.png");o.setPosition(621*t,213*t),this.spMainFrame.addChild(o);var h=r.usersData.getPropCountByid(e-99);this.lableItemCount=new l.LabelAtlas("00","num_white_18.png",18*t,30*t,"./0123456789"),this.lableItemCount.setString(h),this.lableItemCount.setAnchorPoint(.5,.5),this.lableItemCount.setPosition(621*t,214*t),this.spMainFrame.addChild(this.lableItemCount)},NoStoneUpdate:function(){var e=this.spMainFrame.getPosition(),t=l.moveTo(.1,e.x,e.y+30),i=l.moveTo(.2,e.x,e.y+670);this.spMainFrame.runAction(l.sequence(t,i));var n=l.moveTo(.2,0,-30),s=l.moveTo(.1,0,0),r=l.callFunc(function(){this.spStoneShop.showPrice()}.bind(this,this.spStoneShop));this.spStoneShop.runAction(l.sequence(n,s,r))},menuCallback:function(e){var t=wr.getModel(),i=e;switch(i.getTag()){case jc:if(t.usersData.getDiamond()<this.nSub){n=this;return void(t.usersData.enablepay?qu.loadResAsync(Wi,function(){var e=aa.create();n.addChild(e,99,991),e.setParent(n,Ar),e.setShowDescription1(ea),e.isWait=!1}):ju.showLiteralsTip(b.Dialog_Hint))}if(t.playSoundWithType($.MTPAGESELECT),dp){var n=this,s=t.usersData,r=this.nItemTag-100+1;if(void 0==r||r<=0)return void ju.alert(b.Dialog_Hint7);this.givencount=s.getObtainPropByid(r),this.givencount=this.givencount>0?this.givencount:0,this.usedCount=t.getCostPropById(r),this.usedCount=this.usedCount>0?this.usedCount:0;var a=s.getPropCountByid(r),o=(a=a>0?a:0)+this.usedCount-this.givencount;o<=0&&(o=0),i.setEnabled(!1),console.log("before 购买的物品ID:"+r+"玩家现在拥有的数量: "+a+" 赠送的数量:"+this.givencount+" 使用了的数量:"+this.usedCount+" 同步的数量:"+o),Ql.buyPropById(r,1,o,function(e){if(void 0!=e){s.setDiamond(e.dm);var r=e.propdata;if(r){var a=r.propid+99,o=t.gameLayer.gameHUD,h=r.count+n.givencount-n.usedCount;(void 0==h||h<0)&&(h=0),console.log("after 购买的物品ID :"+r.propid+" 玩家现在拥有的数量:"+h+"服务器记录的数量:"+r.count),s.setPropByPropid(r.propid,h),o&&o.UpdateBarItemCounter(h,a),n.lableItemCount.setString(String.formatC("%d",h)),n.changeStoneCount(),i.setEnabled(!0)}else ju.alert(b.Dialog_Hint7)}},function(){i.setEnabled(!0)})}else this.nBuy+=1,t.usersData.addDiamond(-this.nSub),this.lableItemCount.setString(String.formatC("%d",this.nBuy)),this.changeStoneCount();break;case R:if(t.usersData.enablepay&&this.spStoneShop){t.playSoundWithType($.MTPAGESELECT);var h=this.spMainFrame.getPosition(),d=l.moveTo(.1,h.x,h.y+30),c=l.moveTo(.2,h.x,h.y+670);this.spMainFrame.runAction(l.sequence(d,c));var u=l.moveTo(.2,0,-30),p=l.moveTo(.1,0,0),m=l.callFunc(function(){this.spStoneShop.showPrice()}.bind(this,this.spStoneShop));this.spStoneShop.runAction(l.sequence(u,p,m))}}},registerWithTouchDispatcher:function(){this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){var i=.5;nr.share().isIPad()&&(i=1);var n=wr.getModel(),s=this.spMainFrame.convertTouchToNodeSpace(e),r=(this.lableStoneCount.getContentSize(),l.rect(this.lableStoneCount.x-12*i,this.lableStoneCount.y,100*i,38*i));if(l.rectContainsPoint(r,s)&&n.usersData.enablepay&&this.spStoneShop){n.playSoundWithType($.MTPAGESELECT);var a=this.spMainFrame.getPosition(),o=l.moveTo(.1,a.x,a.y+30),h=l.moveTo(.2,a.x,a.y+670);this.spMainFrame.runAction(l.sequence(o,h));var d=l.moveTo(.2,0,-30),c=l.moveTo(.1,0,0),u=l.callFunc(function(){this.spStoneShop.showPrice()}.bind(this,this.spStoneShop));this.spStoneShop.runAction(l.sequence(d,c,u))}else;},menuItemWithFile:function(e,t,i,n){var s=new l.Sprite(e),r=null;r=null==n?new l.Sprite(e):new l.Sprite(n);var a=new l.MenuItemSprite(s,r,null,this.menuCallback.bind(this),this);return s.setAnchorPoint(.5,.5),s.setPosition(.5*a.width,.5*a.height),r.setAnchorPoint(.5,.5),r.setPosition(.5*a.width,.5*a.height),r.setScale(null==n?1.1:1),a.setTag(t),a.setPosition(i),a},UpdateMigic:function(){}});Kc.create=function(){return new Kc};var qc={BTN_CHANGE:0,BTN_LIFEFOREVER:1},Qc=Zs.extend({listener:null,m_pTarget:null,_lableMinute:null,_lableSecond:null,_isUpdate:!1,ctor:function(e){this._isUpdate=e,this._super(Ks.DT_NOTICE)},addChildItems:function(){var e=wr.getModel(),t=e.usersData.m_nLanguage;qu.addRes(this,String.formatC("res/Themes%s/LevelSelect/lifeless.plist",t));var i=new l.Sprite(e.m_nGameMode==ge.HIGHERMODE?"floor_nolife_text.png":"nolife_text.png");i.setPosition(396,385),this.spMainFrame.addChild(i,2,1e3);var n=e.usersData.getWaitMS(),s=String.formatC("%02lu",n.m),r=new l.LabelAtlas(s,"num_white_18.png",18,30,"./0123456789");r.setAnchorPoint(0,0),r.setPosition(213,46),r.setTag(1001),i.addChild(r),this._lableMinute=r;var a=String.formatC("%02lu",n.s),o=new l.LabelAtlas(a,"num_white_18.png",18,30,"./0123456789");o.setAnchorPoint(0,0),o.setPosition(259,46),o.setTag(1002),i.addChild(o),this._lableSecond=o;var h=new l.Sprite("sepline_s.png");h.setPosition(401,210),this.spMainFrame.addChild(h,2);var d=this.spMainFrame.getBoundingBox(),c=this.menuItemWithFile("btn_blue_m.png","btn_blue_m_pressed.png","nolife_get.png",qc.BTN_CHANGE,l.p(.5*d.width,.31*d.height)),u=new l.Menu(c);u.setPosition(0,0),this.spMainFrame.addChild(u,99),e.usersData.getGameStars()<O.STARFULLCOUNT2&&this._isUpdate&&this.schedule(this.UpDateTimes,1)},loadResources:function(){wr.getModel().usersData.m_nLanguage;this.registerWithTouchDispatcher(!0)},changeStoneCount:function(){},onExit:function(){qu.clearOwner(this),this.doOnCloseCallback(),this.removeAllChildren(),this.listener&&l.eventManager.removeListener(this.listener),this._super()},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},menuItemWithFile:function(e,t,i,n,s,r){r=r||1;var a=new l.Sprite(e),o=new l.Sprite(i);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o);var h=new l.Sprite(t),d=new l.Sprite(i);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d);var c=new l.MenuItemSprite(a,h,null,this,this.menuCallback.bind(this));return c.setTag(n),c.setPosition(s),c},menuCallback:function(e){var t=e.getTag();switch(wr.getModel().playSoundWithType($.MTPAGESELECT),t){case qc.BTN_CHANGE:i=this.getParent();this.setVisible(!1);l.addTimePoint("LifeRequestDlg_s"),qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(1),i.addChild(e,99)}),this.getParent().removeChild(this,!0);break;case qc.BTN_LIFEFOREVER:var i=this.getParent();this.setVisible(!1);l.addTimePoint("LifeRequestDlg_s"),qu.loadResAsync(Di,function(){var e=Na.create();e.SetShowLayer(2),i.addChild(e,99)}),this.getParent().removeChild(this,!0)}},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},UpDateTimes:function(e){var t=wr.getModel(),i=t.usersData.getWaitMS();this._lableMinute&&this._lableMinute.setString(String.formatC("%02lu",i.m)),this._lableSecond&&this._lableSecond.setString(String.formatC("%02lu",i.s)),t.usersData.getGameStars()>=O.STARFULLCOUNT2&&this.unschedule(this.UpDateTimes)},setOnCloseCallback:function(e,t){this.m_pTarget=e,this.m_callback=t},doOnCloseCallback:function(){this.m_pTarget&&this.m_callback&&this.m_callback&&this.m_callback()}});Qc.create=function(e){return new Qc(e)};var Zc=90,Jc=91,$c=100,eu=101,tu=102,iu=103,nu=104,su=105,ru=106,au=107,ou=108,hu=109,lu=110,du=111,cu=112,uu=113,pu=114,mu=115,_u=116,gu=117,Tu=118,fu=119,Su=120,wu=121,vu=122,Lu=123,Mu=124,Cu=125,yu=126,Bu=127,Fu=128,Eu=129,Pu=130,bu=0,Au=1,Ou=2,Iu=3,Ru=4,Du=5,xu=6,Nu=7,Gu=50,Wu=80,ku=function(e){var t=wr.getModel();e?t.mainLayer&&t.mainLayer.showKTwithRed(!0):t.mainLayer&&t.mainLayer.showKTwithRed(!1)},Uu=0,Hu=Xs.extend({m_animLayer:null,mPopupTip:null,mPopupUnLock:null,mMoveLength:0,carrot:null,bSet:!1,m_nComic:0,m_bShowChallenge:!1,mUnfoldState:!1,listener:null,mScale:1,_listener2:null,mUnfoldSign:null,mUnfoldOpenBg:null,dotSpr:null,ablres:null,aqres:null,_btnList:null,_mailDotSpr:null,_foldBtnList:null,_isRewards:!1,foldDotSpr:null,groupDotSpr:null,_LoginRecord:null,redButton:null,ctor:function(){l.addTimePoint("mainscene_s"),this._super(),this.addLayerName("scene-main")},onExit:function(){this.m_bShowChallenge=!1;var e=wr.getModel();e.mainLayer=null,this.unscheduleAllCallbacks(),e.playMuiscWithType($.MTSTARTBGMSC,2),this.listener&&l.eventManager.removeListener(this.listener),this._listener2&&l.eventManager.removeListener(this._listener2),qu.clearOwner(this),this.ablres&&l.textureCache.removeTextureForKey(this.ablres),this.aqres&&l.textureCache.removeTextureForKey(this.aqres),this._super()},menuItemWithFile:function(e,t,i,n,s){s=s||1.1;var r=new l.Sprite(e),a=new l.Sprite(t);if("#popup_close.png"==e){var o=new l.Sprite("#popup_close_frame.png");o.setPosition(.5*r.width,.5*r.height),r.addChild(o,-1);var h=new l.Sprite("#popup_close_frame.png");h.setPosition(.5*a.width,.5*a.height),a.addChild(h,-1)}var d=new l.MenuItemSprite(r,a,null,this,this.menuCallback.bind(this));return a.setAnchorPoint(.5,.5),a.setPosition(.5*d.width,.5*d.height),a.setScale(s),d.setTag(i),d.setPosition(n),d},showPopupTip:function(e){if(null==this.mPopupTip){var t=wr.getModel().usersData.m_nLanguage,i=nr.share().getWinSize();this.mPopupTip=new l.Sprite("#popup_bg.png"),this.mPopupTip.setPosition(.5*i.width,.5*i.height);var n=new l.Sprite("#popup_btnbg_normal.png");n.setPosition(408,90);var s=new l.Sprite(String.formatC("#popup_btnbg%s.png",t));s.setPosition(.5*n.width,.5*n.height),n.addChild(s);var r=null;(r=0==e?new l.Sprite(String.formatC("#boss_locked%s.png",t)):new l.Sprite(String.formatC("#nest_locked%s.png",t))).setPosition(486,220),this.mPopupTip.addChild(r),this.mPopupTip.addChild(n),this.addChild(this.mPopupTip,10)}this.mPopupTip.setVisible(!0)},showNewsDlg:function(){var e=nr.share().getWinSize(),t=new l.LayerColor(l.color(0,0,0,178),e.width,e.height);t.setTag(eu),this.addChild(t,102);var i=new l.Sprite("#news_bg.png");i.setPosition(nr.share().getMapOffset().width+460,312),t.addChild(i);var n=wr.getModel(),s=n.usersData.m_nLanguage,r=(String.formatC("%s2cf2x%s.jpg",n.strDocRootPath,s),this.menuItemWithFile("#news_close.png","#news_close.png",uu,l.p(nr.share().getMapOffset().width+840,488),1.2)),a=new l.Menu(r);a.setPosition(0,0),t.addChild(a,10)},showMyStoneDlg:function(){wr.getModel().bLockMenu=!0;var e=nr.share().getWinSize(),t=new l.LayerColor(l.color(0,0,0,168),e.width,e.height);t.setTag(222222),this.addChild(t,800);var i=new l.Sprite("front_autumn_img.png");i.setPosition(nr.share().getMapOffset().width+489,311),t.addChild(i);var n=this.menuItemWithFile("front_autumn_close.png","front_autumn_close.png",444444,l.p(nr.share().getMapOffset().width+848,533),1.2),s=new l.Menu(n);s.setPosition(0,0),t.addChild(s,10)},init:function(){this._super(),l.director.getScheduler().isWaite=!1;var e=wr.getModel();e.mainLayer=this,e.m_nGameMode=ge.NORMALMODE;nr.share().getMapOffset();e.usersData.t0=e.usersData.getCurSystemTime();var t=e.usersData.m_nLanguage,i=String.formatC("res/Themes%s/scene/mainscene-hd%s.plist",t,t);qu.addRes(this,i),this.registerWithTouchDispatcher(!0);var n=this;if(this._listener2=l.EventListener.create({event:l.EventListener.CUSTOM,eventName:"msgShowFreeStone",callback:function(e){n.getMessage()}}),l.eventManager.addListener(this._listener2,1),GamePlatform.getCurrentPlatForm()===PlatformType.FaceBook){var s=qu.getLoadImage("res/Themes_en/scene/share_0_en.jpg"),r=document.createElement("canvas");r.width=s.width,r.height=s.height;var a=r.getContext("2d");s&&a.drawImage(s,0,0);var o=r.toDataURL("image/png"),h={context:e.usersData._firstLogin,immediately:!0};SDKInterface.logEvent&&SDKInterface.logEvent("firstScreen"),SDKInterface.shareMessage("",l.playerInfo.name+" played Carrot Defense! Come and play with me!",o,{index:1e3},h)}return e.usersData.getOpenedLevel()<=1&&GamePlatform.getCurrentPlatForm()===PlatformType.FaceBook&&e.usersData._firstLogin?(this.showAnimation(),!0):(this.showMainItems(),l.addTimePoint("GO_MAIN_E"),l.printTimePoint("GO_MAIN_S","GO_MAIN_E"),!0)},showAnimation:function(){var e=wr.getModel(),t=nr.share().getMapOffset();e.usersData.bOpenFirstTime=!0,qu.addRes(this,"res/Themes/scene/WeiboComic-hd.plist");var i=String.formatC("res/Themes%s/scene/WeiboComic-hd%s.plist",Wt,Wt);qu.addRes(this,i),this.m_nComic=1;var n=new l.Sprite("#comic_1.png");n.setPosition(t.width+318,460),n.setScale(.1),this.addChild(n,9,bu),e.playSoundWithType($.MTMAPSTEP1),n.runAction(l.sequence(l.scaleTo(.1,1.2),l.scaleTo(.1,1)));var s=new l.Sprite("#comic_2.png");s.setPosition(t.width+1157,488),this.addChild(s,9,Au),s.setVisible(!1);var r=l.callFunc(this.PlayComicMusic.bind(this));s.runAction(l.sequence(l.delayTime(2.2),l.show(),r,l.moveTo(.1,t.width+677,488),l.moveTo(.1,t.width+717,488)));var a=new l.Sprite("#comic_3.png");a.setScale(.2),a.setPosition(t.width+692,468),this.addChild(a,9,Ou),a.setVisible(!1),a.runAction(l.sequence(l.delayTime(2.4),l.show(),l.spawn(l.moveTo(.1,t.width+592,552),l.scaleTo(.1,1.2)),l.spawn(l.moveTo(.1,t.width+607,536),l.scaleTo(.1,1))));var o=new l.Sprite("#comic_4.png");o.setPosition(t.width+234,178),o.setScale(.8),o.setOpacity(0),this.addChild(o,9,Iu),o.setVisible(!1),o.runAction(l.sequence(l.delayTime(4.6),l.show(),r,l.spawn(l.scaleTo(.4,1),l.fadeTo(.4,255))));var h=new l.Sprite("#comic_5.png");h.setPosition(t.width+666,210),this.addChild(h,8,Ru),h.setVisible(!1),h.runAction(l.sequence(l.delayTime(6.8),l.show(),r));var d=new l.Sprite("#comic_cover.png");d.setPosition(t.width+605,248),d.setScale(.65),this.addChild(d,8,xu),d.setVisible(!1),d.runAction(l.sequence(l.delayTime(6.8),l.show(),l.spawn(l.scaleTo(.1,1),l.moveTo(.1,t.width+480,320)),l.delayTime(1.3),l.spawn(l.scaleTo(.1,.88),l.moveTo(.1,l.p(t.width+489,293))),l.spawn(l.scaleTo(.2,3.8),l.moveTo(.2,l.p(t.width+476,882))),r));var c=new l.Sprite("#comic_6.png");c.setPosition(t.width+1179,329),this.addChild(c,9,Du),c.setVisible(!1),c.runAction(l.sequence(l.delayTime(10.3),l.show(),r,l.moveTo(.1,t.width+439,329),l.moveTo(.1,t.width+479,329)));var u=new l.Sprite("#comic_start.png");u.setPosition(t.width+479,31),this.addChild(u,9,Nu),u.setVisible(!1);var p=l.callFunc(this.ComicStartFun.bind(this,u));u.runAction(l.sequence(l.delayTime(10.5),l.show(),p))},showNewAnimation:function(){var e=wr.getModel(),t=nr.share().getWinSize();e.usersData.bOpenFirstTime=!0,qu.addRes(this,"res/Themes_en/tencent/openAnimation.plist"),this._actionList=[],this._nodeList=[],this._nodeposList=[];var i=new l.Sprite("bg_blue.png");i.setAnchorPoint(.5,.5),i.setPosition(.5*t.width,.5*t.height),this.addChild(i,10004),this._animLayer=i,t=i.getContentSize(),this._actionState=bu;var n=new l.Sprite("screen1.png");n.setAnchorPoint(0,0),n.setPosition(t.width,.5*t.height),n.setVisible(!1),i.addChild(n,9,bu);var s=l.sequence(l.show(),l.moveTo(.1,.5*t.width,.5*t.height),l.moveTo(.1,.5*t.width+38,.5*t.height),l.callFunc(function(){this._actionState=Au},this));this._actionList[bu]=s,this._nodeList[bu]=n,this._nodeposList[bu]=l.p(.5*t.width+38,.5*t.height),n.runAction(s);var r=new l.Sprite("screen2.png");r.setAnchorPoint(1,0),r.setPosition(0,.5*t.height),i.addChild(r,9,Au),r.setVisible(!1),s=l.sequence(l.show(),l.moveTo(.1,.5*t.width,.5*t.height),l.moveTo(.1,.5*t.width-44,.5*t.height),l.callFunc(function(){this._actionState=Ou},this)),this._actionList[Au]=s,this._nodeList[Au]=r,this._nodeposList[Au]=l.p(.5*t.width-44,.5*t.height),r.runAction(l.sequence(l.delayTime(1),s));var a=new l.Sprite("screen3.png");a.setScale(.2),a.setAnchorPoint(.5,1),a.setPosition(.5*t.width,0),i.addChild(a,9,Ou),a.setVisible(!1),s=l.sequence(l.show(),l.spawn(l.moveTo(.1,.5*t.width,.5*t.height),l.scaleTo(.1,1.2)),l.scaleTo(.1,1),l.callFunc(function(){this._actionState=Iu},this)),this._actionList[Ou]=s,this._nodeList[Ou]=a,this._nodeposList[Ou]=l.p(.5*t.width,.5*t.height),a.runAction(l.sequence(l.delayTime(2),s));var o=new l.Sprite("screen4.png");o.setAnchorPoint(.5,0),o.setPosition(.5*t.width,.2*t.height),o.setScale(.8),o.setOpacity(0),i.addChild(o,9,Iu),o.setVisible(!1),s=l.sequence(l.show(),l.spawn(l.scaleTo(.4,1),l.fadeTo(.4,255)),l.callFunc(function(){this._actionState=Ru},this)),this._actionList[Iu]=s,this._nodeList[Iu]=o,this._nodeposList[Iu]=l.p(.5*t.width,.2*t.height),o.runAction(l.sequence(l.delayTime(3),s)),s=l.sequence(l.callFunc(function(){var e=l.spriteFrameCache.getSpriteFrame("screen5.png");e&&this._nodeList[Ou].setSpriteFrame(e),this._actionState=Du},this)),this._actionList[Ru]=s,this._nodeList[Ru]=o,this._nodeposList[Ru]=l.p(.5*t.width,.2*t.height),o.runAction(l.sequence(l.delayTime(4),s));var h=new l.Sprite("screen_start.png");h.setPosition(.82*t.width,91),i.addChild(h,9,Du),h.setVisible(!1);var d=l.callFunc(function(e){this._bAnimationOver=!0,e&&e.runAction(l.repeatForever(l.sequence(l.scaleTo(.3,1.3),l.scaleTo(.3,.9),l.scaleTo(.3,1.1),l.scaleTo(.3,1).easing(l.easeElasticOut(3)),l.delayTime(3))))},this,h);s=l.sequence(l.show(),d),this._actionList[Du]=s,this._nodeList[Du]=h,this._nodeposList[Du]=l.p(.82*t.width,91),h.runAction(l.sequence(l.delayTime(5),s)),this._spComicStart=h},cb_func:function(e){var t=e;if(t){var i=l.moveBy(.5,0,4),n=l.moveBy(.5,0,-4),s=l.sequence(i,n),r=l.repeatForever(s);t.runAction(r)}},showChalleageDlg:function(){this.getChildByTag(1129)&&this.removeChildByTag(1129);var e=this;qu.loadResAsync(wi,function(){var t=Qo.create();t.setPosition(0,0),e.addChild(t,500,1129)})},showMainAnim:function(){var e=nr.share().getMapOffset();this.ablres="res/Themes/scene/nfront_abo_lim.png";var t=new l.Sprite(this.ablres);t.setPosition(238+e.width,453),this.m_animLayer.addChild(t,99);var i=l.moveBy(2,-1,5),n=l.moveBy(2,1,-5);t.runAction(l.repeatForever(l.sequence(i,n))),this.aqres="res/Themes/scene/nfront_aqo_lim.png";var s=new l.Sprite(this.aqres);s.setPosition(774+e.width,170),this.m_animLayer.addChild(s,99);var r=l.moveBy(1.8,-4,-3),a=l.moveBy(1.8,4,3),o=l.rotateBy(1.8,-1),h=l.rotateBy(1.8,1);s.runAction(l.repeatForever(l.sequence(l.spawn(r,o),l.spawn(a,h))));var d=new l.Sprite("nfront_light.png");d.setPosition(237+e.width,339),this.m_animLayer.addChild(d,99);var c=new l.Sprite("nfront_aqo_shadow.png");c.setPosition(774+e.width,170),this.m_animLayer.addChild(c,98);var u=l.moveBy(1.8,-5,4),p=l.rotateBy(1.8,-3),m=l.scaleTo(1.8,1.1),_=l.moveBy(1.8,5,-4),g=l.rotateBy(1.8,3),T=l.scaleTo(1.8,1);c.runAction(l.repeatForever(l.sequence(l.spawn(u,p,m),l.spawn(_,g,T))));var f=new l.Sprite("nfront_lvding.png");f.setPosition(756+e.width,503),this.m_animLayer.addChild(f,99);var S=l.moveBy(2.5,5,-5),w=l.moveBy(2.5,-5,5);f.runAction(l.repeatForever(l.sequence(S,w)));var v=new l.Sprite("nfront_lvding_shadow.png");v.setPosition(756+e.width,503),this.m_animLayer.addChild(v,98),v.runAction(l.repeatForever(l.sequence(l.scaleTo(2.5,1.1),l.scaleTo(2.5,1))));var L=new l.Sprite("nfront_leaf_01.png");L.setPosition(173+e.width,194),this.m_animLayer.addChild(L,98),L.runAction(l.repeatForever(l.sequence(l.moveBy(3,-21,2),l.moveBy(3,21,-2))));var M=new l.Sprite("nfront_leaf_02.png");M.setPosition(920+e.width,316),this.m_animLayer.addChild(M,98),M.runAction(l.repeatForever(l.sequence(l.spawn(l.moveBy(3,23,-6),l.rotateBy(3,3)),l.spawn(l.moveBy(3,-23,6),l.rotateBy(3,-3)))));var C=new l.Sprite("nfront_leaf_03.png");C.setPosition(488+e.width,519),this.m_animLayer.addChild(C,98),C.runAction(l.repeatForever(l.sequence(l.moveBy(3,-4,5),l.moveBy(3,4,-5))));var y=new l.Sprite("nfront_leaf_04.png");y.setPosition(71+e.width,220),this.m_animLayer.addChild(y,98),y.runAction(l.repeatForever(l.sequence(l.spawn(l.moveBy(3,-32,5),l.rotateBy(3,-8)),l.spawn(l.moveBy(3,32,-5),l.rotateBy(3,8)))));var B=new l.Sprite("nfront_lotus_01.png");B.setPosition(760+e.width,347.5),this.m_animLayer.addChild(B,98),B.runAction(l.repeatForever(l.sequence(l.spawn(l.moveBy(3,13,-2),l.rotateBy(3,2),l.scaleTo(3,1.02)),l.spawn(l.moveBy(3,-13,2),l.rotateBy(3,-2),l.scaleTo(3,1)))));var F=new l.Sprite("nfront_lotus_02.png");F.setPosition(488+e.width,519),this.m_animLayer.addChild(F,98),F.runAction(l.repeatForever(l.sequence(l.moveBy(3.5,5,9),l.moveBy(3.5,-5,-9))));var E=new l.Sprite("nfront_lotus_03.png");E.setPosition(173+e.width,194),this.m_animLayer.addChild(E,98),E.runAction(l.repeatForever(l.sequence(l.spawn(l.moveBy(3,-7,6),l.rotateBy(3,4),l.scaleTo(3,1.02)),l.spawn(l.moveBy(3,7,-6),l.rotateBy(3,-4),l.scaleTo(3,1)))));var P=new l.Sprite("nfront_petal_01.png");P.setPosition(908+e.width,143),this.m_animLayer.addChild(P,99),P.runAction(l.repeatForever(l.sequence(l.spawn(l.moveBy(3,10,-5),l.rotateBy(3,-2)),l.spawn(l.moveBy(3,-10,5),l.rotateBy(3,2)))));var b=new l.Sprite("nfront_petal_02.png");b.setPosition(476+e.width,532),this.m_animLayer.addChild(b,99),b.runAction(l.repeatForever(l.sequence(l.moveBy(3,-4,5),l.moveBy(3,4,-5))));var A=new l.Sprite("nfront_petal_03.png");A.setPosition(139+e.width,60),this.m_animLayer.addChild(A,99),A.runAction(l.repeatForever(l.sequence(l.spawn(l.moveBy(3,-10,-12),l.rotateBy(3,-11)),l.spawn(l.moveBy(3,10,12),l.rotateBy(3,11)))));var O=new l.Sprite("nfront_ripple_01.png");O.setPosition(71+e.width,479),this.m_animLayer.addChild(O,98),O.setScale(.4),O.runAction(l.repeatForever(l.sequence(l.scaleTo(.8,1.47),l.spawn(l.scaleTo(.32,2),l.fadeOut(.32)),l.delayTime(3*l.random0To1()+2),l.scaleTo(0,.4),l.fadeTo(0,255))));var I=new l.Sprite("nfront_ripple_02.png");I.setPosition(707+e.width,590),this.m_animLayer.addChild(I,98),I.setScale(.6),I.runAction(l.repeatForever(l.sequence(l.scaleTo(1,1.65),l.spawn(l.scaleTo(.32,2.1),l.fadeOut(.32)),l.delayTime(3*l.random0To1()+2),l.scaleTo(0,.6),l.fadeTo(0,255))));var R=new l.Sprite("nfront_stone_butterfly_00.png");R.setPosition(676+e.width,109),this.addChild(R,101);for(var D=new l.Animation,x=1;x<=17;x++){var N=null,G=0;G=2==x||4==x||12==x?1:3==x||11==x?2:6==x||8==x||14==x||16==x?3:7==x||15==x?4:0,N=String.formatC("nfront_stone_butterfly_0%d.png",G);var W=l.spriteFrameCache.getSpriteFrame(N);D.addSpriteFrame(W)}D.setLoops(1),D.setDelayPerUnit(.08);var k=l.animate(D);R.runAction(l.repeatForever(l.sequence(k,l.delayTime(3*l.random0To1()+2))))},showMainItems:function(){var e=wr.getModel(),t=nr.share().getWinSize(),i=nr.share().getMapOffset(),n=e.usersData;n.GetYMData();var s=new l.Sprite("nfront_bg.png");s.setPosition(.5*t.width,.5*t.height),this.addChild(s),this.m_animLayer=new l.Sprite,this.m_animLayer.setPosition(0,0),this.addChild(this.m_animLayer,5);var r=new l.Sprite("nfront_prospect_01.png"),a=new l.Sprite("nfront_prospect_02.png"),o=new l.Sprite("nfront_prospect_03.png"),h=new l.Sprite("nfront_prospect_04.png");r.setPosition(128,449),a.setPosition(617,620),o.setPosition(909+2*i.width,427),h.setPosition(568,466),this.addChild(h,6),this.addChild(r,6),this.addChild(a,6),this.addChild(o,6);var d=new l.Sprite("nfront_stone.png");d.setPosition(l.pMult(l.p(479+i.width,249),this.mScale)),this.addChild(d,100);var c=new l.Sprite("nfront_leaf_left.png");c.setPosition(81,246),d.addChild(c,1);var u=new l.Sprite("nfront_leaf_right.png");u.setPosition(348,263),d.addChild(u,1);var p=GamePlatform.getCurrentPlatForm(),m=p===PlatformType.QQ;if(e.usersData.getOpenedLevel()>37&&(e.usersData.mIsUnlockedDayDayUp=!0),!e.usersData.mIsUnlockedDayDayUp&&!e.usersData.isCarrotBuy2(oe.UNLOCK_HIGHER)){var _=new l.Sprite("nfront_btn_floor_locked.png");_.setPosition(368,208),d.addChild(_,4),this._spLock=_}var g=this.menuItemWithFile("nfront_btn_adv_normal.png","nfront_btn_adv_pressed.png",nu,l.p(214,353)),T=null;GamePlatform.getIsShowAll()||!GamePlatform.isCN()?T=this.menuItemWithFile("nfront_btn_floor_normal.png","nfront_btn_floor_pressed.png",su,l.p(214,224)):(T=this.menuItemWithFile("wait_btn_floor_normal.png","wait_btn_floor_pressed.png",su,l.p(214,224))).setEnabled(!1);var f=new l.Menu(g,T);if(f.setPosition(0,0),d.addChild(f,2),n.IsShowGameAdvice()){var S=new l.Sprite("front_whb.png");S.setPosition(.5*t.width,.5*t.height),this.addChild(S,100)}var w=this.menuItemWithFile("newfront_btn_unfold.png","newfront_btn_unfold.png",Mu,l.pMult(l.p(900+2*i.width,60),this.mScale));this.mUnfoldSign=new l.Sprite("newfront_btn_unfold_sign.png"),this.mUnfoldSign.setPosition(55,72),w.addChild(this.mUnfoldSign),null==this.foldDotSpr&&!this._isRewards&&m&&(this.foldDotSpr=new l.Sprite("quickstart_prompt.png"),this.foldDotSpr.setPosition(.65*w.width,.8*w.height),this.foldDotSpr.visible=!1,w.addChild(this.foldDotSpr));var v=[w],L=m;window.isOnIOS||(L=p===PlatformType.WeiXinApp||m),L=GamePlatform.getCurrentPlatForm()===PlatformType.FaceBook||L,console.log("window.isOnIOS: "+window.isOnIOS+" curPlatForm:"+p+"UseSDK: "+lp+" isVisible:"+L);var M=this.menuItemWithFile("newfront_btn_unfold.png","newfront_btn_unfold.png",Cu,l.pMult(l.p(90,280),this.mScale));M.setVisible(L);var C=new l.Sprite("newfront_share.png");C.setAnchorPoint(.5,.5),C.setPosition(.5*M.width-5,.5*M.height+15),M.addChild(C),M&&M.isVisible()&&v.push(M),n.rewardShortcut!=Ad.Type_Receive&&L&&(this.dotSpr=new l.Sprite("quickstart_prompt.png"),this.dotSpr.setPosition(.65*M.width,.8*M.height),M.addChild(this.dotSpr)),n.rewardShortcut==Ad.Type_Mandatory&&L&&!window.isOnIOS&&(kl.dotSpr=this.dotSpr,kl.coercionShowShortCut(Ad.Type_Carriedout));var y=null,B=null;e.usersData.mIsUnlckedEverydayChanllenge&&(y=this.menuItemWithFile("newfront_btn_daily_normal.png","newfront_btn_daily_pressed.png",wu,l.pMult(l.p(80,60),this.mScale)),v.push(y)),l.spriteFrameCache.getSpriteFrame("newfront_btn_day.png")&&((B=this.menuItemWithFile("newfront_btn_day.png","newfront_btn_day_pressed.png",Fu,l.pMult(l.p(90,180),this.mScale)))&&v.push(B),B.setVisible(!1),this._LoginRecord=B);var F=this.menuItemWithFile("newfront_btn_unfold.png","newfront_btn_unfold.png",Bu,l.pMult(l.p(90,380),this.mScale));(C=new l.Sprite("newfront_email.png")).setAnchorPoint(.5,.5),C.setPosition(.5*F.width-5,.5*F.height+15),F.addChild(C),null==this._mailDotSpr&&(this._mailDotSpr=new l.Sprite("quickstart_prompt.png"),this._mailDotSpr.setPosition(.65*F.width,.8*F.height),F.addChild(this._mailDotSpr),this._mailDotSpr.visible=e.usersData.urm),F.isVisible()&&v.push(F);var E=new l.Menu(v);E.setPosition(0,0),this.addChild(E,10,$c),this._btnList=[],y&&y.isVisible()&&this._btnList.push(y),B&&this._btnList.push(B),M&&M.isVisible()&&this._btnList.push(M),F&&F.isVisible()&&this._btnList.push(F),this.replaceBtn(),this.initUnfold(),this.showMainAnim();var P=l.sys.localStorage.getItem("YS_SMSDFT1");if(P&&P.length<1&&(this.showMyStoneDlg(),l.sys.localStorage.setItem("YS_SMSDFT1","YS_DCS1")),(P=l.sys.localStorage.getItem("SMSDFTS"))&&P.length<1){var b=O.STARFULLCOUNT-e.usersData.getStarCount();b>0&&e.usersData.addPlayTimes(b),l.sys.localStorage.setItem("SMSDFTS","DCS")}void 0==e.isFirstBGM?this.scheduleOnce(function(){e.playMuiscWithType($.MTSTARTBGMSC,1,!0)},10):e.playMuiscWithType($.MTSTARTBGMSC,1,!0),GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&this.showFBReward(),e.usersData._firstLogin=!1},showFBReward:function(){var e=wr.getModel();e.rewardDim&&e.canbackreward&&(console.log("bot 打开奖励打点"),SDKInterface.logEvent&&SDKInterface.logEvent("OpenBotReward"),qu.loadResAsync(Hi,function(){var t=Gl.create(e.rewardDim,Ks.DT_NOTICENOCLOSE);t.clickCB=function(){Ql.comebackreward(function(i){void 0!=i&&(console.log("bot 领取奖励打点"),SDKInterface.logEvent&&SDKInterface.logEvent("getBotReward"),e.rewardDim=0,e.canbackreward=0,e.usersData.setDiamond(i.dm),t.removeFromParent())})},t.showInScene()}))},replaceBtn:function(){var e=60;for(var t in this._btnList){var i=this._btnList[t];i&&i.isVisible()&&(i.y=e,e+=120)}},initUnfold:function(){var e=nr.share().getMapOffset();this._foldBtnList=[];var t=this.menuItemWithFile("newfront_btn_setting_normal.png","newfront_btn_setting_pressed.png",au,l.p(55,239)),i=this.menuItemWithFile("newfront_btn_help_normal.png","newfront_btn_help_pressed.png",ru,l.p(55,157));if(this._foldBtnList.push(t,i),GamePlatform.getCurrentPlatForm()==PlatformType.QQ){var n=this.menuItemWithFile("newfront_btn_cs_normal.png","newfront_btn_cs_pressed.png",Tu,l.p(55,320));this._foldBtnList.push(n);var s=this.menuItemWithFile("newfront_btn_comm_normal.png","newfront_btn_comm_pressed.png",fu,l.p(55,403));this._foldBtnList.push(s);var r=this.menuItemWithFile("newfront_group_1.png","newfront_group_2.png",Eu,l.p(55,483));null!=this.groupDotSpr||this._isRewards||(this.groupDotSpr=new l.Sprite("quickstart_prompt.png"),this.groupDotSpr.setPosition(.65*r.width,.8*r.height),this.groupDotSpr.visible=!1,r.addChild(this.groupDotSpr)),this._foldBtnList.push(r)}var a=new l.Menu(this._foldBtnList);if(this.mUnfoldOpenBg=new l.Sprite("newfront_btn_open.png"),null!=a){a.setPosition(0,0);var o=GamePlatform.getCurrentPlatForm()==PlatformType.QQ?1:.55;3==this._foldBtnList.length&&(o=.7),this.replaceFoldBtn();var h=l.size(120,540);this.mUnfoldOpenBg.setAnchorPoint(.5,0),this.mUnfoldOpenBg.setScaleY(o);var d=new l.Node;d.setContentSize(h.width,h.height*o),d.setAnchorPoint(.5,0),d.setPosition(l.pMult(l.p(900+2*e.width,20),this.mScale)),d.addChild(this.mUnfoldOpenBg),d.addChild(a),this.addChild(d,9),h=d.getContentSize(),this.mUnfoldOpenBg.setPosition(.5*h.width,0),this.bgnode=d,this.bgnode.setScaleY(0)}},replaceFoldBtn:function(){for(var e=60,t=0;t<this._foldBtnList.length;t++){var i=this._foldBtnList[t];i.isVisible()&&(e+=80,i.y=e)}},showUnfold:function(e){if(e){n=l.rotateBy(.08,45);this.mUnfoldSign.runAction(n);var t=l.scaleTo(.25,1,1),i=l.moveBy(.25,0,0);this.bgnode.runAction(l.spawn(t,i))}else{var n=l.rotateBy(.08,-45);this.mUnfoldSign.runAction(n);var s=l.scaleTo(.25,1,0),r=l.moveBy(.25,0,-0);this.bgnode.runAction(l.spawn(s,r))}this.mUnfoldState=e},ComicStartFun:function(e){e.runAction(l.repeatForever(l.sequence(l.fadeTo(.3,128),l.fadeTo(.3,255)))),this.bSet=!0},PlayComicMusic:function(){this.m_nComic+=1;var e=wr.getModel();switch(this.m_nComic){case 2:e.playSoundWithType($.MTMAPSTEP2);break;case 3:e.playSoundWithType($.MTMAPSTEP3);break;case 4:e.playSoundWithType($.MTMAPSTEP6);break;case 5:e.playSoundWithType($.MTMAPSTEP4);break;case 6:e.playSoundWithType($.MTMAPSTEP5)}},Snow2Animate:function(e){var t=nr.share().getMapOffset();e.runAction(l.repeatForever(l.sequence(l.spawn(l.moveTo(1.3,t.width-127,329),l.scaleTo(1.3,2.2),l.fadeTo(1.3,255)),l.spawn(l.moveTo(8.7,l.p(t.width+802,342)),l.scaleTo(8.7,.2)),l.spawn(l.moveTo(0,l.p(t.width-303,323)),l.scaleTo(0,2.6),l.fadeTo(0,0)))))},onEnterTransitionDidFinish:function(){this._super(),qu.loadWithCCLoader(Ut,function(){qu.addRes(0,"res/Themes/Items/num_images.plist")},!0);var e=wr.getModel();return this.autoDownNews(),e.bBackMainScene||e.usersData.bOpenFirstTime||!e.m_oChallenge.canShow()?e.bBackMainScene||e.bBackMainScene&&!e.usersData.noAD()&&(e.bBackMainScene=!1,e.curMainAdShowTimes++):e.usersData.mIsUnlckedEverydayChanllenge&&(this.showChalleageDlg(),e.usersData.setOpenFirstTime(!0)),!e.m_bFeast||e.bBackMainScene||e.usersData.bOpenFirstTime||e.m_oFeast.showFeastLayer(this),this.showWindowsHint(),void this.sendCode()},sendCode:function(){var e=this,t=wr.getModel();Ql.gethomerecord(function(i){var n=!1,s=i.awardrecords;t.usersData.setawardrecord(s),t.usersData.setfirstrecord(i.firstrecords),i.isopendaydayup&&(t.mIsUnlockedDayDayUp=i.isopendaydayup),s&&(n=s[0]),e._isRewards=n,e.clbegintime=i.clbegintime,e.clendtime=i.clendtime,e.upTime(),e.foldDotSpr&&(e.foldDotSpr.visible=!e._isRewards),e.groupDotSpr&&(e.groupDotSpr.visible=!e._isRewards)}),Ql.getdailyawardrecord(function(e){var i=e.records;t.usersData.setdailyawardrecord(i)})},upTime:function(){var e=wr.getModel().getCurSystemTime();this._LoginRecord&&this._LoginRecord.setVisible(this.clendtime>e&&this.clbegintime<=e),this.replaceBtn(),(this.clbegintime>e||this.clendtime>e)&&(this._tempTime=this.clbegintime>e?this.clbegintime-e:this.clendtime-e,this.schedule(this.updateclTime,3))},updateclTime:function(e){if(this._tempTime-=3,this._tempTime<=0){if(this.unschedule(this.updateclTime),void 0==this._LoginRecord)return;if(this._LoginRecord.setVisible(!this._LoginRecord.isVisible()),this.replaceBtn(),this._LoginRecord.isVisible()){var t=wr.getModel().getCurSystemTime();this._tempTime=this.clendtime-t,this.schedule(this.updateclTime,3)}else this._record&&(this._record.removeFromParent(),this._record=null,ju.alert(b.Dialog_Hint6))}},showWindowsHint:function(){var e=wr.getModel().getBantimeContent();if(e){var t=this,i=e.shift();i&&ju.alert(decodeURIComponent(i.content),function(){t.showWindowsHint()})}},autoDownNews:function(){wr.getModel()},autoPopupNews:function(e){var t=wr.getModel(),i=t.usersData.m_nLanguage;String.formatC("%s2cf2x%s.jpg",t.strDocRootPath,i)},changeAction:function(){var e=this._actionState,t=this._nodeList[e];if(t&&e<=Du){if(t.stopAllActions(),t.setPosition(this._nodeposList[e]),t.setVisible(!0),t.setScale(1),t.setOpacity(255),this._actionState=e+1,e==Ru){var i=l.spriteFrameCache.getSpriteFrame("screen5.png");i&&this._nodeList[Ou].setSpriteFrame(i)}e==Du&&t.runAction(l.repeatForever(l.sequence(l.scaleTo(.3,1.3),l.scaleTo(.3,.9),l.scaleTo(.3,1.1),l.scaleTo(.3,1).easing(l.easeElasticOut(3)),l.delayTime(3))));for(var n=0,s=e+1;s<this._nodeList.length;s++)(t=this._nodeList[s])&&(t.stopAllActions(),t.runAction(l.sequence(l.delayTime(n),this._actionList[s])),n++)}},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){var i=wr.getModel();return this.getChildByTag(999999)?(this.removeChildByTag(999999,!0),!0):1!=i.bLockMenu&&(!!i.usersData.bOpenFirstTime||(this.mMoveLength=0,!1))},ccTouchMoved:function(e,t){if(!wr.getModel().usersData.bOpenFirstTime){var i=this.convertTouchToNodeSpace(e),n=e.getPreviousLocationInView();n=l.director.convertToGL(n),n=this.convertToNodeSpace(n);var s=l.pSub(i,n);this.mMoveLength+=-s.x}},showWeiboLogin:function(){var e=Al.create();this.addChild(e,1111)},showKefu:function(){wr.getModel().bLockMenu=!0;var e=Ol.create();this.addChild(e,1112)},weiboCallBack:function(){wr.getModel().usersData.bhadLogin||Tt.onReward("weibo-mainlogin",1)},ccTouchEnded:function(e,t){var i=wr.getModel();if(i.usersData.bOpenFirstTime){if(!this.bSet)return;return i.usersData.setOpenFirstTime(!1),this.removeChildByTag(bu,!0),this.removeChildByTag(Au,!0),this.removeChildByTag(Ou,!0),this.removeChildByTag(Iu,!0),this.removeChildByTag(Ru,!0),this.removeChildByTag(Du,!0),this.removeChildByTag(xu,!0),this.removeChildByTag(Nu,!0),i.playMuiscWithType($.MTSPANIMATEMSC,2),void this.showMainItems()}},menuCallback:function(e){if(this.getChildByTag(999999))this.removeChildByTag(999999,!0);else{var t=wr.getModel(),i=e.getTag();if(this.getChildByTag(222222))switch(i){case 444444:(h=this.getChildByTag(222222))&&this.removeChildByTag(222222,!0),t.bLockMenu=!1}else if(!this.getChildByTag(1129)&&!this.getChildByTag(1130)&&!t.bLockMenu){t.isFirstBGM=!0,t.playSoundWithType($.MTPAGESELECT);var n=this,s=e,r=t.usersData.m_nLanguage;switch(i){case nu:l.addTimePoint("level start"),t.bBackMainScene=!1,t.m_nGameMode=ge.NORMALMODE;var a=t.usersData.getOpenedLevel();if(t.setCurLevel(a),!t.usersData.bShowLogin){t.usersData.bShowLogin=!0}lp&&SDKInterface.logEvent&&SDKInterface.logEvent("startAdventure"),t.usersData.openPropsByOpenLv(),qu.loadWithCCLoader(kt,function(){qi.preloadWithLoadingTag(Yd.getUsedRes(),we.LEVELSEL)},!1,!0);break;case su:if(t.bLockMenu)return;t.bBackMainScene=!1,t.usersData.mIsUnlockedDayDayUp||t.usersData.isCarrotBuy2(oe.UNLOCK_HIGHER)?(this.registerWithTouchDispatcher(!1),qi.preloadWithStoreyScene(we.STOREY,!1)):qu.loadWithCCLoader(kt,function(){qu.loadResAsync(Wi,function(){var e=aa.create();n.addChild(e,4e3,998),e.setParent(n,xr),e.setShowDescription(Zr,de.PROP_99)})});break;case au:if(t.bLockMenu)return;l.addTimePoint("setting_s");c=GamePlatform.isCN()?Jt:$t;qi.preloadWithLoadingTag(c,we.SETTING);break;case ru:if(t.bLockMenu)return;l.addTimePoint("help_s"),t.bBackMainScene=!0;var o=s.getParent();o&&o.setEnabled(!1),this.registerWithTouchDispatcher(!1),qi.preloadWithLoadingTag(ti,we.HELP);break;case cu:break;case uu:(h=this.getChildByTag(eu))&&this.removeChildByTag(eu,!0),t.bLockMenu=!1;break;case 444444:var h=this.getChildByTag(222222);h&&this.removeChildByTag(222222,!0),t.bLockMenu=!1;break;case du:if(t.bLockMenu)return;this.showNewsDlg(),t.bLockMenu=!0;break;case ou:case hu:this.mPopupUnLock&&this.mPopupUnLock.setVisible(!1);break;case _u:break;case gu:var d=this.m_animLayer.getChildByTag($c);d&&d.setEnabled(!0),s.setVisible(!1);break;case Tu:if(t.bLockMenu)return;lp&&SDKInterface.openKefu();break;case fu:if(t.bLockMenu)return;GamePlatform.getCurrentPlatForm()==PlatformType.QQ&&SDKInterface.openQQBuluo();break;case Su:break;case lu:var c=[Ki("res/Themes/LevelSelect/LevelSel02-hd.plist"),Ki("res/Themes/LevelSelect/LevelSel02-hd.png")],u=String.formatC("res/Themes%s/LevelSelect/LevelSel02-hd%s.plist",r,r);c.push(Ki(u)),c.push(Ki(u.replace(".plist",".png"))),qu.loadResAsync(c,function(){var e=Lo.create();n.addChild(e,9999)});break;case vu:break;case wu:this.showChalleageDlg();break;case Mu:this.showUnfold(!this.mUnfoldState);break;case Cu:if(GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook){var p=qu.getLoadImage("res/Themes_en/scene/share_0_en.jpg"),m=document.createElement("canvas");m.width=p.width,m.height=p.height,m.getContext("2d").drawImage(p,0,0);var _=m.toDataURL("image/png"),g={context:!0,immediately:!0};SDKInterface.shareMessage("",l.playerInfo.name+" played Carrot Defense! Come and play with me!",_,{index:1001},g)}else kl.showShortCutLayer(this.dotSpr);break;case Bu:qu.loadWithCCLoader(kt,function(){qu.loadResAsync(ki,function(){var e=Yl.create();e.callback=function(e){n.readMailOver(e),t.usersData.urm=e},e.showInScene()})},!1,!0);break;case Fu:n=this;qu.loadResAsync(Vi,function(){n._record=$u.create(),n._record.showInScene()});break;case Eu:GamePlatform.getCurrentPlatForm()==PlatformType.QQ&&(SDKInterface.openQQGroup(),kl.sendAwarddmCode(Ce.Qun_Share,function(){n._isRewards||(n._isRewards=!0),n.foldDotSpr&&n.foldDotSpr.isVisible()&&n.foldDotSpr.setVisible(!1),n.groupDotSpr&&n.groupDotSpr.isVisible()&&n.groupDotSpr.setVisible(!1)}));break;case Pu:Ms.getInstance().open(Vu,mi,Dt.waitingForYounDlgSwitch)}}}},readMailOver:function(e){this._mailDotSpr&&(this._mailDotSpr.visible=e)},keyBackClicked:function(){var e=wr.getModel();this.getChildByTag(eu)?(this.removeChildByTag(eu,!0),e.bLockMenu=!0):this.exitGame()},exitGame:function(){wr.getModel();l.director.end()},carrotAction:function(){var e=this.carrot.getChildByTag(2);e.runAction(l.repeatForever(l.sequence(l.delayTime(1),l.rotateTo(.1,15),l.rotateTo(.1,0),l.rotateTo(.1,15),l.rotateTo(.1,0),l.delayTime(5.5)))),(e=this.carrot.getChildByTag(3)).runAction(l.repeatForever(l.sequence(l.delayTime(3),l.rotateTo(.1,15),l.rotateTo(.1,0),l.rotateTo(.1,15),l.rotateTo(.1,0),l.delayTime(3.5))))},showFreeStone:function(){var e=this;qu.loadResAsync(Ti,function(){var t=Wa.create();t.setPosition(0,0),t.spTopFrame=null,e.addChild(t,2e3,2e3),t.setShowAdWall()});var t=wr.getModel();t&&(t.bLockMenu=!0)},getMessage:function(e){this.showFreeStone()},showKTwithRed:function(e){this.redButton&&this.redButton.setVisible(e)},showVideoAD:function(e){if(null!=this.m_animLayer){var t=null,i=wr.getModel(),n=this.m_animLayer.getChildByTag($c);switch(n&&(t=n.getChildByTag(vu)),e){case ve.SHOWVAD:if(i.usersData.canPlayAD(ve.MAIN_VIDEO)&&t){t.setVisible(!0);var s=i.usersData.YSPlayTimes,r=i.usersData.getMainPagePlayTimes();if(s>0&&s<r){var a=String.formatC("front_video_%d.png",r-s),o=new l.Sprite(a);o.setPosition(.5*t.width,.5*t.height),t.addChild(o,1,1887)}}break;case ve.VADSTARTPLAY:i.usersData.addPlayADOneTime(ve.MAIN_VIDEO),t&&(t.setVisible(!1),t.removeChildByTag(1887));break;case ve.VADPLAYED:i.playMuiscWithType(ve.MTSTARTBGMSC,4)}}},showVedioTimes:function(){if(null!=this.m_animLayer){var e=null,t=this.m_animLayer.getChildByTag($c);t&&(e=t.getChildByTag(vu)).removeChildByTag(1887);var i=wr.getModel(),n=i.usersData.YSPlayTimes,s=i.usersData.getMainPagePlayTimes();if(n>0&&n<s&&null!=e){var r=String.formatC("front_video_%d.png",s-n),a=new l.Sprite(r);a.setPosition(.5*e.width,.5*e.height),e.addChild(a,1,1887)}}}});Hu.create=function(){return Qs(Hu)},Hu.scene=function(){var e=new l.Scene,t=new Hu;return nr.share().scaleScene(t),e.addChild(t,0,111),e};var Vu=l.Layer.extend({spbg:null,listener:null,ctor:function(){this._super(),this._headArray=[],this.registerWithTouchDispatcher(),qu.addRes(this,String.formatC("res/Themes%s/tencent/activity_common.plist",GamePlatform.getLanguage())),qu.addRes(this,String.formatC("res/Themes%s/tencent/dengdaoni.plist",GamePlatform.getLanguage()));var e=nr.share().getMapOffset(),t=1==nr.share().isIPad()?1:.5,i=l.spriteFrameCache.getSpriteFrame("zyddn_1.png");this.spbg=new l.Sprite(i),this.spbg.setPosition(478*t+e.width,312*t),this.addChild(this.spbg,10);var n=new l.Sprite("zyddn_3.png");n.setAnchorPoint(0,0),n.setPosition(-7*t,32*t),this.spbg.addChild(n);var s=new l.Sprite("zyddn_2.png");s.setAnchorPoint(.5,0),s.setPosition(.5*this.spbg.getContentSize().width,this.spbg.getContentSize().height-90*t),this.spbg.addChild(s);var r=new ys("btn_blue_s.png");r.addCovergeImage("zyddn_4.png"),r.bindCallBack(this.eventClose.bind(this)),r.setPosition(643*t,95*t),this.spbg.addChild(r);wr.getModel();for(var a=120*t,o=330*t,h=0;h<8;h++){var d=new l.Sprite("rankingup_portrait.png");d.setAnchorPoint(0,0),d.setPosition(a,o),a+=160*t,3==h&&(a=120*t,o-=110*t),this.spbg.addChild(d),this._headArray.push(d)}this.joinText=new l.LabelTTF("有66个好友已经在保卫萝卜了哦～","Helvetica",18,l.size(150,50)),this.joinText.setAnchorPoint(.5,1),this.joinText.setColor(l.color(255,255,255)),this.joinText.setPosition(l.p(.3*n.getContentSize().width+15,n.getContentSize().height-10)),n.addChild(this.joinText,20),l.sys.isMobile&&this.loadFriend()},loadFriend:function(){SDKInterface.getFriendList(0,function(e){var t=e.length;if(t>0){this.joinText.setString(String.formatC(b.waiting_For_You,t*(parseInt(10*Math.random())+5)));for(var i=0,n=this._headArray.length;i<n;i++){var s=this._headArray[i],r=e[i];r&&this.createFriendHead(s,r)}}}.bind(this))},eventClose:function(){wr.getModel().playSoundWithType($.MTPAGESELECT),Ms.getInstance().close(this)},createFriendHead:function(e,t){var i=t.picture,n=null;if(i)n=Rt.createPhotoSprite(),Rt.loadUserPhoto(i,n);else{var s=l.spriteFrameCache.getSpriteFrame("UserHead.png");n=new l.Sprite(s)}var r=e.getContentSize();n&&(n.setPosition(r.width/2,r.height/2),e.addChild(n,10));var a=new l.LabelTTF(t.nickName,"Helvetica",18);a.setAnchorPoint(.5,1),a.setColor(l.color(255,255,255)),a.setPosition(l.p(r.width/2,0)),e.addChild(a,20)},onExit:function(){this.getParent().bLockPopUp=!1,this.removeAllChildren(),qu.clearOwner(this),this.listener&&l.eventManager.removeListener(this.listener),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},_headArray:null}),zu={};zu.Alert=0,zu.Retry=2,zu.YesNo=3,zu.RetryCancel=5,zu.Custom=6;var Yu=10004;zu.OKCancel=4;var Xu=[],ju=Zs.extend({type:zu.Alert,callback:null,buttons:null,retryCountDown:0,label:null,text:"",waitFlag:!1,closed:!1,ctor:function(e,t,i,n){void 0!==t&&(this.type=t),e=e||"",this.text=e,this.buttons=n,this.callback=i,this._super(Ks.DT_NOTICENOCLOSE);for(var s in Xu)Xu[s].visible=!1;Xu.push(this)},addChildItems:function(){console.log("Dialog begin addChildItems ");var e=.5,t=1,i="btn_blue_m_ok.png";switch(this.type){case zu.Alert:break;case zu.Retry:i="btn_blue_m_retry.png";break;case zu.OKCancel:case zu.YesNo:t=2;break;case zu.RetryCancel:i="btn_blue_m_retry.png",t=2;break;case zu.Custom:}if(!l.spriteFrameCache.getSpriteFrame("woodbg_notice.png"))return this.spMainFrame.setVisible(!1),void this.addLayerColor(t);nr.share().isIPad()&&(e=1);var n=null,s=162*e;if(2===t){var r=this.menuItemWithFile("#btn_blue_m.png","#btn_blue_m_pressed.png",sa,l.p(267*e,s),e,i),a=this.menuItemWithFile("#btn_green_m.png","#btn_green_m_pressed.png",ra,l.p(540*e,s),e,"btn_green_m_cancel.png");n=new l.Menu(r,a)}else{r=this.menuItemWithFile("#btn_blue_m.png","#btn_blue_m_pressed.png",sa,l.p(390*e,s),e,i);n=new l.Menu(r)}if(n.setPosition(0,0),this.text.length){var o=new l.LabelTTF(this.text,"Arial",32*e,l.size(650,200),l.TEXT_ALIGNMENT_CENTER,l.TEXT_ALIGNMENT_CENTER);o.setAnchorPoint(.5,.5),o.setPosition(400*e,s+160*e),this.spMainFrame.addChild(o,1),o.enableShadow(l.color(0,0,0,255),l.p(1,-1),1),this.label=o}var h=new l.Sprite("sepline.png");h.setPosition(.5*this.spMainFrame.width*e,s+70*e),h.setScaleX(.95),this.spMainFrame.addChild(h),this.spMainFrame.addChild(n,99),console.log("Dialog end addChildItems ")},addLayerColor:function(e){var t=nr.share().getWinSize(),i=new l.LayerColor(l.color(178,223,238),560,330);i.ignoreAnchorPointForPosition(!1),i.setAnchorPoint(.5,.5),i.setPosition(.5*t.width,.5*t.height),this.addChild(i,999);var n=new l.LayerColor(l.color(79,148,205),540,310);if(n.ignoreAnchorPointForPosition(!1),n.setAnchorPoint(.5,.5),n.setPosition(.5*t.width,.5*t.height),this.addChild(n,1e3),this.text.length){var s=new l.LabelTTF(this.text,"Arial",32,l.size(460,260),l.TEXT_ALIGNMENT_CENTER,l.TEXT_ALIGNMENT_CENTER);s.setAnchorPoint(.5,.5),s.setPosition(.5*n.width,.5*n.height+60),this.label=s,s.enableShadow(l.color(0,0,0,255),l.p(1,-1),1),n.addChild(s,1)}var r=new l.DrawNode;n.addChild(r,10);var a=n.getContentSize();r.drawSegment(l.p(10,120),l.p(a.width-10,120),1,l.color.BLACK);var o=[],h=l.color(54,100,139),d=function(e,t,i){var s=new l.LabelTTF(e,"Arial",36);s.enableShadow(l.color(0,0,0,255),l.p(1,-1),1);var r=new l.LayerColor(h,120,70);r.ignoreAnchorPointForPosition(!1),r.setAnchorPoint(.5,.5),r.setPosition(i),n.addChild(r);var a=new l.MenuItemLabel(s,this.menuCallback,this);a.setTag(t),a.setAnchorPoint(.5,.5),a.setPosition(i),o.push(a)};if(this.buttons)for(var c=this.buttons.length,u=n.width/(c+1),p=0;p<c;p++)d.call(this,this.buttons[p],p,l.p((p+1)*u,60));else 1==e?d.call(this,"重 试",sa,l.p(.5*n.width,60)):(d.call(this,"确 定",sa,l.p(135,60)),d.call(this,"取 消",ra,l.p(n.width-135,60)));var m=new l.Menu(o);m.setPosition(0,0),n.addChild(m)},menuCallback:function(e){if(!(parseInt(this.retryCountDown)>0)){var t=e.tag;this.close(),this.callback&&this.callback(t)}},menuItemWithFile:function(e,t,i,n,s,r){var a=new l.Sprite(e),o=new l.Sprite(t);if(r){var h=new l.Sprite(r);h.setPosition(0,0),h.setAnchorPoint(0,0),a.addChild(h),(h=new l.Sprite(r)).setPosition(0,0),h.setAnchorPoint(0,0),o.addChild(h)}var d=new l.MenuItemSprite(a,o,null,this,this.menuCallback.bind(this));return d.setTag(i),d.setPosition(n),d},close:function(){this.closed=!0,this.waitFlag&&(l.director.getScheduler().isWaite=!1),this.removeFromParent()},onEnter:function(){this._super(),this.registerWithTouchDispatcher(!0),l.director.getScheduler().isWaite||(l.director.getScheduler().isWaite=!0,this.waitFlag=!0),l.eventManager.setEnabled(!0)},onExit:function(){if(this.registerWithTouchDispatcher(!1),this.closed){for(var e in Xu)if(Xu[e]==this){Xu.splice(e,1);break}Xu.length&&(Xu[0].visible=!0)}this._super()},registerWithTouchDispatcher:function(e){if(this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e){var t=this;this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!!t.visible}.bind(this)}),l.eventManager.addListener(this.listener,this)}},_setCountDown:function(e){this.retryCountDown=e,e>0&&this.scheduleUpdate(),this.update(0)},update:function(e){this.retryCountDown-=e;t=this.text;if(parseInt(this.retryCountDown)>0)var t=String.format("{0}\n请{1}秒后点再试",this.text,parseInt(this.retryCountDown));else this.unscheduleUpdate();this.label.setString(t)},initUI:function(){switch(this.type){case zu.Alert:case zu.Retry:break;case zu.OKCancel:case zu.YesNo:2}}});ju._currentScene=null,ju.changeScene=function(e){for(var t in Xu){var i=Xu[t];i.removeFromParent(),e.addChild(i,Yu)}this._currentScene=e},ju._getCurrentScene=function(){return this._currentScene?this._currentScene:l.director.getRunningScene()},ju.removeAllDialog=function(){var e=[].concat(Xu);for(var t in e)e[t].close();Xu.length=0},ju.alert=function(e,t){console.log("call Dialog.alert");var i=this._getCurrentScene();if(!i)return console.log("对话框无可用场景"),null;var n=new ju(e,zu.Alert,t);return i.addChild(n,Yu),n},ju.Retry=function(e,t,i){console.log("call Dialog.Retry");var n=this._getCurrentScene();if(!n)return console.log("对话框无可用场景"),null;var s=new ju(e,zu.Retry,t);return i&&s._setCountDown(i),n.addChild(s,Yu),s},ju.showConfirm=function(e,t,i){var n=this._getCurrentScene();if(console.log("call Dialog.showConfirm"),!n)return console.log("对话框无可用场景"),null;void 0==i&&(i=zu.YesNo);var s=new ju(e,i,t);return n.addChild(s,Yu),s},ju.showCustom=function(e,t,i){var n=this._getCurrentScene();if(console.log("call Dialog.showCustom"),!n)return console.log("对话框无可用场景"),null;var s=new ju(e,zu.Custom,i,t);return n.addChild(s,Yu),s},ju.showLiteralsTip=function(e){void 0==e&&(e="");var t=this._getCurrentScene(),i=t.getChildByTag(65214);i&&(i.stopAllActions(),i.runAction(l.sequence(l.spawn(l.moveBy(.2,0,60),l.fadeTo(.2,0)),l.removeSelf())));var n=new l.LabelTTF(e,"Arial",36);n.enableShadow(l.color(0,0,0,255),l.p(2,-2),2);var s=36*e.length,r=0,a=function(e){var t=l.spriteFrameCache.getSpriteFrame("unlimited_bg_tips1.png");if(!t)return null;var i=e||0,n=new l.Sprite(t);n.setAnchorPoint(0,0),n.setPosition(0,0);var s=n.getContentSize(),r=new l.Sprite("unlimited_bg_tips3.png");r.setAnchorPoint(0,0),r.setPosition(n.width-2,0);var a=i/r.width;r.setScaleX(a),s.width+=r.width*a;var o=new l.Sprite("unlimited_bg_tips2.png");o.setAnchorPoint(0,0),o.setPosition(s.width-4,0),s.width+=o.width;var h=new l.Node;return h.setContentSize(s),h.addChild(n),h.addChild(r),h.addChild(o),h}(n.width);a?(s=a.width,r=.5*a.height):((a=new l.DrawNode).clear(),a.drawSegment(l.p(0,0),l.p(s,0),45,l.color(200,200,255,255)),a.drawSegment(l.p(0,0),l.p(s,0),40,l.color(0,0,0,150)));var o=nr.share().getWinSize();t.addChild(a,Yu,65214),a.setAnchorPoint(0,0),a.x=.5*o.width-.5*s,a.y=.5*o.height,n.setAnchorPoint(.5,.5),n.setPosition(.5*s,r),a.addChild(n),a.runAction(l.sequence(l.delayTime(1),l.spawn(l.moveBy(.2,0,60),l.fadeTo(.2,0)),l.removeSelf()))};var Ku=Zs.extend({data:null,ctor:function(e){this.data=this.parse(e),this._super(Ks.DT_BULLETIN),0===Ku.instances.length&&(Ku.waite=l.director.getScheduler().isWaite);for(var t in Ku.instances)Ku.instances[t].visible=!1;Ku.instances.push(this)},parse:function(e){var t={},i=l.saxParser.parse(decodeURIComponent(e)).documentElement;return"html"===i.tagName?(t.text=e,t):("a"===i.tagName&&(t.url=i.getAttribute("href"),i=i.firstChild),"img"===i.tagName?t.image=i.getAttribute("src"):t.text=i.nodeValue,t)},addChildItems:function(){var e=.5;nr.share().isIPad()&&(e=1),this.addOkay(e),this.data.image&&this.addImage(e,this.data.image),this.data.text&&this.addText(e,this.data.text)},addOkay:function(e){var t=new l.Sprite("#btn_blue_m.png"),i=new l.Sprite("btn_blue_m_ok.png"),n=t.getContentSize();i.setPosition(n.width/2,n.height/2),t.addChild(i);var s=new l.Sprite("#btn_blue_m_pressed.png"),r=new l.Sprite("btn_blue_m_ok.png"),a=s.getContentSize();r.setPosition(a.width/2,a.height/2),s.addChild(r);var o=new l.MenuItemSprite(t,s,null,this,this.onOkay.bind(this));o.setPosition(400*e,162*e);var h=new l.Menu(o);h.setPosition(0,0),this.spMainFrame.addChild(h,99)},addImage:function(e,t){var i=function(t){var i=t.getContentSize();t.setScaleX(650/i.width),t.setScaleY(180/i.height),t.setPosition(400*e,162*e+150*e)},n=new l.Sprite(t);n.textureLoaded()?i(n):n.addEventListener("load",i,this),this.spMainFrame.addChild(n,1)},addText:function(e,t){var i=new l.LabelTTF(t,"Arial",32*e,l.size(650,200),l.TEXT_ALIGNMENT_CENTER,l.TEXT_ALIGNMENT_CENTER);i.setPosition(400*e,162*e+160*e),i.enableShadow(l.color(0,0,0,255),l.p(1,-1),1),this.spMainFrame.addChild(i,1)},onEnter:function(){this._super(),this.registerWithTouchDispatcher(!0)},onExit:function(){this.registerWithTouchDispatcher(!1),this._super()},onTouchEnded:function(e,t){var i=this.spMainFrame.convertTouchToNodeSpace(e),n=this.spMainFrame.getContentSize(),s=l.rect(55,90,n.width-110,n.height-180);l.rectContainsPoint(s,i)&&this.data.url&&l.sys.openURL(this.data.url)},onOkay:function(e){this.close()},registerWithTouchDispatcher:function(e){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e,t){return this.visible}.bind(this),onTouchEnded:function(e,t){this.onTouchEnded(e,t)}.bind(this)}),l.eventManager.addListener(this.listener,this))},close:function(){for(var e in Ku.instances)if(Ku.instances[e]===this){Ku.instances.splice(e,1);break}Ku.instances.length>0&&(Ku.instances[0].visible=!0),0===Ku.instances.length&&(l.director.getScheduler().isWaite=Ku.waite),this.removeFromParent()}});Ku.zorder=10010,Ku.scene=null,Ku.instances=[],Ku.waite=!1,Ku.changeScene=function(e){for(var t in this.instances){var i=this.instances[t];i.removeFromParent(),e.addChild(i,this.zorder)}this.scene=e},Ku.show=function(e){var t=new Ku(e);return this.scene.addChild(t,this.zorder),t};var qu={allRes:{},owners:{},panelRes:[],imageRes:{},_ownerToKey:function(e){return void 0!==e.__instanceId?e.__instanceId:e},clearScene:function(){l.game.config.debugMode&&l.textureCache.dumpCachedTextureInfo();for(var e in this.panelRes){var t=this.panelRes[e];this.release(t)}this.panelRes=[],l.audioEngine.stopAllEffects(),l.loader.releaseAllAudio()},loadWithCCLoader:function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var s=this;n&&Qu.show(),l.loader.load(e,function(r,a){if(n&&Qu.hide(),l.log("loadWithCCLoader callback error length = "+(r?r.length:0)),r&&r.length){for(var o in r){l.path.basename(e[o]);break}!i&&ju.Retry(b.NetWork_Hint11,function(){l.log("loadWithCCLoader Retry "),s.loadWithCCLoader(e,t,i,n)})?l.log("loadWithCCLoader Dialog.Retry "):setTimeout(function(){s.loadWithCCLoader(e,t,i,n)},150)}else t&&t()})},readTowersResWithTMX:function(e){for(var t,i=[],n={},s=wr.getModel(),r=e.getObjectGroup(O.kMPath),a=e.getProperty(O.kMPObj).split(","),o=null,h=a.length,l=0;l<h;l++)for(S=1;t=a[l]+"Ob"+S,null!=(o=r.getObject(t));S++){if(L=o.RT){"-3"===L&&(L="01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,");for(var d=L.split(","),c=0,u=0;u<d.length-1;u++)n[c=parseInt(d[u])+J.TBOTTLE-1]=1}var p=o.type?parseInt(o.type):0;if(p&&-2!=p){if(c=J.TBOTTLE,p>0)n[c+=p-1]=1;else if(p<0){var m=0,_=s.curTheme;m=_<4?6+4*(_-1):14;for(var g=0;g<m;g++)n[c=J.TBOTTLE+g]=1}}else-2==p&&(i.push(Ki("res/Themes/Items/Items08-hd.plist")),i.push(Ki("res/Themes/Items/Items08-hd.png")))}for(var T=!1,f=J.MONSTEREND+1;f<J.TOWEREND;f++)for(var S=1;t=String.formatC("%dT%d",f-J.TBOTTLE+1,S),null!=(o=r.getObject(t));S++)o.new&&(T=!0),n[f]=1;var w,v=1;for(v=1;w=r.getObject("Obj"+v);){v++;var L=w.RT;if(L){"-3"===L&&(L="01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,");var d=L.split(","),c=0;for(var u in d){if(c=parseInt(d[u])+J.TBOTTLE-1,isNaN(c))break;n[c]=1}}}for(var M in n){var C=Zt[M];C&&(i=i.concat(C))}return T&&(i=i.concat(Ci)),i},clearAll:function(){this.clearScene(),this.owners={},this.allRes={}},perloadWithKey:function(e){var t=Gt[e];t&&(this.perloadResAsync(t),delete Gt[e])},loadImages:function(e,t){if(0!=e.length){var i=e.shift();if(!this.getLoadImage(i)){var n=new Image;GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook&&n.setAttribute("crossOrigin","Anonymous");var s=this;n.onload=function(){s.imageRes[i]=n,s.loadImages(e,t)},n.onerror=function(){s.imageRes[i]=null,s.loadImages(e,t)},n.src=i}}else t&&t()},getLoadImage:function(e){return this.imageRes[e]},perloadResAsync:function(e){var t=function(){},i=function(e){var t=l.loader.getBasePath?l.loader.getBasePath():l.loader.resPath;return 0===e.indexOf("http")?e:l.path.join(t||"",e)};for(var n in e){var s=e[n];switch(l.path.extname(s)){case".plist":case".tmx":l.loader.loadTxt(i(s),t);break;case".png":case".jpg":case".pvr.ccz":l.loader.loadImg(i(s),t)}}},loadResAsync:function(e,t,i,n){var s=this,r=function(n,r){if(console.log("loadResAsync callback error length = "+(n?n.length:0)),Qu.hide(),n&&n.length){for(var a in n){l.path.basename(e[a]);break}ju.Retry(b.NetWork_Hint11,function(){console.log("loadResAsync Retry "),s.loadResAsync(e,t,i)})?console.log("loadResAsync Dialog.Retry "):s.loadResAsync(e,t,i)}else s.panelRes=s.panelRes.concat(e),t&&t()};void 0!=i?l.loader.load(e,i,function(e,t){r(e)}):(Qu.show(),l.loader.load(e,function(e,t){r(e)}))},loadDialogRes:function(e,t){},clearDialog:function(){},urlRemoveV:function(e){return e=e.replace(/\?v=\d+$/,"")},addRes:function(e,t){t=this.urlRemoveV(t),e instanceof l.Node&&void 0===e.onExit&&(e.onExit=function(){qu.clearOwner(this),this._super()}),e=this._ownerToKey(e);var i=this.owners[e];i||(i=[],this.owners[e]=i);var n=!1;for(var s in i)if(i[s]==t){n=!0;break}n||i.push(t);var r=this.allRes[t]||0;r++,this.allRes[t]=r;var a=l.path.extname(t);".plist"==a?l.spriteFrameCache.addSpriteFrames(t):".png"!=a&&".jpg"!=a||l.textureCache.addImage(t,function(e){if("string"!=typeof e){var i=new l.SpriteFrame;i.initWithTexture(e,l.rect(0,0,e.width,e.height));var n=l.path.basename(t);n?l.spriteFrameCache.addSpriteFrame(i,n):l.spriteFrameCache.addSpriteFrame(i,t)}})},_removeRes:function(e){".plist"==l.path.extname(e)&&l.spriteFrameCache.removeSpriteFramesFromFile(e),delete this.allRes[e]},releaseWithArray:function(e){for(var t in e)this.release(e[t])},release:function(e){e=this.urlRemoveV(e);var t=l.path.extname(e);if(".plist"==t){l.spriteFrameCache.removeSpriteFramesFromFile(e);var i=l.path.changeExtname(e,".png");l.textureCache.removeTextureForKey(i)}else if(".png"===t||".jpg"===t){var n=l.path.basename(e);n?l.spriteFrameCache.removeSpriteFrameByName(n):l.spriteFrameCache.removeSpriteFrameByName(e),l.textureCache.removeTextureForKey(e)}l.loader.release(e)},removeItem:function(e,t){e=this._ownerToKey(e);var i=this.owners[e];if(i){for(var n in i){var s=i[n];if(s==t){var r=this.allRes[s];r&&(0===--r?this._removeRes(s):this.allRes[s]=r),i.splice(n,1);break}}0==i.length&&delete this.owners[e]}},clearOwner:function(e){e=this._ownerToKey(e);var t=this.owners[e];if(t){for(var i in t){var n=t[i],s=this.allRes[n];s&&(0===--s?this._removeRes(n):this.allRes[n]=s)}delete this.owners[e]}}},Qu=l.LayerColor.extend({ctor:function(){this._super(),this.width=l.winSize.width,this.height=l.winSize.height;var e=new l.Sprite("net_loading.png");this.opacity=128,e.x=.5*this.width,e.y=.5*this.height,e.runAction(l.repeatForever(l.sequence(l.rotateBy(.05,20)))),this.addChild(e,1)},onEnter:function(){this._super(),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0},onTouchMoved:null,onTouchEnded:null}),l.eventManager.addListener(this.listener,this)}});Qu.show=function(e){Qu.hide();var t=new Qu;l.director.getRunningScene().addChild(t,1e3,156757246),t.visible=!1,t.runAction(l.sequence(l.delayTime(.25),l.show()))},Qu.hide=function(){var e=l.director.getRunningScene();if(e){var t=e.getChildByTag(156757246);t&&t.removeFromParent()}};var Zu=l.LayerColor.extend({listSpeed:-30,resIsload:!0,ctor:function(){this._super(),this.height=40,this.width=l.winSize.width,this.anchorY=1,this.anchorX=.5,this.ignoreAnchor=!1,this.x=.5*l.winSize.width,this.y=l.winSize.height,this.color=l.color(0,0,0,128),this.opacity=128,this._createList(),this.visible=!1;var e={onChange:this.noticeChanged.bind(this),onRemove:this.noticeRemove.bind(this)};Ql.noticeHandler=e},update:function(e){if(this.resIsload){var t=(e/=l.director.getScheduler().getTimeScale())*this.listSpeed,i=(this.width,[].concat(this.children)),n=this.width;for(var s in i)(r=i[s]).x+=t,n=Math.max(n,r.x+r.width);for(var s in i){var r=i[s];r.x<=-r.width&&(r.x=n,n+=r.width)}}else this._createList()},noticeChanged:function(){this._createList()},noticeRemove:function(e){var t=[].concat(this.children),i=0;for(var n in t){var s=t[n];if(s.x-=i,s.getTag()===e){i+=s.width,s.removeFromParent();break}}this.visible=this.childrenCount>0},_createList:function(){this.removeAllChildren();var e=l.spriteFrameCache.getSpriteFrame("laba.png");if(e){this.resIsload=!0;var t=Ql.noticeList,i=.5*this.width,n=!1;for(var s in t){var r=t[s];if(0==r.type){var a=0,o=new l.Node;o.height=this.height;var h=new l.Sprite(e);h.x=.5*h.width,h.y=.5*o.height,o.addChild(h),a+=h.width;var d=new l.LabelTTF(decodeURIComponent(r.content)+" ","Arial",20);d.anchorX=0,d.y=.5*o.height,d.x=h.x+.5*h.width+8,a+=d.width,o.addChild(d),o.setTag(r.id),o.width=a+20,o.x=i,i+=o.width,this.addChild(o),n=!0}else Ku.show(r.content)}this.visible=n}else this.resIsload=!1},onEnter:function(){this._super(),this.scheduleUpdate()}});Zu._instance=null,Zu.getInstance=function(){return null===this._instance&&(this._instance=new Zu),this._instance};var Ju=l.Layer.extend({labelEnter:null,touchRestart:!1,isEnterGame:!1,resList:null,ctor:function(e){this._super(),this.isEnterGame=e,void 0===e&&(e=!1),e&&Ju._instance&&(Ju._instance.removeFromParent(),Ju._instance=null);var t=l.loader.resPath;l.loader.resPath="";var i=this,n=["res/btn_enter.png","res/bg_group_2.png","res/bg_group.png"];l.loader.load(n,function(){for(var e in n)qu.addRes(this,n[e]);i.initUI(),l.loader.resPath=t}),this.resList=n},ccTouchBegan:function(e,t){if(!this.labelEnter)return!0;var i=this.labelEnter.getBoundingBox();return l.rectContainsPoint(i,e.getLocation())?(this.labelEnter.scale=1.1,this.touchRestart=!0):this.touchRestart=!1,!0},initUI:function(){var e=new l.LayerColor;e.setContentSize(this.getContentSize()),e.color=l.color(200,200,200,255);var t=new l.Node;t.setContentSize(l.size(120,400)),t.ignoreAnchorPointForPosition(!1),t.anchorY=.5,t.anchorX=.5,t.x=e.width-60,t.y=.5*e.height,e.addChild(t,10);var i=new l.Sprite("bg_group.png");i.x=.5*e.width,i.y=.5*e.height,e.addChild(i),i.setRotation(-90);var n=function(){var t=new np("group_rank");t.setAnchorPoint(0,0),e.addChild(t)};setTimeout(function(){n()},300);var s=new l.Sprite("bg_group_2.png");s.x=e.width-.5*s.height,s.y=.5*e.height,e.addChild(s),s.setRotation(-90),this.labelEnter=t,this.addChild(e);var r=new l.Sprite("btn_enter.png");r.x=.5*t.width,r.y=.5*t.height,r.setRotation(-90),t.addChild(r,111)},ccTouchEnded:function(e,t){return void(this.isEnterGame?this.removeFromParent():l.game.restart())},onEnter:function(){this._super(),this.isEnterGame&&(Ju._instance=this),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:null,onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},onExit:function(){if(Ju._instance==this&&(Ju._instance=null),!this.isEnterGame)for(var e in this.resList)l.loader.release(this.resList[e]);qu.clearOwner(this),this._super()}});Ju.scene=function(){var e=new Ju(!1),t=new l.Scene;return t.addChild(e),t},Ju.layer=function(){},Ju._instance=null;var $u=Zs.extend({listener:null,_dayLabel:null,_beganTimeLbl:null,_endTimeLbl:null,_nodelist:null,_size:null,_bgLayer:null,_isMove:!1,_clipperNode:null,_curDay:0,_dataList:null,_curIndex:0,_leftBtn:null,_rightBtn:null,ctor:function(){qu.addRes(this,String.formatC("res/Themes%s/tencent/LoginRecord.plist",GamePlatform.getLanguage())),this._super(Ks.DT_LOGIN)},addChildItems:function(){var e=this.spMainFrame.getContentSize();this._size=e;var t=new l.Sprite("everyday_4.png");t.setAnchorPoint(0,.5),t.setPosition(-50,.5*e.height+60),this.spMainFrame.addChild(t);t.width;(t=new l.Sprite("everyday_5.png")).setAnchorPoint(0,0),t.setPosition(.5*e.width+20,.5*e.height),this.spMainFrame.addChild(t),(t=new l.Sprite("everyday_6.png")).setAnchorPoint(0,.5),t.setPosition(.5*e.width+50,.5*e.height-30),this.spMainFrame.addChild(t),this._dayLabel=new l.LabelAtlas("","rankingup_number2.png",28,38,"0123456789x+"),this._dayLabel.setAnchorPoint(.5,.5);var i=GamePlatform.isCN()?87:75;this._dayLabel.setPosition(t.width-i,.5*t.height+2),this._dayLabel.setScale(.8),t.addChild(this._dayLabel);var n=this.menuItemWithFile("everyday_7.png","everyday_9.png",lo,l.p(-10,80)),s=this.menuItemWithFile("everyday_8.png","everyday_10.png",co,l.p(e.width+10,80));this._leftBtn=n,this._rightBtn=s,this._leftBtn.setVisible(!1),this._rightBtn.setVisible(!1);var r=new l.Menu(n,s);r.setPosition(0,0),this.spMainFrame.addChild(r,-1,15),Ql.getcllogininfo(this.loadServerData.bind(this)),this.registerWithTouchDispatcher(!0)},menuItemWithFile:function(e,t,i,n){var s=new l.Sprite(e),r=new l.Sprite(t),a=new l.MenuItemSprite(s,null,r,this,this.menuCallback.bind(this));return a.setTag(i),a.setPosition(n),a},menuCallback:function(e){if(void 0!=e){var t=e.getTag();switch(wr.getModel().playSoundWithType($.MTPAGESELECT),t){case lo:if(0==this._curIndex)return;this._rightBtn.setEnabled(!0),this._curIndex-=3,this._curIndex<=0&&(this._leftBtn.setEnabled(!1),this._curIndex=0),this.showNextStep();break;case co:var i=this._curIndex;if((i+=3)+3>this._dataList.length&&(this._rightBtn.setEnabled(!1),i=this._dataList.length-3),this._leftBtn.setEnabled(!0),i==this._curIndex)return;this._curIndex=i,this.showNextStep()}}},showNextStep:function(){var e=this._curIndex;(e<0||e>=this._dataList.length)&&(this._curIndex=e<0?0:this._dataList.length-3),e=this._curIndex;for(var t=0;t<this._nodelist.length;t++){var i=e<this._dataList.length?this._dataList[e]:null,n=this._nodelist[t];n.refreshData(i),n.setVisible(i),n.showLightSprInNode(this._curDay>=n.getIndex()),e++}},loadServerData:function(e){if(void 0!=e){this._curDay=e.ln,this._dayLabel.setString(this._curDay);this.spMainFrame.getContentSize();this.loadTime(e.cfg.beginTime,e.cfg.endTime),this.loadRecordItem(e.cfg.awards,e.days)}},loadRecordItem:function(e,t){if(void 0!=e){nr.share().getWinSize();this._nodelist=[],this._bgLayer=new l.Layer,this._bgLayer.setContentSize(200*e.length,100),this._bgLayer.setPosition(30,35),this.spMainFrame.addChild(this._bgLayer),this._dataList=[];var i=!1;for(var n in e){var s=e[n];i=!1;for(var r in t)if(s.day==t[r]){i=!0;break}this._dataList.push({day:s.day,diamond:s.diamond,isReward:i})}this._curIndex=0;for(var a=42,n=0;n<3;n++)if(void 0!=this._dataList[n]){var o=ep.create(this._dataList[n]);o.x=a,this._bgLayer.addChild(o),this._nodelist.push(o),o.showLightSprInNode(this._curDay>=o.getIndex()),a+=o.width+50}this._rightBtn.setVisible(this._dataList.length>3),this._leftBtn.setVisible(this._dataList.length>3)}},loadTime:function(e,t){var i=this.spMainFrame.getContentSize();null==this._beganTimeLbl&&(this._beganTimeLbl=this.createTimeLabel(),this._beganTimeLbl.setPosition(.5*i.width-10,i.height-70)),null==this._endTimeLbl&&(this._endTimeLbl=this.createTimeLabel(),this._endTimeLbl.setPosition(i.width-40,i.height-70));var n=GamePlatform.isCN()?"":" GMT+8";this._endTimeLbl.setString(t+n),this._beganTimeLbl.x=this._endTimeLbl.x-this._endTimeLbl.width,this._beganTimeLbl.setString(e+" ~ ")},getTimeData:function(e){var t=(e=new Date(e)).getFullYear(),i=e.getMonth()+1,n=e.getDate(),s=e.getHours(),r=e.getMinutes();return i<10&&(i="0"+i),n<10&&(n="0"+n),s<10&&(s="0"+s),r<10&&(r="0"+r),{y:t,mon:i,d:n,h:s,min:r}},createTimeLabel:function(){var e=new l.LabelTTF("","Arial-BoldMT",17);return e.setAnchorPoint(1,.5),this.spMainFrame.addChild(e),e},onExit:function(){qu.clearOwner(this),this._super()},registerWithTouchDispatcher:function(e){this.listener&&l.eventManager.removeListener(this.listener),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){return!0},ccTouchEnded:function(e,t){var i=this._bgLayer.convertTouchToNodeSpace(e);for(var n in this._nodelist){var s=this._nodelist[n],r=s.getBoundingBox();if(l.rectContainsPoint(r,i)){l.log("touch in box:"+n),s.getItemState()?ju.alert(b.Dialog_Hint2):s.getIndex()<=this._curDay?this.onClickItem(s):ju.showLiteralsTip(b.Dialog_Hint1);break}}},onClickItem:function(e){if(void 0!=e){var t=this,i=wr.getModel();Ql.finishcllogin(e.getIndex(),function(n){var s=i.usersData.getDiamond();i.usersData.setDiamond(n.dm),qu.loadResAsync(Hi,function(){Gl.create(n.dm-s).showInScene()}),lp&&SDKInterface.logEvent&&SDKInterface.logEvent("LoginRecord",1,{day:e.getIndex()});var r=t.findItemByDay(n.day);r&&(r.setIsReward(!0),r.showLightSprInNode(!1)),t.changeDataByDay(n.day,!0)})}},changeDataByDay:function(e,t){e=e||0;for(var i in this._dataList){var n=this._dataList[i];if(n.day==e){n.isReward=t;break}}},findItemByDay:function(e){e=e||0;for(var t in this._nodelist){var i=this._nodelist[t];if(i.getIndex()==e)return i}return null},SlowDownShow:function(){nr.share().getWinSize();var e=l.p(this.mDis,0),t=l.pAdd(this._bgLayer.getPosition(),e);this.mDis=0,t.x<-this._bgLayer.width+this._clipperNode.width&&(t.x=-this._bgLayer.width+this._clipperNode.width),t.x>0&&(t.x=0);var i=l.moveTo(1,t);this._bgLayer.stopActionByTag(1e3),i.setTag(1e3),this._bgLayer.runAction(i.easing(l.easeExponentialOut()))},showInScene:function(){l.director.getRunningScene().addChild(this,1e3)}}),ep=l.Node.extend({_label:null,_isReward:null,_index:null,_checkSpr:null,_dayLabel:null,_dimLabel:null,_dimSpr:null,_rewardNode:null,_lightSpr:null,ctor:function(e){this._super(),this.init(e)},init:function(e){this._index=e?e.day:0,this.setContentSize(180,90);var t=new l.Sprite("everyday_2.png");t.setPosition(.5*this.width,.5*this.height),this.addChild(t);var i=GamePlatform.isCN()?b.Record_Text:"Day %d",n=new l.LabelTTF(String.formatC(i,this._index),"Arial",20);n.enableStroke(l.color.WHITE,1),n.setColor(l.color(216,171,123)),n.setPosition(.5*this.width,.5*this.height+30),this.addChild(n),this._dayLabel=n,this._checkSpr=new l.Sprite("everyday_check.png"),this._checkSpr.setAnchorPoint(.5,.5),this._checkSpr.setPosition(.87*this.width,.85*this.height),this.addChild(this._checkSpr),this._checkSpr.visible=!1;var s=this.createReward(e?e.diamond:0);s.setAnchorPoint(.5,.5),s.setPosition(.5*this.width+6,.5*this.height-9),this.addChild(s),this._rewardNode=s,this.setIsReward(e.isReward)},refreshData:function(e){if(void 0!=e){this._index=e?e.day:0;var t=GamePlatform.isCN()?b.Record_Text:"Day %d";this._dayLabel.setString(String.formatC(t,this._index)),this._dimLabel.setString("+"+e.diamond);var i=this._dimSpr.width+this._dimLabel.width;this._rewardNode.width=i,this._dimSpr.x=0,this._dimLabel.x=this._dimSpr.width+2,this._rewardNode.x=.5*this.width+6,this.setIsReward(e.isReward)}},createReward:function(e){e=e||0;var t=new l.Sprite("shop_gem.png");t.setAnchorPoint(0,.5),this._dimSpr=t;var i=t.getContentSize(),n=new l.LabelAtlas("+"+e,"rankingup_number2.png",28,38,"0123456789x+");n.setAnchorPoint(0,.5),n.setScale(.8),i.width+=n.width,this._dimLabel=n;var s=new l.Node;return s.setContentSize(i),t.setPosition(0,.5*i.height),n.setPosition(t.width+2,.5*i.height),s.addChild(t),s.addChild(n),s},getItemState:function(){return this._isReward},setIsReward:function(e){this._isReward=e,this._checkSpr&&(this._checkSpr.visible=e)},showLightSprInNode:function(e){null==this._lightSpr&&(this._lightSpr=new l.Sprite("everyday_3.png"),this._lightSpr.setAnchorPoint(.5,.5),this._lightSpr.setPosition(.5*this.width,.5*this.height+5.5),this.addChild(this._lightSpr));var t=e&&!this._isReward;console.log("isVisible:"+e+" _isReward:"+this._isReward),this._lightSpr.setVisible(t)},getIndex:function(){return this._index}});ep.create=function(e){return new ep(e)},$u.create=function(){return new $u};var tp=Zs.extend({_sharetype:0,_shareIndex:0,listener:null,closeBack:null,_close:!1,ctor:function(e,t){void 0==e&&(this._sharetype=1),this._sharetype=e,this._shareIndex=t||Me.CarrotGla,this._super(Ks.DT_TAB)},onExit:function(){qu.clearOwner(this),this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),this._close||this.sendClose(),this.closeBack&&this.closeBack(),this._super()},sendClose:function(){var e=-1;e=this._shareIndex==Ce.BuyLuobo_CarrotGirl_Share||this._shareIndex==Ce.BuyLuobo_CarrotFat_Share?this._shareIndex==Ce.BuyLuobo_CarrotGirl_Share?Be.BuyLuobo_CarrotGirl_First:Be.BuyLuobo_CarrotFat_First:this._shareIndex-3;var t=wr.getModel();t.usersData.setfirstrecordByIndex(e,1),Ql.firstrecord(e,function(e){void 0!=e&&t.usersData.setfirstrecordByIndex(e.index,1)})},registerWithTouchDispatcher:function(e){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0}}),l.eventManager.addListener(this.listener,this))},addChildItems:function(){qu.addRes(this,String.formatC("res/Themes%s/tencent/share_img.plist",GamePlatform.getLanguage()));var e="";switch(this._shareIndex){case 3:case 4:case 5:case 6:case 7:case 8:e="ui_shark_1.png";break;case 9:e="ui_shark_2.png";break;case 10:e="ui_shark_3.png";break;case 11:e="ui_shark_4.png";break;default:e="ui_shark_1.png"}var t=new l.Sprite(e);t.setAnchorPoint(.5,1),t.setPosition(.5*this.spMainFrame.width,this.spMainFrame.height),this.spMainFrame.addChild(t),t=new l.Sprite("ui_shark_5.png");var i=new l.Sprite("btn_blue_s.png"),n=new l.Sprite("btn_blue_s_pressed.png"),s=new l.MenuItemSprite(i,n,null,this,this.menuCallback.bind(this));s.setTag(1021),s.setPosition(.5*this.spMainFrame.width,95),t.setAnchorPoint(.5,.5),t.setPosition(.5*s.width,.5*s.height),s.addChild(t);var r=new l.Menu(s);if(r.setPosition(0,0),this.spMainFrame.addChild(r),!wr.getModel().usersData.getAwardrecordByIndex(this._shareIndex)&&GamePlatform.getCurrentPlatForm()!=PlatformType.FaceBook){var a=new l.Sprite("gem_10.png");a.setAnchorPoint(.5,0),a.setPosition(.5*s.width,s.height-30),s.addChild(a)}this.registerWithTouchDispatcher(!0)},getCarrorStr:function(e){var t="";switch(e){case 9:t=b.ShareText21;break;case 10:t=b.ShareText20;break;case 11:t=b.ShareText19;break;default:t=b.Share_Text15}return t},getCarrorTitle:function(e){var t="";switch(e){case 9:t=b.Share_Title21;break;case 10:t=b.Share_Title20;break;case 11:t=b.Share_Title19;break;default:t=b.Share_Title21}return t},menuCallback:function(e){var t="",i="";1==this._sharetype?(t=kl.getThemeStr(this._shareIndex),i=kl.getThemeTitle(this._shareIndex)):(t=this.getCarrorStr(this._shareIndex),i=this.getCarrorTitle(this._shareIndex));var n=this._shareIndex,s=this;kl.shareAwarddmMessage(i,t,n,function(e){e&&(s._close=!0,s.removeFromParent())})},showInScene:function(){l.director.getRunningScene().addChild(this,10001)}});tp.create=function(e,t){return new tp(e,t)};var ip={list:[],push:function(e){e.scale=1/window.devicePixelRatio*2;var t=this.list.length?this.list[this.list.length-1]:null;t&&(SDKInterface.possMessage&&SDKInterface.possMessage({type:t.msg,subtype:"hide"}),t.visible=!1),SDKInterface.possMessage&&SDKInterface.possMessage({type:e.msg,subtype:"show"}),this.list.push(e)},pop:function(e){var t=this.list.length?this.list[this.list.length-1]:null;if(e===t)SDKInterface.possMessage&&SDKInterface.possMessage({type:t.msg,subtype:"hide"}),this.list.pop(),(t=this.list.length?this.list[this.list.length-1]:null)&&(SDKInterface.possMessage&&SDKInterface.possMessage({type:t.msg,subtype:"show"}),t.visible=!0);else for(var i in this.list)if(this.list[i]===e){this.list.splice(i,1);break}}},np=l.Sprite.extend({msg:null,ctor:function(e){this._super(window.sharedCanvas),this.msg=e},update:function(e){var t=new l.Texture2D;t.initWithElement(window.sharedCanvas),this.setTexture(t)},onEnter:function(){this._super(),ip.push(this)},onExit:function(){ip.pop(this),this._super()}}),sp=l.Node.extend({_isRunAction:!1,_bottomSpr:null,closeBack:null,ctor:function(){this._super(),this.init()},onExit:function(){qu.clearOwner(this),this.closeBack&&this.closeBack(),this._super()},init:function(){qu.addRes(this,String.formatC("res/Themes%s/tencent/stage_share.plist",GamePlatform.getLanguage()));var e=F()%5+1,t=l.spriteFrameCache.getSpriteFrame(String.formatC("tips_1_%d.png",e));if(t||(t=l.spriteFrameCache.getSpriteFrame("tips_1_1.png")),t){var i=new l.Sprite(t);i.setAnchorPoint(.5,1),this.addChild(i);var n=i.getContentSize();this._bottomSpr=new l.Sprite("tips_3.png"),this._bottomSpr.setAnchorPoint(.5,0),this.addChild(this._bottomSpr),n.width-=8,n.height+=this._bottomSpr.height,this.setContentSize(n),i.setPosition(.5*n.width,n.height),this._bottomSpr.setPosition(.5*this.width,0);var s="tips_5.png";1!=e&&(s=3==e||4==e?"tips_7.png":"tips_6.png");var r=this.menuItemWithFile("btn_blue_s.png",s,"btn_blue_s_pressed.png",sa,l.p(.62*this.width,this.height-135)),a=new l.Menu(r);a.setPosition(0,0),this.addChild(a,99)}},menuItemWithFile:function(e,t,i,n,s){var r,a;if(e){r=new l.Sprite(e);var o=new l.Sprite(t);r.addChild(o),o.setPosition(r.width/2,r.height/2)}else r=new l.Sprite(t);if(i){a=new l.Sprite(i);var h=new l.Sprite(t);a.addChild(h),h.setPosition(a.width/2,a.height/2)}else a=new l.Sprite(t);var d=new l.MenuItemSprite(r,a,null,this,this.menuCallback.bind(this));return r.setAnchorPoint(.5,.5),r.setPosition(.5*d.width,.5*d.height),a.setAnchorPoint(.5,.5),a.setPosition(.5*d.width,.5*d.height),a.setScale(1.05),d.setTag(n),d.setAnchorPoint(.5,.5),d.setPosition(s),d},menuCallback:function(e){if(GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp){var t=this;qu.loadResAsync(Gi,function(){if(qu.addRes(this,"res/Themes_cn/tencent/tencent_qun_share.plist"),wr.getModel().usersData.isShareQun)t.sendShare();else{var e=Pr.create(5);e.shareCallBack=function(){t.hide()},e.showInScene()}})}else this.sendShare()},sendShare:function(){var e=F()%4+11;e<12&&(e=12),e>14&&(e=14);var t=wr.getModel(),i=this;kl.shareMessage(null,"",Wl.SPACING_SHARE,t.usersData.getOpenedLevel(),e,null,function(){i.hide()})},hide:function(){this._isRunAction=!0,this.stopAllActions();var e=this.getAnchorPoint().x?this.x+this.width:-this.width;this.runAction(l.sequence(l.moveTo(.2,e,this.y),l.hide(),l.callFunc(function(){this._isRunAction=!1,wr.getModel().usersData.isShowPromptingShare=!1},this),l.removeSelf()))},show:function(){this._isRunAction=!0,this.stopAllActions(),this._bottomSpr&&this._bottomSpr.setOpacity(0);var e=nr.share().getWinSize(),t=this.getAnchorPoint().x,i=t?e.width:0;this.runAction(l.sequence(l.show(),l.moveTo(.2,i,this.y),l.callFunc(function(){if(this._isRunAction=!1,this._bottomSpr){var e=l.spriteFrameCache.getSpriteFrame(t?"tips_4.png":"tips_3.png");e&&this._bottomSpr.setSpriteFrame(e),this._bottomSpr.runAction(l.fadeIn(.2))}},this))),this.unschedule(this.updateTime),this.schedule(this.updateTime,29)},updateTime:function(e){this.unschedule(this.updateTime),this.hide()},getIsRunaction:function(){return this._isRunAction}});sp.create=function(){return new sp};var rp=l.Layer.extend({mBg:null,menuBg:null,m_nClickType:0,bWait:!1,TagPageUp:1,TagPageDown:2,TagHome:3,TagGO:4,pageCahnged:!1,labelGem:null,btnLeft:null,btnRight:null,btnHome:null,btnGo:null,labelWave:null,clickBlank:!1,pMenu:null,messData:null,nodeNoStar:null,waveIndex:-1,ctor:function(){this._super()},init:function(){if(this._super()){var e=wr.getModel();this.bWait=!1;e.curWave;this.messData=e.getMessData(),this.waveIndex=this.messData.beginIndex;var t=e.usersData,i=nr.share().getMapOffset();this.stageType=e.m_nGameMode;for(var n in yi){var s=yi[n];".plist"==l.path.extname(s)&&qu.addRes(this,s)}var r=e.usersData.m_nLanguage,a=String.formatC("res/Themes%s/Items/Items02-hd%s.plist",r,r);qu.addRes(this,a);var o=nr.share().getWinSize(),h=l.color(0,0,0,178),d=new l.LayerColor(h);d&&(d.setPosition(0,0),d.setContentSize(o),this.addChild(d,0));var c=l.spriteFrameCache.getSpriteFrame("mess_8.png");if(!c)return!1;var u=480+i.width;this.menuBg=new l.Sprite(c),this.menuBg.setPosition(u,380),this.addChild(this.menuBg,188,2003);var p=new l.Sprite("mess_11.png");p.x=.5*this.menuBg.width,p.y=this.menuBg.height-110-.5*p.height,this.menuBg.addChild(p);var m=new l.Sprite("mess_12.png");m.x=.5*this.menuBg.width,m.y=270,this.menuBg.addChild(m);var _=new l.Sprite("mess_14.png"),g=new l.Sprite("mess_14.png"),T=new l.Sprite("mess_14.png");g.flippedX=!0,_.flippedX=!0,T.flippedX=!0,T.opacity=150,g.scale=1.1;var f=new l.Sprite("mess_14.png"),S=new l.Sprite("mess_14.png"),w=new l.Sprite("mess_14.png");S.scale=1.1,w.opacity=150;var v=new l.MenuItemSprite(_,g,T,this,this.menuCallback),L=new l.MenuItemSprite(f,S,w,this,this.menuCallback);v.x=76,v.y=L.y=310,L.x=364,this.btnLeft=v,this.btnRight=L;var M=new l.LabelAtlas("0","x53_gap0.png",53,64,"0123456789");this.labelWave=M,M.x=220,M.y=280,M.anchorX=.5,this.menuBg.addChild(M);var C=new l.Node;C.setContentSize(l.size(100,50));var y=new l.Sprite("shop_gem.png"),B=new l.LabelAtlas("+3","x28_gap0.png",28,38,"0123456789x+");C.addChild(y),C.addChild(B),y.anchorY=B.anchorY=y.anchorX=.5,B.anchorX=0,y.y=B.y=.5*C.height,y.x=30,B.x=55,C.y=210,C.x=150,this.menuBg.addChild(C),this.labelGem=B;var F=new l.LabelAtlas(this.messData.canAwardTimes+"","x28_gap0.png",28,38,"0123456789x+");F.x=GamePlatform.isCN()?308:306,F.y=176,F.anchorX=.5,this.menuBg.addChild(F);var E=new l.Sprite("mess_1.png"),P=new l.Sprite("mess_1.png");P.scale=1.1,P.anchorX=E.anchorX=E.anchorY=P.anchorY=.5;var b=new l.MenuItemSprite(E,P,null,this,this.menuCallback),A=new l.Node;this.nodeNoStar=A,A.width=200,A.height=100;var O=new l.Sprite("mess_1_2.png");O.x=.5*O.width,O.y=.5*O.height,A.width=O.width,A.height=O.height,A.addChild(O);var I=new l.LabelTTF("00:00","Arial",32);I.x=.5*O.width,I.y=.5*O.height+6,I.enableShadow(l.color(0,0,0),l.p(1,-1),2),I.setTag(1),A.addChild(I),A.visible=!1,t.getGameStars()<this.messData.needStar&&(A.visible=!0,this.runAction(l.repeatForever(l.sequence(l.delayTime(.5),l.callFunc(this.updateStars,this)))));var R=new l.Sprite("mess_1.png"),D=new l.Sprite("mess_1.png");D.scale=1.1,D.anchorX=R.anchorX=R.anchorY=D.anchorY=.5;var x=new l.MenuItemSprite(R,D,null,this,this.menuCallback);this.btnHome=x,this.btnGo=b;var N=new l.Sprite("adv_menu_home_s.png");x.addChild(N),N.setPosition(60,46),N=new l.Sprite("mess_13.png"),b.addChild(N),N.setPosition(60,46),b.y=x.y=120,b.x=302,x.x=140,b.anchorX=x.anchorX=b.anchorY=x.anchorY=.5,A.setPosition(b.getPosition()),A.setAnchorPoint(b.getAnchorPoint());var G=new l.Menu(v,L,b,x);if(G.setPosition(0,0),this.menuBg.addChild(G,1),this.menuBg.addChild(A,2),this.menuBg.setPosition(480+i.width,890),b.visible=t.getGameStars()>=this.messData.needStar,this.messData.needStar>0){(O=new l.Sprite("mess_17.png")).x=b.x,O.y=b.y-20,O.anchorY=1,this.menuBg.addChild(O,0);var W=new l.Sprite("lifestar_active.png");W.y=32,W.scale=.65,W.anchorX=.5,W.anchorY=.5,W.x=16,O.addChild(W);var k=new l.LabelAtlas("x"+this.messData.needStar,"x28_gap0.png",28,38,"0123456789x+");k.x=28,k.scale=.8,k.y=16,O.addChild(k)}var U=l.moveTo(.2,u,360),H=l.moveTo(.1,u,380);this.menuBg.runAction(l.sequence(U,H)),this.setLeftRightEnable(),this.pMenu=G}return!0},registerWithTouchDispatcher:function(e){this.listener&&(l.eventManager.removeListener(this.listener),this.listener=null),e&&(this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:null,onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this))},ccTouchBegan:function(e,t){var i=this.convertTouchToNodeSpace(e);if(!l.rectContainsPoint(this.menuBg.getBoundingBox(),i)){var n=wr.getModel();this.clickBlank=!0,n.bGameStart&&this.removeFromParent()}return!0},ccTouchEnded:function(e,t){},onEnter:function(){this._super(),0==l.director.getScheduler().isWaite&&(l.director.getScheduler().isWaite=!0,this.bWait=!0);var e=wr.getModel();e.gameLayer.gameHUD.registerWithTouchDispatcher(!1),e.bLockMenu=!0,this.registerWithTouchDispatcher(!0)},updateStars:function(e){var t=wr.getModel().usersData,i=this.nodeNoStar.getChildByTag(1),n=t.getWaitMS();i.setString(String.formatC("%02lu:%02lu",n.m,n.s)),t.getGameStars()>=this.messData.needStar&&(this.nodeNoStar.visible=!1,this.btnGo.visible=!0)},onExit:function(){var e=wr.getModel();this.bWait&&(l.director.getScheduler().isWaite=!1),e.gameLayer.gameHUD.registerWithTouchDispatcher(!0),e.bLockMenu=!1,qu.clearOwner(this),this._super()},startMess:function(e){this.pMenu.setEnabled(!1);var t=wr.getModel(),i=t.animeLayer,n=0==t.bGameStart,s=this;Qu.show(),Ql.requestBeginMess(t.curLevel,1,function(r,a){if(Qu.hide(),r&&0===r.code){var o=r.msg;t.usersData.setStarCount(o.star),void 0!==o.laststartime&&t.usersData.setWaitTime(o.laststartime),n?i.showCountDownTip(0):e&&i.reShowCountDownTip(!0),s.removeFromParent()}else{var h=a||r.msg;ju.showConfirm(h,function(t){t===sa?s.startMess(e):qi.loadLevelSelScene()},zu.RetryCancel)}})},restart:function(){var e=wr.getModel(),t=(e.gameLayer,e.usersData.getCarrotFigure()),i=e.usersData.getSecondCarrotFigure();l.director.getScheduler().setTimeScale(1),e.bRestart=!0,e.usersData.setLastPlayedLevel(e.curLevel,!0),e.playMuiscWithType($.MTWARBGMSC,2),e.m_nGameMode==ge.DOUBLECARROT?(t==ue.CARROT_FAT?e.nCarrotHP=7:e.nCarrotHP=5,i==ue.CARROT_FAT?e.nSecondCarrotHP=7:e.nSecondCarrotHP=5):t==ue.CARROT_FAT?e.nCarrotHP=12:e.nCarrotHP=10;qi.preloadWithGameScene(),e.bLockMenu=!1,e.bGameStart=!1},quit:function(){var e=wr.getModel();e.gameLayer;e.bRestart=!1,e.playMuiscWithType($.MTWARBGMSC,2),l.director.getScheduler().setTimeScale(1);this.replaceScene(!1),l.director.getScheduler().isWaite=!0,e.bBackMainScene=!0,e.bLockMenu=!1},setLeftRightEnable:function(){wr.getModel();this.btnLeft.setEnabled(this.waveIndex>0),this.btnRight.setEnabled(this.waveIndex<this.messData.waves.length-1);var e=this.messData.getAwardGem(this.waveIndex);this.labelGem.setString("+"+e),this.labelWave.setString(this.messData.waves[this.waveIndex]+1)},replaceScene:function(e){wr.getModel();var t=Yd.getUsedRes();qi.preloadWithLoadingTag(t,we.THEME,e)},menuCallback:function(e){var t=wr.getModel();t.playSoundWithType($.MTMENUSELECT);var i=e,n=i.getParent();if(n&&n.setEnabled(!1),i!=this.btnHome){if(i==this.btnGo){t.animeLayer;this.isWaite=!1;var s=t.curWave,r=this.messData.waves[this.waveIndex],a=(t.bGameStart,!1);s!=r&&(this.messData.beginIndex=this.waveIndex,t.loadMessWaveData(r,this.messData.datas[this.waveIndex]),a=!0),this.startMess(a)}else i==this.btnLeft?this.waveIndex>0&&(this.waveIndex-=1,this.pageCahnged=!0,this.setLeftRightEnable()):i==this.btnRight&&this.waveIndex<this.messData.waves.length-1&&(this.pageCahnged=!0,this.waveIndex+=1,this.setLeftRightEnable());n.setEnabled(!0)}else this.quit()}});rp.create=function(){var e=new rp;return e.init(),e};var bh=0,Dh=1,ap=2,op=3,hp=l.Layer.extend({spbg:null,scheduleNode:null,listener:null,pMenuShare:null,pMenuThank:null,pMenuClose:null,spCloseBg:null,ctor:function(){this._super(),wr.getModel().bLockMenu=!0,this.numberTable=[],this.headBgTable=[],this.registerWithTouchDispatcher(),qu.addRes(this,String.formatC("res/Themes%s/tencent/ganxiexin.plist",GamePlatform.getLanguage())),qu.addRes(this,"res/Themes/Items/Items03-hd.plist"),qu.addRes(this,"res/Themes/scene/themelocked.plist"),qu.addRes(this,String.formatC("res/Themes%s/tencent/buy_items.plist",GamePlatform.getLanguage()));nr.share().getWinSize(),nr.share().getMapOffset();var e=1==nr.share().isIPad()?1:.5;this.spbg=new l.Sprite("bg_ganxiexin.png"),this.spbg.setPosition(.5*l.winSize.width,.5*l.winSize.height),this.addChild(this.spbg,101),this.spCloseBg=new l.Sprite("popup_close_frame.png"),this.spCloseBg.setPosition(1043*e,585*e),this.spbg.addChild(this.spCloseBg,2),this.pMenuClose=this.menuItemWithFile("popup_close.png",bh,l.p(1043*e,585*e),null,null,1.1),this.pMenuShare=this.menuItemWithFile("bt_fenxiang.png",ap,l.p(568*e,165*e),null,null,1.1),this.pMenuThank=this.menuItemWithFile("bt_ganxiexin.png",op,l.p(568*e,165*e),null,null,1.1),this.pMenuThank.setVisible(!1);var t=new l.Menu(this.pMenuClose,this.pMenuShare,this.pMenuThank,null);t.setPosition(0,0),t.setTag(Dh),this.spbg.addChild(t,2),this.generateQrCode(),Ql.getbargain(function(e){this.loadFriendName(e)}.bind(this))},intToColor:function(e){e=e||0;var t=new l.Color;return t.b=255&e,t.g=e>>8&255,t.r=e>>16&255,t},loadFriendName:function(e){var t=e.bargains,i=1==nr.share().isIPad()?1:.5,n=[15246336,5142272,1474995,16282700,14168286,7105644,959488,5142272,1474995],s=398*i;if(t.length>0)for(var r="",a=0,o=t.length;a<o;a++){var h=t[a];if(h){r=decodeURIComponent(h.name),this.GetStringLength(r)>=10&&(r=r.slice(0,4)+"... ");var d=new l.LabelTTF(r,"Arial",23);d.setAnchorPoint(0,1),d.setColor(this.intToColor(n[a])),a<=3?d.setPosition(l.p(s,480*i)):d.setPosition(l.p(s,440*i)),s=s+d.getContentSize().width+5,3==a&&(s=398*i),this.spbg.addChild(d,20)}}},GetStringLength:function(e){for(var t=0,i=e.length,n=-1,s=0;s<i;s++)t+=(n=e.charCodeAt(s))>=0&&n<=128?1:2;return t},menuItemWithFile:function(e,t,i,n,s,r){r=r||1;var a=new l.Sprite(e);if(null!=s){var o=new l.Sprite(s);o.setPosition(0,0),o.setAnchorPoint(0,0),a.addChild(o)}var h=null;if(h=null==n?new l.Sprite(e):new l.Sprite(n),null!=s){var d=new l.Sprite(s);d.setPosition(0,0),d.setAnchorPoint(0,0),h.addChild(d)}var c=new l.MenuItemSprite(a,h,null,this,this.menuCallback.bind(this));return c.setTag(t),c.setPosition(i),c},menuCallback:function(e){switch(e.getTag()){case bh:this.setVisible(!1),this.getParent().removeChild(this,!0),wr.getModel().playSoundWithType($.MTPAGESELECT);break;case ap:this.pMenuShare.setVisible(!1),this.pMenuThank.setVisible(!0),this.spCloseBg.setVisible(!1),this.pMenuClose.setVisible(!1),GamePlatform.getCurrentPlatForm()==PlatformType.QQ&&kl.shareScreenshot(0,function(){this.pMenuShare.setVisible(!0),this.pMenuThank.setVisible(!1),this.spCloseBg.setVisible(!0),this.pMenuClose.setVisible(!0)}.bind(this),!1)}},onExit:function(){this.getParent().bLockPopUp=!1,this.removeAllChildren(),qu.clearOwner(this),this.listener&&l.eventManager.removeListener(this.listener),GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp&&lp&&SDKInterface.wxtriggerGC(),this._super()},registerWithTouchDispatcher:function(){this.listener&&l.eventManager.removeListener(this.listener),this.listener=l.EventListener.create({event:l.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.ccTouchBegan.bind(this),onTouchMoved:this.ccTouchMoved.bind(this),onTouchEnded:this.ccTouchEnded.bind(this)}),l.eventManager.addListener(this.listener,this)},ccTouchBegan:function(e,t){return!0},ccTouchMoved:function(e,t){},ccTouchEnded:function(e,t){},generateQrCode:function(){var e=Date.parse(new Date),t="&fuid="+l.playerInfo.id+"&name="+l.playerInfo.name+"&photo="+l.playerInfo.photo,i=GamePlatform.getLoginUrl()+"?_wv=2147674919&_wwv=2048&channel=10029941&time="+e+t,n=jrQrcode.getQrBase64(i,{padding:1,width:130,height:130,correctLevel:QRErrorCorrectLevel.L});l.playerInfo&&l.loader.loadImg(n,{isCrossOrigin:!1},function(e,t){var i=1==nr.share().isIPad()?1:.5,n=new l.Texture2D;n.initWithElement(t),n.handleLoadedTexture();var s=new l.Sprite(n);s.setScale(l.contentScaleFactor()),s.setPosition(l.p(860*i,195*i)),this.spbg.addChild(s,102);var r=l.playerInfo.photo,a=null;if(r)a=Rt.createPhotoSprite(),Rt.loadUserPhoto(r,a);else{var o=l.spriteFrameCache.getSpriteFrame("UserHead.png");a=new l.Sprite(o)}var h=s.getContentSize();if(a){a.setScale(1);var d=25/a.getContentSize().width,c=25/a.getContentSize().height;a.setScaleX(d),a.setScaleY(c),a.setPosition(h.width/2,h.height/2),s.addChild(a,10)}var u=new l.LabelTTF(l.playerInfo.name,"Arial",18);u.setAnchorPoint(.5,1),u.setColor(l.color(255,255,255)),u.setPosition(l.p(h.width/2,-3)),s.addChild(u,20)}.bind(this))}});hp.create=function(){qu.loadResAsync(pi,function(){var e=new hp;l.director.getRunningScene().addChild(e,100)})},l.game.version="1.0.1",l.game.versionInt=10001,l.game.config={project_type:"javascript",debugMode:0,showFPS:!1,frameRate:30,noCache:!1,id:"gameCanvas",renderMode:0,engineDir:"frameworks/cocos2d-html5",modules:["cocos2d"],jsList:[]},void 0===l.game.version&&(l.game.version="1.0.0",l.game.versionInt=1e4);var lp=GamePlatform.getCurrentPlatForm()!=PlatformType.None,dp=!0;l.game.onStart=function(){function e(){qu.loadWithCCLoader(kt,function(){for(var e in kt){var t=kt[e];".plist"===l.path.extname(t)&&qu.addRes(0,t)}},!0)}l.addTimePoint("enterGame"),!l.sys.isNative&&document.getElementById("cocosLoading")&&document.body.removeChild(document.getElementById("cocosLoading"));var t=l.director,i=l.view.getFrameSize();if(l.sys.os===l.sys.OS_IOS)l.view.enableRetina(!0);else{l.view.enableRetina(!0);n=String.formatC(" %s|Display resolution  : width=%d;height= %d",l.sys.browserType,i.width,i.height);l.log(n)}if(l.loader.resPath=GamePlatform.getCDN(),l.view.adjustViewPort(!0),l.view.setOrientation(l.ORIENTATION_LANDSCAPE),l.view.setDesignResolutionSize(1136,640,l.ResolutionPolicy.EXACT_FIT),l.view.resizeWithBrowserSize(!0),!nr.create(1136,640)){var n=String.formatC("not Support Display resolution ratio : %.2f - %.2f",i.width,i.height);l.log(n)}er=!0,t.setAnimationInterval(1/30),l.game.setFrameRate(30),l.addTimePoint("setFrameRate"),l.printTimePoint("enterGame","setFrameRate"),l.director.getScheduler().setTimeScale(1),qu.clearAll(),l.spriteFrameCache.removeSpriteFrames(),l.textureCache.removeAllTextures(),Ql.reset(),l.director.getScheduler().isWaite=!1,l.eventManager.setEnabled(!0),ju.removeAllDialog();var s=new l.Layer;s.setLocalZOrder(1e4),l.director.setNotificationNode(s);var r=Zu.getInstance();if(r.removeFromParent(),s.addChild(r,1),l.game.isDebug=l.game.config.debugMode,!lp){var a={name:"",photo:"",id:0,token:"",openid:""},o=33271482;o||(o=F(),l.sys.localStorage.setItem("openid",o)),a.openid=o,l.playerInfo=a}if(qu.perloadResAsync(Ht),GamePlatform.getCurrentPlatForm()==PlatformType.FaceBook?qu.loadImages(zt,e):e(),lp){var d=function(e,t){for(var i=[{type:"name",option:b.Name},{type:"photo",option:"UserHead.png"}],n=i.length,s=0;s<i.length;++s)!function(r){var a=i[s];Rt.uic(e.openid,a.type,e[a.type],function(i){i||(e[a.type]=a.option),0==--n&&t(e)})}()};SDKInterface.logEvent&&SDKInterface.logEvent("gameLoad");var c=null;l.game.entryData=null,void 0===l.game.firstStart&&(c=SDKInterface.getEntryData(),l.game.firstStart=!1,l.game.entryData=c||null);if(c&&"group"==c.type)return void l.director.runScene(Ju.scene());!0,console.log("进入logo场景"),qi.sceneWithLoadingLogo([],we.INVALIDE);var u=!0,p=function(e,t){if(e)console.log("SDK login success......"+e.toString()),"function"==typeof SDKInterface.setLoadProgress&&SDKInterface.setLoadProgress(100),d(e,function(e){l.playerInfo=e,h(c),qu.loadImages([e.photo])});else{console.log("SDK login failed!......");var i=GamePlatform.getCurrentPlatForm();if(i!=PlatformType.QQ&&i!=PlatformType.WeiXinApp||-1!==t){if(!1===u)return;ju.removeAllDialog();ju.Retry(t||b.NetWork_Hint12,function(){SDKInterface.login(p)})}else ju.removeAllDialog(),u=!1,ju.showCustom(b.NetWork_Hint12,[b.NetWork_Hint13],function(){u=!0,SDKInterface.login(p),console.log("wait for login.......")})}},m=setInterval(function(){console.log("wait running scene"),l.director.getRunningScene()&&(console.log("sdk login......."),SDKInterface.login(p),clearInterval(m))},1)}else l.game.isDebug,h(null)},lp?(window.setLocalStorageItem=l.sys.localStorage.setItem.bind(l.sys.localStorage),window.getLocalStorageItem=l.sys.localStorage.getItem.bind(l.sys.localStorage),SDKInterface.init(function(){l.game.run(),l.addTimePoint("runEnd")})):l.game.run(),l.game.onShow=function(e){console.log("cc.game.onShow"),console.log("EntryData = "+JSON.stringify(e)),e&&("group"==e.type?setTimeout(function(){console.log("show ranked scene");var e=new Ju(!0);l.director.getRunningScene().addChild(e,1e4)},50):void 0!==e.mess&&qi.preloadWithMessData(e.mess)),l.director.resume(),l.audioEngine.resumeMusic()},l.game.onHide=function(){l.director.pause(),l.audioEngine.pauseMusic()},l.game.refresh=function(){var e=GamePlatform.getCurrentPlatForm()==PlatformType.WeiXinApp;!location||e?l.game.restart():location.reload()}}("undefined"==typeof launch?launch={}:launch); 
 			});
 		define("weapp-adapter.js", function(require, module, exports){ 			
(function(){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)})([function(a,b,c){var d=c(1),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f=GameGlobal;GameGlobal.__isAdapterInjected||(GameGlobal.__isAdapterInjected=!0,function(){e.addEventListener=e.canvas.addEventListener=function(a,b){e.document.addEventListener(a,b)},e.removeEventListener=e.canvas.removeEventListener=function(a,b){e.document.removeEventListener(a,b)};var a=wx.getSystemInfoSync(),b=a.platform;if("undefined"==typeof __devtoolssubcontext&&"devtools"===b){for(var c in e){var d=Object.getOwnPropertyDescriptor(f,c);d&&!0!==d.configurable||Object.defineProperty(window,c,{value:e[c]})}for(var g in e.document){var h=Object.getOwnPropertyDescriptor(f.document,g);h&&!0!==h.configurable||Object.defineProperty(f.document,g,{value:e.document[g]})}window.parent=window}else{for(var i in e)f[i]=e[i];f.window=e,window=f,window.top=window.parent=window}}())},function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0}),b.cancelAnimationFrame=b.requestAnimationFrame=b.clearInterval=b.clearTimeout=b.setInterval=b.setTimeout=b.canvas=b.location=b.localStorage=b.HTMLElement=b.FileReader=b.Audio=b.Image=b.WebSocket=b.XMLHttpRequest=b.navigator=b.document=void 0;var e=c(2);Object.keys(e).forEach(function(a){"default"===a||"__esModule"===a||Object.defineProperty(b,a,{enumerable:!0,get:function(){return e[a]}})});var f=c(3);Object.keys(f).forEach(function(a){"default"===a||"__esModule"===a||Object.defineProperty(b,a,{enumerable:!0,get:function(){return f[a]}})});var g=c(9),h=d(g),i=c(10),j=d(i),k=c(17),l=d(k),m=c(18),n=d(m),o=c(19),p=d(o),q=c(11),r=d(q),s=c(12),t=d(s),u=c(20),v=d(u),w=c(4),x=d(w),y=c(21),z=d(y),A=c(22),B=d(A);b.document=j.default,b.navigator=l.default,b.XMLHttpRequest=n.default,b.WebSocket=p.default,b.Image=r.default,b.Audio=t.default,b.FileReader=v.default,b.HTMLElement=x.default,b.localStorage=z.default,b.location=B.default;var C=new h.default;b.canvas=C,b.setTimeout=setTimeout,b.setInterval=setInterval,b.clearTimeout=clearTimeout,b.clearInterval=clearInterval,b.requestAnimationFrame=requestAnimationFrame,b.cancelAnimationFrame=cancelAnimationFrame},function(a,b){Object.defineProperty(b,"__esModule",{value:!0});var c=wx.getSystemInfoSync(),d=c.screenWidth,e=c.screenHeight,f=c.devicePixelRatio,g=b.innerWidth=d,h=b.innerHeight=e;b.devicePixelRatio=f;var i=b.screen={availWidth:g,availHeight:h},j=b.performance={now:function(){return Date.now()/1e3}},k=b.ontouchstart=null,l=b.ontouchmove=null,m=b.ontouchend=null},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0}),c.HTMLCanvasElement=c.HTMLImageElement=void 0;var h=d(4),i=function(a){return a&&a.__esModule?a:{default:a}}(h),j=c.HTMLImageElement=function(a){function b(){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"img"))}return g(b,a),b}(i.default),k=c.HTMLCanvasElement=function(a){function b(){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"canvas"))}return g(b,a),b}(i.default)},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=d(5),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=d(8),l=d(2),m=function(a){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.className="",c.childern=[],c.style={width:l.innerWidth+"px",height:l.innerHeight+"px"},c.insertBefore=k.noop,c.innerHTML="",c.tagName=a.toUpperCase(),c}var c=Number.isNaN;return g(b,a),h(b,[{key:"setAttribute",value:function(a,b){this[a]=b}},{key:"getAttribute",value:function(a){return this[a]}},{key:"getBoundingClientRect",value:function(){return{top:0,left:0,width:l.innerWidth,height:l.innerHeight}}},{key:"focus",value:function(){}},{key:"clientWidth",get:function(){var a=parseInt(this.style.fontSize,10)*this.innerHTML.length;return c(a)?0:a}},{key:"clientHeight",get:function(){var a=parseInt(this.style.fontSize,10);return c(a)?0:a}}]),b}(j.default);c.default=m},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=d(6),i=function(a){return a&&a.__esModule?a:{default:a}}(h),j=function(a){function b(){e(this,b);var a=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a.className="",a.children=[],a}return g(b,a),b}(i.default);c.default=j},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=d(7),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=function(a){function b(){e(this,b);var a=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a.childNodes=[],a}return g(b,a),h(b,[{key:"appendChild",value:function(a){if(a instanceof b)this.childNodes.push(a);else throw new TypeError("Failed to executed 'appendChild' on 'Node': parameter 1 is not of type 'Node'.")}},{key:"cloneNode",value:function(){var a=Object.create(this);return Object.assign(a,this),a}},{key:"removeChild",value:function(a){var b=this.childNodes.findIndex(function(b){return b===a});return-1<b?this.childNodes.splice(b,1):null}}]),b}(j.default);c.default=k},function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=new WeakMap,f=function(){function a(){c(this,a),e.set(this,{})}return d(a,[{key:"addEventListener",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},d=e.get(this);d||(d={},e.set(this,d)),d[a]||(d[a]=[]),d[a].push(b),c.capture&&console.warn("EventTarget.addEventListener: options.capture is not implemented."),c.once&&console.warn("EventTarget.addEventListener: options.once is not implemented."),c.passive&&console.warn("EventTarget.addEventListener: options.passive is not implemented.")}},{key:"removeEventListener",value:function(a,b){var c=e.get(this)[a];if(c&&0<c.length)for(var d=c.length;d--;0<d)if(c[d]===b){c.splice(d,1);break}}},{key:"dispatchEvent",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=e.get(this)[a.type];if(b)for(var c=0;c<b.length;c++)b[c](a)}}]),a}();b.default=f},function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b.noop=function(){}},function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(){var a=wx.createCanvas();a.type="canvas",a.__proto__.__proto__=new g.default("canvas");a.getContext;return a.getBoundingClientRect=function(){var a={top:0,left:0,width:window.innerWidth,height:window.innerHeight};return a},a};var e=c(3),f=c(4),g=d(f),h=c(10),i=d(h)},function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c(1),f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(e),g=c(4),h=d(g),i=c(11),j=d(i),k=c(12),l=d(k),m=c(9),n=d(m);c(15);var o={},p={readyState:"complete",visibilityState:"visible",documentElement:f,hidden:!1,style:{},location:f.location,ontouchstart:null,ontouchmove:null,ontouchend:null,head:new h.default("head"),body:new h.default("body"),createElement:function(a){if("canvas"===a)return new n.default;return"audio"===a?new l.default:"img"===a?new j.default:new h.default(a)},getElementById:function(a){return a===f.canvas.id?f.canvas:null},getElementsByTagName:function(a){if("head"===a)return[p.head];return"body"===a?[p.body]:"canvas"===a?[f.canvas]:[]},querySelector:function(a){if("head"===a)return p.head;return"body"===a?p.body:"canvas"===a?f.canvas:a==="#"+f.canvas.id?f.canvas:null},querySelectorAll:function(a){if("head"===a)return[p.head];return"body"===a?[p.body]:"canvas"===a?[f.canvas]:[]},addEventListener:function(a,b){o[a]||(o[a]=[]),o[a].push(b)},removeEventListener:function(a,b){var c=o[a];if(c&&0<c.length)for(var d=c.length;d--;0<d)if(c[d]===b){c.splice(d,1);break}},dispatchEvent:function(a){var b=o[a.type];if(b)for(var c=0;c<b.length;c++)b[c](a)}};b.default=p},function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(){var a=wx.createImage();return a}},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=d(13),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=0,l=2,m=4,n=new WeakMap,o=new WeakMap,p=new WeakMap,q=new WeakMap,r=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.HAVE_NOTHING=k,c.HAVE_METADATA=1,c.HAVE_CURRENT_DATA=l,c.HAVE_FUTURE_DATA=3,c.HAVE_ENOUGH_DATA=m,c.readyState=k,o.set(c,"");var d=wx.createInnerAudioContext();return n.set(c,d),d.onCanplay(function(){c.dispatchEvent({type:"load"}),c.dispatchEvent({type:"loadend"}),c.dispatchEvent({type:"canplay"}),c.dispatchEvent({type:"canplaythrough"}),c.dispatchEvent({type:"loadedmetadata"}),c.readyState=l}),d.onPlay(function(){c.dispatchEvent({type:"play"})}),d.onPause(function(){c.dispatchEvent({type:"pause"})}),d.onEnded(function(){c.dispatchEvent({type:"ended"}),c.readyState=m}),d.onError(function(){c.dispatchEvent({type:"error"})}),a&&(n.get(c).src=a),c}return g(b,a),h(b,[{key:"load",value:function(){console.warn("HTMLAudioElement.load() is not implemented.")}},{key:"play",value:function(){n.get(this).play()}},{key:"pause",value:function(){n.get(this).pause()}},{key:"canPlayType",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return"string"==typeof a?-1<a.indexOf("audio/mpeg")||a.indexOf("audio/mp4")?"probably":"":""}},{key:"cloneNode",value:function(){var a=new b;return a.loop=n.get(this).loop,a.autoplay=n.get(this).loop,a.src=this.src,a}},{key:"currentTime",get:function(){return n.get(this).currentTime},set:function(a){n.get(this).seek(a)}},{key:"src",get:function(){return o.get(this)},set:function(a){o.set(this,a),n.get(this).src=a}},{key:"loop",get:function(){return n.get(this).loop},set:function(a){n.get(this).loop=a}},{key:"autoplay",get:function(){return n.get(this).autoplay},set:function(a){n.get(this).autoplay=a}},{key:"paused",get:function(){return n.get(this).paused}}]),b}(j.default);c.default=r},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=d(14),i=function(a){return a&&a.__esModule?a:{default:a}}(h),j=function(a){function b(){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"audio"))}return g(b,a),b}(i.default);c.default=j},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=d(4),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=function(a){function b(a){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a))}return g(b,a),h(b,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),b}(j.default);c.default=k},function(a,b,c){c(16)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){return function(b){var c=new k(a);c.touches=b.touches,c.targetTouches=Array.prototype.slice.call(b.touches),c.changedTouches=b.changedTouches,c.timeStamp=b.timeStamp,i.default.dispatchEvent(c)}}var f=c(1),g=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(f),h=c(10),i=function(a){return a&&a.__esModule?a:{default:a}}(h),j=c(8),k=function a(b){d(this,a),this.target=g.canvas,this.currentTarget=g.canvas,this.touches=[],this.targetTouches=[],this.changedTouches=[],this.preventDefault=j.noop,this.stopPropagation=j.noop,this.type=b};wx.onTouchStart(e("touchstart")),wx.onTouchMove(e("touchmove")),wx.onTouchEnd(e("touchend")),wx.onTouchCancel(e("touchcancel"))},function(a,b,c){Object.defineProperty(b,"__esModule",{value:!0});var d=c(8),e=wx.getSystemInfoSync(),f=e.platform,g={platform:f,language:"zh-cn",appVersion:"5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/zh_CN",onLine:!0,geolocation:{getCurrentPosition:d.noop,watchPosition:d.noop,clearWatch:d.noop}};b.default=g},function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function d(a){if("function"==typeof this["on"+a]){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];this["on"+a].apply(this,c)}}function e(a){this.readyState=a,d.call(this,"readystatechange")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=new WeakMap,h=new WeakMap,i=new WeakMap,j=new WeakMap,k=new WeakMap,l=function(){function a(){c(this,a),this.onabort=null,this.onerror=null,this.onload=null,this.onloadstart=null,this.onprogress=null,this.ontimeout=null,this.onloadend=null,this.onreadystatechange=null,this.readyState=0,this.response=null,this.responseText=null,this.responseType="",this.responseXML=null,this.status=0,this.statusText="",this.upload={},this.withCredentials=!1,i.set(this,{"content-type":"application/x-www-form-urlencoded"}),j.set(this,{})}return f(a,[{key:"abort",value:function(){var a=k.get(this);a&&a.abort()}},{key:"getAllResponseHeaders",value:function(){var a=j.get(this);return Object.keys(a).map(function(b){return b+": "+a[b]}).join("\n")}},{key:"getResponseHeader",value:function(a){return j.get(this)[a]}},{key:"open",value:function(b,c){h.set(this,b),g.set(this,c),e.call(this,a.OPENED)}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var b=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(this.readyState!==a.OPENED)throw new Error("Failed to execute 'send' on 'XMLHttpRequest': The object's state must be OPENED.");else wx.request({data:c,url:g.get(this),method:h.get(this),header:i.get(this),responseType:this.responseType,success:function(c){var f=c.data,g=c.statusCode,h=c.header;if("string"!=typeof f&&!(f instanceof ArrayBuffer))try{f=JSON.stringify(f)}catch(a){f=f}if(b.status=g,j.set(b,h),d.call(b,"loadstart"),e.call(b,a.HEADERS_RECEIVED),e.call(b,a.LOADING),b.response=f,f instanceof ArrayBuffer){b.responseText="";for(var k=new Uint8Array(f),l=k.byteLength,m=0;m<l;m++)b.responseText+=String.fromCharCode(k[m])}else b.responseText=f;e.call(b,a.DONE),d.call(b,"load"),d.call(b,"loadend")},fail:function(a){var c=a.errMsg;-1===c.indexOf("abort")?d.call(b,"error",c):d.call(b,"abort"),d.call(b,"loadend")}})}},{key:"setRequestHeader",value:function(a,b){var c=i.get(this);c[a]=b,i.set(this,c)}}]),a}();l.UNSEND=0,l.OPENED=1,l.HEADERS_RECEIVED=2,l.LOADING=3,l.DONE=4,b.default=l},function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=new WeakMap,f=function(){function a(b){var d=this,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(c(this,a),this.binaryType="",this.bufferedAmount=0,this.extensions="",this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.protocol="",this.readyState=3,"string"!=typeof b||!/(^ws:\/\/)|(^wss:\/\/)/.test(b))throw new TypeError("Failed to construct 'WebSocket': The URL '"+b+"' is invalid");this.url=b,this.readyState=a.CONNECTING;var g=wx.connectSocket({url:b,protocols:Array.isArray(f)?f:[f]});return e.set(this,g),g.onClose(function(b){d.readyState=a.CLOSED,"function"==typeof d.onclose&&d.onclose(b)}),g.onMessage(function(a){"function"==typeof d.onmessage&&d.onmessage(a)}),g.onOpen(function(){d.readyState=a.OPEN,"function"==typeof d.onopen&&d.onopen()}),g.onError(function(a){"function"==typeof d.onerror&&d.onerror(new Error(a.errMsg))}),this}return d(a,[{key:"close",value:function(b,c){this.readyState=a.CLOSING;var d=e.get(this);d.close({code:b,reason:c})}},{key:"send",value:function(a){if("string"!=typeof a&&!(a instanceof ArrayBuffer))throw new TypeError("Failed to send message: The data "+a+" is invalid");var b=e.get(this);b.send({data:a})}}]),a}();f.CONNECTING=0,f.OPEN=1,f.CLOSING=2,f.CLOSED=3,b.default=f},function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});b.default=function a(){c(this,a)}},function(a,b){Object.defineProperty(b,"__esModule",{value:!0});var c={get length(){var a=wx.getStorageInfoSync(),b=a.keys;return b.length},key:function(a){var b=wx.getStorageInfoSync(),c=b.keys;return c[a]},getItem:function(a){return wx.getStorageSync(a)},setItem:function(a,b){return wx.setStorageSync(a,b)},removeItem:function(a){wx.removeStorageSync(a)},clear:function(){wx.clearStorageSync()}};b.default=c},function(a,b){Object.defineProperty(b,"__esModule",{value:!0});b.default={href:"game.js",reload:function(){}}}])})(); 
 			});
 		define("xmldom.js", function(require, module, exports){ 			
(function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window.WX_QIUQIU=!0,function(){function e(e){this.options=e||{locator:{}}}function t(e,t,r){function a(t){var n=e[t];if(!n)if(l)n=2==e.length?function(n){e(t,n)}:e;else for(var a=arguments.length;--a&&!(n=e[arguments[a]]););d[t]=n&&function(e){n(e+o(r))}||function(){}}if(!e){if(t instanceof n)return t;e=t}var d={},l=e instanceof Function;return r=r||{},a("warning","warn"),a("error","warn","warning"),a("fatalError","warn","warning","error"),d}function n(){this.cdata=!1}function r(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function o(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function a(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function d(e,t){e.currentElement?e.currentElement.appendChild(t):e.document.appendChild(t)}e.prototype.parseFromString=function(e,r){var o=this.options,a=new XMLReader,d=o.domBuilder||new n,i=o.errorHandler,l=o.locator,u=o.xmlns||{},s={lt:"<",gt:">",amp:"&",quot:"\"",apos:"'"};return l&&d.setDocumentLocator(l),a.errorHandler=t(i,d,l),a.domBuilder=o.domBuilder||d,/\/x?html?$/.test(r)&&(s.nbsp="\xA0",s.copy="\xA9",u[""]="http://www.w3.org/1999/xhtml"),e?a.parse(e,u,s):a.errorHandler.error("invalid document source"),d.document},n.prototype={startDocument:function(){this.document=new DOMImplementation().createDocument(null,null,null),this.locator&&(this.document.documentURI=this.locator.systemId)},startElement:function(e,t,n,o){var a=this.document,l=a.createElementNS(e,n||t),u=o.length;d(this,l),this.currentElement=l,this.locator&&r(this.locator,l);for(var s=0;s<u;s++){var e=o.getURI(s),i=o.getValue(s),n=o.getQName(s),c=a.createAttributeNS(e,n);c.getOffset&&r(c.getOffset(1),c),c.value=c.nodeValue=i,l.setAttributeNode(c)}},endElement:function(){var e=this.currentElement,t=e.tagName;this.currentElement=e.parentNode},startPrefixMapping:function(){},endPrefixMapping:function(){},processingInstruction:function(e,t){var n=this.document.createProcessingInstruction(e,t);this.locator&&r(this.locator,n),d(this,n)},ignorableWhitespace:function(){},characters:function(e){if(e=a.apply(this,arguments),this.currentElement&&e){if(this.cdata){var t=this.document.createCDATASection(e);this.currentElement.appendChild(t)}else{var t=this.document.createTextNode(e);this.currentElement.appendChild(t)}this.locator&&r(this.locator,t)}},skippedEntity:function(){},endDocument:function(){this.document.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e){e=a.apply(this,arguments);var t=this.document.createComment(e);this.locator&&r(this.locator,t),d(this,t)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var o=this.document.implementation;if(o&&o.createDocumentType){var a=o.createDocumentType(e,t,n);this.locator&&r(this.locator,a),d(this,a)}},warning:function(e){console.warn(e,o(this.locator))},error:function(e){console.error(e,o(this.locator))},fatalError:function(e){throw console.error(e,o(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){n.prototype[e]=function(){return null}}),window.iDOMParser=e}(),function(){function n(e,t){for(var n in e)t[n]=e[n]}function t(e,r){var o=e.prototype;if(Object.create)Object.create(r.prototype);if(!(o instanceof r)){var a=function(){};a.prototype=r.prototype,a=new a,n(o,a),e.prototype=o=a}o.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),o.constructor=e)}function r(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,ee[e]),this.message=ee[e],Error.captureStackTrace&&Error.captureStackTrace(this,r);return n.code=e,t&&(this.message=this.message+": "+t),n}function o(){}function a(e,t){this._node=e,this._refresh=t,d(this)}function d(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);L(e,"length",r.length),n(r,e),e._inc=t}}function l(){}function u(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function i(e,t,n,r){if(r?t[u(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var o=e.ownerDocument;o&&(r&&f(o,e,r),h(o,e,n))}}function s(e,t,n){var o=u(t,n);if(0<=o){for(var a=t.length-1;o<a;)t[o]=t[++o];if(t.length=a,e){var d=e.ownerDocument;d&&(f(d,e,n),n.ownerElement=null)}}else throw r(le,new Error)}function c(e){if(this._features={},e)for(var t in e)this._features=e[t]}function m(){}function p(e){return"<"==e&&"&lt;"||">"==e&&"&gt;"||"&"==e&&"&amp;"||"\""==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function N(e,t){if(t(e))return!0;if(e=e.firstChild)do if(N(e,t))return!0;while(e=e.nextSibling)}function g(){}function h(e,t,n){e&&e._inc++;var r=n.namespaceURI;"http://www.w3.org/2000/xmlns/"==r&&(t._nsMap[n.prefix?n.localName:""]=n.value)}function f(e,t,n){e&&e._inc++;var r=n.namespaceURI;"http://www.w3.org/2000/xmlns/"==r&&delete t._nsMap[n.prefix?n.localName:""]}function y(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var o=t.firstChild,a=0;o;)r[a++]=o,o=o.nextSibling;r.length=a}}}function b(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,y(e.ownerDocument,e),t}function E(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===Z){var o=t.firstChild;if(null==o)return t;var a=t.lastChild}else o=a=t;var d=n?n.previousSibling:e.lastChild;o.previousSibling=d,a.nextSibling=n,d?d.nextSibling=o:e.firstChild=o,null==n?e.lastChild=a:n.previousSibling=a;do o.parentNode=e;while(o!==a&&(o=o.nextSibling));return y(e.ownerDocument||e,e),t.nodeType==Z&&(t.firstChild=t.lastChild=null),t}function T(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t);var r=e.lastChild}var r=e.lastChild;return t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,y(e.ownerDocument,e,t),t}function D(){this._nsMap={}}function S(){}function w(){}function C(){}function _(){}function A(){}function x(){}function I(){}function R(){}function O(){}function v(){}function M(){}function U(){}function B(e,t){switch(e.nodeType){case F:var n=e.attributes,r=n.length,o=e.firstChild,a=e.tagName,d=V===e.namespaceURI;t.push("<",a);for(var l=0;l<r;l++)B(n.item(l),t,d);if(o||d&&!/^(?:meta|link|img|br|hr|input)$/i.test(a)){if(t.push(">"),d&&/^script$/i.test(a))o&&t.push(o.data);else for(;o;)B(o,t),o=o.nextSibling;t.push("</",a,">")}else t.push("/>");return;case j:case Z:for(var o=e.firstChild;o;)B(o,t),o=o.nextSibling;return;case z:return t.push(" ",e.name,"=\"",e.value.replace(/[<&"]/g,p),"\"");case H:return t.push(e.data.replace(/[<&]/g,p));case X:return t.push("<![CDATA[",e.data,"]]>");case Q:return t.push("<!--",e.data,"-->");case G:var i=e.publicId,u=e.systemId;if(t.push("<!DOCTYPE ",e.name),i)t.push(" PUBLIC \"",i),u&&"."!=u&&t.push("\" \"",u),t.push("\">");else if(u&&"."!=u)t.push(" SYSTEM \"",u,"\">");else{var s=e.internalSubset;s&&t.push(" [",s,"]"),t.push(">")}return;case W:return t.push("<?",e.target," ",e.data,"?>");case Y:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName);}}function P(e,t,n){var r;switch(t.nodeType){case F:r=t.cloneNode(!1),r.ownerDocument=e;case Z:break;case z:n=!0;}if(r||(r=t.cloneNode(!1)),r.ownerDocument=e,r.parentNode=null,n)for(var o=t.firstChild;o;)r.appendChild(P(e,o,n)),o=o.nextSibling;return r}function q(t,r,a){var d=new r.constructor;for(var u in r){var n=r[u];"object"!=("undefined"==typeof n?"undefined":e(n))&&n!=d[u]&&(d[u]=n)}switch(r.childNodes&&(d.childNodes=new o),d.ownerDocument=t,d.nodeType){case F:var s=r.attributes,c=d.attributes=new l,m=s.length;c._ownerElement=d;for(var p=0;p<m;p++)d.setAttributeNode(q(t,s.item(p),!0));break;;case z:a=!0;}if(a)for(var i=r.firstChild;i;)d.appendChild(q(t,i,a)),i=i.nextSibling;return d}function L(e,t,n){e[t]=n}var V="http://www.w3.org/1999/xhtml",k={},F=k.ELEMENT_NODE=1,z=k.ATTRIBUTE_NODE=2,H=k.TEXT_NODE=3,X=k.CDATA_SECTION_NODE=4,Y=k.ENTITY_REFERENCE_NODE=5,$=k.ENTITY_NODE=6,W=k.PROCESSING_INSTRUCTION_NODE=7,Q=k.COMMENT_NODE=8,j=k.DOCUMENT_NODE=9,G=k.DOCUMENT_TYPE_NODE=10,Z=k.DOCUMENT_FRAGMENT_NODE=11,J=k.NOTATION_NODE=12,K={},ee={},te=K.INDEX_SIZE_ERR=(ee[1]="Index size error",1),ne=K.DOMSTRING_SIZE_ERR=(ee[2]="DOMString size error",2),re=K.HIERARCHY_REQUEST_ERR=(ee[3]="Hierarchy request error",3),oe=K.WRONG_DOCUMENT_ERR=(ee[4]="Wrong document",4),ae=K.INVALID_CHARACTER_ERR=(ee[5]="Invalid character",5),de=K.NO_DATA_ALLOWED_ERR=(ee[6]="No data allowed",6),ie=K.NO_MODIFICATION_ALLOWED_ERR=(ee[7]="No modification allowed",7),le=K.NOT_FOUND_ERR=(ee[8]="Not found",8),ue=K.NOT_SUPPORTED_ERR=(ee[9]="Not supported",9),se=K.INUSE_ATTRIBUTE_ERR=(ee[10]="Attribute in use",10),ce=K.INVALID_STATE_ERR=(ee[11]="Invalid state",11),me=K.SYNTAX_ERR=(ee[12]="Syntax error",12),pe=K.INVALID_MODIFICATION_ERR=(ee[13]="Invalid modification",13),Ne=K.NAMESPACE_ERR=(ee[14]="Invalid namespace",14),ge=K.INVALID_ACCESS_ERR=(ee[15]="Invalid access",15);r.prototype=Error.prototype,n(K,r);o.prototype={length:0,item:function(e){return this[e]||null}},a.prototype.item=function(e){return d(this),this[e]},t(a,o);l.prototype={length:0,item:o.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new r(se);var n=this.getNamedItem(e.nodeName);return i(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new r(se);return t=this.getNamedItemNS(e.namespaceURI,e.localName),i(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return s(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return s(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}};c.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return n&&(!t||t in n)},createDocument:function(e,t,n){var r=new g;if(r.doctype=n,n&&r.appendChild(n),r.implementation=this,r.childNodes=new o,t){var a=r.createElementNS(e,t);r.appendChild(a)}return r},createDocumentType:function(e,t,n){var r=new x;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}};m.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return E(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return b(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return q(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==H&&e.nodeType==H?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var o in r)if(r[o]==e)return o;t=2==t.nodeType?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=2==t.nodeType?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return null==t}},n(k,m),n(k,m.prototype),g.prototype={nodeName:"#document",nodeType:j,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==Z){for(var n,r=e.firstChild;r;)n=r.nextSibling,this.insertBefore(r,t),r=n;return e}return null==this.documentElement&&1==e.nodeType&&(this.documentElement=e),E(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),b(this,e)},importNode:function(e,t){return P(this,e,t)},getElementById:function(e){var t=null;return N(this.documentElement,function(n){if(1==n.nodeType&&n.getAttribute("id")==e)return t=n,!0}),t},createElement:function(e){var t=new D;t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new o;var n=t.attributes=new l;return n._ownerElement=t,t},createDocumentFragment:function(){var e=new v;return e.ownerDocument=this,e.childNodes=new o,e},createTextNode:function(e){var t=new C;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new _;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new A;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new M;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new S;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new O;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new D,r=t.split(":"),a=n.attributes=new l;return n.childNodes=new o,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,a._ownerElement=n,n},createAttributeNS:function(e,t){var n=new S,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},t(g,m);D.prototype={nodeType:F,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===Z?this.insertBefore(e,null):T(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new a(this,function(t){var n=[];return N(t,function(r){r!==t&&r.nodeType==F&&("*"===e||r.tagName==e)&&n.push(r)}),n})},getElementsByTagNameNS:function(e,t){return new a(this,function(n){var r=[];return N(n,function(o){o!==n&&o.nodeType===F&&o.namespaceURI===e&&("*"===t||o.localName==t)&&r.push(o)}),r})},_parseSelector:function(e){return e=e.replace(/\s*>\s*/g," "),e.split(" ")},_findTagsByName:function(e,t,n){for(var r in e.tagName==t&&n.push(e),e.childNodes)this._findTagsByName(e.childNodes[r],t,n)},querySelector:function(e){var t=this.querySelectorAll(e);t.length?t[0]:null},querySelectorAll:function(e){var o=this._parseSelector(e),a=[];o.length&&this._findTagsByName(this,o.shift(),a);for(var d=[].concat(a);o.length;){d.length=0;var r=o.shift();for(var t in a){var i=a[t].childNodes;for(var l in i){var u=i[l];u.tagName==r&&d.push(u)}}a=[].concat(d)}return d}},g.prototype.getElementsByTagName=D.prototype.getElementsByTagName,g.prototype.getElementsByTagNameNS=D.prototype.getElementsByTagNameNS,g.prototype.querySelectorAll=D.prototype.querySelectorAll,g.prototype.querySelector=D.prototype.querySelector,t(D,m);S.prototype.nodeType=z,t(S,m);w.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(){throw new Error(ee[3])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){var r=this.data.substring(0,e),o=this.data.substring(e+t);n=r+n+o,this.nodeValue=this.data=n,this.length=n.length}},t(w,m);C.prototype={nodeName:"#text",nodeType:H,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},t(C,w);_.prototype={nodeName:"#comment",nodeType:Q},t(_,w);A.prototype={nodeName:"#cdata-section",nodeType:X},t(A,w);x.prototype.nodeType=G,t(x,m);I.prototype.nodeType=J,t(I,m);R.prototype.nodeType=$,t(R,m);O.prototype.nodeType=Y,t(O,m);v.prototype.nodeName="#document-fragment",v.prototype.nodeType=Z,t(v,m),M.prototype.nodeType=W,t(M,m),U.prototype.serializeToString=function(e){var t=[];return B(e,t),t.join("")},m.prototype.toString=function(){return U.prototype.serializeToString(this)};try{if(Object.defineProperty){var he=function e(t){switch(t.nodeType){case 1:case 11:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue;}};Object.defineProperty(a.prototype,"length",{get:function(){return d(this),this.$$length}}),Object.defineProperty(m.prototype,"textContent",{get:function(){return he(this)},set:function(e){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(e||e+"")&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=value,this.nodeValue=e;}}}),L=function(e,t,n){e["$$"+t]=n}}}catch(t){}window.DOMImplementation=c,window.XMLSerializer=U}(),function(){function e(){}function t(e,t,u,p,N){function g(e){var t=String.fromCharCode;if(65535<e){e-=65536;var n=55296+(e>>10),r=56320+(1023&e);return t(n,r)}return t(e)}function h(e){var t=e.slice(1,-1);return t in u?u[t]:"#"===t.charAt(0)?g(parseInt(t.substr(1).replace("x","0x"))):(N.error("entity not found:"+e),e)}function f(t){var n=e.substring(C,t).replace(/&#?\w+;/g,h);D&&y(C),p.characters(n,0,t-C),C=t}function y(t,n){for(;t>=E&&(n=T.exec(e));)i=n.index,E=i+n[0].length,D.lineNumber++;D.columnNumber=t-i+1}for(var b,i=0,E=0,T=/.+(?:\r\n?|\n)|.*$/g,D=p.locator,S=[{currentNSMap:t}],w={},C=0;;){if(b=e.indexOf("<",C),0>b){if(!e.substr(C).match(/^\s*$/)){var _=p.document,A=_.createTextNode(e.substr(C));_.appendChild(A),p.currentElement=A}return}switch(b>C&&f(b),e.charAt(b+1)){case"/":var x=e.indexOf(">",b+3),I=e.substring(b+2,x),R=S.pop(),O=R.localNSMap;if(R.tagName!=I&&N.fatalError("end tag name: "+I+" is not match the current start tagName:"+R.tagName),p.endElement(R.uri,R.localName,I),O)for(var v in O)p.endPrefixMapping(v);x++;break;case"?":D&&y(b),x=c(e,b,p);break;case"!":D&&y(b),x=s(e,b,p,N);break;default:try{D&&y(b);var M=new m,x=r(e,b,M,h,N),U=M.length;if(U&&D){for(var B,a=n(D,{}),b=0;b<U;b++)B=M[b],y(B.offset),B.offset=n(D,{});n(a,D)}!M.closed&&l(e,x,M.tagName,w)&&(M.closed=!0,!u.nbsp&&N.warning("unclosed xml attribute")),o(M,p,S),"http://www.w3.org/1999/xhtml"!==M.uri||M.closed?x++:x=d(e,x,M.tagName,h,p)}catch(t){N.error("element parse error: "+t),x=-1}}0>x?f(b+1):C=x}}function n(e,n){return n.lineNumber=e.lineNumber,n.columnNumber=e.columnNumber,n}function r(e,t,n,r,o){for(var a,d,i=++t,l=g;;){var u=e.charAt(i);switch(u){case"=":if(l==h)a=e.slice(t,i),l=y;else if(l==f)l=y;else throw new Error("attribute equal must after attrName");break;case"'":case"\"":if(l==y){if(t=i+1,i=e.indexOf(u,t),0<i)d=e.slice(t,i).replace(/&#?\w+;/g,r),n.add(a,d,t-1),l=E;else throw new Error("attribute value no end '"+u+"' match");}else if(l==b)d=e.slice(t,i).replace(/&#?\w+;/g,r),n.add(a,d,t),o.warning("attribute \""+a+"\" missed start quot("+u+")!!"),t=i+1,l=E;else throw new Error("attribute value must after \"=\"");break;case"/":switch(l){case g:n.setTagName(e.slice(t,i));case E:case T:case D:l=D,n.closed=!0;case b:case h:case f:break;default:throw new Error("attribute invalid close char('/')");}break;case"":o.error("unexpected end of input");case">":switch(l){case g:n.setTagName(e.slice(t,i));case E:case T:case D:break;case b:case h:d=e.slice(t,i),"/"===d.slice(-1)&&(n.closed=!0,d=d.slice(0,-1));case f:l==f&&(d=a),l==b?(o.warning("attribute \""+d+"\" missed quot(\")!!"),n.add(a,d.replace(/&#?\w+;/g,r),t)):(o.warning("attribute \""+d+"\" missed value!! \""+d+"\" instead!!"),n.add(d,d,t));break;case y:throw new Error("attribute value missed!!");}return i;case"\x80":u=" ";default:if(" ">=u)switch(l){case g:n.setTagName(e.slice(t,i)),l=T;break;case h:a=e.slice(t,i),l=f;break;case b:var d=e.slice(t,i).replace(/&#?\w+;/g,r);o.warning("attribute \""+d+"\" missed quot(\")!!"),n.add(a,d,t);case E:l=T;}else switch(l){case f:o.warning("attribute \""+a+"\" missed value!! \""+a+"\" instead!!"),n.add(a,a,t),t=i,l=h;break;case E:o.warning("attribute space is required\""+a+"\"!!");case T:l=h,t=i;break;case y:l=b,t=i;break;case D:throw new Error("elements closed character '/' and '>' must be connected to");}}i++}}function o(e,t,n){for(var r=e.tagName,o=null,d=n[n.length-1].currentNSMap,l=e.length;l--;){var i=e[l],a=i.qName,s=i.value,c=a.indexOf(":");if(0<c)var m=i.prefix=a.slice(0,c),p=a.slice(c+1),N="xmlns"===m&&p;else p=a,m=null,N="xmlns"===a&&"";i.localName=p,!1!==N&&(null==o&&(o={},u(d,d={})),d[N]=o[N]=s,i.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(N,s))}for(var l=e.length;l--;){i=e[l];var m=i.prefix;m&&("xml"===m&&(i.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==m&&(i.uri=d[m]))}var c=r.indexOf(":");0<c?(m=e.prefix=r.slice(0,c),p=e.localName=r.slice(c+1)):(m=null,p=e.localName=r);var g=e.uri=d[m||""];if(t.startElement(g,p,r,e),!e.closed)e.currentNSMap=d,e.localNSMap=o,n.push(e);else if(t.endElement(g,p,r),o)for(m in o)t.endPrefixMapping(m)}function d(e,t,n,r,o){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf("</"+n+">",t),d=e.substring(t+1,a);if(/[&<]/.test(d))return /^script$/i.test(n)?(o.characters(d,0,d.length),a):(d=d.replace(/&#?\w+;/g,r),o.characters(d,0,d.length),a)}return t+1}function l(e,t,n,r){var o=r[n];return null==o&&(o=r[n]=e.lastIndexOf("</"+n+">")),o<t}function u(e,t){for(var r in e)t[r]=e[r]}function s(e,t,n,r){var o=e.charAt(t+2);switch(o){case"-":if("-"===e.charAt(t+3)){var d=e.indexOf("-->",t+4);return d>t?(n.comment(e,t+4,d-t-4),d+3):(r.error("Unclosed comment"),-1)}return-1;default:if("CDATA["==e.substr(t+3,6)){var d=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,d-t-9),n.endCDATA(),d+3}var i=a(e,t),l=i.length;if(1<l&&/!doctype/i.test(i[0][0])){var u=i[1][0],s=3<l&&/^public$/i.test(i[2][0])&&i[3][0],c=4<l&&i[4][0],m=i[l-1];return n.startDTD(u,s&&s.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),m.index+m[0].length}}return-1}function c(e,t,n){var r=e.indexOf("?>",t);if(r){var o=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(o){o[0].length;return n.processingInstruction(o[1],o[2]),r+2}return-1}return-1}function m(){}function a(e,t){var n,r=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(o.lastIndex=t,o.exec(e);n=o.exec(e);)if(r.push(n),n[1])return r}var i=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=new RegExp("[\\-\\.0-9"+i.source.slice(1,-1)+"\xB7\u0300-\u036F\\ux203F-\u2040]"),N=new RegExp("^"+i.source+p.source+"*(?::"+i.source+p.source+"*)?$"),g=0,h=1,f=2,y=3,b=4,E=5,T=6,D=7;e.prototype={parse:function(e,n,r){var o=this.domBuilder;o.startDocument(),u(n,n={}),t(e,n,r,o,this.errorHandler),o.endDocument()}},m.prototype={setTagName:function(e){if(!N.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!N.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getOffset:function(e){return this[e].offset},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},window.XMLReader=e}()})(); 
 			});
 		define("game.js", function(require, module, exports){ 			
(function(){"use strict";require("weapp-adapter.js"),console.log("run game.js"),sharedCanvas.width=568*window.devicePixelRatio,sharedCanvas.height=320*window.devicePixelRatio,wx.postMessage({type:"canvas_create"}),window.launch={},window.DOMParser===void 0&&(require("xmldom.js"),window.DOMParser=window.iDOMParser),require("GamePlatform.js"),require("SDKInterface_WeiXinApp.js");var a=wx.getLaunchOptionsSync();console.log(a.scene),require("main.js")})(); 
 			}); 	require("game.js");
 	