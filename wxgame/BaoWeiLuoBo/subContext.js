	define("mySubContext/GroupRank2.js", function(require, module, exports){ 			
(function(){'use strict';function a(){var a=y.scene;t(a),a.rotation=0,a.y=0,y.off_canvas.draw.redraw(),y.off_canvas.events.enabled=!1}function b(){if(!y.off_canvas){console.log('off_canvas creator');var a=window.oCanvas,b=a.create({canvas:sharedCanvas});y.off_canvas=b;var c=b.display.rectangle({origin:{x:'center',y:'center'},x:0,y:0,width:b.width,height:b.height});y.scene=c,b.addChild(c)}}function c(){B=1;var a=y.off_canvas,b=y.scene;b.rotation=0,b.y=0,t(b);var c=a.display.rectangle({x:90,y:50,width:568,height:320}),d=a.display.image({origin:{x:'center',y:'center'},x:485,y:120,image:E+'muser_up_normal.png',width:50,height:70}),e=a.display.image({origin:{x:'center',y:'center'},x:485,y:120,image:E+'muser_up_disable.png',width:50,height:70}),f=a.display.image({origin:{x:'center',y:'center'},x:485,y:200,image:E+'muser_down_normal.png',width:50,height:70}),g=a.display.image({origin:{x:'center',y:'center'},x:485,y:200,image:E+'muser_down_disable.png',width:50,height:70});b.addChild(c),b.addChild(e),b.addChild(g),b.addChild(d),b.addChild(f),d.bind('tap',function(){q()}),f.bind('tap',function(){r()}),g.opacity=0,e.opacity=0,b.nextButton_d=g,b.preButton_d=e,b.nextButton=f,b.preButton=d,b.rankNode=c,h(c,i)}function d(){console.log('\u8FDB\u6765\u4E00\u6B21');var a=y.off_canvas,b=y.scene;t(b),b.rotation=-90,b.y=a.height;var c=a.display.rectangle({x:0,y:35,width:320,height:568});c.x=30,console.log('off_canvas',a.width,a.height),console.log('rankNode.x'+c.y),b.addChild(c),g(c),b.rankNode=c}function e(){var a=y.off_canvas,b=y.scene;t(b),b.rotation=0,b.y=0;var c=a.display.rectangle({x:0,y:0,width:568,height:320});b.addChild(c),h(c,f)}function f(a,b){for(var c=0,d={},e=v(b),f=0;f<e.length;++f)if(console.log(e[f].openId,e[f].openId),e[f].openId===A){c=e[f].gold,d=e[f],d.rank=f+1;break}for(var g=!1,h={},f=0;f<e.length;++f)if(e[f].gold===c-1){g=!0,h=e[f],h.rank=f+1;break}if(console.log(h),console.log(d),!!g){var i=y.off_canvas,j=i.display.rectangle({width:i.width,height:i.height,origin:{x:'center',y:'center'},fill:'#000',opacity:0.5,x:i.width/2,y:i.height/2}),k=i.display.image({origin:{x:'center',y:'center'},image:E+'rankingup_title_cn.png',x:i.width/2-10,y:i.height/2-80,width:216,height:38}),l=i.display.rectangle({origin:{x:'center',y:'center'},x:i.width/2-20,y:i.height/2,width:390,height:80}),m=i.display.image({origin:{x:'center',y:'center'},image:E+'rankingup_frame_1.png',x:0,y:0,width:250,height:80}),n=i.display.image({origin:{x:'center',y:'center'},image:d.avatarUrl,x:-40,y:5,width:30,height:30}),o=i.display.text({origin:{x:'left',y:'center'},font:'20px',text:d.rank+'',fill:'#ff4121',x:-90,y:5}),p=i.display.text({origin:{x:'left',y:'center'},font:'12px',text:d.gold+'',fill:'#fff',x:40,y:5}),q=i.display.image({origin:{x:'center',y:'center'},image:E+'rankingup_up.png',x:145,y:0,width:42,height:55}),r=i.display.image({origin:{x:'center',y:'center'},image:E+'rankingup_goldencarrot.png',x:20,y:5,width:20,height:26}),s=i.display.rectangle({origin:{x:'center',y:'center'},x:i.width/2-20,y:i.height/2+50,width:330,height:54}),t=i.display.image({origin:{x:'center',y:'center'},image:E+'rankingup_goldencarrot.png',x:20,y:5,width:18,height:23}),u=i.display.image({origin:{x:'center',y:'center'},image:E+'rankingup_frame_3.png',x:0,y:0,width:198,height:54}),w=i.display.image({origin:{x:'center',y:'center'},image:h.avatarUrl,x:-30,y:3,width:25,height:25}),x=i.display.text({origin:{x:'left',y:'center'},font:'10px',text:h.gold+'',fill:'#fff',x:40,y:5}),z=i.display.text({origin:{x:'left',y:'center'},font:'16px',text:h.rank+'',fill:'#ff4121',x:-80,y:5}),B=i.display.image({origin:{x:'center',y:'center'},image:E+'rankingup_down.png',x:125,y:0,width:35,height:45});a.addChild(j),a.addChild(k),a.addChild(s),a.addChild(l),l.addChild(m),l.addChild(q),l.addChild(r),l.addChild(n),l.addChild(p),l.addChild(o),s.addChild(u),s.addChild(t),s.addChild(B),s.addChild(w),s.addChild(x),s.addChild(z),a.stop(),l.y=340,l.animate({y:150,scalingX:2,scalingY:2},{duration:200}),l.animate({scalingX:1,scalingY:1},{duration:200,callback:function(){var a=i.display.image({origin:{x:'center',y:'center'},image:E+'rankingup_frame_2.png',x:0,y:0,width:250,height:80});l.addChild(a),a.zIndex=0}}),s.y=150,s.delay(200),s.animate({y:230},{duration:200,callback:function(){console.log('ddddddd')}})}}function g(a){wx.getGroupUserGameData({success:function(b){console.log('--getGroupUserGameData:'+b.data);var c=v(b.data);0==c.length?wx.getUserInfo({openIdList:['selfOpenId'],success:function(b){console.log('success',b.data),c=v(b.data),j(c,a)},fail:function(){}}):j(c,a),console.log(c)},fail:function(a){console.log('getGroupUserGamedata'+a.errMsg)}})}function h(a,b){wx.getFriendUserGameData&&wx.getFriendUserGameData({success:function(c){b(a,c.data),console.log(D),console.log(c.data)},fail:function(a){console.log(a.err_code)}})}function i(a,b){D=v(b),0==D.length?wx.getUserInfo({openIdList:['selfOpenId'],success:function(b){console.log('success',b.data),D=v(b.data),k(D,a)},fail:function(){}}):k(D,a)}function j(a,b){var c=a.slice(0,8);t(b),n(b,c)}function k(){s();var a=D.slice((B-1)*C,(B-1)*C+C);console.log('console.log(drawList);'),console.log(a),t(y.scene.rankNode),p(y.scene.rankNode,a)}function l(a,b,c){var d=c.nickName;console.log('name'+d+'gblen'+d.gblen()),d=14<=d.gblen()?d.slice(0,7)+'...':d;var e=c.avatarUrl,f=c.gold;f=f?f:0;var g=c.crystal;g=g?g:0,e=e?e:'UserHead.png';var h=1==b?'img_first.png':'img_other.png';console.log(e);var i=a.display.image({origin:{x:'left',y:'center'},image:E+h,x:-14,y:0,width:23,height:20}),j=a.display.image({origin:{x:'left',y:'center'},image:E+'rank_item.png',width:265,height:40}),k=a.display.text({origin:{x:'left',y:'center'},font:'10px',text:b+'',fill:'#fff'}),l=a.display.text({origin:{x:'left',y:'center'},font:'15px',text:d,fill:'#fff'}),m=a.display.image({origin:{x:'center',y:'center'},image:e,width:30,height:30});m.clipChildren=!0;var n=a.display.text({origin:{x:'center',y:'center'},font:'20px',text:f+'',fill:'#fff'}),o=a.display.image({origin:{x:'center',y:'center'},image:E+'gold.png',width:30,height:27}),p=a.display.image({x:0,y:0,width:265,height:40,origin:{x:'left',y:'center'}});return p.addChild(j),p.addChild(l),p.addChild(m),p.addChild(o),p.addChild(i),p.addChild(k),p.addChild(n),j.x=0,k.x=-6,m.x=23,l.x=60,o.x=200,n.x=235,m.bind('tap',function(){console.log('\u6211\u70B9')}),p}function m(a,b,c){var d=c.nickName;d=14<=d.gblen()?d.slice(0,7)+'...':d;var e=c.avatarUrl,f=c.gold;f=f?f:0;var g=c.crystal;e=e?e:'UserHead.png';var h=1==b?'img_first.png':'img_other.png';console.log(e);var i=a.display.image({origin:{x:'left',y:'center'},image:E+h,x:-4,y:0,width:23,height:20}),j=a.display.image({origin:{x:'left',y:'center'},image:E+'muser_contentbox.png',width:350,height:50}),k=a.display.text({origin:{x:'left',y:'center'},font:'10px',text:b+'',fill:'#fff'}),l=a.display.text({origin:{x:'left',y:'center'},font:'11px',text:d,fill:'#fff'}),m=a.display.image({origin:{x:'center',y:'center'},image:e,width:35,height:35}),n=a.display.image({origin:{x:'center',y:'center'},image:E+'muser_avatar_s.png',width:35,height:35}),o=a.display.text({origin:{x:'center',y:'center'},font:'20px',text:f+'',fill:'#fff'}),p=a.display.text({origin:{x:'center',y:'center'},font:'20px',text:g+'',fill:'#fff'}),q=a.display.image({origin:{x:'center',y:'center'},image:E+'muser_cup_gold.png',width:30,height:27}),r=a.display.image({origin:{x:'center',y:'center'},image:E+'muser_cup_mission.png',width:30,height:30}),s=a.display.image({origin:{x:'center',y:'center'},image:E+'contentbox_dotline.png',width:10,height:50}),t=a.display.image({origin:{x:'center',y:'center'},image:E+'contentbox_dotline.png',width:10,height:50}),u=a.display.rectangle({x:20,y:0,width:265,height:40,origin:{x:'left',y:'center'}});return u.addChild(j),u.addChild(l),u.addChild(m),u.addChild(n),u.addChild(q),u.addChild(i),u.addChild(o),u.addChild(p),u.addChild(k),u.addChild(r),u.addChild(s),u.addChild(t),j.x=0,k.x=4,m.x=33,n.x=33,l.x=60,s.x=185,q.x=210,o.x=242,t.x=265,r.x=290,p.x=320,m.bind('tap',function(){console.log('\u6211\u70B9')}),u}function n(a,b){var c=b.length;c=c>z?z:c;for(var d=0;d<c;++d){var e=b[d],f=l(y.off_canvas,(1-1)*z+d+1,e);f.y=45+45*d,a.addChild(f),console.log('rankitem'+a.x)}1<c||o(a)}function o(a){var b=y.off_canvas.display.image({origin:{x:'left',y:'center'},image:E+'bg_group_3.png',width:320,height:335,x:-30,y:368});b.zIndex=0,a.addChild(b)}function p(a,b){var c=b.length;console.log('len'+c);for(var d=0;d<c;++d){var e=b[d],f=m(y.off_canvas,(B-1)*C+d+1,e);f.y=45+50*d,a.addChild(f),console.log('rankitem'+f.y),console.log('container'+a.y)}}function q(){console.log('\u7FFB\u4E0A\u9875');0==D.length||1==B||(B--,k())}function r(){console.log('\u7FFB\u4E0B\u9875');0==D.length||B==x()||(B++,k())}function s(){B==x()?(y.scene.nextButton_d&&(y.scene.nextButton_d.opacity=1),y.scene.nextButton&&(y.scene.nextButton.opacity=0)):(y.scene.nextButton_d&&(y.scene.nextButton_d.opacity=0),y.scene.nextButton&&(y.scene.nextButton.opacity=1)),1==B?(y.scene.preButton_d&&(y.scene.preButton_d.opacity=1),y.scene.preButton&&(y.scene.preButton.opacity=0)):(y.scene.preButton_d&&(y.scene.preButton_d.opacity=0),y.scene.preButton&&(y.scene.preButton.opacity=1))}function t(a){if(a.children&&a.children instanceof Array)for(var b,c=a.children.length-1,d=c;0<=d;--d)b=a.children[d],a.removeChild(b)}function u(){}function v(a){for(var b,c=a.length,d=0;d<c;++d)if(b=a[d],console.log(b.buffer),b.photo=b.avatarUrl,b.id=b.openId,b.gender=1,b.name=b.nickName,''==b.avatarUrl&&(b.avatarUrl=E+'UserHead.png',b.photo=''),b.buffer){try{var e=JSON.parse(b.buffer)}catch(a){console.log(a);continue}console.log('gold:'+e.wxgame.rank[0].gold),b.gold=parseInt(e.wxgame.rank[0].gold?e.wxgame.rank[0].gold:0),b.crystal=parseInt(e.wxgame.rank[0].crystal?e.wxgame.rank[0].crystal:0),b.stage=parseInt(e.wxgame.rank[0].stage?e.wxgame.rank[0].stage:0)}else b.gold=0,b.crystal=0,b.stage=0;return a.sort(w('gold')),a}function w(a){return function(b,c){var d=b[a],e=c[a];return e<d?-1:e>d?1:0}}function x(){return D.length?parseInt((D.length-1)/C)+1:0}require('ocanvas-2.8.10-compiled');var y={},z=8;wx.onMessage(function(f){if(console.log('--wx.onMessage:'+JSON.stringify(f)),!!f){if('hide'==f.subtype)return a(),void console.log('\u5B50\u57DF\u4E0D\u663E\u793A');switch('show'==f.subtype&&(y.off_canvas.events.enabled=!0,console.log('\u663E\u793A\u5B50\u57DF')),f.type){case'friendRank':c(f.subtype),console.log('\u597D\u53CB\u6392\u884C\u699C\u663E\u793A');break;case'group_rank':d(f.subtype),console.log('\u7FA4\u6392\u884C\u663E\u793A');break;case'friend_custtoms':u(f.subtype);break;case'canvas_create':b();break;case'rest_canvas':break;case'surpass_friend':e(f.subtype);break;case'update_openid':A=f.data,console.log('myOpenID:'+A);}}});var A,B=1,C=4,D=[];String.prototype.gblen=function(){for(var a=0,b=0;b<this.length;b++)127<this.charCodeAt(b)||94==this.charCodeAt(b)?a+=2:a++;return a};var E='res/'})(); 
 			});
 		define("mySubContext/ocanvas-2.8.10-compiled.js", function(require, module, exports){ 			
(function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(i,n,s){var o=Math.sin,_=Math.cos,x=Math.PI,r=Math.asin,O=Math.abs,P=Math.sqrt,C=Math.pow,l=Math.round,g=Math.max,p={version:"2.8.10",canvasList:[],modules:{},inits:{},plugins:{},core:function(r){for(var s in this.isCore=!0,this.id=p.canvasList.push(this)-1,this.lastObjectID=0,this.children=[],this.domEventHandlers=[],p.modules)this[s]="function"==typeof p.modules[s]?p.modules[s]():Object.create(p.modules[s]);this.settings={fps:30,background:"transparent",clearEachFrame:!0,drawEachFrame:!0,disableScrolling:!1,plugins:[]},p.extend(this.settings,r),this.originalSettings=p.extend({},this.settings),this.canvasElement="CANVAS"===this.settings.canvas.tagName||this.settings.canvas.nodeName&&"canvas"===this.settings.canvas.nodeName.toLowerCase()?this.settings.canvas:"string"==typeof this.settings.canvas?n.querySelector(this.settings.canvas):this.settings.canvas,this.canvas=this.canvasElement.getContext("2d");var o=this.canvasElement.width,l=this.canvasElement.height;for(s in Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,set:function(e){o=isNaN(parseFloat(e))?o:parseFloat(e),this.canvasElement.width=o,this.background.set(this.settings.background),this.redraw()},get:function(){return o/i.devicePixelRatio}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,set:function(e){l=isNaN(parseFloat(e))?l:parseFloat(e),this.canvasElement.height=l,this.background.set(this.settings.background),this.redraw()},get:function(){return l/i.devicePixelRatio}}),p.modules){if(!0===this[s].wrapper)for(var e in this[s])"object"===t(this[s][e])&&"function"==typeof this[s][e].setCore?this[s][e]=this[s][e].setCore(this):"function"==typeof this[s][e].setCore&&this[s][e].setCore(this),this[s].core=this;this[s].core=this}for(var a in p.inits)if("string"==typeof p.inits[a]&&"function"==typeof this[a][p.inits[a]])this[a][p.inits[a]]();else if("object"===p.inits[a])for(var d in p.inits[a])"function"==typeof this[a][p.inits[a][d]]&&this[a][p.inits[a][d]]();if(r=this.settings.plugins,0<r.length)for(s=0,e=r.length;s<e;s++)"function"==typeof p.plugins[r[s]]&&p.plugins[r[s]].call(this)},registerModule:function(e,t,i){~e.indexOf(".")?(e=e.split("."),p.modules[e[0]][e[1]]=t,i!==s&&(p.inits[e[0]]||(p.inits[e[0]]={}),p.inits[e[0]][e[1]]=i)):(p.modules[e]=t,i!==s&&(p.inits[e]=i))},registerPlugin:function(e,t){p.plugins[e]=t},create:function(e){return new p.core(e)},domReady:function(e){if(this.domReadyHandlers.push(e||function(){}),this.isDomReadyListening)return!1;if(this.isDomReady)return p.triggerDomReadyHandlers(),!0;var t=function e(t){("complete"===n.readyState||t&&"DOMContentLoaded"===t.type)&&(p.isDomReadyListening=!1,p.isDomReady=!0,p.triggerDomReadyHandlers(),n.removeEventListener("readystatechange",e,!1),n.removeEventListener("DOMContentLoaded",e,!1))};return!!t()||(this.isDomReadyListening?void 0:(p.isDomReadyListening=!0,n.addEventListener("readystatechange",t,!1),n.addEventListener("DOMContentLoaded",t,!1),!1))},isDomReady:!1,isDomReadyListening:!1,domReadyHandlers:[],triggerDomReadyHandlers:function(){var t,i,n,a;for(t=this.domReadyHandlers,i=0,n=t.length;i<n;i++)(a=t[i])&&(delete t[i],a())}};p.core.prototype={addChild:function(e,t){return e.add(t),this},removeChild:function(e,t){return e.remove(t),this},clear:function(e){return this.draw.clear(e),this},redraw:function(){return this.draw.redraw(),this},bind:function(e,t){return this.events.bind(this.canvasElement,e.split(" "),t),this},unbind:function(e,t){return this.events.unbind(this.canvasElement,e.split(" "),t),this},trigger:function(e,t){var i=this.events;return i.triggerHandlers(this.canvasElement,e.split(" "),i.fixEventObject(t)),this},reset:function(){for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].remove(),i--,n--;this.lastObjectID=t.length=0;var a,t=this.canvasElement.events;for(a in t)t[a]instanceof Array&&this.unbind(a,t[a]);this.settings=p.extend({},this.originalSettings)},destroy:function(){this.timeline&&this.timeline.stop(),this.reset();for(var e=0,t=this.domEventHandlers.length;e<t;e++)p.removeDOMEventHandler(this,e);this.domEventHandlers.length=0,p.canvasList[this.id]=null,this.canvasElement=n.createElement("canvas"),this.canvas=this.canvasElement.getContext("2d")}},i.oCanvas=p,p.domReady(),p.extend=function(){var t,i=Array.prototype.slice.call(arguments),n=i[i.length-1],a=i.splice(0,1)[0],r=i.splice(0,1)[0],e=[];if(n.exclude&&JSON.stringify(n)===JSON.stringify({exclude:n.exclude})&&(e=n.exclude),r!==n||0===e.length)for(t in r)~e.indexOf(t)||(n=Object.getOwnPropertyDescriptor(r,t),n.get||n.set?Object.defineProperty(a,t,n):a[t]=r[t]);return 0<i.length?p.extend.apply(this,[a].concat(i)):a},p.addDOMEventHandler=function(t,i,n,r,s){t.domEventHandlers.push({obj:i,event:n,handler:r,useCapture:!!s}),i.addEventListener(n,r,s)},p.removeDOMEventHandler=function(e,t){e=e.domEventHandlers[t],e.obj.removeEventListener(e.event,e.handler,e.useCapture)},p.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),"function"!=typeof Object.getPropertyDescriptor&&(Object.getPropertyDescriptor=function(e,t){var i=Object.getOwnPropertyDescriptor(e,t);for(e=Object.getPrototypeOf(e);i===s&&null!==e;)i=Object.getOwnPropertyDescriptor(e,t),e=Object.getPrototypeOf(e);return i}),function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!i.requestAnimationFrame;++n)i.requestAnimationFrame=i[t[n]+"RequestAnimationFrame"],i.cancelAnimationFrame=i[t[n]+"CancelAnimationFrame"]||i[t[n]+"CancelRequestAnimationFrame"];i.requestAnimationFrame||(i.requestAnimationFrame=function(t,n){var a=new Date().getTime(),r=g(0,16-(a-e));return n=i.setTimeout(function(){t(a+r)},r),e=a+r,n}),i.cancelAnimationFrame||(i.cancelAnimationFrame=function(e){clearTimeout(e)})}(),i.log=function(){if(log.history=log.history||[],log.history.push(arguments),this.console){var e,t=Array.prototype.slice.call(arguments),i=t.length;for(e=0;e<i;e++)console.log(t[e])}},p.registerModule("timeline",function(){var e={init:function(){var e=this;this.core.setLoop=function(t){return e.userLoop=t,e}},currentFrame:1,timeline:0,running:!1,set fps(e){this.core.settings.fps=e,this.running&&this.start()},get fps(){return this.core.settings.fps},loop:function(){this.running&&setTimeout(function(){e.timeline=requestAnimationFrame(e.loopBound);var t=e.core;"function"==typeof e.userLoop&&(!0===t.settings.clearEachFrame&&t.draw.clear(),e.userLoop.call(t,t.canvas),!0===t.settings.drawEachFrame&&t.draw.redraw(),e.currentFrame++)},1E3/e.fps)},loopBound:function(){e.loop()},start:function(){return cancelAnimationFrame(e.timeline),e.running=!0,e.loop(),this},stop:function(){return this.running=!1,cancelAnimationFrame(e.timeline),this}};return e},"init"),p.registerModule("keyboard",function(){return{keysDown:{},keyPressTimers:{},modifiedKeys:[],init:function(){var e=this;p.addDOMEventHandler(this.core,n,"keydown",function(t){e.docHandler(t)},!1),p.addDOMEventHandler(this.core,n,"keyup",function(t){e.docHandler(t)},!1),p.addDOMEventHandler(this.core,n,"keypress",function(t){e.preventDefault(t)},!1)},docHandler:function(t){var i,n,a,e;if(n=this.core.events,a=this.core.canvasElement,n.enabled&&(!this.core.pointer||!0===this.core.pointer.canvasFocused)&&(i=this.getKeyCode(t),this.preventDefault(t),"keydown"!==t.type||!0!==this.keysDown[i])&&("keydown"===t.type?this.keysDown[i]=!0:"keyup"===t.type&&delete this.keysDown[i],e=n.fixEventObject(t,"keyboard"),n.lastKeyboardEventObject=e,n.triggerHandlers(a,[t.type]),"keydown"===t.type&&(this.keyPressTimers[i]=setInterval(function(){n.triggerHandlers(a,["keypress"],e)},1E3/this.core.settings.fps)),"keyup"===t.type))if(this.anyKeysDown())clearInterval(this.keyPressTimers[i]);else for(i in this.keyPressTimers)clearInterval(this.keyPressTimers[i])},preventDefault:function(e){if(this.core.mouse&&!0===this.core.mouse.canvasFocused||!this.core.mouse){var t=this.getKeyCode(e);~this.modifiedKeys.indexOf(t)&&e.preventDefault()}},addPreventDefaultFor:function(e){e="number"==typeof e?[e]:e instanceof Array?e:[];for(var t=0;t<e.length;t++)this.modifiedKeys.push(e[t])},removePreventDefaultFor:function(e){e="number"==typeof e?[e]:e instanceof Array?e:[];var t,i;for(t=0;t<e.length;t++)i=this.modifiedKeys.indexOf(e[t]),~i&&this.modifiedKeys.splice(i,1)},getKeyCode:function(e){return 0===e.keyCode?e.which:e.keyCode},numKeysDown:function(){var e,t,i;for(i in e=0,t=this.keysDown,t)!0===t[i]&&e++;return e},anyKeysDown:function(){return 0<this.numKeysDown()},getKeysDown:function(){var e,t,i;for(i in e=this.keysDown,t=[],e)!0===e[i]&&t.push(parseInt(i,10));return t},ARROW_UP:38,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,SPACE:32,ENTER:13,ESC:27}},"init"),p.registerModule("mouse",function(){return{x:0,y:0,buttonState:"up",canvasFocused:!1,canvasHovered:!1,cursorValue:"default",init:function(){this.core.events.addEventTypes("mouse",{move:"mousemove",enter:"mouseenter",leave:"mouseleave",down:"mousedown",up:"mouseup",singleClick:"click",doubleClick:"dblclick"}),this.types={mousemove:"move",mousedown:"down",mouseup:"up",dblclick:"doubleClick"},this.core.pointer=this,this.core.touch&&this.core.touch.isTouch||this.bindHandlers()},bindHandlers:function(){var t,r,a,s;for(s in t=this,r=this.core,a=r.canvasElement,this.types){p.addDOMEventHandler(r,a,s,function(e){t.canvasHandler(e)},!1),"mousemove"===s&&(s="mouseover"),p.addDOMEventHandler(r,n,s,function(e){t.docHandler(e)},!1);var e=null;try{e=i.parent.document}catch(e){}e&&p.addDOMEventHandler(r,e,s,function(e){t.docHandler(e)},!1)}},canvasHandler:function(t,i){var n,a,r;n=this.core.events,a=this.onCanvas(t),"mouseup"!==t.type||a||this.canvasUpEventTriggered?(i||a)&&(r=i&&"mouseover"===t.type?"mousemove":t.type,i||(this.canvasHovered=!0),"mousedown"===r&&(this.canvasUpEventTriggered=!1,this.canvasFocused=!0,this.buttonState="down"),"mouseup"===r&&(this.buttonState="up"),a=i||!a?s:n.getFrontObject("mouse"),i&&n.frontObject?(n.triggerChain(n.getParentChain(n.frontObject,!0,!0),["mouseleave"]),n.frontObject=null):i?n.triggerHandlers(this.core.canvasElement,["mouseleave"]):n.triggerPointerEvent(this.types[r],a,"mouse",t)):(n.triggerPointerEvent(this.types.mouseup,n.frontObject,"mouse",t),n.triggerPointerEvent(this.types.mouseup,this.core.canvasElement,"mouse",t),this.canvasUpEventTriggered=!0)},docHandler:function(e){this.onCanvas(e)||(this.core.canvasElement.events.hasEntered?"mouseover"===e.type&&this.canvasHandler(e,!0):("mouseup"===e.type&&"down"===this.buttonState&&this.canvasHandler(e,!0),"mousedown"===e.type&&(this.canvasFocused=!1)))},getPos:function(e){var t=this.core.canvasElement,n=t.getBoundingClientRect();return{x:t.width/t.clientWidth*(e.pageX-i.pageXOffset-l(n.left)),y:t.height/t.clientHeight*(e.pageY-i.pageYOffset-l(n.top))}},updatePos:function(e){e=this.getPos(e),this.x=e.x,this.y=e.y},onCanvas:function(e){var t=(e=e||this.core.events.lastPointerEventObject&&this.core.events.lastPointerEventObject.originalEvent)?this.getPos(e):{x:this.x,y:this.y};return 0<=t.x&&t.x<=this.core.width&&0<=t.y&&t.y<=this.core.height?(this.canvasHovered=!0,e&&this.updatePos(e),!0):this.canvasHovered=!1},cancel:function(){this.core.events.lastDownObject=null},hide:function(){this.core.canvasElement.style.cursor="none"},show:function(){this.core.canvasElement.style.cursor=this.cursorValue},cursor:function(e){if(~e.indexOf("url(")){e=/url\((.*?)\)(\s(.*?)\s(.*?)|)($|,.*?$)/.exec(e);var t=e[5]?e[5]:"";e="url("+e[1]+") "+(e[3]?e[3]:0)+" "+(e[4]?e[4]:0)+(""===t?", default":t)}this.cursorValue=this.core.canvasElement.style.cursor=e}}},"init"),p.registerModule("touch",function(){return{x:0,y:0,touchState:"up",canvasFocused:!1,canvasHovered:!1,isTouch:"ontouchstart"in i||"createTouch"in n,dblTapInterval:500,init:function(){var e;e=this.core,e.events.addEventTypes("touch",{move:"touchmove",enter:"touchenter",leave:"touchleave",down:"touchstart",up:"touchend",singleClick:"tap",doubleClick:"dbltap"}),this.types={touchmove:"move",touchstart:"down",touchend:"up"},this.isTouch&&(e.pointer=this),this.bindHandlers()},bindHandlers:function(){var t,r,a,s;for(s in t=this,r=this.core,a=r.canvasElement,this.types){p.addDOMEventHandler(r,a,s,function(e){t.canvasHandler(e)},!1),p.addDOMEventHandler(r,n,s,function(e){t.docHandler(e)},!1);var e=null;try{e=i.parent.document}catch(e){}e&&p.addDOMEventHandler(r,e,s,function(e){t.docHandler(e)},!1)}this.core.settings.disableScrolling&&p.addDOMEventHandler(r,a,"touchmove",function(e){e.preventDefault()},!1)},canvasHandler:function(t,i){var n,a,r;n=this.core.events,a=this.onCanvas(t),"touchend"!==t.type||a||this.canvasUpEventTriggered?(i||a)&&(i||(this.canvasHovered=!0),"touchstart"===t.type&&(this.canvasUpEventTriggered=!1,this.canvasFocused=!0,this.touchState="down"),"touchend"===t.type&&(this.touchState="up"),a=i||!a?s:n.getFrontObject("touch"),i&&n.frontObject?(n.triggerChain(n.getParentChain(n.frontObject,!0,!0),["touchleave"]),n.frontObject=null):i?n.triggerHandlers(this.core.canvasElement,["touchleave"]):n.triggerPointerEvent(this.types[t.type],a,"touch",t),"touchstart"===t.type&&(r=new Date().getTime(),!this.dblTapStart||r-this.dblTapStart.timestamp>this.dblTapInterval?this.dblTapStart={timestamp:r,obj:a,count:1}:this.dblTapStart&&this.dblTapStart.count++),"touchend"===t.type&&this.dblTapStart&&2===this.dblTapStart.count&&(r=new Date().getTime(),i=a===this.dblTapStart.obj,r-=this.dblTapStart.timestamp,i&&r<this.dblTapInterval&&n.triggerPointerEvent("doubleClick",a,"touch",t),delete this.dblTapStart)):(n.triggerPointerEvent(this.types.touchend,n.frontObject,"touch",t),n.triggerPointerEvent(this.types.touchend,this.core.canvasElement,"touch",t),this.canvasUpEventTriggered=!0)},docHandler:function(e){this.onCanvas(e)||(this.core.canvasElement.events.hasEntered?"touchmove"===e.type&&this.canvasHandler(e,!0):("touchend"===e.type&&"down"===this.touchState&&this.canvasHandler(e,!0),"touchstart"===e.type&&(this.canvasFocused=!1)))},getPos:function(t){var n,r;if(r=t.changedTouches,r!==s&&0<r.length){t=r[0];var o=this.core.canvasElement;r=o.getBoundingClientRect();var e=n=1;o.clientWidth&&o.clientHeight?(n=o.width/o.clientWidth,e=o.height/o.clientHeight):i.devicePixelRatio&&(n=o.width/i.innerWidth/i.devicePixelRatio,e=o.height/i.innerHeight/i.devicePixelRatio),i.pageXOffset&&i.pageYOffset?(o=t.pageX-i.pageXOffset,t=t.pageY-i.pageYOffset):(o=t.pageX,t=t.pageY),n*=o-l(r.left),r=e*(t-l(r.top))}else n=this.x,r=this.y;return{x:n,y:r}},updatePos:function(e){e=this.getPos(e),this.x=e.x,this.y=e.y},onCanvas:function(e){var t=(e=e||this.core.events.lastPointerEventObject&&this.core.events.lastPointerEventObject.originalEvent)?this.getPos(e):{x:this.x,y:this.y};return 0<=t.x&&t.x<=this.core.width&&0<=t.y&&t.y<=this.core.height?(this.canvasHovered=!0,e&&this.updatePos(e),!0):this.canvasHovered=!1},cancel:function(){this.core.events.lastDownObject=null}}},"init"),p.registerModule("tools",function(){return{transformPointerPosition:function(i,s,a,l,e){if(l=l||0,e=e||this.core.pointer,"object"===("undefined"==typeof i?"undefined":t(i))){var d,c=i.parent,u=[],y={x:0,y:0};for(u.push(i);c&&c!==this.core;)u.push(c),c=c.parent;for(u.reverse(),c=0,d=u.length;c<d;c++)y=u[c],e=y=this.transformPointerPosition(y.rotation,y.abs_x,y.abs_y,0,e);return 0!==l&&(u=i.getOrigin(),y=this.transformPointerPosition(-1*l,s-u.x,a-u.y,0,e)),{x:y.x,y:y.y}}var g=i;i=e.x>=s&&e.y<=a;var f=e.x>=s&&e.y>=a,m=e.x<=s&&e.y>=a,y=e.x<=s&&e.y<=a,c=P(C(e.x-s,2)+C(e.y-a,2)),g=360*(g/360-Math.floor(g/360))-l;return l=0===c?0:O(e.y-a)/c,i||m?(l=(180-g-180*r(l)/x)*x/180,u=s+_(l)*c*(i?-1:1),d=a+o(l)*c*(i?-1:1)):(y||f)&&(l=(180*r(l)/x-g)*x/180,u=s+_(l)*c*(y?-1:1),d=a+o(l)*c*(y?-1:1)),{x:u,y:d}},isPointerInside:function(i,s){var a,c,e,d=Math.acos,y=i.getOrigin();if("line"===i.type){var b=O(i._.end_x-i.abs_x),h=O(i._.end_y-i.abs_y),b=P(b*b+h*h),g=i.start;return c=i.end,c=180/x*r(h/b)*(g.x<c.x&&g.y<c.y||g.x>c.x&&g.y>c.y?-1:1),h=this.transformPointerPosition(i,i.abs_x,i.abs_y,c,s),h.x>i.abs_x-b-y.x&&h.x<i.abs_x+b-y.x&&h.y>i.abs_y-i.strokeWidth/2-y.y&&h.y<i.abs_y+i.strokeWidth/2-y.y}if("text"===i.type){h=this.transformPointerPosition(i,i.abs_x,i.abs_y,0,s),g=i.strokeWidth/2,s=i._.lines,c=s.length,e=i.size*i.lineHeight;var p,n,l,u,t=i.align,f="rtl"===this.core.canvasElement.dir;for(a={top:.05*i.size,hanging:-.12*i.size,middle:-.47*i.size,alphabetic:-.78*i.size,ideographic:-.83*i.size,bottom:-1*i.size},b=0;b<c;b++)if(p={start:f?i.width-s[b].width:0,left:0,center:(i.width-s[b].width)/2,end:f?0:i.width-s[b].width,right:i.width-s[b].width},p=i.abs_x+p[t],n=p+s[b].width,l=i.abs_y+e*b+a[i.baseline],u=l+e+(0<c&&b<c-1?1:0),p=h.x>p-y.x-g&&h.x<n-y.x+g&&h.y>l-y.y-g&&h.y<u-y.y+g)return!0;return!1}if("rectangular"===i.shapeType)return h=this.transformPointerPosition(i,i.abs_x,i.abs_y,0,s),g="outside"===i.strokePosition?i.strokeWidth:"center"===i.strokePosition?i.strokeWidth/2:0,h.x>i.abs_x-y.x-g&&h.x<i.abs_x+i.width-y.x+g&&h.y>i.abs_y-y.y-g&&h.y<i.abs_y+i.height-y.y+g;if("ellipse"===i.type&&i.radius_x===i.radius_y)return h=this.transformPointerPosition(i,i.abs_x,i.abs_y,0,s),b=P(C(h.x-i.abs_x+y.x,2)+C(h.y-i.abs_y+y.y,2)),b<i.radius_x+i.strokeWidth/2;if("ellipse"===i.type)return h=this.transformPointerPosition(i,i.abs_x,i.abs_y,0,s),s=i.radius_x+i.strokeWidth/2,b=i.radius_y+i.strokeWidth/2,h.x-=i.abs_x-y.x,h.y-=i.abs_y-y.y,1>h.x*h.x/(s*s)+h.y*h.y/(b*b);if("polygon"===i.type){for(h=this.transformPointerPosition(i,i.abs_x,i.abs_y,0,s),g=i.radius+i.strokeWidth/2,t=i.sides,a=t-1,f=!1,b=0;b<t;b++)c=i.abs_x-y.x+g*_(2*b*x/t),e=i.abs_y-y.y+g*o(2*b*x/t),s=i.abs_x-y.x+g*_(2*a*x/t),a=i.abs_y-y.y+g*o(2*a*x/t),(e<h.y&&a>=h.y||a<h.y&&e>=h.y)&&c+(h.y-e)/(a-e)*(s-c)<h.x&&(f=!f),a=b;return f}if("arc"===i.type){if(h=i.end-i.start,c="clockwise"===i.direction?(0>h?360:0)+(h%360?h%360:0<h?360:0):O(h),h="clockwise"===i.direction?-1*i.start:-1*i.end,h=this.transformPointerPosition(i,i.abs_x,i.abs_y,h,s),b=P(C(h.x-i.abs_x+y.x,2)+C(h.y-i.abs_y+y.y,2)),g=i.radius,0===i.strokeWidth&&b>g||0<i.strokeWidth&&b>g+i.strokeWidth/2)return!1;if(g===i.strokeWidth/2||i.pieSection){if(e=i.pieSection?i.radius:e,180<c)return g=O(i.abs_x-y.x-h.x),t=O(i.abs_y-y.y-h.y),t=P(g*g+t*t),g=180*d(g/t)/x,h.y>=i.abs_y-y.y&&b<=e||h.y<i.abs_y-y.y&&h.x<i.abs_x-y.x&&g<=c-180;if(180===c)return h.y>=i.abs_y-y.y&&b<=e;if(180>c)return h=90-c/2-("clockwise"===i.direction?i.start:i.end),h=this.transformPointerPosition(i,i.abs_x,i.abs_y,h,s),s=2*_(c/2*x/180)*g,g=O(i.abs_x-y.x-h.x),t=O(i.abs_y-y.y-h.y),t=P(g*g+t*t),g=180*r(g/t)/x,!!(h.y>=i.abs_y-y.y+s)||h.y>=i.abs_y-y.y&&g<=c/2}else{if(180<c){if(s=(360-c)/2,e=_(s*x/180)*g,c=i.abs_x-y.x+_(s*x/180)*e,e=i.abs_y-y.y-o(s*x/180)*e,f=180-2*s,t=i.abs_x-y.x-_(f*x/180)*g,h.y<e&&h.x<c)c=s-180*d(O(h.y-e)/P(C(h.x-c,2)+C(h.y-e,2)))/x;else if(h.y>e&&h.x>=c)c=90-(90-f)-(90-s)-180*d(O(h.x-c)/P(C(h.x-c,2)+C(h.y-e,2)))/x;else{if(h.y<i.abs_y-y.y&&h.x>=c)return!1;c=-1E6}return(""===i.fill||"transparent"===i.fill)&&0<i.strokeWidth&&b<g-i.strokeWidth/2?!1:0>=c&&h.x>=t&&h.y>e&&h.y<i.abs_y-y.y||0>=c&&h.y<=i.abs_y-y.y&&b<=g||(0===i.strokeWidth&&b<=g||0<i.strokeWidth&&b<=g+i.strokeWidth/2)&&(h.x<=t&&h.y<=i.abs_y-y.y||h.y>=i.abs_y-y.y)}if(180===c)return h.y>=i.abs_y-y.y&&(0===i.strokeWidth&&b<=g||0<i.strokeWidth&&b<=g+i.strokeWidth/2);if(180>c)return h=90-c/2-("clockwise"===i.direction?i.start:i.end),h=this.transformPointerPosition(i,i.abs_x,i.abs_y,h,s),s=_(c/2*x/180)*(""===i.fill?g-i.strokeWidth/2:g),""===i.fill&&0<i.strokeWidth?h.y>=i.abs_y-y.y+s&&b>=g-i.strokeWidth/2&&b<=g+i.strokeWidth/2:!!(h.y>=i.abs_y-y.y+s)&&(!(0<i.strokeWidth)||!!(b<=g+i.strokeWidth/2))}}else if("radial"===i.shapeType&&(g=i.radius?i.radius:0,0<g))return h=this.transformPointerPosition(i,i.abs_x,i.abs_y,0,s),y=i.getOrigin(),b=P(C(h.x-i.abs_x+y.x,2)+C(h.y-i.abs_y+y.y,2)),b<g}}}),p.registerModule("events",function(){return{enabled:!0,eventTypes:{},init:function(){this.core.canvasElement.events={}},addEventTypes:function(e,t){for(var i in this.eventTypes[e]=this.eventTypes[e]||[],e=this.eventTypes[e],t)e[i]=e[i]||[],e[i].push(t[i])},bind:function(t,i,n){for(var a=0;a<i.length;a++)t.events[i[a]]=t.events[i[a]]||[],t.events[i[a]].push(n)},unbind:function(t,i,n){var a,e,r;for(a=0;a<i.length;a++)e=t.events[i[a]],e!==s&&(n===s?delete t.events[i[a]]:(r=e.indexOf(n),~r&&e.splice(r,1)))},findFrontObject:function(t,i){var n,a,e;if(0===t.length)return!1;for(n=t.length;n--&&!!(a=t[n],e=this.findFrontObject(a.children,i),!1===e);)if(a.pointerEvents&&a.isPointerInside(i)){e=a;break}return e},getFrontObject:function(e){return this.findFrontObject(this.core.children,this.core[e])||s},triggerPointerEvent:function(t,i,n,r){if(this.enabled){var e,s,o,d,c,g,h;if(e=this.core.canvasElement,s=this.eventTypes[n],o=s.enter,d=s.leave,c=s[t],s=s.singleClick,this.lastPointerEventObject=this.fixEventObject(r,n),!i)this.frontObject?(r=this.getParentChain(this.frontObject,!1,!0),this.triggerChain(r,d),this.frontObject=null):e.events.hasEntered||this.triggerHandlers(e,o),i=this.core.canvasElement;else if(i!==this.frontObject){if(this.frontObject&&(n=this.getParentChain(i),!~n.indexOf(this.frontObject)))if(this.triggerHandlers(this.frontObject,d),n=this.getParentChain(this.frontObject),~n.indexOf(i)){for(r=[],g=0,h=n.length;g<h&&n[g]!==i;g++)r.push(n[g]);this.triggerChain(r,d)}else this.triggerChain(n,d);this.frontObject=i,(i.parent||e).events.hasEntered||(n=this.findNonEnteredParentChain(i),this.triggerChain(n,o)),i.events.hasEntered||this.triggerHandlers(i,o)}"down"===t&&(this.lastDownObject=i),r=this.getParentChain(i,!0,!0),this.triggerChain(r,c),"up"===t&&(i===this.lastDownObject?this.triggerChain(r,s):(t=this.getSharedParent(i,this.lastDownObject))&&(r=this.getParentChain(t,!0,!0),this.triggerChain(r,s)),this.lastDownObject=null)}},getSharedParent:function(e,t){var i;for(e=this.getParentChain(e,!0,!0),i=this.core.canvasElement;t&&!~e.indexOf(t);)t=t.parent||(t===i?s:i);return t},findNonEnteredParentChain:function(e){var t,i;for(t=[],i=this.core.canvasElement,e=e.parent;e&&!e.events.hasEntered;)t.push(e),e=e.parent;return e||i.events.hasEntered||t.push(i),t.reverse()},getParentChain:function(t,i,n){var a;for(a=[],n&&a.push(t),n=t.parent;n;)a.push(n),n=n.parent;return i&&t!==this.core.canvasElement&&a.push(this.core.canvasElement),a},triggerChain:function(t,i,n){var a,e,r;for(a=0,e=t.length;a<e&&(r=this.triggerHandlers(t[a],i,n),r);a++);},triggerHandlers:function(t,i,n){var a,e,r,s,o,d=t===this.core.canvasElement?this.core:t;for(a=0;a<i.length;a++)if(e=t.events[i[a]],r=!!~i[a].indexOf("enter"),s=!!~i[a].indexOf("leave"),o=n||(~i[a].indexOf("key")?this.lastKeyboardEventObject:this.lastPointerEventObject),o.type=i[a],o.bubbles=r||s?!1:!0,r&&!t.events.hasEntered?t.events.hasEntered=!0:s&&t.events.hasEntered&&(t.events.hasEntered=!1),e){for(r=e.length,s=0;s<r;s++)"function"==typeof e[s]&&e[s].call(d,o);if(o.stoppingPropagation)return o.stoppingPropagation=!1}return!0},fixEventObject:function(t,i){var n,a,r,o=["altKey","ctrlKey","metaKey","shiftKey","button","charCode","keyCode","clientX","clientY","pageX","pageY","screenX","screenY","detail","eventPhase","isChar","touches","targetTouches","changedTouches","scale","rotation"],d=o.length;if(n={originalEvent:t,timeStamp:new Date().getTime(),which:t===s?0:0===t.which?t.keyCode:t.which,preventDefault:function(){t!==s&&t.preventDefault()},stopPropagation:function(){this.bubbles&&(this.stoppingPropagation=!0),t!==s&&t.stopPropagation()}},t===s)return n;for(a=0;a<d;a++)r=o[a],t[r]!==s&&(n[r]=t[r]);return~"mouse touch".indexOf(i)&&(n.x=this.core[i].x,n.y=this.core[i].y),"mouse"===i&&(o={0:1,1:3,2:2,default:0},n.which=o[n.button]||o["default"]),"touch"===i&&(n.which=0),n}}},"init"),p.registerModule("draw",function(){return{objects:[],translation:{x:0,y:0},changeZorder:function(t,i,n){var a,r,o=t.children,e=o[i];e!==s&&i!==n&&(n>o.length-1&&(n=o.length-1),0>n&&(n=0),n>i?(a=o.slice(0,i),r=o.slice(n+1,o.length),i=o.slice(i,n+1),i.shift(),i.push(e)):(a=o.slice(0,n),r=o.slice(i+1,o.length),i=o.slice(n,i+1),i.pop(),i.unshift(e)),t.children=a.concat(i).concat(r))},clear:function(e){return this.core.canvas.clearRect(0,0,this.core.width*i.devicePixelRatio,this.core.height*i.devicePixelRatio),!1!==e&&this.core.background.redraw(),this.isCleared=!0,this},redraw:function(e){return(this.core.settings.clearEachFrame||e)&&this.clear(),this.isCleared=!1,this.drawObjects(this.core.children),this},drawObjects:function(t){var n,r,e,o,d,l,c=this.core.canvas;for(n=0,r=t.length;n<r;n++)if(e=t[n],e!==s&&"function"==typeof e.draw){for(c.strokeStyle="#000",c.fillStyle="#000",c.globalAlpha=1,c.lineWidth=1,c.lineCap="butt",c.lineJoin="miter",c.miterLimit=10,c.lineDashOffset=0,c.shadowOffsetX=0,c.shadowOffsetY=0,c.shadowBlur=0,c.shadowColor="rgba(0, 0, 0, 0)",c.globalCompositeOperation="source-over",c.font="10px sans-serif",c.textAlign="start",c.textBaseline="alphabetic",c.direction="inherit",c.imageSmoothingEnabled=!0,"function"==typeof e.update&&e.update(),c.save(),c.translate(e.x*i.devicePixelRatio,e.y*i.devicePixelRatio),0!==e.rotation&&c.rotate(e.rotation*x/180),1===e.scalingX&&1===e.scalingY||c.scale(e.scalingX,e.scalingY),l=e.opacity,o=e.parent;o&&o!==this.core;)l*=o.opacity,o=o.parent;this.translation={x:e.abs_x,y:e.abs_y},o=e.abs_x,d=e.abs_y,e._.abs_x=0,e._.abs_y=0,c.globalAlpha=isNaN(parseFloat(l))?1:parseFloat(l),c.globalCompositeOperation=e.composition,l=e.shadow,0<l.blur&&(c.shadowOffsetX=l.offsetX,c.shadowOffsetY=l.offsetY,c.shadowBlur=l.blur,c.shadowColor=l.color),c.lineCap=e.cap,c.lineJoin=e.join,c.miterLimit=e.miterLimit,e.draw(),e.drawn=!0,e._.abs_x=o,e._.abs_y=d,0<e.children.length&&this.drawObjects(e.children),c.restore(),this.translation={x:0,y:0}}}}}),p.registerModule("background",function(){return{bg:"",value:"",type:"transparent",loaded:!1,init:function(){this.set(this.core.settings.background)},set:function(t){var i=this;if("string"!=typeof t&&(t=""),this.value=t,this.type=~t.indexOf("gradient")?"gradient":~t.indexOf("image")?"image":this.core.style&&this.core.style.isColor(t)?"color":"transparent","color"===this.type)this.bg=t,this.core.timeline&&!this.core.timeline.running&&this.core.draw.redraw(!0),this.loaded=!0;else if("gradient"===this.type)this.bg=this.core.style?this.core.style.getGradient(t,0,0,this.core.width,this.core.height):"",this.core.timeline&&!this.core.timeline.running&&this.core.draw.redraw(!0),this.loaded=!0;else if("image"===this.type){var n=/image\((.*?)(,(\s|)(repeat|repeat-x|repeat-y|no-repeat)|)\)/.exec(t);t=n[1];var a=n[4]||"repeat",n=new Image;n.src=t,n.onload=function(){i.bg=i.core.canvas.createPattern(this,a),i.loaded=!0,i.core.timeline&&!i.core.timeline.running&&i.core.redraw(!0)}}else this.redraw(!0),this.loaded=!0;return this},redraw:function(){var e=this.core;"transparent"!==this.type&&(e.canvas.fillStyle=this.bg,e.canvas.fillRect(0,0,e.width*i.devicePixelRatio,e.height*i.devicePixelRatio))}}},"init"),p.registerModule("scenes",function(){return{current:"none",scenes:{},create:function(e,t){return this.scenes[e]=Object.create(this.scenesBase()),this.scenes[e].name=e,t.call(this.scenes[e]),this.scenes[e]},scenesBase:function(){return{name:"",objects:[],loaded:!1,add:function(e){return this.objects.push(e),this.loaded&&e.add(),this},remove:function(e){var t=this.objects.indexOf(e);return~t&&(this.objects.splice(t,1),this.loaded&&e.remove()),this},load:function(){if(!this.loaded){var e,t=this.objects,i=t.length;for(e=0;e<i;e++)t[e]!==s&&t[e].add(!1);return this.loaded=!0,this}},unload:function(){var e,t=this.objects,i=t.length;for(e=0;e<i;e++)t[e]!==s&&t[e].remove(!1);return this.loaded=!1,this}}},load:function(e,t){return!0===t&&"none"!==this.current&&this.unload(this.current),this.current=e,this.scenes[e].load(),this.core.draw.redraw(),this},unload:function(e){return this.current="none",this.scenes[e].unload(),this.core.draw.redraw(),this}}}),p.registerModule("style",function(){return{getStroke:function(i,n){if(n="string"===n?"string":"object","object"===("undefined"==typeof i?"undefined":t(i))&&"string"===n){var a=i;i="string"==typeof a.pos?a.pos:"center",i+=" "+("number"==typeof a.width?a.width+"px":"1px"),i+=" "+("string"==typeof a.color?a.color:"#000000")}i=i.split(" ");for(var r,o,a=0,d=i.length;a<d;a++)!r&&-1<i[a].indexOf("(")&&(r=a),-1<i[a].indexOf(")")&&(o=a);if((a=o?i.splice(r,o-r+1):s)&&i.push(a.join(" ")),a=["outside","center","inside"],r="",o=i.length,3<=o)if(~a.indexOf(i[0])){if(3<o){for(a=2;a<o;a++)r+=i[a]+(a===o-1?" ":"");i=[i[0],i[1],r]}i={pos:i[0],width:parseFloat(i[1]),color:i[2]}}else{for(a=(d=isNaN(parseInt(i[0])))?0:1;a<o;a++)r+=i[a]+(a===o-1?" ":"");i=d?[1,r]:[i[0],r],o=2}return 2===o&&(i={pos:"center",width:parseFloat(i[0]),color:i[1]}),i.length&&(i={pos:"center",width:0,color:""}),"string"===n?i.pos+" "+i.width+"px "+i.color:"object"===n?i:void 0},getGradient:function(t,i,n,a,e){return~t.indexOf("linear")?this.getLinearGradient(t,i,n,a,e):~t.indexOf("radial")?this.getRadialGradient(t,i,n,a,e):"transparent"},getLinearGradient:function(i,s,a,c,e){var d,p,h,b,m,l,n,u=[],g=["top","bottom","left","right"],f=[];for(i=/\((.*)\)/.exec(i)[1];p=/((hsl|hsla|rgb|rgba)\(.*?\))/.exec(i);)n=f.push(p[1])-1,i=i.substring(0,p.index)+"###"+n+"###"+i.substring(p.index+p[1].length,i.length);if(i=i.split(","),p=i[0].split(" "),(~g.indexOf(p[0])||~p[0].indexOf("deg"))&&u.push(p[0]),1<p.length&&~g.indexOf(p[1])&&u.push(p[1]),0===u.length?u.push("top"):h=1,1!==u.length)~u.indexOf("top")&&~u.indexOf("left")?(d=s,b=a,m=s+c,l=a+e):~u.indexOf("top")&&~u.indexOf("right")?(d=s+c,b=a,m=s,l=a+e):~u.indexOf("bottom")&&~u.indexOf("left")?(d=s,b=a+e,m=s+c,l=a):~u.indexOf("bottom")&&~u.indexOf("right")&&(d=s+c,b=a+e,m=s,l=a);else if("top"===u[0])d=s+c/2,b=a,m=s+c/2,l=a+e;else if("right"===u[0])d=s+c,b=a+e/2,m=s,l=a+e/2;else if("bottom"===u[0])d=s+c/2,b=a+e,m=s+c/2,l=a;else if("left"===u[0])d=s,b=a+e/2,m=s+c,l=a+e/2;else if(~u[0].indexOf("deg")){var t,v,r,y,g=x;p=s+c/2,n=a+e/2,t=u=parseFloat(u)%360*g/180,0<=u&&u<g/2?(v=s+c,r=a):u>=g/2&&u<g?(y=n,n=p,r=s,v=y,p=a):u>=g&&u<1.5*g?(y=n,v=p,p=s,n=a+e,r=y):u>=1.5*g&&u<2*g&&(y=n,n=s+c,r=p,v=a+e,p=y),u%=g/2,s=P(C(n-r,2)+C(p-v,2))*_(Math.atan(O(n-r)/O(v-p))-u),0<=t&&t<g/2?(m=p+s*_(u),l=n-s*o(u),d=2*p-m,b=2*n-l):t>=g/2&&t<g?(m=n-s*_(g/2-u),l=v-s*o(g/2-u),d=2*n-m,b=2*v-l):t>=g&&t<1.5*g?(m=v+s*_(g-u),l=r+s*o(g-u),d=2*v-m,b=2*r-l):t>=1.5*g&&t<2*g&&(m=r-s*_(1.5*g-u),l=p-s*o(1.5*g-u),d=2*r-m,b=2*p-l)}for(d=this.core.canvas.createLinearGradient(d,b,m,l),h=this.getColorStops(d,i.slice(h),f),f=0;f<h.length;f++)d.addColorStop(h[f].pos/100,h[f].color);return d},getRadialGradient:function(i,o,p,y,e){var d,_,n,b,t=Math.min,x=["left","center","right"],h=["top","center","bottom"],f={left:o,center:o+y/2,right:o+y},k={top:p,center:p+e/2,bottom:p+e},l=["closest-side","closest-corner","farthest-side","farthest-corner","contain","cover"],r=[];b=0,d=[{x:s,y:s,r:0},{x:s,y:s,r:s}];var u,v=!1;for(i=/\((.*)\)/.exec(i)[1];_=/((hsl|hsla|rgb|rgba)\(.*?\))/.exec(i);)n=r.push(_[1])-1,i=i.substring(0,_.index)+"###"+n+"###"+i.substring(_.index+_[1].length,i.length);for(i=i.split(/\s*,\s*/),_=0;2>_;_++)~i[_].indexOf(" ")?(n=i[_].split(" "),"center"===n[0]?(d[_].x=n[0],d[_].y=n[1],b=_+1):~x.indexOf(n[0])?(d[_].x=n[0],b=_+1,~h.indexOf(n[1])&&(d[_].y=n[1])):~h.indexOf(n[0])?(d[_].y=n[0],b=_+1,~x.indexOf(n[1])&&(d[_].x=n[1])):isNaN(parseFloat(n[0]))||(d[_].x=n[0],b=_+1,!~h.indexOf(n[1])&&isNaN(parseFloat(n[1])))||(d[_].y=n[1]),d[_].x||(d[_].x="center"),d[_].y||(d[_].y="center")):(~x.indexOf(i[_])?(d[_].x=i[_],b=_+1):~h.indexOf(i[_])?(d[_].y=i[_],b=_+1):d[_].x=1===_?d[0].x:"center",d[_].y=1===_?d[0].y:"center");for(~l.indexOf(i[b])&&(u=i[b],v=!0),/\d+(%|px)\s/.test(i[b])&&(u=parseFloat(i[b]),v=!0,isNaN(u)&&(u=0)),u===s&&(u="cover"),_=0;2>_;_++)for(d[_].abs_x=f[d[_].x],d[_].abs_y=k[d[_].y],x=0;2>x;x++)h="abs_"+(0===x?"x":"y"),d[_][h]===s&&(d[_][h]=parseFloat(d[_]["abs_x"===h?"x":"y"]),isNaN(d[_][h])&&(d[_][h]="abs_x"===h?f.center-o:k.center-p),~d[_]["abs_x"===h?"x":"y"].indexOf("%")&&(d[_][h]=d[_][h]/100*("abs_x"===h?y:e)),d[_][h]+="abs_x"===h?o:p);for(~l.indexOf(u)&&(u="closest-side"===u||"contain"===u?t(O(d[1].abs_y-p),O(p+e-d[1].abs_y),O(d[1].abs_x-o),O(o+y-d[1].abs_y)):"closest-corner"===u?t(P(C(d[1].abs_x-o,2)+C(d[1].abs_y-p,2)),P(C(o+y-d[1].abs_x,2)+C(d[1].abs_y-p,2)),P(C(o+y-d[1].abs_x,2)+C(p+e-d[1].abs_y,2)),P(C(d[1].abs_x-o,2)+C(p+e-d[1].abs_y,2))):"farthest-corner"===u||"cover"===u?g(P(C(d[1].abs_x-o,2)+C(d[1].abs_y-p,2)),P(C(o+y-d[1].abs_x,2)+C(d[1].abs_y-p,2)),P(C(o+y-d[1].abs_x,2)+C(p+e-d[1].abs_y,2)),P(C(d[1].abs_x-o,2)+C(p+e-d[1].abs_y,2))):"farthest-side"===u?g(O(d[1].abs_y-p),O(p+e-d[1].abs_y),O(d[1].abs_x-o),O(o+y-d[1].abs_y)):0),~i[b].indexOf("%")&&(o=~i[b].indexOf(" ")?"height"===i[b].split(" ")[1]?e:y:y,u=u/100*o),d[1].r=u,d=this.core.canvas.createRadialGradient(d[0].abs_x,d[0].abs_y,d[0].r,d[1].abs_x,d[1].abs_y,d[1].r),r=this.getColorStops(d,i.slice(b+(v?1:0)),r),b=0;b<r.length;b++)d.addColorStop(r[b].pos/100,r[b].color);return d},getColorStops:function(t,i,n){var a,r,o=i.length,e=[];for(t=0;t<o&&(a=i[t].trim(),!(100<=r));t++)~a.indexOf(" ")?(r=a.split(" "),a=r[0],r=r[1],r=~r.indexOf("px")?100*(parseFloat(r)/P(C(eX-sX,2)+C(eY-sY,2))):parseFloat(r)):r===s?r=0:(r=r||0,r+=(100-r)/(o-t)),~a.indexOf("###")&&(a=n[/###(\d+)###/.exec(a)[1]]),e.push({pos:r,color:a});return e},getFont:function(i,n){if(n="string"===n?"string":"object","object"===("undefined"==typeof i?"undefined":t(i))&&"string"===n){var a=i;i="string"==typeof a.style?a.style:"normal",i+=" "+("string"==typeof a.variant?a.variant:"normal"),i+=" "+("string"==typeof a.weight?a.weight:"normal"),i+=" "+("number"==typeof a.size?~~(10*a.size+.5)/10+"px":"16px"),i+="/"+("number"==typeof a.lineHeight?~~(10*a.lineHeight+.5)/10:"string"==typeof a.lineHeight?-1<a.lineHeight.indexOf("px")?a.lineHeight:1:1),i+=" "+("string"==typeof a.family?a.family:"sans-serif")}if(0<i.length){var r,o,a=i.split(" "),d=a.length,e=["normal","italic","oblique"],c=["normal","small-caps"],g=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"],h={};for(r=0;r<d;r++)if(i=a[r],~e.indexOf(i)&&!h.style)h.style=i;else if(~c.indexOf(i)&&!h.variant)h.variant=i;else if(~g.indexOf(i)&&!h.weight)h.weight=i;else if(~i.indexOf("/")&&!h.size&&!h.lineHeight)i=i.split("/"),isNaN(parseInt(i[0]))||(h.size=parseInt(i[0])),isNaN(parseFloat(i[1]))||(h.lineHeight=parseFloat(i[1]),h.lineHeightUnit=-1<i[1].indexOf("px")?"px":"relative");else if(!h.size&&/\d+[a-z]{2}(?!\/)/.test(i))isNaN(parseInt(i))||(h.size=parseInt(i));else if(isNaN(parseInt(i))&&!h.family){for(o="",i=r;i<d;i++)o+=a[i]+(i===d-1?"":" ");h.family=o}}return a=h,a.style=a.style?a.style:"normal",a.variant=a.variant?a.variant:"normal",a.weight=a.weight?a.weight:"normal",a.size=a.size===s?16:a.size,a.lineHeight=a.lineHeight===s?1:a.lineHeight,a.lineHeightUnit=a.lineHeightUnit===s?"relative":a.lineHeightUnit,a.family=a.family?a.family:"sans-serif","string"===n?a.style+" "+a.variant+" "+a.weight+" "+a.size+"px/"+a.lineHeight+("px"===a.lineHeightUnit?"px":"")+" "+a.family:"object"===n?a:void 0},getShadow:function(e,i){var n={};return"object"===("undefined"==typeof e?"undefined":t(e))?(n.offsetX=isNaN(parseFloat(e.offsetX))?0:parseFloat(e.offsetX),n.offsetY=isNaN(parseFloat(e.offsetY))?0:parseFloat(e.offsetY),n.blur=isNaN(parseFloat(e.blur))?0:parseFloat(e.blur),n.color=this.isColor(e.color)?e.color:"#000"):"string"==typeof e&&(e=/^(.*?)\s(.*?)\s(.*?)\s(.*?)$/.exec(e),n.offsetX=isNaN(parseFloat(e[1]))?0:parseFloat(e[1]),n.offsetY=isNaN(parseFloat(e[2]))?0:parseFloat(e[2]),n.blur=isNaN(parseFloat(e[3]))?0:parseFloat(e[3]),n.color=this.isColor(e[4])?e[4]:"#000"),"string"===i?n.offsetX+"px "+n.offsetY+"px "+n.blur+"px "+n.color:n},isColor:function(e){return"string"!=typeof e||"#"!==e[0]&&"rgb("!==e.substr(0,4)&&"rgba("!==e.substr(0,5)&&"hsl("!==e.substr(0,4)&&"hsla("!==e.substr(0,5)?!1:!0}}}),i.logs=[],p.registerModule("animation",function(){var i={durations:{short:500,normal:1E3,long:2E3},defaults:{duration:"normal",easing:"ease-in-out"},animate:function(e,t){console.log("55555555555555555");var i=this.parseArguments(t);t=i.properties;var i=i.options,n=this.queues.create(e,i.queue);n.add({obj:e,properties:t,startValues:{},diffValues:{},options:{queue:n,duration:i.duration,easing:i.easing,callback:i.callback}}),n.run()},parseArguments:function(e){e=Array.prototype.slice.call(e),e[1]=e[1]||{};var i;return"object"===t(e[1])?(i=e[0],e=p.extend({duration:this.defaults.duration,easing:this.defaults.easing,queue:"default",callback:function(){}},e[1]),e.easing=this.parseEasingOption(e.easing),e.duration=this.parseDurationOption(e.duration)):(i=e.shift(),e=this.getAnimateArguments(e)),{properties:i,options:e}},parseEasingOption:function(e){return"string"==typeof e?~e.indexOf("cubic-bezier")?this.getCustomCubicBezier(e)||this.easing[this.defaults.easing]:this.easing[e]||this.easing[this.defaults.easing]:"function"==typeof e?e:this.easing[this.defaults.easing]},parseDurationOption:function(e){var t=i.durations;return"string"==typeof e?t[e]||t[i.defaults.duration]:e},runAnimation:function(e,t){var i;i=e.obj,e.advanceCallback=t,this.mainTimer.add(e),t=this.parseProperties(e.properties,i),e.properties=t.properties,e.startValues=t.startValues,e.diffValues=t.diffValues,e.startTime=new Date().getTime()},parseProperties:function(e,i){var n,r={},s={};for(n in e)if(p.isNumber(e[n]))r[n]=i[n]||0,s[n]=e[n]-(i[n]||0);else if("object"===t(e[n])){var o=this.parseProperties(e[n],i[n]);r[n]=o.startValues,s[n]=o.diffValues}else delete e[n];return{properties:e,startValues:r,diffValues:s}},tick:function(e){var t,i,n,a;if(t=new Date().getTime()-e.startTime,i=t/e.options.duration,1<i)return this.setEndValues(e),!1;for(a in t=1===e.options.easing.length?e.options.easing.call(this.easing,i):e.options.easing.call(this.easing,t,0,1,e.options.duration),i=e.startValues,n=e.diffValues,n)this.setObjectProperty(e.obj,a,i[a],n[a],t);return!0},setObjectProperty:function(e,t,i,n,a){if(p.isNumber(i))e[t]=i+n*a;else for(var r in i)this.setObjectProperty(e[t],r,i[r],n[r],a)},setEndValues:function(e){var t,i=e.obj,n=e.startValues,a=e.diffValues;for(t in e.properties)this.setObjectProperty(i,t,n[t],a[t],1);this.core.timeline.running||this.core.draw.redraw(!0)},getAnimateArguments:function(e){var t,i,n,a;return"number"==typeof e[0]?t=e[0]:"string"==typeof e[0]?e[0]in this.durations?t=this.durations[e[0]]:e[0]in this.easing&&(i=this.easing[e[0]]):"boolean"==typeof e[0]?n=e[0]:"function"==typeof e[0]&&"function"==typeof e[1]&&(i=e[0],a=e[1]),"string"==typeof e[1]?i=this.easing[e[1]]:"function"==typeof e[1]&&(e[2]===s?a=e[1]:i=e[1]),e[2]!==s&&("function"==typeof e[2]?a=e[2]:n=!!e[2]),e[3]!==s&&(a=e[3]),i||(i="string"==typeof e[0]?e[0]:"",i=~i.indexOf("cubic-bezier")?i:s,i||(i="string"==typeof e[1]?e[1]:"",i=~i.indexOf("cubic-bezier")?i:s),i&&(i=this.getCustomCubicBezier(i))),t=t||this.durations[this.defaults.duration],i=i||this.easing[this.defaults.easing],n=n!==s&&n,{duration:t,easing:i,queue:n?s:"default",callback:a||function(){}}},getCustomCubicBezier:function(e){var t,i,n,r;if(e=e.match(/cubic-bezier\(\s*(.*?),\s*(.*?),\s*(.*?),\s*(.*?)\)/))return t=isNaN(parseFloat(e[1]))?0:parseFloat(e[1]),i=isNaN(parseFloat(e[2]))?0:parseFloat(e[2]),n=isNaN(parseFloat(e[3]))?1:parseFloat(e[3]),r=isNaN(parseFloat(e[4]))?1:parseFloat(e[4]),function(e){return this.cubicBezier(t,i,n,r,e)}},stop:function(e){for(var t in e.animationQueues)e.animationQueues[t].clear(!1)},finish:function(e){for(var t in e.animationQueues)e.animationQueues[t].clear(!0)},delay:function(e,t,i){(e=e.animationQueues[i&&i.queue||"default"])&&e.add({type:"delay",duration:t||0})},mainTimer:{animations:[],add:function(e){this.animations.push(e),1===this.animations.length&&this.start()},remove:function(e){this.animations.splice(this.animations.indexOf(e),1),0===this.animations.length&&this.stop()},start:function(){this.tick()},stop:function(){cancelAnimationFrame(this.timer)},tick:function(){var t=this;setTimeout(function(){t.timer=requestAnimationFrame(function(){t.tick()});for(var n,e=t.animations,a=0,r=e.length;a<r;a++)n=e[a],n.cancelled||i.tick(n)||(i.mainTimer.remove(n),a--,r--,n.advanceCallback(),n.options.callback.call(n.obj));i.core.timeline.running||i.core.draw.redraw(!0)},1E3/i.core.settings.fps)}},queues:{create:function(e,t){return t===s&&(t=l(new Date().getTime()*Math.random()).toString()),e.animationQueues[t]||(e.animationQueues[t]={name:t,list:[],isRunning:!1,add:function(e){this.list.push(e)},remove:function(e){e?(e=this.list.indexOf(e),~e&&this.list.splice(e,1)):this.list.shift()},run:function(){if(!this.isRunning&&0<this.list.length){this.isRunning=!0;var e=this.list[0],t=this;"delay"===e.type?setTimeout(function(){t.advance()},e.duration):i.runAnimation(e,function(){t.advance()})}},advance:function(){this.list.shift(),this.isRunning=!1,this.run()},clear:function(e){if(this.isRunning){var t=this.list[0];t.cancelled=!0,e&&(i.setEndValues(t),t.options.callback.call(t.obj)),this.isRunning=!1,i.mainTimer.remove(t)}this.list.length=0}}),this.get(e,t)},get:function(e,t){return e.animationQueues[t]}},easing:{"ease-in":function(e){return this.cubicBezier(.42,0,1,1,e)},"ease-out":function(e){return this.cubicBezier(0,0,.58,1,e)},"ease-in-out":function(e){return this.cubicBezier(.42,0,.58,1,e)},linear:function(e){return e},"ease-in-quad":function(e,t,i,n){return i*(e/=n)*e+t},"ease-out-quad":function(e,t,i,n){return-i*(e/=n)*(e-2)+t},"ease-in-out-quad":function(e,t,i,n){return 1>(e/=n/2)?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},"ease-in-cubic":function(e,t,i,n){return i*(e/=n)*e*e+t},"ease-out-cubic":function(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t},"ease-in-out-cubic":function(e,t,i,n){return 1>(e/=n/2)?i/2*e*e*e+t:i/2*((e-=2)*e*e+2)+t},"ease-in-quart":function(e,t,i,n){return i*(e/=n)*e*e*e+t},"ease-out-quart":function(e,t,i,n){return-i*((e=e/n-1)*e*e*e-1)+t},"ease-in-out-quart":function(e,t,i,n){return 1>(e/=n/2)?i/2*e*e*e*e+t:-i/2*((e-=2)*e*e*e-2)+t},"ease-in-quint":function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},"ease-out-quint":function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},"ease-in-out-quint":function(e,t,i,n){return 1>(e/=n/2)?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},"ease-in-sine":function(e,t,i,n){return-i*_(e/n*(x/2))+i+t},"ease-out-sine":function(e,t,i,n){return i*o(e/n*(x/2))+t},"ease-in-out-sine":function(e,t,i,n){return-i/2*(_(x*e/n)-1)+t},"ease-in-expo":function(e,t,i,n){return 0==e?t:i*C(2,10*(e/n-1))+t},"ease-out-expo":function(e,t,i,n){return e==n?t+i:i*(-C(2,-10*e/n)+1)+t},"ease-in-out-expo":function(e,t,i,n){return 0==e?t:e==n?t+i:1>(e/=n/2)?i/2*C(2,10*(e-1))+t:i/2*(-C(2,-10*--e)+2)+t},"ease-in-circ":function(e,t,i,n){return-i*(P(1-(e/=n)*e)-1)+t},"ease-out-circ":function(e,t,i,n){return i*P(1-(e=e/n-1)*e)+t},"ease-in-out-circ":function(e,t,i,n){return 1>(e/=n/2)?-i/2*(P(1-e*e)-1)+t:i/2*(P(1-(e-=2)*e)+1)+t},"ease-in-elastic":function(e,t,i,n,a,s){return(a=a||0,0==e)?t:1==(e/=n)?t+i:(s||(s=.3*n),a<O(i)?(a=i,i=s/4):i=s/(2*x)*r(i/a),-(a*C(2,10*--e)*o(2*(e*n-i)*x/s))+t)},"ease-out-elastic":function(t,i,n,e,a,s){if(a=a||0,0==t)return i;if(1==(t/=e))return i+n;if(s||(s=.3*e),a<O(n)){a=n;var d=s/4}else d=s/(2*x)*r(n/a);return a*C(2,-10*t)*o(2*(t*e-d)*x/s)+n+i},"ease-in-out-elastic":function(t,i,n,e,a,s){if(a=a||0,0==t)return i;if(2==(t/=e/2))return i+n;if(s||(s=1.5*(.3*e)),a<O(n)){a=n;var d=s/4}else d=s/(2*x)*r(n/a);return 1>t?-.5*a*C(2,10*--t)*o(2*(t*e-d)*x/s)+i:.5*(a*C(2,-10*--t)*o(2*(t*e-d)*x/s))+n+i},"ease-in-back":function(t,i,n,e,a){return a==s&&(a=1.70158),n*(t/=e)*t*((a+1)*t-a)+i},"ease-out-back":function(t,i,n,e,a){return a==s&&(a=1.70158),n*((t=t/e-1)*t*((a+1)*t+a)+1)+i},"ease-in-out-back":function(t,i,n,e,a){return a==s&&(a=1.70158),1>(t/=e/2)?n/2*t*t*(((a*=1.525)+1)*t-a)+i:n/2*((t-=2)*t*(((a*=1.525)+1)*t+a)+2)+i},"ease-in-bounce":function(t,i,n,e){return n-this["ease-out-bounce"](e-t,0,n,e)+i},"ease-out-bounce":function(t,i,n,e){return(t/=e)<1/2.75?7.5625*n*t*t+i:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+i:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+i:n*(7.5625*(t-=2.625/2.75)*t+.984375)+i},"ease-in-out-bounce":function(t,i,n,e){return t<e/2?.5*this["ease-in-bounce"](2*t,0,n,e)+i:.5*this["ease-out-bounce"](2*t-e,0,n,e)+.5*n+i},cubicBezier:function(t,i,n,e,a){var r=1-3*n+3*t-0;n=3*n-6*t+0,t=3*t-0;var s,o,d,l=a;for(s=0;5>s;s++)d=r*l*l*l+n*l*l+t*l+0,o=1/(3*r*l*l+2*n*l+t),l-=(d-a)*o,l=1<l?1:0>l?0:l;return O((1-3*e+3*i-0)*l*l*l+(3*e-6*i+0)*l*l+0*((3*i-0)*l))}}};return i});var h=function(){var e=function(t,i,n,e,a){e=a.style.getStroke(t.stroke),e[i]=n,t.stroke=a.style.getStroke(e,"string")};return{id:0,shapeType:"rectangular",type:"",origin:{x:0,y:0},events:{},children:[],added:!1,opacity:1,rotation:0,composition:"source-over",scalingX:1,scalingY:1,pointerEvents:!0,animationQueues:{},_:{x:0,y:0,abs_x:0,abs_y:0,rotation:0,width:0,height:0,drawn:!1,stroke:"",strokeColor:"",strokeWidth:0,strokePosition:"center",cap:"butt",join:"miter",miterLimit:10,fill:"",shadow:{offsetX:0,offsetY:0,blur:0,color:"transparent"}},set strokeColor(t){e(this,"color",t,"strokeColor",this.core)},set strokeWidth(t){e(this,"width",t,"strokeWidth",this.core)},set strokePosition(t){e(this,"pos",t,"strokePosition",this.core)},set stroke(t){"string"!=typeof t&&(t=this.core.style.getStroke(t,"string"));var i=this.core.style.getStroke(t);if(~i.color.indexOf("image(")){var n=/image\((.*?)(,(\s|)(repeat|repeat-x|repeat-y|no-repeat)|)\)/.exec(i.color),e=n[1],r=n[4]||"repeat",n=new Image,s=this;n.src=e,this._.strokepattern_loading=!0,this._.strokepattern_redraw=!1,n.onload=function(){s._.strokeColor=s.core.canvas.createPattern(this,r),s._.strokepattern_loading=!1,s._.strokepattern_redraw&&(s._.strokepattern_redraw=!1,s.redraw())}}else this._.strokeColor=i.color;this._.strokeWidth=i.width,this._.strokePosition=i.pos,this._.stroke=t},set cap(e){this._.cap=~["butt","round","square"].indexOf(e)?e:"butt"},set join(e){this._.join=~["round","bevel","miter"].indexOf(e)?e:"miter"},set miterLimit(e){this._.miterLimit=isNaN(parseFloat(e))?10:parseFloat(e)},get stroke(){return this._.stroke},get strokeColor(){if(this._.strokepattern_loading)return this._.strokepattern_redraw=!0,"";if(!~this._.strokeColor.toString().indexOf("CanvasPattern")&&~this._.strokeColor.indexOf("gradient")){var e=this.getOrigin();if("rectangular"===this.shapeType){var t="outside"===this.strokePosition?this.strokeWidth:"center"===this.strokePosition?this.strokeWidth/2:0;return this.core.style.getGradient(this._.strokeColor,this.abs_x-e.x-t,this.abs_y-e.y-t,this.width+2*t,this.height+2*t)}if("radial"===this.shapeType)return t=this.radius+this.strokeWidth/2,e.x+=this.radius,e.y+=this.radius,this.core.style.getGradient(this._.strokeColor,this.abs_x-e.x-this.radius,this.abs_y-e.y-this.radius,2*t,2*t)}else return this._.strokeColor},get strokeWidth(){return this._.strokeWidth},get strokePosition(){return this._.strokePosition},get cap(){return this._.cap},get join(){return this._.join},get miterLimit(){return this._.miterLimit},set fill(t){if(~t.indexOf("image(")){var i=/image\((.*?)(,(\s|)(repeat|repeat-x|repeat-y|no-repeat)|)\)/.exec(t);t=i[1];var n=i[4]||"repeat",i=new Image,e=this;i.src=t,this._.pattern_loading=!0,this._.pattern_redraw=!1,i.onload=function(){e._.fill=e.core.canvas.createPattern(this,n),e._.pattern_loading=!1,e._.pattern_redraw&&(e._.pattern_redraw=!1,e.redraw())}}else this._.fill=t},get fill(){if(this._.pattern_loading)return this._.pattern_redraw=!0,"";if(!~this._.fill.toString().indexOf("CanvasPattern")&&~this._.fill.indexOf("gradient")){var e=this.getOrigin();if("rectangular"===this.shapeType)return this.core.style.getGradient(this._.fill,this.abs_x-e.x,this.abs_y-e.y,this.width,this.height);if("radial"===this.shapeType)return this.core.style.getGradient(this._.fill,this.abs_x-e.x-this.radius,this.abs_y-e.y-this.radius,2*this.radius,2*this.radius)}else return this._.fill},set shadow(e){"string"!=typeof e&&(e=this.core.style.getShadow(e,"string")),e=this.core.style.getShadow(e),this._.shadow=e},set shadowOffsetX(e){isNaN(parseFloat(e))||(this._.shadow.offsetX=parseFloat(e))},set shadowOffsetY(e){isNaN(parseFloat(e))||(this._.shadow.offsetY=parseFloat(e))},set shadowBlur(e){isNaN(parseFloat(e))||(this._.shadow.blur=parseFloat(e))},set shadowColor(e){this.core.style.isColor(e)&&(this._.shadow.color=e)},get shadow(){return this._.shadow},get shadowOffsetX(){return this._.shadow.offsetX},get shadowOffsetY(){return this._.shadow.offsetY},get shadowBlur(){return this._.shadow.blur},get shadowColor(){return this._.shadow.color},set x(t){this._.x=t,this._.abs_x=t+(this.parent!==s&&this.parent!==this.core?this.parent.abs_x:0),t=this.children;var i,e=t.length;for(i=0;i<e;i++)t[i]._.abs_x=this.abs_x+t[i].x,t[i].x+=0},set y(t){this._.y=t,this._.abs_y=t+(this.parent!==s&&this.parent!==this.core?this.parent.abs_y:0),t=this.children;var i,e=t.length;for(i=0;i<e;i++)t[i]._.abs_y=this.abs_y-t[i].y,t[i].y+=0},get x(){return this._.x},get y(){return this._.y},set abs_x(e){},set abs_y(e){},get abs_x(){return this._.abs_x},get abs_y(){return this._.abs_y},set width(e){this._.width=e},get width(){return this._.width},set height(e){this._.height=e},get height(){return this._.height},set zIndex(e){this.parent&&("front"===e&&(e=this.parent.children.length-1),"back"===e&&(e=0),this.core.draw.changeZorder(this.parent,this.zIndex,e))},get zIndex(){return this.parent&&this.parent.children.indexOf(this)},get drawn(){return!this.core.draw.isCleared&&this._.drawn},set drawn(e){this._.drawn=!!e},bind:function(e,t){return this.core.events.bind(this,e.split(" "),t),this},unbind:function(e,t){return this.core.events.unbind(this,e.split(" "),t),this},trigger:function(t,i){var n=this.core.events,e=n.getParentChain(this,!0,!0);return n.triggerChain(e,t.split(" "),n.fixEventObject(i)),this},add:function(e){return this.added||(e=e===s||e,this.core.children.push(this),this.added=!0,this.parent=this.core,this.core.draw.objects.push(this),e&&this.core.draw.redraw()),this},remove:function(t){if(t=t===s||t,!this.parent)return this;var i=this.parent.children.indexOf(this);if(~i){this.parent.children.splice(i,1),this.parent=s,this.drawn=this.added=!1,i=this.core.draw.objects.indexOf(this),~i&&this.core.draw.objects.splice(e,1);for(var n=this.children,e=0,a=n.length;e<a;e++)n[e].drawn=!1,i=this.core.draw.objects.indexOf(n[e]),~i&&this.core.draw.objects.splice(i,1);t&&this.core.draw.redraw()}return this},draw:function(){},redraw:function(){return this.core.draw.redraw(),this},rotate:function(e){return this.rotation+=e,this},rotateTo:function(e){return this.rotation=e,this},getArgs:function(t,i,n,e){if("string"==typeof i){var r=t;t="x"===i?r:n||0,i="y"===i?r:e||0}else i===s&&(i=t);return{x:t,y:i}},move:function(e,t){return e=this.getArgs(e,t),this.x+=e.x,this.y+=e.y,this},moveTo:function(e,t){return e=this.getArgs(e,t,this.x,this.y),this.x=e.x,this.y=e.y,this},scale:function(e,t){return e=this.getArgs(e,t,1,1),this.scalingX=e.x,this.scalingY=e.y,this},scaleTo:function(t,i){var n="rectangular"===this.shapeType?this.width:this.radius,e="rectangular"===this.shapeType?this.height:this.radius;return t=this.getArgs(t,i,n,e),t.x=0>=t.x?1:t.x,t.y=0>=t.y?1:t.y,this.scalingX=t.x/n,this.scalingY=t.y/e,this},animate:function(){return this.core.animation.animate(this,arguments),this},stop:function(){return this.core.animation.stop(this),this},finish:function(){return this.core.animation.finish(this),this},delay:function(e,t){return this.core.animation.delay(this,e,t),this},fadeIn:function(){var e=Array.prototype.slice.call(arguments);return this.core.animation.animate(this,[{opacity:1}].concat(e)),this},fadeOut:function(){var e=Array.prototype.slice.call(arguments);return this.core.animation.animate(this,[{opacity:0}].concat(e)),this},fadeTo:function(){var e=Array.prototype.slice.call(arguments);return this.core.animation.animate(this,[{opacity:e.splice(0,1)[0]}].concat(e)),this},dragAndDrop:function(t){if(t=t===s?{}:t,!1===t&&!0===this.draggable)this.draggable=!1,this.unbind("mousedown touchstart",this._.drag_start),this.core.unbind("mouseup touchend",this._.drag_end),this.core.unbind("mousemove touchmove",this._.drag_move);else if(!this.draggable){this.draggable=!0,this.dragging=!1;var i=this,n=0,e=0,a={x:0,y:0};this._.drag_start=function(r){!1===t.bubble&&r.stopPropagation(),this.dragging=!0,n=this.x,e=this.y,a=i.core.tools.transformPointerPosition(i,i.abs_x,i.abs_y,i.rotation),!0===t.changeZindex&&(this.zIndex="front"),"function"==typeof t.start&&t.start.call(this),this.core.timeline.running||this.core.draw.redraw()},this._.drag_end=function(e){i.dragging&&(!1===t.bubble&&e.stopPropagation(),i.dragging=!1,"function"==typeof t.end&&t.end.call(i),i.core.timeline.running||i.core.draw.redraw())},this._.drag_move=function(r){i.dragging&&(!1===t.bubble&&r.stopPropagation(),r=i.core.tools.transformPointerPosition(i,i.abs_x,i.abs_y,i.rotation),i.x=n+r.x-a.x,i.y=e+r.y-a.y,"function"==typeof t.move&&t.move.call(i),i.core.timeline.running||i.core.draw.redraw())},this.bind("mousedown touchstart",this._.drag_start),this.core.bind("mouseup touchend",this._.drag_end),this.core.bind("mousemove touchmove",this._.drag_move)}return this},setOrigin:function(e,t){return this.origin.x=e,this.origin.y=t,this},getOrigin:function(){var t,i;i=this.origin;var n=this.shapeType;return t="center"===i.x?"rectangular"===n?this.width/2:0:"right"===i.x?"rectangular"===n?this.width:this.radius:"left"===i.x?"rectangular"===n?0:-this.radius:isNaN(parseFloat(i.x))?0:parseFloat(i.x),i="center"===i.y?"rectangular"===n?this.height/2:0:"bottom"===i.y?"rectangular"===n?this.height:this.radius:"top"===i.y?"rectangular"===n?0:-this.radius:isNaN(parseFloat(i.y))?0:parseFloat(i.y),{x:t,y:i}},addChild:function(t,i){if(t.parent===s){var n=this.children.push(t)-1;if(t.parent=this,t.x+=0,t.y+=0,this.core.draw.objects.push(t),this.drawn&&this.core.draw.redraw(),i)return n}else if(i)return!1;return this},removeChild:function(e,t){return e=this.children.indexOf(e),~e&&this.removeChildAt(e,t),this},removeChildAt:function(e,t){return this.children[e]!==s&&this.children[e].remove(t),this},clone:function(i){i=i||{},i.drawn=!1;var o,l,a,r,n,c,u=this.parent,y=this.core.display[this.type](i),e={},_=["core","events","children","parent","img","image","fill","strokeColor","added"],b=["abs_x","start_x","end_x"],h=["abs_y","start_y","end_y"];if(o=function(i,n){for(l in i)if(!~_.indexOf(l)&&(c=Object.getPropertyDescriptor(i,l))&&c.get===s)if("object"===t(i[l]))n[l]=i[l].constructor===Array?[]:{},o(i[l],n[l]);else{var a=i[l];u&&(-1<b.indexOf(l)?a-=u.abs_x:-1<h.indexOf(l)&&(a-=u.abs_y)),n[l]=a}},o(this,e),e.fill=this._.fill,a=this.core.style.getStroke(this.stroke),e.strokeColor=a.color,this.image&&(e.image=this.image),y=p.extend(y,e,i),y.id=++this.core.lastObjectID,"function"==typeof y.init&&y.init(),a=this.children,0<a.length)for(e=0;e<a.length;e++)r=a[e].clone(),y.children.push(r),r.parent=y,i.x&&(n=O(a[e].abs_x-this.x),r.x=n),i.y&&(n=O(a[e].abs_y-this.y),r.y=n);return y},isPointerInside:function(e){return this.core.tools.isPointerInside(this,e)}}};p.registerModule("displayObject",h),p.registerModule("display",{wrapper:!0,register:function(t,i,n,r){var e=this.core,o=function(a,r){return p.extend({core:r,type:t,shapeType:"rectangular",draw:function(){return n.call(this,e.canvas,e),this}},i,a)};return this[t]=function(t){return t=p.extend(Object.create(h()),new o(t,e)),r!==s&&"function"==typeof t[r]&&t[r](),t},this}}),p.registerDisplayObject=function(t,i,n){p.registerModule("display."+t,{setCore:function(a){return function(e){return e=p.extend(Object.create(h()),new i(e,a)),e.type=t,e.id=++a.lastObjectID,a.animation.queues.create(e,"default"),n!==s&&e[n](),e}}})},p.registerDisplayObject("rectangle",function(e,t){return p.extend({core:t,shapeType:"rectangular",clipChildren:!1,draw:function(){var e=this.core.canvas,t=this.getOrigin(),n=(this.abs_x-t.x)*i.devicePixelRatio,t=(this.abs_y-t.y)*i.devicePixelRatio;return e.beginPath(),e.rect(n,t,this.width*i.devicePixelRatio,this.height*i.devicePixelRatio),""!==this.fill&&(e.fillStyle=this.fill,e.fill()),0<this.strokeWidth&&(e.lineWidth=this.strokeWidth*i.devicePixelRatio,e.strokeStyle=this.strokeColor,"outside"===this.strokePosition?e.strokeRect(n-this.strokeWidth/2,t-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth):"center"===this.strokePosition?e.strokeRect(n,t,this.width,this.height):"inside"===this.strokePosition&&e.strokeRect(n+this.strokeWidth/2,t+this.strokeWidth/2,this.width-this.strokeWidth,this.height-this.strokeWidth)),e.closePath(),this.clipChildren&&e.clip(),this}},e)}),p.registerDisplayObject("image",function(e,t){return p.extend({core:t,_:p.extend({},t.displayObject._,{hasBeenDrawn:!1}),shapeType:"rectangular",loaded:!1,firstDrawn:!1,tile:!1,tile_width:0,tile_height:0,tile_spacing_x:0,tile_spacing_y:0,clipChildren:!1,init:function(){var e=this;if(this.image!==s){var t=this.image.nodeName&&"img"===this.image.nodeName.toLowerCase();this.img=t?this.image:new Image;var i=function(){e.loaded=!0,0===e.width?e.width=this.width:0===e.height&&(e.height=e.width/(this.width/this.height)),0===e.height?e.height=this.height:0===e.width&&(e.width=e.height/(this.height/this.width)),e.tile_width=0===e.tile_width?e.width:e.tile_width,e.tile_height=0===e.tile_height?e.height:e.tile_height,e._.hasBeenDrawn&&e.core.draw.redraw()};t&&this.img.complete?i.call(this.img):(this.img.addEventListener("load",i),t||(this.img.src=this.image))}},draw:function(){var e,t,o=Math.ceil,l=this.core.canvas,a=this,c=this.getOrigin(),d=(this.abs_x-c.x)*i.devicePixelRatio,c=(this.abs_y-c.y)*i.devicePixelRatio;if(this.loaded&&this.core.draw.objects[this.zIndex]!==s&&0<this.img.width&&0<this.img.height){if(e=0===this.width?this.img.width:this.width,t=0===this.height?this.img.height:this.height,e*=i.devicePixelRatio,t*=i.devicePixelRatio,this.tile){var g,h,n=o(e/this.tile_width),u=o(t/this.tile_height);for(l.save(),l.beginPath(),l.moveTo(d,c),l.lineTo(d+e,c),l.lineTo(d+e,c+t),l.lineTo(d,c+t),l.lineTo(d,c),l.clip(),h=0;h<u;h++)for(g=0;g<n;g++)l.drawImage(this.img,d+g*(this.tile_width+this.tile_spacing_x),c+h*(this.tile_height+this.tile_spacing_y),this.tile_width,this.tile_height);l.closePath(),l.restore()}else this.clipChildren&&(n=5*i.devicePixelRatio,l.beginPath(),l.moveTo(d+n,c),l.arcTo(d+e,c,d+e,c+t,n),l.arcTo(d+e,c+t,d,c+t,n),l.arcTo(d,c+t,d,c,n),l.arcTo(d,c,d+e,c,n),l.closePath(),l.clip()),l.drawImage(this.img,d,c,e,t);0<this.strokeWidth&&(l.lineWidth=this.strokeWidth,l.strokeStyle=this.strokeColor,l.strokeRect(d,c,e,t)),!1===this.firstDrawn&&(this.firstDrawn=!0,clearTimeout(this.loadtimer))}else clearTimeout(this.loadtimer),this.loadtimer=setTimeout(function(){a.draw()},100);return this._.hasBeenDrawn=!0,this}},e)},"init");var e=[];p.registerDisplayObject("text",function(t,r){var s=function(e,t,i,n,a){var r=a.style.getFont(e.font);r[t]=i,e._.font=a.style.getFont(r,"string"),"lineHeight"===n?(e._.lineHeight=isNaN(parseInt(i,10))?1:parseInt(i,10),e._.lineHeightUnit="string"==typeof i?-1<i.indexOf("px")?"px":"relative":"relative"):e._[n]=i};return p.extend({core:r,shapeType:"rectangular",align:"start",baseline:"top",_:p.extend({},r.displayObject._,{hasBeenDrawn:!1,font:"normal normal normal 16px/1 sans-serif",style:"normal",variant:"normal",weight:"normal",size:16,lineHeight:1,family:"sans-serif",text:"",width:0,height:0,lines:[]}),set font(e){"string"!=typeof e&&(e=this.core.style.getFont(e,"string"));var t=this.core.style.getFont(e);e=this.core.style.getFont(t,"string"),this._.style=t.style,this._.variant=t.variant,this._.weight=t.weight,this._.size=t.size,this._.lineHeight=t.lineHeight,this._.lineHeightUnit=t.lineHeightUnit,this._.family=t.family,this._.font=e,this.initWebFont(),this.setDimensions()},set style(e){s(this,"style",e,"style",this.core),this.initWebFont(),this.setDimensions()},set variant(e){s(this,"variant",e,"variant",this.core),this.initWebFont(),this.setDimensions()},set weight(e){s(this,"weight",e,"weight",this.core),this.initWebFont(),this.setDimensions()},set size(e){s(this,"size",e,"size",this.core),this.setDimensions()},set lineHeight(e){s(this,"lineHeight",e,"lineHeight",this.core),this.setDimensions()},set family(e){s(this,"family",e,"family",this.core),this.initWebFont(),this.setDimensions()},set text(e){this._.text=e,this.setDimensions()},set width(e){},set height(e){},get font(){return this._.font},get style(){return this._.style},get variant(){return this._.variant},get weight(){return this._.weight},get size(){return this._.size},get lineHeight(){return this._.lineHeight+("px"===this._.lineHeightUnit?"px":0)},get family(){return this._.family},get text(){return this._.text},get width(){return this._.width},get height(){return this._.height},init:function(){this._.initialized=!0,this.initWebFont(),this.setDimensions()},setDimensions:function(){if(this._.initialized){var e,t,i,a,r,s,o,d,l;for(e=this.core.canvas,e.fillStyle=this.fill,e.font=this.font,t=this.text.toString().split("\n"),i=t.length,s=r=0,l=[],o=0;o<i;o++)d=e.measureText(t[o]),r=d.width>r?d.width:r,a="px"===this._.lineHeightUnit?this._.lineHeight:this.size*this._.lineHeight,s+=a,l.push({text:t[o],width:d.width,height:a});this._.width=r,this._.height=s,this._.lines=l}},initWebFont:function(){var t=this.style+" "+this.variant+" "+this.weight+" 0px "+this.family;if(!(-1<e.indexOf(t))){e.push(t);var i,a=this,r=this.core;i=n.createElement("span"),i.style.font=t,n.body.appendChild(i),setTimeout(function(){n.body.removeChild(i),a._.hasBeenDrawn&&r.redraw()},1E3)}},getAlignOffset:function(){return{start:0,end:-this.width,left:0,center:-this.width/2,right:-this.width}[this.align]||0},getBaselineOffset:function(){return{top:.82*this.size,hanging:.65*this.size,middle:.31*this.size,alphabetic:0,ideographic:-.05*this.size,bottom:-.22*this.size}[this.baseline]||0},draw:function(){var e,t,n,a,r,s;if(e=this.core.canvas,t=this._.lines,n=this.getAlignOffset(),a=this.getBaselineOffset(),r="px"===this._.lineHeightUnit?this._.lineHeight/this.size:this._.lineHeight,r="top"===this.baseline?0:this.size*(r-1)/2,s=this.getOrigin(),n=(this.abs_x-s.x-n)*i.devicePixelRatio,a=(this.abs_y-s.y+a-r)*i.devicePixelRatio,e.beginPath(),r=this.core.style.getFont(this.font),r.size*=i.devicePixelRatio,r=this.core.style.getFont(r,"string"),e.font=r,e.textAlign=this.align,e.textBaseline="alphabetic",0<this.strokeWidth)for(e.lineWidth=this.strokeWidth*i.devicePixelRatio,e.strokeStyle=this.strokeColor,r=0,s=t.length;r<s;r++)e.strokeText(t[r].text,n,a+r*t[r].height+(t[r].height-this.size)/2);if(""!==this.fill)for(e.fillStyle=this.fill,r=0,s=t.length;r<s;r++)e.fillText(t[r].text,n,a+r*t[r].height+(t[r].height-this.size)/2);return e.closePath(),this._.hasBeenDrawn=!0,this}},t)},"init"),p.registerDisplayObject("arc",function(e,t){return p.extend({core:t,shapeType:"radial",radius:0,start:0,end:0,direction:"clockwise",pieSection:!1,clipChildren:!1,draw:function(){var e=this.core.canvas,t=this.getOrigin(),i=this.abs_x-t.x,t=this.abs_y-t.y;return e.beginPath(),0<this.radius&&this.start!==this.end&&(this.pieSection&&e.moveTo(i,t),e.arc(i,t,this.radius,this.start*x/180,this.end*x/180,"anticlockwise"===this.direction),""!==this.fill&&(e.fillStyle=this.fill,e.fill()),0<this.strokeWidth&&(e.lineWidth=this.strokeWidth,e.strokeStyle=this.strokeColor,e.stroke())),e.closePath(),this.clipChildren&&e.clip(),this}},e)}),p.registerDisplayObject("ellipse",function(e,t){return p.extend({core:t,shapeType:"radial",clipChildren:!1,_:p.extend({},t.displayObject._,{radius_x:0,radius_y:0}),set radius(e){this._.radius_x=e,this._.radius_y=e},set radius_x(e){this._.radius_x=e},set radius_y(e){this._.radius_y=e},get radius(){return this._.radius_x},get radius_x(){return this._.radius_x},get radius_y(){return this._.radius_y},getOrigin:function(){var e,t;return e="right"===this.origin.x?this.radius_x:"left"===this.origin.x?-this.radius_x:isNaN(parseFloat(this.origin.x))?0:parseFloat(this.origin.x),t="bottom"===this.origin.y?this.radius_y:"top"===this.origin.y?-this.radius_y:isNaN(parseFloat(this.origin.y))?0:parseFloat(this.origin.y),{x:e,y:t}},draw:function(){var e=this.core.canvas,t=this.getOrigin(),i=this.abs_x-t.x,t=this.abs_y-t.y;if(e.beginPath(),this.radius_x===this.radius_y)e.arc(i,t,this.radius_x,0,2*x,!1);else{var n=.552284749830794*this.radius_x,a=.552284749830794*this.radius_y;e.moveTo(i-this.radius_x,t),e.bezierCurveTo(i-this.radius_x,t-a,i-n,t-this.radius_y,i,t-this.radius_y),e.bezierCurveTo(i+n,t-this.radius_y,i+this.radius_x,t-a,i+this.radius_x,t),e.bezierCurveTo(i+this.radius_x,t+a,i+n,t+this.radius_y,i,t+this.radius_y),e.bezierCurveTo(i-n,t+this.radius_y,i-this.radius_x,t+a,i-this.radius_x,t)}return""!==this.fill&&(e.fillStyle=this.fill,e.fill()),0<this.strokeWidth&&(e.lineWidth=this.strokeWidth,e.strokeStyle=this.strokeColor,e.stroke()),e.closePath(),this.clipChildren&&e.clip(),this}},e)}),p.registerDisplayObject("polygon",function(e,t){return p.extend({core:t,shapeType:"radial",sides:3,clipChildren:!1,_:p.extend({},t.displayObject._,{radius:0,side:0}),set radius(e){this._.radius=e,this._.side=2*this._.radius*o(x/this.sides)},set side(e){this._.side=e,this._.radius=this._.side/2/o(x/this.sides)},get radius(){return this._.radius},get side(){return this._.side},draw:function(){var e,t,i,n=this.core.canvas,a=this.getOrigin(),r=this.abs_x-a.x,a=this.abs_y-a.y,s=0,d=0,l=this.sides,c=this.radius;for(n.beginPath(),i=0;i<=l;i++)e=r+c*_(2*i*x/l),t=a+c*o(2*i*x/l),0===i?(n.moveTo(e,t),s=e,d=t):i==l?n.lineTo(s,d):n.lineTo(e,t);return n.closePath(),""!==this.fill&&(n.fillStyle=this.fill,n.fill()),0<this.strokeWidth&&(n.lineWidth=this.strokeWidth,n.strokeStyle=this.strokeColor,n.stroke()),this.clipChildren&&n.clip(),this}},e)}),p.registerDisplayObject("line",function(e,t){return p.extend({core:t,shapeType:"radial",_:p.extend({},t.displayObject._,{start_x:0,start_y:0,end_x:0,end_y:0,x:0,y:0,abs_x:0,abs_y:0}),children:[],set start(e){this._.start_x=e.x+(this.parent&&!this.parent.isCore?this.parent._.abs_x:0),this._.start_y=e.y+(this.parent&&!this.parent.isCore?this.parent._.abs_y:0),this.setPosition()},set end(e){this._.end_x=e.x+(this.parent&&!this.parent.isCore?this.parent._.abs_x:0),this._.end_y=e.y+(this.parent&&!this.parent.isCore?this.parent._.abs_y:0),this.setPosition()},get start(){var e=0,t=0;this.parent&&!this.parent.isCore&&(e=this.parent._.abs_x,t=this.parent._.abs_y);var i=this;return{get x(){return i._.start_x-e},get y(){return i._.start_y-t},set x(e){i._.start_x=e+(i.parent&&!i.parent.isCore?i.parent._.abs_x:0),i.setPosition()},set y(e){i._.start_y=e+(i.parent&&!i.parent.isCore?i.parent._.abs_y:0),i.setPosition()}}},get end(){var e=0,t=0;this.parent&&!this.parent.isCore&&(e=this.parent._.abs_x,t=this.parent._.abs_y);var i=this;return{get x(){return i._.end_x-e},get y(){return i._.end_y-t},set x(e){i._.end_x=e+(i.parent&&!i.parent.isCore?i.parent._.abs_x:0),i.setPosition()},set y(e){i._.end_y=e+(i.parent&&!i.parent.isCore?i.parent._.abs_y:0),i.setPosition()}}},set x(e){var t,i;for(t=this._.end_x-this._.start_x,i=this.parent&&!this.parent.isCore?this.parent._.abs_x:0,this._.x=e,this._.abs_x=e+i,this._.start_x=e-t/2+i,this._.end_x=e+t/2+i,e=this.children,t=e.length,i=0;i<t;i++)e[i]._.abs_x=this.abs_x+e[i].x,e[i].x+=0},set y(e){var t,i;for(t=this._.end_y-this._.start_y,i=this.parent&&!this.parent.isCore?this.parent._.abs_y:0,this._.y=e,this._.abs_y=e+i,this._.start_y=e-t/2+i,this._.end_y=e+t/2+i,e=this.children,t=e.length,i=0;i<t;i++)e[i]._.abs_y=this.abs_y-e[i].y,e[i].y+=0},get x(){return this._.x},get y(){return this._.y},set length(e){var t,i;t=O(this._.end_x-this._.start_x),i=O(this._.end_y-this._.start_y),i=r(t/P(t*t+i*i)),t=o(i)*e,i=_(i)*e,this._.end_x=this._.start_x+t,this._.end_y=this._.start_y+i,this.x+=0,this.y+=0,this.setPosition()},get length(){var e,t;return e=O(this._.end_x-this._.start_x),t=O(this._.end_y-this._.start_y),P(e*e+t*t)},set radius(e){this.length=2*e},get radius(){return this.length/2},setPosition:function(){var e=0,t=0;this.parent&&!this.parent.isCore&&(e=this.parent._.abs_x,t=this.parent._.abs_y),this.x=this._.start_x-e+(this._.end_x-this._.start_x)/2,this.y=this._.start_y-t+(this._.end_y-this._.start_y)/2},init:function(){this.initialized=!0,this.setPosition()},draw:function(){var e=this.core.canvas,t=this.getOrigin(),i=this.core.draw.translation;return e.lineWidth=this.strokeWidth,e.strokeStyle=this.strokeColor,e.beginPath(),e.moveTo(this._.start_x-i.x-t.x,this._.start_y-i.y-t.y),e.lineTo(this._.end_x-i.x-t.x,this._.end_y-i.y-t.y),e.stroke(),e.closePath(),this}},e)},"init"),p.registerDisplayObject("sprite",function(e,t){return p.extend({core:t,shapeType:"rectangular",loaded:!1,firstDrawn:!1,frames:[],duration:0,frame:1,generate:!1,numFrames:0,offset_x:0,offset_y:0,direction:"x",running:!1,active:!1,loop:!0,clipChildren:!1,_:p.extend({},t.displayObject._,{autostart:!1,hasBeenDrawn:!1}),set autostart(e){this.active=e,this._.autostart=e},get autostart(){return this._.autostart},init:function(){if(this.image!==s){var t=this,e=this.image.nodeName&&"img"===this.image.nodeName.toLowerCase();this.img=e?this.image:new Image;var i=function(){if(t.full_width=this.width,t.full_height=this.height,t.generate){var i,n,a;for(i=t.direction,n="y"===i?t.full_height:t.full_width,a="y"===i?t.height:t.width,0<t.numFrames?n=t.numFrames:(n/=a,t.numFrames=n),t.frames=[],a=0;a<n;a++)t.frames.push({x:t.offset_x+a*("x"===i?t.width:0),y:t.offset_y+a*("y"===i?t.height:0),d:t.duration})}t.loaded=!0,t._.hasBeenDrawn&&t.core.redraw()};e&&this.img.complete?i.call(this.img):(this.img.addEventListener("load",i),e||(this.img.src=this.image))}},draw:function(){var e,t=this,i=this.core.canvas,n=this.getOrigin(),a=this.abs_x-n.x,n=this.abs_y-n.y,r=0,o=0;if(this.loaded){if(0<this.frames.length){if(this.frame>this.frames.length)return this.clipChildren&&(i.beginPath(),i.rect(a,n,0,0),i.closePath(),i.clip()),this;e=this.frames[this.frame-1],r=e.w===s?this.width:e.w,o=e.h===s?this.height:e.h,i.drawImage(this.img,e.x,e.y,r,o,a,n,r,o),0<this.strokeWidth&&(i.lineWidth=this.strokeWidth,i.strokeStyle=this.strokeColor,i.strokeRect(a,n,r,o)),!1===this.running&&this.active&&(setTimeout(function(){t.frame=t.loop?t.frame===t.frames.length?1:t.frame+1:t.frame===t.frames.length?t.frame:t.frame+1,t.running=!1,t.core.timeline.running||t.core.draw.redraw()},e.d),this.running=!0)}!1===this.firstDrawn&&(this.firstDrawn=!0,clearTimeout(this.loadtimer))}else clearTimeout(this.loadtimer),this.loadtimer=setTimeout(function(){t.draw()},100);return this.clipChildren&&(i.beginPath(),i.rect(a,n,r,o),i.closePath(),i.clip()),this._.hasBeenDrawn=!0,this},start:function(){return this.startAnimation(),this},startAnimation:function(){return this.active=!0,this.core.redraw(),this},stopAnimation:function(){return this.active=!1,this}},e)},"init")})(window,document),function(){var e=Object.prototype,t=e.__defineGetter__,i=e.__defineSetter__,n=e.__lookupGetter__,r=e.__lookupSetter__,s=e.hasOwnProperty;t&&i&&n&&r&&(Object.defineProperty||(Object.defineProperty=function(e,o,a){if(3>arguments.length)throw new TypeError("Arguments not optional");if(o+="",s.call(a,"value")&&(n.call(e,o)||r.call(e,o)||(e[o]=a.value),s.call(a,"get")||s.call(a,"set")))throw new TypeError("Cannot specify an accessor and a value");return a.get&&t.call(e,o,a.get),a.set&&i.call(e,o,a.set),e}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(t,i){if(2>arguments.length)throw new TypeError("Arguments not optional.");i+="";var a={configurable:!0,enumerable:!0,writable:!0},o=n.call(t,i),e=r.call(t,i);return s.call(t,i)?o||e?(delete a.writable,a.get=a.set=void 0,o&&(a.get=o),e&&(a.set=e),a):(a.value=t[i],a):a}),Object.defineProperties||(Object.defineProperties=function(e,t){for(var i in t)s.call(t,i)&&Object.defineProperty(e,i,t[i])}))}()})(); 
 			});
 		define("mySubContext/weapp-adapter.js", function(require, module, exports){ 			
(function(){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)})([function(a,b,c){var d=c(1),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f=c(4),g=function(a){return a&&a.__esModule?a:{default:a}}(f),h=GameGlobal;GameGlobal.__isAdapterInjected||(GameGlobal.__isAdapterInjected=!0,function(){e.addEventListener=function(a,b){e.document.addEventListener(a,b)},e.removeEventListener=function(a,b){e.document.removeEventListener(a,b)},e.canvas&&(e.canvas.addEventListener=e.addEventListener,e.canvas.removeEventListener=e.removeEventListener),h.sharedCanvas&&(sharedCanvas.__proto__.__proto__=new g.default("canvas"),sharedCanvas.getBoundingClientRect=function(){var a={top:0,left:0,width:window.innerWidth,height:window.innerHeight};return a},sharedCanvas.addEventListener=e.addEventListener,sharedCanvas.removeEventListener=e.removeEventListener);var a=wx.getSystemInfoSync(),b=a.platform;if("undefined"==typeof __devtoolssubcontext&&"devtools"===b){for(var c in e){var d=Object.getOwnPropertyDescriptor(h,c);d&&!0!==d.configurable||Object.defineProperty(window,c,{value:e[c]})}for(var f in e.document){var i=Object.getOwnPropertyDescriptor(h.document,f);i&&!0!==i.configurable||Object.defineProperty(h.document,f,{value:e.document[f]})}window.parent=window}else{for(var j in e)h[j]=e[j];h.window=e,window=h,window.top=window.parent=window}}())},function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0}),b.cancelAnimationFrame=b.requestAnimationFrame=b.clearInterval=b.clearTimeout=b.setInterval=b.setTimeout=b.canvas=b.location=b.localStorage=b.HTMLElement=b.FileReader=b.Audio=b.Image=b.WebSocket=b.XMLHttpRequest=b.navigator=b.document=void 0;var e=c(2);Object.keys(e).forEach(function(a){"default"===a||"__esModule"===a||Object.defineProperty(b,a,{enumerable:!0,get:function(){return e[a]}})});var f=c(3);Object.keys(f).forEach(function(a){"default"===a||"__esModule"===a||Object.defineProperty(b,a,{enumerable:!0,get:function(){return f[a]}})});var g=c(9),h=d(g),i=c(17),j=c(10),k=d(j),l=c(18),m=d(l),n=c(19),o=d(n),p=c(20),q=d(p),r=c(11),s=d(r),t=c(12),u=d(t),v=c(21),w=d(v),x=c(4),y=d(x),z=c(22),A=d(z),B=c(23),C=d(B);b.document=k.default,b.navigator=m.default,b.XMLHttpRequest=o.default,b.WebSocket=q.default,b.Image=s.default,b.Audio=u.default,b.FileReader=w.default,b.HTMLElement=y.default,b.localStorage=A.default,b.location=C.default;var D=(0,i.isSubContext)()?void 0:new h.default;b.canvas=D,b.setTimeout=setTimeout,b.setInterval=setInterval,b.clearTimeout=clearTimeout,b.clearInterval=clearInterval,b.requestAnimationFrame=requestAnimationFrame,b.cancelAnimationFrame=cancelAnimationFrame},function(a,b){Object.defineProperty(b,"__esModule",{value:!0});var c=wx.getSystemInfoSync(),d=c.screenWidth,e=c.screenHeight,f=c.devicePixelRatio,g=b.innerWidth=d,h=b.innerHeight=e;b.devicePixelRatio=f;var i=b.screen={availWidth:g,availHeight:h},j=b.performance={now:function(){return Date.now()/1e3}},k=b.ontouchstart=null,l=b.ontouchmove=null,m=b.ontouchend=null},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0}),c.HTMLCanvasElement=c.HTMLImageElement=void 0;var h=d(4),i=function(a){return a&&a.__esModule?a:{default:a}}(h),j=c.HTMLImageElement=function(a){function b(){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"img"))}return g(b,a),b}(i.default),k=c.HTMLCanvasElement=function(a){function b(){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"canvas"))}return g(b,a),b}(i.default)},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=d(5),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=d(8),l=d(2),m=function(a){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.className="",c.childern=[],c.style={width:l.innerWidth+"px",height:l.innerHeight+"px"},c.insertBefore=k.noop,c.innerHTML="",c.tagName=a.toUpperCase(),c}var c=Number.isNaN;return g(b,a),h(b,[{key:"setAttribute",value:function(a,b){this[a]=b}},{key:"getAttribute",value:function(a){return this[a]}},{key:"getBoundingClientRect",value:function(){return{top:0,left:0,width:l.innerWidth,height:l.innerHeight}}},{key:"focus",value:function(){}},{key:"clientWidth",get:function(){var a=parseInt(this.style.fontSize,10)*this.innerHTML.length;return c(a)?0:a}},{key:"clientHeight",get:function(){var a=parseInt(this.style.fontSize,10);return c(a)?0:a}}]),b}(j.default);c.default=m},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=d(6),i=function(a){return a&&a.__esModule?a:{default:a}}(h),j=function(a){function b(){e(this,b);var a=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a.className="",a.children=[],a}return g(b,a),b}(i.default);c.default=j},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=d(7),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=function(a){function b(){e(this,b);var a=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a.childNodes=[],a}return g(b,a),h(b,[{key:"appendChild",value:function(a){if(a instanceof b)this.childNodes.push(a);else throw new TypeError("Failed to executed 'appendChild' on 'Node': parameter 1 is not of type 'Node'.")}},{key:"cloneNode",value:function(){var a=Object.create(this);return Object.assign(a,this),a}},{key:"removeChild",value:function(a){var b=this.childNodes.findIndex(function(b){return b===a});return-1<b?this.childNodes.splice(b,1):null}}]),b}(j.default);c.default=k},function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=new WeakMap,f=function(){function a(){c(this,a),e.set(this,{})}return d(a,[{key:"addEventListener",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},d=e.get(this);d||(d={},e.set(this,d)),d[a]||(d[a]=[]),d[a].push(b),c.capture&&console.warn("EventTarget.addEventListener: options.capture is not implemented."),c.once&&console.warn("EventTarget.addEventListener: options.once is not implemented."),c.passive&&console.warn("EventTarget.addEventListener: options.passive is not implemented.")}},{key:"removeEventListener",value:function(a,b){var c=e.get(this)[a];if(c&&0<c.length)for(var d=c.length;d--;0<d)if(c[d]===b){c.splice(d,1);break}}},{key:"dispatchEvent",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=e.get(this)[a.type];if(b)for(var c=0;c<b.length;c++)b[c](a)}}]),a}();b.default=f},function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b.noop=function(){},b.isSubContext=function(){return"undefined"!=typeof GameGlobal&&!0===GameGlobal.__isSubContext}},function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(){var a=wx.createCanvas();a.type="canvas",a.__proto__.__proto__=new g.default("canvas");a.getContext;return a.getBoundingClientRect=function(){var a={top:0,left:0,width:window.innerWidth,height:window.innerHeight};return a},a};var e=c(3),f=c(4),g=d(f),h=c(10),i=d(h)},function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c(1),f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(e),g=c(4),h=d(g),i=c(11),j=d(i),k=c(12),l=d(k),m=c(9),n=d(m);c(15);var o={},p={readyState:"complete",visibilityState:"visible",documentElement:f,hidden:!1,style:{},location:f.location,ontouchstart:null,ontouchmove:null,ontouchend:null,head:new h.default("head"),body:new h.default("body"),createElement:function(a){if("canvas"===a)return new n.default;return"audio"===a?new l.default:"img"===a?new j.default:new h.default(a)},getElementById:function(a){return a===f.canvas.id?f.canvas:null},getElementsByTagName:function(a){if("head"===a)return[p.head];return"body"===a?[p.body]:"canvas"===a?[f.canvas]:[]},querySelector:function(a){if("head"===a)return p.head;return"body"===a?p.body:"canvas"===a?f.canvas:a==="#"+f.canvas.id?f.canvas:null},querySelectorAll:function(a){if("head"===a)return[p.head];return"body"===a?[p.body]:"canvas"===a?[f.canvas]:[]},addEventListener:function(a,b){o[a]||(o[a]=[]),o[a].push(b)},removeEventListener:function(a,b){var c=o[a];if(c&&0<c.length)for(var d=c.length;d--;0<d)if(c[d]===b){c.splice(d,1);break}},dispatchEvent:function(a){var b=o[a.type];if(b)for(var c=0;c<b.length;c++)b[c](a)}};b.default=p},function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(){var a=wx.createImage();return a}},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=d(13),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=d(8),l=0,m=2,n=4,o=new WeakMap,p=new WeakMap,q=new WeakMap,r=new WeakMap,s=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));if(c.HAVE_NOTHING=l,c.HAVE_METADATA=1,c.HAVE_CURRENT_DATA=m,c.HAVE_FUTURE_DATA=3,c.HAVE_ENOUGH_DATA=n,c.readyState=l,(0,k.isSubContext)())return console.warn("HTMLAudioElement is not supported in SubContext."),f(c);p.set(c,"");var d=wx.createInnerAudioContext();return o.set(c,d),d.onCanplay(function(){c.dispatchEvent({type:"load"}),c.dispatchEvent({type:"loadend"}),c.dispatchEvent({type:"canplay"}),c.dispatchEvent({type:"canplaythrough"}),c.dispatchEvent({type:"loadedmetadata"}),c.readyState=m}),d.onPlay(function(){c.dispatchEvent({type:"play"})}),d.onPause(function(){c.dispatchEvent({type:"pause"})}),d.onEnded(function(){c.dispatchEvent({type:"ended"}),c.readyState=n}),d.onError(function(){c.dispatchEvent({type:"error"})}),a&&(o.get(c).src=a),c}return g(b,a),h(b,[{key:"load",value:function(){console.warn("HTMLAudioElement.load() is not implemented.")}},{key:"play",value:function(){(0,k.isSubContext)()||o.get(this).play()}},{key:"pause",value:function(){(0,k.isSubContext)()||o.get(this).pause()}},{key:"canPlayType",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return"string"==typeof a?-1<a.indexOf("audio/mpeg")||a.indexOf("audio/mp4")?"probably":"":""}},{key:"cloneNode",value:function(){var a=new b;return(0,k.isSubContext)()||(a.loop=o.get(this).loop,a.autoplay=o.get(this).loop,a.src=this.src),a}},{key:"currentTime",get:function(){return(0,k.isSubContext)()?0:o.get(this).currentTime},set:function(a){(0,k.isSubContext)()||o.get(this).seek(a)}},{key:"src",get:function(){return p.get(this)},set:function(a){p.set(this,a),(0,k.isSubContext)()||(o.get(this).src=a)}},{key:"loop",get:function(){return!(0,k.isSubContext)()&&o.get(this).loop},set:function(a){(0,k.isSubContext)()||(o.get(this).loop=a)}},{key:"autoplay",get:function(){return!(0,k.isSubContext)()&&o.get(this).autoplay},set:function(a){(0,k.isSubContext)()||(o.get(this).autoplay=a)}},{key:"paused",get:function(){return!(0,k.isSubContext)()&&o.get(this).paused}}]),b}(j.default);c.default=s},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=d(14),i=function(a){return a&&a.__esModule?a:{default:a}}(h),j=function(a){function b(){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"audio"))}return g(b,a),b}(i.default);c.default=j},function(b,c,d){function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&("object"===("undefined"==typeof c?"undefined":a(c))||"function"==typeof c)?c:b}function g(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":a(c)));b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=d(4),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=function(a){function b(a){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a))}return g(b,a),h(b,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),b}(j.default);c.default=k},function(a,b,c){c(16)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){return function(b){var c=new k(a);c.touches=b.touches,c.targetTouches=Array.prototype.slice.call(b.touches),c.changedTouches=b.changedTouches,c.timeStamp=b.timeStamp,i.default.dispatchEvent(c)}}var f=c(1),g=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(f),h=c(10),i=function(a){return a&&a.__esModule?a:{default:a}}(h),j=c(8),k=function a(b){d(this,a),this.target=g.canvas,this.currentTarget=g.canvas,this.touches=[],this.targetTouches=[],this.changedTouches=[],this.preventDefault=j.noop,this.stopPropagation=j.noop,this.type=b};wx.onTouchStart(e("touchstart")),wx.onTouchMove(e("touchmove")),wx.onTouchEnd(e("touchend")),wx.onTouchCancel(e("touchcancel"))},function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b.noop=function(){},b.isSubContext=function(){return"undefined"!=typeof GameGlobal&&!0===GameGlobal.__isSubContext}},function(a,b,c){Object.defineProperty(b,"__esModule",{value:!0});var d=c(8),e=wx.getSystemInfoSync(),f=e.platform,g={platform:f,language:"zh-cn",appVersion:"5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/zh_CN",onLine:!0,geolocation:{getCurrentPosition:d.noop,watchPosition:d.noop,clearWatch:d.noop}};b.default=g},function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function d(a){if("function"==typeof this["on"+a]){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];this["on"+a].apply(this,c)}}function e(a){this.readyState=a,d.call(this,"readystatechange")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=new WeakMap,h=new WeakMap,i=new WeakMap,j=new WeakMap,k=new WeakMap,l=function(){function a(){c(this,a),this.onabort=null,this.onerror=null,this.onload=null,this.onloadstart=null,this.onprogress=null,this.ontimeout=null,this.onloadend=null,this.onreadystatechange=null,this.readyState=0,this.response=null,this.responseText=null,this.responseType="",this.responseXML=null,this.status=0,this.statusText="",this.upload={},this.withCredentials=!1,i.set(this,{"content-type":"application/x-www-form-urlencoded"}),j.set(this,{})}return f(a,[{key:"abort",value:function(){var a=k.get(this);a&&a.abort()}},{key:"getAllResponseHeaders",value:function(){var a=j.get(this);return Object.keys(a).map(function(b){return b+": "+a[b]}).join("\n")}},{key:"getResponseHeader",value:function(a){return j.get(this)[a]}},{key:"open",value:function(b,c){h.set(this,b),g.set(this,c),e.call(this,a.OPENED)}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var b=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(this.readyState!==a.OPENED)throw new Error("Failed to execute 'send' on 'XMLHttpRequest': The object's state must be OPENED.");else wx.request({data:c,url:g.get(this),method:h.get(this),header:i.get(this),responseType:this.responseType,success:function(c){var f=c.data,g=c.statusCode,h=c.header;if("string"!=typeof f&&!(f instanceof ArrayBuffer))try{f=JSON.stringify(f)}catch(a){f=f}if(b.status=g,j.set(b,h),d.call(b,"loadstart"),e.call(b,a.HEADERS_RECEIVED),e.call(b,a.LOADING),b.response=f,f instanceof ArrayBuffer){b.responseText="";for(var k=new Uint8Array(f),l=k.byteLength,m=0;m<l;m++)b.responseText+=String.fromCharCode(k[m])}else b.responseText=f;e.call(b,a.DONE),d.call(b,"load"),d.call(b,"loadend")},fail:function(a){var c=a.errMsg;-1===c.indexOf("abort")?d.call(b,"error",c):d.call(b,"abort"),d.call(b,"loadend")}})}},{key:"setRequestHeader",value:function(a,b){var c=i.get(this);c[a]=b,i.set(this,c)}}]),a}();l.UNSEND=0,l.OPENED=1,l.HEADERS_RECEIVED=2,l.LOADING=3,l.DONE=4,b.default=l},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=c(8),g=new WeakMap,h=function(){function a(b){var c=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(d(this,a),this.binaryType="",this.bufferedAmount=0,this.extensions="",this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.protocol="",this.readyState=3,(0,f.isSubContext)())throw new Error("WebSocket is not supported in SubContext.");if("string"!=typeof b||!/(^ws:\/\/)|(^wss:\/\/)/.test(b))throw new TypeError("Failed to construct 'WebSocket': The URL '"+b+"' is invalid");this.url=b,this.readyState=a.CONNECTING;var h=wx.connectSocket({url:b,protocols:Array.isArray(e)?e:[e]});return g.set(this,h),h.onClose(function(b){c.readyState=a.CLOSED,"function"==typeof c.onclose&&c.onclose(b)}),h.onMessage(function(a){"function"==typeof c.onmessage&&c.onmessage(a)}),h.onOpen(function(){c.readyState=a.OPEN,"function"==typeof c.onopen&&c.onopen()}),h.onError(function(a){"function"==typeof c.onerror&&c.onerror(new Error(a.errMsg))}),this}return e(a,[{key:"close",value:function(b,c){this.readyState=a.CLOSING;var d=g.get(this);d.close({code:b,reason:c})}},{key:"send",value:function(a){if("string"!=typeof a&&!(a instanceof ArrayBuffer))throw new TypeError("Failed to send message: The data "+a+" is invalid");var b=g.get(this);b.send({data:a})}}]),a}();h.CONNECTING=0,h.OPEN=1,h.CLOSING=2,h.CLOSED=3,b.default=h},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=c(8),g=function(){function a(){d(this,a)}return e(a,[{key:"construct",value:function(){if((0,f.isSubContext)())throw new Error("FileReader is not supported in SubContext.")}}]),a}();b.default=g},function(a,b,c){Object.defineProperty(b,"__esModule",{value:!0});var d=c(8),e={get length(){var a=wx.getStorageInfoSync(),b=a.keys;return b.length},key:function(a){var b=wx.getStorageInfoSync(),c=b.keys;return c[a]},getItem:function(a){return wx.getStorageSync(a)},setItem:function(a,b){return wx.setStorageSync(a,b)},removeItem:function(a){wx.removeStorageSync(a)},clear:function(){wx.clearStorageSync()}},f={},g={get length(){var a=Object.keys(f);return a.length},key:function(a){var b=Object.keys(f);return b[a]},getItem:function(a){return f[a]},setItem:function(a,b){f[a]=b},removeItem:function(a){delete f[a]},clear:function(){f={}}},h=(0,d.isSubContext)()?g:e;b.default=h},function(a,b){Object.defineProperty(b,"__esModule",{value:!0});b.default={href:"game.js",reload:function(){}}}])})(); 
 			});
 		define("mySubContext/sub.js", function(require, module, exports){ 			
(function(){'use strict';console.log('\u5B50\u57DF\u4EE3\u7801'),require('weapp-adapter.js'),require('GroupRank2')})(); 
 			}); 	require("mySubContext/sub.js");
 	